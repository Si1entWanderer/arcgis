(this.webpackJsonparcgis=this.webpackJsonparcgis||[]).push([[170],{1044:function(e,t,a){"use strict";a.r(t),a.d(t,"getPatternDescriptor",(function(){return S})),a.d(t,"getSymbolLayerFill",(function(){return z})),a.d(t,"previewSymbol3D",(function(){return q}));var r=a(8),s=a.n(r),l=a(14),n=a(16),i=a(93),c=a(763),o=(a(17),a(22)),u=a(15),h=a(3),p=a(23),b=a(28),m=a(608),f=a(484),v=a(387),y=a(932),d=a(981),j=a(557),g=a(267),O=22,k=120,x=u.a.getLogger("esri.symbols.support.previewSymbol3D");function w(e){var t=e.outline,a=Object(h.j)(e.material)?e.material.color:null,r=Object(h.j)(a)?a.toHex():null;if(Object(h.i)(t))return"fill"===e.type&&"#ffffff"===r?{color:"#bdc3c7",width:.75}:null;var s=Object(b.g)(t.size)||0;return{color:"rgba("+(Object(h.j)(t.color)?t.color.toRgba():"255,255,255,1")+")",width:Math.min(s,80)}}function M(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,a=e.a,r=Object(c.a)(e),s=r.h,l=r.s/t,n=100-(100-r.v)/t,i=Object(c.d)({h:s,s:l,v:n}),o=i.r,u=i.g,h=i.b;return[o,u,h,a]}function L(e){return"water"===e.type?Object(h.i)(e.color)?null:e.color:Object(h.i)(e.material)||Object(h.i)(e.material.color)?null:e.material.color}function z(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,a=L(e);if(!a){if("fill"===e.type)return null;var r=m.a.r,s=Object(y.b)(r,t);return[s,s,s,100]}for(var l=a.toRgba(),n=0;n<3;n++)l[n]=Object(y.b)(l[n],t);return l}function S(e,t){return P.apply(this,arguments)}function P(){return(P=Object(n.a)(s.a.mark((function e(t,a){var r;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("none"!==(r=t.style)){e.next=3;break}return e.abrupt("return",null);case 3:return e.next=5,Object(m.c)(Object(i.b)("esri/symbols/patterns/".concat(r,".png")),a.toCss(!0));case 5:return e.t0=e.sent,e.abrupt("return",{type:"pattern",x:0,y:0,src:e.t0,width:5,height:5});case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function D(e){return e.outline?w(e):{color:"rgba(0, 0, 0, 1)",width:1.5}}function I(e,t){var a=L(e);if(!a)return null;var r="rgba(";return r+=Object(y.b)(a.r,t)+",",r+=Object(y.b)(a.g,t)+",",(r+=Object(y.b)(a.b,t)+",")+a.a+");"}function C(e,t){var a=I(e,t);return a?{color:a,width:Math.min(e.size?Object(b.g)(e.size):.75,80)}:{}}function E(e,t,a){var r=.75*a;return{type:"linear",x1:r?.25*r:0,y1:r?.5*r:0,x2:r||4,y2:r?.5*r:4,colors:[{color:e,offset:0},{color:t,offset:1}]}}function R(e,t){var a,r=t&&t.size?Object(b.g)(t.size):null,s=t&&t.maxSize?Object(b.g)(t.maxSize):null,l=t&&t.disableUpsampling,n=e.symbolLayers,c=[],o=0,u=0,h=n.getItemAt(n.length-1);return h&&"icon"===h.type&&(a=h.size&&Object(b.g)(h.size)),n.forEach((function(n){if("icon"===n.type||"object"===n.type){var h="icon"===n.type?n.size&&Object(b.g)(n.size):0,p=r||h?Math.ceil(Math.min(r||h,s||k)):O;if(n&&n.resource&&n.resource.href){var m=function(e,t){var a=t&&t.resource,r=a&&a.href;if(e.thumbnail&&e.thumbnail.url)return Promise.resolve(e.thumbnail.url);if(r&&"object"!==t.type)return Promise.resolve(Object(g.f)(e,t));var s=Object(i.b)("esri/images/Legend/legend3dsymboldefault.png");return e.styleOrigin&&(e.styleOrigin.styleName||e.styleOrigin.styleUrl)?Object(j.resolveWebStyleSymbol)(e.styleOrigin,{portal:e.styleOrigin.portal},"webRef").catch((function(e){return e})).then((function(e){var t;return(null==e||null==(t=e.thumbnail)?void 0:t.url)||s})):Promise.resolve(s)}(e,n).then((function(e){var t=n.get("material.color"),a=function(e){return"icon"===e.type?"multiply":"tint"}(n);return Object(d.b)(e,p,t,a,l)})).then((function(e){var t=e.width,a=e.height;return o=Math.max(o,t),u=Math.max(u,a),[{shape:{type:"image",x:0,y:0,width:t,height:a,src:e.url},fill:null,stroke:null}]}));c.push(m)}else{var x,M=p;"icon"===n.type&&a&&r&&(M=p*(h/a));var L="tall"===(null==t?void 0:t.symbolConfig)||(null==t||null==(x=t.symbolConfig)?void 0:x.isTall)||"object"===n.type&&function(e){var t=e.depth,a=e.height,r=e.width;return r&&t&&a&&r===t&&r<a}(n);o=Math.max(o,L?20:M),u=Math.max(u,M),c.push(Promise.resolve(function(e,t,a){var r=[];if(!e)return r;switch(e.type){case"icon":var s=t,l=t;switch(e.resource&&e.resource.primitive||f.b){case"circle":r.push({shape:{type:"circle",cx:0,cy:0,r:.5*t},fill:z(e,0),stroke:w(e)});break;case"square":r.push({shape:{type:"path",path:[{command:"M",values:[0,l]},{command:"L",values:[0,0]},{command:"L",values:[s,0]},{command:"L",values:[s,l]},{command:"Z",values:[]}]},fill:z(e,0),stroke:w(e)});break;case"triangle":r.push({shape:{type:"path",path:[{command:"M",values:[0,l]},{command:"L",values:[.5*s,0]},{command:"L",values:[s,l]},{command:"Z",values:[]}]},fill:z(e,0),stroke:w(e)});break;case"cross":r.push({shape:{type:"path",path:[{command:"M",values:[.5*s,0]},{command:"L",values:[.5*s,l]},{command:"M",values:[0,.5*l]},{command:"L",values:[s,.5*l]}]},stroke:D(e)});break;case"x":r.push({shape:{type:"path",path:[{command:"M",values:[0,0]},{command:"L",values:[s,l]},{command:"M",values:[s,0]},{command:"L",values:[0,l]}]},stroke:D(e)});break;case"kite":r.push({shape:{type:"path",path:[{command:"M",values:[0,.5*l]},{command:"L",values:[.5*s,0]},{command:"L",values:[s,.5*l]},{command:"L",values:[.5*s,l]},{command:"Z",values:[]}]},fill:z(e,0),stroke:w(e)})}break;case"object":switch(e.resource&&e.resource.primitive||v.b){case"cone":var n=E(z(e,0),z(e,-.6),a?20:t),i=Object(y.c)(t,a);r.push({shape:i[0],fill:n}),r.push({shape:i[1],fill:n});break;case"inverted-cone":var c=z(e,0),o=E(c,z(e,-.6),t),u=Object(y.h)(t);r.push({shape:u[0],fill:o}),r.push({shape:u[1],fill:c});break;case"cube":var h=Object(y.d)(t,a);r.push({shape:h[0],fill:z(e,0)}),r.push({shape:h[1],fill:z(e,-.3)}),r.push({shape:h[2],fill:z(e,-.5)});break;case"cylinder":var p=E(z(e,0),z(e,-.6),a?20:t),b=Object(y.e)(t,a);r.push({shape:b[0],fill:p}),r.push({shape:b[1],fill:p}),r.push({shape:b[2],fill:z(e,0)});break;case"diamond":var m=Object(y.f)(t);r.push({shape:m[0],fill:z(e,-.3)}),r.push({shape:m[1],fill:z(e,0)}),r.push({shape:m[2],fill:z(e,-.3)}),r.push({shape:m[3],fill:z(e,-.7)});break;case"sphere":var d=E(z(e,0),z(e,-.6));d.x1=0,d.y1=0,d.x2=.25*t,d.y2=.25*t,r.push({shape:{type:"circle",cx:0,cy:0,r:.5*t},fill:d});break;case"tetrahedron":var j=Object(y.j)(t);r.push({shape:j[0],fill:z(e,-.3)}),r.push({shape:j[1],fill:z(e,0)}),r.push({shape:j[2],fill:z(e,-.6)})}}return r}(n,M,L)))}}})),Object(p.k)(c).then((function(e){var a=[];return e.forEach((function(e){e.value?a.push(e.value):e.error&&x.warn("error while building swatchInfo!",e.error)})),Object(d.a)(a,[o,u],{node:t&&t.node,scale:!1,opacity:t&&t.opacity})}))}function Z(){return(Z=Object(n.a)(s.a.mark((function e(t,a){var r,n,i,c,o,u,p,m,f,v,j,g,x,P,D,I,E,R,Z,q,A,H,J,N,T,U,F,W,B,G,K;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r="mesh-3d"===t.type,n=t.symbolLayers,i=a&&a.size?Object(b.g)(a.size):null,c=a&&a.maxSize?Object(b.g)(a.maxSize):null,o=i||O,u=[],p=0,m=0,f=!1,v=0;case 3:if(!(v<n.length)){e.next=39;break}if(j=n.getItemAt(v),g=[],!r||"fill"===j.type){e.next=7;break}return e.abrupt("continue",36);case 7:x=y.l.fill[0],e.t0=j.type,e.next="fill"===e.t0?11:"line"===e.t0?22:"extrude"===e.t0?25:"water"===e.t0?30:35;break;case 11:if(P=w(j),D=Math.min(o,c||k),p=Math.max(p,D),m=Math.max(m,D),f=!0,I=z(j,0),E="pattern"in j&&j.pattern,R=L(j),e.t1=!r&&Object(h.j)(E)&&"style"===E.type&&"solid"!==E.style&&R,!e.t1){e.next=20;break}return e.next=19,S(E,R);case 19:I=e.sent;case 20:return g.push({shape:x,fill:I,stroke:P}),e.abrupt("break",35);case 22:return Z={stroke:C(j,0),shape:x},p=Math.max(p,O),m=Math.max(m,O),g.push(Z),e.abrupt("break",35);case 25:return q=Object(l.a)({join:"round"},C(j,-.4)),A=z(j,0),H=z(j,-.2),J=Math.min(o,c||k),N=Object(y.g)(J),q.width=1,g.push({shape:N[0],fill:H,stroke:q}),g.push({shape:N[1],fill:H,stroke:q}),g.push({shape:N[2],fill:A,stroke:q}),O,T=.7*O+.5*J,p=Math.max(p,22),m=Math.max(m,T),e.abrupt("break",35);case 30:return U=L(j),F=M(U),W=M(U,2),B=M(U,3),G=Object(y.k)(),f=!0,g.push({shape:G[0],fill:F}),g.push({shape:G[1],fill:W}),g.push({shape:G[2],fill:B}),K=Math.min(o,c||k),p=Math.max(p,K),m=Math.max(m,K),e.abrupt("break",35);case 35:u.push(g);case 36:v++,e.next=3;break;case 39:return e.abrupt("return",Promise.resolve(Object(d.a)(u,[p,m],{node:a&&a.node,scale:f,opacity:a&&a.opacity})));case 40:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function q(e,t){if(0===e.symbolLayers.length)return Promise.reject(new o.a("symbolPreview: renderPreviewHTML3D","No symbolLayers in the symbol."));var a=null;switch(e.type){case"point-3d":a=R(e,t);break;case"line-3d":a=function(e,t){var a,r=e.symbolLayers,s=[],n=Object(g.g)(e),i=t&&t.size?Object(b.g)(t.size):null,c=(t&&t.maxSize?Object(b.g)(t.maxSize):null)||80,o=0,u=0;return r.forEach((function(e,t){if(e&&("line"===e.type||"path"===e.type)){var r=[];switch(e.type){case"line":var n=C(e,0),h=n&&n.width||0;0===t&&(a=h);var p=Math.min(i||h,c),b=0===t?p:i?p*(h/a):p,m=b>20?2*b:40;u=Math.max(u,b),o=Math.max(o,m),n.width=b,r.push({shape:{type:"path",path:[{command:"M",values:[0,.5*u]},{command:"L",values:[o,.5*u]}]},stroke:n});break;case"path":var f=Math.min(i||O,c),v=z(e,0),d=z(e,-.2),j=I(e,-.4),g=j?{color:j,width:1}:{};if("quad"===e.profile){var k,x,w=null!=(k=e.width)?k:e.size,M=null!=(x=e.height)?x:e.size,L=Object(y.i)(w&&M?w/M:1,0===M,0===w),S=Object(l.a)(Object(l.a)({},g),{},{join:"bevel"});r.push({shape:L[0],fill:d,stroke:S}),r.push({shape:L[1],fill:d,stroke:S}),r.push({shape:L[2],fill:v,stroke:S})}else r.push({shape:y.l.pathSymbol3DLayer[0],fill:d,stroke:g}),r.push({shape:y.l.pathSymbol3DLayer[1],fill:v,stroke:g});u=Math.max(u,f),o=u}s.push(r)}})),Promise.resolve(Object(d.a)(s,[o,u],{node:t&&t.node,scale:n,opacity:t&&t.opacity}))}(e,t);break;case"polygon-3d":case"mesh-3d":a=function(e,t){return Z.apply(this,arguments)}(e,t)}return a||Promise.reject(new o.a("symbolPreview: swatchInfo3D","symbol not supported."))}}}]);
//# sourceMappingURL=170.7b13474d.chunk.js.map