/*! For license information please see 45.b1bcb2b4.chunk.js.LICENSE.txt */
(this.webpackJsonparcgis=this.webpackJsonparcgis||[]).push([[45],[function(e,t,r){"use strict";function n(e,t,r,n){var i,a=arguments.length,o=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(a<3?i(o):a>3?i(t,r,o):i(t,r))||o);return a>3&&o&&Object.defineProperty(t,r,o),o}r.d(t,"a",(function(){return n}))},function(e,t,r){"use strict";r.d(t,"a",(function(){return h})),r.d(t,"b",(function(){return l})),r.d(t,"c",(function(){return u}));var n=r(15),i=r(18),a=r(200),o=r(204),s=r(501),c=n.a.getLogger("esri.core.accessorSupport.decorators.property");function l(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(t,r,n){if(t===Function.prototype)throw new Error("Inappropriate use of @property() on a static field: ".concat(t.name,".").concat(r,". Accessor does not support static properties."));var l=Object(o.b)(t,r);n&&(n.get||n.set?(l.get=n.get||l.get,l.set=n.set||l.set):"value"in n&&("value"in e&&c.warn('@property() will redefine the value of "'.concat(r,'" on "').concat(t.constructor.name,'" already defined in the metadata'),e),l.value=e.value=n.value)),null!=e.readOnly&&(l.readOnly=e.readOnly);var u=e.aliasOf;if(u){var f,p="string"==typeof u?u:u.source,b="string"==typeof u?null:!0===u.overridable;l.dependsOn=[p],l.get=function(){var e=Object(a.b)(this,p);if("function"==typeof e){f||(f=p.split(".").slice(0,-1).join("."));var t=Object(a.b)(this,f);t&&(e=e.bind(t))}return e},l.readOnly||(l.set=b?function(e){void 0!==e?this._override(r,e):this._clearOverride(r)}:function(e){Object(s.a)(this,p,e)})}var v=e.type,m=e.types;l.cast||(v?l.cast=d(v):m&&(Array.isArray(m)?l.cast=Object(i.c)(Object(i.k)(m[0])):l.cast=Object(i.k)(m))),e.range&&(l.cast=h(l.cast,e.range)),Object(o.c)(l,e)}}function u(e,t,r){var n=Object(o.b)(e,r);n.json||(n.json={});var i=n.json;return void 0!==t&&(i.origins||(i.origins={}),i.origins[t]||(i.origins[t]={}),i=i.origins[t]),i}function d(e){var t=0,r=e;if(Object(i.n)(e))return Object(i.f)(e);for(;Array.isArray(r)&&1===r.length&&"string"!=typeof r[0]&&"number"!=typeof r[0];)r=r[0],t++;var n=r;if(Object(i.o)(n))return 0===t?Object(i.j)(n):Object(i.h)(Object(i.j)(n),t);if(1===t)return Object(i.b)(n);if(t>1)return Object(i.g)(n,t);var a=e;return a.from?a.from:Object(i.m)(a)}function h(e,t){return function(r){var n=+e(r);return null!=t.step&&(n=Math.round(n/t.step)*t.step),null!=t.min&&(n=Math.max(t.min,n)),null!=t.max&&(n=Math.min(t.max,n)),n}}},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}r.d(t,"a",(function(){return n}))},function(e,t,r){"use strict";r.d(t,"a",(function(){return b})),r.d(t,"b",(function(){return _})),r.d(t,"c",(function(){return c})),r.d(t,"d",(function(){return x})),r.d(t,"e",(function(){return h})),r.d(t,"f",(function(){return f})),r.d(t,"g",(function(){return O})),r.d(t,"h",(function(){return w})),r.d(t,"i",(function(){return o})),r.d(t,"j",(function(){return a})),r.d(t,"k",(function(){return s})),r.d(t,"l",(function(){return g})),r.d(t,"m",(function(){return j})),r.d(t,"n",(function(){return y})),r.d(t,"o",(function(){return i})),r.d(t,"p",(function(){return m})),r.d(t,"q",(function(){return v})),r.d(t,"r",(function(){return p})),r.d(t,"s",(function(){return l})),r.d(t,"t",(function(){return d})),r.d(t,"u",(function(){return u}));var n=r(13),i=null;function a(e){return null!=e}function o(e){return null==e}function s(e){return void 0===e}function c(e,t){return a(e)?t(e):i}function l(e){return e}function u(e,t){if(o(e))throw new Error(t);return e}function d(e,t){return a(e)?e:"function"==typeof t?t():t}function h(e){return a(e)&&e.destroy(),null}function f(e){return a(e)&&e.dispose(),null}function p(e){return a(e)&&e.remove(),null}function b(e){return a(e)&&e.abort(),null}function v(e){return a(e)&&e.release(),null}function m(e){return null}function y(e,t){var r=new Array;return e.forEach((function(e){var n=t(e);a(n)&&r.push(n)})),r}function g(e,t){var r,i=new Array,a=Object(n.a)(e);try{for(a.s();!(r=a.n()).done;){var o=r.value;i.push(j(o,null,t))}}catch(s){a.e(s)}finally{a.f()}return i}function O(e,t){var r,i=Object(n.a)(e);try{for(i.s();!(r=i.n()).done;){j(r.value,null,t)}}catch(a){i.e(a)}finally{i.f()}}function j(e,t,r){return a(e)?r(e):t}function _(e,t){return a(e)?t(e):null}function w(e){for(var t=e,r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];for(var a=0;a<n.length&&t;++a)t=t[n[a]];return t}function x(e){return e}},function(e,t,r){"use strict";r.d(t,"a",(function(){return h})),r.d(t,"b",(function(){return f})),r.d(t,"c",(function(){return N})),r.d(t,"d",(function(){return u})),r.d(t,"e",(function(){return d})),r.d(t,"f",(function(){return b})),r.d(t,"g",(function(){return p})),r.d(t,"h",(function(){return c})),r.d(t,"i",(function(){return _})),r.d(t,"j",(function(){return j})),r.d(t,"k",(function(){return w})),r.d(t,"l",(function(){return l})),r.d(t,"m",(function(){return o})),r.d(t,"n",(function(){return m})),r.d(t,"o",(function(){return v})),r.d(t,"p",(function(){return F})),r.d(t,"q",(function(){return P})),r.d(t,"r",(function(){return a})),r.d(t,"s",(function(){return x})),r.d(t,"t",(function(){return O})),r.d(t,"u",(function(){return g})),r.d(t,"v",(function(){return y})),r.d(t,"w",(function(){return S})),r.d(t,"x",(function(){return E})),r.d(t,"y",(function(){return s})),r.d(t,"z",(function(){return k})),r.d(t,"A",(function(){return z})),r.d(t,"B",(function(){return T})),r.d(t,"C",(function(){return R})),r.d(t,"D",(function(){return V})),r.d(t,"E",(function(){return L})),r.d(t,"F",(function(){return A}));var n=r(9),i=r(63);function a(e){var t=e[0],r=e[1],n=e[2];return Math.sqrt(t*t+r*r+n*n)}function o(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e}function s(e,t,r,n){return e[0]=t,e[1]=r,e[2]=n,e}function c(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e}function l(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e[2]=t[2]-r[2],e}function u(e,t,r){return e[0]=t[0]*r[0],e[1]=t[1]*r[1],e[2]=t[2]*r[2],e}function d(e,t,r){return e[0]=t[0]/r[0],e[1]=t[1]/r[1],e[2]=t[2]/r[2],e}function h(e,t,r){return e[0]=Math.min(t[0],r[0]),e[1]=Math.min(t[1],r[1]),e[2]=Math.min(t[2],r[2]),e}function f(e,t,r){return e[0]=Math.max(t[0],r[0]),e[1]=Math.max(t[1],r[1]),e[2]=Math.max(t[2],r[2]),e}function p(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e}function b(e,t,r,n){return e[0]=t[0]+r[0]*n,e[1]=t[1]+r[1]*n,e[2]=t[2]+r[2]*n,e}function v(e,t){var r=t[0]-e[0],n=t[1]-e[1],i=t[2]-e[2];return Math.sqrt(r*r+n*n+i*i)}function m(e,t){var r=t[0]-e[0],n=t[1]-e[1],i=t[2]-e[2];return r*r+n*n+i*i}function y(e){var t=e[0],r=e[1],n=e[2];return t*t+r*r+n*n}function g(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e}function O(e,t){var r=t[0],n=t[1],i=t[2],a=r*r+n*n+i*i;return a>0&&(a=1/Math.sqrt(a),e[0]=t[0]*a,e[1]=t[1]*a,e[2]=t[2]*a),e}function j(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function _(e,t,r){var n=t[0],i=t[1],a=t[2],o=r[0],s=r[1],c=r[2];return e[0]=i*c-a*s,e[1]=a*o-n*c,e[2]=n*s-i*o,e}function w(e,t,r,n){var i=t[0],a=t[1],o=t[2];return e[0]=i+n*(r[0]-i),e[1]=a+n*(r[1]-a),e[2]=o+n*(r[2]-o),e}function x(e,t,r){var n=t[0],i=t[1],a=t[2];return e[0]=r[0]*n+r[4]*i+r[8]*a+r[12],e[1]=r[1]*n+r[5]*i+r[9]*a+r[13],e[2]=r[2]*n+r[6]*i+r[10]*a+r[14],e}function k(e,t,r){var n=t[0],i=t[1],a=t[2];return e[0]=n*r[0]+i*r[3]+a*r[6],e[1]=n*r[1]+i*r[4]+a*r[7],e[2]=n*r[2]+i*r[5]+a*r[8],e}function S(e,t,r){var n=r[0],i=r[1],a=r[2],o=r[3],s=t[0],c=t[1],l=t[2],u=i*l-a*c,d=a*s-n*l,h=n*c-i*s,f=i*h-a*d,p=a*u-n*h,b=n*d-i*u,v=2*o;return u*=v,d*=v,h*=v,f*=2,p*=2,b*=2,e[0]=s+u+f,e[1]=c+d+p,e[2]=l+h+b,e}function T(e,t){o(C,e),o(M,t),O(C,C),O(M,M);var r=j(C,M);return r>1?0:r<-1?Math.PI:Math.acos(r)}var C=Object(n.e)(),M=Object(n.e)();function P(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]}function A(e,t){var r=e[0],n=e[1],a=e[2],o=t[0],s=t[1],c=t[2];return Math.abs(r-o)<=i.a*Math.max(1,Math.abs(r),Math.abs(o))&&Math.abs(n-s)<=i.a*Math.max(1,Math.abs(n),Math.abs(s))&&Math.abs(a-c)<=i.a*Math.max(1,Math.abs(a),Math.abs(c))}function E(e,t,r){var n=r[0]-t[0],i=r[1]-t[1],a=r[2]-t[2],o=n*n+i*i+a*a;return o>0?(o=1/Math.sqrt(o),e[0]=n*o,e[1]=i*o,e[2]=a*o,e):(e[0]=0,e[1]=0,e[2]=0,e)}var R=l,I=u,D=d,F=v,L=m,z=a,V=y,N=Object.freeze({__proto__:null,length:a,copy:o,set:s,add:c,subtract:l,multiply:u,divide:d,ceil:function(e,t){return e[0]=Math.ceil(t[0]),e[1]=Math.ceil(t[1]),e[2]=Math.ceil(t[2]),e},floor:function(e,t){return e[0]=Math.floor(t[0]),e[1]=Math.floor(t[1]),e[2]=Math.floor(t[2]),e},min:h,max:f,round:function(e,t){return e[0]=Math.round(t[0]),e[1]=Math.round(t[1]),e[2]=Math.round(t[2]),e},scale:p,scaleAndAdd:b,distance:v,squaredDistance:m,squaredLength:y,negate:g,inverse:function(e,t){return e[0]=1/t[0],e[1]=1/t[1],e[2]=1/t[2],e},normalize:O,dot:j,cross:_,lerp:w,hermite:function(e,t,r,n,i,a){var o=a*a,s=o*(2*a-3)+1,c=o*(a-2)+a,l=o*(a-1),u=o*(3-2*a);return e[0]=t[0]*s+r[0]*c+n[0]*l+i[0]*u,e[1]=t[1]*s+r[1]*c+n[1]*l+i[1]*u,e[2]=t[2]*s+r[2]*c+n[2]*l+i[2]*u,e},bezier:function(e,t,r,n,i,a){var o=1-a,s=o*o,c=a*a,l=s*o,u=3*a*s,d=3*c*o,h=c*a;return e[0]=t[0]*l+r[0]*u+n[0]*d+i[0]*h,e[1]=t[1]*l+r[1]*u+n[1]*d+i[1]*h,e[2]=t[2]*l+r[2]*u+n[2]*d+i[2]*h,e},random:function(e,t){t=t||1;var r=2*Object(i.b)()*Math.PI,n=2*Object(i.b)()-1,a=Math.sqrt(1-n*n)*t;return e[0]=Math.cos(r)*a,e[1]=Math.sin(r)*a,e[2]=n*t,e},transformMat4:x,transformMat3:k,transformQuat:S,rotateX:function(e,t,r,n){var i=[],a=[];return i[0]=t[0]-r[0],i[1]=t[1]-r[1],i[2]=t[2]-r[2],a[0]=i[0],a[1]=i[1]*Math.cos(n)-i[2]*Math.sin(n),a[2]=i[1]*Math.sin(n)+i[2]*Math.cos(n),e[0]=a[0]+r[0],e[1]=a[1]+r[1],e[2]=a[2]+r[2],e},rotateY:function(e,t,r,n){var i=[],a=[];return i[0]=t[0]-r[0],i[1]=t[1]-r[1],i[2]=t[2]-r[2],a[0]=i[2]*Math.sin(n)+i[0]*Math.cos(n),a[1]=i[1],a[2]=i[2]*Math.cos(n)-i[0]*Math.sin(n),e[0]=a[0]+r[0],e[1]=a[1]+r[1],e[2]=a[2]+r[2],e},rotateZ:function(e,t,r,n){var i=[],a=[];return i[0]=t[0]-r[0],i[1]=t[1]-r[1],i[2]=t[2]-r[2],a[0]=i[0]*Math.cos(n)-i[1]*Math.sin(n),a[1]=i[0]*Math.sin(n)+i[1]*Math.cos(n),a[2]=i[2],e[0]=a[0]+r[0],e[1]=a[1]+r[1],e[2]=a[2]+r[2],e},angle:T,str:function(e){return"vec3("+e[0]+", "+e[1]+", "+e[2]+")"},exactEquals:P,equals:A,direction:E,sub:R,mul:I,div:D,dist:F,sqrDist:L,len:z,sqrLen:V})},function(e,t,r){"use strict";function n(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function i(e,t,r){return t&&n(e.prototype,t),r&&n(e,r),e}r.d(t,"a",(function(){return i}))},function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var n=r(392);function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Object(n.a)(e,t)}},function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r(42),i=r(499),a=r(287);function o(e){var t=Object(i.a)();return function(){var r,i=Object(n.a)(e);if(t){var o=Object(n.a)(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return Object(a.a)(this,r)}}},function(e,t,r){e.exports=r(697)},function(e,t,r){"use strict";function n(){return[0,0,0]}function i(e){return[e[0],e[1],e[2]]}function a(e,t,r){return[e,t,r]}function o(e){for(var t=[0,0,0],r=Math.min(3,e.length),n=0;n<r;++n)t[n]=e[n];return t}function s(e,t){return new Float64Array(e,t,3)}function c(){return[0,0,0]}function l(){return a(1,1,1)}function u(){return a(1,0,0)}function d(){return a(0,1,0)}function h(){return a(0,0,1)}r.d(t,"a",(function(){return p})),r.d(t,"b",(function(){return f})),r.d(t,"c",(function(){return i})),r.d(t,"d",(function(){return s})),r.d(t,"e",(function(){return n})),r.d(t,"f",(function(){return o})),r.d(t,"g",(function(){return a})),r.d(t,"h",(function(){return h}));var f=[0,0,0],p=l(),b=u(),v=d(),m=h();Object.freeze({__proto__:null,create:n,clone:i,fromValues:a,fromArray:o,createView:s,zeros:c,ones:l,unitX:u,unitY:d,unitZ:h,ZEROS:f,ONES:p,UNIT_X:b,UNIT_Y:v,UNIT_Z:m})},function(e,t,r){"use strict";r.d(t,"a",(function(){return p}));var n=r(13),i=r(2),a=r(287),o=r(19),s=r(6),c=r(7),l=(r(17),[r(298).a]);var u=r(204),d=r(80),h=new Set,f=new Set;function p(e){return function(t){t.prototype.declaredClass=e,function(e,t){var r,i=Object(n.a)(l);try{for(i.s();!(r=i.n()).done;){var a=r.value;if(a.processPrototypePropertyMetadata)for(var o in e){var s=e[o];a.processPrototypePropertyMetadata(o,s,e,t)}}}catch(c){i.e(c)}finally{i.f()}}(Object(u.a)(t.prototype).properties,e),function(e){var t=e.prototype,r=t.declaredClass,i=Object(u.a)(t).properties;!function(e,t){var r,i=Object(n.a)(l);try{for(i.s();!(r=i.n()).done;){var a=r.value;if(a.processClassPropertyMetadata)for(var o in e){var s=e[o];a.processClassPropertyMetadata(o,s,e,t)}}}catch(c){i.e(c)}finally{i.f()}}(i,r);var a,o={},s=Object(n.a)(Object.getOwnPropertyNames(i));try{var c=function(){var e=a.value,t=i[e];o[e]={enumerable:!0,configurable:!0,get:b(e,t),set:function(r){var n=this.__accessor__;if(void 0!==n){if(!Object.isFrozen(this)){if(n.initialized&&t.readOnly)throw new TypeError("[accessor] cannot assign to read-only property '".concat(e,"' of ").concat(this.declaredClass));if(2===n.lifecycle&&t.constructOnly)throw new TypeError("[accessor] cannot assign to construct-only property '".concat(e,"' of ").concat(this.declaredClass));n.set(e,r)}}else Object.defineProperty(this,e,{enumerable:!0,configurable:!0,writable:!0,value:r})}}};for(s.s();!(a=s.n()).done;)c()}catch(d){s.e(d)}finally{s.f()}Object.defineProperties(e.prototype,o)}(t);for(var r=[],d=[],p=t.prototype;p;)p.hasOwnProperty("initialize")&&!h.has(p.initialize)&&(h.add(p.initialize),r.push(p.initialize)),p.hasOwnProperty("destroy")&&!f.has(p.destroy)&&(f.add(p.destroy),d.push(p.destroy)),p=Object.getPrototypeOf(p);h.clear(),f.clear();var v=function(e){Object(s.a)(n,e);var t=Object(c.a)(n);function n(){var e;Object(i.a)(this,n);for(var s=arguments.length,c=new Array(s),l=0;l<s;l++)c[l]=arguments[l];if((e=t.call.apply(t,[this].concat(c))).constructor===n&&"function"==typeof e.postscript){var u;if(r.length&&Object.defineProperty(Object(o.a)(e),"initialize",{enumerable:!1,configurable:!0,value:function(){for(var e=r.length-1;e>=0;e--)r[e].call(this)}}),d.length){var h=!1;Object.defineProperty(Object(o.a)(e),"destroy",{enumerable:!1,configurable:!0,value:function(){if(!h){h=!0;for(var e=0;e<d.length;e++)d[e].call(this)}}})}(u=e).postscript.apply(u,c)}return Object(a.a)(e)}return n}(t);return v.__accessorMetadata__=Object(u.a)(t.prototype),v.prototype.declaredClass=e,v}}function b(e,t){return null==t.get?function(){var t=this.__accessor__.properties.get(e);if(void 0!==t){Object(d.c)(t);var r=this.__accessor__.store;return r.has(e)?r.get(e):t.metadata.value}}:function(){var t=this.__accessor__.properties.get(e);if(void 0!==t)return t.getComputed()}}},function(e,t,r){"use strict";function n(e){for(var t="",r=0;r<(arguments.length<=1?0:arguments.length-1);r++)t+=e[r]+(r+1<1||arguments.length<=r+1?void 0:arguments[r+1]);return t+=e[e.length-1]}r.d(t,"a",(function(){return n})),function(e){e.int=function(e){return Math.round(e).toString()},e.float=function(e){return e.toPrecision(8)}}(n||(n={}))},function(e,t,r){"use strict";function n(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}r.d(t,"a",(function(){return n}))},function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var n=r(383);function i(e,t){var r;if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=Object(n.a)(e))||t&&e&&"number"===typeof e.length){r&&(e=r);var i=0,a=function(){};return{s:a,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,c=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return s=e.done,e},e:function(e){c=!0,o=e},f:function(){try{s||null==r.return||r.return()}finally{if(c)throw o}}}}},function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var n=r(21);function i(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function a(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?i(Object(r),!0).forEach((function(t){Object(n.a)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):i(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}},function(e,t,r){"use strict";var n=r(13),i=r(2),a=r(5),o=r(123),s=(r(17),r(3)),c=r(147),l={info:0,warn:1,error:2,none:3},u=function(){function e(t){Object(i.a)(this,e),this.level=null,this._module="",this._parent=null,this.writer=null,this._loggedMessages={error:new Map,warn:new Map,info:new Map},null!=t.level&&(this.level=t.level),null!=t.writer&&(this.writer=t.writer),this._module=t.module,e._loggers[this.module]=this;var r=this.module.lastIndexOf(".");-1!==r&&(this._parent=e.getLogger(this.module.slice(0,r)))}return Object(a.a)(e,[{key:"module",get:function(){return this._module}},{key:"parent",get:function(){return this._parent}},{key:"error",value:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];this._log.apply(this,["error","always"].concat(t))}},{key:"warn",value:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];this._log.apply(this,["warn","always"].concat(t))}},{key:"info",value:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];this._log.apply(this,["info","always"].concat(t))}},{key:"errorOnce",value:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];this._log.apply(this,["error","once"].concat(t))}},{key:"warnOnce",value:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];this._log.apply(this,["warn","once"].concat(t))}},{key:"infoOnce",value:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];this._log.apply(this,["info","once"].concat(t))}},{key:"errorOncePerTick",value:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];this._log.apply(this,["error","oncePerTick"].concat(t))}},{key:"warnOncePerTick",value:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];this._log.apply(this,["warn","oncePerTick"].concat(t))}},{key:"infoOncePerTick",value:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];this._log.apply(this,["info","oncePerTick"].concat(t))}},{key:"test",get:function(){var e=this;return{loggedMessages:e._loggedMessages,clearLoggedWarnings:function(){return e._loggedMessages.warn.clear()}}}},{key:"_log",value:function(t,r){if(this._matchLevel(t)){for(var i=arguments.length,a=new Array(i>2?i-2:0),s=2;s<i;s++)a[s-2]=arguments[s];if("always"!==r&&!e._throttlingDisabled){var c=this._argsToKey(a),l=this._loggedMessages[t].get(c);if("once"===r&&null!=l||"oncePerTick"===r&&l&&l>=e._tickCounter)return;this._loggedMessages[t].set(c,e._tickCounter),e._scheduleTickCounterIncrement()}var u,d=Object(n.a)(o.a.log.interceptors);try{for(d.s();!(u=d.n()).done;){var h=u.value;if(h.apply(void 0,[t,this.module].concat(a)))return}}catch(f){d.e(f)}finally{d.f()}this._inheritedWriter().apply(void 0,[t,this.module].concat(a))}}},{key:"_parentWithMember",value:function(e,t){for(var r=this;Object(s.j)(r);){var n=r[e];if(Object(s.j)(n))return n;r=r.parent}return t}},{key:"_inheritedWriter",value:function(){return this._parentWithMember("writer",this._consoleWriter)}},{key:"_consoleWriter",value:function(e,t){for(var r,n=arguments.length,i=new Array(n>2?n-2:0),a=2;a<n;a++)i[a-2]=arguments[a];(r=console)[e].apply(r,["[".concat(t,"]")].concat(i))}},{key:"_matchLevel",value:function(e){var t=o.a.log.level?o.a.log.level:"warn";return l[this._parentWithMember("level",t)]<=l[e]}},{key:"_argsToKey",value:function(){for(var e=function(e,t){return"object"!=typeof t||Array.isArray(t)?t:"[Object]"},t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return Object(c.b)(JSON.stringify(r,e))}}],[{key:"testSingleton",get:function(){return{resetLoggers:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=e._loggers;return e._loggers=t,r},set throttlingDisabled(t){e._throttlingDisabled=t}}}},{key:"getLogger",value:function(t){var r=e._loggers[t];return r||(r=new e({module:t})),r}},{key:"_scheduleTickCounterIncrement",value:function(){e._tickCounterScheduled||(e._tickCounterScheduled=!0,Promise.resolve().then((function(){e._tickCounter++,e._tickCounterScheduled=!1})))}}]),e}();u._loggers={},u._tickCounter=0,u._tickCounterScheduled=!1,u._throttlingDisabled=!1,t.a=u},function(e,t,r){"use strict";function n(e,t,r,n,i,a,o){try{var s=e[a](o),c=s.value}catch(l){return void r(l)}s.done?t(c):Promise.resolve(c).then(n,i)}function i(e){return function(){var t=this,r=arguments;return new Promise((function(i,a){var o=e.apply(t,r);function s(e){n(o,i,a,s,c,"next",e)}function c(e){n(o,i,a,s,c,"throw",e)}s(void 0)}))}}r.d(t,"a",(function(){return i}))},function(e,t,r){"use strict";var n,i,a,o,s,c=r(14),l=r(71);function u(e){return"function"==typeof a[e]?a[e]=a[e](l.a):a[e]}a=null!=(n=l.a.dojoConfig)&&n.has||null!=(i=l.a.esriConfig)&&i.has?Object(c.a)(Object(c.a)({},null==(o=l.a.dojoConfig)?void 0:o.has),null==(s=l.a.esriConfig)?void 0:s.has):{},u.add=function(e,t,r,n){return(n||void 0===a[e])&&(a[e]=t),r&&u(e)},u.cache=a,u.add("esri-deprecation-warnings",!0),function(){u.add("host-webworker",void 0!==l.a.WorkerGlobalScope&&self instanceof l.a.WorkerGlobalScope);var e="undefined"!=typeof window&&"undefined"!=typeof location&&"undefined"!=typeof document&&window.location===location&&window.document===document;if(u.add("host-browser",e),u.add("host-node","object"==typeof l.a.process&&l.a.process.versions&&l.a.process.versions.node&&l.a.process.versions.v8),u.add("dom",e),u("host-browser")){var t=navigator,r=t.userAgent,n=t.appVersion,i=parseFloat(n);if(u.add("wp",parseFloat(r.split("Windows Phone")[1])||void 0),u.add("msapp",parseFloat(r.split("MSAppHost/")[1])||void 0),u.add("khtml",n.includes("Konqueror")?i:void 0),u.add("edge",parseFloat(r.split("Edge/")[1])||void 0),u.add("opr",parseFloat(r.split("OPR/")[1])||void 0),u.add("webkit",!u("wp")&&!u("edge")&&parseFloat(r.split("WebKit/")[1])||void 0),u.add("chrome",!u("edge")&&!u("opr")&&parseFloat(r.split("Chrome/")[1])||void 0),u.add("android",!u("wp")&&parseFloat(r.split("Android ")[1])||void 0),u.add("safari",!n.includes("Safari")||u("wp")||u("chrome")||u("android")||u("edge")||u("opr")?void 0:parseFloat(n.split("Version/")[1])),u.add("mac",n.includes("Macintosh")),!u("wp")&&r.match(/(iPhone|iPod|iPad)/)){var a=RegExp.$1.replace(/P/,"p"),o=r.match(/OS ([\d_]+)/)?RegExp.$1:"1",s=parseFloat(o.replace(/_/,".").replace(/_/g,""));u.add(a,s),u.add("ios",s)}u.add("trident",parseFloat(n.split("Trident/")[1])||void 0),u("webkit")||(!r.includes("Gecko")||u("wp")||u("khtml")||u("trident")||u("edge")||u.add("mozilla",i),u("mozilla")&&u.add("ff",parseFloat(r.split("Firefox/")[1]||r.split("Minefield/")[1])||void 0))}}(),function(){if(l.a.navigator){var e=navigator.userAgent,t=/Android|webOS|iPhone|iPad|iPod|BlackBerry|Opera Mini|IEMobile/i.test(e),r=/iPhone/i.test(e);t&&u.add("esri-mobile",t),r&&u.add("esri-iPhone",r),u.add("esri-geolocation",!!navigator.geolocation)}u.add("esri-canvas-svg-support",!u("trident")),u.add("esri-wasm","WebAssembly"in l.a),u.add("esri-shared-array-buffer",(function(){var e="SharedArrayBuffer"in l.a,t=!1===l.a.crossOriginIsolated;return e&&!t})),u.add("esri-atomics","Atomics"in l.a),u.add("esri-workers","Worker"in l.a),u.add("esri-text-decoder","TextDecoder"in l.a),u.add("esri-text-encoder","TextEncoder"in l.a),u.add("web-feat:cache","caches"in l.a),u.add("esri-workers-arraybuffer-transfer",!u("safari")||Number(u("safari"))>=12),u.add("featurelayer-snapshot-enabled",!0),u.add("featurelayer-snapshot-point-min-threshold",8e4),u.add("featurelayer-snapshot-point-max-threshold",4e5),u.add("featurelayer-snapshot-point-coverage",.1),u.add("featurelayer-advanced-symbols",!1),u.add("featurelayer-pbf",!0),u.add("featurelayer-pbf-statistics",!1),u.add("feature-layers-workers",!0),u.add("mapview-transitions-duration",200),u.add("mapserver-pbf-enabled",!1),u("host-webworker")||u("host-browser")&&(u.add("csp-restrictions",(function(){try{new Function}catch(e){return!0}return!1})),u.add("esri-image-decode",(function(){if("decode"in new Image){var e=new Image;return e.src='data:image/svg+xml;charset=UTF-8,<svg version="1.1" xmlns="http://www.w3.org/2000/svg"></svg>',void e.decode().then((function(){u.add("esri-image-decode",!0,!0,!0)})).catch((function(){u.add("esri-image-decode",!1,!0,!0)}))}return!1})),u.add("esri-url-encodes-apostrophe",(function(){var e=l.a.document.createElement("a");return e.href="?'",e.href.includes("?%27")})),u.add("vectortilelayer-max-buffers",u("ff")?160:Number.POSITIVE_INFINITY))}(),t.a=u},function(e,t,r){"use strict";r.d(t,"a",(function(){return C})),r.d(t,"b",(function(){return j})),r.d(t,"c",(function(){return O})),r.d(t,"d",(function(){return v})),r.d(t,"e",(function(){return u})),r.d(t,"f",(function(){return A})),r.d(t,"g",(function(){return x})),r.d(t,"h",(function(){return w})),r.d(t,"i",(function(){return l})),r.d(t,"j",(function(){return S})),r.d(t,"k",(function(){return T})),r.d(t,"l",(function(){return c})),r.d(t,"m",(function(){return g})),r.d(t,"n",(function(){return P})),r.d(t,"o",(function(){return k})),r.d(t,"p",(function(){return M}));var n=r(2),i=r(13),a=(r(17),r(15).a.getLogger("esri.core.Accessor"));function o(e){return null==e?e:new Date(e)}function s(e){return null==e?e:!!e}function c(e){return null==e?e:e.toString()}function l(e){return null==e?e:(e=parseFloat(e),isNaN(e)?0:e)}function u(e){return null==e?e:Math.round(parseFloat(e))}function d(e){return e&&e.constructor&&void 0!==e.constructor.__accessorMetadata__}function h(e,t){return null!=t&&e&&!(t instanceof e)}function f(e){return e&&"isCollection"in e}function p(e){return e&&e.Type?"function"==typeof e.Type?e.Type:e.Type.base:null}function b(e,t){return!!d(t)&&(a.error("Accessor#set","Assigning an instance of '"+(t.declaredClass||"unknown")+"' which is not a subclass of '"+m(e)+"'"),!0)}function v(e,t){return null==t?t:f(e)?function(e,t){if(!t||!t.constructor||!f(t.constructor))return b(e,t)?t:new e(t);var r=p(e.prototype.itemType),n=p(t.constructor.prototype.itemType);return r?n?r===n?t:r.prototype.isPrototypeOf(n.prototype)?new e(t):(b(e,t),t):new e(t):t}(e,t):h(e,t)?b(e,t)?t:new e(t):t}function m(e){return e&&e.prototype&&e.prototype.declaredClass||"unknown"}function y(e){switch(e){case Number:return l;case C:return u;case Boolean:return s;case String:return c;case Date:return o;default:return v.bind(null,e)}}function g(e,t){var r=y(e);return 1===arguments.length?r:r(t)}function O(e,t,r){return 1===arguments.length?O.bind(null,e):t?Array.isArray(t)?t.map((function(t){return e(t,r)})):[e(t,r)]:t}function j(e,t){return 1===arguments.length?O(g.bind(null,e)):O(g.bind(null,e),t)}function _(e,t,r){return 0!==t&&Array.isArray(r)?r.map((function(r){return _(e,t-1,r)})):e(r)}function w(e,t,r){if(2===arguments.length)return w.bind(null,e,t);if(!r)return r;for(var n=t,i=r=_(e,t,r);n>0&&Array.isArray(i);)n--,i=i[0];if(void 0!==i)for(var a=0;a<n;a++)r=[r];return r}function x(e,t,r){return 2===arguments.length?w(g.bind(null,e),t):w(g.bind(null,e),t,r)}function k(e){return!!Array.isArray(e)&&!e.some((function(t){var r=typeof t;return!("string"===r||"number"===r||"function"===r&&e.length>1)}))}function S(e,t){if(2===arguments.length)return S(e).call(null,t);var r,n=new Set,o=e.filter((function(e){return"function"!=typeof e})),s=e.filter((function(e){return"function"==typeof e})),c=Object(i.a)(e);try{for(c.s();!(r=c.n()).done;){var l=r.value;"string"!=typeof l&&"number"!=typeof l||n.add(l)}}catch(f){c.e(f)}finally{c.f()}var u=null,d=null;return function(e,t){if(null==e)return e;var r=typeof e,i="string"===r||"number"===r;return i&&(n.has(e)||s.some((function(e){return"string"===r&&e===String||"number"===r&&e===Number})))||"object"===r&&s.some((function(t){return!h(e,t)}))?e:(i&&o.length?(u||(u=o.map((function(e){return"string"==typeof e?"'".concat(e,"'"):"".concat(e)})).join(", ")),a.error("Accessor#set","'".concat(e,"' is not a valid value for this property, only the following values are valid: ").concat(u))):"object"==typeof e&&s.length?(d||(d=s.map((function(e){return m(e)})).join(", ")),a.error("Accessor#set","'".concat(e,"' is not a valid value for this property, value must be one of ").concat(d))):a.error("Accessor#set","'".concat(e,"' is not a valid value for this property")),t&&(t.valid=!1),null)}}function T(e,t){if(2===arguments.length)return T(e).call(null,t);var r={},n=[],i=[];for(var o in e.typeMap){var s=e.typeMap[o];r[o]=g(s),n.push(m(s)),i.push(o)}var c=function(){return"'".concat(n.join("', '"),"'")},l=function(){return"'".concat(i.join("', '"),"'")},u="string"==typeof e.key?function(t){return t[e.key]}:e.key;return function(t){if(e.base&&!h(e.base,t))return t;if(null==t)return t;var n=u(t)||e.defaultKeyValue,i=r[n];if(!i)return a.error("Accessor#set","Invalid property value, value needs to be one of ".concat(c(),", or a plain object that can autocast (having .type = ").concat(l(),")")),null;if(!h(e.typeMap[n],t))return t;if("string"==typeof e.key&&!d(t)){var o={};for(var s in t)s!==e.key&&(o[s]=t[s]);return i(o)}return i(t)}}var C=function e(){Object(n.a)(this,e)},M={native:function(e){return{type:"native",value:e}},array:function(e){return{type:"array",value:e}},oneOf:function(e){return{type:"one-of",values:e}}};function P(e){if(!e||!("type"in e))return!1;switch(e.type){case"native":case"array":case"one-of":return!0}return!1}function A(e){switch(e.type){case"native":return g(e.value);case"array":return O(A(e.value));case"one-of":return function(e){var t=null;return function(r,n){return R(r,e)?r:(null==t&&(t=E(e)),a.error("Accessor#set","Invalid property value, value needs to be of type ".concat(t)),n&&(n.valid=!1),null)}}(e);default:return null}}function E(e){switch(e.type){case"native":switch(e.value){case Number:return"number";case String:return"string";case Boolean:return"boolean";case C:return"integer";case Date:return"date";default:return m(e.value)}case"array":return"array of ".concat(E(e.value));case"one-of":var t=e.values.map((function(e){return E(e)}));return"one of ".concat(t.slice(0,t.length-1)," or ").concat(t[t.length-1])}return"unknown"}function R(e,t){if(null==e)return!0;switch(t.type){case"native":switch(t.value){case Number:case C:return"number"==typeof e;case Boolean:return"boolean"==typeof e;case String:return"string"==typeof e}return e instanceof t.value;case"array":return!!Array.isArray(e)&&!e.some((function(e){return!R(e,t.value)}));case"one-of":return t.values.some((function(t){return R(e,t)}))}}},function(e,t,r){"use strict";function n(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}r.d(t,"a",(function(){return n}))},function(e,t,r){"use strict";r.d(t,"a",(function(){return S})),r.d(t,"b",(function(){return y})),r.d(t,"c",(function(){return g})),r.d(t,"d",(function(){return k})),r.d(t,"e",(function(){return c})),r.d(t,"f",(function(){return _})),r.d(t,"g",(function(){return b})),r.d(t,"h",(function(){return j})),r.d(t,"i",(function(){return O})),r.d(t,"j",(function(){return a})),r.d(t,"k",(function(){return o})),r.d(t,"l",(function(){return l})),r.d(t,"m",(function(){return p})),r.d(t,"n",(function(){return f})),r.d(t,"o",(function(){return d})),r.d(t,"p",(function(){return s})),r.d(t,"q",(function(){return u})),r.d(t,"r",(function(){return v})),r.d(t,"s",(function(){return m})),r.d(t,"t",(function(){return h})),r.d(t,"u",(function(){return x}));var n=r(4),i=new Float32Array(1),a=Number.isFinite||function(e){return"number"==typeof e&&window.isFinite(e)},o=Number.isNaN||function(e){return e!=e};function s(e){--e;for(var t=1;t<32;t<<=1)e|=e>>t;return e+1}function c(e,t,r){return Math.min(Math.max(e,t),r)}function l(e){return 0==(e&e-1)}function u(e){return e--,e|=e>>1,e|=e>>2,e|=e>>4,e|=e>>8,e|=e>>16,++e}function d(e){return Math.pow(10,Math.ceil(Math.LOG10E*Math.log(e)))}var h=Math.sign||function(e){return+(e>0)-+(e<0)||+e},f=Math.log2||function(e){return Math.log(e)/Math.LN2};function p(e,t,r){return e+(t-e)*r}function b(e){return e*Math.PI/180}function v(e){return 180*e/Math.PI}function m(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e-6;return(e<0?-1:1)/Math.max(Math.abs(e),t)}function y(e){return Math.acos(c(e,-1,1))}function g(e){return Math.asin(c(e,-1,1))}function O(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e-6;if(o(e)||o(t))return!1;if(e===t)return!0;var n=Math.abs(e-t),i=Math.abs(e),a=Math.abs(t);if(0===e||0===t||i<1e-12&&a<1e-12){if(n>.01*r)return!1}else if(n/(i+a)>r)return!1;return!0}function j(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e-6;return!o(e)&&!o(t)&&(e>t?e-t:t-e)<=r}function _(e){return w(Math.max(-S,Math.min(e,S)))}function w(e){return i[0]=e,i[0]}function x(e,t,r){var n=c((r-e)/(t-e),0,1);return n*n*(3-2*n)}function k(e,t){var r=Object(n.r)(e),i=g(e[2]/r),a=Math.atan2(e[1]/r,e[0]/r);return Object(n.y)(t,r,i,a),t}var S=w(34028234663852886e22)},function(e,t,r){"use strict";function n(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}r.d(t,"a",(function(){return n}))},function(e,t,r){"use strict";var n=r(2),i=r(5),a=r(287),o=r(19),s=r(6),c=r(7),l=r(25),u=r(15),d=function(e){Object(s.a)(r,e);var t=Object(c.a)(r);function r(e,i,s){var c;return Object(n.a)(this,r),c=t.call(this,e,i,s),Object(o.a)(c)instanceof r?Object(a.a)(c):Object(a.a)(c,new r(e,i,s))}return Object(i.a)(r,[{key:"toJSON",value:function(){if(null!=this.details)try{return{name:this.name,message:this.message,details:JSON.parse(JSON.stringify(this.details,(function(e,t){if(t&&"object"==typeof t&&"function"==typeof t.toJSON)return t;try{return Object(l.a)(t)}catch(r){return"[object]"}})))}}catch(e){throw u.a.getLogger("esri.core.Error").error(e),e}return{name:this.name,message:this.message,details:this.details}}}],[{key:"fromJSON",value:function(e){return new r(e.name,e.message,e.details)}}]),r}(r(503).a);d.prototype.type="error",t.a=d},function(e,t,r){"use strict";r.d(t,"a",(function(){return M})),r.d(t,"b",(function(){return l})),r.d(t,"c",(function(){return D})),r.d(t,"d",(function(){return u})),r.d(t,"e",(function(){return h})),r.d(t,"f",(function(){return d})),r.d(t,"g",(function(){return x})),r.d(t,"h",(function(){return I})),r.d(t,"i",(function(){return F})),r.d(t,"j",(function(){return R})),r.d(t,"k",(function(){return k})),r.d(t,"l",(function(){return S})),r.d(t,"m",(function(){return _})),r.d(t,"n",(function(){return j})),r.d(t,"o",(function(){return b})),r.d(t,"p",(function(){return E})),r.d(t,"q",(function(){return P})),r.d(t,"r",(function(){return w})),r.d(t,"s",(function(){return y})),r.d(t,"t",(function(){return g})),r.d(t,"u",(function(){return T})),r.d(t,"v",(function(){return C})),r.d(t,"w",(function(){return v})),r.d(t,"x",(function(){return f})),r.d(t,"y",(function(){return m})),r.d(t,"z",(function(){return A})),r.d(t,"A",(function(){return O}));var n=r(50),i=r(327),a=r(22),o=r(168),s=r(15),c=r(3);function l(e){return Promise.all(e)}function u(e){return new Promise((function(t,r){try{e(t,r)}catch(n){Promise.resolve().then((function(){return r(n)}))}}))}function d(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Aborted";return new a.a("AbortError",e)}function h(){return new AbortController}function f(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Aborted";if(b(e))throw d(t)}function p(e){return Object(c.j)(e)?"aborted"in e?e:e.signal:e}function b(e){var t=p(e);return Object(c.j)(t)&&t.aborted}function v(e){if(j(e))throw e}function m(e){if(!j(e))throw e}function y(e,t){var r=p(e);if(!Object(c.i)(r)){if(!r.aborted)return Object(o.d)(r,"abort",(function(){return t()}));t()}}function g(e,t){var r=p(e);if(!Object(c.i)(r))return f(r),Object(o.d)(r,"abort",(function(){return t(d())}))}function O(e,t){var r=p(t);return Object(c.i)(r)?e:new Promise((function(r,n){var i=y(t,(function(){return n(d())})),a=function(){return i=Object(c.r)(i)};e.then(a,a),e.then(r,n)}))}function j(e){return e&&"AbortError"===e.name}function _(e){return e.catch((function(e){if(!j(e))throw e}))}function w(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:s.a.getLogger("esri");return e.catch((function(e){j(e)||t.error(e)}))}function x(){var e=null,t=new Promise((function(t,r){e={promise:void 0,resolve:t,reject:r}}));return e.promise=t,e}function k(e){if(e){if("function"!=typeof e.forEach){var t=Object.keys(e);return k(t.map((function(t){return e[t]}))).then((function(e){var r={};return t.forEach((function(t,n){return r[t]=e[n]})),r}))}var r=e;return u((function(e){var t=[],n=r.length;0===n&&e(t),r.forEach((function(r){var i={promise:r||Promise.resolve(r)};t.push(i),i.promise.then((function(e){i.value=e})).catch((function(e){i.error=e})).then((function(){0===--n&&e(t)}))}))}))}}function S(e){return k(e).then((function(e){return e.filter((function(e){return!!e.value})).map((function(e){return e.value}))}))}function T(e){return Promise.reject(e)}function C(e){return Promise.resolve(e)}function M(e,t,r){var n=h();return y(r,(function(){return n.abort()})),new Promise((function(r,i){var a=setTimeout((function(){a=0,r(t)}),e);y(n,(function(){a&&(clearTimeout(a),i(d()))}))}))}function P(e){return e&&"function"==typeof e.then}function A(e){return E(e)?e:Promise.resolve(e)}function E(e){return e&&"object"==typeof e&&"then"in e&&"function"==typeof e.then}function R(e){var t,r,i,a,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,s=null,l=function l(){for(var u=arguments.length,f=new Array(u),p=0;p<u;p++)f[p]=arguments[p];if(t){r=f,a&&a.reject(d()),a=x();var b=Object(c.d)(a.promise);if(s){var v=s;s=null,v.abort()}return b}if(i=a||x(),a=null,o>0){var m=h(),y=t=A(e.apply(void 0,f.concat([m.signal])));M(o).then((function(){t===y&&(a?m.abort():s=m)}))}else t=1,t=A(e.apply(void 0,f));var g=function(){var e=r;r=i=t=s=null,null!=e&&l.apply(void 0,Object(n.a)(e))},O=t,j=i;return O.then(g,g),O.then(j.resolve,j.reject),Object(c.d)(j.promise)};return l}function I(){var e,t,r=new Promise((function(r,n){e=r,t=n})),n=function(t){e(t)};return n.resolve=function(t){return e(t)},n.reject=function(e){return t(e)},n.timeout=function(e,t){return i.a.setTimeout((function(){return n.reject(t)}),e)},n.promise=r,n}function D(e,t){return e.then(t,t)}function F(e){var t=h(),r=e(t.signal),n={promise:r,finished:!1,abort:function(){t&&(t.abort(),t=null)}},i=function(){n&&(n.finished=!0,n=null),t=null};return r.then(i,i),n}},function(e,t,r){"use strict";r.d(t,"a",(function(){return s})),r.d(t,"b",(function(){return c}));var n=r(13),i=r(2),a=r(5),o=r(20),s=function(){function e(){Object(i.a)(this,e),this._key="",this._keyDirty=!1,this._parameterBits=this._parameterBits.map((function(){return 0}))}return Object(a.a)(e,[{key:"key",get:function(){return this._keyDirty&&(this._keyDirty=!1,this._key=String.fromCharCode.apply(String,this._parameterBits)),this._key}},{key:"snapshot",value:function(){var e,t=this._parameterNames,r={key:this.key},i=Object(n.a)(t);try{for(i.s();!(e=i.n()).done;){var a=e.value;r[a]=this[a]}}catch(o){i.e(o)}finally{i.f()}return r}}]),e}();function c(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(t,r){var n,i;t._parameterNames=null!=(n=t._parameterNames)?n:[],t._parameterNames.push(r);for(var a=t._parameterNames.length-1,s=e.count||2,c=Math.ceil(Object(o.n)(s)),l=null!=(i=t._parameterBits)?i:[0],u=0;l[u]+c>16;)++u>=l.length&&l.push(0);t._parameterBits=l;var d=l[u],h=(1<<c)-1<<d;l[u]+=c,Object.defineProperty(t,r,{get:function(){return this[a]},set:function(e){if(this[a]!==e&&(this[a]=e,this._keyDirty=!0,this._parameterBits[u]=this._parameterBits[u]&~h|+e<<d&h,"number"!=typeof e&&"boolean"!=typeof e))throw"Configuration value for "+r+" must be boolean or number, got "+typeof e}})}}},function(e,t,r){"use strict";r.d(t,"a",(function(){return o})),r.d(t,"b",(function(){return s})),r.d(t,"c",(function(){return a}));var n=r(13),i=(r(17),r(94));function a(e,t){var r;if(t)for(r in e)e.hasOwnProperty(r)&&(void 0===e[r]?delete e[r]:e[r]instanceof Object&&a(e[r],!0));else for(r in e)e.hasOwnProperty(r)&&void 0===e[r]&&delete e[r];return e}function o(e){if(!e||"object"!=typeof e||"function"==typeof e)return e;if(Object(i.h)(e)||Object(i.k)(e)||Object(i.l)(e)||Object(i.f)(e)||Object(i.i)(e)||Object(i.g)(e)||Object(i.j)(e)||Object(i.d)(e)||Object(i.e)(e))return Object(i.m)(e);if(e instanceof Date)return new Date(e.getTime());if(e instanceof ArrayBuffer)return e.slice(0,e.byteLength);if(e instanceof Map){var t=new Map;return e.forEach((function(e,r){t.set(r,o(e))})),t}if(e instanceof Set){var r=new Set;return e.forEach((function(e){r.add(o(e))})),r}var a,s=e;if("function"==typeof s.clone)a=s.clone();else if("function"==typeof s.map&&"function"==typeof s.forEach)a=s.map(o);else if("function"==typeof s.notifyChange&&"function"==typeof s.watch)a=s.clone();else{a={};var c,l=Object(n.a)(Object.getOwnPropertyNames(e));try{for(l.s();!(c=l.n()).done;){var u=c.value;a[u]=o(e[u])}}catch(d){l.e(d)}finally{l.f()}}return a}function s(e,t){return e===t||"number"==typeof e&&isNaN(e)&&"number"==typeof t&&isNaN(t)||"function"==typeof(e||{}).getTime&&"function"==typeof(t||{}).getTime&&e.getTime()===t.getTime()||!1}},function(e,t,r){"use strict";r.d(t,"a",(function(){return l})),r.d(t,"b",(function(){return p})),r.d(t,"c",(function(){return f})),r.d(t,"d",(function(){return a})),r.d(t,"e",(function(){return c})),r.d(t,"f",(function(){return M})),r.d(t,"g",(function(){return C})),r.d(t,"h",(function(){return o})),r.d(t,"i",(function(){return s})),r.d(t,"j",(function(){return b})),r.d(t,"k",(function(){return x})),r.d(t,"l",(function(){return S})),r.d(t,"m",(function(){return u})),r.d(t,"n",(function(){return g})),r.d(t,"o",(function(){return k})),r.d(t,"p",(function(){return P})),r.d(t,"q",(function(){return m})),r.d(t,"r",(function(){return v})),r.d(t,"s",(function(){return h})),r.d(t,"t",(function(){return d})),r.d(t,"u",(function(){return _})),r.d(t,"v",(function(){return y})),r.d(t,"w",(function(){return w}));var n=r(9),i=r(63);function a(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function o(e,t,r,n,i,a,o,s,c,l,u,d,h,f,p,b,v){return e[0]=t,e[1]=r,e[2]=n,e[3]=i,e[4]=a,e[5]=o,e[6]=s,e[7]=c,e[8]=l,e[9]=u,e[10]=d,e[11]=h,e[12]=f,e[13]=p,e[14]=b,e[15]=v,e}function s(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function c(e,t){if(e===t){var r=t[1],n=t[2],i=t[3],a=t[6],o=t[7],s=t[11];e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=r,e[6]=t[9],e[7]=t[13],e[8]=n,e[9]=a,e[11]=t[14],e[12]=i,e[13]=o,e[14]=s}else e[0]=t[0],e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=t[1],e[5]=t[5],e[6]=t[9],e[7]=t[13],e[8]=t[2],e[9]=t[6],e[10]=t[10],e[11]=t[14],e[12]=t[3],e[13]=t[7],e[14]=t[11],e[15]=t[15];return e}function l(e,t){var r=t[0],n=t[1],i=t[2],a=t[3],o=t[4],s=t[5],c=t[6],l=t[7],u=t[8],d=t[9],h=t[10],f=t[11],p=t[12],b=t[13],v=t[14],m=t[15],y=r*s-n*o,g=r*c-i*o,O=r*l-a*o,j=n*c-i*s,_=n*l-a*s,w=i*l-a*c,x=u*b-d*p,k=u*v-h*p,S=u*m-f*p,T=d*v-h*b,C=d*m-f*b,M=h*m-f*v,P=y*M-g*C+O*T+j*S-_*k+w*x;return P?(P=1/P,e[0]=(s*M-c*C+l*T)*P,e[1]=(i*C-n*M-a*T)*P,e[2]=(b*w-v*_+m*j)*P,e[3]=(h*_-d*w-f*j)*P,e[4]=(c*S-o*M-l*k)*P,e[5]=(r*M-i*S+a*k)*P,e[6]=(v*O-p*w-m*g)*P,e[7]=(u*w-h*O+f*g)*P,e[8]=(o*C-s*S+l*x)*P,e[9]=(n*S-r*C-a*x)*P,e[10]=(p*_-b*O+m*y)*P,e[11]=(d*O-u*_-f*y)*P,e[12]=(s*k-o*T-c*x)*P,e[13]=(r*T-n*k+i*x)*P,e[14]=(b*g-p*j-v*y)*P,e[15]=(u*j-d*g+h*y)*P,e):null}function u(e,t,r){var n=t[0],i=t[1],a=t[2],o=t[3],s=t[4],c=t[5],l=t[6],u=t[7],d=t[8],h=t[9],f=t[10],p=t[11],b=t[12],v=t[13],m=t[14],y=t[15],g=r[0],O=r[1],j=r[2],_=r[3];return e[0]=g*n+O*s+j*d+_*b,e[1]=g*i+O*c+j*h+_*v,e[2]=g*a+O*l+j*f+_*m,e[3]=g*o+O*u+j*p+_*y,g=r[4],O=r[5],j=r[6],_=r[7],e[4]=g*n+O*s+j*d+_*b,e[5]=g*i+O*c+j*h+_*v,e[6]=g*a+O*l+j*f+_*m,e[7]=g*o+O*u+j*p+_*y,g=r[8],O=r[9],j=r[10],_=r[11],e[8]=g*n+O*s+j*d+_*b,e[9]=g*i+O*c+j*h+_*v,e[10]=g*a+O*l+j*f+_*m,e[11]=g*o+O*u+j*p+_*y,g=r[12],O=r[13],j=r[14],_=r[15],e[12]=g*n+O*s+j*d+_*b,e[13]=g*i+O*c+j*h+_*v,e[14]=g*a+O*l+j*f+_*m,e[15]=g*o+O*u+j*p+_*y,e}function d(e,t,r){var n,i,a,o,s,c,l,u,d,h,f,p,b=r[0],v=r[1],m=r[2];return t===e?(e[12]=t[0]*b+t[4]*v+t[8]*m+t[12],e[13]=t[1]*b+t[5]*v+t[9]*m+t[13],e[14]=t[2]*b+t[6]*v+t[10]*m+t[14],e[15]=t[3]*b+t[7]*v+t[11]*m+t[15]):(n=t[0],i=t[1],a=t[2],o=t[3],s=t[4],c=t[5],l=t[6],u=t[7],d=t[8],h=t[9],f=t[10],p=t[11],e[0]=n,e[1]=i,e[2]=a,e[3]=o,e[4]=s,e[5]=c,e[6]=l,e[7]=u,e[8]=d,e[9]=h,e[10]=f,e[11]=p,e[12]=n*b+s*v+d*m+t[12],e[13]=i*b+c*v+h*m+t[13],e[14]=a*b+l*v+f*m+t[14],e[15]=o*b+u*v+p*m+t[15]),e}function h(e,t,r){var n=r[0],i=r[1],a=r[2];return e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e[3]=t[3]*n,e[4]=t[4]*i,e[5]=t[5]*i,e[6]=t[6]*i,e[7]=t[7]*i,e[8]=t[8]*a,e[9]=t[9]*a,e[10]=t[10]*a,e[11]=t[11]*a,e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function f(e,t,r,n){var a,o,s,c,l,u,d,h,f,p,b,v,m,y,g,O,j,_,w,x,k,S,T,C,M=n[0],P=n[1],A=n[2],E=Math.sqrt(M*M+P*P+A*A);return E<i.a?null:(M*=E=1/E,P*=E,A*=E,a=Math.sin(r),s=1-(o=Math.cos(r)),c=t[0],l=t[1],u=t[2],d=t[3],h=t[4],f=t[5],p=t[6],b=t[7],v=t[8],m=t[9],y=t[10],g=t[11],O=M*M*s+o,j=P*M*s+A*a,_=A*M*s-P*a,w=M*P*s-A*a,x=P*P*s+o,k=A*P*s+M*a,S=M*A*s+P*a,T=P*A*s-M*a,C=A*A*s+o,e[0]=c*O+h*j+v*_,e[1]=l*O+f*j+m*_,e[2]=u*O+p*j+y*_,e[3]=d*O+b*j+g*_,e[4]=c*w+h*x+v*k,e[5]=l*w+f*x+m*k,e[6]=u*w+p*x+y*k,e[7]=d*w+b*x+g*k,e[8]=c*S+h*T+v*C,e[9]=l*S+f*T+m*C,e[10]=u*S+p*T+y*C,e[11]=d*S+b*T+g*C,t!==e&&(e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e)}function p(e,t,r){var n=Math.sin(r),i=Math.cos(r),a=t[4],o=t[5],s=t[6],c=t[7],l=t[8],u=t[9],d=t[10],h=t[11];return t!==e&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[4]=a*i+l*n,e[5]=o*i+u*n,e[6]=s*i+d*n,e[7]=c*i+h*n,e[8]=l*i-a*n,e[9]=u*i-o*n,e[10]=d*i-s*n,e[11]=h*i-c*n,e}function b(e,t,r){var n=Math.sin(r),i=Math.cos(r),a=t[0],o=t[1],s=t[2],c=t[3],l=t[8],u=t[9],d=t[10],h=t[11];return t!==e&&(e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=a*i-l*n,e[1]=o*i-u*n,e[2]=s*i-d*n,e[3]=c*i-h*n,e[8]=a*n+l*i,e[9]=o*n+u*i,e[10]=s*n+d*i,e[11]=c*n+h*i,e}function v(e,t,r){var n=Math.sin(r),i=Math.cos(r),a=t[0],o=t[1],s=t[2],c=t[3],l=t[4],u=t[5],d=t[6],h=t[7];return t!==e&&(e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=a*i+l*n,e[1]=o*i+u*n,e[2]=s*i+d*n,e[3]=c*i+h*n,e[4]=l*i-a*n,e[5]=u*i-o*n,e[6]=d*i-s*n,e[7]=h*i-c*n,e}function m(e,t){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=t[0],e[13]=t[1],e[14]=t[2],e[15]=1,e}function y(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=t[1],e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=t[2],e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function g(e,t){var r=Math.sin(t),n=Math.cos(t);return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=n,e[6]=r,e[7]=0,e[8]=0,e[9]=-r,e[10]=n,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function O(e,t,r){var n=t[0],i=t[1],a=t[2],o=t[3],s=n+n,c=i+i,l=a+a,u=n*s,d=n*c,h=n*l,f=i*c,p=i*l,b=a*l,v=o*s,m=o*c,y=o*l;return e[0]=1-(f+b),e[1]=d+y,e[2]=h-m,e[3]=0,e[4]=d-y,e[5]=1-(u+b),e[6]=p+v,e[7]=0,e[8]=h+m,e[9]=p-v,e[10]=1-(u+f),e[11]=0,e[12]=r[0],e[13]=r[1],e[14]=r[2],e[15]=1,e}var j=Object(n.e)();function _(e,t){return e[0]=t[12],e[1]=t[13],e[2]=t[14],e}function w(e,t){var r=t[0],n=t[1],i=t[2],a=t[3],o=r+r,s=n+n,c=i+i,l=r*o,u=n*o,d=n*s,h=i*o,f=i*s,p=i*c,b=a*o,v=a*s,m=a*c;return e[0]=1-d-p,e[1]=u+m,e[2]=h-v,e[3]=0,e[4]=u-m,e[5]=1-l-p,e[6]=f+b,e[7]=0,e[8]=h+v,e[9]=f-b,e[10]=1-l-d,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function x(e,t,r,n,i,a,o){var s=1/(r-t),c=1/(i-n),l=1/(a-o);return e[0]=2*a*s,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=2*a*c,e[6]=0,e[7]=0,e[8]=(r+t)*s,e[9]=(i+n)*c,e[10]=(o+a)*l,e[11]=-1,e[12]=0,e[13]=0,e[14]=o*a*2*l,e[15]=0,e}function k(e,t,r,n,i,a,o){var s=1/(t-r),c=1/(n-i),l=1/(a-o);return e[0]=-2*s,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*c,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*l,e[11]=0,e[12]=(t+r)*s,e[13]=(i+n)*c,e[14]=(o+a)*l,e[15]=1,e}function S(e,t,r,n){var a,o,c,l,u,d,h,f,p,b,v=t[0],m=t[1],y=t[2],g=n[0],O=n[1],j=n[2],_=r[0],w=r[1],x=r[2];return Math.abs(v-_)<i.a&&Math.abs(m-w)<i.a&&Math.abs(y-x)<i.a?s(e):(h=v-_,f=m-w,p=y-x,a=O*(p*=b=1/Math.sqrt(h*h+f*f+p*p))-j*(f*=b),o=j*(h*=b)-g*p,c=g*f-O*h,(b=Math.sqrt(a*a+o*o+c*c))?(a*=b=1/b,o*=b,c*=b):(a=0,o=0,c=0),l=f*c-p*o,u=p*a-h*c,d=h*o-f*a,(b=Math.sqrt(l*l+u*u+d*d))?(l*=b=1/b,u*=b,d*=b):(l=0,u=0,d=0),e[0]=a,e[1]=l,e[2]=h,e[3]=0,e[4]=o,e[5]=u,e[6]=f,e[7]=0,e[8]=c,e[9]=d,e[10]=p,e[11]=0,e[12]=-(a*v+o*m+c*y),e[13]=-(l*v+u*m+d*y),e[14]=-(h*v+f*m+p*y),e[15]=1,e)}function T(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e[2]=t[2]-r[2],e[3]=t[3]-r[3],e[4]=t[4]-r[4],e[5]=t[5]-r[5],e[6]=t[6]-r[6],e[7]=t[7]-r[7],e[8]=t[8]-r[8],e[9]=t[9]-r[9],e[10]=t[10]-r[10],e[11]=t[11]-r[11],e[12]=t[12]-r[12],e[13]=t[13]-r[13],e[14]=t[14]-r[14],e[15]=t[15]-r[15],e}function C(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&e[4]===t[4]&&e[5]===t[5]&&e[6]===t[6]&&e[7]===t[7]&&e[8]===t[8]&&e[9]===t[9]&&e[10]===t[10]&&e[11]===t[11]&&e[12]===t[12]&&e[13]===t[13]&&e[14]===t[14]&&e[15]===t[15]}function M(e,t){var r=e[0],n=e[1],a=e[2],o=e[3],s=e[4],c=e[5],l=e[6],u=e[7],d=e[8],h=e[9],f=e[10],p=e[11],b=e[12],v=e[13],m=e[14],y=e[15],g=t[0],O=t[1],j=t[2],_=t[3],w=t[4],x=t[5],k=t[6],S=t[7],T=t[8],C=t[9],M=t[10],P=t[11],A=t[12],E=t[13],R=t[14],I=t[15];return Math.abs(r-g)<=i.a*Math.max(1,Math.abs(r),Math.abs(g))&&Math.abs(n-O)<=i.a*Math.max(1,Math.abs(n),Math.abs(O))&&Math.abs(a-j)<=i.a*Math.max(1,Math.abs(a),Math.abs(j))&&Math.abs(o-_)<=i.a*Math.max(1,Math.abs(o),Math.abs(_))&&Math.abs(s-w)<=i.a*Math.max(1,Math.abs(s),Math.abs(w))&&Math.abs(c-x)<=i.a*Math.max(1,Math.abs(c),Math.abs(x))&&Math.abs(l-k)<=i.a*Math.max(1,Math.abs(l),Math.abs(k))&&Math.abs(u-S)<=i.a*Math.max(1,Math.abs(u),Math.abs(S))&&Math.abs(d-T)<=i.a*Math.max(1,Math.abs(d),Math.abs(T))&&Math.abs(h-C)<=i.a*Math.max(1,Math.abs(h),Math.abs(C))&&Math.abs(f-M)<=i.a*Math.max(1,Math.abs(f),Math.abs(M))&&Math.abs(p-P)<=i.a*Math.max(1,Math.abs(p),Math.abs(P))&&Math.abs(b-A)<=i.a*Math.max(1,Math.abs(b),Math.abs(A))&&Math.abs(v-E)<=i.a*Math.max(1,Math.abs(v),Math.abs(E))&&Math.abs(m-R)<=i.a*Math.max(1,Math.abs(m),Math.abs(R))&&Math.abs(y-I)<=i.a*Math.max(1,Math.abs(y),Math.abs(I))}function P(e){var t=i.a,r=e[0],n=e[1],a=e[2],o=e[4],s=e[5],c=e[6],l=e[8],u=e[9],d=e[10];return Math.abs(1-(r*r+o*o+l*l))<=t&&Math.abs(1-(n*n+s*s+u*u))<=t&&Math.abs(1-(a*a+c*c+d*d))<=t}var A=u,E=T;Object.freeze({__proto__:null,copy:a,set:o,identity:s,transpose:c,invert:l,adjoint:function(e,t){var r=t[0],n=t[1],i=t[2],a=t[3],o=t[4],s=t[5],c=t[6],l=t[7],u=t[8],d=t[9],h=t[10],f=t[11],p=t[12],b=t[13],v=t[14],m=t[15];return e[0]=s*(h*m-f*v)-d*(c*m-l*v)+b*(c*f-l*h),e[1]=-(n*(h*m-f*v)-d*(i*m-a*v)+b*(i*f-a*h)),e[2]=n*(c*m-l*v)-s*(i*m-a*v)+b*(i*l-a*c),e[3]=-(n*(c*f-l*h)-s*(i*f-a*h)+d*(i*l-a*c)),e[4]=-(o*(h*m-f*v)-u*(c*m-l*v)+p*(c*f-l*h)),e[5]=r*(h*m-f*v)-u*(i*m-a*v)+p*(i*f-a*h),e[6]=-(r*(c*m-l*v)-o*(i*m-a*v)+p*(i*l-a*c)),e[7]=r*(c*f-l*h)-o*(i*f-a*h)+u*(i*l-a*c),e[8]=o*(d*m-f*b)-u*(s*m-l*b)+p*(s*f-l*d),e[9]=-(r*(d*m-f*b)-u*(n*m-a*b)+p*(n*f-a*d)),e[10]=r*(s*m-l*b)-o*(n*m-a*b)+p*(n*l-a*s),e[11]=-(r*(s*f-l*d)-o*(n*f-a*d)+u*(n*l-a*s)),e[12]=-(o*(d*v-h*b)-u*(s*v-c*b)+p*(s*h-c*d)),e[13]=r*(d*v-h*b)-u*(n*v-i*b)+p*(n*h-i*d),e[14]=-(r*(s*v-c*b)-o*(n*v-i*b)+p*(n*c-i*s)),e[15]=r*(s*h-c*d)-o*(n*h-i*d)+u*(n*c-i*s),e},determinant:function(e){var t=e[0],r=e[1],n=e[2],i=e[3],a=e[4],o=e[5],s=e[6],c=e[7],l=e[8],u=e[9],d=e[10],h=e[11],f=e[12],p=e[13],b=e[14],v=e[15];return(t*o-r*a)*(d*v-h*b)-(t*s-n*a)*(u*v-h*p)+(t*c-i*a)*(u*b-d*p)+(r*s-n*o)*(l*v-h*f)-(r*c-i*o)*(l*b-d*f)+(n*c-i*s)*(l*p-u*f)},multiply:u,translate:d,scale:h,rotate:f,rotateX:p,rotateY:b,rotateZ:v,fromTranslation:m,fromScaling:y,fromRotation:function(e,t,r){var n,a,o,s=r[0],c=r[1],l=r[2],u=Math.sqrt(s*s+c*c+l*l);return u<i.a?null:(s*=u=1/u,c*=u,l*=u,n=Math.sin(t),o=1-(a=Math.cos(t)),e[0]=s*s*o+a,e[1]=c*s*o+l*n,e[2]=l*s*o-c*n,e[3]=0,e[4]=s*c*o-l*n,e[5]=c*c*o+a,e[6]=l*c*o+s*n,e[7]=0,e[8]=s*l*o+c*n,e[9]=c*l*o-s*n,e[10]=l*l*o+a,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e)},fromXRotation:g,fromYRotation:function(e,t){var r=Math.sin(t),n=Math.cos(t);return e[0]=n,e[1]=0,e[2]=-r,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=r,e[9]=0,e[10]=n,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},fromZRotation:function(e,t){var r=Math.sin(t),n=Math.cos(t);return e[0]=n,e[1]=r,e[2]=0,e[3]=0,e[4]=-r,e[5]=n,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},fromRotationTranslation:O,fromQuat2:function(e,t){var r=j,n=-t[0],i=-t[1],a=-t[2],o=t[3],s=t[4],c=t[5],l=t[6],u=t[7],d=n*n+i*i+a*a+o*o;return d>0?(r[0]=2*(s*o+u*n+c*a-l*i)/d,r[1]=2*(c*o+u*i+l*n-s*a)/d,r[2]=2*(l*o+u*a+s*i-c*n)/d):(r[0]=2*(s*o+u*n+c*a-l*i),r[1]=2*(c*o+u*i+l*n-s*a),r[2]=2*(l*o+u*a+s*i-c*n)),O(e,t,r),e},getTranslation:_,getScaling:function(e,t){var r=t[0],n=t[1],i=t[2],a=t[4],o=t[5],s=t[6],c=t[8],l=t[9],u=t[10];return e[0]=Math.sqrt(r*r+n*n+i*i),e[1]=Math.sqrt(a*a+o*o+s*s),e[2]=Math.sqrt(c*c+l*l+u*u),e},getRotation:function(e,t){var r=t[0]+t[5]+t[10],n=0;return r>0?(n=2*Math.sqrt(r+1),e[3]=.25*n,e[0]=(t[6]-t[9])/n,e[1]=(t[8]-t[2])/n,e[2]=(t[1]-t[4])/n):t[0]>t[5]&&t[0]>t[10]?(n=2*Math.sqrt(1+t[0]-t[5]-t[10]),e[3]=(t[6]-t[9])/n,e[0]=.25*n,e[1]=(t[1]+t[4])/n,e[2]=(t[8]+t[2])/n):t[5]>t[10]?(n=2*Math.sqrt(1+t[5]-t[0]-t[10]),e[3]=(t[8]-t[2])/n,e[0]=(t[1]+t[4])/n,e[1]=.25*n,e[2]=(t[6]+t[9])/n):(n=2*Math.sqrt(1+t[10]-t[0]-t[5]),e[3]=(t[1]-t[4])/n,e[0]=(t[8]+t[2])/n,e[1]=(t[6]+t[9])/n,e[2]=.25*n),e},fromRotationTranslationScale:function(e,t,r,n){var i=t[0],a=t[1],o=t[2],s=t[3],c=i+i,l=a+a,u=o+o,d=i*c,h=i*l,f=i*u,p=a*l,b=a*u,v=o*u,m=s*c,y=s*l,g=s*u,O=n[0],j=n[1],_=n[2];return e[0]=(1-(p+v))*O,e[1]=(h+g)*O,e[2]=(f-y)*O,e[3]=0,e[4]=(h-g)*j,e[5]=(1-(d+v))*j,e[6]=(b+m)*j,e[7]=0,e[8]=(f+y)*_,e[9]=(b-m)*_,e[10]=(1-(d+p))*_,e[11]=0,e[12]=r[0],e[13]=r[1],e[14]=r[2],e[15]=1,e},fromRotationTranslationScaleOrigin:function(e,t,r,n,i){var a=t[0],o=t[1],s=t[2],c=t[3],l=a+a,u=o+o,d=s+s,h=a*l,f=a*u,p=a*d,b=o*u,v=o*d,m=s*d,y=c*l,g=c*u,O=c*d,j=n[0],_=n[1],w=n[2],x=i[0],k=i[1],S=i[2],T=(1-(b+m))*j,C=(f+O)*j,M=(p-g)*j,P=(f-O)*_,A=(1-(h+m))*_,E=(v+y)*_,R=(p+g)*w,I=(v-y)*w,D=(1-(h+b))*w;return e[0]=T,e[1]=C,e[2]=M,e[3]=0,e[4]=P,e[5]=A,e[6]=E,e[7]=0,e[8]=R,e[9]=I,e[10]=D,e[11]=0,e[12]=r[0]+x-(T*x+P*k+R*S),e[13]=r[1]+k-(C*x+A*k+I*S),e[14]=r[2]+S-(M*x+E*k+D*S),e[15]=1,e},fromQuat:w,frustum:x,perspective:function(e,t,r,n,i){var a,o=1/Math.tan(t/2);return e[0]=o/r,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=o,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,null!=i&&i!==1/0?(a=1/(n-i),e[10]=(i+n)*a,e[14]=2*i*n*a):(e[10]=-1,e[14]=-2*n),e},perspectiveFromFieldOfView:function(e,t,r,n){var i=Math.tan(t.upDegrees*Math.PI/180),a=Math.tan(t.downDegrees*Math.PI/180),o=Math.tan(t.leftDegrees*Math.PI/180),s=Math.tan(t.rightDegrees*Math.PI/180),c=2/(o+s),l=2/(i+a);return e[0]=c,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=l,e[6]=0,e[7]=0,e[8]=-(o-s)*c*.5,e[9]=(i-a)*l*.5,e[10]=n/(r-n),e[11]=-1,e[12]=0,e[13]=0,e[14]=n*r/(r-n),e[15]=0,e},ortho:k,lookAt:S,targetTo:function(e,t,r,n){var i=t[0],a=t[1],o=t[2],s=n[0],c=n[1],l=n[2],u=i-r[0],d=a-r[1],h=o-r[2],f=u*u+d*d+h*h;f>0&&(u*=f=1/Math.sqrt(f),d*=f,h*=f);var p=c*h-l*d,b=l*u-s*h,v=s*d-c*u;return(f=p*p+b*b+v*v)>0&&(p*=f=1/Math.sqrt(f),b*=f,v*=f),e[0]=p,e[1]=b,e[2]=v,e[3]=0,e[4]=d*v-h*b,e[5]=h*p-u*v,e[6]=u*b-d*p,e[7]=0,e[8]=u,e[9]=d,e[10]=h,e[11]=0,e[12]=i,e[13]=a,e[14]=o,e[15]=1,e},str:function(e){return"mat4("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+", "+e[8]+", "+e[9]+", "+e[10]+", "+e[11]+", "+e[12]+", "+e[13]+", "+e[14]+", "+e[15]+")"},frob:function(e){return Math.sqrt(Math.pow(e[0],2)+Math.pow(e[1],2)+Math.pow(e[2],2)+Math.pow(e[3],2)+Math.pow(e[4],2)+Math.pow(e[5],2)+Math.pow(e[6],2)+Math.pow(e[7],2)+Math.pow(e[8],2)+Math.pow(e[9],2)+Math.pow(e[10],2)+Math.pow(e[11],2)+Math.pow(e[12],2)+Math.pow(e[13],2)+Math.pow(e[14],2)+Math.pow(e[15],2))},add:function(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e[3]=t[3]+r[3],e[4]=t[4]+r[4],e[5]=t[5]+r[5],e[6]=t[6]+r[6],e[7]=t[7]+r[7],e[8]=t[8]+r[8],e[9]=t[9]+r[9],e[10]=t[10]+r[10],e[11]=t[11]+r[11],e[12]=t[12]+r[12],e[13]=t[13]+r[13],e[14]=t[14]+r[14],e[15]=t[15]+r[15],e},subtract:T,multiplyScalar:function(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e[4]=t[4]*r,e[5]=t[5]*r,e[6]=t[6]*r,e[7]=t[7]*r,e[8]=t[8]*r,e[9]=t[9]*r,e[10]=t[10]*r,e[11]=t[11]*r,e[12]=t[12]*r,e[13]=t[13]*r,e[14]=t[14]*r,e[15]=t[15]*r,e},multiplyScalarAndAdd:function(e,t,r,n){return e[0]=t[0]+r[0]*n,e[1]=t[1]+r[1]*n,e[2]=t[2]+r[2]*n,e[3]=t[3]+r[3]*n,e[4]=t[4]+r[4]*n,e[5]=t[5]+r[5]*n,e[6]=t[6]+r[6]*n,e[7]=t[7]+r[7]*n,e[8]=t[8]+r[8]*n,e[9]=t[9]+r[9]*n,e[10]=t[10]+r[10]*n,e[11]=t[11]+r[11]*n,e[12]=t[12]+r[12]*n,e[13]=t[13]+r[13]*n,e[14]=t[14]+r[14]*n,e[15]=t[15]+r[15]*n,e},exactEquals:C,equals:M,isOrthoNormal:P,mul:A,sub:E})},function(e,t,r){"use strict";r.d(t,"a",(function(){return p})),r.d(t,"b",(function(){return h}));var n=r(2),i=r(5),a=r(6),o=r(7),s=r(0),c=r(30),l=r(393),u=r(385),d=r(10),h=function(e){var t=function(e){Object(a.a)(r,e);var t=Object(o.a)(r);function r(){Object(n.a)(this,r);for(var e=arguments.length,i=new Array(e),a=0;a<e;a++)i[a]=arguments[a];return t.call.apply(t,[this].concat(i))}return Object(i.a)(r,[{key:"read",value:function(e,t){Object(l.a)(this,e,t)}},{key:"write",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;return Object(u.b)(this,e,t)}},{key:"toJSON",value:function(e){return this.write({},e)}}],[{key:"fromJSON",value:function(e,t){return f.call(this,e,t)}}]),r}(e);return t=Object(s.a)([Object(d.a)("esri.core.JSONSupport")],t),t.prototype.toJSON.isDefaultToJSON=!0,t};function f(e,t){if(!e)return null;if(e.declaredClass)throw new Error("JSON object is already hydrated");var r=new this;return r.read(e,t),r}var p=function(e){Object(a.a)(r,e);var t=Object(o.a)(r);function r(){return Object(n.a)(this,r),t.apply(this,arguments)}return r}(h(c.a));p=Object(s.a)([Object(d.a)("esri.core.JSONSupport")],p)},function(e,t,r){"use strict";r.d(t,"a",(function(){return d})),r.d(t,"b",(function(){return h})),r.d(t,"c",(function(){return l})),r.d(t,"d",(function(){return u})),r.d(t,"e",(function(){return s})),r.d(t,"f",(function(){return c})),r.d(t,"g",(function(){return i})),r.d(t,"h",(function(){return a})),r.d(t,"i",(function(){return f})),r.d(t,"j",(function(){return o}));var n=/^-?(\d+(\.\d+)?)\s*((px)|(pt))?$/i;function i(e){return e?e/72*96:0}function a(e){return e?72*e/96:0}function o(e){if("string"==typeof e){if(n.test(e)){var t=e.match(n),r=Number(t[1]),i=t[3]&&t[3].toLowerCase(),o="-"===e.charAt(0),s="px"===i?a(r):r;return o?-s:s}return console.warn("screenUtils.toPt: input not recognized!"),null}return e}function s(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return{x:e,y:t}}function c(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return[e,t]}function l(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return[e,t]}function u(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return[e,t,r]}function d(e){return e}function h(e){return e}function f(e,t){return t?(t[0]=e.x,t[1]=e.y,t.length>2&&(t[2]=0),t):[e.x,e.y]}},function(e,t,r){"use strict";r.d(t,"a",(function(){return s})),r.d(t,"b",(function(){return u})),r.d(t,"c",(function(){return i})),r.d(t,"d",(function(){return h})),r.d(t,"e",(function(){return S})),r.d(t,"f",(function(){return m})),r.d(t,"g",(function(){return g})),r.d(t,"h",(function(){return y})),r.d(t,"i",(function(){return o})),r.d(t,"j",(function(){return f})),r.d(t,"k",(function(){return x})),r.d(t,"l",(function(){return p})),r.d(t,"m",(function(){return O})),r.d(t,"n",(function(){return v})),r.d(t,"o",(function(){return j})),r.d(t,"p",(function(){return d})),r.d(t,"q",(function(){return w})),r.d(t,"r",(function(){return a})),r.d(t,"s",(function(){return _}));var n=r(63);function i(e,t){return e[0]=t[0],e[1]=t[1],e}function a(e,t,r){return e[0]=t,e[1]=r,e}function o(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e}function s(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e}function c(e,t,r){return e[0]=t[0]*r[0],e[1]=t[1]*r[1],e}function l(e,t,r){return e[0]=t[0]/r[0],e[1]=t[1]/r[1],e}function u(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e}function d(e,t,r,n){return e[0]=t[0]+r[0]*n,e[1]=t[1]+r[1]*n,e}function h(e,t){var r=t[0]-e[0],n=t[1]-e[1];return Math.sqrt(r*r+n*n)}function f(e,t){var r=t[0]-e[0],n=t[1]-e[1];return r*r+n*n}function p(e){var t=e[0],r=e[1];return Math.sqrt(t*t+r*r)}function b(e){var t=e[0],r=e[1];return t*t+r*r}function v(e,t){return e[0]=-t[0],e[1]=-t[1],e}function m(e,t){var r=t[0],n=t[1],i=r*r+n*n;return i>0&&(i=1/Math.sqrt(i),e[0]=t[0]*i,e[1]=t[1]*i),e}function y(e,t){return e[0]*t[0]+e[1]*t[1]}function g(e,t,r){var n=t[0]*r[1]-t[1]*r[0];return e[0]=e[1]=0,e[2]=n,e}function O(e,t,r,n){var i=t[0],a=t[1];return e[0]=i+n*(r[0]-i),e[1]=a+n*(r[1]-a),e}function j(e,t,r){var n=t[0],i=t[1];return e[0]=r[0]*n+r[2]*i,e[1]=r[1]*n+r[3]*i,e}function _(e,t,r){var n=t[0],i=t[1];return e[0]=r[0]*n+r[2]*i+r[4],e[1]=r[1]*n+r[3]*i+r[5],e}function w(e,t,r,n){var i=t[0]-r[0],a=t[1]-r[1],o=Math.sin(n),s=Math.cos(n);return e[0]=i*s-a*o+r[0],e[1]=i*o+a*s+r[1],e}function x(e,t){return e[0]===t[0]&&e[1]===t[1]}var k=p,S=s,T=c,C=l,M=h,P=f,A=b;Object.freeze({__proto__:null,copy:i,set:a,add:o,subtract:s,multiply:c,divide:l,ceil:function(e,t){return e[0]=Math.ceil(t[0]),e[1]=Math.ceil(t[1]),e},floor:function(e,t){return e[0]=Math.floor(t[0]),e[1]=Math.floor(t[1]),e},min:function(e,t,r){return e[0]=Math.min(t[0],r[0]),e[1]=Math.min(t[1],r[1]),e},max:function(e,t,r){return e[0]=Math.max(t[0],r[0]),e[1]=Math.max(t[1],r[1]),e},round:function(e,t){return e[0]=Math.round(t[0]),e[1]=Math.round(t[1]),e},scale:u,scaleAndAdd:d,distance:h,squaredDistance:f,length:p,squaredLength:b,negate:v,inverse:function(e,t){return e[0]=1/t[0],e[1]=1/t[1],e},normalize:m,dot:y,cross:g,lerp:O,random:function(e,t){t=t||1;var r=2*Object(n.b)()*Math.PI;return e[0]=Math.cos(r)*t,e[1]=Math.sin(r)*t,e},transformMat2:j,transformMat2d:_,transformMat3:function(e,t,r){var n=t[0],i=t[1];return e[0]=r[0]*n+r[3]*i+r[6],e[1]=r[1]*n+r[4]*i+r[7],e},transformMat4:function(e,t,r){var n=t[0],i=t[1];return e[0]=r[0]*n+r[4]*i+r[12],e[1]=r[1]*n+r[5]*i+r[13],e},rotate:w,angle:function(e,t){var r=e[0],n=e[1],i=t[0],a=t[1],o=r*r+n*n;o>0&&(o=1/Math.sqrt(o));var s=i*i+a*a;s>0&&(s=1/Math.sqrt(s));var c=(r*i+n*a)*o*s;return c>1?0:c<-1?Math.PI:Math.acos(c)},str:function(e){return"vec2("+e[0]+", "+e[1]+")"},exactEquals:x,equals:function(e,t){var r=e[0],i=e[1],a=t[0],o=t[1];return Math.abs(r-a)<=n.a*Math.max(1,Math.abs(r),Math.abs(a))&&Math.abs(i-o)<=n.a*Math.max(1,Math.abs(i),Math.abs(o))},len:k,sub:S,mul:T,div:C,dist:M,sqrDist:P,sqrLen:A})},function(e,t,r){"use strict";var n=r(19),i=r(6),a=r(7),o=r(2),s=r(5),c=r(306),l=r(15),u=r(200),d=r(204),h=r(50),f=r(33),p=r(13),b=(r(17),r(25)),v=r(117),m=r(80),y=r(500),g=function(){function e(t,r,n){Object(o.a)(this,e),this.properties=t,this.propertyName=r,this.metadata=n,this._observers=null,this._accessed=null,this._handles=null,this.flags=1|(n.nonNullable?8:0)|(n.hasOwnProperty("value")?16:0)|(void 0===n.get?32:0)|(void 0===n.dependsOn?64:0)}return Object(s.a)(e,[{key:"destroy",value:function(){this._accessed=null,this._observers=null,this._clearObservationHandles()}},{key:"getComputed",value:function(){Object(m.c)(this);var e=this.properties.store,t=this.propertyName,r=this.flags,n=e.get(t);if(4&r)return n;if(1&~r&&e.has(t))return n;this.flags|=4;var i,a=this.properties.host;64&r?i=Object(m.b)(this,this.metadata.get,a):(Object(m.d)(a,this),i=this.metadata.get.call(a)),e.set(t,i,1);var o=e.get(t);return o===n?this.flags&=-2:this.commit(),this.flags&=-5,o}},{key:"onObservableAccessed",value:function(e){e!==this&&(null===this._accessed&&(this._accessed=[]),this._accessed.includes(e)||this._accessed.push(e))}},{key:"onTrackingEnd",value:function(){this._clearObservationHandles(),this.flags|=32;var e=this._accessed;if(null!==e){var t=this._handles;null===t&&(t=this._handles=[]);for(var r=0;r<e.length;++r)t.push(e[r].observe(this));e.length=0}}},{key:"observe",value:function(e){return null===this._observers&&(this._observers=[]),this._observers.includes(e)||this._observers.push(e),new y.a(this._observers,e)}},{key:"notifyChange",value:function(){this.onInvalidated(),this.onCommitted()}},{key:"invalidate",value:function(){this.onInvalidated()}},{key:"onInvalidated",value:function(){2&~this.flags&&(this.flags|=1);var e=this._observers;if(null!==e)for(var t=0;t<e.length;++t)e[t].onInvalidated()}},{key:"commit",value:function(){this.flags&=-2,this.onCommitted()}},{key:"onCommitted",value:function(){if(null!==this._observers)for(var e=this._observers.slice(),t=0;t<e.length;++t)e[t].onCommitted()}},{key:"_clearObservationHandles",value:function(){var e=this._handles;if(null!==e){for(var t=0;t<e.length;++t)e[t].remove();e.length=0}}}]),e}(),O=r(164),j=function(){function e(){Object(o.a)(this,e),this._values=new Map}return Object(s.a)(e,[{key:"clone",value:function(t){var r=new e;return this._values.forEach((function(e,n){t&&t.has(n)||r.set(n,Object(b.a)(e))})),r}},{key:"get",value:function(e){return this._values.get(e)}},{key:"originOf",value:function(){return 6}},{key:"keys",value:function(){return Object(h.a)(this._values.keys())}},{key:"set",value:function(e,t){this._values.set(e,t)}},{key:"delete",value:function(e){this._values.delete(e)}},{key:"has",value:function(e){return this._values.has(e)}},{key:"forEach",value:function(e){this._values.forEach(e)}}]),e}(),_=r(114);function w(e,t,r){return void 0!==e}function x(e,t,r,n){return void 0!==e&&(!(null==r&&8&e.flags)||(n.lifecycle,!1))}l.a.getLogger("esri.core.accessorSupport.Properties");var k=function(){function e(t){Object(o.a)(this,e),this.host=t,this.properties=new Map,this.ctorArgs=null,this.destroyed=!1,this.lifecycle=0,this.store=new j,this._origin=6;var r=this.host.constructor.__accessorMetadata__,n=r.properties;for(var i in n){var a=new g(this,i,n[i]);this.properties.set(i,a)}this.metadatas=n,this._autoDestroy=r.autoDestroy}return Object(s.a)(e,[{key:"initialize",value:function(){this.lifecycle=1}},{key:"constructed",value:function(){this.lifecycle=2}},{key:"destroy",value:function(){if(this.destroyed=!0,this._autoDestroy){var e,t=Object(p.a)(this.properties);try{for(t.s();!(e=t.n()).done;){var r=Object(f.a)(e.value,2),n=r[0],i=r[1],a=this.internalGet(n);a&&((l=a)&&"function"==typeof l.destroy)&&(a.destroy(),8&~i.flags&&this._internalSet(i,null)),i.destroy()}}catch(u){t.e(u)}finally{t.f()}}else{var o,s=Object(p.a)(this.properties);try{for(s.s();!(o=s.n()).done;){var c=Object(f.a)(o.value,2);c[0];c[1].destroy()}}catch(u){s.e(u)}finally{s.f()}}var l}},{key:"initialized",get:function(){return 0!==this.lifecycle}},{key:"get",value:function(e){var t=this.properties.get(e);if(t.metadata.get)return t.getComputed();Object(m.c)(t);var r=this.store;return r.has(e)?r.get(e):t.metadata.value}},{key:"originOf",value:function(e){var t=this.store.originOf(e);if(void 0===t){var r=this.properties.get(e);if(void 0!==r&&16&r.flags)return"defaults"}return Object(O.b)(t)}},{key:"has",value:function(e){return!!this.properties.has(e)&&this.store.has(e)}},{key:"keys",value:function(){return Object(h.a)(this.properties.keys())}},{key:"internalGet",value:function(e){var t=this.properties.get(e);if(w(t))return this.store.has(e)?this.store.get(e):t.metadata.value}},{key:"internalSet",value:function(e,t){var r=this.properties.get(e);w(r)&&this._internalSet(r,t)}},{key:"getDependsInfo",value:function(e,t,r){var n=this.properties.get(t);if(!w(n))return"";var i=new Set,a=Object(m.b)({onObservableAccessed:function(e){return i.add(e)},onTrackingEnd:function(){}},(function(){var t;return null==(t=n.metadata.get)?void 0:t.call(e)})),o="".concat(r).concat(e.declaredClass.split(".").pop(),".").concat(t,": ").concat(a,"\n");if(0===i.size)return o;r+="  ";var s,c=Object(p.a)(i);try{for(c.s();!(s=c.n()).done;){var l=s.value;if(l instanceof g){var u=l.properties.host,d=l.propertyName,h=Object(_.a)(u);o+=h?h.getDependsInfo(u,d,r):"".concat(r).concat(d,": undefined\n")}}}catch(f){c.e(f)}finally{c.f()}return o}},{key:"setAtOrigin",value:function(e,t,r){var n=this.properties.get(e);if(w(n))return this._setAtOrigin(n,t,r)}},{key:"isOverridden",value:function(e){var t=this.properties.get(e);return void 0!==t&&!!(2&t.flags)}},{key:"clearOverride",value:function(e){var t=this.properties.get(e);void 0!==t&&2&t.flags&&(t.flags&=-3,t.notifyChange())}},{key:"override",value:function(e,t){var r=this.properties.get(e);if(x(r,0,t,this)){var n=r.metadata.cast;if(n){var i=this._cast(n,t),a=i.valid,o=i.value;if(T.release(i),!a)return;t=o}r.flags|=2,this._internalSet(r,t)}}},{key:"set",value:function(e,t){var r=this.properties.get(e);if(x(r,0,t,this)){var n=r.metadata.cast;if(n){var i=this._cast(n,t),a=i.valid,o=i.value;if(T.release(i),!a)return;t=o}var s=r.metadata.set;s?s.call(this.host,t):this._internalSet(r,t)}}},{key:"setDefaultOrigin",value:function(e){this._origin=Object(O.d)(e)}},{key:"getDefaultOrigin",value:function(){return Object(O.b)(this._origin)}},{key:"notifyChange",value:function(e){var t=this.properties.get(e);void 0!==t&&t.notifyChange()}},{key:"invalidate",value:function(e){var t=this.properties.get(e);void 0!==t&&t.invalidate()}},{key:"commit",value:function(e){var t=this.properties.get(e);void 0!==t&&t.commit()}},{key:"_internalSet",value:function(e,t){var r=0!==this.lifecycle?this._origin:0;this._setAtOrigin(e,t,r)}},{key:"_setAtOrigin",value:function(e,t,r){var n=this.store,i=e.propertyName;n.has(i,r)&&Object(b.b)(t,n.get(i))&&2&~e.flags&&r===n.originOf(i)||(e.invalidate(),n.set(i,t,r),e.commit(),Object(m.a)(this.host,e))}},{key:"_cast",value:function(e,t){var r=T.acquire();return r.valid=!0,r.value=t,e&&(r.value=e.call(this.host,t,r)),r}}]),e}(),S=function(){function e(){Object(o.a)(this,e),this.value=null,this.valid=!0}return Object(s.a)(e,[{key:"acquire",value:function(){this.valid=!0}},{key:"release",value:function(){this.value=null}}]),e}(),T=new v.a(S),C=k,M=r(501),P=r(309),A=r(1),E=r(10);function R(e){if(null==e)return{value:e};if(Array.isArray(e))return{type:[e[0]],value:null};switch(typeof e){case"object":return e.constructor&&e.constructor.__accessorMetadata__||e instanceof Date?{type:e.constructor,value:e}:e;case"boolean":return{type:Boolean,value:e};case"string":return{type:String,value:e};case"number":return{type:Number,value:e};case"function":return{type:e,value:null};default:return}}var I=function(){function e(){if(Object(o.a)(this,e),this.constructor===e)throw new Error("[accessor] cannot instantiate Accessor. This can be fixed by creating a subclass of Accessor");for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];Object.defineProperty(this,"__accessor__",{enumerable:!1,value:new C(this)}),r.length>0&&this.normalizeCtorArgs&&(this.__accessor__.ctorArgs=this.normalizeCtorArgs.apply(this,r))}return Object(s.a)(e,[{key:"postscript",value:function(e){var t=this.__accessor__,r=t.ctorArgs||e;t.initialize(),r&&(this.set(r),t.ctorArgs=null),t.constructed(),this.initialize()}},{key:"initialize",value:function(){}},{key:"destroy",value:function(){this.destroyed||(Object(P.c)(this),this.__accessor__.destroy())}},{key:"initialized",get:function(){return this.__accessor__&&this.__accessor__.initialized||!1}},{key:"constructed",get:function(){return this.__accessor__&&2===this.__accessor__.lifecycle||!1}},{key:"destroyed",get:function(){return this.__accessor__&&this.__accessor__.destroyed||!1}},{key:"commitProperty",value:function(e){this.get(e)}},{key:"get",value:function(e){return Object(u.b)(this,e)}},{key:"hasOwnProperty",value:function(e){return this.__accessor__?this.__accessor__.has(e):Object.prototype.hasOwnProperty.call(this,e)}},{key:"isInstanceOf",value:function(e){return Object(c.b)(l.a.getLogger(this.declaredClass),"isInstanceOf",{replacement:"Use instanceof directly",version:"4.16"}),this instanceof e}},{key:"keys",value:function(){return this.__accessor__?this.__accessor__.keys():[]}},{key:"set",value:function(e,t){return Object(M.a)(this,e,t),this}},{key:"watch",value:function(e,t,r){return Object(P.d)(this,e,t,r)}},{key:"_clearOverride",value:function(e){return this.__accessor__.clearOverride(e)}},{key:"_override",value:function(e,t){return this.__accessor__.override(e,t)}},{key:"_isOverridden",value:function(e){return this.__accessor__.isOverridden(e)}},{key:"notifyChange",value:function(e){this.__accessor__.notifyChange(e)}},{key:"_get",value:function(e){return this.__accessor__.internalGet(e)}},{key:"_set",value:function(e,t){return this.__accessor__.internalSet(e,t),this}}],[{key:"createSubclass",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(Array.isArray(e))throw new Error("Multi-inheritance unsupported since 4.16");var t=e.properties,r=e.declaredClass,s=e.constructor;delete e.declaredClass,delete e.properties,delete e.constructor;var c=this,l=function(e){Object(i.a)(r,e);var t=Object(a.a)(r);function r(){var e;Object(o.a)(this,r);for(var i=arguments.length,a=new Array(i),c=0;c<i;c++)a[c]=arguments[c];return(e=t.call.apply(t,[this].concat(a))).inherited=null,s&&s.apply(Object(n.a)(e),a),e}return r}(c);Object(d.a)(l.prototype);var u=function(t){var r=e[t];l.prototype[t]="function"==typeof r?function(){var e,n=this.inherited;this.inherited=function(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];if(c.prototype[t])return c.prototype[t].apply(this,r)};try{for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];e=r.apply(this,a)}catch(l){throw this.inherited=n,l}return this.inherited=n,e}:e[t]};for(var h in e)u(h);for(var f in t){var p=R(t[f]);Object(A.b)(p)(l.prototype,f)}return Object(E.a)(r)(l)}}]),e}();t.a=I},function(e,t,r){"use strict";function n(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function i(e){return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8],e[9],e[10],e[11],e[12],e[13],e[14],e[15]]}function a(e,t,r,n,i,a,o,s,c,l,u,d,h,f,p,b){return[e,t,r,n,i,a,o,s,c,l,u,d,h,f,p,b]}function o(e,t){return new Float64Array(e,t,16)}r.d(t,"a",(function(){return s})),r.d(t,"b",(function(){return o})),r.d(t,"c",(function(){return i})),r.d(t,"d",(function(){return n})),r.d(t,"e",(function(){return a}));var s=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];Object.freeze({__proto__:null,create:n,clone:i,fromValues:a,createView:o,IDENTITY:s})},function(e,t,r){"use strict";r.d(t,"a",(function(){return v})),r.d(t,"b",(function(){return x})),r.d(t,"c",(function(){return q})),r.d(t,"d",(function(){return Z})),r.d(t,"e",(function(){return N})),r.d(t,"f",(function(){return O})),r.d(t,"g",(function(){return j})),r.d(t,"h",(function(){return _})),r.d(t,"i",(function(){return w})),r.d(t,"j",(function(){return E})),r.d(t,"k",(function(){return F})),r.d(t,"l",(function(){return C})),r.d(t,"m",(function(){return m})),r.d(t,"n",(function(){return k})),r.d(t,"o",(function(){return H})),r.d(t,"p",(function(){return X})),r.d(t,"q",(function(){return U})),r.d(t,"r",(function(){return R})),r.d(t,"s",(function(){return L})),r.d(t,"t",(function(){return M})),r.d(t,"u",(function(){return y})),r.d(t,"v",(function(){return S})),r.d(t,"w",(function(){return W})),r.d(t,"x",(function(){return Y})),r.d(t,"y",(function(){return B})),r.d(t,"z",(function(){return I})),r.d(t,"A",(function(){return z})),r.d(t,"B",(function(){return P})),r.d(t,"C",(function(){return g})),r.d(t,"D",(function(){return T})),r.d(t,"E",(function(){return Q})),r.d(t,"F",(function(){return $})),r.d(t,"G",(function(){return G})),r.d(t,"H",(function(){return D})),r.d(t,"I",(function(){return V})),r.d(t,"J",(function(){return A}));var n=r(2),i=r(5),a=r(6),o=r(7),s=function(){function e(t,r){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=arguments.length>3?arguments[3]:void 0,o=arguments.length>4?arguments[4]:void 0;Object(n.a)(this,e),this.TypedArrayConstructor=t,this.elementCount=9;var s=this.TypedArrayConstructor;void 0===a&&(a=9*s.BYTES_PER_ELEMENT);var c=0===r.byteLength?0:i;this.typedBuffer=null==o?new s(r,c):new s(r,c,(o-i)/s.BYTES_PER_ELEMENT),this.typedBufferStride=a/s.BYTES_PER_ELEMENT,this.count=Math.ceil(this.typedBuffer.length/this.typedBufferStride),this.stride=this.typedBufferStride*this.TypedArrayConstructor.BYTES_PER_ELEMENT}return Object(i.a)(e,[{key:"sliceBuffer",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.count-t,n=this.typedBuffer.byteOffset+t*this.stride;return new e(this.buffer,n,this.stride,n+r*this.stride)}},{key:"getMat",value:function(e,t){for(var r=e*this.typedBufferStride,n=0;n<9;n++)t[n]=this.typedBuffer[r++];return t}},{key:"setMat",value:function(e,t){for(var r=e*this.typedBufferStride,n=0;n<9;n++)this.typedBuffer[r++]=t[n]}},{key:"get",value:function(e,t){return this.typedBuffer[e*this.typedBufferStride+t]}},{key:"set",value:function(e,t,r){this.typedBuffer[e*this.typedBufferStride+t]=r}},{key:"copyFrom",value:function(e,t,r){for(var n=this.typedBuffer,i=t.typedBuffer,a=e*this.typedBufferStride,o=r*t.typedBufferStride,s=0;s<9;++s)n[a++]=i[o++]}},{key:"buffer",get:function(){return this.typedBuffer.buffer}}]),e}();s.ElementCount=9;var c=function(){function e(t,r){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=arguments.length>3?arguments[3]:void 0,o=arguments.length>4?arguments[4]:void 0;Object(n.a)(this,e),this.TypedArrayConstructor=t,this.elementCount=16;var s=this.TypedArrayConstructor;void 0===a&&(a=16*s.BYTES_PER_ELEMENT);var c=0===r.byteLength?0:i;this.typedBuffer=null==o?new s(r,c):new s(r,c,(o-i)/s.BYTES_PER_ELEMENT),this.typedBufferStride=a/s.BYTES_PER_ELEMENT,this.count=Math.ceil(this.typedBuffer.length/this.typedBufferStride),this.stride=this.typedBufferStride*this.TypedArrayConstructor.BYTES_PER_ELEMENT}return Object(i.a)(e,[{key:"sliceBuffer",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.count-t,n=this.typedBuffer.byteOffset+t*this.stride;return new e(this.buffer,n,this.stride,n+r*this.stride)}},{key:"getMat",value:function(e,t){for(var r=e*this.typedBufferStride,n=0;n<16;n++)t[n]=this.typedBuffer[r++];return t}},{key:"setMat",value:function(e,t){for(var r=e*this.typedBufferStride,n=0;n<16;n++)this.typedBuffer[r++]=t[n]}},{key:"get",value:function(e,t){return this.typedBuffer[e*this.typedBufferStride+t]}},{key:"set",value:function(e,t,r){this.typedBuffer[e*this.typedBufferStride+t]=r}},{key:"copyFrom",value:function(e,t,r){for(var n=this.typedBuffer,i=t.typedBuffer,a=e*this.typedBufferStride,o=r*t.typedBufferStride,s=0;s<16;++s)n[a++]=i[o++]}},{key:"buffer",get:function(){return this.typedBuffer.buffer}}]),e}();c.ElementCount=16;var l=function(){function e(t,r){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=arguments.length>3?arguments[3]:void 0,o=arguments.length>4?arguments[4]:void 0;Object(n.a)(this,e),this.TypedArrayConstructor=t,this.elementCount=1;var s=this.TypedArrayConstructor;void 0===a&&(a=s.BYTES_PER_ELEMENT);var c=0===r.byteLength?0:i;this.typedBuffer=null==o?new s(r,c):new s(r,c,(o-i)/s.BYTES_PER_ELEMENT),this.typedBufferStride=a/s.BYTES_PER_ELEMENT,this.count=Math.ceil(this.typedBuffer.length/this.typedBufferStride),this.stride=this.typedBufferStride*this.TypedArrayConstructor.BYTES_PER_ELEMENT}return Object(i.a)(e,[{key:"sliceBuffer",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.count-t,n=this.typedBuffer.byteOffset+t*this.stride;return new e(this.buffer,n,this.stride,n+r*this.stride)}},{key:"get",value:function(e){return this.typedBuffer[e*this.typedBufferStride]}},{key:"set",value:function(e,t){this.typedBuffer[e*this.typedBufferStride]=t}},{key:"buffer",get:function(){return this.typedBuffer.buffer}}]),e}();l.ElementCount=1;var u=r(29),d=function(){function e(t,r){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=arguments.length>3?arguments[3]:void 0,o=arguments.length>4?arguments[4]:void 0;Object(n.a)(this,e),this.TypedArrayConstructor=t,this.elementCount=2;var s=this.TypedArrayConstructor;void 0===a&&(a=2*s.BYTES_PER_ELEMENT);var c=0===r.byteLength?0:i;this.typedBuffer=null==o?new s(r,c):new s(r,c,(o-i)/s.BYTES_PER_ELEMENT),this.typedBufferStride=a/s.BYTES_PER_ELEMENT,this.count=Math.ceil(this.typedBuffer.length/this.typedBufferStride),this.stride=this.typedBufferStride*this.TypedArrayConstructor.BYTES_PER_ELEMENT}return Object(i.a)(e,[{key:"sliceBuffer",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.count-t,n=this.typedBuffer.byteOffset+t*this.stride;return new e(this.buffer,n,this.stride,n+r*this.stride)}},{key:"getVec",value:function(e,t){return e*=this.typedBufferStride,Object(u.r)(t,this.typedBuffer[e],this.typedBuffer[e+1])}},{key:"setVec",value:function(e,t){e*=this.typedBufferStride,this.typedBuffer[e++]=t[0],this.typedBuffer[e]=t[1]}},{key:"get",value:function(e,t){return this.typedBuffer[e*this.typedBufferStride+t]}},{key:"set",value:function(e,t,r){this.typedBuffer[e*this.typedBufferStride+t]=r}},{key:"setValues",value:function(e,t,r){e*=this.typedBufferStride,this.typedBuffer[e++]=t,this.typedBuffer[e]=r}},{key:"copyFrom",value:function(e,t,r){var n=this.typedBuffer,i=t.typedBuffer,a=e*this.typedBufferStride,o=r*t.typedBufferStride;n[a++]=i[o++],n[a]=i[o]}},{key:"buffer",get:function(){return this.typedBuffer.buffer}}]),e}();d.ElementCount=2;var h=r(4),f=function(){function e(t,r){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=arguments.length>3?arguments[3]:void 0,o=arguments.length>4?arguments[4]:void 0;Object(n.a)(this,e),this.TypedArrayConstructor=t,this.elementCount=3;var s=this.TypedArrayConstructor;void 0===a&&(a=3*s.BYTES_PER_ELEMENT);var c=0===r.byteLength?0:i;this.typedBuffer=null==o?new s(r,c):new s(r,c,(o-i)/s.BYTES_PER_ELEMENT),this.typedBufferStride=a/s.BYTES_PER_ELEMENT,this.count=Math.ceil(this.typedBuffer.length/this.typedBufferStride),this.stride=this.typedBufferStride*this.TypedArrayConstructor.BYTES_PER_ELEMENT}return Object(i.a)(e,[{key:"sliceBuffer",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.count-t,n=this.typedBuffer.byteOffset+t*this.stride;return new e(this.buffer,n,this.stride,n+r*this.stride)}},{key:"getVec",value:function(e,t){return e*=this.typedBufferStride,Object(h.y)(t,this.typedBuffer[e],this.typedBuffer[e+1],this.typedBuffer[e+2])}},{key:"setVec",value:function(e,t){e*=this.typedBufferStride,this.typedBuffer[e++]=t[0],this.typedBuffer[e++]=t[1],this.typedBuffer[e]=t[2]}},{key:"get",value:function(e,t){return this.typedBuffer[e*this.typedBufferStride+t]}},{key:"set",value:function(e,t,r){this.typedBuffer[e*this.typedBufferStride+t]=r}},{key:"setValues",value:function(e,t,r,n){e*=this.typedBufferStride,this.typedBuffer[e++]=t,this.typedBuffer[e++]=r,this.typedBuffer[e]=n}},{key:"copyFrom",value:function(e,t,r){var n=this.typedBuffer,i=t.typedBuffer,a=e*this.typedBufferStride,o=r*t.typedBufferStride;n[a++]=i[o++],n[a++]=i[o++],n[a]=i[o]}},{key:"buffer",get:function(){return this.typedBuffer.buffer}}]),e}();f.ElementCount=3;var p=r(54),b=function(){function e(t,r){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=arguments.length>3?arguments[3]:void 0,o=arguments.length>4?arguments[4]:void 0;Object(n.a)(this,e),this.TypedArrayConstructor=t,this.elementCount=4;var s=this.TypedArrayConstructor;void 0===a&&(a=4*s.BYTES_PER_ELEMENT);var c=0===r.byteLength?0:i;this.typedBuffer=null==o?new s(r,c):new s(r,c,(o-i)/s.BYTES_PER_ELEMENT),this.typedBufferStride=a/s.BYTES_PER_ELEMENT,this.count=Math.ceil(this.typedBuffer.length/this.typedBufferStride),this.stride=this.typedBufferStride*this.TypedArrayConstructor.BYTES_PER_ELEMENT}return Object(i.a)(e,[{key:"sliceBuffer",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.count-t,n=this.typedBuffer.byteOffset+t*this.stride;return new e(this.buffer,n,this.stride,n+r*this.stride)}},{key:"getVec",value:function(e,t){return e*=this.typedBufferStride,Object(p.l)(t,this.typedBuffer[e++],this.typedBuffer[e++],this.typedBuffer[e++],this.typedBuffer[e])}},{key:"setVec",value:function(e,t){e*=this.typedBufferStride,this.typedBuffer[e++]=t[0],this.typedBuffer[e++]=t[1],this.typedBuffer[e++]=t[2],this.typedBuffer[e]=t[3]}},{key:"get",value:function(e,t){return this.typedBuffer[e*this.typedBufferStride+t]}},{key:"set",value:function(e,t,r){this.typedBuffer[e*this.typedBufferStride+t]=r}},{key:"setValues",value:function(e,t,r,n,i){e*=this.typedBufferStride,this.typedBuffer[e++]=t,this.typedBuffer[e++]=r,this.typedBuffer[e++]=n,this.typedBuffer[e]=i}},{key:"copyFrom",value:function(e,t,r){var n=this.typedBuffer,i=t.typedBuffer,a=e*this.typedBufferStride,o=r*t.typedBufferStride;n[a++]=i[o++],n[a++]=i[o++],n[a++]=i[o++],n[a]=i[o]}},{key:"buffer",get:function(){return this.typedBuffer.buffer}}]),e}();b.ElementCount=4;var v=function(e){Object(a.a)(r,e);var t=Object(o.a)(r);function r(e){var i,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=arguments.length>2?arguments[2]:void 0,s=arguments.length>3?arguments[3]:void 0;return Object(n.a)(this,r),(i=t.call(this,Float32Array,e,a,o,s)).elementType="f32",i}return Object(i.a)(r,null,[{key:"fromTypedArray",value:function(e,t){return new r(e.buffer,e.byteOffset,t,e.byteOffset+e.byteLength)}}]),r}(l);v.ElementType="f32";var m=function(e){Object(a.a)(r,e);var t=Object(o.a)(r);function r(e){var i,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=arguments.length>2?arguments[2]:void 0,s=arguments.length>3?arguments[3]:void 0;return Object(n.a)(this,r),(i=t.call(this,Float32Array,e,a,o,s)).elementType="f32",i}return Object(i.a)(r,[{key:"slice",value:function(e,t){return this.sliceBuffer(r,e,t)}}],[{key:"fromTypedArray",value:function(e,t){return new r(e.buffer,e.byteOffset,t,e.byteOffset+e.byteLength)}}]),r}(d);m.ElementType="f32";var y=function(e){Object(a.a)(r,e);var t=Object(o.a)(r);function r(e){var i,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=arguments.length>2?arguments[2]:void 0,s=arguments.length>3?arguments[3]:void 0;return Object(n.a)(this,r),(i=t.call(this,Float32Array,e,a,o,s)).elementType="f32",i}return Object(i.a)(r,[{key:"slice",value:function(e,t){return this.sliceBuffer(r,e,t)}}],[{key:"fromTypedArray",value:function(e,t){return new r(e.buffer,e.byteOffset,t,e.byteOffset+e.byteLength)}}]),r}(f);y.ElementType="f32";var g=function(e){Object(a.a)(r,e);var t=Object(o.a)(r);function r(e){var i,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=arguments.length>2?arguments[2]:void 0,s=arguments.length>3?arguments[3]:void 0;return Object(n.a)(this,r),(i=t.call(this,Float32Array,e,a,o,s)).elementType="f32",i}return Object(i.a)(r,[{key:"slice",value:function(e,t){return this.sliceBuffer(r,e,t)}}],[{key:"fromTypedArray",value:function(e,t){return new r(e.buffer,e.byteOffset,t,e.byteOffset+e.byteLength)}}]),r}(b);g.ElementType="f32";var O=function(e){Object(a.a)(r,e);var t=Object(o.a)(r);function r(e){var i,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=arguments.length>2?arguments[2]:void 0,s=arguments.length>3?arguments[3]:void 0;return Object(n.a)(this,r),(i=t.call(this,Float32Array,e,a,o,s)).elementType="f32",i}return Object(i.a)(r,[{key:"slice",value:function(e,t){return this.sliceBuffer(r,e,t)}}],[{key:"fromTypedArray",value:function(e,t){return new r(e.buffer,e.byteOffset,t,e.byteOffset+e.byteLength)}}]),r}(s);O.ElementType="f32";var j=function(e){Object(a.a)(r,e);var t=Object(o.a)(r);function r(e){var i,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=arguments.length>2?arguments[2]:void 0,s=arguments.length>3?arguments[3]:void 0;return Object(n.a)(this,r),(i=t.call(this,Float64Array,e,a,o,s)).elementType="f64",i}return Object(i.a)(r,[{key:"slice",value:function(e,t){return this.sliceBuffer(r,e,t)}}],[{key:"fromTypedArray",value:function(e,t){return new r(e.buffer,e.byteOffset,t,e.byteOffset+e.byteLength)}}]),r}(s);j.ElementType="f64";var _=function(e){Object(a.a)(r,e);var t=Object(o.a)(r);function r(e){var i,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=arguments.length>2?arguments[2]:void 0,s=arguments.length>3?arguments[3]:void 0;return Object(n.a)(this,r),(i=t.call(this,Float32Array,e,a,o,s)).elementType="f32",i}return Object(i.a)(r,[{key:"slice",value:function(e,t){return this.sliceBuffer(r,e,t)}}],[{key:"fromTypedArray",value:function(e,t){return new r(e.buffer,e.byteOffset,t,e.byteOffset+e.byteLength)}}]),r}(c);_.ElementType="f32";var w=function(e){Object(a.a)(r,e);var t=Object(o.a)(r);function r(e){var i,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=arguments.length>2?arguments[2]:void 0,s=arguments.length>3?arguments[3]:void 0;return Object(n.a)(this,r),(i=t.call(this,Float64Array,e,a,o,s)).elementType="f64",i}return Object(i.a)(r,[{key:"slice",value:function(e,t){return this.sliceBuffer(r,e,t)}}],[{key:"fromTypedArray",value:function(e,t){return new r(e.buffer,e.byteOffset,t,e.byteOffset+e.byteLength)}}]),r}(c);w.ElementType="f64";var x=function(e){Object(a.a)(r,e);var t=Object(o.a)(r);function r(e){var i,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=arguments.length>2?arguments[2]:void 0,s=arguments.length>3?arguments[3]:void 0;return Object(n.a)(this,r),(i=t.call(this,Float64Array,e,a,o,s)).elementType="f64",i}return Object(i.a)(r,[{key:"slice",value:function(e,t){return this.sliceBuffer(r,e,t)}}],[{key:"fromTypedArray",value:function(e,t){return new r(e.buffer,e.byteOffset,t,e.byteOffset+e.byteLength)}}]),r}(l);x.ElementType="f64";var k=function(e){Object(a.a)(r,e);var t=Object(o.a)(r);function r(e){var i,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=arguments.length>2?arguments[2]:void 0,s=arguments.length>3?arguments[3]:void 0;return Object(n.a)(this,r),(i=t.call(this,Float64Array,e,a,o,s)).elementType="f64",i}return Object(i.a)(r,[{key:"slice",value:function(e,t){return this.sliceBuffer(r,e,t)}}],[{key:"fromTypedArray",value:function(e,t){return new r(e.buffer,e.byteOffset,t,e.byteOffset+e.byteLength)}}]),r}(d);k.ElementType="f64";var S=function(e){Object(a.a)(r,e);var t=Object(o.a)(r);function r(e){var i,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=arguments.length>2?arguments[2]:void 0,s=arguments.length>3?arguments[3]:void 0;return Object(n.a)(this,r),(i=t.call(this,Float64Array,e,a,o,s)).elementType="f64",i}return Object(i.a)(r,[{key:"slice",value:function(e,t){return this.sliceBuffer(r,e,t)}}],[{key:"fromTypedArray",value:function(e,t){return new r(e.buffer,e.byteOffset,t,e.byteOffset+e.byteLength)}}]),r}(f);S.ElementType="f64";var T=function(e){Object(a.a)(r,e);var t=Object(o.a)(r);function r(e){var i,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=arguments.length>2?arguments[2]:void 0,s=arguments.length>3?arguments[3]:void 0;return Object(n.a)(this,r),(i=t.call(this,Float64Array,e,a,o,s)).elementType="f64",i}return Object(i.a)(r,[{key:"slice",value:function(e,t){return this.sliceBuffer(r,e,t)}}],[{key:"fromTypedArray",value:function(e,t){return new r(e.buffer,e.byteOffset,t,e.byteOffset+e.byteLength)}}]),r}(b);T.ElementType="f64";var C=function(e){Object(a.a)(r,e);var t=Object(o.a)(r);function r(e){var i,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=arguments.length>2?arguments[2]:void 0,s=arguments.length>3?arguments[3]:void 0;return Object(n.a)(this,r),(i=t.call(this,Uint8Array,e,a,o,s)).elementType="u8",i}return Object(i.a)(r,[{key:"slice",value:function(e,t){return this.sliceBuffer(r,e,t)}}],[{key:"fromTypedArray",value:function(e,t){return new r(e.buffer,e.byteOffset,t,e.byteOffset+e.byteLength)}}]),r}(l);C.ElementType="u8";var M=function(e){Object(a.a)(r,e);var t=Object(o.a)(r);function r(e){var i,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=arguments.length>2?arguments[2]:void 0,s=arguments.length>3?arguments[3]:void 0;return Object(n.a)(this,r),(i=t.call(this,Uint8Array,e,a,o,s)).elementType="u8",i}return Object(i.a)(r,[{key:"slice",value:function(e,t){return this.sliceBuffer(r,e,t)}}],[{key:"fromTypedArray",value:function(e,t){return new r(e.buffer,e.byteOffset,t,e.byteOffset+e.byteLength)}}]),r}(d);M.ElementType="u8";var P=function(e){Object(a.a)(r,e);var t=Object(o.a)(r);function r(e){var i,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=arguments.length>2?arguments[2]:void 0,s=arguments.length>3?arguments[3]:void 0;return Object(n.a)(this,r),(i=t.call(this,Uint8Array,e,a,o,s)).elementType="u8",i}return Object(i.a)(r,[{key:"slice",value:function(e,t){return this.sliceBuffer(r,e,t)}}],[{key:"fromTypedArray",value:function(e,t){return new r(e.buffer,e.byteOffset,t,e.byteOffset+e.byteLength)}}]),r}(f);P.ElementType="u8";var A=function(e){Object(a.a)(r,e);var t=Object(o.a)(r);function r(e){var i,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=arguments.length>2?arguments[2]:void 0,s=arguments.length>3?arguments[3]:void 0;return Object(n.a)(this,r),(i=t.call(this,Uint8Array,e,a,o,s)).elementType="u8",i}return Object(i.a)(r,[{key:"slice",value:function(e,t){return this.sliceBuffer(r,e,t)}}],[{key:"fromTypedArray",value:function(e,t){return new r(e.buffer,e.byteOffset,t,e.byteOffset+e.byteLength)}}]),r}(b);A.ElementType="u8";var E=function(e){Object(a.a)(r,e);var t=Object(o.a)(r);function r(e){var i,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=arguments.length>2?arguments[2]:void 0,s=arguments.length>3?arguments[3]:void 0;return Object(n.a)(this,r),(i=t.call(this,Uint16Array,e,a,o,s)).elementType="u16",i}return Object(i.a)(r,[{key:"slice",value:function(e,t){return this.sliceBuffer(r,e,t)}}],[{key:"fromTypedArray",value:function(e,t){return new r(e.buffer,e.byteOffset,t,e.byteOffset+e.byteLength)}}]),r}(l);E.ElementType="u16";var R=function(e){Object(a.a)(r,e);var t=Object(o.a)(r);function r(e){var i,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=arguments.length>2?arguments[2]:void 0,s=arguments.length>3?arguments[3]:void 0;return Object(n.a)(this,r),(i=t.call(this,Uint16Array,e,a,o,s)).elementType="u16",i}return Object(i.a)(r,[{key:"slice",value:function(e,t){return this.sliceBuffer(r,e,t)}}],[{key:"fromTypedArray",value:function(e,t){return new r(e.buffer,e.byteOffset,t,e.byteOffset+e.byteLength)}}]),r}(d);R.ElementType="u16";var I=function(e){Object(a.a)(r,e);var t=Object(o.a)(r);function r(e){var i,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=arguments.length>2?arguments[2]:void 0,s=arguments.length>3?arguments[3]:void 0;return Object(n.a)(this,r),(i=t.call(this,Uint16Array,e,a,o,s)).elementType="u16",i}return Object(i.a)(r,[{key:"slice",value:function(e,t){return this.sliceBuffer(r,e,t)}}],[{key:"fromTypedArray",value:function(e,t){return new r(e.buffer,e.byteOffset,t,e.byteOffset+e.byteLength)}}]),r}(f);I.ElementType="u16";var D=function(e){Object(a.a)(r,e);var t=Object(o.a)(r);function r(e){var i,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=arguments.length>2?arguments[2]:void 0,s=arguments.length>3?arguments[3]:void 0;return Object(n.a)(this,r),(i=t.call(this,Uint16Array,e,a,o,s)).elementType="u16",i}return Object(i.a)(r,[{key:"slice",value:function(e,t){return this.sliceBuffer(r,e,t)}}],[{key:"fromTypedArray",value:function(e,t){return new r(e.buffer,e.byteOffset,t,e.byteOffset+e.byteLength)}}]),r}(b);D.ElementType="u16";var F=function(e){Object(a.a)(r,e);var t=Object(o.a)(r);function r(e){var i,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=arguments.length>2?arguments[2]:void 0,s=arguments.length>3?arguments[3]:void 0;return Object(n.a)(this,r),(i=t.call(this,Uint32Array,e,a,o,s)).elementType="u32",i}return Object(i.a)(r,[{key:"slice",value:function(e,t){return this.sliceBuffer(r,e,t)}}],[{key:"fromTypedArray",value:function(e,t){return new r(e.buffer,e.byteOffset,t,e.byteOffset+e.byteLength)}}]),r}(l);F.ElementType="u32";var L=function(e){Object(a.a)(r,e);var t=Object(o.a)(r);function r(e){var i,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=arguments.length>2?arguments[2]:void 0,s=arguments.length>3?arguments[3]:void 0;return Object(n.a)(this,r),(i=t.call(this,Uint32Array,e,a,o,s)).elementType="u32",i}return Object(i.a)(r,[{key:"slice",value:function(e,t){return this.sliceBuffer(r,e,t)}}],[{key:"fromTypedArray",value:function(e,t){return new r(e.buffer,e.byteOffset,t,e.byteOffset+e.byteLength)}}]),r}(d);L.ElementType="u32";var z=function(e){Object(a.a)(r,e);var t=Object(o.a)(r);function r(e){var i,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=arguments.length>2?arguments[2]:void 0,s=arguments.length>3?arguments[3]:void 0;return Object(n.a)(this,r),(i=t.call(this,Uint32Array,e,a,o,s)).elementType="u32",i}return Object(i.a)(r,[{key:"slice",value:function(e,t){return this.sliceBuffer(r,e,t)}}],[{key:"fromTypedArray",value:function(e,t){return new r(e.buffer,e.byteOffset,t,e.byteOffset+e.byteLength)}}]),r}(f);z.ElementType="u32";var V=function(e){Object(a.a)(r,e);var t=Object(o.a)(r);function r(e){var i,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=arguments.length>2?arguments[2]:void 0,s=arguments.length>3?arguments[3]:void 0;return Object(n.a)(this,r),(i=t.call(this,Uint32Array,e,a,o,s)).elementType="u32",i}return Object(i.a)(r,[{key:"slice",value:function(e,t){return this.sliceBuffer(r,e,t)}}],[{key:"fromTypedArray",value:function(e,t){return new r(e.buffer,e.byteOffset,t,e.byteOffset+e.byteLength)}}]),r}(b);V.ElementType="u32";var N=function(e){Object(a.a)(r,e);var t=Object(o.a)(r);function r(e){var i,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=arguments.length>2?arguments[2]:void 0,s=arguments.length>3?arguments[3]:void 0;return Object(n.a)(this,r),(i=t.call(this,Int8Array,e,a,o,s)).elementType="i8",i}return Object(i.a)(r,[{key:"slice",value:function(e,t){return this.sliceBuffer(r,e,t)}}],[{key:"fromTypedArray",value:function(e,t){return new r(e.buffer,e.byteOffset,t,e.byteOffset+e.byteLength)}}]),r}(l);N.ElementType="i8";var U=function(e){Object(a.a)(r,e);var t=Object(o.a)(r);function r(e){var i,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=arguments.length>2?arguments[2]:void 0,s=arguments.length>3?arguments[3]:void 0;return Object(n.a)(this,r),(i=t.call(this,Int8Array,e,a,o,s)).elementType="i8",i}return Object(i.a)(r,[{key:"slice",value:function(e,t){return this.sliceBuffer(r,e,t)}}],[{key:"fromTypedArray",value:function(e,t){return new r(e.buffer,e.byteOffset,t,e.byteOffset+e.byteLength)}}]),r}(d);U.ElementType="i8";var B=function(e){Object(a.a)(r,e);var t=Object(o.a)(r);function r(e){var i,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=arguments.length>2?arguments[2]:void 0,s=arguments.length>3?arguments[3]:void 0;return Object(n.a)(this,r),(i=t.call(this,Int8Array,e,a,o,s)).elementType="i8",i}return Object(i.a)(r,[{key:"slice",value:function(e,t){return this.sliceBuffer(r,e,t)}}],[{key:"fromTypedArray",value:function(e,t){return new r(e.buffer,e.byteOffset,t,e.byteOffset+e.byteLength)}}]),r}(f);B.ElementType="i8";var G=function(e){Object(a.a)(r,e);var t=Object(o.a)(r);function r(e){var i,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=arguments.length>2?arguments[2]:void 0,s=arguments.length>3?arguments[3]:void 0;return Object(n.a)(this,r),(i=t.call(this,Int8Array,e,a,o,s)).elementType="i8",i}return Object(i.a)(r,[{key:"slice",value:function(e,t){return this.sliceBuffer(r,e,t)}}],[{key:"fromTypedArray",value:function(e,t){return new r(e.buffer,e.byteOffset,t,e.byteOffset+e.byteLength)}}]),r}(b);G.ElementType="i8";var q=function(e){Object(a.a)(r,e);var t=Object(o.a)(r);function r(e){var i,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=arguments.length>2?arguments[2]:void 0,s=arguments.length>3?arguments[3]:void 0;return Object(n.a)(this,r),(i=t.call(this,Int16Array,e,a,o,s)).elementType="i16",i}return Object(i.a)(r,[{key:"slice",value:function(e,t){return this.sliceBuffer(r,e,t)}}],[{key:"fromTypedArray",value:function(e,t){return new r(e.buffer,e.byteOffset,t,e.byteOffset+e.byteLength)}}]),r}(l);q.ElementType="i16";var H=function(e){Object(a.a)(r,e);var t=Object(o.a)(r);function r(e){var i,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=arguments.length>2?arguments[2]:void 0,s=arguments.length>3?arguments[3]:void 0;return Object(n.a)(this,r),(i=t.call(this,Int16Array,e,a,o,s)).elementType="i16",i}return Object(i.a)(r,[{key:"slice",value:function(e,t){return this.sliceBuffer(r,e,t)}}],[{key:"fromTypedArray",value:function(e,t){return new r(e.buffer,e.byteOffset,t,e.byteOffset+e.byteLength)}}]),r}(d);H.ElementType="i16";var W=function(e){Object(a.a)(r,e);var t=Object(o.a)(r);function r(e){var i,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=arguments.length>2?arguments[2]:void 0,s=arguments.length>3?arguments[3]:void 0;return Object(n.a)(this,r),(i=t.call(this,Int16Array,e,a,o,s)).elementType="i16",i}return Object(i.a)(r,[{key:"slice",value:function(e,t){return this.sliceBuffer(r,e,t)}}],[{key:"fromTypedArray",value:function(e,t){return new r(e.buffer,e.byteOffset,t,e.byteOffset+e.byteLength)}}]),r}(f);W.ElementType="i16";var Q=function(e){Object(a.a)(r,e);var t=Object(o.a)(r);function r(e){var i,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=arguments.length>2?arguments[2]:void 0,s=arguments.length>3?arguments[3]:void 0;return Object(n.a)(this,r),(i=t.call(this,Int16Array,e,a,o,s)).elementType="i16",i}return Object(i.a)(r,[{key:"slice",value:function(e,t){return this.sliceBuffer(r,e,t)}}],[{key:"fromTypedArray",value:function(e,t){return new r(e.buffer,e.byteOffset,t,e.byteOffset+e.byteLength)}}]),r}(b);Q.ElementType="i16";var Z=function(e){Object(a.a)(r,e);var t=Object(o.a)(r);function r(e){var i,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=arguments.length>2?arguments[2]:void 0,s=arguments.length>3?arguments[3]:void 0;return Object(n.a)(this,r),(i=t.call(this,Int32Array,e,a,o,s)).elementType="i32",i}return Object(i.a)(r,[{key:"slice",value:function(e,t){return this.sliceBuffer(r,e,t)}}],[{key:"fromTypedArray",value:function(e,t){return new r(e.buffer,e.byteOffset,t,e.byteOffset+e.byteLength)}}]),r}(l);Z.ElementType="i32";var X=function(e){Object(a.a)(r,e);var t=Object(o.a)(r);function r(e){var i,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=arguments.length>2?arguments[2]:void 0,s=arguments.length>3?arguments[3]:void 0;return Object(n.a)(this,r),(i=t.call(this,Int32Array,e,a,o,s)).elementType="i32",i}return Object(i.a)(r,[{key:"slice",value:function(e,t){return this.sliceBuffer(r,e,t)}}],[{key:"fromTypedArray",value:function(e,t){return new r(e.buffer,e.byteOffset,t,e.byteOffset+e.byteLength)}}]),r}(d);X.ElementType="i32";var Y=function(e){Object(a.a)(r,e);var t=Object(o.a)(r);function r(e){var i,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=arguments.length>2?arguments[2]:void 0,s=arguments.length>3?arguments[3]:void 0;return Object(n.a)(this,r),(i=t.call(this,Int32Array,e,a,o,s)).elementType="i32",i}return Object(i.a)(r,[{key:"slice",value:function(e,t){return this.sliceBuffer(r,e,t)}}],[{key:"fromTypedArray",value:function(e,t){return new r(e.buffer,e.byteOffset,t,e.byteOffset+e.byteLength)}}]),r}(f);Y.ElementType="i32";var $=function(e){Object(a.a)(r,e);var t=Object(o.a)(r);function r(e){var i,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=arguments.length>2?arguments[2]:void 0,s=arguments.length>3?arguments[3]:void 0;return Object(n.a)(this,r),(i=t.call(this,Int32Array,e,a,o,s)).elementType="i32",i}return Object(i.a)(r,[{key:"slice",value:function(e,t){return this.sliceBuffer(r,e,t)}}],[{key:"fromTypedArray",value:function(e,t){return new r(e.buffer,e.byteOffset,t,e.byteOffset+e.byteLength)}}]),r}(b);$.ElementType="i32"},function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r(636);var i=r(383),a=r(637);function o(e,t){return Object(n.a)(e)||function(e,t){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(e)){var r=[],n=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(n=(o=s.next()).done)&&(r.push(o.value),!t||r.length!==t);n=!0);}catch(c){i=!0,a=c}finally{try{n||null==s.return||s.return()}finally{if(i)throw a}}return r}}(e,t)||Object(i.a)(e,t)||Object(a.a)()}},function(e,t,r){"use strict";r.d(t,"a",(function(){return z})),r.d(t,"b",(function(){return L})),r.d(t,"c",(function(){return V})),r.d(t,"d",(function(){return f})),r.d(t,"e",(function(){return y})),r.d(t,"f",(function(){return _})),r.d(t,"g",(function(){return j})),r.d(t,"h",(function(){return a})),r.d(t,"i",(function(){return b})),r.d(t,"j",(function(){return m})),r.d(t,"k",(function(){return P})),r.d(t,"l",(function(){return D})),r.d(t,"m",(function(){return s})),r.d(t,"n",(function(){return u})),r.d(t,"o",(function(){return h})),r.d(t,"p",(function(){return d})),r.d(t,"q",(function(){return c})),r.d(t,"r",(function(){return l})),r.d(t,"s",(function(){return E})),r.d(t,"t",(function(){return o})),r.d(t,"u",(function(){return v})),r.d(t,"v",(function(){return w})),r.d(t,"w",(function(){return x})),r.d(t,"x",(function(){return I})),r.d(t,"y",(function(){return O})),r.d(t,"z",(function(){return k})),r.d(t,"A",(function(){return S})),r.d(t,"B",(function(){return M})),r.d(t,"C",(function(){return C})),r.d(t,"D",(function(){return T})),r.d(t,"E",(function(){return g})),r.d(t,"F",(function(){return A})),r.d(t,"G",(function(){return p})),r.d(t,"H",(function(){return F}));var n=r(3),i=(r(66),r(40));function a(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:V;return[e[0],e[1],e[2],e[3],e[4],e[5]]}function o(e,t,r,n,i,o){var s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:a();return s[0]=e,s[1]=t,s[2]=r,s[3]=n,s[4]=i,s[5]=o,s}function s(e,t){e[0]=Math.min(e[0],t[0]),e[1]=Math.min(e[1],t[1]),e[2]=Math.min(e[2],t[2]),e[3]=Math.max(e[3],t[3]),e[4]=Math.max(e[4],t[4]),e[5]=Math.max(e[5],t[5])}function c(e,t){e[0]=Math.min(e[0],t[0]),e[1]=Math.min(e[1],t[1]),e[3]=Math.max(e[3],t[2]),e[4]=Math.max(e[4],t[3])}function l(e,t){e[0]=Math.min(e[0],t[0]),e[1]=Math.min(e[1],t[1]),e[2]=Math.min(e[2],t[2]),e[3]=Math.max(e[3],t[0]),e[4]=Math.max(e[4],t[1]),e[5]=Math.max(e[5],t[2])}function u(e,t){for(var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:t.length/3,i=e[0],a=e[1],o=e[2],s=e[3],c=e[4],l=e[5],u=0;u<n;u++)i=Math.min(i,t[r+3*u]),a=Math.min(a,t[r+3*u+1]),o=Math.min(o,t[r+3*u+2]),s=Math.max(s,t[r+3*u]),c=Math.max(c,t[r+3*u+1]),l=Math.max(l,t[r+3*u+2]);e[0]=i,e[1]=a,e[2]=o,e[3]=s,e[4]=c,e[5]=l}function d(e,t,r,n){e[0]=Math.min(e[0],e[0]+t),e[3]=Math.max(e[3],e[3]+t),e[1]=Math.min(e[1],e[1]+r),e[4]=Math.max(e[4],e[4]+r),e[2]=Math.min(e[2],e[2]+n),e[5]=Math.max(e[5],e[5]+n)}function h(e,t,r){var n=t.length,i=e[0],a=e[1],o=e[2],s=e[3],c=e[4],l=e[5];if(r)for(var u=0;u<n;u++){var d=t[u];i=Math.min(i,d[0]),a=Math.min(a,d[1]),o=Math.min(o,d[2]),s=Math.max(s,d[0]),c=Math.max(c,d[1]),l=Math.max(l,d[2])}else for(var h=0;h<n;h++){var f=t[h];i=Math.min(i,f[0]),a=Math.min(a,f[1]),s=Math.max(s,f[0]),c=Math.max(c,f[1])}e[0]=i,e[1]=a,e[2]=o,e[3]=s,e[4]=c,e[5]=l}function f(e){for(var t=0;t<6;t++)if(!isFinite(e[t]))return!1;return!0}function p(e){return e[0]>=e[3]?0:e[3]-e[0]}function b(e){return e[1]>=e[4]?0:e[4]-e[1]}function v(e){return e[2]>=e[5]?0:e[5]-e[2]}function m(e){var t=p(e),r=v(e),n=b(e);return Math.sqrt(t*t+r*r+n*n)}function y(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0,0];return t[0]=e[0]+p(e)/2,t[1]=e[1]+b(e)/2,t[2]=e[2]+v(e)/2,t}function g(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0,0];return t[0]=p(e),t[1]=b(e),t[2]=v(e),t}function O(e){return Math.max(p(e),v(e),b(e))}function j(e,t){return t[0]>=e[0]&&t[1]>=e[1]&&t[2]>=e[2]&&t[0]<=e[3]&&t[1]<=e[4]&&t[2]<=e[5]}function _(e,t){return t[0]>=e[0]&&t[1]>=e[1]&&t[2]>=e[2]&&t[3]<=e[3]&&t[4]<=e[4]&&t[5]<=e[5]}function w(e,t){return Math.max(t[0],e[0])<=Math.min(t[3],e[3])&&Math.max(t[1],e[1])<=Math.min(t[4],e[4])&&Math.max(t[2],e[2])<=Math.min(t[5],e[5])}function x(e,t){return!!Object(n.i)(t)||w(e,t)}function k(e,t,r,n){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:e;return i[0]=e[0]+t,i[1]=e[1]+r,i[2]=e[2]+n,i[3]=e[3]+t,i[4]=e[4]+r,i[5]=e[5]+n,i}function S(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e,n=e[0]+p(e)/2,i=e[1]+b(e)/2,a=e[2]+v(e)/2;return r[0]=n+(e[0]-n)*t,r[1]=i+(e[1]-i)*t,r[2]=a+(e[2]-a)*t,r[3]=n+(e[3]-n)*t,r[4]=i+(e[4]-i)*t,r[5]=a+(e[5]-a)*t,r}function T(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e;return r[0]=t[0],r[1]=t[1],r[2]=t[2],r!==e&&(r[3]=e[3],r[4]=e[4],r[5]=e[5]),r}function C(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e;return r[3]=t[0],r[4]=t[1],r[5]=t[2],r!==e&&(r[0]=e[0],r[1]=e[1],r[2]=e[2]),e}function M(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e}function P(e){return e?M(e,z):a(z)}function A(e,t){return t||(t=Object(i.k)()),t[0]=e[0],t[1]=e[1],t[2]=e[3],t[3]=e[4],t}function E(e,t){return e[0]=t[0],e[1]=t[1],e[2]=Number.NEGATIVE_INFINITY,e[3]=t[2],e[4]=t[3],e[5]=Number.POSITIVE_INFINITY,e}function R(e){return 6===e.length}function I(e){return 0===p(e)&&0===b(e)&&0===v(e)}function D(e,t,r){if(Object(n.i)(e)||Object(n.i)(t))return e===t;if(!R(e)||!R(t))return!1;if(r){for(var i=0;i<e.length;i++)if(!r(e[i],t[i]))return!1}else for(var a=0;a<e.length;a++)if(e[a]!==t[a])return!1;return!0}function F(e,t,r,n,i,a){return o(e,t,r,n,i,a,N)}var L=[-1/0,-1/0,-1/0,1/0,1/0,1/0],z=[1/0,1/0,1/0,-1/0,-1/0,-1/0],V=[0,0,0,0,0,0],N=a()},function(e,t,r){"use strict";r.d(t,"a",(function(){return f})),r.d(t,"b",(function(){return x})),r.d(t,"c",(function(){return b})),r.d(t,"d",(function(){return w})),r.d(t,"e",(function(){return p})),r.d(t,"f",(function(){return v})),r.d(t,"g",(function(){return j})),r.d(t,"h",(function(){return _})),r.d(t,"i",(function(){return y})),r.d(t,"j",(function(){return m})),r.d(t,"k",(function(){return g})),r.d(t,"l",(function(){return O})),r.d(t,"m",(function(){return s}));var n=r(13),i=r(168),a=(r(25),r(23));function o(e,t,r,i,a){var o=e.watch(t,(function(t,n,a,o){r&&!r(t)||null==i||i.call(e,t,n,a,o)}),a);if(Array.isArray(t)){var s,c=Object(n.a)(t);try{for(c.s();!(s=c.n()).done;){var l=s.value,u=e.get(l);r&&r(u)&&(null==i||i.call(e,u,u,t,e))}}catch(h){c.e(h)}finally{c.f()}}else{var d=e.get(t);r&&r(d)&&(null==i||i.call(e,d,d,t,e))}return o}function s(e,t,r,n,i){var s="function"==typeof n?n:null,c="object"==typeof n?n:null;"boolean"==typeof n&&(i=n);var l,u=!1;function d(){l&&(l.remove(),l=null)}var h=Object(a.g)();Object(a.s)(c,(function(){d(),h.reject(Object(a.f)())}));var f={then:h.promise.then.bind(h.promise),catch:h.promise.catch.bind(h.promise),remove:d};return Object.freeze(f),l=o(e,t,r,(function(t,r,n,i){u=!0,d(),s&&s.call(e,t,r,n,i),h.resolve({value:t,oldValue:r,propertyName:n,target:i})}),i),u&&d(),f}function c(e){return!!e}function l(e){return!e}function u(e){return!0===e}function d(e){return!1===e}var h=/\?(\.|$)/g;function f(e,t,r,i){var a,o=Array.isArray(t)?t:t.indexOf(",")>-1?t.split(","):[t],s=p(e,t,r,i),c=Object(n.a)(o);try{for(c.s();!(a=c.n()).done;){var l=a.value.trim().replace(h,"$1"),u=e.get(l);r.call(e,u,u,l,e)}}catch(d){c.e(d)}finally{c.f()}return s}function p(e,t,r,n){return e.watch(t,r,n)}function b(e,t,r,n){return s(e,t,null,r,n)}function v(e,t,r,n){return o(e,t,c,r,n)}function m(e,t,r,n){return s(e,t,c,r,n)}function y(e,t,r,n){return s(e,t,l,r,n)}function g(e,t,r,n){return o(e,t,u,r,n)}function O(e,t,r,n){return s(e,t,u,r,n)}function j(e,t,r,n){return o(e,t,d,r,n)}function _(e,t,r,n){return s(e,t,d,r,n)}function w(e,t,r,n){var i=!1,a=e.watch(t,(function(t,n,a,o){i||r.call(e,t,n,a,o)}),n);return{remove:function(){a.remove()},pause:function(){i=!0},resume:function(){i=!1}}}function x(e,t,r,n,a,o,s){var c={};function l(t){var n=c[t];n&&(o&&o(n.target,t,e,r),n.handle.remove(),delete c[t])}var u=f(e,t,(function(t,o,s){l(s),Object(i.b)(t)&&(c[s]={handle:Object(i.c)(t,r,n),target:t},a&&a(t,s,e,r))}),s);return{remove:function(){for(var e in u.remove(),c)l(e)}}}},function(e,t,r){"use strict";r.d(t,"a",(function(){return s}));var n=r(404),i=function(e){return{vnodeSelector:"",properties:void 0,children:void 0,text:e.toString(),domNode:null}},a=function e(t,r){for(var n=0,a=t.length;n<a;n++){var o=t[n];Array.isArray(o)?e(o,r):null!=o&&!1!==o&&(o.hasOwnProperty("vnodeSelector")||(o=i(o)),r.push(o))}},o=function(e,t){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];if(1===r.length&&"string"==typeof r[0])return{vnodeSelector:e,properties:t||void 0,children:void 0,text:r[0],domNode:null};var i=[];return a(r,i),{vnodeSelector:e,properties:t||void 0,children:i,text:void 0,domNode:null}};function s(e,t){for(var r=arguments.length,i=new Array(r>2?r-2:0),a=2;a<r;a++)i[a-2]=arguments[a];return"function"!=typeof e||Object(n.b)(e)?o.apply(void 0,[e,t].concat(i)):e.apply(void 0,[t].concat(i))}},function(e,t,r){"use strict";r.d(t,"a",(function(){return R})),r.d(t,"b",(function(){return I})),r.d(t,"c",(function(){return d})),r.d(t,"d",(function(){return l})),r.d(t,"e",(function(){return v})),r.d(t,"f",(function(){return f})),r.d(t,"g",(function(){return b})),r.d(t,"h",(function(){return p})),r.d(t,"i",(function(){return h})),r.d(t,"j",(function(){return k})),r.d(t,"k",(function(){return T})),r.d(t,"l",(function(){return C})),r.d(t,"m",(function(){return S})),r.d(t,"n",(function(){return E})),r.d(t,"o",(function(){return P})),r.d(t,"p",(function(){return A})),r.d(t,"q",(function(){return M})),r.d(t,"r",(function(){return x})),r.d(t,"s",(function(){return V})),r.d(t,"t",(function(){return D})),r.d(t,"u",(function(){return F})),r.d(t,"v",(function(){return w})),r.d(t,"w",(function(){return L})),r.d(t,"x",(function(){return u}));var n=r(20),i=r(3),a=r(4),o=r(9),s=r(70),c=r(47);function l(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:N;return[e[0],e[1],e[2],e[3]]}function u(e,t,r,n){return h(e,t,r,n,c.d.get())}function d(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:l();return h(e[0],e[1],e[2],e[3],t)}function h(e,t,r,n){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:l();return i[0]=e,i[1]=t,i[2]=r,i[3]=n,i}function f(e,t,r){return Object(a.m)(r,e),r[3]=t,r}function p(e,t,r){Object(a.m)(r,t);var n=Object(a.j)(t,t);return Math.abs(n-1)>1e-5&&n>1e-12&&Object(a.g)(r,r,1/Math.sqrt(n)),w(r,e,r)}function b(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:l();return k(Object(a.l)(c.c.get(),e,t),Object(a.l)(c.c.get(),r,t),e,n)}function v(e,t,r,n,i){if(e.count<3)return!1;e.getVec(r,y);for(var o=n,s=!1;o<e.count-1&&!s;)e.getVec(o,g),o++,s=!Object(a.q)(y,g);if(!s)return!1;for(o=Math.max(o,i),s=!1;o<e.count&&!s;)e.getVec(o,O),o++,Object(a.l)(j,y,g),Object(a.t)(j,j),Object(a.l)(_,g,O),Object(a.t)(_,_),s=!Object(a.q)(y,O)&&!Object(a.q)(g,O)&&Math.abs(Object(a.j)(j,_))<m;return s?(b(y,g,O,t),!0):(0!==r||1!==n||2!==i)&&v(e,t,0,1,2)}var m=.99619469809,y=Object(o.e)(),g=Object(o.e)(),O=Object(o.e)(),j=Object(o.e)(),_=Object(o.e)();function w(e,t,r){return e!==r&&d(e,r),r[3]=-Object(a.j)(r,t),r}function x(e,t){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=-e[3],t}function k(e,t,r,n){return p(r,Object(a.i)(O,t,e),n)}function S(e,t,r){return!!Object(i.j)(t)&&z(e,t.origin,t.direction,U,r)}function T(e,t,r){return z(e,t.origin,t.vector,0,r)}function C(e,t,r){return z(e,t.origin,t.vector,1,r)}function M(e,t){return L(e,Object(s.g)(t))-t[3]>=0}function P(e,t){return L(e,t)>=0}function A(e,t){return L(e,t)<0}function E(e,t){var r=t[0],n=t[1],i=t[2],a=t[3],o=t[4],s=t[5];return e[0]*(e[0]>0?r:a)+e[1]*(e[1]>0?n:o)+e[2]*(e[2]>0?i:s)+e[3]>=0}function R(e,t){var r=Object(a.j)(e,t.ray.direction),n=-L(e,t.ray.origin);if(n<0&&r>=0)return!1;if(r>-1e-6&&r<1e-6)return n>0;if((n<0||r<0)&&!(n<0&&r<0))return!0;var i=n/r;return r>0?i<t.c1&&(t.c1=i):i>t.c0&&(t.c0=i),t.c0<=t.c1}function I(e,t){var r=Object(a.j)(e,t.ray.direction),n=-L(e,t.ray.origin);if(r>-1e-6&&r<1e-6)return n>0;var i=n/r;return r>0?i<t.c1&&(t.c1=i):i>t.c0&&(t.c0=i),t.c0<=t.c1}function D(e,t,r){var n=Object(a.g)(c.c.get(),e,-e[3]),i=F(e,Object(a.l)(c.c.get(),t,n),c.c.get());return Object(a.h)(r,i,n),r}function F(e,t,r){var n=Object(a.g)(c.c.get(),e,Object(a.j)(e,t));return Object(a.l)(r,t,n),r}function L(e,t){return Object(a.j)(e,t)+e[3]}function z(e,t,r,i,o){var s=Object(a.j)(e,r);if(0===s)return!1;var c=-(Object(a.j)(e,t)+e[3])/s;return 1&i&&(c=Object(n.e)(c,0,1)),!(!(4&i)&&c<0||!(8&i)&&c>1)&&(Object(a.h)(o,t,Object(a.g)(o,r,c)),!0)}function V(e){return e}var N=[0,0,1,0],U=8},function(e,t,r){"use strict";function n(){return[0,0]}function i(e){return[e[0],e[1]]}function a(e,t){return[e,t]}function o(e){for(var t=[0,0],r=Math.min(2,e.length),n=0;n<r;++n)t[n]=e[n];return t}function s(e,t){return new Float64Array(e,t,2)}function c(){return[0,0]}function l(){return a(1,1)}function u(){return a(1,0)}function d(){return a(0,1)}r.d(t,"a",(function(){return h})),r.d(t,"b",(function(){return n})),r.d(t,"c",(function(){return i})),r.d(t,"d",(function(){return s})),r.d(t,"e",(function(){return o})),r.d(t,"f",(function(){return a}));var h=[0,0],f=l(),p=u(),b=d();Object.freeze({__proto__:null,create:n,clone:i,fromValues:a,fromArray:o,createView:s,zeros:c,ones:l,unitX:u,unitY:d,ZEROS:h,ONES:f,UNIT_X:p,UNIT_Y:b})},function(e,t,r){"use strict";r.d(t,"a",(function(){return w})),r.d(t,"b",(function(){return E})),r.d(t,"c",(function(){return F})),r.d(t,"d",(function(){return me})),r.d(t,"e",(function(){return ye})),r.d(t,"f",(function(){return S})),r.d(t,"g",(function(){return x})),r.d(t,"h",(function(){return fe})),r.d(t,"i",(function(){return ee})),r.d(t,"j",(function(){return J})),r.d(t,"k",(function(){return de})),r.d(t,"l",(function(){return N})),r.d(t,"m",(function(){return Z})),r.d(t,"n",(function(){return ge})),r.d(t,"o",(function(){return L})),r.d(t,"p",(function(){return A})),r.d(t,"q",(function(){return U})),r.d(t,"r",(function(){return z})),r.d(t,"s",(function(){return X})),r.d(t,"t",(function(){return Y})),r.d(t,"u",(function(){return $})),r.d(t,"v",(function(){return ie})),r.d(t,"w",(function(){return re})),r.d(t,"x",(function(){return be})),r.d(t,"y",(function(){return B})),r.d(t,"z",(function(){return Q})),r.d(t,"A",(function(){return q})),r.d(t,"B",(function(){return te})),r.d(t,"C",(function(){return H})),r.d(t,"D",(function(){return W})),r.d(t,"E",(function(){return P})),r.d(t,"F",(function(){return C})),r.d(t,"G",(function(){return ue})),r.d(t,"H",(function(){return ve})),r.d(t,"I",(function(){return he})),r.d(t,"J",(function(){return oe})),r.d(t,"K",(function(){return T}));var n=r(33),i=r(14),a=r(13),o=r(2),s=r(5),c=r(123),l=r(22),u=(r(71),r(15)),d=r(3),h=u.a.getLogger("esri.core.urlUtils"),f=c.a.request,p="esri/config: esriConfig.request.proxyUrl is not set.",b=/^\s*[a-z][a-z0-9-+.]*:(?![0-9])/i,v=/^\s*http:/i,m=/^\s*https:/i,y=/^\s*file:/i,g=/:\d+$/,O=/^https?:\/\/[^/]+\.arcgis.com\/sharing(\/|$)/i,j=new RegExp("^(([^:/?#]+):)?(//([^/?#]*))?([^?#]*)(\\?([^#]*))?(#(.*))?$"),_=new RegExp("^((([^\\[:]+):)?([^@]+)@)?(\\[([^\\]]+)\\]|([^\\[:]*))(:([0-9]+))?$"),w=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";Object(o.a)(this,e),this.uri=t,this.scheme=null,this.authority=null,this.path=null,this.query=null,this.fragment=null,this.user=null,this.password=null,this.host=null,this.port=null;var r=Object(d.d)(this.uri.match(j));this.scheme=r[2]||(r[1]?"":null),this.authority=r[4]||(r[3]?"":null),this.path=r[5],this.query=r[7]||(r[6]?"":null),this.fragment=r[9]||(r[8]?"":null),null!=this.authority&&(r=Object(d.d)(this.authority.match(_)),this.user=r[3]||null,this.password=r[4]||null,this.host=r[6]||r[7],this.port=r[9]||null)}return Object(s.a)(e,[{key:"toString",value:function(){return this.uri}}]),e}(),x=new w(c.a.applicationUrl),k={},S=function(){var e=Object(d.d)(x.path),t=e.substring(0,e.lastIndexOf(e.split("/")[e.split("/").length-1]));return"".concat("".concat(x.scheme,"://").concat(x.host).concat(null!=x.port?":".concat(x.port):""),t)}();function T(e){var t={path:null,query:null},r=new w(e),n=e.indexOf("?");return null===r.query?t.path=e:(t.path=e.substring(0,n),t.query=C(r.query)),r.fragment&&(t.hash=r.fragment,null===r.query&&(t.path=t.path.substring(0,t.path.length-(r.fragment.length+1)))),t}function C(e){var t,r=e.split("&"),n={},i=Object(a.a)(r);try{for(i.s();!(t=i.n()).done;){var o=t.value;if(o){var s=o.indexOf("="),c=void 0,l=void 0;s<0?(c=decodeURIComponent(o),l=""):(c=decodeURIComponent(o.slice(0,s)),l=decodeURIComponent(o.slice(s+1)));var u=n[c];"string"==typeof u&&(u=n[c]=[u]),Array.isArray(u)?u.push(l):n[c]=l}}}catch(d){i.e(d)}finally{i.f()}return n}function M(e){return e&&"object"==typeof e&&"toJSON"in e&&"function"==typeof e.toJSON}function P(e,t){return e?t&&"function"==typeof t?Object.keys(e).map((function(r){return encodeURIComponent(r)+"="+encodeURIComponent(t(r,e[r]))})).join("&"):Object.keys(e).map((function(r){var n=e[r];if(null==n)return"";var i=encodeURIComponent(r)+"=",a=t&&t[r];return a?i+encodeURIComponent(a(n)):Array.isArray(n)?n.map((function(e){return M(e)?i+encodeURIComponent(JSON.stringify(e)):i+encodeURIComponent(e)})).join("&"):M(n)?i+encodeURIComponent(JSON.stringify(n)):i+encodeURIComponent(n)})).filter((function(e){return e})).join("&"):""}function A(){var e,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],r=f.proxyUrl;if("string"==typeof t){e=ie(t);var n=L(t);n&&(r=n.proxyUrl)}else e=!!t;if(!r)throw h.warn(p),new l.a("urlutils:proxy-not-set",p);return e&&se()&&(r=oe(r)),T(r)}function E(e){var t,r,n=L(e);if(n){var a=I(n.proxyUrl);t=a.path,r=a.query?C(a.query):null}if(t){var o=T(e);e=t+"?"+o.path;var s=P(Object(i.a)(Object(i.a)({},r),o.query));s&&(e="".concat(e,"?").concat(s))}return e}var R={path:"",query:""};function I(e){var t=e.indexOf("?");return-1!==t?(R.path=e.slice(0,t),R.query=e.slice(t+1)):(R.path=e,R.query=null),R}function D(e){return(e=ce(e=function(e){return e&&"/"===e[e.length-1]?e:"".concat(e,"/")}(e=I(e).path),!0)).toLowerCase()}function F(e){for(var t={proxyUrl:e.proxyUrl,urlPrefix:D(e.urlPrefix)},r=f.proxyRules,n=t.urlPrefix,i=r.length,a=0;a<r.length;a++){var o=r[a].urlPrefix;if(0===n.indexOf(o)){if(n.length===o.length)return-1;i=a;break}0===o.indexOf(n)&&(i=a+1)}return r.splice(i,0,t),i}function L(e){for(var t=f.proxyRules,r=D(e),n=0;n<t.length;n++)if(0===r.indexOf(t[n].urlPrefix))return t[n]}function z(e,t){return e=V(e),t=V(t),ce(e)===ce(t)}function V(e){var t=(e=W(e)).indexOf("/sharing");return t>0?e.substring(0,t):e.replace(/\/+$/,"")}function N(e){var t=function(t){return null==t||t instanceof RegExp&&t.test(e)||"string"==typeof t&&e.startsWith(t)},r=f.interceptors;if(r){var n,i=Object(a.a)(r);try{for(i.s();!(n=i.n()).done;){var o=n.value;if(Array.isArray(o.urls)){if(o.urls.some(t))return o}else if(t(o.urls))return o}}catch(s){i.e(s)}finally{i.f()}}return null}function U(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=pe(e),i=pe(t);return!(!r&&n.scheme!==i.scheme)&&null!=n.host&&null!=i.host&&n.host.toLowerCase()===i.host.toLowerCase()&&n.port===i.port}function B(e){if("string"==typeof e){if(!X(e))return!0;e=pe(e)}if(U(e,x))return!0;for(var t=f.trustedServers||[],r=0;r<t.length;r++)for(var n=G(t[r]),i=0;i<n.length;i++)if(U(e,n[i]))return!0;return!1}function G(e){return k[e]||(ne(e)||re(e)?k[e]=[new w(q(e))]:k[e]=[new w("http://".concat(e)),new w("https://".concat(e))]),k[e]}function q(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:S,r=arguments.length>2?arguments[2]:void 0;return re(e)?r&&r.preserveProtocolRelative?e:"http"===x.scheme&&x.authority===Z(e).slice(2)?"http:".concat(e):"https:".concat(e):ne(e)?e:Object(d.d)(Q("/"===e[0]?le(t):t,e))}function H(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:S,r=arguments.length>2?arguments[2]:void 0;if(!X(e))return e;var n=W(e),i=n.toLowerCase(),a=W(t).toLowerCase().replace(/\/+$/,""),o=r?W(r).toLowerCase().replace(/\/+$/,""):null;if(o&&0!==a.indexOf(o))return e;for(var s=function(e,t,r){return-1===(r=e.indexOf(t,r))?e.length:r},c=s(i,"/",i.indexOf("//")+2),l=-1;i.slice(0,c+1)===a.slice(0,c)+"/"&&(l=c+1,c!==i.length);)c=s(i,"/",c+1);if(-1===l)return e;if(o&&l<o.length)return e;e=n.slice(l);var u=a.slice(l-1).replace(/[^/]+/g,"").length;if(u>0)for(var d=0;d<u;d++)e="../".concat(e);else e="./".concat(e);return e}function W(e){return function(e){var t=f.httpsDomains;if(!function(e){return v.test(e)||"http"===x.scheme&&re(e)}(e))return e;var r,n=e.indexOf("/",7);if(r=(r=-1===n?e:e.slice(0,n)).toLowerCase().slice(7),g.test(r)){if(!r.endsWith(":80"))return e;r=r.slice(0,-3),e=e.replace(":80","")}return"http"===x.scheme&&r===x.authority&&!O.test(e)||(se()&&r===x.authority||t&&t.some((function(e){return r===e||r.endsWith(".".concat(e))}))||se()&&!L(e))&&(e=oe(e)),e}(e=function(e){return e.replace(/^(https?:\/\/)(arcgis\.com)/i,"$1www.$2")}(e=function(e){if(/^https?:\/\//i.test(e)){var t=I(e);e=(e=t.path.replace(/\/{2,}/g,"/")).replace("/","//"),t.query&&(e+="?".concat(t.query))}return e}(e=q(e=e.trim()))))}function Q(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var n=t.filter(d.j);if(n&&n.length){var i=[];if(X(n[0])){var a=n[0],o=a.indexOf("//");-1!==o&&(i.push(a.slice(0,o+1)),ae(n[0])&&(i[0]+="/"),n[0]=a.slice(o+2))}else"/"===n[0][0]&&i.push("");for(var s=n.reduce((function(e,t){return t?e.concat(t.split("/")):e}),[]),c=0;c<s.length;c++){var l=s[c];".."===l&&i.length>0&&".."!==i[i.length-1]?i.pop():(!l&&c===s.length-1||l&&("."!==l||0===i.length))&&i.push(l)}return i.join("/")}}function Z(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(Y(e)||$(e))return null;var r=e.indexOf("://");if(-1===r&&re(e))r=2;else{if(-1===r)return null;r+=3}var n=e.indexOf("/",r);return-1!==n&&(e=e.slice(0,n)),t&&(e=ce(e,!0)),e}function X(e){return re(e)||ne(e)}function Y(e){return null!=e&&"blob:"===e.slice(0,5)}function $(e){return"data:"===e.slice(0,5)}function J(e){var t=ee(e);if(!t||!t.isBase64)return null;for(var r=atob(t.data),n=new Uint8Array(r.length),i=0;i<r.length;i++)n[i]=r.charCodeAt(i);return n.buffer}var K=/^data:(.*?)(;base64)?,(.*)$/;function ee(e){var t=e.match(K);if(!t)return null;var r=Object(n.a)(t,4);return{mediaType:r[1],isBase64:!!r[2],data:r[3]}}function te(e){return e.isBase64?"data:".concat(e.mediaType,";base64,").concat(e.data):"data:".concat(e.mediaType,",").concat(e.data)}function re(e){return null!=e&&void 0!==e&&"/"===e[0]&&"/"===e[1]}function ne(e){return b.test(e)}function ie(e){return m.test(e)||"https"===x.scheme&&re(e)}function ae(e){return y.test(e)}function oe(e){return re(e)?"https:".concat(e):e.replace(v,"https:")}function se(){return"https"===x.scheme}function ce(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return re(e)?e.slice(2):(e=e.replace(b,""),t&&e.length>1&&"/"===e[0]&&"/"===e[1]&&(e=e.slice(2)),e)}function le(e){var t=e.indexOf("//"),r=e.indexOf("/",t+2);return-1===r?e:e.slice(0,r)}function ue(e){var t=0;if(X(e)){var r=e.indexOf("//");-1!==r&&(t=r+2)}var n=e.lastIndexOf("/");return n<t?e:e.slice(0,n+1)}function de(e,t){if(!e)return"";var r=T(e).path.replace(/\/+$/,""),n=r.substring(r.lastIndexOf("/")+1);if(null==t||!t.length)return n;var i=new RegExp(".(".concat(t.join("|"),")$"),"ig");return n.replace(i,"")}function he(e){return e.replace(/\/+$/,"")}function fe(e,t,r){if(!(t&&r&&e&&X(e)))return e;var n=e.indexOf("//"),i=e.indexOf("/",n+2),a=e.indexOf(":",n+2),o=Math.min(i<0?e.length:i,a<0?e.length:a);return e.slice(n+2,o).toLowerCase()!==t.toLowerCase()?e:"".concat(e.slice(0,n+2)).concat(r).concat(e.slice(o))}function pe(e){return"string"==typeof e?new w(q(e)):(e.scheme||(e.scheme=x.scheme),e)}function be(e){return je.test(e)}function ve(e,t){var r=T(e),n=Object.keys(r.query||{});return n.length>0&&t&&t.warn("removeQueryParameters()","Url query parameters are not supported, the following parameters have been removed: ".concat(n.join(", "),".")),r.path}function me(e,t,r){var n=T(e),i=n.query||{};return i[t]=String(r),"".concat(n.path,"?").concat(P(i))}function ye(e,t){var r=T(e),n=r.query||{};for(var i in t)n[i]=t[i];var a=P(n);return a?"".concat(r.path,"?").concat(a):r.path}function ge(e){if(Object(d.i)(e))return null;var t=e.match(Oe);return t?t[1]:null}var Oe=/.*?\.([^\/]*)$/,je=/(^data:image\/svg|\.svg$)/i},function(e,t,r){"use strict";r.d(t,"a",(function(){return I})),r.d(t,"b",(function(){return R})),r.d(t,"c",(function(){return f})),r.d(t,"d",(function(){return v})),r.d(t,"e",(function(){return m})),r.d(t,"f",(function(){return o})),r.d(t,"g",(function(){return w})),r.d(t,"h",(function(){return y})),r.d(t,"i",(function(){return g})),r.d(t,"j",(function(){return j})),r.d(t,"k",(function(){return a})),r.d(t,"l",(function(){return k})),r.d(t,"m",(function(){return C})),r.d(t,"n",(function(){return A})),r.d(t,"o",(function(){return d})),r.d(t,"p",(function(){return u})),r.d(t,"q",(function(){return h})),r.d(t,"r",(function(){return c})),r.d(t,"s",(function(){return s})),r.d(t,"t",(function(){return b})),r.d(t,"u",(function(){return x})),r.d(t,"v",(function(){return _})),r.d(t,"w",(function(){return P})),r.d(t,"x",(function(){return S})),r.d(t,"y",(function(){return T})),r.d(t,"z",(function(){return l})),r.d(t,"A",(function(){return p}));r(17);var n=r(3),i=r(66);function a(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:D;return[e[0],e[1],e[2],e[3]]}function o(e){return[e[0],e[1],e[2],e[3]]}function s(e,t,r,n){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:a();return i[0]=e,i[1]=t,i[2]=r,i[3]=n,i}function c(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:a();return t[0]=e.xmin,t[1]=e.ymin,t[2]=e.xmax,t[3]=e.ymax,t}function l(e,t){return new i.a({xmin:e[0],ymin:e[1],xmax:e[2],ymax:e[3],spatialReference:t})}function u(e,t){t[0]<e[0]&&(e[0]=t[0]),t[0]>e[2]&&(e[2]=t[0]),t[1]<e[1]&&(e[1]=t[1]),t[1]>e[3]&&(e[3]=t[1])}function d(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e;if("length"in t)M(t)?(r[0]=Math.min(e[0],t[0]),r[1]=Math.min(e[1],t[1]),r[2]=Math.max(e[2],t[2]),r[3]=Math.max(e[3],t[3])):2!==t.length&&3!==t.length||(r[0]=Math.min(e[0],t[0]),r[1]=Math.min(e[1],t[1]),r[2]=Math.max(e[2],t[0]),r[3]=Math.max(e[3],t[1]));else switch(t.type){case"extent":r[0]=Math.min(e[0],t.xmin),r[1]=Math.min(e[1],t.ymin),r[2]=Math.max(e[2],t.xmax),r[3]=Math.max(e[3],t.ymax);break;case"point":r[0]=Math.min(e[0],t.x),r[1]=Math.min(e[1],t.y),r[2]=Math.max(e[2],t.x),r[3]=Math.max(e[3],t.y)}return r}function h(e,t){for(var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e,n=t.length,i=e[0],a=e[1],o=e[2],s=e[3],c=0;c<n;c++){var l=t[c];i=Math.min(i,l[0]),a=Math.min(a,l[1]),o=Math.max(o,l[0]),s=Math.max(s,l[1])}return r[0]=i,r[1]=a,r[2]=o,r[3]=s,r}function f(e){for(var t=0;t<4;t++)if(!isFinite(e[t]))return!1;return!0}function p(e){return e[0]>=e[2]?0:e[2]-e[0]}function b(e){return e[1]>=e[3]?0:e[3]-e[1]}function v(e){return p(e)*b(e)}function m(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0];return t[0]=(e[0]+e[2])/2,t[1]=(e[1]+e[3])/2,t}function y(e,t){return O(e,t[0],t[1])}function g(e,t){return O(e,t.x,t.y)}function O(e,t,r){return t>=e[0]&&r>=e[1]&&t<=e[2]&&r<=e[3]}function j(e,t,r){return t[0]>=e[0]-r&&t[1]>=e[1]-r&&t[0]<=e[2]+r&&t[1]<=e[3]+r}function _(e,t){return Math.max(t[0],e[0])<=Math.min(t[2],e[2])&&Math.max(t[1],e[1])<=Math.min(t[3],e[3])}function w(e,t){return t[0]>=e[0]&&t[2]<=e[2]&&t[1]>=e[1]&&t[3]<=e[3]}function x(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e,n=t[0],i=t[1],a=t[2],o=t[3];return r[0]=E(e[0],n,a),r[1]=E(e[1],i,o),r[2]=E(e[2],n,a),r[3]=E(e[3],i,o),r}function k(e,t){var r=(e[0]+e[2])/2,n=(e[1]+e[3])/2,i=Math.max(Math.abs(t[0]-r)-p(e)/2,0),a=Math.max(Math.abs(t[1]-n)-b(e)/2,0);return Math.sqrt(i*i+a*a)}function S(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:e;return n[0]=e[0]+t,n[1]=e[1]+r,n[2]=e[2]+t,n[3]=e[3]+r,n}function T(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e}function C(e){return e?T(e,I):a(I)}function M(e){return 4===e.length}function P(e){return!(0!==p(e)&&isFinite(e[0])||0!==b(e)&&isFinite(e[1]))}function A(e,t,r){if(Object(n.i)(e)||Object(n.i)(t))return e===t;if(!M(e)||!M(t))return!1;if(r){for(var i=0;i<e.length;i++)if(!r(e[i],t[i]))return!1}else for(var a=0;a<e.length;a++)if(e[a]!==t[a])return!1;return!0}function E(e,t,r){return e<t?t:e>r?r:e}var R=[-1/0,-1/0,1/0,1/0],I=[1/0,1/0,-1/0,-1/0],D=[0,0,0,0]},function(e,t,r){"use strict";r.d(t,"a",(function(){return U})),r.d(t,"b",(function(){return c})),r.d(t,"c",(function(){return u})),r.d(t,"d",(function(){return h})),r.d(t,"e",(function(){return d})),r.d(t,"f",(function(){return l})),r.d(t,"g",(function(){return j})),r.d(t,"h",(function(){return s})),r.d(t,"i",(function(){return o}));var n=r(14),i=r(2),a=r(5);function o(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:32774,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[0,0,0,0];return{srcRgb:e,srcAlpha:e,dstRgb:t,dstAlpha:t,opRgb:r,opAlpha:r,color:{r:n[0],g:n[1],b:n[2],a:n[3]}}}function s(e,t,r,n){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:32774,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:32774,o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:[0,0,0,0];return{srcRgb:e,srcAlpha:t,dstRgb:r,dstAlpha:n,opRgb:i,opAlpha:a,color:{r:o[0],g:o[1],b:o[2],a:o[3]}}}var c={face:1029,mode:2305},l={face:1028,mode:2305},u=function(e){return 2===e?c:1===e?l:null},d={zNear:0,zFar:1},h={r:!0,g:!0,b:!0,a:!0};function f(e){return x.intern(e)}function p(e){return S.intern(e)}function b(e){return C.intern(e)}function v(e){return P.intern(e)}function m(e){return E.intern(e)}function y(e){return I.intern(e)}function g(e){return F.intern(e)}function O(e){return z.intern(e)}function j(e){return N.intern(e)}var _=function(){function e(t,r){Object(i.a)(this,e),this.makeKey=t,this.makeRef=r,this.interns=new Map}return Object(a.a)(e,[{key:"intern",value:function(e){if(!e)return null;var t=this.makeKey(e),r=this.interns;return r.has(t)||r.set(t,this.makeRef(e)),r.get(t)}}]),e}();function w(e){return"["+e.join(",")+"]"}var x=new _(k,(function(e){return Object(n.a)({__tag:"Blending"},e)}));function k(e){return e?w([e.srcRgb,e.srcAlpha,e.dstRgb,e.dstAlpha,e.opRgb,e.opAlpha,e.color.r,e.color.g,e.color.b,e.color.a]):null}var S=new _(T,(function(e){return Object(n.a)({__tag:"Culling"},e)}));function T(e){return e?w([e.face,e.mode]):null}var C=new _(M,(function(e){return Object(n.a)({__tag:"PolygonOffset"},e)}));function M(e){return e?w([e.factor,e.units]):null}var P=new _(A,(function(e){return Object(n.a)({__tag:"DepthTest"},e)}));function A(e){return e?w([e.func]):null}var E=new _(R,(function(e){return Object(n.a)({__tag:"StencilTest"},e)}));function R(e){return e?w([e.function.func,e.function.ref,e.function.mask,e.operation.fail,e.operation.zFail,e.operation.zPass]):null}var I=new _(D,(function(e){return Object(n.a)({__tag:"DepthWrite"},e)}));function D(e){return e?w([e.zNear,e.zFar]):null}var F=new _(L,(function(e){return Object(n.a)({__tag:"ColorWrite"},e)}));function L(e){return e?w([e.r,e.g,e.b,e.a]):null}var z=new _(V,(function(e){return Object(n.a)({__tag:"StencilWrite"},e)}));function V(e){return e?w([e.mask]):null}var N=new _((function(e){return e?w([k(e.blending),T(e.culling),M(e.polygonOffset),A(e.depthTest),R(e.stencilTest),D(e.depthWrite),L(e.colorWrite),V(e.stencilWrite)]):null}),(function(e){return{blending:f(e.blending),culling:p(e.culling),polygonOffset:b(e.polygonOffset),depthTest:v(e.depthTest),stencilTest:m(e.stencilTest),depthWrite:y(e.depthWrite),colorWrite:g(e.colorWrite),stencilWrite:O(e.stencilWrite)}}));var U=function(){function e(t){Object(i.a)(this,e),this._pipelineInvalid=!0,this._blendingInvalid=!0,this._cullingInvalid=!0,this._polygonOffsetInvalid=!0,this._depthTestInvalid=!0,this._stencilTestInvalid=!0,this._depthWriteInvalid=!0,this._colorWriteInvalid=!0,this._stencilWriteInvalid=!0,this._stateSetters=t}return Object(a.a)(e,[{key:"setPipeline",value:function(e){(this._pipelineInvalid||e!==this._pipeline)&&(this.setBlending(e.blending),this.setCulling(e.culling),this.setPolygonOffset(e.polygonOffset),this.setDepthTest(e.depthTest),this.setStencilTest(e.stencilTest),this.setDepthWrite(e.depthWrite),this.setColorWrite(e.colorWrite),this.setStencilWrite(e.stencilWrite),this._pipeline=e),this._pipelineInvalid=!1}},{key:"invalidateBlending",value:function(){this._blendingInvalid=!0,this._pipelineInvalid=!0}},{key:"invalidateCulling",value:function(){this._cullingInvalid=!0,this._pipelineInvalid=!0}},{key:"invalidatePolygonOffset",value:function(){this._polygonOffsetInvalid=!0,this._pipelineInvalid=!0}},{key:"invalidateDepthTest",value:function(){this._depthTestInvalid=!0,this._pipelineInvalid=!0}},{key:"invalidateStencilTest",value:function(){this._stencilTestInvalid=!0,this._pipelineInvalid=!0}},{key:"invalidateDepthWrite",value:function(){this._depthWriteInvalid=!0,this._pipelineInvalid=!0}},{key:"invalidateColorWrite",value:function(){this._colorWriteInvalid=!0,this._pipelineInvalid=!0}},{key:"invalidateStencilWrite",value:function(){this._stencilTestInvalid=!0,this._pipelineInvalid=!0}},{key:"setBlending",value:function(e){this._blending=this.setSubState(e,this._blending,this._blendingInvalid,this._stateSetters.setBlending),this._blendingInvalid=!1}},{key:"setCulling",value:function(e){this._culling=this.setSubState(e,this._culling,this._cullingInvalid,this._stateSetters.setCulling),this._cullingInvalid=!1}},{key:"setPolygonOffset",value:function(e){this._polygonOffset=this.setSubState(e,this._polygonOffset,this._polygonOffsetInvalid,this._stateSetters.setPolygonOffset),this._polygonOffsetInvalid=!1}},{key:"setDepthTest",value:function(e){this._depthTest=this.setSubState(e,this._depthTest,this._depthTestInvalid,this._stateSetters.setDepthTest),this._depthTestInvalid=!1}},{key:"setStencilTest",value:function(e){this._stencilTest=this.setSubState(e,this._stencilTest,this._stencilTestInvalid,this._stateSetters.setStencilTest),this._stencilTestInvalid=!1}},{key:"setDepthWrite",value:function(e){this._depthWrite=this.setSubState(e,this._depthWrite,this._depthWriteInvalid,this._stateSetters.setDepthWrite),this._depthWriteInvalid=!1}},{key:"setColorWrite",value:function(e){this._colorWrite=this.setSubState(e,this._colorWrite,this._colorWriteInvalid,this._stateSetters.setColorWrite),this._colorWriteInvalid=!1}},{key:"setStencilWrite",value:function(e){this._stencilWrite=this.setSubState(e,this._stencilWrite,this._stencilWriteInvalid,this._stateSetters.setStencilWrite),this._stencilTestInvalid=!1}},{key:"setSubState",value:function(e,t,r,n){return(r||e!==t)&&(n(e),this._pipelineInvalid=!0),e}}]),e}()},function(e,t,r){"use strict";function n(e){return(n=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}r.d(t,"a",(function(){return n}))},function(e,t,r){"use strict";function n(){return[0,0,0,0]}function i(e){return[e[0],e[1],e[2],e[3]]}function a(e,t,r,n){return[e,t,r,n]}function o(e){for(var t=[0,0,0,0],r=Math.min(4,e.length),n=0;n<r;++n)t[n]=e[n];return t}function s(e,t){return new Float64Array(e,t,4)}function c(){return[0,0,0,0]}function l(){return a(1,1,1,1)}function u(){return a(1,0,0,0)}function d(){return a(0,1,0,0)}function h(){return a(0,0,1,0)}function f(){return a(0,0,0,1)}r.d(t,"a",(function(){return b})),r.d(t,"b",(function(){return p})),r.d(t,"c",(function(){return s})),r.d(t,"d",(function(){return o})),r.d(t,"e",(function(){return n})),r.d(t,"f",(function(){return i})),r.d(t,"g",(function(){return a}));var p=[0,0,0,0],b=l(),v=u(),m=d(),y=h(),g=f();Object.freeze({__proto__:null,create:n,clone:i,fromValues:a,fromArray:o,createView:s,zeros:c,ones:l,unitX:u,unitY:d,unitZ:h,unitW:f,ZEROS:p,ONES:b,UNIT_X:v,UNIT_Y:m,UNIT_Z:y,UNIT_W:g})},function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var n=r(113),i=r(1);function a(e,t,r){var a,o;return void 0===t?(o=e,a=[void 0]):"string"!=typeof t?(o=e,a=[void 0],r=t):(o=t,a=Array.isArray(e)?e:[e]),function(e,t){var s=e.constructor.prototype;a.forEach((function(a){var c=Object(i.c)(e,a,o);c.write&&"object"!=typeof c.write&&(c.write={}),r&&Object(n.c)("write.target",r,c),Object(n.c)("write.writer",s[t],c)}))}}},function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var n=r(42);function i(e,t,r){return(i="undefined"!==typeof Reflect&&Reflect.get?Reflect.get:function(e,t,r){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Object(n.a)(e)););return e}(e,t);if(i){var a=Object.getOwnPropertyDescriptor(i,t);return a.get?a.get.call(r):a.value}})(e,t,r||e)}},function(e,t,r){"use strict";r.d(t,"a",(function(){return h})),r.d(t,"b",(function(){return _})),r.d(t,"c",(function(){return w})),r.d(t,"d",(function(){return O})),r.d(t,"e",(function(){return j})),r.d(t,"f",(function(){return P})),r.d(t,"g",(function(){return g})),r.d(t,"h",(function(){return m})),r.d(t,"i",(function(){return x})),r.d(t,"j",(function(){return v})),r.d(t,"k",(function(){return p})),r.d(t,"l",(function(){return b})),r.d(t,"m",(function(){return y})),r.d(t,"n",(function(){return k})),r.d(t,"o",(function(){return f}));var n=r(2),i=r(5),a=r(20),o=(r(26),r(29)),s=r(38),c=(r(9),r(54)),l=r(43),u=Object(l.e)(),d=function(){function e(t){Object(n.a)(this,e),this.message=t}return Object(i.a)(e,[{key:"toString",value:function(){return"AssertException: ".concat(this.message)}}]),e}();function h(e,t){if(!e){t=t||"assert";var r=new Error(t);throw r.stack&&console.log(r.stack),new d(t)}}function f(e,t){e||(t=t||"",console.warn("Verify failed: "+t+"\n"+new Error("verify").stack))}function p(e,t,r,n){var i,a=(r[0]-e[0])/t[0],o=(n[0]-e[0])/t[0];a>o&&(i=a,a=o,o=i);var s=(r[1]-e[1])/t[1],c=(n[1]-e[1])/t[1];if(s>c&&(i=s,s=c,c=i),a>c||s>o)return!1;s>a&&(a=s),c<o&&(o=c);var l=(r[2]-e[2])/t[2],u=(n[2]-e[2])/t[2];return l>u&&(i=l,l=u,u=i),!(a>u||l>o)&&(u<o&&(o=u),!(o<0))}function b(e,t,r,n,i){var a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:Object(s.b)(),o=(n[i]-r[i])*(t[0]-e[0])-(n[0]-r[0])*(t[i]-e[i]),c=(n[0]-r[0])*(e[i]-r[i])-(n[i]-r[i])*(e[0]-r[0]);if(0===o)return!1;var l=c/o;return a[0]=e[0]+l*(t[0]-e[0]),a[1]=e[i]+l*(t[i]-e[i]),!0}function v(e,t,r,n,i){i||(i=e),u[0]=e[0],u[1]=e[1],u[2]=e[2],u[3]=1,Object(c.m)(u,u,t),i.length>2&&(i[2]=-u[2]),Object(c.m)(u,u,r),h(0!==u[3]),i[0]=u[0]/u[3],i[1]=u[1]/u[3],i[2]=u[2]/u[3],i[0]=(.5*i[0]+.5)*n[2]+n[0],i[1]=(.5*i[1]+.5)*n[3]+n[1]}function m(e,t){return Math.log(e)/Math.log(t)}function y(e,t,r,n){e[12]=t,e[13]=r,e[14]=n}function g(e){return 1===e[0]&&0===e[1]&&0===e[2]&&0===e[3]&&0===e[4]&&1===e[5]&&0===e[6]&&0===e[7]&&0===e[8]&&0===e[9]&&1===e[10]&&0===e[11]&&1===e[15]}function O(e,t,r){return 2*Math.atan(Math.sqrt(t*t+r*r)*Math.tan(.5*e)/t)}function j(e,t,r){return 2*Math.atan(Math.sqrt(t*t+r*r)*Math.tan(.5*e)/r)}function _(e,t,r){return 2*Math.atan(t*Math.tan(.5*e)/Math.sqrt(t*t+r*r))}function w(e,t,r){return 2*Math.atan(r*Math.tan(.5*e)/Math.sqrt(t*t+r*r))}function x(e,t){for(var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=Object(a.e)(e,0,C),i=0;i<4;i++)t[r+i]=Math.floor(256*M(n*S[i]))}function k(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=0,n=0;n<4;n++)r+=e[t+n]*T[n];return r}var S=[1,256,65536,16777216],T=[1/256,1/65536,1/16777216,1/4294967296],C=k(new Uint8ClampedArray([255,255,255,255]));function M(e){return e-Math.floor(e)}function P(e,t,r,n,i){var a=e;0===e[11]?(n[0]=2/(t*a[0]),n[1]=2/(r*a[5]),n[2]=(1+a[12])/a[0],n[3]=(1+a[13])/a[5],Object(o.r)(i,0,1)):(n[0]=-2/(t*a[0]),n[1]=-2/(r*a[5]),n[2]=(1-a[8])/a[0],n[3]=(1-a[9])/a[5],Object(o.r)(i,1,0))}},function(e,t,r){"use strict";r.d(t,"a",(function(){return m})),r.d(t,"b",(function(){return y})),r.d(t,"c",(function(){return b})),r.d(t,"d",(function(){return v}));var n=r(2),i=r(5),a=r(3),o=r(310),s=r(96),c=r(31),l=r(196),u=r(38),d=r(9),h=r(43),f=function(){function e(t,r,i){var a=this;Object(n.a)(this,e),this.itemByteSize=t,this.itemCreate=r,this.buffers=[],this.items=[],this.itemsPerBuffer=0,this.itemsPtr=0,this.itemsPerBuffer=Math.ceil(i/this.itemByteSize),this.tickHandle=o.a.before((function(){return a.reset()}))}return Object(i.a)(e,[{key:"destroy",value:function(){this.tickHandle&&(this.tickHandle.remove(),this.tickHandle=Object(a.p)(this.tickHandle)),this.itemsPtr=0,this.items=Object(a.p)(this.items),this.buffers=Object(a.p)(this.buffers)}},{key:"get",value:function(){0===this.itemsPtr&&Object(o.a)((function(){}));for(var e=Math.floor(this.itemsPtr/this.itemsPerBuffer);this.buffers.length<=e;){for(var t=new ArrayBuffer(this.itemsPerBuffer*this.itemByteSize),r=0;r<this.itemsPerBuffer;++r)this.items.push(this.itemCreate(t,r*this.itemByteSize));this.buffers.push(t)}return this.items[this.itemsPtr++]}},{key:"reset",value:function(){for(var e=2*(Math.floor(this.itemsPtr/this.itemsPerBuffer)+1);this.buffers.length>e;)this.buffers.pop(),this.items.length=this.buffers.length*this.itemsPerBuffer;this.itemsPtr=0}},{key:"test",get:function(){return{size:this.buffers.length*this.itemsPerBuffer*this.itemByteSize}}}],[{key:"createVec2f64",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:p;return new e(16,u.d,t)}},{key:"createVec3f64",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:p;return new e(24,d.d,t)}},{key:"createVec4f64",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:p;return new e(32,h.c,t)}},{key:"createMat3f64",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:p;return new e(72,s.a,t)}},{key:"createMat4f64",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:p;return new e(128,c.b,t)}},{key:"createQuatf64",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:p;return new e(32,l.d,t)}}]),e}(),p=4096,b=(f.createVec2f64(),f.createVec3f64()),v=f.createVec4f64(),m=(f.createMat3f64(),f.createMat4f64()),y=f.createQuatf64()},function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var n=r(113),i=r(1);function a(e,t,r){var a,o;return void 0===t||Array.isArray(t)?(o=e,r=t,a=[void 0]):(o=t,a=Array.isArray(e)?e:[e]),function(e,t){var s=e.constructor.prototype;a.forEach((function(a){var c=Object(i.c)(e,a,o);c.read&&"object"!=typeof c.read&&(c.read={}),Object(n.c)("read.reader",s[t],c),r&&(c.read.source=(c.read.source||[]).concat(r))}))}}},function(e,t,r){"use strict";var n=r(2),i=r(5),a=(r(50),{transparent:[0,0,0,0],black:[0,0,0,1],silver:[192,192,192,1],gray:[128,128,128,1],white:[255,255,255,1],maroon:[128,0,0,1],red:[255,0,0,1],purple:[128,0,128,1],fuchsia:[255,0,255,1],green:[0,128,0,1],lime:[0,255,0,1],olive:[128,128,0,1],yellow:[255,255,0,1],navy:[0,0,128,1],blue:[0,0,255,1],teal:[0,128,128,1],aqua:[0,255,255,1],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],blanchedalmond:[255,235,205,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],oldlace:[253,245,230,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],rebeccapurple:[102,51,153,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],whitesmoke:[245,245,245,1],yellowgreen:[154,205,5,10]});function o(e){var t;return null!=(t=a[e.toLowerCase()])?t:null}function s(e,t,r){r<0&&++r,r>1&&--r;var n=6*r;return n<1?e+(t-e)*n:2*r<1?t:3*r<2?e+(t-e)*(2/3-r)*6:e}var c=r(20),l=r(3),u=r(18);function d(e){return Object(c.e)(Object(u.e)(e),0,255)}function h(e,t,r){return e=Number(e),isNaN(e)?r:e<t?t:e>r?r:e}var f=function(){function e(t){Object(n.a)(this,e),this.r=255,this.g=255,this.b=255,this.a=1,t&&this.setColor(t)}return Object(i.a)(e,[{key:"isBright",get:function(){return.299*this.r+.587*this.g+.114*this.b>=127}},{key:"setColor",value:function(t){if("string"==typeof t)e.fromString(t,this);else if(Array.isArray(t))e.fromArray(t,this);else{var r,n,i,a;this._set(null!=(r=t.r)?r:0,null!=(n=t.g)?n:0,null!=(i=t.b)?i:0,null!=(a=t.a)?a:1),t instanceof e||this._sanitize()}return this}},{key:"toRgb",value:function(){return[this.r,this.g,this.b]}},{key:"toRgba",value:function(){return[this.r,this.g,this.b,this.a]}},{key:"toHex",value:function(){var e=this.r.toString(16),t=this.g.toString(16),r=this.b.toString(16);return"#".concat(e.length<2?"0"+e:e).concat(t.length<2?"0"+t:t).concat(r.length<2?"0"+r:r)}},{key:"toCss",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this.r+", "+this.g+", "+this.b;return e?"rgba(".concat(t,", ").concat(this.a,")"):"rgb(".concat(t,")")}},{key:"toString",value:function(){return this.toCss(!0)}},{key:"toJSON",value:function(){return this.toArray()}},{key:"toArray",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=d(this.r),r=d(this.g),n=d(this.b);return 0===e||1!==this.a?[t,r,n,d(255*this.a)]:[t,r,n]}},{key:"clone",value:function(){return new e(this.toRgba())}},{key:"hash",value:function(){return this.r<<24|this.g<<16|this.b<<8|255*this.a}},{key:"_sanitize",value:function(){return this.r=Math.round(h(this.r,0,255)),this.g=Math.round(h(this.g,0,255)),this.b=Math.round(h(this.b,0,255)),this.a=h(this.a,0,1),this}},{key:"_set",value:function(e,t,r,n){this.r=e,this.g=t,this.b=r,this.a=n}}],[{key:"blendColors",value:function(t,r,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new e;return i.r=Math.round(t.r+(r.r-t.r)*n),i.g=Math.round(t.g+(r.g-t.g)*n),i.b=Math.round(t.b+(r.b-t.b)*n),i.a=t.a+(r.a-t.a)*n,i._sanitize()}},{key:"fromRgb",value:function(t,r){var n=t.toLowerCase().match(/^(rgba?|hsla?)\(([\s\.\-,%0-9]+)\)/);if(n){var i=n[2].split(/\s*,\s*/),a=n[1];if("rgb"===a&&3===i.length||"rgba"===a&&4===i.length){var o=i[0];if("%"===o.charAt(o.length-1)){var c=i.map((function(e){return 2.56*parseFloat(e)}));return 4===i.length&&(c[3]=parseFloat(i[3])),e.fromArray(c,r)}return e.fromArray(i.map((function(e){return parseFloat(e)})),r)}if("hsl"===a&&3===i.length||"hsla"===a&&4===i.length)return e.fromArray(function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,i=(e%360+360)%360/360,a=r<=.5?r*(t+1):r+t-r*t,o=2*r-a;return[Math.round(256*s(o,a,i+1/3)),Math.round(256*s(o,a,i)),Math.round(256*s(o,a,i-1/3)),n]}(parseFloat(i[0]),parseFloat(i[1])/100,parseFloat(i[2])/100,parseFloat(i[3])),r)}return null}},{key:"fromHex",value:function(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new e;if(4!==t.length&&7!==t.length||"#"!==t[0])return null;var n=4===t.length?4:8,i=(1<<n)-1,a=Number("0x"+t.substr(1));return isNaN(a)?null:(["b","g","r"].forEach((function(e){var t=a&i;a>>=n,r[e]=4===n?17*t:t})),r.a=1,r)}},{key:"fromArray",value:function(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new e;return r._set(Number(t[0]),Number(t[1]),Number(t[2]),Number(t[3])),isNaN(r.a)&&(r.a=1),r._sanitize()}},{key:"fromString",value:function(t,r){var n=o(t);return n&&e.fromArray(n,r)||e.fromRgb(t,r)||e.fromHex(t,r)}},{key:"fromJSON",value:function(t){return t&&new e([t[0],t[1],t[2],t[3]/255])}},{key:"toUnitRGB",value:function(e){return Object(l.j)(e)?[e.r/255,e.g/255,e.b/255]:null}},{key:"toUnitRGBA",value:function(e){return Object(l.j)(e)?[e.r/255,e.g/255,e.b/255,null!=e.a?e.a:1]:null}}]),e}();f.prototype.declaredClass="esri.Color";t.a=f},function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r(433);var i=r(635),a=r(383);function o(e){return function(e){if(Array.isArray(e))return Object(n.a)(e)}(e)||Object(i.a)(e)||Object(a.a)(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}},function(e,t,r){"use strict";r.d(t,"a",(function(){return $e})),r.d(t,"b",(function(){return ve})),r.d(t,"c",(function(){return Ge})),r.d(t,"d",(function(){return Ue})),r.d(t,"e",(function(){return ge})),r.d(t,"f",(function(){return pe})),r.d(t,"g",(function(){return me})),r.d(t,"h",(function(){return le})),r.d(t,"i",(function(){return ue})),r.d(t,"j",(function(){return de})),r.d(t,"k",(function(){return Ne})),r.d(t,"l",(function(){return Je})),r.d(t,"m",(function(){return Xe})),r.d(t,"n",(function(){return he})),r.d(t,"o",(function(){return Ve})),r.d(t,"p",(function(){return ze})),r.d(t,"q",(function(){return De})),r.d(t,"r",(function(){return Fe})),r.d(t,"s",(function(){return fe})),r.d(t,"t",(function(){return je})),r.d(t,"u",(function(){return Pe})),r.d(t,"v",(function(){return Re})),r.d(t,"w",(function(){return ke})),r.d(t,"x",(function(){return Me})),r.d(t,"y",(function(){return Ce})),r.d(t,"z",(function(){return Ee})),r.d(t,"A",(function(){return Ie})),r.d(t,"B",(function(){return Ae})),r.d(t,"C",(function(){return nt}));var n,i,a,o,s,c=r(8),l=r.n(c),u=r(16),d=r(2),h=r(6),f=r(7),p=r(13),b=r(33),v=r(22),m=r(20),y=r(3),g=r(23),O=r(69),j=r(26),_=r(4),w=r(9),x=r(66),k=r(254),S=r(5),T=r(93),C=r(17),M=null;function P(){return!!M}function A(){return n||(n=Promise.all([r.e(133),r.e(146)]).then(r.bind(null,998)).then((function(e){return e.p})).then((function(e){return(0,e.default)({locateFile:function(e){return Object(T.b)("esri/geometry/support/".concat(e))}})})).then((function(e){B(e)})))}!function(e){function t(e,t,r){M.ensureCache.prepare();var n=H(r),i=r===n,a=M.ensureFloat64(n),o=M._pe_geog_to_proj(M.getPointer(e),t,a);return o&&W(r,t,a,i),o}function r(e,t,r){return n(e,t,r,0)}function n(e,t,r,n){M.ensureCache.prepare();var i=H(r),a=r===i,o=M.ensureFloat64(i),s=M._pe_proj_to_geog_center(M.getPointer(e),t,o,n);return s&&W(r,t,o,a),s}e.geogToProj=t,e.projGeog=function(e,n,i,o){switch(o){case a.PE_TRANSFORM_P_TO_G:return r(e,n,i);case a.PE_TRANSFORM_G_TO_P:return t(e,n,i)}return 0},e.projToGeog=r,e.projToGeogCenter=n}(i||(i={})),(s=a||(a={})).init=function(){s.PE_BUFFER_MAX=M.PeDefs.prototype.PE_BUFFER_MAX,s.PE_NAME_MAX=M.PeDefs.prototype.PE_NAME_MAX,s.PE_MGRS_MAX=M.PeDefs.prototype.PE_MGRS_MAX,s.PE_USNG_MAX=M.PeDefs.prototype.PE_USNG_MAX,s.PE_DD_MAX=M.PeDefs.prototype.PE_DD_MAX,s.PE_DDM_MAX=M.PeDefs.prototype.PE_DDM_MAX,s.PE_DMS_MAX=M.PeDefs.prototype.PE_DMS_MAX,s.PE_UTM_MAX=M.PeDefs.prototype.PE_UTM_MAX,s.PE_PARM_MAX=M.PeDefs.prototype.PE_PARM_MAX,s.PE_TYPE_NONE=M.PeDefs.prototype.PE_TYPE_NONE,s.PE_TYPE_GEOGCS=M.PeDefs.prototype.PE_TYPE_GEOGCS,s.PE_TYPE_PROJCS=M.PeDefs.prototype.PE_TYPE_PROJCS,s.PE_TYPE_GEOGTRAN=M.PeDefs.prototype.PE_TYPE_GEOGTRAN,s.PE_TYPE_COORDSYS=M.PeDefs.prototype.PE_TYPE_COORDSYS,s.PE_TYPE_UNIT=M.PeDefs.prototype.PE_TYPE_UNIT,s.PE_TYPE_LINUNIT=M.PeDefs.prototype.PE_TYPE_LINUNIT,s.PE_STR_OPTS_NONE=M.PeDefs.prototype.PE_STR_OPTS_NONE,s.PE_STR_AUTH_NONE=M.PeDefs.prototype.PE_STR_AUTH_NONE,s.PE_STR_AUTH_TOP=M.PeDefs.prototype.PE_STR_AUTH_TOP,s.PE_STR_NAME_CANON=M.PeDefs.prototype.PE_STR_NAME_CANON,s.PE_PARM_X0=M.PeDefs.prototype.PE_PARM_X0,s.PE_PARM_ND=M.PeDefs.prototype.PE_PARM_ND,s.PE_TRANSFORM_1_TO_2=M.PeDefs.prototype.PE_TRANSFORM_1_TO_2,s.PE_TRANSFORM_2_TO_1=M.PeDefs.prototype.PE_TRANSFORM_2_TO_1,s.PE_TRANSFORM_P_TO_G=M.PeDefs.prototype.PE_TRANSFORM_P_TO_G,s.PE_TRANSFORM_G_TO_P=M.PeDefs.prototype.PE_TRANSFORM_G_TO_P,s.PE_HORIZON_RECT=M.PeDefs.prototype.PE_HORIZON_RECT,s.PE_HORIZON_POLY=M.PeDefs.prototype.PE_HORIZON_POLY,s.PE_HORIZON_LINE=M.PeDefs.prototype.PE_HORIZON_LINE,s.PE_HORIZON_DELTA=M.PeDefs.prototype.PE_HORIZON_DELTA},function(e){var t={},r={},n=function(e){if(e){var t=e.getType();switch(t){case a.PE_TYPE_GEOGCS:e=M.castObject(e,M.PeGeogcs);break;case a.PE_TYPE_PROJCS:e=M.castObject(e,M.PeProjcs);break;case a.PE_TYPE_GEOGTRAN:e=M.castObject(e,M.PeGeogtran);break;default:t&a.PE_TYPE_UNIT&&(e=M.castObject(e,M.PeUnit))}}return e};function i(e,r){var i=null,a=t[e];if(a||(a={},t[e]=a),a.hasOwnProperty(String(r)))i=a[r];else{var o=M.PeFactory.prototype.factoryByType(e,r);M.compare(o,M.NULL)||(i=o,a[r]=i)}return i=n(i)}e.initialize=function(){M.PeFactory.prototype.initialize(null)},e.coordsys=function(e){return i(a.PE_TYPE_COORDSYS,e)},e.factoryByType=i,e.fromString=function(e,t){var i=null,a=r[e];if(a||(a={},r[e]=a),a.hasOwnProperty(t))i=a[t];else{var o=M.PeFactory.prototype.fromString(e,t);M.compare(o,M.NULL)||(i=o,a[t]=i)}return i=n(i)},e.geogcs=function(e){return i(a.PE_TYPE_GEOGCS,e)},e.geogtran=function(e){return i(a.PE_TYPE_GEOGTRAN,e)},e.getCode=function(e){return M.PeFactory.prototype.getCode(e)},e.projcs=function(e){return i(a.PE_TYPE_PROJCS,e)},e.unit=function(e){return i(a.PE_TYPE_UNIT,e)}}(o||(o={}));var E,R,I,D,F,L,z,V,N,U=null;function B(e){function t(e,t,r){e[t]=r(e[t])}M=e,a.init(),E.init(),F.init(),z.init(),V.init(),U=function(e){Object(h.a)(r,e);var t=Object(f.a)(r);function r(){return Object(d.a)(this,r),t.apply(this,arguments)}return Object(S.a)(r,[{key:"destroy",value:function(){M.destroy(this)}}]),r}(M.PeGCSExtent);for(var r=0,n=[M.PeDatum,M.PeGeogcs,M.PeGeogtran,M.PeObject,M.PeParameter,M.PePrimem,M.PeProjcs,M.PeSpheroid,M.PeUnit];r<n.length;r++){t(n[r].prototype,"getName",(function(e){return function(){return e.call(this,new Array(a.PE_NAME_MAX))}}))}for(var i=0,o=[M.PeGeogtran,M.PeProjcs];i<o.length;i++){t(o[i].prototype,"getParameters",(function(e){return function(){for(var t=new Array(a.PE_PARM_MAX),r=e.call(this),n=0;n<t.length;n++){var i=M.getValue(r,"*");t[n]=i?M.wrapPointer(i,M.PeParameter):null,r+=Int32Array.BYTES_PER_ELEMENT}return t}}))}t(M.PeHorizon.prototype,"getCoord",(function(e){return function(){var t=this.getSize();if(!t)return null;var r=[];return W(r,t,e.call(this)),r}})),t(M.PeGTlistExtendedEntry.prototype,"getEntries",(function(e){var t=M._pe_getPeGTlistExtendedGTsSize();return function(){var r=null,n=e.call(this);if(!M.compare(n,M.NULL)){r=[n];var i=this.getSteps();if(i>1)for(var a=M.getPointer(n),o=1;o<i;o++)r.push(M.wrapPointer(a+t*o,M.PeGTlistExtendedGTs))}return r}}));var s=M._pe_getPeHorizonSize(),c=function(e){return function(){var t=this._cache;if(t||(t=new Map,this._cache=t),t.has(e))return t.get(e);var r=null,n=e.call(this);if(!M.compare(n,M.NULL)){r=[n];var i=n.getNump();if(i>1)for(var a=M.getPointer(n),o=1;o<i;o++)r.push(M.wrapPointer(a+s*o,M.PeHorizon))}return t.set(e,r),r}};t(M.PeProjcs.prototype,"horizonGcsGenerate",c),t(M.PeProjcs.prototype,"horizonPcsGenerate",c),M.PeObject.prototype.toString=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:a.PE_STR_OPTS_NONE;M.ensureCache.prepare();var t=M.getPointer(this),r=M.ensureInt8(new Array(a.PE_BUFFER_MAX));return M.UTF8ToString(M._pe_object_to_string_ext(t,e,r))}}function G(e){if(e){var t=M.getClass(e);if(t){var r=M.getCache(t);if(r){var n=M.getPointer(e);n&&delete r[n]}}}}function q(e,t){for(var r=[],n=new Array(t),i=0;i<e;i++)r.push(M.ensureInt8(n));return r}function H(e){var t;return Array.isArray(e[0])?(t=[],e.forEach((function(e){t.push(e[0],e[1])}))):t=e,t}function W(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(n)for(var i=0;i<2*t;i++)e[i]=M.getValue(r+i*Float64Array.BYTES_PER_ELEMENT,"double");else for(var a=0===e.length,o=0;o<t;o++)a&&(e[o]=new Array(2)),e[o][0]=M.getValue(r,"double"),e[o][1]=M.getValue(r+Float64Array.BYTES_PER_ELEMENT,"double"),r+=2*Float64Array.BYTES_PER_ELEMENT}!function(e){var t;e.init=function(){e.PE_GTLIST_OPTS_COMMON=M.PeGTlistExtended.prototype.PE_GTLIST_OPTS_COMMON,t=M._pe_getPeGTlistExtendedEntrySize()},e.getGTlist=function(e,r,n,i,a,o){var s=null,c=new M.PeInteger(o);try{var l=M.PeGTlistExtended.prototype.getGTlist(e,r,n,i,a,c);if((o=c.val)&&(s=[l],o>1))for(var u=M.getPointer(l),d=1;d<o;d++)s.push(M.wrapPointer(u+t*d,M.PeGTlistExtendedEntry))}finally{M.destroy(c)}return s}}(E||(E={})),function(e){e.destroy=function(e){if(e&&e.length){var t,r=Object(p.a)(e);try{for(r.s();!(t=r.n()).done;){var n=t.value;G(n),n.getEntries().forEach((function(e){G(e);var t=e.getGeogtran();G(t),t.getParameters().forEach(G),[t.getGeogcs1(),t.getGeogcs2()].forEach((function(e){G(e);var t=e.getDatum();G(t),G(t.getSpheroid()),G(e.getPrimem()),G(e.getUnit())}))}))}}catch(i){r.e(i)}finally{r.f()}M.PeGTlistExtendedEntry.prototype.Delete(e[0])}}}(R||(R={})),function(e){e.geogToGeog=function(e,t,r,n,i){M.ensureCache.prepare();var a=H(r),o=r===a,s=M.ensureFloat64(a),c=0;n&&(c=M.ensureFloat64(n));var l=M._pe_geog_to_geog(M.getPointer(e),t,s,c,i);return l&&W(r,t,s,o),l}}(I||(I={})),function(e){var t=function(e,t,r,n,i,o){var s,c;switch(M.ensureCache.prepare(),e){case"dd":s=M._pe_geog_to_dd,c=a.PE_DD_MAX;break;case"ddm":s=M._pe_geog_to_ddm,c=a.PE_DDM_MAX;break;case"dms":s=M._pe_geog_to_dms,c=a.PE_DMS_MAX}var l=0;t&&(l=M.getPointer(t));var u=H(n),d=M.ensureFloat64(u),h=q(r,c),f=s(l,r,d,i,M.ensureInt32(h));if(f)for(var p=0;p<r;p++)o[p]=M.UTF8ToString(h[p]);return f},r=function(e,t,r,n,i){var a;switch(M.ensureCache.prepare(),e){case"dd":a=M._pe_dd_to_geog;break;case"ddm":a=M._pe_ddm_to_geog;break;case"dms":a=M._pe_dms_to_geog}var o=0;t&&(o=M.getPointer(t));var s=n.map((function(e){return M.ensureString(e)})),c=M.ensureInt32(s),l=M.ensureFloat64(new Array(2*r)),u=a(o,r,c,l);return u&&W(i,r,l),u};e.geog_to_dms=function(e,r,n,i,a){return t("dms",e,r,n,i,a)},e.dms_to_geog=function(e,t,n,i){return r("dms",e,t,n,i)},e.geog_to_ddm=function(e,r,n,i,a){return t("ddm",e,r,n,i,a)},e.ddm_to_geog=function(e,t,n,i){return r("ddm",e,t,n,i)},e.geog_to_dd=function(e,r,n,i,a){return t("dd",e,r,n,i,a)},e.dd_to_geog=function(e,t,n,i){return r("dd",e,t,n,i)}}(D||(D={})),function(e){e.init=function(){e.PE_MGRS_STYLE_NEW=M.PeNotationMgrs.prototype.PE_MGRS_STYLE_NEW,e.PE_MGRS_STYLE_OLD=M.PeNotationMgrs.prototype.PE_MGRS_STYLE_OLD,e.PE_MGRS_STYLE_AUTO=M.PeNotationMgrs.prototype.PE_MGRS_STYLE_AUTO,e.PE_MGRS_180_ZONE_1_PLUS=M.PeNotationMgrs.prototype.PE_MGRS_180_ZONE_1_PLUS,e.PE_MGRS_ADD_SPACES=M.PeNotationMgrs.prototype.PE_MGRS_ADD_SPACES},e.geog_to_mgrs_extended=function(e,t,r,n,i,o,s){M.ensureCache.prepare();var c=0;e&&(c=M.getPointer(e));var l=H(r),u=M.ensureFloat64(l),d=q(t,a.PE_MGRS_MAX),h=M.ensureInt32(d),f=M._pe_geog_to_mgrs_extended(c,t,u,n,i,o,h);if(f)for(var p=0;p<t;p++)s[p]=M.UTF8ToString(d[p]);return f},e.mgrs_to_geog_extended=function(e,t,r,n,i){M.ensureCache.prepare();var a=0;e&&(a=M.getPointer(e));var o=r.map((function(e){return M.ensureString(e)})),s=M.ensureInt32(o),c=M.ensureFloat64(new Array(2*t)),l=M._pe_mgrs_to_geog_extended(a,t,s,n,c);return l&&W(i,t,c),l}}(F||(F={})),function(e){e.geog_to_usng=function(e,t,r,n,i,o,s){M.ensureCache.prepare();var c=0;e&&(c=M.getPointer(e));var l=H(r),u=M.ensureFloat64(l),d=q(t,a.PE_MGRS_MAX),h=M.ensureInt32(d),f=M._pe_geog_to_usng(c,t,u,n,i,o,h);if(f)for(var p=0;p<t;p++)s[p]=M.UTF8ToString(d[p]);return f},e.usng_to_geog=function(e,t,r,n){M.ensureCache.prepare();var i=0;e&&(i=M.getPointer(e));var a=r.map((function(e){return M.ensureString(e)})),o=M.ensureInt32(a),s=M.ensureFloat64(new Array(2*t)),c=M._pe_usng_to_geog(i,t,o,s);return c&&W(n,t,s),c}}(L||(L={})),function(e){e.init=function(){e.PE_UTM_OPTS_NONE=M.PeNotationUtm.prototype.PE_UTM_OPTS_NONE,e.PE_UTM_OPTS_ADD_SPACES=M.PeNotationUtm.prototype.PE_UTM_OPTS_ADD_SPACES,e.PE_UTM_OPTS_NS=M.PeNotationUtm.prototype.PE_UTM_OPTS_NS},e.geog_to_utm=function(e,t,r,n,i){M.ensureCache.prepare();var o=0;e&&(o=M.getPointer(e));var s=H(r),c=M.ensureFloat64(s),l=q(t,a.PE_UTM_MAX),u=M.ensureInt32(l),d=M._pe_geog_to_utm(o,t,c,n,u);if(d)for(var h=0;h<t;h++)i[h]=M.UTF8ToString(l[h]);return d},e.utm_to_geog=function(e,t,r,n,i){M.ensureCache.prepare();var a=0;e&&(a=M.getPointer(e));var o=r.map((function(e){return M.ensureString(e)})),s=M.ensureInt32(o),c=M.ensureFloat64(new Array(2*t)),l=M._pe_utm_to_geog(a,t,s,n,c);return l&&W(i,t,c),l}}(z||(z={})),function(e){var t=new Map;e.init=function(){e.PE_PCSINFO_OPTION_NONE=M.PePCSInfo.prototype.PE_PCSINFO_OPTION_NONE,e.PE_PCSINFO_OPTION_DOMAIN=M.PePCSInfo.prototype.PE_PCSINFO_OPTION_DOMAIN,e.PE_POLE_OUTSIDE_BOUNDARY=M.PePCSInfo.prototype.PE_POLE_OUTSIDE_BOUNDARY,e.PE_POLE_POINT=M.PePCSInfo.prototype.PE_POLE_POINT},e.generate=function(r){var n,i,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.PE_PCSINFO_OPTION_DOMAIN;return t.has(r)&&((i=t.get(r))[a]&&(n=i[a])),n||(n=M.PePCSInfo.prototype.generate(r,a),i||(i=[],t.set(r,i)),i[a]=n),n}}(V||(V={})),function(e){e.version_string=function(){return M.PeVersion.prototype.version_string()}}(N||(N={}));var Q=Object.freeze({__proto__:null,get _pe(){return M},isLoaded:P,isSupported:function(){return!!Object(C.a)("esri-wasm")},load:A,get PeCSTransformations(){return i},get PeDefs(){return a},get PeFactory(){return o},get PeGCSExtent(){return U},get PeGTlistExtended(){return E},get PeGTlistExtendedEntry(){return R},get PeGTTransformations(){return I},get PeNotationDms(){return D},get PeNotationMgrs(){return F},get PeNotationUsng(){return L},get PeNotationUtm(){return z},get PePCSInfo(){return V},get PeVersion(){return N},_init:B}),Z=r(56),X=r(158),Y=r(176),$=r(68),J=r(40),K=r(72),ee=r(642),te=0,re=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;Object(d.a)(this,e),this.uid=te++,t?(this._wkt=void 0!==t.wkt?t.wkt:null,this._wkid=void 0!==t.wkid?t.wkid:-1,this._isInverse=void 0!==t.isInverse&&!0===t.isInverse):(this._wkt=null,this._wkid=-1,this._isInverse=!1)}return Object(S.a)(e,[{key:"wkt",get:function(){return this._wkt},set:function(e){this._wkt=e,this.uid=te++}},{key:"wkid",get:function(){return this._wkid},set:function(e){this._wkid=e,this.uid=te++}},{key:"isInverse",get:function(){return this._isInverse},set:function(e){this._isInverse=e,this.uid=te++}},{key:"getInverse",value:function(){var t=new e;return t._wkt=this.wkt,t._wkid=this._wkid,t._isInverse=!this.isInverse,t}}],[{key:"fromGE",value:function(t){var r=new e;return r._wkt=t.wkt,r._wkid=t.wkid,r._isInverse=t.isInverse,r}}]),e}(),ne=function(){function e(t){if(Object(d.a)(this,e),this.steps=[],this._cached_projection={},this._chain="",this._gtlistentry=null,t&&t.steps){var r,n=Object(p.a)(t.steps);try{for(n.s();!(r=n.n()).done;){var i=r.value;i instanceof re?this.steps.push(i):this.steps.push(new re({wkid:i.wkid,wkt:i.wkt,isInverse:i.isInverse}))}}catch(a){n.e(a)}finally{n.f()}}}return Object(S.a)(e,[{key:"getInverse",value:function(){var t=new e;t.steps=[];for(var r=this.steps.length-1;r>=0;r--){var n=this.steps[r];t.steps.push(n.getInverse())}return t}},{key:"getGTListEntry",value:function(){var e,t="",r=Object(p.a)(this.steps);try{for(r.s();!(e=r.n()).done;){t+=e.value.uid.toString()+","}}catch(n){r.e(n)}finally{r.f()}return t!==this._chain&&(this._gtlistentry=null,this._cached_projection={},this._chain=t),this._gtlistentry}},{key:"assignCachedGe",value:function(t,r,n){this._cached_projection[e.cacheKey(t,r)]=n}},{key:"getCachedGeTransformation",value:function(t,r){var n,i="",a=Object(p.a)(this.steps);try{for(a.s();!(n=a.n()).done;){i+=n.value.uid.toString()+","}}catch(s){a.e(s)}finally{a.f()}i!==this._chain&&(this._gtlistentry=null,this._cached_projection={},this._chain=i);var o=this._cached_projection[e.cacheKey(t,r)];return void 0===o?null:o}}],[{key:"cacheKey",value:function(e,t){return[void 0!==e.wkid&&null!==e.wkid?e.wkid.toString():"-1",void 0!==e.wkt&&null!==e.wkt?e.wkt.toString():"",void 0!==t.wkid&&null!==t.wkid?t.wkid.toString():"-1",void 0!==t.wkt&&null!==t.wkt?t.wkt.toString():""].join(",")}},{key:"fromGE",value:function(t){var r,n=new e,i="",a=Object(p.a)(t.steps);try{for(a.s();!(r=a.n()).done;){var o=r.value,s=re.fromGE(o);n.steps.push(s),i+=s.uid.toString()+","}}catch(c){a.e(c)}finally{a.f()}return n._cached_projection={},n._gtlistentry=null,n._chain=i,n}}]),e}(),ie=r(59),ae=null,oe=null,se=null,ce={};function le(){return!!ae&&P()}function ue(){return!0}function de(e){return Object(y.i)(se)&&(se=Promise.all([A(),r.e(4).then(r.bind(null,799)).then((function(e){return e.g})),r.e(155).then(r.bind(null,829))])),se.then((function(t){var r=Object(b.a)(t,3),n=r[1],i=r[2].hydratedAdapter;Object(g.x)(e),oe=i,(ae=n.default)._enableProjection(Q)}))}function he(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return Array.isArray(e)?0===e.length?[]:fe(oe,e,e[0].spatialReference,t,r):fe(oe,[e],e.spatialReference,t,r)[0]}function fe(e,t,r,n){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;if(Object(y.i)(r)||Object(y.i)(n))return t;if(ve(r,n,i))return t.map((function(e){return Oe(e,r,n)}));if(Object(y.i)(i)){var a=ne.cacheKey(r,n);void 0!==ce[a]?i=ce[a]:(i=pe(r,n,null),Object(y.i)(i)&&(i=new ne),ce[a]=i)}if(Object(y.i)(ae))throw new be;return ae._project(e,t,r,n,i)}function pe(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(Object(y.i)(ae))throw new be;if(Object(y.i)(e)||Object(y.i)(t))return null;var n=ae._getTransformation(oe,e,t,r,null==r?void 0:r.spatialReference);return null!==n?ne.fromGE(n):null}var be=function(e){Object(h.a)(r,e);var t=Object(f.a)(r);function r(){return Object(d.a)(this,r),t.call(this,"projection:not-loaded","projection engine not fully loaded yet, please call load()")}return r}(v.a);function ve(e,t,r){return!r&&(!!Object(ie.c)(e,t)||Object(ie.j)(e)&&Object(ie.j)(t)&&!!pt(e,t,gt))}function me(e,t,r,n){return ye.apply(this,arguments)}function ye(){return(ye=Object(u.a)(l.a.mark((function e(t,r,n,i){var a,o,s,c,u,d;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(le()){e.next=23;break}if(!Array.isArray(t)){e.next=21;break}a=Object(p.a)(t),e.prev=3,a.s();case 5:if((o=a.n()).done){e.next=11;break}if(s=o.value,c=s.source,u=s.dest,d=s.geographicTransformation,ve(c,u,d)){e.next=9;break}return e.abrupt("return",de(i));case 9:e.next=5;break;case 11:e.next=16;break;case 13:e.prev=13,e.t0=e.catch(3),a.e(e.t0);case 16:return e.prev=16,a.f(),e.finish(16);case 19:e.next=23;break;case 21:if(ve(t,r,n)){e.next=23;break}return e.abrupt("return",de(i));case 23:case"end":return e.stop()}}),e,null,[[3,13,16,19]])})))).apply(this,arguments)}function ge(e,t){switch(pt(e,t,gt)){case He:return"copy3";case rt:return"wgs84ToSphericalECEF";case Ye:return"wgs84ToWebMercator";case lt:return"wgs84ToWGS84ECEF";case We:return"webMercatorToWGS84";case Qe:return"webMercatorToSphericalECEF";case Ze:return"webMercatorToWGS84ECEF";case ut:return"wgs84ECEFToWGS84";case dt:return"wgs84ECEFToSphericalECEF";case ht:return"wgs84ECEFToWebMercator";case ot:return"sphericalECEFToWGS84";case st:return"sphericalECEFToWebMercator";case at:return"sphericalMarsPCPFToMars2000";case it:return"sphericalMoonPCPFToMoon2000";case ct:return"sphericalECEFToWGS84ECEF";case tt:return"mars2000ToSphericalPCPF";case et:return"moon2000ToSphericalPCPF";default:return null}}function Oe(e,t,r){if(!e)return e;if("x"in e){var n=new Z.a;return _e(e,t,n,r)?n:null}if("xmin"in e){var i=new x.a;return Te(e,t,i,r)?i:null}if("rings"in e){var a=new X.a;return Se(e,t,a,r)?a:null}if("paths"in e){var o=new Y.a;return xe(e,t,o,r)?o:null}if("points"in e){var s=new k.a;return we(e,t,s,r)?s:null}return null}function je(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t.spatialReference,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;return!Object(y.i)(r)&&_e(e,e.spatialReference,t,r,n)}function _e(e,t,r,n){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;St[0]=e.x,St[1]=e.y;var a=e.z;return St[2]=void 0!==a?a:i,!!De(St,t,0,St,n,0,1)&&(r.x=St[0],r.y=St[1],r.spatialReference=n,void 0===a?(r.z=void 0,r.hasZ=!1):(r.z=St[2],r.hasZ=!0),void 0===e.m?(r.m=void 0,r.hasM=!1):(r.m=e.m,r.hasM=!0),!0)}function we(e,t,r,n){var i,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,o=e.points,s=e.hasZ,c=e.hasM,l=[],u=o.length,d=[],h=Object(p.a)(o);try{for(h.s();!(i=h.n()).done;){var f=i.value;d.push(f[0],f[1],s?f[2]:a)}}catch(g){h.e(g)}finally{h.f()}if(!De(d,t,0,d,n,0,u))return!1;for(var b=0;b<u;++b){var v=3*b,m=d[v],y=d[v+1];s&&c?l.push([m,y,d[v+2],o[b][3]]):s?l.push([m,y,d[v+2]]):c?l.push([m,y,o[b][2]]):l.push([m,y])}return r.points=l,r.spatialReference=n,r.hasZ=s,r.hasM=c,!0}function xe(e,t,r,n){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,a=e.paths,o=e.hasZ,s=e.hasM,c=[];return!!Le(a,o,s,t,c,n,i)&&(r.paths=c,r.spatialReference=n,r.hasZ=o,r.hasM=s,!0)}function ke(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t.spatialReference,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;return!Object(y.i)(r)&&Se(e,e.spatialReference,t,r,n)}function Se(e,t,r,n){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,a=e.rings,o=e.hasZ,s=e.hasM,c=[];return!!Le(a,o,s,t,c,n,i)&&(r.rings=c,r.spatialReference=n,r.hasZ=o,r.hasM=s,!0)}function Te(e,t,r,n){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,a=e.xmin,o=e.ymin,s=e.xmax,c=e.ymax,l=e.hasZ,u=e.hasM;return!!Ae(a,o,l?e.zmin:i,t,St,n)&&(r.xmin=St[0],r.ymin=St[1],l&&(r.zmin=St[2]),!!Ae(s,c,l?e.zmax:i,t,St,n)&&(r.xmax=St[0],r.ymax=St[1],l&&(r.zmax=St[2]),u&&(r.mmin=e.mmin,r.mmax=e.mmax),r.spatialReference=n,!0))}function Ce(e,t,r){if(Object(y.i)(t)||Object(y.i)(r))return null;var n=new Z.a({spatialReference:r});return De(e,t,0,St,r,0,1)?(n.x=St[0],n.y=St[1],n.z=St[2],n):null}function Me(e,t,r){return De(e,t,0,St,r.spatialReference,0,1)?(r.x=St[0],r.y=St[1],r.z=St[2],r):null}function Pe(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;St[0]=e.x,St[1]=e.y;var i=e.z;return St[2]=void 0!==i?i:n,De(St,e.spatialReference,0,t,r,0,1)}function Ae(e,t,r,n,i,a){return wt[0]=e,wt[1]=t,wt[2]=r,De(wt,n,0,i,a,0,1)}function Ee(e,t,r,n){return!(Object(y.i)(t)||Object(y.i)(n)||e.length<2)&&(2===e.length&&(wt[0]=e[0],wt[1]=e[1],wt[2]=0,e=wt),De(e,t,0,r,n,0,1))}function Re(e,t){St[0]=e.x,St[1]=e.y;var r=e.z;return St[2]=void 0!==r?r:0,Ie(St,e.spatialReference,t)}function Ie(e,t,r){return function(e,t,r){if(Object(y.i)(t))return!1;var n=qe(t,mt),i=ft[n][6];return!Object(y.i)(i)&&(i(e,0,wt,0),r!==wt&&(r[0]=wt[0],r[1]=wt[1],r.length>2&&(r[2]=wt[2])),!0)}(e,t,r)}function De(e,t,r,n,i,a){var o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:1,s=pt(t,i,gt);if(Object(y.i)(s))return!1;if(s===He){if(e===n&&r===a)return!0;for(var c=r+3*o,l=r,u=a;l<c;l++,u++)n[u]=e[l];return!0}for(var d=r+3*o,h=r,f=a;h<d;h+=3,f+=3)s(e,h,n,f);return!0}function Fe(e,t,r,n,i){Object(_.m)(St,e),Object(_.h)(Tt,e,t),Ee(St,r,St,i),Ee(Tt,r,Tt,i),Object(_.l)(n,Tt,St),Object(_.t)(n,n)}function Le(e,t,r,n,i,a){var o,s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,c=new Array,l=Object(p.a)(e);try{for(l.s();!(o=l.n()).done;){var u,d=o.value,h=Object(p.a)(d);try{for(h.s();!(u=h.n()).done;){var f=u.value;c.push(f[0],f[1],t?f[2]:s)}}catch(w){h.e(w)}finally{h.f()}}}catch(w){l.e(w)}finally{l.f()}if(!De(c,n,0,c,a,0,c.length/3))return!1;var b=0;i.length=0;var v,m=Object(p.a)(e);try{for(m.s();!(v=m.n()).done;){var y,g=v.value,O=new Array,j=Object(p.a)(g);try{for(j.s();!(y=j.n()).done;){var _=y.value;t&&r?O.push([c[b++],c[b++],c[b++],_[3]]):t?O.push([c[b++],c[b++],c[b++]]):r?(O.push([c[b++],c[b++],_[2]]),b++):(O.push([c[b++],c[b++]]),b++)}}catch(w){j.e(w)}finally{j.f()}i.push(O)}}catch(w){m.e(w)}finally{m.f()}return!0}function ze(e,t,r,n){if(Object(y.i)(t)||Object(y.i)(n))return!1;var i=bt(t,n,Ot);if(i.projector===He)return r[0]=e[0],r[1]=e[1],r[2]=e[2],r[3]=e[3],!0;if(Object(y.i)(i.projector))return!1;var a=i.source,o=i.dest;if(3===o.spatialReferenceId){var s=ft[a.spatialReferenceId][2];if(Object(y.i)(s))return!1;s(e,0,xt,0);var c=Math.abs(jt*xt[1])+Math.asin(e[3]/(K.a.radius+e[2]));if(Ye(xt,0,r,0),c>.9999*Math.PI)r[3]=Number.MAX_VALUE;else{var l=1/Math.cos(c);r[3]=l*e[3]}return!0}return i.projector(e,0,r,0),r[3]=e[3]*a.metersPerUnit/o.metersPerUnit,!0}function Ve(e,t,r,n){return null!=e&&(Object(ie.c)(t,n)?(Object(J.y)(r,e),!0):(wt[0]=e[0],wt[1]=e[1],wt[2]=0,!!De(wt,t,0,wt,n,0,1)&&(r[0]=wt[0],r[1]=wt[1],wt[0]=e[2],wt[1]=e[3],wt[2]=0,!!De(wt,t,0,wt,n,0,1)&&(r[2]=wt[0],r[3]=wt[1],!0))))}function Ne(e,t,r,n){if(Object(y.i)(t)||Object(y.i)(n))return!1;var i=qe(t,mt),a=qe(n,yt);if(i===a&&0!==i||Object(ie.c)(t,n))return r[0]=1,r[1]=1,r[2]=1,!0;if(1===i){var o=Object(_.r)(e),s=o/Math.sqrt(e[0]*e[0]+e[1]*e[1]),c=o/K.a.radius;if(3===a)return r[0]=s*c,r[1]=s*c,r[2]=1,!0;if(2===a||5===a){var l=180/(K.a.radius*Math.PI);return r[0]=l*s*c,r[1]=l*c,r[2]=1,!0}}return!1}function Ue(e,t,r,n){if(Object(y.i)(e)||Object(y.i)(n))return!1;var i=qe(e,mt),a=qe(n,yt);if(i===a&&!Be(a)&&(0!==i||Object(ie.c)(e,n)))return Object(j.i)(r),Object(j.t)(r,r,t),!0;if(Be(a)){var o=0,s=ft[i][11],c=ft[11][a];return!Object(y.i)(s)&&!Object(y.i)(c)&&(s(t,0,xt,0),c(xt,0,kt,0),o=jt*xt[0],Ge(jt*xt[1],o,r),r[12]=kt[0],r[13]=kt[1],r[14]=kt[2],!0)}if(3===a&&(2===i||1===i)){var l=ft[i][11];if(Object(y.i)(l))return!1;l(t,0,xt,0);var u=jt*xt[1];Ye(xt,0,kt,0),Object(j.i)(r),Object(j.t)(r,r,kt);var d=1/Math.cos(u);return Object(j.s)(r,r,[d,d,1]),!0}return!1}function Be(e){return 1===e||7===e||9===e}function Ge(e,t,r){var n=Math.sin(t),i=Math.cos(t),a=Math.sin(e),o=Math.cos(e),s=r;return s[0]=-n,s[4]=-a*i,s[8]=o*i,s[12]=0,s[1]=i,s[5]=-a*n,s[9]=o*n,s[13]=0,s[2]=0,s[6]=o,s[10]=a,s[14]=0,s[3]=0,s[7]=0,s[11]=0,s[15]=1,s}function qe(e,t){return t.spatialReference===e?t.spatialReferenceId:(t.spatialReference=e,"metersPerUnit"in t&&(t.metersPerUnit=Object(O.f)(e,1)),e.wkt===$.a.wkt?t.spatialReferenceId=1:Object(ie.k)(e)?t.spatialReferenceId=2:Object(ie.n)(e)?t.spatialReferenceId=3:e.wkt===$.d.wkt?t.spatialReferenceId=4:4490===e.wkid?t.spatialReferenceId=5:e.wkt===$.b.wkt?t.spatialReferenceId=7:e.wkt===$.c.wkt?t.spatialReferenceId=9:Object(ie.h)(e)?t.spatialReferenceId=8:Object(ie.i)(e)?t.spatialReferenceId=10:t.spatialReferenceId=0)}function He(e,t,r,n){e!==r&&(r[n++]=e[t++],r[n++]=e[t++],r[n]=e[t])}function We(e,t,r,n){r[n++]=_t*(e[t++]/K.a.radius),r[n++]=_t*(Math.PI/2-2*Math.atan(Math.exp(-1*e[t++]/K.a.radius))),r[n]=e[t]}function Qe(e,t,r,n){We(e,t,r,n),rt(r,n,r,n)}function Ze(e,t,r,n){We(e,t,r,n),lt(r,n,r,n)}function Xe(e,t,r,n,i){var a=.4999999*Math.PI,o=Object(m.e)(jt*e[t+1],-a,a),s=Math.sin(o);r[n++]=jt*e[t]*i.radius,r[n++]=i.halfSemiMajorAxis*Math.log((1+s)/(1-s)),r[n]=e[t+2]}function Ye(e,t,r,n){Xe(e,t,r,n,K.a)}function $e(e){if(Object(y.i)(e))return!1;var t=qe(e,mt);return!!ft[t][6]}function Je(e,t,r,n){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,a=n+i,o=Math.cos(r);e[0]=Math.cos(t)*o*a,e[1]=Math.sin(t)*o*a,e[2]=Math.sin(r)*a}function Ke(e,t,r,n,i){var a=i+e[t+2],o=jt*e[t+1],s=jt*e[t],c=Math.cos(o);r[n++]=Math.cos(s)*c*a,r[n++]=Math.sin(s)*c*a,r[n]=Math.sin(o)*a}function et(e,t,r,n){Ke(e,t,r,n,K.c.radius)}function tt(e,t,r,n){Ke(e,t,r,n,K.b.radius)}function rt(e,t,r,n){Ke(e,t,r,n,K.a.radius)}function nt(e,t,r,n,i){var a=e[t],o=e[t+1],s=e[t+2],c=Math.sqrt(a*a+o*o+s*s),l=Object(m.c)(s/(0===c?1:c)),u=Math.atan2(o,a);r[n++]=_t*u,r[n++]=_t*l,r[n]=c-i}function it(e,t,r,n){nt(e,t,r,n,K.c.radius)}function at(e,t,r,n){nt(e,t,r,n,K.b.radius)}function ot(e,t,r,n){nt(e,t,r,n,K.a.radius)}function st(e,t,r,n){ot(e,t,r,n),Ye(r,n,r,n)}function ct(e,t,r,n){ot(e,t,r,n),lt(r,n,r,n)}function lt(e,t,r,n){!function(e,t,r,n,i){var a=jt*e[t],o=jt*e[t+1],s=e[t+2],c=Math.sin(o),l=Math.cos(o),u=i.radius/Math.sqrt(1-i.eccentricitySquared*c*c);r[n++]=(u+s)*l*Math.cos(a),r[n++]=(u+s)*l*Math.sin(a),r[n++]=(u*(1-i.eccentricitySquared)+s)*c}(e,t,r,n,K.a)}function ut(e,t,r,n){var i,a,o,s,c,l,u,d,h,f,p,b,v,m,y,g,O,j,_,w,x,k=ee.b,S=e[t],T=e[t+1],C=e[t+2];i=Math.abs(C),a=S*S+T*T,o=Math.sqrt(a),s=a+C*C,c=Math.sqrt(s),w=Math.atan2(T,S),l=C*C/s,u=a/s,m=k.a2/c,y=k.a3-k.a4/c,u>.3?(d=i/c*(1+u*(k.a1+m+l*y)/c),_=Math.asin(d),f=d*d,h=Math.sqrt(1-f)):(h=o/c*(1-l*(k.a5-m-u*y)/c),_=Math.acos(h),f=1-h*h,d=Math.sqrt(f)),p=1-K.a.eccentricitySquared*f,b=K.a.radius/Math.sqrt(p),_+=j=(g=h*(y=i-(v=k.a6*b)*d)-d*(m=o-b*h))/(v/p+(O=h*m+d*y)),x=O+g*j/2,C<0&&(_=-_),r[n++]=_t*w,r[n++]=_t*_,r[n]=x}function dt(e,t,r,n){ut(e,t,r,n),rt(r,n,r,n)}function ht(e,t,r,n){ut(e,t,r,n),Ye(r,n,r,n)}var ft={2:{5:null,8:null,10:null,11:He,6:He,1:rt,7:null,9:null,0:null,3:Ye,2:He,4:lt},5:{5:He,8:null,10:null,11:He,6:He,1:rt,7:null,9:null,0:null,3:null,2:null,4:lt},8:{5:null,8:He,10:null,11:He,6:null,1:null,7:tt,9:null,0:null,3:null,2:null,4:null},10:{5:null,8:null,10:He,11:He,6:null,1:null,7:null,9:et,0:null,3:null,2:null,4:null},3:{5:null,8:null,10:null,11:We,6:We,1:Qe,7:null,9:null,0:null,3:He,2:We,4:Ze},4:{5:ut,8:null,10:null,11:ut,6:ut,1:dt,7:null,9:null,0:null,3:ht,2:ut,4:He},1:{5:ot,8:null,10:null,11:ot,6:ot,1:He,7:null,9:null,0:null,3:st,2:ot,4:ct},7:{5:null,8:at,10:null,11:at,6:null,1:null,7:He,9:null,0:null,3:null,2:null,4:null},9:{5:null,8:null,10:it,11:it,6:null,1:null,7:null,9:He,0:null,3:null,2:null,4:null},0:{5:null,8:null,10:null,11:null,6:null,1:null,7:null,9:null,0:He,3:null,2:null,4:null},11:{5:He,8:He,10:He,11:He,6:He,1:rt,7:tt,9:et,0:null,3:Ye,2:He,4:lt},6:{5:null,8:null,10:null,11:He,6:He,1:rt,7:null,9:null,0:null,3:null,2:He,4:lt}};function pt(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:vt();return Object(y.i)(e)||Object(y.i)(t)?null:bt(e,t,r).projector}function bt(e,t,r){if(Object(y.i)(e)||Object(y.i)(t)||r.source.spatialReference===e&&r.dest.spatialReference===t)return r;var n=qe(e,r.source),i=qe(t,r.dest);return 0===n&&0===i?Object(ie.c)(e,t)?r.projector=He:r.projector=null:r.projector=ft[n][i],r}function vt(){return{source:{spatialReference:null,spatialReferenceId:0,metersPerUnit:1},dest:{spatialReference:null,spatialReferenceId:0,metersPerUnit:1},projector:He}}var mt={spatialReference:null,spatialReferenceId:0},yt={spatialReference:null,spatialReferenceId:0},gt=vt(),Ot=vt(),jt=Object(m.g)(1),_t=Object(m.r)(1),wt=Object(w.e)(),xt=Object(w.e)(),kt=Object(w.e)(),St=Object(w.e)(),Tt=Object(w.e)()},function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var n=r(58),i=r(1);function a(e){var t,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=e instanceof n.a?e:new n.a(e,r),o={type:null==(t=null==r?void 0:r.ignoreUnknown)||t?a.apiValues:String,readOnly:null==r?void 0:r.readOnly,json:{type:a.jsonValues,read:(null==r||!r.readOnly)&&{reader:a.read},write:{writer:a.write}}};return void 0!==(null==r?void 0:r.default)&&(o.json.default=r.default),void 0!==(null==r?void 0:r.name)&&(o.json.name=r.name),Object(i.b)(o)}},function(e,t,r){"use strict";var n,i=r(13),a=r(50),o=r(8),s=r.n(o),c=r(19),l=r(6),u=r(7),d=r(2),h=r(5),f=r(0),p=r(184),b=r(82),v=r(25),m=r(3),y=r(117),g=r(141),O=r(18),j=r(80),_=r(1),w=r(10),x=r(500),k=function(){function e(){Object(d.a)(this,e),this._observers=[]}return Object(h.a)(e,[{key:"observe",value:function(e){return this._observers.includes(e)||this._observers.push(e),new x.a(this._observers,e)}},{key:"notify",value:function(){for(var e=this._observers.slice(),t=0;t<e.length;++t){var r=e[t];r.onInvalidated(),r.onCommitted()}}}]),e}(),S=function(){function e(){Object(d.a)(this,e),this.target=null,this.cancellable=!1,this.defaultPrevented=!1,this.item=void 0,this.type=void 0}return Object(h.a)(e,[{key:"preventDefault",value:function(){this.cancellable&&(this.defaultPrevented=!0)}},{key:"reset",value:function(e){this.defaultPrevented=!1,this.item=e}}]),e}(),T=new y.a(S,void 0,(function(e){e.item=null,e.target=null,e.defaultPrevented=!1,e.cancellable=!1})),C=function(){};function M(e){return e?e instanceof z?e.toArray():e.length?Array.prototype.slice.apply(e):[]:[]}function P(e){if(e&&e.length)return e[0]}function A(e,t,r,n){for(var i=Math.min(e.length-r,t.length-n),a=0;a<i&&e[r+a]===t[n+a];)a++;return a}function E(e,t,r,n){t&&t.forEach((function(t,i,a){e.push(t),E(e,r.call(n,t,i,a),r,n)}))}var R=new Set,I=new Set,D=new Set,F=new Map,L=0,z=n=function(e,t){Object(l.a)(o,e);var r=Object(u.a)(o);function o(e){var t;return Object(d.a)(this,o),(t=r.call(this,e))._chgListeners=[],t._notifications=null,t._timer=null,t._observable=new k,t.length=0,t._items=[],Object.defineProperty(Object(c.a)(t),"uid",{value:L++}),t}return Object(h.a)(o,[{key:"normalizeCtorArgs",value:function(e){return e?Array.isArray(e)||e instanceof n?{items:e}:e:{}}},{key:t,value:s.a.mark((function e(){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.delegateYield(this.items,"t0",1);case 1:case"end":return e.stop()}}),e,this)}))},{key:"items",get:function(){return Object(j.c)(this._observable),this._items}},{key:"items",set:function(e){this._emitBeforeChanges(1)||(this._splice.apply(this,[0,this.length].concat(Object(a.a)(M(e)))),this._emitAfterChanges(1))}},{key:"hasEventListener",value:function(e){return"change"===e?this._chgListeners.length>0:this._emitter.hasEventListener(e)}},{key:"on",value:function(e,t){if("change"===e){var r=this._chgListeners,n={removed:!1,callback:t};return r.push(n),this._notifications&&this._notifications.push({listeners:r.slice(),items:this._items.slice(),changes:[]}),{remove:function(){this.remove=C,n.removed=!0,r.splice(r.indexOf(n),1)}}}return this._emitter.on(e,t)}},{key:"once",value:function(e,t){var r=this.on(e,t);return{remove:function(){r.remove()}}}},{key:"add",value:function(e,t){if(Object(j.c)(this._observable),this._emitBeforeChanges(1))return this;var r=this.getNextIndex(null!=t?t:null);return this._splice(r,0,e),this._emitAfterChanges(1),this}},{key:"addMany",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this._items.length;if(Object(j.c)(this._observable),!e||!e.length)return this;if(this._emitBeforeChanges(1))return this;var r=this.getNextIndex(t);return this._splice.apply(this,[r,0].concat(Object(a.a)(M(e)))),this._emitAfterChanges(1),this}},{key:"removeAll",value:function(){if(Object(j.c)(this._observable),!this.length||this._emitBeforeChanges(2))return[];var e=this._splice(0,this.length)||[];return this._emitAfterChanges(2),e}},{key:"clone",value:function(){return Object(j.c)(this._observable),this._createNewInstance({items:this._items.map(v.a)})}},{key:"concat",value:function(){var e;Object(j.c)(this._observable);for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];var i=r.map(M);return this._createNewInstance({items:(e=this._items).concat.apply(e,Object(a.a)(i))})}},{key:"drain",value:function(e,t){if(Object(j.c)(this._observable),this.length&&!this._emitBeforeChanges(2)){for(var r=Object(m.d)(this._splice(0,this.length)),n=r.length,i=0;i<n;i++)e.call(t,r[i],i,r);this._emitAfterChanges(2)}}},{key:"every",value:function(e,t){return Object(j.c)(this._observable),this._items.every(e,t)}},{key:"filter",value:function(e,t){var r;return Object(j.c)(this._observable),r=2===arguments.length?this._items.filter(e,t):this._items.filter(e),this._createNewInstance({items:r})}},{key:"find",value:function(e,t){return Object(j.c)(this._observable),this._items.find(e,t)}},{key:"findIndex",value:function(e,t){return Object(j.c)(this._observable),this._items.findIndex(e,t)}},{key:"flatten",value:function(e,t){Object(j.c)(this._observable);var r=[];return E(r,this,e,t),new n(r)}},{key:"forEach",value:function(e,t){return Object(j.c)(this._observable),this._items.forEach(e,t)}},{key:"getItemAt",value:function(e){return Object(j.c)(this._observable),this._items[e]}},{key:"getNextIndex",value:function(e){Object(j.c)(this._observable);var t=this.length;return(e=null==e?t:e)<0?e=0:e>t&&(e=t),e}},{key:"includes",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return Object(j.c)(this._observable),this._items.includes(e,t)}},{key:"indexOf",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return Object(j.c)(this._observable),this._items.indexOf(e,t)}},{key:"join",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:",";return Object(j.c)(this._observable),this._items.join(e)}},{key:"lastIndexOf",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.length-1;return Object(j.c)(this._observable),this._items.lastIndexOf(e,t)}},{key:"map",value:function(e,t){Object(j.c)(this._observable);var r=this._items.map(e,t);return new n({items:r})}},{key:"reorder",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.length-1;Object(j.c)(this._observable);var r=this.indexOf(e);if(-1!==r){if(t<0?t=0:t>=this.length&&(t=this.length-1),r!==t){if(this._emitBeforeChanges(4))return e;this._splice(r,1),this._splice(t,0,e),this._emitAfterChanges(4)}return e}}},{key:"pop",value:function(){if(Object(j.c)(this._observable),this.length&&!this._emitBeforeChanges(2)){var e=P(this._splice(this.length-1,1));return this._emitAfterChanges(2),e}}},{key:"push",value:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return Object(j.c)(this._observable),this._emitBeforeChanges(1)||(this._splice.apply(this,[this.length,0].concat(t)),this._emitAfterChanges(1)),this.length}},{key:"reduce",value:function(e,t){Object(j.c)(this._observable);var r=this._items;return 2===arguments.length?r.reduce(e,t):r.reduce(e)}},{key:"reduceRight",value:function(e,t){Object(j.c)(this._observable);var r=this._items;return 2===arguments.length?r.reduceRight(e,t):r.reduceRight(e)}},{key:"remove",value:function(e){return Object(j.c)(this._observable),this.removeAt(this.indexOf(e))}},{key:"removeAt",value:function(e){if(Object(j.c)(this._observable),!(e<0||e>=this.length||this._emitBeforeChanges(2))){var t=P(this._splice(e,1));return this._emitAfterChanges(2),t}}},{key:"removeMany",value:function(e){if(Object(j.c)(this._observable),!e||!e.length||this._emitBeforeChanges(2))return[];for(var t=e instanceof n?e.toArray():e,r=this._items,i=[],a=t.length,o=0;o<a;o++){var s=t[o],c=r.indexOf(s);if(c>-1){var l=1+A(t,r,o+1,c+1),u=this._splice(c,l);u&&u.length>0&&i.push.apply(i,u),o+=l-1}}return this._emitAfterChanges(2),i}},{key:"reverse",value:function(){if(Object(j.c)(this._observable),this._emitBeforeChanges(4))return this;var e=this._splice(0,this.length);return e&&(e.reverse(),this._splice.apply(this,[0,0].concat(Object(a.a)(e)))),this._emitAfterChanges(4),this}},{key:"shift",value:function(){if(Object(j.c)(this._observable),this.length&&!this._emitBeforeChanges(2)){var e=P(this._splice(0,1));return this._emitAfterChanges(2),e}}},{key:"slice",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.length;return Object(j.c)(this._observable),this._createNewInstance({items:this._items.slice(e,t)})}},{key:"some",value:function(e,t){return Object(j.c)(this._observable),this._items.some(e,t)}},{key:"sort",value:function(e){if(Object(j.c)(this._observable),!this.length||this._emitBeforeChanges(4))return this;var t=Object(m.d)(this._splice(0,this.length));return arguments.length?t.sort(e):t.sort(),this._splice.apply(this,[0,0].concat(Object(a.a)(t))),this._emitAfterChanges(4),this}},{key:"splice",value:function(e,t){Object(j.c)(this._observable);for(var r=arguments.length,n=new Array(r>2?r-2:0),i=2;i<r;i++)n[i-2]=arguments[i];var a=(t?2:0)|(n.length?1:0);if(this._emitBeforeChanges(a))return[];var o=this._splice.apply(this,[e,t].concat(n))||[];return this._emitAfterChanges(a),o}},{key:"toArray",value:function(){return Object(j.c)(this._observable),this._items.slice()}},{key:"toJSON",value:function(){return Object(j.c)(this._observable),this.toArray()}},{key:"toLocaleString",value:function(){return Object(j.c)(this._observable),this._items.toLocaleString()}},{key:"toString",value:function(){return Object(j.c)(this._observable),this._items.toString()}},{key:"unshift",value:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return Object(j.c)(this._observable),!t.length||this._emitBeforeChanges(1)||(this._splice.apply(this,[0,0].concat(t)),this._emitAfterChanges(1)),this.length}},{key:"_createNewInstance",value:function(e){return new this.constructor(e)}},{key:"_splice",value:function(e,t){for(var r=this,n=arguments.length,o=new Array(n>2?n-2:0),s=2;s<n;s++)o[s-2]=arguments[s];var c,l,u=this._items,d=this.constructor.prototype.itemType;if(!this._notifications&&this.hasEventListener("change")&&(this._notifications=[{listeners:this._chgListeners.slice(),items:this._items.slice(),changes:[]}],this._timer&&this._timer.remove(),this._timer=Object(g.b)((function(){return r._dispatchChange()}))),t){if(l=u.splice(e,t),this.hasEventListener("before-remove")){var h=T.acquire();h.target=this,h.cancellable=!0;for(var f=0,p=l.length;f<p;f++)c=l[f],h.reset(c),this.emit("before-remove",h),h.defaultPrevented&&(l.splice(f,1),u.splice(e,0,c),e+=1,f-=1,p-=1);T.release(h)}if(this.length=this._items.length,this.hasEventListener("after-remove")){var b=T.acquire();b.target=this,b.cancellable=!1;for(var v=l.length,m=0;m<v;m++)b.reset(l[m]),this.emit("after-remove",b);T.release(b)}}if(o&&o.length){if(d){var y,O=[],j=Object(i.a)(o);try{for(j.s();!(y=j.n()).done;){var _=y.value,w=d.ensureType(_);null==w&&null!=_||O.push(w)}}catch(F){j.e(F)}finally{j.f()}o=O}var x=this.hasEventListener("before-add"),k=this.hasEventListener("after-add"),S=e===this.length;if(x||k){var C=T.acquire();C.target=this,C.cancellable=!0;var M=T.acquire();M.target=this,M.cancellable=!1;var P,A=Object(i.a)(o);try{for(A.s();!(P=A.n()).done;){var E=P.value;x?(C.reset(E),this.emit("before-add",C),C.defaultPrevented||(S?u.push(E):u.splice(e++,0,E),this._set("length",u.length),k&&(M.reset(E),this.emit("after-add",M)))):(S?u.push(E):u.splice(e++,0,E),this._set("length",u.length),M.reset(E),this.emit("after-add",M))}}catch(F){A.e(F)}finally{A.f()}T.release(M),T.release(C)}else{if(S){var R,I=Object(i.a)(o);try{for(I.s();!(R=I.n()).done;){var D=R.value;u.push(D)}}catch(F){I.e(F)}finally{I.f()}}else u.splice.apply(u,[e,0].concat(Object(a.a)(o)));this._set("length",u.length)}}return(o&&o.length||l&&l.length)&&this._notifyChangeEvent(o,l),l}},{key:"_emitBeforeChanges",value:function(e){var t=!1;if(this.hasEventListener("before-changes")){var r=T.acquire();r.target=this,r.cancellable=!0,r.type=e,this.emit("before-changes",r),t=r.defaultPrevented,T.release(r)}return t}},{key:"_emitAfterChanges",value:function(e){if(this.hasEventListener("after-changes")){var t=T.acquire();t.target=this,t.cancellable=!1,t.type=e,this.emit("after-changes",t),T.release(t)}this._observable.notify()}},{key:"_notifyChangeEvent",value:function(e,t){this.hasEventListener("change")&&this._notifications&&this._notifications[this._notifications.length-1].changes.push({added:e,removed:t})}},{key:"_dispatchChange",value:function(){var e=this;if(this._timer&&(this._timer.remove(),this._timer=null),this._notifications){var t=this._notifications;this._notifications=null;var r,n=Object(i.a)(t);try{var a=function(){var t=r.value,n=t.changes;R.clear(),I.clear(),D.clear();var a,o=Object(i.a)(n);try{for(o.s();!(a=o.n()).done;){var s=a.value,c=s.added,l=s.removed;if(c)if(0===D.size&&0===I.size){var u,d=Object(i.a)(c);try{for(d.s();!(u=d.n()).done;){var h=u.value;R.add(h)}}catch(E){d.e(E)}finally{d.f()}}else{var f,b=Object(i.a)(c);try{for(b.s();!(f=b.n()).done;){var v=f.value;I.has(v)?(D.add(v),I.delete(v)):D.has(v)||R.add(v)}}catch(E){b.e(E)}finally{b.f()}}if(l)if(0===D.size&&0===R.size){var m,y=Object(i.a)(l);try{for(y.s();!(m=y.n()).done;){var g=m.value;I.add(g)}}catch(E){y.e(E)}finally{y.f()}}else{var O,j=Object(i.a)(l);try{for(j.s();!(O=j.n()).done;){var _=O.value;R.has(_)?R.delete(_):(D.delete(_),I.add(_))}}catch(E){j.e(E)}finally{j.f()}}}}catch(E){o.e(E)}finally{o.f()}var w=p.a.acquire();R.forEach((function(e){w.push(e)}));var x=p.a.acquire();I.forEach((function(e){x.push(e)}));var k=e._items,S=t.items,T=p.a.acquire();if(D.forEach((function(e){S.indexOf(e)!==k.indexOf(e)&&T.push(e)})),t.listeners&&(w.length||x.length||T.length))for(var C={target:e,added:w,removed:x,moved:T},M=t.listeners.length,P=0;P<M;P++){var A=t.listeners[P];A.removed||A.callback.call(e,C)}p.a.release(w),p.a.release(x),p.a.release(T)};for(n.s();!(r=n.n()).done;)a()}catch(o){n.e(o)}finally{n.f()}R.clear(),I.clear(),D.clear()}}}],[{key:"isCollection",value:function(e){return null!=e&&e instanceof n}}]),o}(b.a.EventedAccessor,Symbol.iterator);z.ofType=function(e){if(!e)return n;if(F.has(e))return F.get(e);var t=null;if("function"==typeof e)t=e.prototype.declaredClass;else if(e.base)t=e.base.prototype.declaredClass;else for(var r in e.typeMap){var i=e.typeMap[r].prototype.declaredClass;t?t+=" | ".concat(i):t=i}var a=function(e){Object(l.a)(r,e);var t=Object(u.a)(r);function r(){return Object(d.a)(this,r),t.apply(this,arguments)}return r}(n);a=Object(f.a)([Object(w.a)("esri.core.Collection<".concat(t,">"))],a);var o={Type:e,ensureType:"function"==typeof e?Object(O.m)(e):Object(O.k)(e)};return Object.defineProperty(a.prototype,"itemType",{value:o}),F.set(e,a),a},Object(f.a)([Object(_.b)()],z.prototype,"length",void 0),Object(f.a)([Object(_.b)()],z.prototype,"items",null);var V=z=n=Object(f.a)([Object(w.a)("esri.core.Collection")],z);t.a=V},function(e,t,r){"use strict";r.d(t,"a",(function(){return o})),r.d(t,"b",(function(){return u})),r.d(t,"c",(function(){return i})),r.d(t,"d",(function(){return v})),r.d(t,"e",(function(){return f})),r.d(t,"f",(function(){return p})),r.d(t,"g",(function(){return g})),r.d(t,"h",(function(){return O})),r.d(t,"i",(function(){return h})),r.d(t,"j",(function(){return m})),r.d(t,"k",(function(){return b})),r.d(t,"l",(function(){return a})),r.d(t,"m",(function(){return y})),r.d(t,"n",(function(){return C}));var n=r(63);function i(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e}function a(e,t,r,n,i){return e[0]=t,e[1]=r,e[2]=n,e[3]=i,e}function o(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e[3]=t[3]+r[3],e}function s(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e[2]=t[2]-r[2],e[3]=t[3]-r[3],e}function c(e,t,r){return e[0]=t[0]*r[0],e[1]=t[1]*r[1],e[2]=t[2]*r[2],e[3]=t[3]*r[3],e}function l(e,t,r){return e[0]=t[0]/r[0],e[1]=t[1]/r[1],e[2]=t[2]/r[2],e[3]=t[3]/r[3],e}function u(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e}function d(e,t){var r=t[0]-e[0],n=t[1]-e[1],i=t[2]-e[2],a=t[3]-e[3];return Math.sqrt(r*r+n*n+i*i+a*a)}function h(e,t){var r=t[0]-e[0],n=t[1]-e[1],i=t[2]-e[2],a=t[3]-e[3];return r*r+n*n+i*i+a*a}function f(e){var t=e[0],r=e[1],n=e[2],i=e[3];return Math.sqrt(t*t+r*r+n*n+i*i)}function p(e){var t=e[0],r=e[1],n=e[2],i=e[3];return t*t+r*r+n*n+i*i}function b(e,t){var r=t[0],n=t[1],i=t[2],a=t[3],o=r*r+n*n+i*i+a*a;return o>0&&(o=1/Math.sqrt(o),e[0]=r*o,e[1]=n*o,e[2]=i*o,e[3]=a*o),e}function v(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3]}function m(e,t,r,n){var i=t[0],a=t[1],o=t[2],s=t[3];return e[0]=i+n*(r[0]-i),e[1]=a+n*(r[1]-a),e[2]=o+n*(r[2]-o),e[3]=s+n*(r[3]-s),e}function y(e,t,r){var n=t[0],i=t[1],a=t[2],o=t[3];return e[0]=r[0]*n+r[4]*i+r[8]*a+r[12]*o,e[1]=r[1]*n+r[5]*i+r[9]*a+r[13]*o,e[2]=r[2]*n+r[6]*i+r[10]*a+r[14]*o,e[3]=r[3]*n+r[7]*i+r[11]*a+r[15]*o,e}function g(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]}function O(e,t){var r=e[0],i=e[1],a=e[2],o=e[3],s=t[0],c=t[1],l=t[2],u=t[3];return Math.abs(r-s)<=n.a*Math.max(1,Math.abs(r),Math.abs(s))&&Math.abs(i-c)<=n.a*Math.max(1,Math.abs(i),Math.abs(c))&&Math.abs(a-l)<=n.a*Math.max(1,Math.abs(a),Math.abs(l))&&Math.abs(o-u)<=n.a*Math.max(1,Math.abs(o),Math.abs(u))}var j=s,_=c,w=l,x=d,k=h,S=f,T=p,C=Object.freeze({__proto__:null,copy:i,set:a,add:o,subtract:s,multiply:c,divide:l,ceil:function(e,t){return e[0]=Math.ceil(t[0]),e[1]=Math.ceil(t[1]),e[2]=Math.ceil(t[2]),e[3]=Math.ceil(t[3]),e},floor:function(e,t){return e[0]=Math.floor(t[0]),e[1]=Math.floor(t[1]),e[2]=Math.floor(t[2]),e[3]=Math.floor(t[3]),e},min:function(e,t,r){return e[0]=Math.min(t[0],r[0]),e[1]=Math.min(t[1],r[1]),e[2]=Math.min(t[2],r[2]),e[3]=Math.min(t[3],r[3]),e},max:function(e,t,r){return e[0]=Math.max(t[0],r[0]),e[1]=Math.max(t[1],r[1]),e[2]=Math.max(t[2],r[2]),e[3]=Math.max(t[3],r[3]),e},round:function(e,t){return e[0]=Math.round(t[0]),e[1]=Math.round(t[1]),e[2]=Math.round(t[2]),e[3]=Math.round(t[3]),e},scale:u,scaleAndAdd:function(e,t,r,n){return e[0]=t[0]+r[0]*n,e[1]=t[1]+r[1]*n,e[2]=t[2]+r[2]*n,e[3]=t[3]+r[3]*n,e},distance:d,squaredDistance:h,length:f,squaredLength:p,negate:function(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=-t[3],e},inverse:function(e,t){return e[0]=1/t[0],e[1]=1/t[1],e[2]=1/t[2],e[3]=1/t[3],e},normalize:b,dot:v,lerp:m,random:function(e,t){var r,i,a,o,s,c;t=t||1;do{s=(r=2*Object(n.b)()-1)*r+(i=2*Object(n.b)()-1)*i}while(s>=1);do{c=(a=2*Object(n.b)()-1)*a+(o=2*Object(n.b)()-1)*o}while(c>=1);var l=Math.sqrt((1-s)/c);return e[0]=t*r,e[1]=t*i,e[2]=t*a*l,e[3]=t*o*l,e},transformMat4:y,transformQuat:function(e,t,r){var n=t[0],i=t[1],a=t[2],o=r[0],s=r[1],c=r[2],l=r[3],u=l*n+s*a-c*i,d=l*i+c*n-o*a,h=l*a+o*i-s*n,f=-o*n-s*i-c*a;return e[0]=u*l+f*-o+d*-c-h*-s,e[1]=d*l+f*-s+h*-o-u*-c,e[2]=h*l+f*-c+u*-s-d*-o,e[3]=t[3],e},str:function(e){return"vec4("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+")"},exactEquals:g,equals:O,sub:j,mul:_,div:w,dist:x,sqrDist:k,len:S,sqrLen:T})},function(e,t,r){"use strict";var n,i=r(21),a=r(2),o=r(5),s=r(6),c=r(7),l=r(0),u=r(27),d=r(25),h=r(18),f=r(1),p=r(10),b=r(44),v=r(59),m=n=function(e){Object(s.a)(r,e);var t=Object(c.a)(r);function r(e){var n;return Object(a.a)(this,r),(n=t.call(this,e)).latestWkid=null,n.wkid=null,n.wkt=null,n.vcsWkid=null,n.latestVcsWkid=null,n.imageCoordinateSystem=null,n}return Object(o.a)(r,[{key:"normalizeCtorArgs",value:function(e){return e&&"object"==typeof e?e:Object(i.a)({},"string"==typeof e?"wkt":"wkid",e)}},{key:"isWGS84",get:function(){return Object(v.k)(this)}},{key:"isWebMercator",get:function(){return Object(v.n)(this)}},{key:"isGeographic",get:function(){return Object(v.g)(this)}},{key:"isWrappable",get:function(){return Object(v.o)(this)}},{key:"writeWkt",value:function(e,t){this.wkid||(t.wkt=e)}},{key:"clone",value:function(){if(this===n.WGS84)return n.WGS84;if(this===n.WebMercator)return n.WebMercator;var e=new n;return null!=this.wkid?(e.wkid=this.wkid,null!=this.latestWkid&&(e.latestWkid=this.latestWkid),null!=this.vcsWkid&&(e.vcsWkid=this.vcsWkid),null!=this.latestVcsWkid&&(e.latestVcsWkid=this.latestVcsWkid)):null!=this.wkt&&(e.wkt=this.wkt),this.imageCoordinateSystem&&(e.imageCoordinateSystem=Object(d.a)(this.imageCoordinateSystem)),e}},{key:"equals",value:function(e){if(null==e)return!1;if(this.imageCoordinateSystem||e.imageCoordinateSystem){if(null==this.imageCoordinateSystem||null==e.imageCoordinateSystem)return!1;var t=e.imageCoordinateSystem,r=t.id,n=t.referenceServiceName,i=e.imageCoordinateSystem.geodataXform,a=this.imageCoordinateSystem;return null==r||i?JSON.stringify(a)===JSON.stringify(e.imageCoordinateSystem):n?a.id===r&&a.referenceServiceName===n:a.id===r}return Object(v.c)(this,e)}},{key:"toJSON",value:function(e){return this.write(void 0,e)}}],[{key:"fromJSON",value:function(e){if(!e)return null;if(e.wkid){if(102100===e.wkid)return n.WebMercator;if(4326===e.wkid)return n.WGS84}var t=new n;return t.read(e),t}}]),r}(u.a);m.GCS_NAD_1927=null,m.WGS84=null,m.WebMercator=null,Object(l.a)([Object(f.b)({readOnly:!0})],m.prototype,"isWGS84",null),Object(l.a)([Object(f.b)({readOnly:!0})],m.prototype,"isWebMercator",null),Object(l.a)([Object(f.b)({readOnly:!0})],m.prototype,"isGeographic",null),Object(l.a)([Object(f.b)({readOnly:!0})],m.prototype,"isWrappable",null),Object(l.a)([Object(f.b)({type:h.a,json:{write:!0}})],m.prototype,"latestWkid",void 0),Object(l.a)([Object(f.b)({type:h.a,json:{write:!0,origins:{"web-scene":{write:{overridePolicy:function(){return{isRequired:null===this.wkt}}}}}}})],m.prototype,"wkid",void 0),Object(l.a)([Object(f.b)({type:String,json:{origins:{"web-scene":{write:{overridePolicy:function(){return{isRequired:null===this.wkid}}}}}}})],m.prototype,"wkt",void 0),Object(l.a)([Object(b.a)("wkt"),Object(b.a)("web-scene","wkt")],m.prototype,"writeWkt",null),Object(l.a)([Object(f.b)({type:h.a,json:{write:!0}})],m.prototype,"vcsWkid",void 0),Object(l.a)([Object(f.b)({type:h.a,json:{write:!0}})],m.prototype,"latestVcsWkid",void 0),Object(l.a)([Object(f.b)()],m.prototype,"imageCoordinateSystem",void 0),(m=n=Object(l.a)([Object(p.a)("esri.geometry.SpatialReference")],m)).prototype.toJSON.isDefaultToJSON=!0,m.GCS_NAD_1927=new m({wkid:4267,wkt:'GEOGCS["GCS_North_American_1927",DATUM["D_North_American_1927",SPHEROID["Clarke_1866",6378206.4,294.9786982]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]]'}),m.WGS84=new m(v.a),m.WebMercator=new m(v.b),Object.freeze&&(Object.freeze(m.GCS_NAD_1927),Object.freeze(m.WGS84),Object.freeze(m.WebMercator));var y=m;t.a=y},function(e,t,r){"use strict";var n=r(33),i=r(2),a=r(5),o=r(6),s=r(7),c=r(0),l=r(15),u=r(1),d=(r(17),r(64)),h=r(48),f=r(10),p=r(44),b=r(18),v=r(160),m=r(55);var y,g=r(59),O=r(61),j=[0,0];function _(e){return e&&("esri.geometry.SpatialReference"===e.declaredClass||null!=e.wkid)}var w=l.a.getLogger("esri.geometry.Point"),x=y=function(e){Object(o.a)(r,e);var t=Object(s.a)(r);function r(){var e;Object(i.a)(this,r);for(var n=arguments.length,a=new Array(n),o=0;o<n;o++)a[o]=arguments[o];return(e=t.call.apply(t,[this].concat(a))).x=0,e.y=0,e.z=void 0,e.m=void 0,e.type="point",e}return Object(a.a)(r,[{key:"normalizeCtorArgs",value:function(e,t,r,n,i){var a;if(Array.isArray(e))i=t,e=(a=e)[0],t=a[1],r=a[2],n=a[3];else if(e&&"object"==typeof e){if(e=null!=(a=e).x?a.x:a.longitude,t=null!=a.y?a.y:a.latitude,r=a.z,n=a.m,(i=a.spatialReference)&&"esri.geometry.SpatialReference"!==i.declaredClass&&(i=new m.a(i)),null!=a.longitude||null!=a.latitude)if(null==a.longitude)w.warn(".longitude=","Latitude was defined without longitude");else if(null==a.latitude)w.warn(".latitude=","Longitude was defined without latitude");else if(!a.declaredClass&&i&&i.isWebMercator){var o=Object(O.c)(a.longitude,a.latitude,j);e=o[0],t=o[1]}}else _(r)?(i=r,r=null):_(n)&&(i=n,n=null);var s={x:e,y:t};return null==s.x&&null!=s.y?w.warn(".y=","Y coordinate was defined without an X coordinate"):null==s.y&&null!=s.x&&w.warn(".x=","X coordinate was defined without a Y coordinate"),null!=i&&(s.spatialReference=i),null!=r&&(s.z=r),null!=n&&(s.m=n),s}},{key:"cache",get:function(){return this.commitProperty("x"),this.commitProperty("y"),this.commitProperty("z"),this.commitProperty("m"),this.commitProperty("spatialReference"),{}}},{key:"hasM",get:function(){return void 0!==this.m},set:function(e){e!==(void 0!==this._get("m"))&&(this._set("m",e?0:void 0),this._set("hasM",e))}},{key:"hasZ",get:function(){return void 0!==this.z},set:function(e){e!==(void 0!==this._get("z"))&&(this._set("z",e?0:void 0),this._set("hasZ",e))}},{key:"latitude",get:function(){var e=this.spatialReference,t=this.x,r=this.y;if(e){if(e.isWebMercator)return Object(O.g)(t,r,j)[1];if(e.isGeographic)return r}return null},set:function(e){var t=this.spatialReference,r=this.x;t&&(t.isWebMercator?this._set("y",Object(O.c)(r,e,j)[1]):t.isGeographic&&this._set("y",e),this._set("latitude",e))}},{key:"longitude",get:function(){var e=this.x,t=this.y,r=this.spatialReference;if(r){if(r.isWebMercator)return Object(O.g)(e,t,j)[0];if(r.isGeographic)return e}return NaN},set:function(e){var t=this.y,r=this.spatialReference;r&&(r.isWebMercator?this._set("x",Object(O.c)(e,t,j)[0]):r.isGeographic&&this._set("x",e),this._set("longitude",e))}},{key:"writeX",value:function(e,t,r){t[r]=isNaN(e)?"NaN":e}},{key:"readX",value:function(e){return"string"==typeof e?NaN:e}},{key:"clone",value:function(){var e=new y;return e.x=this.x,e.y=this.y,e.z=this.z,e.m=this.m,e.spatialReference=this.spatialReference,e}},{key:"copy",value:function(e){return y.copy(e,this),this}},{key:"equals",value:function(e){var t,r;if(!e)return!1;var i=this.x,a=this.y,o=this.z,s=this.m,c=this.spatialReference,l=e.z,u=e.m,d=e.x,h=e.y,f=e.spatialReference;if(!c.equals(f))if(c.isWebMercator&&f.isWGS84)t=Object(O.c)(d,h),d=(r=Object(n.a)(t,2))[0],h=r[1],f=c;else{var p,b;if(!c.isWGS84||!f.isWebMercator)return!1;p=Object(O.g)(d,h),d=(b=Object(n.a)(p,2))[0],h=b[1],f=c}return i===d&&a===h&&o===l&&s===u&&c.wkid===f.wkid}},{key:"offset",value:function(e,t,r){return function(e,t,r,n){var i;return e.x=e.x+t,e.y=e.y+r,null!=n&&(e.z=(null!=(i=e.z)?i:0)+n),e}(this,e,t,r)}},{key:"normalize",value:function(){if(!this.spatialReference)return this;var e=Object(g.d)(this.spatialReference);if(!e)return this;var t=this.x,r=Object(n.a)(e.valid,2),i=r[0],a=r[1],o=2*a;return t>a?t-=Math.ceil(Math.abs(t-a)/o)*o:t<i&&(t+=Math.ceil(Math.abs(t-i)/o)*o),this._set("x",t),this}},{key:"distance",value:function(e){return function(e,t){var r=e.x-t.x,n=e.y-t.y,i=e.hasZ&&t.hasZ?e.z-t.z:0;return Math.sqrt(r*r+n*n+i*i)}(this,e)}},{key:"toArray",value:function(){var e=this.hasZ,t=this.hasM;return e&&t?[this.x,this.y,this.z,this.m]:e?[this.x,this.y,this.z]:t?[this.x,this.y,this.m]:[this.x,this.y]}},{key:"toJSON",value:function(e){return this.write(null,e)}}],[{key:"copy",value:function(e,t){t._set("x",e._get("x")),t._set("y",e._get("y")),t._set("z",e._get("z")),t._set("m",e._get("m"));var r=e._get("spatialReference");t._set("spatialReference",Object.isFrozen(r)?r:r.clone())}}]),r}(v.a);Object(c.a)([Object(u.b)({readOnly:!0})],x.prototype,"cache",null),Object(c.a)([Object(u.b)({type:Boolean,json:{read:!1,write:{enabled:!1,overridePolicy:null}}})],x.prototype,"hasM",null),Object(c.a)([Object(u.b)({type:Boolean,json:{read:!1,write:{enabled:!1,overridePolicy:null}}})],x.prototype,"hasZ",null),Object(c.a)([Object(u.b)({type:Number})],x.prototype,"latitude",null),Object(c.a)([Object(u.b)({type:Number})],x.prototype,"longitude",null),Object(c.a)([Object(u.b)({type:Number,json:{type:[Number,String],write:{isRequired:!0,allowNull:!0}}}),Object(d.a)((function(e){return isNaN(e)?e:Object(b.i)(e)}))],x.prototype,"x",void 0),Object(c.a)([Object(p.a)("x")],x.prototype,"writeX",null),Object(c.a)([Object(h.a)("x")],x.prototype,"readX",null),Object(c.a)([Object(u.b)({type:Number,json:{write:!0}})],x.prototype,"y",void 0),Object(c.a)([Object(u.b)({type:Number,json:{write:{overridePolicy:function(){return{enabled:this.hasZ}}}}})],x.prototype,"z",void 0),Object(c.a)([Object(u.b)({type:Number,json:{write:{overridePolicy:function(){return{enabled:this.hasM}}}}})],x.prototype,"m",void 0),(x=y=Object(c.a)([Object(f.a)("esri.geometry.Point")],x)).prototype.toJSON.isDefaultToJSON=!0;var k=x;t.a=k},function(e,t,r){"use strict";var n=r(2),i=r(5),a=r(6),o=r(7),s=r(0),c=r(30),l=r(53),u=r(3),d=r(1),h=r(10),f=function(e){Object(a.a)(r,e);var t=Object(o.a)(r);function r(e){var i;return Object(n.a)(this,r),(i=t.call(this,e))._groups=new Map,i}return Object(i.a)(r,[{key:"destroy",value:function(){this.removeAll()}},{key:"size",get:function(){var e=0;return this._groups.forEach((function(t){e+=t.length})),e}},{key:"add",value:function(e,t){var r=this;if(!this._isHandle(e)&&!Array.isArray(e)&&!l.a.isCollection(e))return this;var n=this._getOrCreateGroup(t);return Array.isArray(e)||l.a.isCollection(e)?e.forEach((function(e){return r._isHandle(e)&&n.push(e)})):n.push(e),this.notifyChange("size"),this}},{key:"forEach",value:function(e,t){if("function"==typeof e)this._groups.forEach((function(t){return t.forEach(e)}));else{var r=this._getGroup(e);r&&t&&r.forEach(t)}}},{key:"has",value:function(e){return this._groups.has(this._ensureGroupKey(e))}},{key:"remove",value:function(e){if(Array.isArray(e)||l.a.isCollection(e))return e.forEach(this.remove,this),this;if(!this.has(e))return this;for(var t=this._getGroup(e),r=0;r<t.length;r++)t[r].remove();return this._deleteGroup(e),this.notifyChange("size"),this}},{key:"removeAll",value:function(){return this._groups.forEach((function(e){for(var t=0;t<e.length;t++)e[t].remove()})),this._groups.clear(),this.notifyChange("size"),this}},{key:"_isHandle",value:function(e){return e&&!!e.remove}},{key:"_getOrCreateGroup",value:function(e){if(this.has(e))return this._getGroup(e);var t=[];return this._groups.set(this._ensureGroupKey(e),t),t}},{key:"_getGroup",value:function(e){return Object(u.d)(this._groups.get(this._ensureGroupKey(e)))}},{key:"_deleteGroup",value:function(e){return this._groups.delete(this._ensureGroupKey(e))}},{key:"_ensureGroupKey",value:function(e){return e||"_default_"}}]),r}(c.a);Object(s.a)([Object(d.b)({readOnly:!0})],f.prototype,"size",null);var p=f=Object(s.a)([Object(h.a)("esri.core.Handles")],f);t.a=p},function(e,t,r){"use strict";r.d(t,"a",(function(){return o})),r.d(t,"b",(function(){return s}));var n=r(2),i=r(5),a=r(113),o=function(){function e(t){var r=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{ignoreUnknown:!1};Object(n.a)(this,e),this.jsonToAPI=t,this.options=i,this.apiValues=[],this.jsonValues=[],this.apiToJSON=this.invertMap(t),this.apiValues=this.getKeysSorted(this.apiToJSON),this.jsonValues=this.getKeysSorted(this.jsonToAPI),this.read=function(e){return r.fromJSON(e)},this.write=function(e,t,n){var i=r.toJSON(e);void 0!==i&&Object(a.c)(n,i,t)},this.write.isJSONMapWriter=!0}return Object(i.a)(e,[{key:"toJSON",value:function(e){return this.apiToJSON.hasOwnProperty(e)?this.apiToJSON[e]:this.options.ignoreUnknown?void 0:e}},{key:"fromJSON",value:function(e){return this.jsonToAPI.hasOwnProperty(e)?this.jsonToAPI[e]:this.options.ignoreUnknown?void 0:e}},{key:"invertMap",value:function(e){var t={};for(var r in e)t[e[r]]=r;return t}},{key:"getKeysSorted",value:function(e){var t=[];for(var r in e)t.push(r);return t.sort(),t}}]),e}();function s(){return function(e){return new o(e,{ignoreUnknown:!0})}}},function(e,t,r){"use strict";r.d(t,"a",(function(){return k})),r.d(t,"b",(function(){return S})),r.d(t,"c",(function(){return h})),r.d(t,"d",(function(){return f})),r.d(t,"e",(function(){return m})),r.d(t,"f",(function(){return b})),r.d(t,"g",(function(){return p})),r.d(t,"h",(function(){return O})),r.d(t,"i",(function(){return _})),r.d(t,"j",(function(){return x})),r.d(t,"k",(function(){return v})),r.d(t,"l",(function(){return g})),r.d(t,"m",(function(){return j})),r.d(t,"n",(function(){return y})),r.d(t,"o",(function(){return w}));var n=r(3),i=r(147),a=r(481),o={102113:!0,102100:!0,3857:!0,3785:!0},s={102113:!0,102100:!0,3857:!0,3785:!0,4326:!0},c='PROJCS["WGS_1984_Web_Mercator_Auxiliary_Sphere",GEOGCS["GCS_WGS_1984",DATUM["D_WGS_1984",SPHEROID["WGS_1984",6378137.0,298.257223563]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Mercator_Auxiliary_Sphere"],PARAMETER["False_Easting",0.0],PARAMETER["False_Northing",0.0],PARAMETER["Central_Meridian",{Central_Meridian}],PARAMETER["Standard_Parallel_1",0.0],PARAMETER["Auxiliary_Sphere_Type",0.0],UNIT["Meter",1.0]]',l=[-20037508.342788905,20037508.342788905],u=[-20037508.342787,20037508.342787],d={102113:{wkTemplate:'PROJCS["WGS_1984_Web_Mercator",GEOGCS["GCS_WGS_1984_Major_Auxiliary_Sphere",DATUM["D_WGS_1984_Major_Auxiliary_Sphere",SPHEROID["WGS_1984_Major_Auxiliary_Sphere",6378137.0,0.0]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Mercator"],PARAMETER["False_Easting",0.0],PARAMETER["False_Northing",0.0],PARAMETER["Central_Meridian",{Central_Meridian}],PARAMETER["Standard_Parallel_1",0.0],UNIT["Meter",1.0]]',valid:l,origin:u,dx:1e-5},102100:{wkTemplate:c,valid:l,origin:u,dx:1e-5},3785:{wkTemplate:'PROJCS["WGS_1984_Web_Mercator",GEOGCS["GCS_WGS_1984_Major_Auxiliary_Sphere",DATUM["D_WGS_1984_Major_Auxiliary_Sphere",SPHEROID["WGS_1984_Major_Auxiliary_Sphere",6378137.0,0.0]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Mercator"],PARAMETER["False_Easting",0.0],PARAMETER["False_Northing",0.0],PARAMETER["Central_Meridian",{Central_Meridian}],PARAMETER["Standard_Parallel_1",0.0],UNIT["Meter",1.0]]',valid:l,origin:u,dx:1e-5},3857:{wkTemplate:c,valid:l,origin:u,dx:1e-5},4326:{wkTemplate:'GEOGCS["GCS_WGS_1984",DATUM["D_WGS_1984",SPHEROID["WGS_1984",6378137.0,298.257223563]],PRIMEM["Greenwich",{Central_Meridian}],UNIT["Degree",0.0174532925199433]]',altTemplate:'PROJCS["WGS_1984_Plate_Carree",GEOGCS["GCS_WGS_1984",DATUM["D_WGS_1984",SPHEROID["WGS_1984",6378137.0,298.257223563]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Plate_Carree"],PARAMETER["False_Easting",0.0],PARAMETER["False_Northing",0.0],PARAMETER["Central_Meridian",{Central_Meridian}],UNIT["Degrees",111319.491]]',valid:[-180,180],origin:[-180,90],dx:1e-5},104971:{wkTemplate:'GEOGCS["Mars_2000_(Sphere)",DATUM["Mars_2000_(Sphere)",SPHEROID["Mars_2000_(Sphere)",3396190.0,0.0]],PRIMEM["Reference_Meridian",0.0],UNIT["Degree",0.0174532925199433]]',valid:[-180,180],origin:[-180,90],dx:1e-5},104905:{wkTemplate:'GEOGCS["GCS_Mars_2000",DATUM["D_Mars_2000",SPHEROID["Mars_2000_IAU_IAG",3396190.0,169.8944472236118]],PRIMEM["Reference_Meridian",0.0],UNIT["Degree",0.0174532925199433]]',valid:[-180,180],origin:[-180,90],dx:1e-5}};function h(e,t){return!Object(n.i)(e)&&!Object(n.i)(t)&&(e===t||(null!=e.wkid||null!=t.wkid?e.wkid===t.wkid||y(e)&&y(t)||null!=t.latestWkid&&e.wkid===t.latestWkid||null!=e.latestWkid&&t.wkid===e.latestWkid:!(!e.wkt||!t.wkt)&&e.wkt.toUpperCase()===t.wkt.toUpperCase()))}function f(e){return x(e)&&e.wkid?d[e.wkid]:null}function p(e){return!!x(e)&&(e.wkid?null==a.a[e.wkid]:!!e.wkt&&!!/^\s*GEOGCS/i.test(e.wkt))}function b(e){return!(O(e)||_(e))}function v(e){return x(e)&&4326===e.wkid}function m(e){return x(e)&&4490===e.wkid}function y(e){return x(e)&&null!=e.wkid&&!0===o[e.wkid]}function g(e){return 104971===e||104905===e}function O(e){return x(e)&&null!=e.wkid&&g(e.wkid)}function j(e){return 104903===e}function _(e){return x(e)&&null!=e.wkid&&j(e.wkid)}function w(e){return x(e)&&null!=e.wkid&&!0===s[e.wkid]}function x(e){return Object(n.j)(e)&&(null!=e.wkid&&e.wkid>=2e3||null!=e.wkt)}var k={wkid:4326,wkt:Object(i.c)(d[4326].wkTemplate,{Central_Meridian:"0.0"})},S={wkid:102100,latestWkid:3857}},function(e,t,r){"use strict";var n=r(14),i=r(2),a=r(5),o=r(20),s=r(3),c=r(122),l=r(157),u=function(){function e(t,r){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;Object(i.a)(this,e),this._context=t,this.type="texture",this._glName=null,this._descriptor=void 0,this._samplingModeDirty=!1,this._wrapModeDirty=!1,t.instanceCounter.increment(c.b.Texture,this),this._descriptor=Object(n.a)({target:3553,samplingMode:9729,wrapMode:10497,flipped:!1,hasMipmap:!1,isOpaque:!1,unpackAlignment:4,preMultiplyAlpha:!1},r),this.setData(a)}return Object(a.a)(e,[{key:"glName",get:function(){return this._glName}},{key:"descriptor",get:function(){return this._descriptor}},{key:"dispose",value:function(){this._context.gl&&this._glName&&(this._context.unbindTextureAllUnits(this),this._context.gl.deleteTexture(this._glName),this._glName=null,this._context.instanceCounter.decrement(c.b.Texture,this))}},{key:"release",value:function(){this.dispose()}},{key:"resize",value:function(e,t){var r=this._descriptor;r.width===e&&r.height===t||(r.width=e,r.height=t,this.setData(null))}},{key:"setData",value:function(t){if(this._context&&this._context.gl){var r=this._context.gl;this._glName||(this._glName=r.createTexture()),void 0===t&&(t=null),null===t&&(this._descriptor.width=this._descriptor.width||4,this._descriptor.height=this._descriptor.height||4);var n=this._context.bindTexture(this,e.TEXTURE_UNIT_FOR_UPDATES),i=this._descriptor;e._validateTexture(this._context,i),r.pixelStorei(r.UNPACK_ALIGNMENT,i.unpackAlignment),r.pixelStorei(r.UNPACK_FLIP_Y_WEBGL,i.flipped?1:0),r.pixelStorei(r.UNPACK_PREMULTIPLY_ALPHA_WEBGL,i.preMultiplyAlpha?1:0);var a=i.pixelFormat,o=i.internalFormat?i.internalFormat:a;if(t instanceof ImageData||t instanceof HTMLImageElement||t instanceof HTMLCanvasElement||t instanceof HTMLVideoElement){var c=t.width,l=t.height;t instanceof HTMLVideoElement&&(c=t.videoWidth,l=t.videoHeight),i.width&&i.height,r.texImage2D(r.TEXTURE_2D,0,o,a,i.dataType,t),i.hasMipmap&&this.generateMipmap(),void 0===i.width&&(i.width=c),void 0===i.height&&(i.height=l)}else{null!=i.width&&null!=i.height||console.error("Width and height must be specified!"),r.DEPTH24_STENCIL8&&o===r.DEPTH_STENCIL&&(o=r.DEPTH24_STENCIL8);var u=i.width,d=i.height;if(function(e){return Object(s.j)(e)&&"type"in e&&"compressed"===e.type}(t)){var h=Math.round(Math.log(Math.max(u,d))/Math.LN2)+1;i.hasMipmap=i.hasMipmap&&h===t.levels.length;for(var f=0;;++f){var p=t.levels[Math.min(f,t.levels.length-1)];if(r.compressedTexImage2D(r.TEXTURE_2D,f,o,u,d,0,p),1===u&&1===d||!i.hasMipmap)break;u=Math.max(1,u>>1),d=Math.max(1,d>>1)}}else if(Object(s.j)(t))r.texImage2D(r.TEXTURE_2D,0,o,u,d,0,a,i.dataType,t),i.hasMipmap&&this.generateMipmap();else for(var b=0;r.texImage2D(r.TEXTURE_2D,b,o,u,d,0,a,i.dataType,null),(1!==u||1!==d)&&i.hasMipmap;++b)u=Math.max(1,u>>1),d=Math.max(1,d>>1)}e._applySamplingMode(r,this._descriptor),e._applyWrapMode(r,this._descriptor),e._applyAnisotropicFilteringParameters(this._context,this._descriptor),this._context.bindTexture(n,e.TEXTURE_UNIT_FOR_UPDATES)}}},{key:"updateData",value:function(t,r,n,i,a,o){o||console.error("An attempt to use uninitialized data!"),this._glName||console.error("An attempt to update uninitialized texture!");var s=this._context.gl,c=this._descriptor,l=this._context.bindTexture(this,e.TEXTURE_UNIT_FOR_UPDATES);(r<0||n<0||i>c.width||a>c.height||r+i>c.width||n+a>c.height)&&console.error("An attempt to update out of bounds of the texture!"),s.pixelStorei(s.UNPACK_ALIGNMENT,c.unpackAlignment),s.pixelStorei(s.UNPACK_FLIP_Y_WEBGL,c.flipped?1:0),s.pixelStorei(s.UNPACK_PREMULTIPLY_ALPHA_WEBGL,c.preMultiplyAlpha?1:0),o instanceof ImageData||o instanceof HTMLImageElement||o instanceof HTMLCanvasElement||o instanceof HTMLVideoElement?s.texSubImage2D(s.TEXTURE_2D,t,r,n,c.pixelFormat,c.dataType,o):s.texSubImage2D(s.TEXTURE_2D,t,r,n,i,a,c.pixelFormat,c.dataType,o),this._context.bindTexture(l,e.TEXTURE_UNIT_FOR_UPDATES)}},{key:"generateMipmap",value:function(){var t=this._descriptor;t.hasMipmap||(t.hasMipmap=!0,this._samplingModeDirty=!0,e._validateTexture(this._context,t)),9729===t.samplingMode?(this._samplingModeDirty=!0,t.samplingMode=9985):9728===t.samplingMode&&(this._samplingModeDirty=!0,t.samplingMode=9984);var r=this._context.bindTexture(this,e.TEXTURE_UNIT_FOR_UPDATES),n=this._context.gl;n.generateMipmap(n.TEXTURE_2D),this._context.bindTexture(r,e.TEXTURE_UNIT_FOR_UPDATES)}},{key:"setSamplingMode",value:function(e){e!==this._descriptor.samplingMode&&(this._descriptor.samplingMode=e,this._samplingModeDirty=!0)}},{key:"setWrapMode",value:function(t){t!==this._descriptor.wrapMode&&(this._descriptor.wrapMode=t,e._validateTexture(this._context,this._descriptor),this._wrapModeDirty=!0)}},{key:"applyChanges",value:function(){var t=this._context.gl,r=this._descriptor;this._samplingModeDirty&&(e._applySamplingMode(t,r),this._samplingModeDirty=!1),this._wrapModeDirty&&(e._applyWrapMode(t,r),this._wrapModeDirty=!1)}}],[{key:"_validateTexture",value:function(e,t){(t.width<0||t.height<0)&&console.error("Negative dimension parameters are not allowed!");var r=Object(o.l)(t.width)&&Object(o.l)(t.height);Object(l.a)(e.gl)||r||("number"==typeof t.wrapMode?33071!==t.wrapMode&&console.error("Non-power-of-two textures must have a wrap mode of CLAMP_TO_EDGE!"):33071===t.wrapMode.s&&33071===t.wrapMode.t||console.error("Non-power-of-two textures must have a wrap mode of CLAMP_TO_EDGE!"),t.hasMipmap&&console.error("Mipmapping requires power-of-two textures!"))}},{key:"_applySamplingMode",value:function(e,t){var r=t.samplingMode,n=t.samplingMode;9985===r||9987===r?(r=9729,t.hasMipmap||(n=9729)):9984!==r&&9986!==r||(r=9728,t.hasMipmap||(n=9728)),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,r),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,n)}},{key:"_applyWrapMode",value:function(e,t){"number"==typeof t.wrapMode?(e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,t.wrapMode),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,t.wrapMode)):(e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,t.wrapMode.s),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,t.wrapMode.t))}},{key:"_applyAnisotropicFilteringParameters",value:function(e,t){var r,n=e.capabilities.textureFilterAnisotropic;if(n){var i=e.gl;i.texParameterf(i.TEXTURE_2D,n.TEXTURE_MAX_ANISOTROPY,null!=(r=t.maxAnisotropy)?r:1)}}}]),e}();u.TEXTURE_UNIT_FOR_UPDATES=0,t.a=u},function(e,t,r){"use strict";r.d(t,"a",(function(){return b})),r.d(t,"b",(function(){return g})),r.d(t,"c",(function(){return m})),r.d(t,"d",(function(){return v})),r.d(t,"e",(function(){return O})),r.d(t,"f",(function(){return u})),r.d(t,"g",(function(){return y})),r.d(t,"h",(function(){return d}));var n=r(33),i=r(25),a=r(55),o=r(72),s=r(59);function c(e){return 57.29577951308232*e}function l(e){return.017453292519943*e}function u(e){return e/o.a.radius}function d(e){return Math.PI/2-2*Math.atan(Math.exp(-1*e/o.a.radius))}function h(e){return null!=e.wkid||null!=e.wkt}var f=[0,0];function p(e,t,r,i,a){var o,s,c,l,u=e,d=a;if(d.spatialReference=r,"x"in u&&"x"in d){var h=t(u.x,u.y,f,i),p=Object(n.a)(h,2);d.x=p[0],d.y=p[1]}else if("xmin"in u&&"xmin"in d)o=t(u.xmin,u.ymin,f,i),s=Object(n.a)(o,2),d.xmin=s[0],d.ymin=s[1],c=t(u.xmax,u.ymax,f,i),l=Object(n.a)(c,2),d.xmax=l[0],d.ymax=l[1];else if("paths"in u&&"paths"in d||"rings"in u&&"rings"in d){for(var b,v=("paths"in u?u.paths:u.rings),m=[],y=0;y<v.length;y++){var g=v[y];b=[],m.push(b);for(var O=0;O<g.length;O++)b.push(t(g[O][0],g[O][1],[0,0],i)),g[O].length>2&&b[O].push(g[O][2]),g[O].length>3&&b[O].push(g[O][3])}"paths"in d?d.paths=m:d.rings=m}else if("points"in u&&"points"in d){for(var j=u.points,_=[],w=0;w<j.length;w++)_[w]=t(j[w][0],j[w][1],[0,0],i),j[w].length>2&&_[w].push(j[w][2]),j[w].length>3&&_[w].push(j[w][3]);d.points=_}return a}function b(e,t){var r=e&&(h(e)?e:e.spatialReference),n=t&&(h(t)?t:t.spatialReference);return!(e&&"type"in e&&"mesh"===e.type||t&&"type"in t&&"mesh"===t.type||!r||!n)&&(!!Object(s.c)(n,r)||Object(s.n)(n)&&Object(s.k)(r)||Object(s.n)(r)&&Object(s.k)(n))}function v(e,t){var r=e&&e.spatialReference,n=t&&(h(t)?t:t.spatialReference);return b(r,n)?Object(s.c)(r,n)?Object(i.a)(e):Object(s.n)(n)?p(e,m,a.a.WebMercator,!1,Object(i.a)(e)):Object(s.k)(n)?p(e,y,a.a.WGS84,!1,Object(i.a)(e)):null:null}function m(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[0,0];t>89.99999?t=89.99999:t<-89.99999&&(t=-89.99999);var n=l(t);return r[0]=l(e)*o.a.radius,r[1]=o.a.halfSemiMajorAxis*Math.log((1+Math.sin(n))/(1-Math.sin(n))),r}function y(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[0,0],n=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=c(e/o.a.radius);return r[0]=n?i:i-360*Math.floor((i+180)/360),r[1]=c(Math.PI/2-2*Math.atan(Math.exp(-1*t/o.a.radius))),r}function g(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Object(i.a)(e);return p(e,m,a.a.WebMercator,t,r)}function O(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Object(i.a)(e);return p(e,y,a.a.WGS84,t,r)}},function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var n=r(14),i=r(1);function a(e,t){var r=t?Object(n.a)(Object(n.a)({},t),{},{source:e}):e;return Object(i.b)({aliasOf:r})}},function(e,t,r){"use strict";r.d(t,"a",(function(){return n})),r.d(t,"b",(function(){return i})),r.d(t,"c",(function(){return c})),r.d(t,"d",(function(){return s}));var n=1e-6,i=Math.random,a=Math.PI/180,o=180/Math.PI;function s(e){return e*a}function c(e){return e*o}Object.freeze({__proto__:null,EPSILON:n,RANDOM:i,toRadian:s,toDegree:c,equals:function(e,t){return Math.abs(e-t)<=n*Math.max(1,Math.abs(e),Math.abs(t))}})},function(e,t,r){"use strict";r.d(t,"a",(function(){return l}));var n=r(18),i=r(204),a=Object.prototype.toString;function o(e){var t="__accessorMetadata__"in e?Object(n.m)(e):e;return function(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];if(r.push(t),"number"==typeof r[2])throw new Error("Using @cast has parameter decorator is not supported since 4.16");return s.apply(this,r)}}function s(e,t,r,n){Object(i.b)(e,t).cast=n}function c(e){return function(t,r){Object(i.b)(t,e).cast=t[r]}}function l(){if(3!==arguments.length||"string"!=typeof(arguments.length<=1?void 0:arguments[1]))return 1===arguments.length&&"[object Function]"===a.call(arguments.length<=0?void 0:arguments[0])?o(arguments.length<=0?void 0:arguments[0]):1===arguments.length&&"string"==typeof(arguments.length<=0?void 0:arguments[0])?c(arguments.length<=0?void 0:arguments[0]):void 0}},function(e,t,r){"use strict";r.d(t,"a",(function(){return n})),r.d(t,"b",(function(){return g})),r.d(t,"c",(function(){return p})),r.d(t,"d",(function(){return v})),r.d(t,"e",(function(){return b})),r.d(t,"f",(function(){return m})),r.d(t,"g",(function(){return y}));var n,i,a=r(134),o=r(3),s=r(26),c=r(31),l=r(9),u=r(51),d=r(359),h=r(105),f=r(162);function p(e,t,r,n,i,a,o,s,c,l,d){var h,f,p=O[d.mode],b=0;if(Object(u.q)(e,t,r,n,c.spatialReference,i,s))return p.requiresAlignment(d)?(b=p.applyElevationAlignmentBuffer(n,i,a,o,s,c,l,d),h=a,f=o):(h=n,f=i),Object(u.q)(h,c.spatialReference,f,a,l.spatialReference,o,s)?b:void 0}function b(e,t,r,n,i){var s=(Object(d.a)(e)?e.z:Object(f.c)(e)?e.array[e.offset+2]:e[2])||0;switch(r.mode){case"on-the-ground":var c=Object(o.t)(Object(f.b)(t,e,"ground"),0);return i&&(i.verticalDistanceToGround=0,i.sampledElevation=c),c;case"relative-to-ground":var l=Object(o.t)(Object(f.b)(t,e,"ground"),0),u=r.geometryZWithOffset(s,n);return i&&(i.verticalDistanceToGround=u,i.sampledElevation=l),u+l;case"relative-to-scene":var h=Object(o.t)(Object(f.b)(t,e,"scene"),0),p=r.geometryZWithOffset(s,n);return i&&(i.verticalDistanceToGround=p,i.sampledElevation=h),p+h;case"absolute-height":var b=r.geometryZWithOffset(s,n);if(i){var v=Object(o.t)(Object(f.b)(t,e,"ground"),0);i.verticalDistanceToGround=b-v,i.sampledElevation=v}return b;default:return Object(a.a)(r.mode),0}}function v(e,t,r){return null==t||null==r?e.definedChanged:"on-the-ground"===t&&"on-the-ground"===r?e.staysOnTheGround:t===r||"on-the-ground"!==t&&"on-the-ground"!==r?n.UPDATE:e.onTheGroundChanged}function m(e){return"relative-to-ground"===e||"relative-to-scene"===e}function y(e){return"absolute-height"!==e}function g(e,t,r,n,i){var a=b(t,r,i,n,_);Object(h.j)(e,_.verticalDistanceToGround);var o=_.sampledElevation,c=Object(s.d)(j,e.transformation);return w[0]=t.x,w[1]=t.y,w[2]=a,Object(u.d)(t.spatialReference,w,c,n.spatialReference)?e.transformation=c:console.warn("Could not locate symbol object properly, it might be misplaced"),o}(i=n||(n={}))[i.NONE=0]="NONE",i[i.UPDATE=1]="UPDATE",i[i.RECREATE=2]="RECREATE";var O={"absolute-height":{applyElevationAlignmentBuffer:function(e,t,r,n,i,a,o,s){var c=s.calculateOffsetRenderUnits(o),l=s.featureExpressionInfoContext;t*=3,n*=3;for(var u=0;u<i;++u){var d=e[t+0],h=e[t+1],f=e[t+2];r[n+0]=d,r[n+1]=h,r[n+2]=null==l?f+c:c,t+=3,n+=3}return 0},requiresAlignment:function(e){var t=e.meterUnitOffset,r=e.featureExpressionInfoContext;return 0!==t||null!=r}},"on-the-ground":{applyElevationAlignmentBuffer:function(e,t,r,n,i,a){var s=0,c=a.spatialReference;t*=3,n*=3;for(var l=0;l<i;++l){var u=e[t+0],d=e[t+1],h=e[t+2],f=Object(o.t)(a.getElevation(u,d,h,c,"ground"),0);s+=f,r[n+0]=u,r[n+1]=d,r[n+2]=f,t+=3,n+=3}return s/i},requiresAlignment:function(){return!0}},"relative-to-ground":{applyElevationAlignmentBuffer:function(e,t,r,n,i,a,s,c){var l=0,u=c.calculateOffsetRenderUnits(s),d=c.featureExpressionInfoContext,h=a.spatialReference;t*=3,n*=3;for(var f=0;f<i;++f){var p=e[t+0],b=e[t+1],v=e[t+2],m=Object(o.t)(a.getElevation(p,b,v,h,"ground"),0);l+=m,r[n+0]=p,r[n+1]=b,r[n+2]=null==d?v+m+u:m+u,t+=3,n+=3}return l/i},requiresAlignment:function(){return!0}},"relative-to-scene":{applyElevationAlignmentBuffer:function(e,t,r,n,i,a,s,c){var l=0,u=c.calculateOffsetRenderUnits(s),d=c.featureExpressionInfoContext,h=a.spatialReference;t*=3,n*=3;for(var f=0;f<i;++f){var p=e[t+0],b=e[t+1],v=e[t+2],m=Object(o.t)(a.getElevation(p,b,v,h,"scene"),0);l+=m,r[n+0]=p,r[n+1]=b,r[n+2]=null==d?v+m+u:m+u,t+=3,n+=3}return l/i},requiresAlignment:function(){return!0}}},j=Object(c.d)(),_={verticalDistanceToGround:0,sampledElevation:0},w=Object(l.e)()},function(e,t,r){"use strict";var n,i=r(33),a=r(2),o=r(5),s=r(6),c=r(7),l=r(0),u=r(3),d=r(147),h=r(1),f=(r(17),r(18),r(15),r(10)),p=r(160),b=r(56),v=r(55),m=r(169),y=r(449),g=r(59),O=r(61);function j(e,t,r){return null==t?r:null==r?t:e(t,r)}var _=n=function(e){Object(s.a)(r,e);var t=Object(c.a)(r);function r(){var e;Object(a.a)(this,r);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))).type="extent",e.xmin=0,e.ymin=0,e.mmin=void 0,e.zmin=void 0,e.xmax=0,e.ymax=0,e.mmax=void 0,e.zmax=void 0,e}return Object(o.a)(r,[{key:"normalizeCtorArgs",value:function(e,t,r,n,i){return function(e){return e&&("esri.geometry.SpatialReference"===e.declaredClass||null!=e.wkid)}(e)?{spatialReference:e,xmin:0,ymin:0,xmax:0,ymax:0}:"object"==typeof e?(e.spatialReference=null==e.spatialReference?v.a.WGS84:e.spatialReference,e):{xmin:e,ymin:t,xmax:r,ymax:n,spatialReference:null==i?v.a.WGS84:i}}},{key:"cache",get:function(){return this.commitProperty("xmin"),this.commitProperty("ymin"),this.commitProperty("zmin"),this.commitProperty("mmin"),this.commitProperty("xmax"),this.commitProperty("ymax"),this.commitProperty("zmax"),this.commitProperty("mmax"),this.commitProperty("spatialReference"),{}}},{key:"center",get:function(){var e=new b.a({x:.5*(this.xmin+this.xmax),y:.5*(this.ymin+this.ymax),spatialReference:this.spatialReference});return this.hasZ&&(e.z=.5*(this.zmin+this.zmax)),this.hasM&&(e.m=.5*(this.mmin+this.mmax)),e}},{key:"extent",get:function(){return this.clone()}},{key:"hasM",get:function(){return null!=this.mmin&&null!=this.mmax}},{key:"hasZ",get:function(){return null!=this.zmin&&null!=this.zmax}},{key:"height",get:function(){return Math.abs(this.ymax-this.ymin)}},{key:"width",get:function(){return Math.abs(this.xmax-this.xmin)}},{key:"centerAt",value:function(e){var t=this.center;return null!=e.z&&this.hasZ?this.offset(e.x-t.x,e.y-t.y,e.z-t.z):this.offset(e.x-t.x,e.y-t.y)}},{key:"clone",value:function(){var e=new n;return e.xmin=this.xmin,e.ymin=this.ymin,e.xmax=this.xmax,e.ymax=this.ymax,e.spatialReference=this.spatialReference,null!=this.zmin&&(e.zmin=this.zmin,e.zmax=this.zmax),null!=this.mmin&&(e.mmin=this.mmin,e.mmax=this.mmax),e}},{key:"contains",value:function(e){if(!e)return!1;var t=this.spatialReference,r=e.spatialReference;return t&&r&&!t.equals(r)&&Object(O.a)(t,r)&&(e=t.isWebMercator?Object(O.b)(e):Object(O.e)(e,!0)),"point"===e.type?Object(m.e)(this,e):"extent"===e.type&&Object(m.c)(this,e)}},{key:"equals",value:function(e){if(!e)return!1;var t=this.spatialReference,r=e.spatialReference;return t&&r&&!t.equals(r)&&Object(O.a)(t,r)&&(e=t.isWebMercator?Object(O.b)(e):Object(O.e)(e,!0)),this.xmin===e.xmin&&this.ymin===e.ymin&&this.zmin===e.zmin&&this.mmin===e.mmin&&this.xmax===e.xmax&&this.ymax===e.ymax&&this.zmax===e.zmax&&this.mmax===e.mmax}},{key:"expand",value:function(e){var t=.5*(1-e),r=this.width*t,n=this.height*t;if(this.xmin+=r,this.ymin+=n,this.xmax-=r,this.ymax-=n,this.hasZ){var i=(this.zmax-this.zmin)*t;this.zmin+=i,this.zmax-=i}if(this.hasM){var a=(this.mmax-this.mmin)*t;this.mmin+=a,this.mmax-=a}return this}},{key:"intersects",value:function(e){if(Object(u.i)(e))return!1;"mesh"===e.type&&(e=e.extent);var t=this.spatialReference,r=e.spatialReference;return t&&r&&!t.equals(r)&&Object(O.a)(t,r)&&(e=t.isWebMercator?Object(O.b)(e):Object(O.e)(e,!0)),Object(y.b)(e.type)(this,e)}},{key:"normalize",value:function(){var e=this._normalize(!1,!0);return Array.isArray(e)?e:[e]}},{key:"offset",value:function(e,t,r){return this.xmin+=e,this.ymin+=t,this.xmax+=e,this.ymax+=t,null!=r&&(this.zmin+=r,this.zmax+=r),this}},{key:"shiftCentralMeridian",value:function(){return this._normalize(!0)}},{key:"union",value:function(e){return this.xmin=Math.min(this.xmin,e.xmin),this.ymin=Math.min(this.ymin,e.ymin),this.xmax=Math.max(this.xmax,e.xmax),this.ymax=Math.max(this.ymax,e.ymax),(this.hasZ||e.hasZ)&&(this.zmin=j(Math.min,this.zmin,e.zmin),this.zmax=j(Math.max,this.zmax,e.zmax)),(this.hasM||e.hasM)&&(this.mmin=j(Math.min,this.mmin,e.mmin),this.mmax=j(Math.max,this.mmax,e.mmax)),this}},{key:"intersection",value:function(e){return this.intersects(e)?(this.xmin=Math.max(this.xmin,e.xmin),this.ymin=Math.max(this.ymin,e.ymin),this.xmax=Math.min(this.xmax,e.xmax),this.ymax=Math.min(this.ymax,e.ymax),(this.hasZ||e.hasZ)&&(this.zmin=j(Math.max,this.zmin,e.zmin),this.zmax=j(Math.min,this.zmax,e.zmax)),(this.hasM||e.hasM)&&(this.mmin=j(Math.max,this.mmin,e.mmin),this.mmax=j(Math.min,this.mmax,e.mmax)),this):null}},{key:"toJSON",value:function(e){return this.write(null,e)}},{key:"_shiftCM",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Object(g.d)(this.spatialReference);if(!e||!this.spatialReference)return this;var t=this.spatialReference,r=this._getCM(e);if(r){var n=t.isWebMercator?Object(O.e)(r):r;this.xmin-=r.x,this.xmax-=r.x,t.isWebMercator||(n.x=this._normalizeX(n.x,e).x),this.spatialReference=new v.a(Object(d.c)(t.isWGS84?e.altTemplate:e.wkTemplate,{Central_Meridian:n.x}))}return this}},{key:"_getCM",value:function(e){var t=null,r=Object(i.a)(e.valid,2),n=r[0],a=r[1],o=this.xmin,s=this.xmax;return o>=n&&o<=a&&s>=n&&s<=a||(t=this.center),t}},{key:"_normalize",value:function(e,t,r){var n=this.spatialReference;if(!n)return this;if(!(r=r||Object(g.d)(n)))return this;var i=this._getParts(r).map((function(e){return e.extent}));if(i.length<2)return i[0]||this;if(i.length>2)return e?this._shiftCM(r):this.set({xmin:r.valid[0],xmax:r.valid[1]});if(e)return this._shiftCM(r);if(t)return i;var a=!0,o=!0;return i.forEach((function(e){e.hasZ||(a=!1),e.hasM||(o=!1)})),{rings:i.map((function(e){var t=[[e.xmin,e.ymin],[e.xmin,e.ymax],[e.xmax,e.ymax],[e.xmax,e.ymin],[e.xmin,e.ymin]];if(a)for(var r=(e.zmax-e.zmin)/2,n=0;n<t.length;n++)t[n].push(r);if(o)for(var i=(e.mmax-e.mmin)/2,s=0;s<t.length;s++)t[s].push(i);return t})),hasZ:a,hasM:o,spatialReference:n}}},{key:"_getParts",value:function(e){var t=this.cache._parts;if(!t){t=[];var r,a=this.ymin,o=this.ymax,s=this.spatialReference,c=this.width,l=this.xmin,u=this.xmax;e=e||Object(g.d)(s);var d=Object(i.a)(e.valid,2),h=d[0],f=d[1],p=(r=this._normalizeX(this.xmin,e)).x,b=r.frameId,v=(r=this._normalizeX(this.xmax,e)).x,m=r.frameId,y=p===v&&c>0;if(c>2*f){var O=new n(l<u?p:v,a,f,o,s),j=new n(h,a,l<u?v:p,o,s),_=new n(0,a,f,o,s),w=new n(h,a,0,o,s),x=[],k=[];O.contains(_)&&x.push(b),O.contains(w)&&k.push(b),j.contains(_)&&x.push(m),j.contains(w)&&k.push(m);for(var S=b+1;S<m;S++)x.push(S),k.push(S);t.push({extent:O,frameIds:[b]},{extent:j,frameIds:[m]},{extent:_,frameIds:x},{extent:w,frameIds:k})}else p>v||y?t.push({extent:new n(p,a,f,o,s),frameIds:[b]},{extent:new n(h,a,v,o,s),frameIds:[m]}):t.push({extent:new n(p,a,v,o,s),frameIds:[b]});this.cache._parts=t}var T=this.hasZ,C=this.hasM;if(T||C){var M={};T&&(M.zmin=this.zmin,M.zmax=this.zmax),C&&(M.mmin=this.mmin,M.mmax=this.mmax);for(var P=0;P<t.length;P++)t[P].extent.set(M)}return t}},{key:"_normalizeX",value:function(e,t){var r,n=Object(i.a)(t.valid,2),a=n[0],o=n[1],s=2*o,c=0;return e>o?(e-=(r=Math.ceil(Math.abs(e-o)/s))*s,c=r):e<a&&(e+=(r=Math.ceil(Math.abs(e-a)/s))*s,c=-r),{x:e,frameId:c}}}],[{key:"fromBounds",value:function(e,t){return new n({xmin:e[0],ymin:e[1],xmax:e[2],ymax:e[3],spatialReference:t})}}]),r}(p.a);Object(l.a)([Object(h.b)({readOnly:!0})],_.prototype,"cache",null),Object(l.a)([Object(h.b)({readOnly:!0})],_.prototype,"center",null),Object(l.a)([Object(h.b)({readOnly:!0})],_.prototype,"extent",null),Object(l.a)([Object(h.b)({readOnly:!0,json:{write:{enabled:!1,overridePolicy:null}}})],_.prototype,"hasM",null),Object(l.a)([Object(h.b)({readOnly:!0,json:{write:{enabled:!1,overridePolicy:null}}})],_.prototype,"hasZ",null),Object(l.a)([Object(h.b)({readOnly:!0})],_.prototype,"height",null),Object(l.a)([Object(h.b)({readOnly:!0})],_.prototype,"width",null),Object(l.a)([Object(h.b)({type:Number,json:{type:[Number,String],write:{enabled:!0,allowNull:!0}}})],_.prototype,"xmin",void 0),Object(l.a)([Object(h.b)({type:Number,json:{write:!0}})],_.prototype,"ymin",void 0),Object(l.a)([Object(h.b)({type:Number,json:{origins:{"web-scene":{write:!1}},write:{overridePolicy:function(){return{enabled:this.hasM}}}}})],_.prototype,"mmin",void 0),Object(l.a)([Object(h.b)({type:Number,json:{origins:{"web-scene":{write:!1}},write:{overridePolicy:function(){return{enabled:this.hasZ}}}}})],_.prototype,"zmin",void 0),Object(l.a)([Object(h.b)({type:Number,json:{write:!0}})],_.prototype,"xmax",void 0),Object(l.a)([Object(h.b)({type:Number,json:{write:!0}})],_.prototype,"ymax",void 0),Object(l.a)([Object(h.b)({type:Number,json:{origins:{"web-scene":{write:!1}},write:{overridePolicy:function(){return{enabled:this.hasM}}}}})],_.prototype,"mmax",void 0),Object(l.a)([Object(h.b)({type:Number,json:{origins:{"web-scene":{write:!1}},write:{overridePolicy:function(){return{enabled:this.hasZ}}}}})],_.prototype,"zmax",void 0),(_=n=Object(l.a)([Object(f.a)("esri.geometry.Extent")],_)).prototype.toJSON.isDefaultToJSON=!0;var w=_;t.a=w},function(e,t,r){"use strict";r.d(t,"a",(function(){return v})),r.d(t,"b",(function(){return s})),r.d(t,"c",(function(){return d})),r.d(t,"d",(function(){return f})),r.d(t,"e",(function(){return l})),r.d(t,"f",(function(){return i})),r.d(t,"g",(function(){return a})),r.d(t,"h",(function(){return p})),r.d(t,"i",(function(){return y})),r.d(t,"j",(function(){return u})),r.d(t,"k",(function(){return b})),r.d(t,"l",(function(){return h})),r.d(t,"m",(function(){return o})),r.d(t,"n",(function(){return c}));var n=r(63);function i(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[4],e[4]=t[5],e[5]=t[6],e[6]=t[8],e[7]=t[9],e[8]=t[10],e}function a(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e}function o(e,t,r,n,i,a,o,s,c,l){return e[0]=t,e[1]=r,e[2]=n,e[3]=i,e[4]=a,e[5]=o,e[6]=s,e[7]=c,e[8]=l,e}function s(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e}function c(e,t){if(e===t){var r=t[1],n=t[2],i=t[5];e[1]=t[3],e[2]=t[6],e[3]=r,e[5]=t[7],e[6]=n,e[7]=i}else e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8];return e}function l(e,t){var r=t[0],n=t[1],i=t[2],a=t[3],o=t[4],s=t[5],c=t[6],l=t[7],u=t[8],d=u*o-s*l,h=-u*a+s*c,f=l*a-o*c,p=r*d+n*h+i*f;return p?(p=1/p,e[0]=d*p,e[1]=(-u*n+i*l)*p,e[2]=(s*n-i*o)*p,e[3]=h*p,e[4]=(u*r-i*c)*p,e[5]=(-s*r+i*a)*p,e[6]=f*p,e[7]=(-l*r+n*c)*p,e[8]=(o*r-n*a)*p,e):null}function u(e,t,r){var n=t[0],i=t[1],a=t[2],o=t[3],s=t[4],c=t[5],l=t[6],u=t[7],d=t[8],h=r[0],f=r[1],p=r[2],b=r[3],v=r[4],m=r[5],y=r[6],g=r[7],O=r[8];return e[0]=h*n+f*o+p*l,e[1]=h*i+f*s+p*u,e[2]=h*a+f*c+p*d,e[3]=b*n+v*o+m*l,e[4]=b*i+v*s+m*u,e[5]=b*a+v*c+m*d,e[6]=y*n+g*o+O*l,e[7]=y*i+g*s+O*u,e[8]=y*a+g*c+O*d,e}function d(e,t,r){var n=t[0],i=t[1],a=t[2],o=t[3],s=t[4],c=t[5],l=t[6],u=t[7],d=t[8],h=r[0],f=r[1];return e[0]=n,e[1]=i,e[2]=a,e[3]=o,e[4]=s,e[5]=c,e[6]=h*n+f*o+l,e[7]=h*i+f*s+u,e[8]=h*a+f*c+d,e}function h(e,t,r){var n=t[0],i=t[1],a=t[2],o=t[3],s=t[4],c=t[5],l=t[6],u=t[7],d=t[8],h=Math.sin(r),f=Math.cos(r);return e[0]=f*n+h*o,e[1]=f*i+h*s,e[2]=f*a+h*c,e[3]=f*o-h*n,e[4]=f*s-h*i,e[5]=f*c-h*a,e[6]=l,e[7]=u,e[8]=d,e}function f(e,t,r){var n=r[0],i=r[1],a=r[2];return e[0]=n*t[0],e[1]=n*t[1],e[2]=n*t[2],e[3]=i*t[3],e[4]=i*t[4],e[5]=i*t[5],e[6]=a*t[6],e[7]=a*t[7],e[8]=a*t[8],e}function p(e,t){var r=t[0],n=t[1],i=t[2],a=t[3],o=r+r,s=n+n,c=i+i,l=r*o,u=n*o,d=n*s,h=i*o,f=i*s,p=i*c,b=a*o,v=a*s,m=a*c;return e[0]=1-d-p,e[3]=u-m,e[6]=h+v,e[1]=u+m,e[4]=1-l-p,e[7]=f-b,e[2]=h-v,e[5]=f+b,e[8]=1-l-d,e}function b(e,t){var r=t[0],n=t[1],i=t[2],a=t[4],o=t[5],s=t[6],c=t[8],l=t[9],u=t[10],d=u*o-s*l,h=-u*a+s*c,f=l*a-o*c,p=r*d+n*h+i*f;if(!p)return null;var b=1/p;return e[0]=d*b,e[1]=(-u*n+i*l)*b,e[2]=(s*n-i*o)*b,e[3]=h*b,e[4]=(u*r-i*c)*b,e[5]=(-s*r+i*a)*b,e[6]=f*b,e[7]=(-l*r+n*c)*b,e[8]=(o*r-n*a)*b,e}function v(e,t){var r=t[0],n=t[1],i=t[2],a=t[3],o=t[4],s=t[5],c=t[6],l=t[7],u=t[8],d=t[9],h=t[10],f=t[11],p=t[12],b=t[13],v=t[14],m=t[15],y=r*s-n*o,g=r*c-i*o,O=r*l-a*o,j=n*c-i*s,_=n*l-a*s,w=i*l-a*c,x=u*b-d*p,k=u*v-h*p,S=u*m-f*p,T=d*v-h*b,C=d*m-f*b,M=h*m-f*v,P=y*M-g*C+O*T+j*S-_*k+w*x;return P?(P=1/P,e[0]=(s*M-c*C+l*T)*P,e[1]=(c*S-o*M-l*k)*P,e[2]=(o*C-s*S+l*x)*P,e[3]=(i*C-n*M-a*T)*P,e[4]=(r*M-i*S+a*k)*P,e[5]=(n*S-r*C-a*x)*P,e[6]=(b*w-v*_+m*j)*P,e[7]=(v*O-p*w-m*g)*P,e[8]=(p*_-b*O+m*y)*P,e):null}function m(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e[2]=t[2]-r[2],e[3]=t[3]-r[3],e[4]=t[4]-r[4],e[5]=t[5]-r[5],e[6]=t[6]-r[6],e[7]=t[7]-r[7],e[8]=t[8]-r[8],e}function y(e){var t=n.a,r=e[0],i=e[1],a=e[2],o=e[3],s=e[4],c=e[5],l=e[6],u=e[7],d=e[8];return Math.abs(1-(r*r+o*o+l*l))<=t&&Math.abs(1-(i*i+s*s+u*u))<=t&&Math.abs(1-(a*a+c*c+d*d))<=t}var g=u,O=m;Object.freeze({__proto__:null,fromMat4:i,copy:a,set:o,identity:s,transpose:c,invert:l,adjoint:function(e,t){var r=t[0],n=t[1],i=t[2],a=t[3],o=t[4],s=t[5],c=t[6],l=t[7],u=t[8];return e[0]=o*u-s*l,e[1]=i*l-n*u,e[2]=n*s-i*o,e[3]=s*c-a*u,e[4]=r*u-i*c,e[5]=i*a-r*s,e[6]=a*l-o*c,e[7]=n*c-r*l,e[8]=r*o-n*a,e},determinant:function(e){var t=e[0],r=e[1],n=e[2],i=e[3],a=e[4],o=e[5],s=e[6],c=e[7],l=e[8];return t*(l*a-o*c)+r*(-l*i+o*s)+n*(c*i-a*s)},multiply:u,translate:d,rotate:h,scale:f,scaleByVec2:function(e,t,r){var n=r[0],i=r[1];return e[0]=n*t[0],e[1]=n*t[1],e[2]=n*t[2],e[3]=i*t[3],e[4]=i*t[4],e[5]=i*t[5],e},fromTranslation:function(e,t){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=t[0],e[7]=t[1],e[8]=1,e},fromRotation:function(e,t){var r=Math.sin(t),n=Math.cos(t);return e[0]=n,e[1]=r,e[2]=0,e[3]=-r,e[4]=n,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e},fromScaling:function(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=0,e[4]=t[1],e[5]=0,e[6]=0,e[7]=0,e[8]=1,e},fromMat2d:function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=0,e[3]=t[2],e[4]=t[3],e[5]=0,e[6]=t[4],e[7]=t[5],e[8]=1,e},fromQuat:p,normalFromMat4Legacy:b,normalFromMat4:v,projection:function(e,t,r){return e[0]=2/t,e[1]=0,e[2]=0,e[3]=0,e[4]=-2/r,e[5]=0,e[6]=-1,e[7]=1,e[8]=1,e},str:function(e){return"mat3("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+", "+e[8]+")"},frob:function(e){return Math.sqrt(Math.pow(e[0],2)+Math.pow(e[1],2)+Math.pow(e[2],2)+Math.pow(e[3],2)+Math.pow(e[4],2)+Math.pow(e[5],2)+Math.pow(e[6],2)+Math.pow(e[7],2)+Math.pow(e[8],2))},add:function(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e[3]=t[3]+r[3],e[4]=t[4]+r[4],e[5]=t[5]+r[5],e[6]=t[6]+r[6],e[7]=t[7]+r[7],e[8]=t[8]+r[8],e},subtract:m,multiplyScalar:function(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e[4]=t[4]*r,e[5]=t[5]*r,e[6]=t[6]*r,e[7]=t[7]*r,e[8]=t[8]*r,e},multiplyScalarAndAdd:function(e,t,r,n){return e[0]=t[0]+r[0]*n,e[1]=t[1]+r[1]*n,e[2]=t[2]+r[2]*n,e[3]=t[3]+r[3]*n,e[4]=t[4]+r[4]*n,e[5]=t[5]+r[5]*n,e[6]=t[6]+r[6]*n,e[7]=t[7]+r[7]*n,e[8]=t[8]+r[8]*n,e},exactEquals:function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&e[4]===t[4]&&e[5]===t[5]&&e[6]===t[6]&&e[7]===t[7]&&e[8]===t[8]},equals:function(e,t){var r=e[0],i=e[1],a=e[2],o=e[3],s=e[4],c=e[5],l=e[6],u=e[7],d=e[8],h=t[0],f=t[1],p=t[2],b=t[3],v=t[4],m=t[5],y=t[6],g=t[7],O=t[8];return Math.abs(r-h)<=n.a*Math.max(1,Math.abs(r),Math.abs(h))&&Math.abs(i-f)<=n.a*Math.max(1,Math.abs(i),Math.abs(f))&&Math.abs(a-p)<=n.a*Math.max(1,Math.abs(a),Math.abs(p))&&Math.abs(o-b)<=n.a*Math.max(1,Math.abs(o),Math.abs(b))&&Math.abs(s-v)<=n.a*Math.max(1,Math.abs(s),Math.abs(v))&&Math.abs(c-m)<=n.a*Math.max(1,Math.abs(c),Math.abs(m))&&Math.abs(l-y)<=n.a*Math.max(1,Math.abs(l),Math.abs(y))&&Math.abs(u-g)<=n.a*Math.max(1,Math.abs(u),Math.abs(g))&&Math.abs(d-O)<=n.a*Math.max(1,Math.abs(d),Math.abs(O))},isOrthoNormal:y,mul:g,sub:O})},function(e,t,r){"use strict";r.d(t,"a",(function(){return s})),r.d(t,"b",(function(){return c})),r.d(t,"c",(function(){return l})),r.d(t,"d",(function(){return u})),r.d(t,"e",(function(){return f})),r.d(t,"f",(function(){return p})),r.d(t,"g",(function(){return h})),r.d(t,"h",(function(){return d}));var n=r(55),i=r(72),a=r(59);function o(e){return new n.a({wkt:'GEOCCS["Spherical geocentric",\n    DATUM["Not specified",\n      SPHEROID["Sphere",'.concat(e.radius,',0]],\n    PRIMEM["Greenwich",0.0,\n      AUTHORITY["EPSG","8901"]],\n    UNIT["m",1.0],\n    AXIS["Geocentric X",OTHER],\n    AXIS["Geocentric Y",EAST],\n    AXIS["Geocentric Z",NORTH]\n  ]')})}var s=o(i.a),c=o(i.b),l=o(i.c),u=new n.a({wkt:'GEOCCS["WGS 84",\n  DATUM["WGS_1984",\n    SPHEROID["WGS 84",'.concat(i.a.radius,',298.257223563,\n      AUTHORITY["EPSG","7030"]],\n    AUTHORITY["EPSG","6326"]],\n  PRIMEM["Greenwich",0,\n    AUTHORITY["EPSG","8901"]],\n  UNIT["m",1.0,\n    AUTHORITY["EPSG","9001"]],\n  AXIS["Geocentric X",OTHER],\n  AXIS["Geocentric Y",OTHER],\n  AXIS["Geocentric Z",NORTH],\n  AUTHORITY["EPSG","4978"]\n]')});function d(e){return e&&e===i.b?c:e&&e===i.c?l:s}function h(e){return e&&(Object(a.h)(e)||e===c)?c:e&&(Object(a.i)(e)||e===l)?l:s}function f(e){return e&&(Object(a.h)(e)||e===c)?i.b:e&&(Object(a.i)(e)||e===l)?i.c:i.a}function p(e){return Object(a.l)(e)?i.b:Object(a.m)(e)?i.c:i.a}},function(e,t,r){"use strict";r.d(t,"a",(function(){return U})),r.d(t,"b",(function(){return _})),r.d(t,"c",(function(){return x})),r.d(t,"d",(function(){return z})),r.d(t,"e",(function(){return F})),r.d(t,"f",(function(){return D})),r.d(t,"g",(function(){return R})),r.d(t,"h",(function(){return L})),r.d(t,"i",(function(){return I})),r.d(t,"j",(function(){return u})),r.d(t,"k",(function(){return w})),r.d(t,"l",(function(){return A})),r.d(t,"m",(function(){return B})),r.d(t,"n",(function(){return j})),r.d(t,"o",(function(){return P})),r.d(t,"p",(function(){return T})),r.d(t,"q",(function(){return C})),r.d(t,"r",(function(){return M})),r.d(t,"s",(function(){return k})),r.d(t,"t",(function(){return S})),r.d(t,"u",(function(){return E}));var n=r(14),i=(r(17),r(58)),a=r(68),o=r(55),s=r(72),c=r(59),l=r(481),u=39.37,d=s.a.radius*Math.PI/200,h=/UNIT\[([^\]]+)\]\]$/i,f=l.a,p=/UNIT\[([^\]]+)\]/i,b=new Set([4261,4305,4807,4810,4811,4812,4816,4819,4821,4901,4902,37225,104139,104140]),v=Object(i.b)()({meter:"meters",foot:"feet",foot_us:"us-feet",foot_clarke:"clarke-feet",yard_clarke:"clarke-yards",link_clarke:"clarke-links",yard_sears:"sears-yards",foot_sears:"sears-feet",chain_sears:"sears-chains",chain_benoit_1895_b:"benoit-1895-b-chains",yard_indian:"indian-yards",yard_indian_1937:"indian-1937-yards",foot_gold_coast:"gold-coast-feet",chain_sears_1922_truncated:"sears-1922-truncated-chains","50_kilometers":"50-kilometers","150_kilometers":"150-kilometers"}),m=function(e){return e*e},y=function(e){return e*e*e},g={length:{baseUnit:"meters",units:{millimeters:{inBaseUnits:.001},centimeters:{inBaseUnits:.01},decimeters:{inBaseUnits:.1},meters:{inBaseUnits:1},kilometers:{inBaseUnits:1e3},inches:{inBaseUnits:.0254},feet:{inBaseUnits:.3048},yards:{inBaseUnits:.9144},miles:{inBaseUnits:1609.344},"nautical-miles":{inBaseUnits:1852},"us-feet":{inBaseUnits:1200/3937}}},area:{baseUnit:"square-meters",units:{"square-millimeters":{inBaseUnits:m(.001)},"square-centimeters":{inBaseUnits:m(.01)},"square-decimeters":{inBaseUnits:m(.1)},"square-meters":{inBaseUnits:1},"square-kilometers":{inBaseUnits:m(1e3)},"square-inches":{inBaseUnits:m(.0254)},"square-feet":{inBaseUnits:m(.3048)},"square-yards":{inBaseUnits:m(.9144)},"square-miles":{inBaseUnits:m(1609.344)},"square-us-feet":{inBaseUnits:m(1200/3937)},acres:{inBaseUnits:.0015625*m(1609.344)},ares:{inBaseUnits:100},hectares:{inBaseUnits:1e4}}},volume:{baseUnit:"liters",units:{liters:{inBaseUnits:1},"cubic-millimeters":{inBaseUnits:1e3*y(.001)},"cubic-centimeters":{inBaseUnits:1e3*y(.01)},"cubic-decimeters":{inBaseUnits:1e3*y(.1)},"cubic-meters":{inBaseUnits:1e3},"cubic-kilometers":{inBaseUnits:1e3*y(1e3)},"cubic-inches":{inBaseUnits:1e3*y(.0254)},"cubic-feet":{inBaseUnits:1e3*y(.3048)},"cubic-yards":{inBaseUnits:1e3*y(.9144)},"cubic-miles":{inBaseUnits:1e3*y(1609.344)}}},angle:{baseUnit:"radians",units:{radians:{inBaseUnits:1},degrees:{inBaseUnits:Math.PI/180}}}},O=function(){var e={};for(var t in g)for(var r in g[t].units)e[r]=t;return e}();function j(e){var t=O[e];if(t)return t;throw new Error("unknown measure")}function _(e){return function(e){return g[e].baseUnit}(j(e))}function w(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return t=t||j(e),g[t].baseUnit===e}function x(e,t,r){if(t===r)return e;var n=j(t);if(n!==j(r))throw new Error("incompatible units");var i=w(t,n)?e:function(e,t,r){return e*g[r].units[t].inBaseUnits}(e,t,n);return w(r,n)?i:function(e,t,r){return e/g[r].units[t].inBaseUnits}(i,r,n)}function k(e,t){return x(e,t,"meters")<3e3?"meters":"kilometers"}function S(e,t){return x(e,t,"meters")<1e5?"meters":"kilometers"}function T(e,t){return x(e,t,"feet")<1e3?"feet":"miles"}function C(e,t){return x(e,t,"feet")<1e5?"feet":"miles"}function M(e,t){return x(e,t,"square-meters")<3e6?"square-meters":"square-kilometers"}function P(e,t){return x(e,t,"square-feet")<1e6?"square-feet":"square-miles"}function A(e,t,r){return x(e,t,"meters")/(r*Math.PI/180)}function E(e){return v.fromJSON(e.toLowerCase())||null}function R(e){if(e&&"object"==typeof e&&!Object(c.f)(e))return 1;var t=D(e);return t>1e5?1:t}function I(e){return D(e)>=(e instanceof o.a?Object(a.e)(e).metersPerDegree:1e5)?"meters":L(e)}function D(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:s.a.metersPerDegree;return F(e,!0)||t}function F(e){var t,r,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=null;if(null!=e&&("object"==typeof e?(t=e.wkid,r=e.wkt):"number"==typeof e?t=e:"string"==typeof e&&(r=e)),t){if(Object(c.l)(t))return s.b.metersPerDegree;if(Object(c.m)(t))return s.c.metersPerDegree;!(i=f.values[f[t]])&&n&&b.has(t)&&(i=d)}else if(r)if(-1!==r.search(/^PROJCS/i)){var a=h.exec(r);a&&a[1]&&(i=parseFloat(a[1].split(",")[1]))}else if(-1!==r.search(/^GEOCCS/i)){var o=p.exec(r);o&&o[1]&&(i=parseFloat(o[1].split(",")[1]))}return i}function L(e){var t,r,n=null;if(null!=e&&("object"==typeof e?(t=e.wkid,r=e.wkt):"number"==typeof e?t=e:"string"==typeof e&&(r=e)),t)n=f.units[f[t]];else if(r&&-1!==r.search(/^PROJCS/i)){var i=h.exec(r);i&&i[1]&&(n=(i=/[\\"\\']{1}([^\\"\\']+)/.exec(i[1]))&&i[1])}return n?E(n):null}function z(e){if(!e)return null;switch(L(e)){case"feet":case"us-feet":case"clarke-feet":case"clarke-yards":case"clarke-links":case"sears-yards":case"sears-feet":case"sears-chains":case"benoit-1895-b-chains":case"indian-yards":case"indian-1937-yards":case"gold-coast-feet":case"sears-1922-truncated-chains":return"imperial";case"50-kilometers":case"150-kilometers":case"meters":return"metric";case null:case void 0:return null}return null}var V={esriAcres:"acres",esriAres:"ares",esriHectares:"hectares",esriSquareCentimeters:"square-centimeters",esriSquareDecimeters:"square-decimeters",esriSquareFeet:"square-feet",esriSquareInches:"square-inches",esriSquareKilometers:"square-kilometers",esriSquareMeters:"square-meters",esriSquareMiles:"square-miles",esriSquareMillimeters:"square-millimeters",esriSquareUsFeet:"square-us-feet",esriSquareYards:"square-yards"},N={esriCentimeters:"centimeters",esriDecimeters:"decimeters",esriFeet:"feet",esriInches:"inches",esriKilometers:"kilometers",esriMeters:"meters",esriMiles:"miles",esriMillimeters:"millimeters",esriNauticalMiles:"nautical-miles",esriYards:"yards"},U=Object(i.b)()(V),B=Object(i.b)()(N);Object(i.b)()(Object(n.a)(Object(n.a)({},V),N))},function(e,t,r){"use strict";r.d(t,"a",(function(){return g})),r.d(t,"b",(function(){return S})),r.d(t,"c",(function(){return b})),r.d(t,"d",(function(){return C})),r.d(t,"e",(function(){return O})),r.d(t,"f",(function(){return w})),r.d(t,"g",(function(){return _})),r.d(t,"h",(function(){return v})),r.d(t,"i",(function(){return x})),r.d(t,"j",(function(){return k})),r.d(t,"k",(function(){return m})),r.d(t,"l",(function(){return D})),r.d(t,"m",(function(){return y}));r(17);var n=r(15),i=r(20),a=r(3),o=r(26),s=r(4),c=r(9),l=r(54),u=r(43),d=r(79),h=r(210),f=r(47),p=n.a.getLogger("esri.geometry.support.sphere");function b(){return Object(u.e)()}function v(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:b();return Object(l.c)(t,e)}function m(e,t){return Object(u.g)(e[0],e[1],e[2],t)}function y(e){return e}function g(e){e[0]=e[1]=e[2]=e[3]=0}function O(e){return e}function j(e){return Array.isArray(e)?e[3]:e}function _(e){return Array.isArray(e)?e:R}function w(e,t,r,n){return Object(u.g)(e,t,r,n)}function x(e,t,r){if(Object(a.i)(t))return!1;var n=Object(s.l)(f.c.get(),t.origin,_(e)),i=Object(s.j)(t.direction,t.direction),o=2*Object(s.j)(t.direction,n),c=o*o-4*i*(Object(s.j)(n,n)-e[3]*e[3]);if(c<0)return!1;var l=Math.sqrt(c),u=(-o-l)/(2*i),d=(-o+l)/(2*i);return(u<0||d<u&&d>0)&&(u=d),!(u<0)&&(r&&Object(s.h)(r,t.origin,Object(s.g)(f.c.get(),t.direction,u)),!0)}function k(e,t){return x(e,t,null)}function S(e,t,r){var n=f.c.get(),i=f.a.get();Object(s.i)(n,t.origin,t.direction);var a=j(e);Object(s.i)(r,n,t.origin),Object(s.g)(r,r,1/Object(s.r)(r)*a);var c=M(e,t.origin),l=Object(h.a)(t.origin,r);return Object(o.i)(i),Object(o.c)(i,i,l+c,n),Object(s.s)(r,r,i),r}function T(e,t,r){var n=Object(s.l)(f.c.get(),t,_(e)),i=Object(s.g)(f.c.get(),n,e[3]/Object(s.r)(n));return Object(s.h)(r,i,_(e))}function C(e,t){var r=Object(s.l)(f.c.get(),t,_(e)),n=Object(s.v)(r),i=e[3]*e[3];return Math.sqrt(Math.abs(n-i))}function M(e,t){var r=Object(s.l)(f.c.get(),t,_(e)),n=Object(s.r)(r),a=j(e),o=a+Math.abs(a-n);return Object(i.b)(a/o)}var P=Object(c.e)();function A(e,t,r,n){var a=Object(s.l)(P,t,_(e));switch(r){case 0:var o=Object(i.d)(a,P)[2];return Object(s.y)(n,-Math.sin(o),Math.cos(o),0);case 1:var c=Object(i.d)(a,P),l=c[1],u=c[2],d=Math.sin(l);return Object(s.y)(n,-d*Math.cos(u),-d*Math.sin(u),Math.cos(l));case 2:return Object(s.t)(n,a);default:return}}function E(e,t){var r=Object(s.l)(I,t,_(e));return Object(s.r)(r)-e[3]}var R=Object(c.e)(),I=Object(c.e)(),D=Object.freeze({__proto__:null,create:b,copy:v,fromCenterAndRadius:m,wrap:y,clear:g,fromRadius:O,getRadius:j,getCenter:_,fromValues:w,elevate:function(e,t,r){return e!==r&&Object(s.m)(r,e),r[3]=e[3]+t,r},setExtent:function(e,t,r){return p.error("sphere.setExtent is not yet supported"),e===r?r:v(e,r)},intersectRay:x,intersectsRay:k,intersectRayClosestSilhouette:function(e,t,r){if(x(e,t,r))return r;var n=S(e,t,f.c.get());return Object(s.h)(r,t.origin,Object(s.g)(f.c.get(),t.direction,Object(s.o)(t.origin,n)/Object(s.r)(t.direction))),r},closestPointOnSilhouette:S,closestPoint:function(e,t,r){return x(e,t,r)?r:(Object(d.a)(t,_(e),r),T(e,r,r))},projectPoint:T,distanceToSilhouette:C,angleToSilhouette:M,axisAt:A,altitudeAt:E,setAltitudeAt:function(e,t,r,n){var i=E(e,t),a=A(e,t,2,I),o=Object(s.g)(I,a,r-i);return Object(s.h)(n,t,o)}})},function(e,t,r){"use strict";(function(e){var r="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof e?e:void 0;t.a=r}).call(this,r(682))},function(e,t,r){"use strict";r.d(t,"a",(function(){return o})),r.d(t,"b",(function(){return s})),r.d(t,"c",(function(){return c}));var n=r(2),i=r(5),a=function(){function e(t,r,i,a){Object(n.a)(this,e),this.semiMajorAxis=t,this.flattening=r,this.outerAtmosphereRimWidth=i;var o=1-this.flattening;this.semiMinorAxis=this.semiMajorAxis*o,this.halfSemiMajorAxis=this.semiMajorAxis/2,this.halfCircumference=Math.PI*this.semiMajorAxis,this.metersPerDegree=this.halfCircumference/180,this.inverseFlattening=1/(1-this.flattening)-1,this.eccentricitySquared=a||2*this.flattening-this.flattening*this.flattening,this.meanRadiusSemiAxes=(2*this.semiMajorAxis+this.semiMinorAxis)/3}return Object(i.a)(e,[{key:"radius",get:function(){return this.semiMajorAxis}}]),e}(),o=new a(6378137,1/298.257223563,3e5,.006694379990137799),s=new a(3396190,1/169.8944472236118,23e4),c=new a(1737400,0,0)},function(e,t,r){"use strict";function n(){return new Float32Array(3)}function i(e){var t=new Float32Array(3);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t}function a(e,t,r){var n=new Float32Array(3);return n[0]=e,n[1]=t,n[2]=r,n}function o(e,t){return new Float32Array(e,t,3)}function s(){return n()}function c(){return a(1,1,1)}function l(){return a(1,0,0)}function u(){return a(0,1,0)}function d(){return a(0,0,1)}r.d(t,"a",(function(){return i})),r.d(t,"b",(function(){return o})),r.d(t,"c",(function(){return n})),r.d(t,"d",(function(){return a}));var h=s(),f=c(),p=l(),b=u(),v=d();Object.freeze({__proto__:null,create:n,clone:i,fromValues:a,createView:o,zeros:s,ones:c,unitX:l,unitY:u,unitZ:d,ZEROS:h,ONES:f,UNIT_X:p,UNIT_Y:b,UNIT_Z:v})},function(e,t,r){"use strict";var n,i=r(2),a=r(5),o=r(101),s=r(8),c=r.n(s);!function(e){var t=c.a.mark(i),r=function(e,t,r,n){for(var i=t,a=t,o=r>>>1,s=e[i-1];a<=o;){(a=i<<1)<r&&n(e[a-1],e[a])<0&&++a;var c=e[a-1];if(n(c,s)<=0)break;e[i-1]=c,i=a}e[i-1]=s},n=function(e,t){return e<t?-1:e>t?1:0};function i(e,i,a,o){var s,l,u,d;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:void 0===i&&(i=0),void 0===a&&(a=e.length),void 0===o&&(o=n),s=a>>>1;case 2:if(!(s>i)){t.next=9;break}return r(e,s,a,o),void(t.next=6);case 6:s--,t.next=2;break;case 9:l=i+1,u=a-1;case 11:if(!(u>i)){t.next=21;break}return d=e[i],e[i]=e[u],e[u]=d,r(e,l,u,o),void(t.next=18);case 18:u--,t.next=11;break;case 21:case"end":return t.stop()}}),t)}e.sort=function(e,t,i,a){void 0===t&&(t=0),void 0===i&&(i=e.length),void 0===a&&(a=n);for(var o=i>>>1;o>t;o--)r(e,o,i,a);for(var s=t+1,c=i-1;c>t;c--){var l=e[t];e[t]=e[c],e[c]=l,r(e,s,c,a)}},e.iterableSort=i}(n||(n={}));var l=n,u=function(){function e(t){var r=this;Object(i.a)(this,e),this.data=[],this._length=0,this._allocator=void 0,this._deallocator=function(){return null},this._shrink=function(){},this._hint=new o.a,t&&(t.initialSize&&(this.data=new Array(t.initialSize)),t.allocator&&(this._allocator=t.allocator),void 0!==t.deallocator&&(this._deallocator=t.deallocator),t.shrink&&(this._shrink=function(){return d(r)}))}return Object(a.a)(e,[{key:"toArray",value:function(){return this.data.slice(0,this.length)}},{key:"getItemAt",value:function(e){if(!(e<0||e>=this._length))return this.data[e]}},{key:"length",get:function(){return this._length},set:function(e){if(e>this._length){if(this._allocator){for(;this._length<e;)this.data[this._length++]=this._allocator(this.data[this._length]);return}this._length=e}else{if(this._deallocator)for(var t=e;t<this._length;++t)this.data[t]=this._deallocator(this.data[t]);this._length=e,this._shrink()}}},{key:"clear",value:function(){this.length=0}},{key:"prune",value:function(){this.clear(),this.data=[]}},{key:"push",value:function(e){this.data[this._length++]=e}},{key:"pushArray",value:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.length,r=0;r<t;r++)this.data[this._length++]=e[r]}},{key:"fill",value:function(e,t){for(var r=0;r<t;r++)this.data[this._length++]=e}},{key:"pushNew",value:function(){this._allocator&&(this.data[this.length]=this._allocator(this.data[this.length]));var e=this.data[this._length];return++this._length,e}},{key:"unshift",value:function(e){this.data.unshift(e),this._length++,d(this)}},{key:"pop",value:function(){if(0!==this.length){var e=this.data[this.length-1];return this.length=this.length-1,this._shrink(),e}}},{key:"remove",value:function(e){var t=Object(o.g)(this.data,e,this.length,this._hint);if(-1!==t)return this.data.splice(t,1),this.length=this.length-1,e}},{key:"removeUnordered",value:function(e){var t=Object(o.k)(this.data,e,this.length,this._hint);return void 0!==t&&(this.length=this.length-1),this._shrink(),t}},{key:"removeUnorderedIndex",value:function(e){if(!(e>=this.length||e<0))return this.swapElements(e,this.length-1),this.pop()}},{key:"removeUnorderedMany",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.length,r=arguments.length>2?arguments[2]:void 0;this.length=Object(o.l)(this.data,e,this.length,t,this._hint,r),this._shrink()}},{key:"front",value:function(){if(0!==this.length)return this.data[0]}},{key:"back",value:function(){if(0!==this.length)return this.data[this.length-1]}},{key:"swapElements",value:function(e,t){var r;e>=this.length||t>=this.length||e===t||(r=[this.data[t],this.data[e]],this.data[e]=r[0],this.data[t]=r[1])}},{key:"sort",value:function(e){l.sort(this.data,0,this.length,e)}},{key:"iterableSort",value:function(e){return l.iterableSort(this.data,0,this.length,e)}},{key:"some",value:function(e,t){for(var r=0;r<this.length;++r)if(e.call(t,this.data[r],r,this.data))return!0;return!1}},{key:"filterInPlace",value:function(e,t){for(var r=0,n=0;n<this._length;++n){var i=this.data[n];e.call(t,i,n,this.data)&&(this.data[n]=this.data[r],this.data[r]=i,r++)}if(this._deallocator)for(var a=r;a<this._length;a++)this.data[a]=this._deallocator(this.data[a]);return this._length=r,this._shrink(),this}},{key:"forAll",value:function(e,t){for(var r=this.length,n=this.data,i=0;i<r;++i)e.call(t,n[i],i,n)}},{key:"map",value:function(e,t){for(var r=new Array(this.length),n=0;n<this.length;++n)r[n]=e.call(t,this.data[n],n,this.data);return r}},{key:"reduce",value:function(e,t){for(var r=t,n=0;n<this.length;++n)r=e(r,this.data[n],n,this.data);return r}},{key:"has",value:function(e){for(var t=this.length,r=this.data,n=0;n<t;++n)if(r[n]===e)return!0;return!1}}]),e}();function d(e){e.data.length>1.5*e.length&&(e.data.length=Math.floor(1.1*e.length))}t.a=u},function(e,t,r){"use strict";function n(e){return e}function i(e){return 1e3*e}function a(e){return e}function o(e){return.001*e}r.d(t,"a",(function(){return n})),r.d(t,"b",(function(){return i})),r.d(t,"c",(function(){return a})),r.d(t,"d",(function(){return o}))},function(e,t,r){"use strict";r.d(t,"a",(function(){return f})),r.d(t,"b",(function(){return b})),r.d(t,"c",(function(){return p}));var n,i,a,o,s,c=r(12),l=r(3),u=r(4),d=r(9),h=r(11);function f(e,t){if(t.slicePlaneEnabled){e.extensions.add("GL_OES_standard_derivatives"),t.sliceEnabledForVertexPrograms&&(e.vertex.uniforms.add("slicePlaneOrigin","vec3"),e.vertex.uniforms.add("slicePlaneBasis1","vec3"),e.vertex.uniforms.add("slicePlaneBasis2","vec3")),e.fragment.uniforms.add("slicePlaneOrigin","vec3"),e.fragment.uniforms.add("slicePlaneBasis1","vec3"),e.fragment.uniforms.add("slicePlaneBasis2","vec3");var r=Object(h.a)(n||(n=Object(c.a)(["struct SliceFactors {\nfloat front;\nfloat side0;\nfloat side1;\nfloat side2;\nfloat side3;\n};\nSliceFactors calculateSliceFactors(vec3 pos) {\nvec3 rel = pos - slicePlaneOrigin;\nvec3 slicePlaneNormal = -cross(slicePlaneBasis1, slicePlaneBasis2);\nfloat slicePlaneW = -dot(slicePlaneNormal, slicePlaneOrigin);\nfloat basis1Len2 = dot(slicePlaneBasis1, slicePlaneBasis1);\nfloat basis2Len2 = dot(slicePlaneBasis2, slicePlaneBasis2);\nfloat basis1Dot = dot(slicePlaneBasis1, rel);\nfloat basis2Dot = dot(slicePlaneBasis2, rel);\nreturn SliceFactors(\ndot(slicePlaneNormal, pos) + slicePlaneW,\n-basis1Dot - basis1Len2,\nbasis1Dot - basis1Len2,\n-basis2Dot - basis2Len2,\nbasis2Dot - basis2Len2\n);\n}\nbool sliceByFactors(SliceFactors factors) {\nreturn factors.front < 0.0\n&& factors.side0 < 0.0\n&& factors.side1 < 0.0\n&& factors.side2 < 0.0\n&& factors.side3 < 0.0;\n}\nbool sliceEnabled() {\nreturn dot(slicePlaneBasis1, slicePlaneBasis1) != 0.0;\n}\nbool sliceByPlane(vec3 pos) {\nreturn sliceEnabled() && sliceByFactors(calculateSliceFactors(pos));\n}\n#define rejectBySlice(_pos_) sliceByPlane(_pos_)\n#define discardBySlice(_pos_) { if (sliceByPlane(_pos_)) discard; }"]))),l=Object(h.a)(i||(i=Object(c.a)(["vec4 applySliceHighlight(vec4 color, vec3 pos) {\nSliceFactors factors = calculateSliceFactors(pos);\nif (sliceByFactors(factors)) {\nreturn color;\n}\nconst float HIGHLIGHT_WIDTH = 1.0;\nconst vec4 HIGHLIGHT_COLOR = vec4(0.0, 0.0, 0.0, 0.3);\nfactors.front /= (2.0 * HIGHLIGHT_WIDTH) * fwidth(factors.front);\nfactors.side0 /= (2.0 * HIGHLIGHT_WIDTH) * fwidth(factors.side0);\nfactors.side1 /= (2.0 * HIGHLIGHT_WIDTH) * fwidth(factors.side1);\nfactors.side2 /= (2.0 * HIGHLIGHT_WIDTH) * fwidth(factors.side2);\nfactors.side3 /= (2.0 * HIGHLIGHT_WIDTH) * fwidth(factors.side3);\nfloat highlightFactor = (1.0 - step(0.5, factors.front))\n* (1.0 - step(0.5, factors.side0))\n* (1.0 - step(0.5, factors.side1))\n* (1.0 - step(0.5, factors.side2))\n* (1.0 - step(0.5, factors.side3));\nreturn mix(color, vec4(HIGHLIGHT_COLOR.rgb, color.a), highlightFactor * HIGHLIGHT_COLOR.a);\n}"]))),u=t.sliceHighlightDisabled?Object(h.a)(a||(a=Object(c.a)(["#define highlightSlice(_color_, _pos_) (_color_)"]))):Object(h.a)(o||(o=Object(c.a)(["\n        ","\n        #define highlightSlice(_color_, _pos_) (sliceEnabled() ? applySliceHighlight(_color_, _pos_) : (_color_))\n      "])),l);t.sliceEnabledForVertexPrograms&&e.vertex.code.add(r),e.fragment.code.add(r),e.fragment.code.add(u)}else{var d=Object(h.a)(s||(s=Object(c.a)(["#define rejectBySlice(_pos_) false\n#define discardBySlice(_pos_) {}\n#define highlightSlice(_color_, _pos_) (_color_)"])));t.sliceEnabledForVertexPrograms&&e.vertex.code.add(d),e.fragment.code.add(d)}}function p(e,t,r){b(e,t,r.slicePlane,r.origin)}function b(e,t,r,n){t.slicePlaneEnabled&&(Object(l.j)(r)?(n?(Object(u.l)(v,r.origin,n),e.setUniform3fv("slicePlaneOrigin",v)):e.setUniform3fv("slicePlaneOrigin",r.origin),e.setUniform3fv("slicePlaneBasis1",r.basis1),e.setUniform3fv("slicePlaneBasis2",r.basis2)):(e.setUniform3fv("slicePlaneBasis1",d.b),e.setUniform3fv("slicePlaneBasis2",d.b),e.setUniform3fv("slicePlaneOrigin",d.b)))}var v=Object(d.e)()},function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));var n=new Map([["position",0],["normal",1],["uv0",2],["color",3],["size",4],["tangent",4],["auxpos1",5],["symbolColor",5],["auxpos2",6],["featureAttribute",6],["instanceFeatureAttribute",6],["instanceColor",7],["model",8],["modelNormal",12],["modelOriginHi",11],["modelOriginLo",15]])},function(e,t,r){"use strict";r.d(t,"a",(function(){return B})),r.d(t,"b",(function(){return T})),r.d(t,"c",(function(){return C})),r.d(t,"d",(function(){return G})),r.d(t,"e",(function(){return I})),r.d(t,"f",(function(){return A})),r.d(t,"g",(function(){return F})),r.d(t,"h",(function(){return P})),r.d(t,"i",(function(){return V})),r.d(t,"j",(function(){return D})),r.d(t,"k",(function(){return z})),r.d(t,"l",(function(){return E})),r.d(t,"m",(function(){return M})),r.d(t,"n",(function(){return R})),r.d(t,"o",(function(){return L})),r.d(t,"p",(function(){return N})),r.d(t,"q",(function(){return q})),r.d(t,"r",(function(){return U})),r.d(t,"s",(function(){return x}));var n=r(3),i=r(355),a=r(307),o=r(431),s=r(22),c=r(4),l=r(9),u=r(40),d=r(90),h=r(205),f=Object(l.e)(),p=Object(l.e)(),b=Object(l.e)(),v=Object(l.e)();function m(e,t,r,n){Object(c.m)(f,r),f[n]=t[n];var i,a=Object(c.l)(f,f,t),o=Object(c.l)(p,e,t),s=Object(c.j)(o,a),l=Object(c.j)(a,a);i=s<=0?t:l<=s?r:Object(c.h)(f,t,Object(c.g)(a,a,s/l));var u=Object(c.l)(f,e,i);return Math.PI/2-Math.atan(u[2]/Math.sqrt(u[0]*u[0]+u[1]*u[1]))}var y=Object.freeze({__proto__:null,isInsideExtent:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=e.extent;if(0===r)return Object(u.h)(n,t);var i=Math.min(n[2]-n[0],n[3]-n[1]);return Object(u.j)(n,t,r*i)},tiltToExtentEdge:function(e,t,r){var n=e.extent;b[0]=n[0],b[1]=n[1],b[2]=r,v[0]=n[2],v[1]=n[3],v[2]=r;var i=1/0,a=1/0;return t[0]<b[0]?i=m(t,b,v,0):t[0]>v[0]&&(i=m(t,v,b,0)),t[1]<b[1]?a=m(t,b,v,1):t[1]>v[1]&&(a=m(t,v,b,1)),Math.min(i,a)},checkIfTileInfoSupportedForViewSR:function(e,t,r){if(e.spatialReference.isGeographic)return new s.a("tilingscheme:local-gcs-not-supported","Geographic coordinate systems are not supported in local scenes");var n=h.a.checkUnsupported(e);return n||(function(e,t){var r=e.lods,n=r[0].resolution*Math.pow(2,r[0].level),i=[n*e.size[0],n*e.size[1]],a=[e.origin.x,e.origin.y],o=Object(u.r)(t),c=Object(u.k)();h.a.computeRowColExtent(o,i,a,c);var l=(c[2]-c[0])*(c[3]-c[1]);if(l>d.i){var f=r[0].scale*Math.pow(2,r[0].level),p=Math.max((o[3]-o[1])/e.size[1],(o[2]-o[0])/e.size[0])*f/n,b=Math.floor(Math.log(p)/Math.log(10));return p=Math.ceil(p/Math.pow(10,b))*Math.pow(10,b),new s.a("tilingscheme:too-many-root-tiles","Scale of level 0 of the tiling scheme (1:"+Math.floor(f).toLocaleString()+") is too large for the layer's extent. Suggested scale: 1:"+p.toLocaleString()+".",{level0Scale:f,suggestedLevel0Scale:p,requiredNumRootTiles:l,allowedNumRootTiles:d.i})}return null}(e,r)||(t&&!e.spatialReference.equals(t)?new s.a("tilingscheme:spatial-reference-mismatch","The tiling scheme does not match the spatial reference of the local scene"):null))}}),g=r(51),O=r(59);var j=Object.freeze({__proto__:null,isInsideExtent:function(){return!0},tiltToExtentEdge:function(){return 0},checkIfTileInfoSupportedForViewSR:function(e,t){var r=e.lods.length-1,n=e.spatialReference,i=Object(g.a)(n)||Object(O.h)(n)||Object(O.i)(n);if(n.isWebMercator){if(!h.a.makeWebMercatorAuxiliarySphere(r).compatibleWith(e))return new s.a("tilingscheme:incompatible-global-web-mercator","The tiling scheme is not compatible with the ArcGIS Online Web Mercator tiling scheme")}else{if(!i)return new s.a("tilingscheme:global-unsupported-spatial-reference","The tiling scheme spatial reference is not supported in global scenes");if(!h.a.makeGCSWithTileSize(e.spatialReference,e.size[0],r).compatibleWith(e))return e.spatialReference.isWGS84?new s.a("tilingscheme:incompatible-global-wgs84","The tiling scheme is not compatible with the ArcGIS Online WGS84 tiling scheme"):new s.a("tilingscheme:incompatible-global","The tiling scheme is not compatible with the ArcGIS Online tiling scheme")}if(t&&!e.spatialReference.equals(t))return new s.a("tilingscheme:spatial-reference-mismatch","The tiling scheme does not match the spatial reference of the global scene")}}),_=r(253),w={1:j,2:y};function x(e,t){e||console.warn("Terrain: "+t)}var k=80/180*Math.PI,S=110/180*Math.PI;function T(e,t,r){var i,a=w[e.viewingMode];if(a.isInsideExtent(e,t))i=Object(n.t)(e.getElevation(t[0],t[1],t[1],e.spatialReference),0);else{if(!a.isInsideExtent(e,t,1.2))return 0;var o=e.getTileWithElevation(t[0],t[1],t[1],e.spatialReference);i=.5*((Object(n.j)(o)?o.elevationBounds[0]:e.elevationBounds.min)+(Object(n.j)(o)?o.elevationBounds[1]:e.elevationBounds.max));var s=a.tiltToExtentEdge(e,t,i);if(s>k&&s<S)return 0}var c=t[2]-i;return Math.abs(c)<r?0:c<0?-1:1}function C(e){return A(e)?{fullExtent:e.fullExtent,minScale:e.layer.minScale,maxScale:e.layer.maxScale,tilemapCache:null}:e.layer}function M(e){return"vector-tile"===(null==e?void 0:e.type)}function P(e){return"imagery-tile"===(null==e?void 0:e.type)||"wcs"===(null==e?void 0:e.type)}function A(e){return"imagery-tile-3d"===(null==e?void 0:e.type)}function E(e){return"tile-3d"===(null==e?void 0:e.type)}function R(e){return"vector-tile-3d"===(null==e?void 0:e.type)}function I(e){return"elevation-3d"===(null==e?void 0:e.type)}function D(e){return e&&(E(e)||A(e)||I(e)||R(e)||function(e){return"wmts-3d"===(null==e?void 0:e.type)}(e))}function F(e){var t;return(null==e||null==(t=e.sourceLayerInfo)?void 0:t.data)instanceof o.a}function L(e){var t;return(null==e||null==(t=e.sourceLayerInfo)?void 0:t.data)instanceof i.a}function z(e){var t;return(null==e||null==(t=e.sourceLayerInfo)?void 0:t.data)instanceof _.a}function V(e){var t,r=null==e||null==(t=e.sourceLayerInfo)?void 0:t.data;return r instanceof HTMLImageElement||r instanceof a.a||r instanceof HTMLCanvasElement||r instanceof ImageData}function N(e){return Object(n.j)(e)&&"release"in e&&e.release(),null}function U(e){return e.fetchTile&&!1!==e.hasOverriddenFetchTile}function B(e,t,r,n){return w[n].checkIfTileInfoSupportedForViewSR(e,r,t)}function G(e,t,r){var n,i;if("wmts"===e.type){var a=e.activeLayer;if(a){var o=a.tileMatrixSet;if(o)n=o.tileInfo,i=o.fullExtent;else{var s=a.tileMatrixSets;if(s){var c=s.find((function(e){return null==B(e.tileInfo,e.fullExtent,t,r)}));if(c)return{tileInfo:c.tileInfo,fullExtent:c.fullExtent}}}}}else i=P(e)?e.getCompatibleFullExtent(t):e.fullExtent,n=M(e)&&!q.force512VTL?e.compatibleTileInfo256:P(e)?e.getCompatibleTileInfo(t,i,2===r):e.tileInfo;return n&&i&&null==B(n,i,t,r)?{tileInfo:n,fullExtent:i}:{tileInfo:null,fullExtent:null}}var q={force512VTL:!1}},function(e,t,r){"use strict";r.d(t,"a",(function(){return f})),r.d(t,"b",(function(){return l})),r.d(t,"c",(function(){return s})),r.d(t,"d",(function(){return h})),r.d(t,"e",(function(){return u})),r.d(t,"f",(function(){return d})),r.d(t,"g",(function(){return c}));var n=r(212),i=r(4),a=r(9),o=r(47);function s(e){return e?{origin:Object(a.c)(e.origin),direction:Object(a.c)(e.direction)}:{origin:Object(a.e)(),direction:Object(a.e)()}}function c(e,t){var r=p.get();return r.origin=e,r.direction=t,r}function l(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:s();return d(e.origin,e.direction,t)}function u(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:s();return Object(i.m)(r.origin,e),Object(i.l)(r.direction,t,e),r}function d(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:s();return Object(i.m)(r.origin,e),Object(i.m)(r.direction,t),r}function h(e,t){var r=Object(i.i)(o.c.get(),Object(i.t)(o.c.get(),e.direction),Object(i.l)(o.c.get(),t,e.origin));return Object(i.j)(r,r)}function f(e,t,r){var n=Object(i.j)(e.direction,Object(i.l)(r,t,e.origin));return Object(i.h)(r,e.origin,Object(i.g)(r,e.direction,n)),r}var p=new n.a((function(){return{origin:null,direction:null}}))},function(e,t,r){"use strict";r.d(t,"a",(function(){return v})),r.d(t,"b",(function(){return h})),r.d(t,"c",(function(){return l})),r.d(t,"d",(function(){return y}));var n,i=r(13),a=(r(17),r(15)),o=r(114),s=[],c=a.a.getLogger("esri.core.Accessor");function l(e){void 0!==n&&n.onObservableAccessed(e)}var u=!1,d=!1;function h(e,t,r){if(u)return f(e,t,r);p(e);var n=t.call(r);return b(),n}function f(e,t,r){var n=u;u=!0,p(e);var i=null;try{i=t.call(r)}catch(a){d&&c.error(a)}return b(),u=n,i}function p(e){n=e,s.push(e)}function b(){var e=s.pop();n=s.length>0?s[s.length-1]:void 0,void 0!==e&&e.onTrackingEnd()}function v(e,t){if(!(32&t.flags)){var r=d;d=!1,64&t.flags?f(t,t.metadata.get,e):y(e,t),d=r}}var m=[];function y(e,t){128&t.flags||(t.flags|=128,f(t,(function(){var r,n=t.metadata.dependsOn||m,a=Object(i.a)(n);try{for(a.s();!(r=a.n()).done;){var s=r.value;if("string"==typeof s&&-1===s.indexOf("."))g(e,s,!1);else for(var c=Object(o.f)(s),l=0,u=e;l<c.length&&null!=u&&"object"==typeof u;++l)u=g(u,c[l],l!==c.length-1)}}catch(d){a.e(d)}finally{a.f()}})),t.flags&=-129)}function g(e,t,r){var n="?"===t[t.length-1]?t.slice(0,-1):t;if(null!=e.getItemAt||Array.isArray(e)){var i=parseInt(n,10);if(!isNaN(i))return Array.isArray(e)?e[i]:e.getItemAt(i)}var a=Object(o.a)(e),s=null==a?void 0:a.properties.get(n);return s&&(l(s),v(e,s)),r?e[n]:void 0}},function(e,t,r){"use strict";var n=r(2),i=r(5),a=r(15),o=r(94),s=r(22),c=r(159),l=a.a.getLogger("esri/views/webgl");function u(e){if(Object(c.b)()){var t=e.getError();if(t){var r=function(e,t){switch(t){case e.INVALID_ENUM:return"Invalid Enum. An unacceptable value has been specified for an enumerated argument.";case e.INVALID_VALUE:return"Invalid Value. A numeric argument is out of range.";case e.INVALID_OPERATION:return"Invalid Operation. The specified command is not allowed for the current state.";case e.INVALID_FRAMEBUFFER_OPERATION:return"Invalid Framebuffer operation. The currently bound framebuffer is not framebuffer complete when trying to render to or to read from it.";case e.OUT_OF_MEMORY:return"Out of memory. Not enough memory is left to execute the command.";case e.CONTEXT_LOST_WEBGL:return"WebGL context has been lost";default:return"Unknown error"}}(e,t),n=(new Error).stack;l.error(new s.a("webgl-error","WebGL error occured",{message:r,stack:n}))}}}var d=r(122),h=a.a.getLogger("esri.views.webgl.BufferObject"),f=function(){function e(t,r,i,a,o){Object(n.a)(this,e),this._context=t,this.bufferType=r,this.usage=i,this._glName=null,this._size=-1,this._indexType=void 0,t.instanceCounter.increment(d.b.Buffer,this),this._glName=this._context.gl.createBuffer(),u(this._context.gl),a&&this.setData(a,o)}return Object(i.a)(e,[{key:"glName",get:function(){return this._glName}},{key:"size",get:function(){return this._size}},{key:"indexType",get:function(){return this._indexType}},{key:"byteSize",get:function(){return 34962===this.bufferType?this._size:5125===this._indexType?4*this._size:2*this._size}},{key:"dispose",value:function(){var e;null!=(e=this._context)&&e.gl?(this._glName&&(this._context.gl.deleteBuffer(this._glName),this._glName=null),this._context.instanceCounter.decrement(d.b.Buffer,this),this._context=null):this._glName&&h.warn("Leaked WebGL buffer object")}},{key:"setData",value:function(e,t){if(e){if("number"==typeof e){if(e<0&&h.error("Buffer size cannot be negative!"),34963===this.bufferType&&t)switch(this._indexType=t,this._size=e,t){case 5123:e*=2;break;case 5125:e*=4}}else{var r=e.byteLength;Object(o.i)(e)&&(r/=2,this._indexType=5123),Object(o.j)(e)&&(r/=4,this._indexType=5125),this._size=r}var n=this._context.getBoundVAO();this._context.bindVAO(null),this._context.bindBuffer(this);var i=this._context.gl;i.bufferData(this.bufferType,e,this.usage),u(i),this._context.bindVAO(n)}}},{key:"setSubData",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:e.byteLength;if(e){(t<0||t>=this._size)&&h.error("offset is out of range!");var i=t,a=r,s=n,c=e.byteLength;Object(o.i)(e)&&(c/=2,i*=2,a*=2,s*=2),Object(o.j)(e)&&(c/=4,i*=4,a*=4,s*=4),void 0===n&&(n=c-1),r>=n&&h.error("end must be bigger than start!"),t+r-n>this._size&&h.error("An attempt to write beyond the end of the buffer!");var l=this._context.getBoundVAO();this._context.bindVAO(null),this._context.bindBuffer(this);var d=this._context.gl,f=ArrayBuffer.isView(e)?e.buffer:e,p=0===a&&s===e.byteLength?f:f.slice(a,s);d.bufferSubData(this.bufferType,i,p),u(d),this._context.bindVAO(l)}}}],[{key:"createIndex",value:function(t,r,n,i){return new e(t,34963,r,n,i)}},{key:"createVertex",value:function(t,r,n){return new e(t,34962,r,n)}}]),e}();t.a=f},function(e,t,r){"use strict";var n=r(19),i=r(6),a=r(7),o=r(50),s=r(2),c=r(5),l=r(0),u=r(30),d=r(191),h=r(10),f=function(){function e(){Object(s.a)(this,e),this._emitter=new e.EventEmitter(this)}return Object(c.a)(e,[{key:"emit",value:function(e,t){return this._emitter.emit(e,t)}},{key:"on",value:function(e,t){return this._emitter.on(e,t)}},{key:"once",value:function(e,t){return this._emitter.once(e,t)}},{key:"hasEventListener",value:function(e){return this._emitter.hasEventListener(e)}}]),e}();!function(e){var t=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;Object(s.a)(this,e),this.target=t,this._listenersMap=null}return Object(c.a)(e,[{key:"clear",value:function(){this._listenersMap&&this._listenersMap.clear()}},{key:"emit",value:function(e,t){var r=this._listenersMap&&this._listenersMap.get(e);if(!r)return!1;var n=this.target||this;return Object(o.a)(r).forEach((function(e){e.call(n,t)})),r.length>0}},{key:"on",value:function(e,t){var r=this;if(Array.isArray(e)){var n=e.map((function(e){return r.on(e,t)}));return Object(d.a)(n)}if(e.indexOf(",")>-1)throw new TypeError("Evented.on() with a comma delimited string of event types is not supported");this._listenersMap||(this._listenersMap=new Map);var i=this._listenersMap.get(e)||[];return i.push(t),this._listenersMap.set(e,i),{remove:function(){var n=r._listenersMap&&r._listenersMap.get(e)||[],i=n.indexOf(t);i>=0&&n.splice(i,1)}}}},{key:"once",value:function(e,t){var r=this.on(e,(function(e){r.remove(),t.call(null,e)}));return r}},{key:"hasEventListener",value:function(e){var t=this._listenersMap&&this._listenersMap.get(e);return null!=t&&t.length>0}}]),e}();e.EventEmitter=t,e.EventedMixin=function(e){var r=function(e){Object(i.a)(n,e);var r=Object(a.a)(n);function n(){var e;return Object(s.a)(this,n),(e=r.apply(this,arguments))._emitter=new t,e}return Object(c.a)(n,[{key:"destroy",value:function(){this._emitter.clear()}},{key:"emit",value:function(e,t){return this._emitter.emit(e,t)}},{key:"on",value:function(e,t){return this._emitter.on(e,t)}},{key:"once",value:function(e,t){return this._emitter.once(e,t)}},{key:"hasEventListener",value:function(e){return this._emitter.hasEventListener(e)}}]),n}(e);return r=Object(l.a)([Object(h.a)("esri.core.Evented")],r)};var r=function(e){Object(i.a)(r,e);var t=Object(a.a)(r);function r(){var e;return Object(s.a)(this,r),(e=t.apply(this,arguments))._emitter=new f.EventEmitter(Object(n.a)(e)),e}return Object(c.a)(r,[{key:"emit",value:function(e,t){return this._emitter.emit(e,t)}},{key:"on",value:function(e,t){return this._emitter.on(e,t)}},{key:"once",value:function(e,t){return this._emitter.once(e,t)}},{key:"hasEventListener",value:function(e){return this._emitter.hasEventListener(e)}}]),r}(u.a);r=Object(l.a)([Object(h.a)("esri.core.Evented")],r),e.EventedAccessor=r}(f||(f={}));var p=f;t.a=p},function(e,t,r){"use strict";r.d(t,"a",(function(){return je})),r.d(t,"b",(function(){return ke})),r.d(t,"c",(function(){return we})),r.d(t,"d",(function(){return Ee})),r.d(t,"e",(function(){return Pe})),r.d(t,"f",(function(){return Me})),r.d(t,"g",(function(){return Ae})),r.d(t,"h",(function(){return _e})),r.d(t,"i",(function(){return Ce})),r.d(t,"j",(function(){return xe}));var n,i,a=Function.prototype,o=Object.prototype,s=a.toString,c=o.hasOwnProperty,l=s.call(Object),u=o.toString,d=(n=Object.getPrototypeOf,i=Object,function(e){return n(i(e))});var h=function(e){if(!function(e){return!!e&&"object"==typeof e}(e)||"[object Object]"!=u.call(e)||function(e){var t=!1;if(null!=e&&"function"!=typeof e.toString)try{t=!!(e+"")}catch(r){}return t}(e))return!1;var t=d(e);if(null===t)return!0;var r=c.call(t,"constructor")&&t.constructor;return"function"==typeof r&&r instanceof r&&s.call(r)==l},f={exports:{}},p={},b={exports:{}},v={};function m(){var e={"align-content":!1,"align-items":!1,"align-self":!1,"alignment-adjust":!1,"alignment-baseline":!1,all:!1,"anchor-point":!1,animation:!1,"animation-delay":!1,"animation-direction":!1,"animation-duration":!1,"animation-fill-mode":!1,"animation-iteration-count":!1,"animation-name":!1,"animation-play-state":!1,"animation-timing-function":!1,azimuth:!1,"backface-visibility":!1,background:!0,"background-attachment":!0,"background-clip":!0,"background-color":!0,"background-image":!0,"background-origin":!0,"background-position":!0,"background-repeat":!0,"background-size":!0,"baseline-shift":!1,binding:!1,bleed:!1,"bookmark-label":!1,"bookmark-level":!1,"bookmark-state":!1,border:!0,"border-bottom":!0,"border-bottom-color":!0,"border-bottom-left-radius":!0,"border-bottom-right-radius":!0,"border-bottom-style":!0,"border-bottom-width":!0,"border-collapse":!0,"border-color":!0,"border-image":!0,"border-image-outset":!0,"border-image-repeat":!0,"border-image-slice":!0,"border-image-source":!0,"border-image-width":!0,"border-left":!0,"border-left-color":!0,"border-left-style":!0,"border-left-width":!0,"border-radius":!0,"border-right":!0,"border-right-color":!0,"border-right-style":!0,"border-right-width":!0,"border-spacing":!0,"border-style":!0,"border-top":!0,"border-top-color":!0,"border-top-left-radius":!0,"border-top-right-radius":!0,"border-top-style":!0,"border-top-width":!0,"border-width":!0,bottom:!1,"box-decoration-break":!0,"box-shadow":!0,"box-sizing":!0,"box-snap":!0,"box-suppress":!0,"break-after":!0,"break-before":!0,"break-inside":!0,"caption-side":!1,chains:!1,clear:!0,clip:!1,"clip-path":!1,"clip-rule":!1,color:!0,"color-interpolation-filters":!0,"column-count":!1,"column-fill":!1,"column-gap":!1,"column-rule":!1,"column-rule-color":!1,"column-rule-style":!1,"column-rule-width":!1,"column-span":!1,"column-width":!1,columns:!1,contain:!1,content:!1,"counter-increment":!1,"counter-reset":!1,"counter-set":!1,crop:!1,cue:!1,"cue-after":!1,"cue-before":!1,cursor:!1,direction:!1,display:!0,"display-inside":!0,"display-list":!0,"display-outside":!0,"dominant-baseline":!1,elevation:!1,"empty-cells":!1,filter:!1,flex:!1,"flex-basis":!1,"flex-direction":!1,"flex-flow":!1,"flex-grow":!1,"flex-shrink":!1,"flex-wrap":!1,float:!1,"float-offset":!1,"flood-color":!1,"flood-opacity":!1,"flow-from":!1,"flow-into":!1,font:!0,"font-family":!0,"font-feature-settings":!0,"font-kerning":!0,"font-language-override":!0,"font-size":!0,"font-size-adjust":!0,"font-stretch":!0,"font-style":!0,"font-synthesis":!0,"font-variant":!0,"font-variant-alternates":!0,"font-variant-caps":!0,"font-variant-east-asian":!0,"font-variant-ligatures":!0,"font-variant-numeric":!0,"font-variant-position":!0,"font-weight":!0,grid:!1,"grid-area":!1,"grid-auto-columns":!1,"grid-auto-flow":!1,"grid-auto-rows":!1,"grid-column":!1,"grid-column-end":!1,"grid-column-start":!1,"grid-row":!1,"grid-row-end":!1,"grid-row-start":!1,"grid-template":!1,"grid-template-areas":!1,"grid-template-columns":!1,"grid-template-rows":!1,"hanging-punctuation":!1,height:!0,hyphens:!1,icon:!1,"image-orientation":!1,"image-resolution":!1,"ime-mode":!1,"initial-letters":!1,"inline-box-align":!1,"justify-content":!1,"justify-items":!1,"justify-self":!1,left:!1,"letter-spacing":!0,"lighting-color":!0,"line-box-contain":!1,"line-break":!1,"line-grid":!1,"line-height":!1,"line-snap":!1,"line-stacking":!1,"line-stacking-ruby":!1,"line-stacking-shift":!1,"line-stacking-strategy":!1,"list-style":!0,"list-style-image":!0,"list-style-position":!0,"list-style-type":!0,margin:!0,"margin-bottom":!0,"margin-left":!0,"margin-right":!0,"margin-top":!0,"marker-offset":!1,"marker-side":!1,marks:!1,mask:!1,"mask-box":!1,"mask-box-outset":!1,"mask-box-repeat":!1,"mask-box-slice":!1,"mask-box-source":!1,"mask-box-width":!1,"mask-clip":!1,"mask-image":!1,"mask-origin":!1,"mask-position":!1,"mask-repeat":!1,"mask-size":!1,"mask-source-type":!1,"mask-type":!1,"max-height":!0,"max-lines":!1,"max-width":!0,"min-height":!0,"min-width":!0,"move-to":!1,"nav-down":!1,"nav-index":!1,"nav-left":!1,"nav-right":!1,"nav-up":!1,"object-fit":!1,"object-position":!1,opacity:!1,order:!1,orphans:!1,outline:!1,"outline-color":!1,"outline-offset":!1,"outline-style":!1,"outline-width":!1,overflow:!1,"overflow-wrap":!1,"overflow-x":!1,"overflow-y":!1,padding:!0,"padding-bottom":!0,"padding-left":!0,"padding-right":!0,"padding-top":!0,page:!1,"page-break-after":!1,"page-break-before":!1,"page-break-inside":!1,"page-policy":!1,pause:!1,"pause-after":!1,"pause-before":!1,perspective:!1,"perspective-origin":!1,pitch:!1,"pitch-range":!1,"play-during":!1,position:!1,"presentation-level":!1,quotes:!1,"region-fragment":!1,resize:!1,rest:!1,"rest-after":!1,"rest-before":!1,richness:!1,right:!1,rotation:!1,"rotation-point":!1,"ruby-align":!1,"ruby-merge":!1,"ruby-position":!1,"shape-image-threshold":!1,"shape-outside":!1,"shape-margin":!1,size:!1,speak:!1,"speak-as":!1,"speak-header":!1,"speak-numeral":!1,"speak-punctuation":!1,"speech-rate":!1,stress:!1,"string-set":!1,"tab-size":!1,"table-layout":!1,"text-align":!0,"text-align-last":!0,"text-combine-upright":!0,"text-decoration":!0,"text-decoration-color":!0,"text-decoration-line":!0,"text-decoration-skip":!0,"text-decoration-style":!0,"text-emphasis":!0,"text-emphasis-color":!0,"text-emphasis-position":!0,"text-emphasis-style":!0,"text-height":!0,"text-indent":!0,"text-justify":!0,"text-orientation":!0,"text-overflow":!0,"text-shadow":!0,"text-space-collapse":!0,"text-transform":!0,"text-underline-position":!0,"text-wrap":!0,top:!1,transform:!1,"transform-origin":!1,"transform-style":!1,transition:!1,"transition-delay":!1,"transition-duration":!1,"transition-property":!1,"transition-timing-function":!1,"unicode-bidi":!1,"vertical-align":!1,visibility:!1,"voice-balance":!1,"voice-duration":!1,"voice-family":!1,"voice-pitch":!1,"voice-range":!1,"voice-rate":!1,"voice-stress":!1,"voice-volume":!1,volume:!1,"white-space":!1,widows:!1,width:!0,"will-change":!1,"word-break":!0,"word-spacing":!0,"word-wrap":!0,"wrap-flow":!1,"wrap-through":!1,"writing-mode":!1,"z-index":!1};return e}var y=/javascript\s*\:/gim;v.whiteList=m(),v.getDefaultWhiteList=m,v.onAttr=function(e,t,r){},v.onIgnoreAttr=function(e,t,r){},v.safeAttrValue=function(e,t){return y.test(t)?"":t};var g={indexOf:function(e,t){var r,n;if(Array.prototype.indexOf)return e.indexOf(t);for(r=0,n=e.length;r<n;r++)if(e[r]===t)return r;return-1},forEach:function(e,t,r){var n,i;if(Array.prototype.forEach)return e.forEach(t,r);for(n=0,i=e.length;n<i;n++)t.call(r,e[n],n,e)},trim:function(e){return String.prototype.trim?e.trim():e.replace(/(^\s*)|(\s*$)/g,"")},trimRight:function(e){return String.prototype.trimRight?e.trimRight():e.replace(/(\s*$)/g,"")}};var O=v,j=function(e,t){";"!==(e=g.trimRight(e))[e.length-1]&&(e+=";");var r=e.length,n=!1,i=0,a=0,o="";function s(){if(!n){var r=g.trim(e.slice(i,a)),s=r.indexOf(":");if(-1!==s){var c=g.trim(r.slice(0,s)),l=g.trim(r.slice(s+1));if(c){var u=t(i,o.length,c,l,r);u&&(o+=u+"; ")}}}i=a+1}for(;a<r;a++){var c=e[a];if("/"===c&&"*"===e[a+1]){var l=e.indexOf("*/",a+2);if(-1===l)break;i=(a=l+1)+1,n=!1}else"("===c?n=!0:")"===c?n=!1:";"===c?n||s():"\n"===c&&s()}return g.trim(o)};function _(e){return void 0===e||null===e}function w(e){(e=function(e){var t={};for(var r in e)t[r]=e[r];return t}(e||{})).whiteList=e.whiteList||O.whiteList,e.onAttr=e.onAttr||O.onAttr,e.onIgnoreAttr=e.onIgnoreAttr||O.onIgnoreAttr,e.safeAttrValue=e.safeAttrValue||O.safeAttrValue,this.options=e}w.prototype.process=function(e){if(!(e=(e=e||"").toString()))return"";var t=this.options,r=t.whiteList,n=t.onAttr,i=t.onIgnoreAttr,a=t.safeAttrValue;return j(e,(function(e,t,o,s,c){var l=r[o],u=!1;if(!0===l?u=l:"function"===typeof l?u=l(s):l instanceof RegExp&&(u=l.test(s)),!0!==u&&(u=!1),s=a(o,s)){var d,h={position:t,sourcePosition:e,source:c,isWhite:u};return u?_(d=n(o,s,h))?o+":"+s:d:_(d=i(o,s,h))?void 0:d}}))};var x=w;!function(e,t){var r=v,n=x;for(var i in(t=e.exports=function(e,t){return new n(t).process(e)}).FilterCSS=n,r)t[i]=r[i]}(b,b.exports);var k={indexOf:function(e,t){var r,n;if(Array.prototype.indexOf)return e.indexOf(t);for(r=0,n=e.length;r<n;r++)if(e[r]===t)return r;return-1},forEach:function(e,t,r){var n,i;if(Array.prototype.forEach)return e.forEach(t,r);for(n=0,i=e.length;n<i;n++)t.call(r,e[n],n,e)},trim:function(e){return String.prototype.trim?e.trim():e.replace(/(^\s*)|(\s*$)/g,"")},spaceIndex:function(e){var t=/\s|\n|\t/.exec(e);return t?t.index:-1}},S=b.exports.FilterCSS,T=b.exports.getDefaultWhiteList,C=k;function M(){return{a:["target","href","title"],abbr:["title"],address:[],area:["shape","coords","href","alt"],article:[],aside:[],audio:["autoplay","controls","crossorigin","loop","muted","preload","src"],b:[],bdi:["dir"],bdo:["dir"],big:[],blockquote:["cite"],br:[],caption:[],center:[],cite:[],code:[],col:["align","valign","span","width"],colgroup:["align","valign","span","width"],dd:[],del:["datetime"],details:["open"],div:[],dl:[],dt:[],em:[],figcaption:[],figure:[],font:["color","size","face"],footer:[],h1:[],h2:[],h3:[],h4:[],h5:[],h6:[],header:[],hr:[],i:[],img:["src","alt","title","width","height"],ins:["datetime"],li:[],mark:[],nav:[],ol:[],p:[],pre:[],s:[],section:[],small:[],span:[],sub:[],summary:[],sup:[],strong:[],strike:[],table:["width","border","align","valign"],tbody:["align","valign"],td:["width","rowspan","colspan","align","valign"],tfoot:["align","valign"],th:["width","rowspan","colspan","align","valign"],thead:["align","valign"],tr:["rowspan","align","valign"],tt:[],u:[],ul:[],video:["autoplay","controls","crossorigin","loop","muted","playsinline","poster","preload","src","height","width"]}}var P=new S;function A(e){return e.replace(E,"&lt;").replace(R,"&gt;")}var E=/</g,R=/>/g,I=/"/g,D=/&quot;/g,F=/&#([a-zA-Z0-9]*);?/gim,L=/&colon;?/gim,z=/&newline;?/gim,V=/((j\s*a\s*v\s*a|v\s*b|l\s*i\s*v\s*e)\s*s\s*c\s*r\s*i\s*p\s*t\s*|m\s*o\s*c\s*h\s*a)\:/gi,N=/e\s*x\s*p\s*r\s*e\s*s\s*s\s*i\s*o\s*n\s*\(.*/gi,U=/u\s*r\s*l\s*\(.*/gi;function B(e){return e.replace(I,"&quot;")}function G(e){return e.replace(D,'"')}function q(e){return e.replace(F,(function(e,t){return"x"===t[0]||"X"===t[0]?String.fromCharCode(parseInt(t.substr(1),16)):String.fromCharCode(parseInt(t,10))}))}function H(e){return e.replace(L,":").replace(z," ")}function W(e){for(var t="",r=0,n=e.length;r<n;r++)t+=e.charCodeAt(r)<32?" ":e.charAt(r);return C.trim(t)}function Q(e){return e=W(e=H(e=q(e=G(e))))}function Z(e){return e=A(e=B(e))}var X=/<!--[\s\S]*?-->/g;p.whiteList={a:["target","href","title"],abbr:["title"],address:[],area:["shape","coords","href","alt"],article:[],aside:[],audio:["autoplay","controls","crossorigin","loop","muted","preload","src"],b:[],bdi:["dir"],bdo:["dir"],big:[],blockquote:["cite"],br:[],caption:[],center:[],cite:[],code:[],col:["align","valign","span","width"],colgroup:["align","valign","span","width"],dd:[],del:["datetime"],details:["open"],div:[],dl:[],dt:[],em:[],figcaption:[],figure:[],font:["color","size","face"],footer:[],h1:[],h2:[],h3:[],h4:[],h5:[],h6:[],header:[],hr:[],i:[],img:["src","alt","title","width","height"],ins:["datetime"],li:[],mark:[],nav:[],ol:[],p:[],pre:[],s:[],section:[],small:[],span:[],sub:[],summary:[],sup:[],strong:[],strike:[],table:["width","border","align","valign"],tbody:["align","valign"],td:["width","rowspan","colspan","align","valign"],tfoot:["align","valign"],th:["width","rowspan","colspan","align","valign"],thead:["align","valign"],tr:["rowspan","align","valign"],tt:[],u:[],ul:[],video:["autoplay","controls","crossorigin","loop","muted","playsinline","poster","preload","src","height","width"]},p.getDefaultWhiteList=M,p.onTag=function(e,t,r){},p.onIgnoreTag=function(e,t,r){},p.onTagAttr=function(e,t,r){},p.onIgnoreTagAttr=function(e,t,r){},p.safeAttrValue=function(e,t,r,n){if(r=Q(r),"href"===t||"src"===t){if("#"===(r=C.trim(r)))return"#";if("http://"!==r.substr(0,7)&&"https://"!==r.substr(0,8)&&"mailto:"!==r.substr(0,7)&&"tel:"!==r.substr(0,4)&&"data:image/"!==r.substr(0,11)&&"ftp://"!==r.substr(0,6)&&"./"!==r.substr(0,2)&&"../"!==r.substr(0,3)&&"#"!==r[0]&&"/"!==r[0])return""}else if("background"===t){if(V.lastIndex=0,V.test(r))return""}else if("style"===t){if(N.lastIndex=0,N.test(r))return"";if(U.lastIndex=0,U.test(r)&&(V.lastIndex=0,V.test(r)))return"";!1!==n&&(r=(n=n||P).process(r))}return r=Z(r)},p.escapeHtml=A,p.escapeQuote=B,p.unescapeQuote=G,p.escapeHtmlEntities=q,p.escapeDangerHtml5Entities=H,p.clearNonPrintableCharacter=W,p.friendlyAttrValue=Q,p.escapeAttrValue=Z,p.onIgnoreTagStripAll=function(){return""},p.StripTagBody=function(e,t){"function"!==typeof t&&(t=function(){});var r=!Array.isArray(e),n=[],i=!1;return{onIgnoreTag:function(a,o,s){if(function(t){return!!r||-1!==C.indexOf(e,t)}(a)){if(s.isClosing){var c="[/removed]",l=s.position+c.length;return n.push([!1!==i?i:s.position,l]),i=!1,c}return i||(i=s.position),"[removed]"}return t(a,o,s)},remove:function(e){var t="",r=0;return C.forEach(n,(function(n){t+=e.slice(r,n[0]),r=n[1]})),t+=e.slice(r)}}},p.stripCommentTag=function(e){return e.replace(X,"")},p.stripBlankChar=function(e){var t=e.split("");return(t=t.filter((function(e){var t=e.charCodeAt(0);return 127!==t&&(!(t<=31)||(10===t||13===t))}))).join("")},p.cssFilter=P,p.getDefaultCSSWhiteList=T;var Y={},$=k;function J(e){var t=$.spaceIndex(e);if(-1===t)var r=e.slice(1,-1);else r=e.slice(1,t+1);return"/"===(r=$.trim(r).toLowerCase()).slice(0,1)&&(r=r.slice(1)),"/"===r.slice(-1)&&(r=r.slice(0,-1)),r}function K(e){return"</"===e.slice(0,2)}var ee=/[^a-zA-Z0-9_:\.\-]/gim;function te(e,t){for(;t<e.length;t++){var r=e[t];if(" "!==r)return"="===r?t:-1}}function re(e,t){for(;t>0;t--){var r=e[t];if(" "!==r)return"="===r?t:-1}}function ne(e){return function(e){return'"'===e[0]&&'"'===e[e.length-1]||"'"===e[0]&&"'"===e[e.length-1]}(e)?e.substr(1,e.length-2):e}Y.parseTag=function(e,t,r){var n="",i=0,a=!1,o=!1,s=0,c=e.length,l="",u="";e:for(s=0;s<c;s++){var d=e.charAt(s);if(!1===a){if("<"===d){a=s;continue}}else if(!1===o){if("<"===d){n+=r(e.slice(i,s)),a=s,i=s;continue}if(">"===d){n+=r(e.slice(i,a)),l=J(u=e.slice(a,s+1)),n+=t(a,n.length,l,u,K(u)),i=s+1,a=!1;continue}if('"'===d||"'"===d)for(var h=1,f=e.charAt(s-h);""===f.trim()||"="===f;){if("="===f){o=d;continue e}f=e.charAt(s-++h)}}else if(d===o){o=!1;continue}}return i<e.length&&(n+=r(e.substr(i))),n},Y.parseAttr=function(e,t){var r=0,n=[],i=!1,a=e.length;function o(e,r){if(!((e=(e=$.trim(e)).replace(ee,"").toLowerCase()).length<1)){var i=t(e,r||"");i&&n.push(i)}}for(var s=0;s<a;s++){var c,l=e.charAt(s);if(!1!==i||"="!==l)if(!1===i||s!==r||'"'!==l&&"'"!==l||"="!==e.charAt(s-1))if(/\s|\n|\t/.test(l)){if(e=e.replace(/\s|\n|\t/g," "),!1===i){if(-1===(c=te(e,s))){o($.trim(e.slice(r,s))),i=!1,r=s+1;continue}s=c-1;continue}if(-1===(c=re(e,s-1))){o(i,ne($.trim(e.slice(r,s)))),i=!1,r=s+1;continue}}else;else{if(-1===(c=e.indexOf(l,s+1)))break;o(i,$.trim(e.slice(r+1,c))),i=!1,r=(s=c)+1}else i=e.slice(r,s),r=s+1}return r<e.length&&(!1===i?o(e.slice(r)):o(i,ne($.trim(e.slice(r))))),$.trim(n.join(" "))};var ie=b.exports.FilterCSS,ae=p,oe=Y,se=oe.parseTag,ce=oe.parseAttr,le=k;function ue(e){return void 0===e||null===e}function de(e){(e=function(e){var t={};for(var r in e)t[r]=e[r];return t}(e||{})).stripIgnoreTag&&(e.onIgnoreTag&&console.error('Notes: cannot use these two options "stripIgnoreTag" and "onIgnoreTag" at the same time'),e.onIgnoreTag=ae.onIgnoreTagStripAll),e.whiteList=e.whiteList||ae.whiteList,e.onTag=e.onTag||ae.onTag,e.onTagAttr=e.onTagAttr||ae.onTagAttr,e.onIgnoreTag=e.onIgnoreTag||ae.onIgnoreTag,e.onIgnoreTagAttr=e.onIgnoreTagAttr||ae.onIgnoreTagAttr,e.safeAttrValue=e.safeAttrValue||ae.safeAttrValue,e.escapeHtml=e.escapeHtml||ae.escapeHtml,this.options=e,!1===e.css?this.cssFilter=!1:(e.css=e.css||{},this.cssFilter=new ie(e.css))}de.prototype.process=function(e){if(!(e=(e=e||"").toString()))return"";var t=this.options,r=t.whiteList,n=t.onTag,i=t.onIgnoreTag,a=t.onTagAttr,o=t.onIgnoreTagAttr,s=t.safeAttrValue,c=t.escapeHtml,l=this.cssFilter;t.stripBlankChar&&(e=ae.stripBlankChar(e)),t.allowCommentTag||(e=ae.stripCommentTag(e));var u=!1;if(t.stripIgnoreTagBody){u=ae.StripTagBody(t.stripIgnoreTagBody,i);i=u.onIgnoreTag}var d=se(e,(function(e,t,u,d,h){var f,p={sourcePosition:e,position:t,isClosing:h,isWhite:r.hasOwnProperty(u)};if(!ue(f=n(u,d,p)))return f;if(p.isWhite){if(p.isClosing)return"</"+u+">";var b=function(e){var t=le.spaceIndex(e);if(-1===t)return{html:"",closing:"/"===e[e.length-2]};var r="/"===(e=le.trim(e.slice(t+1,-1)))[e.length-1];return r&&(e=le.trim(e.slice(0,-1))),{html:e,closing:r}}(d),v=r[u],m=ce(b.html,(function(e,t){var r,n=-1!==le.indexOf(v,e);return ue(r=a(u,e,t,n))?n?(t=s(u,e,t,l))?e+'="'+t+'"':e:ue(r=o(u,e,t,n))?void 0:r:r}));d="<"+u;return m&&(d+=" "+m),b.closing&&(d+=" /"),d+=">"}return ue(f=i(u,d,p))?c(d):f}),c);return u&&(d=u.remove(d)),d};var he=de;!function(e,t){var r=p,n=Y,i=he;function a(e,t){return new i(t).process(e)}for(var o in(t=e.exports=a).filterXSS=a,t.FilterXSS=i,r)t[o]=r[o];for(var o in n)t[o]=n[o];"undefined"!==typeof self&&"undefined"!==typeof DedicatedWorkerGlobalScope&&self instanceof DedicatedWorkerGlobalScope&&(self.filterXSS=e.exports)}(f,f.exports);var fe,pe,be=function(){function e(e,t){var r,n=this;this.arcgisWhiteList={a:["href","target","style"],abbr:["title"],img:["src","width","height","border","alt","style"],video:["autoplay","controls","height","loop","muted","poster","preload","width"],audio:["autoplay","controls","loop","muted","preload"],source:["media","src","type"],span:["style"],table:["width","height","cellpadding","cellspacing","border","style"],div:["style","align"],font:["size","color","style"],tr:["height","valign","align","style"],td:["height","width","valign","align","colspan","rowspan","nowrap","style"],th:["height","width","valign","align","colspan","rowspan","nowrap","style"],p:["style"],b:[],strong:[],i:[],em:[],u:[],br:[],li:[],ul:[],ol:[],hr:[],tbody:[]},this.allowedProtocols=["http","https","mailto","iform","tel","flow","lfmobile","arcgis-navigator","arcgis-appstudio-player","arcgis-survey123","arcgis-collector","arcgis-workforce","arcgis-explorer","arcgis-trek2there","mspbi","comgooglemaps","pdfefile","pdfehttp","pdfehttps","boxapp","boxemm","awb","awbs","gropen","radarscope"],this.arcgisFilterOptions={allowCommentTag:!0,safeAttrValue:function(e,t,r,i){return"a"===e&&"href"===t||("img"===e||"source"===e)&&"src"===t?n.sanitizeUrl(r):f.exports.safeAttrValue(e,t,r,i)}},e&&!t?r=e:e&&t?(r=Object.create(this.arcgisFilterOptions),Object.keys(e).forEach((function(t){"whiteList"===t?r.whiteList=n._extendObjectOfArrays([n.arcgisWhiteList,e.whiteList||{}]):r[t]=e[t]}))):(r=Object.create(this.arcgisFilterOptions)).whiteList=this.arcgisWhiteList,this.xssFilterOptions=r,this._xssFilter=new f.exports.FilterXSS(r)}return e.prototype.sanitize=function(e,t){switch(void 0===t&&(t={}),typeof e){case"number":return isNaN(e)||!isFinite(e)?null:e;case"boolean":return e;case"string":return this._xssFilter.process(e);case"object":return this._iterateOverObject(e,t);default:if(t.allowUndefined&&"undefined"===typeof e)return;return null}},e.prototype.sanitizeUrl=function(e){var t=this._trim(e.substring(0,e.indexOf(":")));return"/"===e||"#"===e||"#"===e[0]||this.allowedProtocols.indexOf(t.toLowerCase())>-1?f.exports.escapeAttrValue(e):""},e.prototype.sanitizeHTMLAttribute=function(e,t,r,n){return"function"===typeof this.xssFilterOptions.safeAttrValue?this.xssFilterOptions.safeAttrValue(e,t,r,n):f.exports.safeAttrValue(e,t,r,n)},e.prototype.validate=function(e,t){void 0===t&&(t={});var r=this.sanitize(e,t);return{isValid:e===r,sanitized:r}},e.prototype._extendObjectOfArrays=function(e){var t={};return e.forEach((function(e){Object.keys(e).forEach((function(r){Array.isArray(e[r])&&Array.isArray(t[r])?t[r]=t[r].concat(e[r]):t[r]=e[r]}))})),t},e.prototype._iterateOverObject=function(e,t){var r=this;void 0===t&&(t={});try{var n=!1,i=void 0;if(Array.isArray(e))i=e.reduce((function(e,i){var a=r.validate(i,t);return a.isValid?e.concat([i]):(n=!0,e.concat([a.sanitized]))}),[]);else{if(!h(e)){if(t.allowUndefined&&"undefined"===typeof e)return;return null}i=Object.keys(e).reduce((function(i,a){var o=e[a],s=r.validate(o,t);return s.isValid?i[a]=o:(n=!0,i[a]=s.sanitized),i}),{})}return n?i:e}catch(a){return null}},e.prototype._trim=function(e){return String.prototype.trim?e.trim():e.replace(/(^\s*)|(\s*$)/g,"")},e}(),ve=r(184),me=(r(17),r(15)),ye=function(e){fe||function(e){if("WebkitTransition"in e.style)fe="webkitTransitionEnd",pe="webkitAnimationEnd";else{if(!("transition"in e.style))throw new Error("Your browser is not supported!");fe="transitionend",pe="animationend"}}(e)},ge=function(e,t){return void 0===t&&(t=e+"-active"),function(r){ye(r);var n=!1,i=function i(a){n||(n=!0,r.removeEventListener(fe,i),r.removeEventListener(pe,i),r.classList.remove(e),r.classList.remove(t))};r.classList.add(e),r.addEventListener(fe,i),r.addEventListener(pe,i),requestAnimationFrame((function(){r.classList.add(t)}))}},Oe=function(e,t){return void 0===t&&(t=e+"-active"),function(r,n){ye(r);var i=!1,a=function e(t){i||(i=!0,r.removeEventListener(fe,e),r.removeEventListener(pe,e),n())};r.classList.add(e),r.addEventListener(fe,a),r.addEventListener(pe,a),requestAnimationFrame((function(){r.classList.add(t)}))}};function je(e){for(var t=ve.a.acquire(),r=0;r<arguments.length;r++){var n=arguments[r],i=typeof n;if("string"===i)t.push(n);else if(Array.isArray(n))t.push.apply(t,n);else if("object"===i)for(var a in n)n[a]&&t.push(a)}var o=t.join(" ");return ve.a.release(t),o}function _e(){return"rtl"===document.dir}function we(e){this[e.getAttribute("data-node-ref")]=null}function xe(e){this[e.getAttribute("data-node-ref")]=e}function ke(e,t){return("enter"===e?ge:Oe)(t)}me.a.getLogger("esri.widgets.support.widgetUtils");var Se=["dd","dl","dt","h1","h2","h3","h4","h5","h6","sub","sup"].concat(["animate","animatetransform","circle","clippath","defs","ellipse","g","image","line","lineargradient","marker","mask","path","pattern","polygon","polyline","radialgradient","rect","stop","svg","switch","symbol","text","textpath","tspan","use"]).reduce((function(e,t){return e[t]=[],e}),{}),Te=["align","alink","alt","bgcolor","border","cellpadding","cellspacing","class","color","cols","colspan","coords","dir","face","height","hspace","ismap","lang","marginheight","marginwidth","multiple","nohref","noresize","noshade","nowrap","ref","rel","rev","rows","rowspan","scrolling","shape","span","summary","tabindex","title","usemap","valign","value","vlink","vspace","width"],Ce=new be({whiteList:Se,onTagAttr:function(e,t,r){var n="".concat(t,'="').concat(r,'"');if(Te.includes(t))return n},stripIgnoreTag:!0,stripIgnoreTagBody:["script","style"]},!0);function Me(e){return"Enter"===e||" "===e}function Pe(){return getComputedStyle(document.body).getPropertyValue("--esri-calcite-theme-name").replace(/\s|'|"/g,"")}function Ae(){return Pe().startsWith("dark")}function Ee(){return"calcite-theme-"+(Ae()?"dark":"light")}},function(e,t,r){"use strict";var n=r(2),i=r(6),a=r(7),o=r(0),s=r(30),c=r(1),l=(r(17),r(18),r(15),r(10)),u=function(e){Object(i.a)(r,e);var t=Object(a.a)(r);function r(){var e;return Object(n.a)(this,r),(e=t.apply(this,arguments)).SCENEVIEW_HITTEST_RETURN_INTERSECTOR=!1,e.SCENEVIEW_LOCKING_LOG=!1,e.HIGHLIGHTS_GRID_OPTIMIZATION_ENABLED=!0,e.HIGHLIGHTS_PROFILE_TO_CONSOLE=!1,e.DECONFLICTOR_SHOW_VISIBLE=!1,e.DECONFLICTOR_SHOW_INVISIBLE=!1,e.DECONFLICTOR_SHOW_GRID=!1,e.LABELS_SHOW_BORDER=!1,e.OVERLAY_DRAW_DEBUG_TEXTURE=!1,e.OVERLAY_SHOW_CENTER=!1,e.SHOW_POI=!1,e.TESTS_DISABLE_UPDATE_THRESHOLDS=!1,e.DISABLE_DECONFLICTOR_VISIBILITY_OFFSET=!1,e.DISABLE_ELEVATION_ALIGNERS_ITERATIVE_UPDATES=!1,e.DRAW_MESH_GEOMETRY_NORMALS=!1,e.FEATURE_TILE_FETCH_SHOW_TILES=!1,e.FEATURE_TILE_TREE_SHOW_TILES=!1,e.TERRAIN_TILE_TREE_SHOW_TILES=!1,e.I3S_TREE_SHOW_TILES=!1,e.I3S_SHOW_MODIFICATIONS=!1,e.ENABLE_PROFILE_DEPTH_RANGE=!1,e.DISABLE_FAST_UPDATES=!1,e.LOD_INSTANCE_RENDERER_DISABLE_UPDATES=!1,e.LOD_INSTANCE_RENDERER_COLORIZE_BY_LEVEL=!1,e.EDGES_SHOW_HIDDEN_TRANSPARENT_EDGES=!1,e}return r}(s.a);Object(o.a)([Object(c.b)()],u.prototype,"SCENEVIEW_HITTEST_RETURN_INTERSECTOR",void 0),Object(o.a)([Object(c.b)()],u.prototype,"SCENEVIEW_LOCKING_LOG",void 0),Object(o.a)([Object(c.b)()],u.prototype,"HIGHLIGHTS_GRID_OPTIMIZATION_ENABLED",void 0),Object(o.a)([Object(c.b)()],u.prototype,"HIGHLIGHTS_PROFILE_TO_CONSOLE",void 0),Object(o.a)([Object(c.b)()],u.prototype,"DECONFLICTOR_SHOW_VISIBLE",void 0),Object(o.a)([Object(c.b)()],u.prototype,"DECONFLICTOR_SHOW_INVISIBLE",void 0),Object(o.a)([Object(c.b)()],u.prototype,"DECONFLICTOR_SHOW_GRID",void 0),Object(o.a)([Object(c.b)()],u.prototype,"LABELS_SHOW_BORDER",void 0),Object(o.a)([Object(c.b)()],u.prototype,"OVERLAY_DRAW_DEBUG_TEXTURE",void 0),Object(o.a)([Object(c.b)()],u.prototype,"OVERLAY_SHOW_CENTER",void 0),Object(o.a)([Object(c.b)()],u.prototype,"SHOW_POI",void 0),Object(o.a)([Object(c.b)()],u.prototype,"TESTS_DISABLE_UPDATE_THRESHOLDS",void 0),Object(o.a)([Object(c.b)()],u.prototype,"DISABLE_DECONFLICTOR_VISIBILITY_OFFSET",void 0),Object(o.a)([Object(c.b)()],u.prototype,"DISABLE_ELEVATION_ALIGNERS_ITERATIVE_UPDATES",void 0),Object(o.a)([Object(c.b)()],u.prototype,"DRAW_MESH_GEOMETRY_NORMALS",void 0),Object(o.a)([Object(c.b)()],u.prototype,"FEATURE_TILE_FETCH_SHOW_TILES",void 0),Object(o.a)([Object(c.b)()],u.prototype,"FEATURE_TILE_TREE_SHOW_TILES",void 0),Object(o.a)([Object(c.b)()],u.prototype,"TERRAIN_TILE_TREE_SHOW_TILES",void 0),Object(o.a)([Object(c.b)()],u.prototype,"I3S_TREE_SHOW_TILES",void 0),Object(o.a)([Object(c.b)()],u.prototype,"I3S_SHOW_MODIFICATIONS",void 0),Object(o.a)([Object(c.b)()],u.prototype,"ENABLE_PROFILE_DEPTH_RANGE",void 0),Object(o.a)([Object(c.b)()],u.prototype,"DISABLE_FAST_UPDATES",void 0),Object(o.a)([Object(c.b)()],u.prototype,"LOD_INSTANCE_RENDERER_DISABLE_UPDATES",void 0),Object(o.a)([Object(c.b)()],u.prototype,"LOD_INSTANCE_RENDERER_COLORIZE_BY_LEVEL",void 0),Object(o.a)([Object(c.b)()],u.prototype,"EDGES_SHOW_HIDDEN_TRANSPARENT_EDGES",void 0);var d=new(u=Object(o.a)([Object(l.a)("esri.views.3d.support.DebugFlags")],u));t.a=d},function(e,t,r){"use strict";r.d(t,"a",(function(){return m})),r.d(t,"b",(function(){return b})),r.d(t,"c",(function(){return h})),r.d(t,"d",(function(){return _})),r.d(t,"e",(function(){return x})),r.d(t,"f",(function(){return w})),r.d(t,"g",(function(){return u})),r.d(t,"h",(function(){return v})),r.d(t,"i",(function(){return c})),r.d(t,"j",(function(){return y})),r.d(t,"k",(function(){return l})),r.d(t,"l",(function(){return f})),r.d(t,"m",(function(){return p})),r.d(t,"n",(function(){return d}));var n=r(2),i=r(5),a=r(20),o=r(4),s=r(9);function c(e){var t=e[0]*e[0]+e[4]*e[4]+e[8]*e[8],r=e[1]*e[1]+e[5]*e[5]+e[9]*e[9],n=e[2]*e[2]+e[6]*e[6]+e[10]*e[10];return Math.sqrt(Math.max(t,r,n))}function l(e,t){var r=Math.sqrt(t[0]*t[0]+t[4]*t[4]+t[8]*t[8]),n=Math.sqrt(t[1]*t[1]+t[5]*t[5]+t[9]*t[9]),i=Math.sqrt(t[2]*t[2]+t[6]*t[6]+t[10]*t[10]);return Object(o.y)(e,r,n,i),e}function u(e,t,r){r=r||e;var n=Object(o.j)(e,t);Object(o.y)(r,e[0]-n*t[0],e[1]-n*t[1],e[2]-n*t[2]),Object(o.t)(r,r)}function d(e,t,r){Math.abs(e[0])>Math.abs(e[1])?Object(o.y)(t,0,1,0):Object(o.y)(t,1,0,0),Object(o.i)(r,e,t),Object(o.t)(t,t),Object(o.i)(t,r,e),Object(o.t)(r,r)}function h(e,t,r,n,i,a){var o=e+(t-e)*i;return o+(r+(n-r)*i-o)*a}function f(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Object(s.e)(),i=Object(o.r)(e),a=Object(o.r)(t),c=Object(o.j)(e,t)/(i*a);if(c<.9999999999999999){var l=Math.acos(c),u=((1-r)*i+r*a)/Math.sin(l),d=u/i*Math.sin((1-r)*l),h=u/a*Math.sin(r*l);return Object(o.g)(S,e,d),Object(o.g)(T,t,h),Object(o.h)(n,S,T)}return Object(o.k)(n,e,t,r)}function p(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Object(s.e)(),i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Object(s.e)(),a=Object(o.r)(e),c=Object(o.r)(t),l=Object(o.j)(e,t)/(a*c);if(l<.9999999999999999){var u=Math.acos(l),d=Math.sin(u),h=Math.sin(r*u),f=Math.sin((1-r)*u),p=(1-r)*a+r*c,b=p/d,v=b/c*h;Object(o.g)(S,e,b/a*f),Object(o.g)(T,t,v),Object(o.h)(n,S,T);var m=1/a*(-Math.cos((1-r)*u)*u*p+f*(-a+c));Object(o.g)(S,e,m);var y=1/c*(Math.cos(r*u)*u*p+h*(-a+c));return Object(o.g)(T,t,y),Object(o.h)(i,S,T),Object(o.g)(i,i,1/d),i}return Object(o.k)(n,e,t,r),Object(o.l)(i,t,e),Object(o.t)(i,i),i}function b(e,t,r){e=Object(o.t)(S,e),t=Object(o.t)(T,t);var n=Object(a.b)(Object(o.j)(e,t));if(r){var i=Object(o.i)(k,e,t);if(Object(o.j)(i,r)<0)return-n}return n}function v(e){var t=e.length;return function(r){if(r<=e[0][0])return e[0][1];if(r>=e[t-1][0])return e[t-1][1];for(var n=1;r>e[n][0];)n++;var i=e[n-1][0],a=e[n][0],o=(a-r)/(a-i);return o*e[n-1][1]+(1-o)*e[n][1]}}var m=function(){function e(t,r){Object(n.a)(this,e),this.min=t,this.max=r,this.range=r-t}return Object(i.a)(e,[{key:"ndiff",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return Math.ceil((e-t)/this.range)*this.range+t}},{key:"_normalize",value:function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];return(r-=n)<e?r+=this.ndiff(e-r):r>t&&(r-=this.ndiff(r-t)),i&&r===t&&(r=e),r+n}},{key:"normalize",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return this._normalize(this.min,this.max,e,t,r)}},{key:"clamp",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return Object(a.e)(e-t,this.min,this.max)+t}},{key:"monotonic",value:function(e,t,r){return e<t?t:t+this.ndiff(e-t,r)}},{key:"minimalMonotonic",value:function(e,t,r){return this._normalize(e,e+this.range,t,r)}},{key:"center",value:function(e,t,r){return t=this.monotonic(e,t,r),this.normalize((e+t)/2,r)}},{key:"diff",value:function(e,t,r){return this.monotonic(e,t,r)-e}},{key:"shortestSignedDiff",value:function(e,t){e=this.normalize(e);var r=(t=this.normalize(t))-e,n=t<e?this.minimalMonotonic(e,t)-e:t-this.minimalMonotonic(t,e);return Math.abs(r)<Math.abs(n)?r:n}},{key:"contains",value:function(e,t,r){return t=this.minimalMonotonic(e,t),(r=this.minimalMonotonic(e,r))>e&&r<t}}]),e}();function y(e,t,r,n){Object(o.l)(g,t,e),Object(o.l)(O,r,e),Object(o.i)(n,g,O),Object(o.t)(n,n),n[3]=-Object(o.j)(e,n)}var g=Object(s.e)(),O=Object(s.e)();function j(e){for(var t in e){var r=e[t];r instanceof Function&&(e[t]=r.bind(e))}return e}var _=j(new m(0,2*Math.PI)),w=j(new m(-Math.PI,Math.PI)),x=j(new m(0,360)),k=Object(s.e)(),S=Object(s.e)(),T=Object(s.e)()},function(e,t,r){"use strict";var n=r(2),i=r(5),a=r(15),o=r(20),s=r(3),c=r(28),l=r(26),u=r(31),d=r(29),h=r(38),f=r(4),p=r(9),b=r(54),v=r(43),m=r(118),y=r(79),g=r(210),O=r(46),j=a.a.getLogger("esri.views.3d.webgl-engine.lib.Camera"),_=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;Object(n.a)(this,e),this._viewUp=Object(p.e)(),this._viewForward=Object(p.e)(),this._viewRight=Object(p.e)(),this._ray=Object(y.c)(),this._viewport=Object(v.g)(0,0,1,1),this._padding=Object(v.g)(0,0,0,0),this._fov=55/180*Math.PI,this._nearFar=Object(h.f)(1,1e3),this._viewDirty=!0,this._viewMatrix=Object(u.d)(),this._projectionDirty=!0,this._projectionMatrix=Object(u.d)(),this._viewProjectionDirty=!0,this._viewProjectionMatrix=Object(u.d)(),this._viewInverseTransposeMatrixDirty=!0,this._viewInverseTransposeMatrix=Object(u.d)(),this._frustumDirty=!0,this._frustum=Object(m.c)(),this._fullViewport=Object(v.e)(),this.pixelRatio=1,this.relativeElevation=0,Object(s.j)(t)&&Object(f.m)(this._ray.origin,t),this._center=Object(s.j)(r)?Object(p.c)(r):Object(p.e)(),this._up=Object(s.j)(i)?Object(p.c)(i):Object(p.g)(0,0,1)}return Object(i.a)(e,[{key:"eye",get:function(){return this._ray.origin},set:function(e){this._compareAndSetView(e,this._ray.origin)}},{key:"center",get:function(){return this._center},set:function(e){this._compareAndSetView(e,this._center)}},{key:"ray",get:function(){return Object(f.l)(this._ray.direction,this.center,this.eye),this._ray}},{key:"up",get:function(){return this._up},set:function(e){this._compareAndSetView(e,this._up)}},{key:"viewMatrix",get:function(){return this._ensureViewClean(),this._viewMatrix},set:function(e){Object(l.d)(this._viewMatrix,e),this._viewDirty=!1,this._viewInverseTransposeMatrixDirty=!0,this._viewProjectionDirty=!0,this._frustumDirty=!0}},{key:"viewForward",get:function(){return this._ensureViewClean(),this._viewForward}},{key:"viewUp",get:function(){return this._ensureViewClean(),this._viewUp}},{key:"viewRight",get:function(){return this._ensureViewClean(),this._viewRight}},{key:"nearFar",get:function(){return this._nearFar}},{key:"near",get:function(){return this._nearFar[0]},set:function(e){this._nearFar[0]!==e&&(this._nearFar[0]=e,this._projectionDirty=!0,this._viewProjectionDirty=!0,this._frustumDirty=!0)}},{key:"far",get:function(){return this._nearFar[1]},set:function(e){this._nearFar[1]!==e&&(this._nearFar[1]=e,this._projectionDirty=!0,this._viewProjectionDirty=!0,this._frustumDirty=!0)}},{key:"viewport",get:function(){return this._viewport},set:function(e){this.x=e[0],this.y=e[1],this.width=e[2],this.height=e[3]}},{key:"x",get:function(){return this._viewport[0]},set:function(e){e+=this._padding[3],this._viewport[0]!==e&&(this._viewport[0]=e,this._projectionDirty=!0,this._viewProjectionDirty=!0,this._frustumDirty=!0)}},{key:"y",get:function(){return this._viewport[1]},set:function(e){e+=this._padding[2],this._viewport[1]!==e&&(this._viewport[1]=e,this._projectionDirty=!0,this._viewProjectionDirty=!0,this._frustumDirty=!0)}},{key:"width",get:function(){return this._viewport[2]},set:function(e){this._viewport[2]!==e&&(this._viewport[2]=e,this._projectionDirty=!0,this._viewProjectionDirty=!0,this._frustumDirty=!0)}},{key:"height",get:function(){return this._viewport[3]},set:function(e){this._viewport[3]!==e&&(this._viewport[3]=e,this._projectionDirty=!0,this._viewProjectionDirty=!0,this._frustumDirty=!0)}},{key:"fullWidth",get:function(){return this._viewport[2]+this._padding[1]+this._padding[3]},set:function(e){this.width=e-(this._padding[1]+this._padding[3])}},{key:"fullHeight",get:function(){return this._viewport[3]+this._padding[0]+this._padding[2]},set:function(e){this.height=e-(this._padding[0]+this._padding[2])}},{key:"fullViewport",get:function(){return this._fullViewport[0]=this._viewport[0]-this._padding[3],this._fullViewport[1]=this._viewport[1]-this._padding[2],this._fullViewport[2]=this.fullWidth,this._fullViewport[3]=this.fullHeight,this._fullViewport}},{key:"aspect",get:function(){return this.width/this.height}},{key:"padding",get:function(){return this._padding},set:function(e){this._padding[0]===e[0]&&this._padding[1]===e[1]&&this._padding[2]===e[2]&&this._padding[3]===e[3]||(this._viewport[0]+=e[3]-this._padding[3],this._viewport[1]+=e[2]-this._padding[2],this._viewport[2]-=e[1]+e[3]-(this._padding[1]+this._padding[3]),this._viewport[3]-=e[0]+e[2]-(this._padding[0]+this._padding[2]),Object(b.c)(this._padding,e),this._projectionDirty=!0,this._viewProjectionDirty=!0,this._frustumDirty=!0)}},{key:"viewProjectionMatrix",get:function(){return this._viewProjectionDirty&&(Object(l.m)(this._viewProjectionMatrix,this.projectionMatrix,this.viewMatrix),this._viewProjectionDirty=!1),this._viewProjectionMatrix}},{key:"projectionMatrix",get:function(){if(this._projectionDirty){var e=this.width,t=this.height,r=this.near*Math.tan(this.fovY/2),n=r*this.aspect;Object(l.k)(this._projectionMatrix,-n*(1+2*this._padding[3]/e),n*(1+2*this._padding[1]/e),-r*(1+2*this._padding[2]/t),r*(1+2*this._padding[0]/t),this.near,this.far),this._projectionDirty=!1}return this._projectionMatrix},set:function(e){Object(l.d)(this._projectionMatrix,e),this._projectionDirty=!1,this._viewProjectionDirty=!0,this._frustumDirty=!0}},{key:"fov",get:function(){return this._fov},set:function(e){this._fov=e,this._projectionDirty=!0,this._viewProjectionDirty=!0,this._frustumDirty=!0}},{key:"fovX",get:function(){return Object(O.b)(this._fov,this.width,this.height)},set:function(e){this._fov=Object(O.d)(e,this.width,this.height),this._projectionDirty=!0,this._viewProjectionDirty=!0,this._frustumDirty=!0}},{key:"fovY",get:function(){return Object(O.c)(this._fov,this.width,this.height)},set:function(e){this._fov=Object(O.e)(e,this.width,this.height),this._projectionDirty=!0,this._viewProjectionDirty=!0,this._frustumDirty=!0}},{key:"distance",get:function(){return Object(f.o)(this._center,this.eye)}},{key:"frustum",get:function(){return this._recomputeFrustum(),this._frustum}},{key:"viewInverseTransposeMatrix",get:function(){return(this._viewInverseTransposeMatrixDirty||this._viewDirty)&&(Object(l.a)(this._viewInverseTransposeMatrix,this.viewMatrix),Object(l.e)(this._viewInverseTransposeMatrix,this._viewInverseTransposeMatrix),this._viewInverseTransposeMatrixDirty=!1),this._viewInverseTransposeMatrix}},{key:"depthNDCToWorld",value:function(e){var t=2*e-1;return 2*this.near*this.far/(this.far+this.near-t*(this.far-this.near))}},{key:"perRenderPixelRatio",get:function(){return Math.tan(this.fovX/2)/(this.width/2)}},{key:"perScreenPixelRatio",get:function(){return this.perRenderPixelRatio*this.pixelRatio}},{key:"aboveGround",get:function(){return this.relativeElevation&&this.relativeElevation>=0}},{key:"copyFrom",value:function(e){Object(f.m)(this._ray.origin,e.eye),Object(f.m)(this._center,e.center),Object(f.m)(this._up,e.up),Object(b.c)(this._viewport,e.viewport),Object(b.c)(this._padding,e.padding),Object(d.c)(this._nearFar,e.nearFar),this._fov=e.fov,this.relativeElevation=e.relativeElevation;var t=e;return this._viewDirty=t._viewDirty,this._viewDirty||(Object(l.d)(this._viewMatrix,e.viewMatrix),Object(f.m)(this._viewRight,e.viewRight),Object(f.m)(this._viewUp,e.viewUp),Object(f.m)(this._viewForward,e.viewForward)),t._projectionDirty?this._projectionDirty=!0:(Object(l.d)(this._projectionMatrix,e.projectionMatrix),this._projectionDirty=!1),this._viewProjectionDirty=!0,this._frustumDirty=t._frustumDirty,this._frustumDirty||(Object(m.b)(e.frustum,this._frustum),this._frustumDirty=!1),t._viewInverseTransposeMatrixDirty?this._viewInverseTransposeMatrixDirty=!0:(Object(l.d)(this._viewInverseTransposeMatrix,e.viewInverseTransposeMatrix),this._viewInverseTransposeMatrixDirty=!1),Object(b.c)(this._fullViewport,e.fullViewport),this.pixelRatio=e.pixelRatio,this}},{key:"copyViewFrom",value:function(e){this.eye=e.eye,this.center=e.center,this.up=e.up}},{key:"clone",value:function(){return(new e).copyFrom(this)}},{key:"equals",value:function(e){return Object(f.q)(this.eye,e.eye)&&Object(f.q)(this._center,e.center)&&Object(f.q)(this._up,e.up)&&Object(b.g)(this._viewport,e.viewport)&&Object(b.g)(this._padding,e.padding)&&Object(d.k)(this._nearFar,e.nearFar)&&this._fov===e.fov&&this.pixelRatio===e.pixelRatio&&this.relativeElevation===e.relativeElevation}},{key:"almostEquals",value:function(e){if(this.pixelRatio!==e.pixelRatio||Math.abs(e.fov-this._fov)>=.001)return!1;var t=5e-4;Object(f.C)(k,e.eye,e.center),Object(f.C)(S,this.eye,this._center);var r=Object(f.j)(k,S),n=Object(f.D)(k),i=Object(f.D)(S);return r*r>=(1-1e-10)*n*i&&Object(f.E)(e.eye,this.eye)<Math.max(n,i)*t*t&&Object(b.i)(e.padding,this._padding)<.5&&Object(b.i)(e.viewport,this._viewport)<.5}},{key:"computeRenderPixelSizeAt",value:function(e){return this.computeRenderPixelSizeAtDist(this.viewDirectionDistance(e))}},{key:"computeRenderPixelSizeAtDist",value:function(e){return e*this.perRenderPixelRatio}},{key:"computeScreenPixelSizeAt",value:function(e){return this.computeScreenPixelSizeAtDist(this.viewDirectionDistance(e))}},{key:"viewDirectionDistance",value:function(e){return Math.abs(Object(g.c)(this.viewForward,Object(f.l)(k,e,this.eye)))}},{key:"computeScreenPixelSizeAtDist",value:function(e){return e*this.perScreenPixelRatio}},{key:"computeDistanceFromRadius",value:function(e,t){return e/Math.tan(Math.min(this.fovX,this.fovY)/(2*(t||1)))}},{key:"getScreenCenter",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Object(c.f)();return e[0]=(this.padding[3]+this.width/2)/this.pixelRatio,e[1]=(this.padding[0]+this.height/2)/this.pixelRatio,e}},{key:"getRenderCenter",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.5,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.5;return e||(e=Object(c.d)()),e[0]=this.padding[3]+this.width*t,e[1]=this.padding[2]+this.height*r,e.length>2&&(e[2]=.5),e}},{key:"setGLViewport",value:function(e){var t=this.viewport,r=this.padding;e.setViewport(t[0]-r[3],t[1]-r[2],t[2]+r[1]+r[3],t[3]+r[0]+r[2])}},{key:"applyProjection",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];e!==w&&Object(f.m)(w,e),w[3]=1,r&&(t[2]=-w[2]),Object(b.m)(w,w,this.projectionMatrix),Object(f.g)(w,w,1/Math.abs(w[3]));var n=this.fullViewport;return t[0]=Object(o.m)(0,n[0]+n[2],.5+.5*w[0]),t[1]=Object(o.m)(0,n[1]+n[3],.5+.5*w[1]),r||(t[2]=.5*(w[2]+1)),t}},{key:"projectToScreen",value:function(e,t){this.projectToRenderScreen(e,T),this.renderToScreen(T,t)}},{key:"projectToRenderScreen",value:function(e,t){if(w[0]=e[0],w[1]=e[1],w[2]=e[2],w[3]=1,Object(b.m)(w,w,this.viewProjectionMatrix),0===w[3])return null;Object(f.g)(w,w,1/Math.abs(w[3]));var r=this.fullViewport;return"x"in t?(t.x=Object(o.m)(0,r[0]+r[2],.5+.5*w[0]),t.y=Object(o.m)(0,r[1]+r[3],.5+.5*w[1])):(t[0]=Object(o.m)(0,r[0]+r[2],.5+.5*w[0]),t[1]=Object(o.m)(0,r[1]+r[3],.5+.5*w[1]),t.length>2&&(t[2]=.5*(w[2]+1))),t}},{key:"unprojectFromScreen",value:function(e,t){return this.unprojectFromRenderScreen(this.screenToRender(e,T),t)}},{key:"unprojectFromRenderScreen",value:function(e,t){if(Object(l.m)(x,this.projectionMatrix,this.viewMatrix),!Object(l.a)(x,x))return null;var r=this.fullViewport;return w[0]=2*(e[0]-r[0])/r[2]-1,w[1]=2*(e[1]-r[1])/r[3]-1,w[2]=2*e[2]-1,w[3]=1,Object(b.m)(w,w,x),0===w[3]?null:(t[0]=w[0]/w[3],t[1]=w[1]/w[3],t[2]=w[2]/w[3],t)}},{key:"constrainWindowSize",value:function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:r,i=e*this.pixelRatio,a=t*this.pixelRatio,o=Math.max(i-r/2,0),s=Math.max(this.fullHeight-a-n/2,0),c=-Math.min(i-r/2,0),l=-Math.min(this.fullHeight-a-n/2,0);return[o,s,r-c- -Math.min(this.fullWidth-i-r/2,0),n-l- -Math.min(a-n/2,0)]}},{key:"computeUp",value:function(e){1===e?this.computeUpGlobal():this.computeUpLocal()}},{key:"screenToRender",value:function(e,t){var r=e[0]*this.pixelRatio,n=this.fullHeight-e[1]*this.pixelRatio;return t[0]=r,t[1]=n,t}},{key:"renderToScreen",value:function(e,t){var r=e[0]/this.pixelRatio,n=(this.fullHeight-e[1])/this.pixelRatio;t[0]=r,t[1]=n}},{key:"computeUpGlobal",value:function(){Object(f.l)(k,this.center,this.eye);var e=Object(f.r)(this.center);e<1?(Object(f.y)(this._up,0,0,1),this._markViewDirty()):Math.abs(Object(f.j)(k,this.center))>.9999*Object(f.r)(k)*e||(Object(f.i)(this._up,k,this.center),Object(f.i)(this._up,this._up,k),Object(f.t)(this._up,this._up),this._markViewDirty())}},{key:"computeUpLocal",value:function(){Object(f.x)(k,this.eye,this.center),Math.abs(k[2])<=.9999&&(Object(f.g)(k,k,k[2]),Object(f.y)(this._up,-k[0],-k[1],1-k[2]),Object(f.t)(this._up,this._up),this._markViewDirty())}},{key:"_compareAndSetView",value:function(e,t){"number"==typeof e[0]&&isFinite(e[0])&&"number"==typeof e[1]&&isFinite(e[1])&&"number"==typeof e[2]&&isFinite(e[2])?Object(f.q)(e,t)||(Object(f.m)(t,e),this._markViewDirty()):j.warn("Camera vector contains invalid number, ignoring value")}},{key:"_markViewDirty",value:function(){this._viewDirty=!0,this._frustumDirty=!0,this._viewProjectionDirty=!0}},{key:"_recomputeFrustum",value:function(){this._frustumDirty&&(Object(m.e)(this.viewMatrix,this.projectionMatrix,this._frustum),this._frustumDirty=!1)}},{key:"_ensureViewClean",value:function(){this._viewDirty&&(Object(l.l)(this._viewMatrix,this.eye,this._center,this._up),Object(f.y)(this._viewForward,-this._viewMatrix[2],-this._viewMatrix[6],-this._viewMatrix[10]),Object(f.y)(this._viewUp,this._viewMatrix[1],this._viewMatrix[5],this._viewMatrix[9]),Object(f.y)(this._viewRight,this._viewMatrix[0],this._viewMatrix[4],this._viewMatrix[8]),this._viewDirty=!1,this._viewInverseTransposeMatrixDirty=!0)}}]),e}(),w=Object(v.e)(),x=Object(u.d)(),k=Object(p.e)(),S=Object(p.e)(),T=Object(c.d)();t.a=_},function(e,t,r){"use strict";r.d(t,"a",(function(){return l}));var n=r(6),i=r(7),a=r(2),o=r(5),s=r(15).a.getLogger("esri.views.3d.webgl-engine.core.shaderModules.shaderBuilder"),c=function(){function e(){Object(a.a)(this,e),this.includedModules=new Map}return Object(o.a)(e,[{key:"include",value:function(e,t){this.includedModules.has(e)?this.includedModules.get(e)!==t&&s.error("Trying to include shader module multiple times with different sets of options."):(this.includedModules.set(e,t),e(this.builder,t))}}]),e}(),l=function(e){Object(n.a)(r,e);var t=Object(i.a)(r);function r(){var e;return Object(a.a)(this,r),(e=t.apply(this,arguments)).vertex=new h,e.fragment=new h,e.attributes=new f,e.varyings=new p,e.extensions=new b,e.constants=new v,e}return Object(o.a)(r,[{key:"fragmentUniforms",get:function(){return this.fragment.uniforms}},{key:"builder",get:function(){return this}},{key:"generateSource",value:function(e){var t=this.extensions.generateSource(e),r=this.attributes.generateSource(e),n=this.varyings.generateSource(),i="vertex"===e?this.vertex:this.fragment,a=i.uniforms.generateSource(),o=i.code.generateSource(),s="vertex"===e?y:m,c=this.constants.generateSource().concat(i.constants.generateSource());return"\n".concat(t.join("\n"),"\n\n").concat(s,"\n\n").concat(c.join("\n"),"\n\n").concat(a.join("\n"),"\n\n").concat(r.join("\n"),"\n\n").concat(n.join("\n"),"\n\n").concat(o.join("\n"))}}]),r}(c),u=function(){function e(){Object(a.a)(this,e),this._entries=new Map}return Object(o.a)(e,[{key:"add",value:function(e,t,r){var n="".concat(e,"_").concat(t,"_").concat(r);return this._entries.set(n,{name:e,type:t,arraySize:r}),this}},{key:"generateSource",value:function(){return Array.from(this._entries.values()).map((function(e){return"uniform ".concat(e.type," ").concat(e.name).concat((t=e.arraySize)?"[".concat(t,"]"):"",";");var t}))}},{key:"entries",get:function(){return Array.from(this._entries.values())}}]),e}(),d=function(){function e(){Object(a.a)(this,e),this._entries=new Array}return Object(o.a)(e,[{key:"add",value:function(e){this._entries.push(e)}},{key:"generateSource",value:function(){return this._entries}}]),e}(),h=function(e){Object(n.a)(r,e);var t=Object(i.a)(r);function r(){var e;return Object(a.a)(this,r),(e=t.apply(this,arguments)).uniforms=new u,e.code=new d,e.constants=new v,e}return Object(o.a)(r,[{key:"builder",get:function(){return this}}]),r}(c),f=function(){function e(){Object(a.a)(this,e),this._entries=new Array}return Object(o.a)(e,[{key:"add",value:function(e,t){this._entries.push([e,t])}},{key:"generateSource",value:function(e){return"fragment"===e?[]:this._entries.map((function(e){return"attribute ".concat(e[1]," ").concat(e[0],";")}))}}]),e}(),p=function(){function e(){Object(a.a)(this,e),this._entries=new Array}return Object(o.a)(e,[{key:"add",value:function(e,t){this._entries.push([e,t])}},{key:"generateSource",value:function(){return this._entries.map((function(e){return"varying ".concat(e[1]," ").concat(e[0],";")}))}}]),e}(),b=function(){function e(){Object(a.a)(this,e),this._entries=new Set}return Object(o.a)(e,[{key:"add",value:function(e){this._entries.add(e)}},{key:"generateSource",value:function(t){var r="vertex"===t?e.ALLOWLIST_VERTEX:e.ALLOWLIST_FRAGMENT;return Array.from(this._entries).filter((function(e){return r.includes(e)})).map((function(e){return"#extension ".concat(e," : enable")}))}}]),e}();b.ALLOWLIST_FRAGMENT=["GL_EXT_shader_texture_lod","GL_OES_standard_derivatives"],b.ALLOWLIST_VERTEX=[];var v=function(){function e(){Object(a.a)(this,e),this._entries=[]}return Object(o.a)(e,[{key:"add",value:function(t,r,n){var i="ERROR_CONSTRUCTOR_STRING";switch(r){case"float":i=e.numberToFloatStr(n);break;case"int":i=e.numberToIntStr(n);break;case"bool":i=n.toString();break;case"vec2":i="vec2(".concat(e.numberToFloatStr(n[0]),",                            ").concat(e.numberToFloatStr(n[1]),")");break;case"vec3":i="vec3(".concat(e.numberToFloatStr(n[0]),",                            ").concat(e.numberToFloatStr(n[1]),",                            ").concat(e.numberToFloatStr(n[2]),")");break;case"vec4":i="vec4(".concat(e.numberToFloatStr(n[0]),",                            ").concat(e.numberToFloatStr(n[1]),",                            ").concat(e.numberToFloatStr(n[2]),",                            ").concat(e.numberToFloatStr(n[3]),")");break;case"ivec2":i="ivec2(".concat(e.numberToIntStr(n[0]),",                             ").concat(e.numberToIntStr(n[1]),")");break;case"ivec3":i="ivec3(".concat(e.numberToIntStr(n[0]),",                             ").concat(e.numberToIntStr(n[1]),",                             ").concat(e.numberToIntStr(n[2]),")");break;case"ivec4":i="ivec4(".concat(e.numberToIntStr(n[0]),",                             ").concat(e.numberToIntStr(n[1]),",                             ").concat(e.numberToIntStr(n[2]),",                             ").concat(e.numberToIntStr(n[3]),")");break;case"mat2":case"mat3":case"mat4":i="".concat(r,"(").concat(Array.prototype.map.call(n,(function(t){return e.numberToFloatStr(t)})).join(", "),")")}return this._entries.push("const ".concat(r," ").concat(t," = ").concat(i,";")),this}},{key:"generateSource",value:function(){return Array.from(this._entries)}}],[{key:"numberToIntStr",value:function(e){return e.toFixed(0)}},{key:"numberToFloatStr",value:function(e){return Number.isInteger(e)?e.toFixed(1):e.toString()}}]),e}(),m="#ifdef GL_FRAGMENT_PRECISION_HIGH\n  precision highp float;\n  precision highp sampler2D;\n#else\n  precision mediump float;\n  precision mediump sampler2D;\n#endif",y="precision highp float;\nprecision highp sampler2D;"},function(e,t,r){"use strict";r.d(t,"a",(function(){return d}));var n=r(2),i=r(5),a=r(6),o=r(7),s=r(3),c=r(74),l=r(382),u=r(159),d=function(e){Object(a.a)(r,e);var t=Object(o.a)(r);function r(e,i,a){var o;return Object(n.a)(this,r),(o=t.call(this,e,i.generateSource("vertex"),i.generateSource("fragment"),a))._textures=new Map,o._freeTextureUnits=new c.a({deallocator:null}),o._fragmentUniforms=Object(u.b)()?i.fragmentUniforms.entries:null,o}return Object(i.a)(r,[{key:"stop",value:function(){this._textures.clear(),this._freeTextureUnits.clear()}},{key:"bindTexture",value:function(e,t){if(Object(s.i)(e)||null==e.glName){var r=this._textures.get(t);return r&&(this._context.bindTexture(null,r.unit),this._freeTextureUnit(r),this._textures.delete(t)),null}var n=this._textures.get(t);return null==n?(n=this._allocTextureUnit(e),this._textures.set(t,n)):n.texture=e,this._context.useProgram(this),this.setUniform1i(t,n.unit),this._context.bindTexture(e,n.unit),n.unit}},{key:"rebindTextures",value:function(){var e=this;this._context.useProgram(this),this._textures.forEach((function(t,r){e._context.bindTexture(t.texture,t.unit),e.setUniform1i(r,t.unit)})),Object(s.j)(this._fragmentUniforms)&&this._fragmentUniforms.forEach((function(t){if(("sampler2D"===t.type||"samplerCube"===t.type)&&!e._textures.has(t.name))throw new Error("Texture sampler ".concat(t.name," has no bound texture"))}))}},{key:"_allocTextureUnit",value:function(e){return{texture:e,unit:0===this._freeTextureUnits.length?this._textures.size:this._freeTextureUnits.pop()}}},{key:"_freeTextureUnit",value:function(e){this._freeTextureUnits.push(e.unit)}}]),r}(l.a)},function(e,t,r){"use strict";r.d(t,"a",(function(){return s})),r.d(t,"b",(function(){return h})),r.d(t,"c",(function(){return c})),r.d(t,"d",(function(){return u})),r.d(t,"e",(function(){return l})),r.d(t,"f",(function(){return i})),r.d(t,"g",(function(){return d}));var n=r(41),i=Object(n.h)(770,1,771,771),a=Object(n.i)(1,1),o=Object(n.i)(0,771);function s(e){return 2===e?null:1===e?o:a}function c(e){return 2===e?n.e:null}var l=5e5,u={factor:-1,units:-2};function d(e){return e?u:null}function h(e){return 3===e||2===e?513:515}},function(e,t,r){"use strict";r.d(t,"a",(function(){return m})),r.d(t,"b",(function(){return h})),r.d(t,"c",(function(){return u})),r.d(t,"d",(function(){return p})),r.d(t,"e",(function(){return y})),r.d(t,"f",(function(){return o})),r.d(t,"g",(function(){return l})),r.d(t,"h",(function(){return c})),r.d(t,"i",(function(){return s})),r.d(t,"j",(function(){return d})),r.d(t,"k",(function(){return b})),r.d(t,"l",(function(){return v})),r.d(t,"m",(function(){return f}));var n=r(20),i=r(40),a=r(205),o=[0,1],s=64,c=512,l=2.5,u=Object(n.f)(n.a/10),d=4,h=4,f=Object(i.k)();a.a.WebMercatorAuxiliarySphere.getExtent(0,0,0,f);var p=Object(i.k)([-180,-90,180,90]),b="Cannot extend surface to encompass all layers because it would result in too many root tiles.",v="Surface extent is too large for tile resolution at level 0.",m="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAQAAAAEACAIAAADTED8xAAAACXBIWXMAAAsTAAALEwEAmpwYAAAKT2lDQ1BQaG90b3Nob3AgSUNDIHByb2ZpbGUAAHjanVNnVFPpFj333vRCS4iAlEtvUhUIIFJCi4AUkSYqIQkQSoghodkVUcERRUUEG8igiAOOjoCMFVEsDIoK2AfkIaKOg6OIisr74Xuja9a89+bN/rXXPues852zzwfACAyWSDNRNYAMqUIeEeCDx8TG4eQuQIEKJHAAEAizZCFz/SMBAPh+PDwrIsAHvgABeNMLCADATZvAMByH/w/qQplcAYCEAcB0kThLCIAUAEB6jkKmAEBGAYCdmCZTAKAEAGDLY2LjAFAtAGAnf+bTAICd+Jl7AQBblCEVAaCRACATZYhEAGg7AKzPVopFAFgwABRmS8Q5ANgtADBJV2ZIALC3AMDOEAuyAAgMADBRiIUpAAR7AGDIIyN4AISZABRG8lc88SuuEOcqAAB4mbI8uSQ5RYFbCC1xB1dXLh4ozkkXKxQ2YQJhmkAuwnmZGTKBNA/g88wAAKCRFRHgg/P9eM4Ors7ONo62Dl8t6r8G/yJiYuP+5c+rcEAAAOF0ftH+LC+zGoA7BoBt/qIl7gRoXgugdfeLZrIPQLUAoOnaV/Nw+H48PEWhkLnZ2eXk5NhKxEJbYcpXff5nwl/AV/1s+X48/Pf14L7iJIEyXYFHBPjgwsz0TKUcz5IJhGLc5o9H/LcL//wd0yLESWK5WCoU41EScY5EmozzMqUiiUKSKcUl0v9k4t8s+wM+3zUAsGo+AXuRLahdYwP2SycQWHTA4vcAAPK7b8HUKAgDgGiD4c93/+8//UegJQCAZkmScQAAXkQkLlTKsz/HCAAARKCBKrBBG/TBGCzABhzBBdzBC/xgNoRCJMTCQhBCCmSAHHJgKayCQiiGzbAdKmAv1EAdNMBRaIaTcA4uwlW4Dj1wD/phCJ7BKLyBCQRByAgTYSHaiAFiilgjjggXmYX4IcFIBBKLJCDJiBRRIkuRNUgxUopUIFVIHfI9cgI5h1xGupE7yAAygvyGvEcxlIGyUT3UDLVDuag3GoRGogvQZHQxmo8WoJvQcrQaPYw2oefQq2gP2o8+Q8cwwOgYBzPEbDAuxsNCsTgsCZNjy7EirAyrxhqwVqwDu4n1Y8+xdwQSgUXACTYEd0IgYR5BSFhMWE7YSKggHCQ0EdoJNwkDhFHCJyKTqEu0JroR+cQYYjIxh1hILCPWEo8TLxB7iEPENyQSiUMyJ7mQAkmxpFTSEtJG0m5SI+ksqZs0SBojk8naZGuyBzmULCAryIXkneTD5DPkG+Qh8lsKnWJAcaT4U+IoUspqShnlEOU05QZlmDJBVaOaUt2ooVQRNY9aQq2htlKvUYeoEzR1mjnNgxZJS6WtopXTGmgXaPdpr+h0uhHdlR5Ol9BX0svpR+iX6AP0dwwNhhWDx4hnKBmbGAcYZxl3GK+YTKYZ04sZx1QwNzHrmOeZD5lvVVgqtip8FZHKCpVKlSaVGyovVKmqpqreqgtV81XLVI+pXlN9rkZVM1PjqQnUlqtVqp1Q61MbU2epO6iHqmeob1Q/pH5Z/YkGWcNMw09DpFGgsV/jvMYgC2MZs3gsIWsNq4Z1gTXEJrHN2Xx2KruY/R27iz2qqaE5QzNKM1ezUvOUZj8H45hx+Jx0TgnnKKeX836K3hTvKeIpG6Y0TLkxZVxrqpaXllirSKtRq0frvTau7aedpr1Fu1n7gQ5Bx0onXCdHZ4/OBZ3nU9lT3acKpxZNPTr1ri6qa6UbobtEd79up+6Ynr5egJ5Mb6feeb3n+hx9L/1U/W36p/VHDFgGswwkBtsMzhg8xTVxbzwdL8fb8VFDXcNAQ6VhlWGX4YSRudE8o9VGjUYPjGnGXOMk423GbcajJgYmISZLTepN7ppSTbmmKaY7TDtMx83MzaLN1pk1mz0x1zLnm+eb15vft2BaeFostqi2uGVJsuRaplnutrxuhVo5WaVYVVpds0atna0l1rutu6cRp7lOk06rntZnw7Dxtsm2qbcZsOXYBtuutm22fWFnYhdnt8Wuw+6TvZN9un2N/T0HDYfZDqsdWh1+c7RyFDpWOt6azpzuP33F9JbpL2dYzxDP2DPjthPLKcRpnVOb00dnF2e5c4PziIuJS4LLLpc+Lpsbxt3IveRKdPVxXeF60vWdm7Obwu2o26/uNu5p7ofcn8w0nymeWTNz0MPIQ+BR5dE/C5+VMGvfrH5PQ0+BZ7XnIy9jL5FXrdewt6V3qvdh7xc+9j5yn+M+4zw33jLeWV/MN8C3yLfLT8Nvnl+F30N/I/9k/3r/0QCngCUBZwOJgUGBWwL7+Hp8Ib+OPzrbZfay2e1BjKC5QRVBj4KtguXBrSFoyOyQrSH355jOkc5pDoVQfujW0Adh5mGLw34MJ4WHhVeGP45wiFga0TGXNXfR3ENz30T6RJZE3ptnMU85ry1KNSo+qi5qPNo3ujS6P8YuZlnM1VidWElsSxw5LiquNm5svt/87fOH4p3iC+N7F5gvyF1weaHOwvSFpxapLhIsOpZATIhOOJTwQRAqqBaMJfITdyWOCnnCHcJnIi/RNtGI2ENcKh5O8kgqTXqS7JG8NXkkxTOlLOW5hCepkLxMDUzdmzqeFpp2IG0yPTq9MYOSkZBxQqohTZO2Z+pn5mZ2y6xlhbL+xW6Lty8elQfJa7OQrAVZLQq2QqboVFoo1yoHsmdlV2a/zYnKOZarnivN7cyzytuQN5zvn//tEsIS4ZK2pYZLVy0dWOa9rGo5sjxxedsK4xUFK4ZWBqw8uIq2Km3VT6vtV5eufr0mek1rgV7ByoLBtQFr6wtVCuWFfevc1+1dT1gvWd+1YfqGnRs+FYmKrhTbF5cVf9go3HjlG4dvyr+Z3JS0qavEuWTPZtJm6ebeLZ5bDpaql+aXDm4N2dq0Dd9WtO319kXbL5fNKNu7g7ZDuaO/PLi8ZafJzs07P1SkVPRU+lQ27tLdtWHX+G7R7ht7vPY07NXbW7z3/T7JvttVAVVN1WbVZftJ+7P3P66Jqun4lvttXa1ObXHtxwPSA/0HIw6217nU1R3SPVRSj9Yr60cOxx++/p3vdy0NNg1VjZzG4iNwRHnk6fcJ3/ceDTradox7rOEH0x92HWcdL2pCmvKaRptTmvtbYlu6T8w+0dbq3nr8R9sfD5w0PFl5SvNUyWna6YLTk2fyz4ydlZ19fi753GDborZ752PO32oPb++6EHTh0kX/i+c7vDvOXPK4dPKy2+UTV7hXmq86X23qdOo8/pPTT8e7nLuarrlca7nuer21e2b36RueN87d9L158Rb/1tWeOT3dvfN6b/fF9/XfFt1+cif9zsu72Xcn7q28T7xf9EDtQdlD3YfVP1v+3Njv3H9qwHeg89HcR/cGhYPP/pH1jw9DBY+Zj8uGDYbrnjg+OTniP3L96fynQ89kzyaeF/6i/suuFxYvfvjV69fO0ZjRoZfyl5O/bXyl/erA6xmv28bCxh6+yXgzMV70VvvtwXfcdx3vo98PT+R8IH8o/2j5sfVT0Kf7kxmTk/8EA5jz/GMzLdsAAAAgY0hSTQAAeiUAAICDAAD5/wAAgOkAAHUwAADqYAAAOpgAABdvkl/FRgAAA2JJREFUeNrs3d1O20AQgFFvRJInQLQBhHj/h0JVW34El1yQ2F73DVq3jTys55zrqUBbPrErZUSZ+vcOsto4AjK76Lqu1vr8+G3mPzjc3D/+eJj/Bcz/cd75R80fbu79BsAVCAQAAgABgABAACAAEAAIAAQAAgABQPOKfQAy83Ho+HnnHzXv49B4A4AAQAAgABAACAAEAAIAAYAAQAAgABAANM4+AKnZB4ifd/5R8/YB8AYAAYAAQAAgABAACAAEAAIAAYAAQAAgAGicfQBSsw8QP+/8o+btA+ANAAIAAYAAQAAgABAACAAEAAIAAYAAQADQOPsApGYfIH7e+UfN2wfAGwAEAAIAAYAAQAAgABAACAAEAAIAAXA201QdggAggH0AUrMPED8/jsPL03fns/y8fQC8AUAAIAAQAAgABAACAAGAAEAAIAAQAAgAGmcfgNTsA8TP2weImrcPgDcACAAEAAIAAYAAQAAgABAACAAEAAIAAUDj7AOQmn2A+Hn7AFHz9gHwBgABgABAACAAEAAIAAQAAgABgABgNS4cAf9pu9u3O1+m/n2aplKK/0j+TX86/tVP5+eZ3+729gFIfwWyDxA7bx8gat4+ANkJAAGAAEAAIAAQAAgABAACAAGAAEAAIABonn0AUrMPED9vHyBq3j4A3gAgABAACAAEAAIAAYAAQAAgABAA51VrdQgCAAHAsuwDkJp9gPj5vj+9vvx0PsvP2wfAGwAEAAIAAYAAQAAgABAACAAEAAIAAYAAoHH2AUjNPkD8vH2AqHn7AHgDgABAACAAEAAIAAQAAgABgABAACAAEAA0zj4AqdkHiJ+3DxA1bx8AbwAQACQ0DL0AyKuOowBwBYKUSikCIHUBAsAVCAQAAgABgABAALBy9gFIzT5A/Lx9gKj5y6trVyC8AUAAIAAQAAgAVq90Pg5N5gA2AsAVCAQAAgABgABAALB29gFIzT5A/Lx9gKj5q6+3rkB4A4AAQAAgABAACADWzB/IIHsCAsAVCARAlKlWhyAAEAAIABZjH4DU7APEz5+OH2+vT85n+fkvhztXILwBQAAgABAACAAEAGtWigBIHcBGALgCgQBAACAAyPMO9nHosxuHodZx5vB2t691HIdh/nx/Os7/Zsz/fvgXAAAA//8DAF1P1hM2ICMfAAAAAElFTkSuQmCC",y=5},function(e,t,r){"use strict";r.d(t,"a",(function(){return c}));var n=r(8),i=r.n(n),a=r(16),o=r(2),s=r(5),c=function(){function e(t,r){Object(o.a)(this,e),this._module=t,this._loadModule=r}return Object(s.a)(e,[{key:"get",value:function(){return this._module}},{key:"reload",value:function(){var e=Object(a.a)(i.a.mark((function e(){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._loadModule();case 2:return this._module=e.sent,e.abrupt("return",this._module);case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),e}()},function(e,t,r){"use strict";r.d(t,"a",(function(){return s})),r.d(t,"b",(function(){return l})),r.d(t,"c",(function(){return u})),r.d(t,"d",(function(){return o})),r.d(t,"e",(function(){return c})),r.d(t,"f",(function(){return a}));var n=r(13),i=(r(17),r(3));function a(e,t){return e.vertexBuffers[t].size/o(e.layout[t])}function o(e){return e[0].stride}function s(e,t,r,i,a){var o=e.gl,s=e.capabilities.instancing;e.bindBuffer(r);var c,l=Object(n.a)(i);try{for(l.s();!(c=l.n()).done;){var u=c.value,d=t.get(u.name);void 0===d&&console.error("There is no location for vertex attribute '".concat(u.name,"' defined.")),u.baseInstance&&!u.divisor&&console.error("Vertex attribute '".concat(u.name,"' uses baseInstanceOffset without divisor."));var h=(a||(0+u.baseInstance?u.baseInstance:0))*u.stride;if(u.count<=4)o.vertexAttribPointer(d,u.count,u.type,u.normalized,u.stride,u.offset+h),o.enableVertexAttribArray(d),u.divisor>0&&s&&s.vertexAttribDivisor(d,u.divisor);else if(9===u.count)for(var f=0;f<3;f++)o.vertexAttribPointer(d+f,3,u.type,u.normalized,u.stride,u.offset+12*f+h),o.enableVertexAttribArray(d+f),u.divisor>0&&s&&s.vertexAttribDivisor(d+f,u.divisor);else if(16===u.count)for(var p=0;p<4;p++)o.vertexAttribPointer(d+p,4,u.type,u.normalized,u.stride,u.offset+16*p+h),o.enableVertexAttribArray(d+p),u.divisor>0&&s&&s.vertexAttribDivisor(d+p,u.divisor);else console.error("Unsupported vertex attribute element count: "+u.count)}}catch(b){l.e(b)}finally{l.f()}}function c(e,t,r,i){var a=e.gl,o=e.capabilities.instancing;e.bindBuffer(r);var s,c=Object(n.a)(i);try{for(c.s();!(s=c.n()).done;){var l=s.value,u=t.get(l.name);if(l.count<=4)a.disableVertexAttribArray(u),l.divisor&&l.divisor>0&&o&&o.vertexAttribDivisor(u,0);else if(9===l.count)for(var d=0;d<3;d++)a.disableVertexAttribArray(u+d),l.divisor&&l.divisor>0&&o&&o.vertexAttribDivisor(u+d,0);else if(16===l.count)for(var h=0;h<4;h++)a.disableVertexAttribArray(u+h),l.divisor&&l.divisor>0&&o&&o.vertexAttribDivisor(u+h,0);else console.error("Unsupported vertex attribute element count: "+l.count)}}catch(f){c.e(f)}finally{c.f()}e.unbindBuffer(34962)}function l(e){switch(e){case 6406:case 6409:case 36168:return 1;case 6410:case 32854:case 33325:case 32854:case 33189:return 2;case 6407:case 6402:return 3;case 6408:case 34041:case 33326:case 35898:case 33327:case 34041:return 4;case 33328:case 34842:return 8;case 34836:return 16;case 33776:case 33777:return.5;case 33778:case 33779:return 1;case 37488:case 37489:case 37492:case 37493:case 37494:case 37495:return.5;case 37490:case 37491:case 37496:case 37497:return 1}return 0}function u(e){if(Object(i.i)(e))return 0;if("descriptor"in e)return e.glName?u(e.descriptor):0;var t=e.internalFormat||"pixelFormat"in e&&e.pixelFormat;if(!t)return 0;var r="hasMipmap"in e&&e.hasMipmap?1.3:1,n=e.width*e.height;return l(t)*n*r}},function(e,t,r){"use strict";r.d(t,"a",(function(){return l})),r.d(t,"b",(function(){return u}));var n=r(123),i=r(99),a=r(22),o=r(15),s=r(39),c=o.a.getLogger("esri.assets");function l(e,t){return Object(i.default)(u(e),t)}function u(e){if(!n.a.assetsPath)throw c.errorOnce("The API assets location needs to be set using config.assetsPath. More information: https://arcg.is/1OzLe50"),new a.a("assets:path-not-set","config.assetsPath is not set");return Object(s.z)(n.a.assetsPath,e)}},function(e,t,r){"use strict";r.d(t,"a",(function(){return m})),r.d(t,"b",(function(){return i})),r.d(t,"c",(function(){return o})),r.d(t,"d",(function(){return p})),r.d(t,"e",(function(){return b})),r.d(t,"f",(function(){return u})),r.d(t,"g",(function(){return h})),r.d(t,"h",(function(){return s})),r.d(t,"i",(function(){return d})),r.d(t,"j",(function(){return f})),r.d(t,"k",(function(){return c})),r.d(t,"l",(function(){return l})),r.d(t,"m",(function(){return a})),r.d(t,"n",(function(){return v}));var n=r(3);function i(e,t){if(e.forEach)e.forEach(t);else for(var r=0;r<e.length;r++)t(e[r],r,e)}function a(e,t,r){if(e.slice)return e.slice(t,r);void 0===t?t=0:(t<0&&(t+=e.length),t=Math.min(e.length,Math.max(0,t))),void 0===r?r=e.length:(r<0&&(r+=e.length),r=Math.min(e.length,Math.max(0,r)));for(var n=Math.max(0,r-t),i=new(0,e.constructor)(n),a=0;a<n;a++)i[a]=e[t+a];return i}function o(e){return e instanceof ArrayBuffer||e&&e.constructor&&"ArrayBuffer"===e.constructor.name}function s(e){return e instanceof Int8Array||e&&e.constructor&&"Int8Array"===e.constructor.name}function c(e){return e instanceof Uint8Array||e&&e.constructor&&"Uint8Array"===e.constructor.name}function l(e){return e instanceof Uint8ClampedArray||e&&e.constructor&&"Uint8ClampedArray"===e.constructor.name}function u(e){return e instanceof Int16Array||e&&e.constructor&&"Int16Array"===e.constructor.name}function d(e){return e instanceof Uint16Array||e&&e.constructor&&"Uint16Array"===e.constructor.name}function h(e){return e instanceof Int32Array||e&&e.constructor&&"Int32Array"===e.constructor.name}function f(e){return e instanceof Uint32Array||e&&e.constructor&&"Uint32Array"===e.constructor.name}function p(e){return e instanceof Float32Array||e&&e.constructor&&"Float32Array"===e.constructor.name}function b(e){return e instanceof Float64Array||e&&e.constructor&&"Float64Array"===e.constructor.name}function v(e){for(var t=new Array(e.length),r=0;r<e.length;r++)t[r]=e[r];return t}function m(e){return Object(n.i)(e)?0:128+e.buffer.byteLength+64}},function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r(2),i=r(5),a=r(3),o=function(){function e(t,r){var i=this,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){return i.dispose()};Object(n.a)(this,e),this.release=a,r&&(this._config=r.snapshot()),this._program=this.initializeProgram(t),this._pipeline=this.initializePipeline(t)}return Object(i.a)(e,[{key:"dispose",value:function(){this._program=Object(a.f)(this._program),this._pipeline=this._config=null}},{key:"reload",value:function(e){Object(a.f)(this._program),this._program=this.initializeProgram(e)}},{key:"program",get:function(){return this._program}},{key:"pipeline",get:function(){return this._pipeline}},{key:"key",get:function(){return this._config.key}},{key:"configuration",get:function(){return this._config}},{key:"bindPass",value:function(e,t){}},{key:"bindMaterial",value:function(e,t){}},{key:"bindDraw",value:function(e,t,r){}},{key:"bindPipelineState",value:function(e){e.setPipelineState(this.pipeline)}},{key:"ensureAttributeLocations",value:function(e){this.program.assertCompatibleVertexAttributeLocations(e)}},{key:"primitiveType",get:function(){return 4}}]),e}()},function(e,t,r){"use strict";function n(){return[1,0,0,0,1,0,0,0,1]}function i(e,t){return new Float64Array(e,t,9)}r.d(t,"a",(function(){return i})),r.d(t,"b",(function(){return n}));Object.freeze({__proto__:null,create:n,clone:function(e){return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8]]},fromValues:function(e,t,r,n,i,a,o,s,c){return[e,t,r,n,i,a,o,s,c]},createView:i})},function(e,t,r){"use strict";r.d(t,"a",(function(){return F})),r.d(t,"b",(function(){return j})),r.d(t,"c",(function(){return k})),r.d(t,"d",(function(){return D}));var n=r(2),i=r(5),a=r(19),o=r(6),s=r(7),c=r(0),l=r(30),u=r(15),d=r(3),h=r(269),f=r(74),p=r(23),b=r(75),v=r(35),m=r(1),y=(r(17),r(18),r(10)),g=r(591),O=function(e){Object(o.a)(r,e);var t=Object(s.a)(r);function r(){var e;return Object(n.a)(this,r),(e=t.apply(this,arguments)).SCHEDULER_LOG_SLOW_TASKS=!1,e.FEATURE_SERVICE_SNAPPING_SOURCE_TILE_TREE_SHOW_TILES=!1,e}return r}(l.a);Object(c.a)([Object(m.b)()],O.prototype,"SCHEDULER_LOG_SLOW_TASKS",void 0),Object(c.a)([Object(m.b)()],O.prototype,"FEATURE_SERVICE_SNAPPING_SOURCE_TILE_TREE_SHOW_TILES",void 0);var j,_,w=new(O=Object(c.a)([Object(y.a)("esri.views.support.DebugFlags")],O)),x=u.a.getLogger("esri.views.support.Scheduler");function k(e){return new C.Scheduler({nowFunc:e})}(_=j||(j={})).RESOURCE_CONTROLLER="schedule",_.SLIDE="slide",_.STREAM_DATA_LOADER="stream loader",_.ELEVATION_QUERY="elevation query",_.TERRAIN_SURFACE="terrain",_.SURFACE_GEOMETRY_UPDATES="surface geometry updates",_.GRAPHICS_CORE="Graphics3D",_.I3S_CONTROLLER="I3S",_.POINT_CLOUD_LAYER="point cloud",_.FEATURE_TILE_FETCHER="feature fetcher",_.STAGE="stage",_.GRAPHICS_DECONFLICTOR="graphics deconflictor",_.FILTER_VISIBILITY="Graphics3D filter visibility",_.SCALE_VISIBILITY="Graphics3D scale visibility",_.FRUSTUM_VISIBILITY="Graphics3D frustum visibility",_.POINT_OF_INTEREST_FREQUENT="POI frequent",_.POINT_OF_INTEREST_INFREQUENT="POI infrequent",_.LABELER="labeler",_.FEATURE_QUERY_ENGINE="feature query",_.FEATURE_TILE_TREE="feature tile tree",_.FEATURE_TILE_TREE_ACTIVE="fast feature tile tree",_.ELEVATION_ALIGNMENT="elevation alignment",_.TEXT_TEXTURE_ATLAS="text texture atlas",_.TEXTURE_UNLOAD="texture unload",_.OVERLAY_MANAGER="overlay manager",_.LINE_OF_SIGHT_TOOL="line of sight tool",_.LINE_OF_SIGHT_TOOL_INTERACTIVE="interactive line of sight tool",_.ELEVATION_PROFILE="elevation profile",_.SNAPPING="snapping",_.SHADOW_ACCUMULATOR="shadow accumulator",_[_.TEST_PRIO=1]="TEST_PRIO";var S=new Map([[j.RESOURCE_CONTROLLER,0],[j.SLIDE,0],[j.STREAM_DATA_LOADER,0],[j.ELEVATION_QUERY,0],[j.TERRAIN_SURFACE,1],[j.SURFACE_GEOMETRY_UPDATES,1],[j.GRAPHICS_CORE,2],[j.I3S_CONTROLLER,2],[j.POINT_CLOUD_LAYER,2],[j.FEATURE_TILE_FETCHER,2],[j.STAGE,4],[j.GRAPHICS_DECONFLICTOR,4],[j.FILTER_VISIBILITY,4],[j.SCALE_VISIBILITY,4],[j.FRUSTUM_VISIBILITY,4],[j.POINT_OF_INTEREST_FREQUENT,6],[j.POINT_OF_INTEREST_INFREQUENT,30],[j.LABELER,8],[j.FEATURE_QUERY_ENGINE,8],[j.FEATURE_TILE_TREE,16],[j.FEATURE_TILE_TREE_ACTIVE,0],[j.ELEVATION_ALIGNMENT,12],[j.TEXT_TEXTURE_ATLAS,12],[j.TEXTURE_UNLOAD,12],[j.OVERLAY_MANAGER,12],[j.LINE_OF_SIGHT_TOOL,16],[j.LINE_OF_SIGHT_TOOL_INTERACTIVE,0],[j.SNAPPING,0],[j.SHADOW_ACCUMULATOR,30]]);function T(e){return S.has(e)?S.get(e):"number"==typeof e?e:1}var C,M,P=Object(b.a)(6.5),A=Object(b.a)(1),E=Object(b.a)(30),R=Object(b.a)(1e3/30),I=Object(b.a)(100);!function(e){var t=function(e){Object(o.a)(c,e);var t=Object(s.a)(c);function c(e){var r,i;Object(n.a)(this,c),(r=t.call(this,e)).updating=!0,r.performanceInfo={total:new h.a("total"),tasks:new Map},r._frameTaskTimes=new Map,r._budget=null,r._state=1,r._tasks=new f.a,r._runQueue=new f.a,r._load=0,r._idleStateCallbacks=new f.a,r._idleUpdatesStartFired=!1,r._maxReschedule=L,r._forceTask=!1,r._debug=!1,r._debugHandle=Object(v.a)(w,"SCHEDULER_LOG_SLOW_TASKS",(function(e){return r._debug=e})),r._budget=new u(e.nowFunc);for(var o=0,s=Object.keys(j);o<s.length;o++){var l=s[o];r.performanceInfo.tasks.set(j[l],new h.a(j[l]))}var p=Object(a.a)(r);return r._test={get state(){return Object(d.i)(i)?p._state:i},set state(e){i=e},FRAME_SAFETY_BUDGET:P,INTERACTING_BUDGET:R,IDLE_BUDGET:I,get budget(){return p._budget.budget},usedBudget:0,updateTask:function(e){return r._updateTask(e)},getState:function(e){return r._getState(e)},getRuntime:function(e){return r._getRuntime(e)},resetRuntimes:function(){return r._resetRuntimes()},getRunning:function(){return r._getRunning()}},r}return Object(i.a)(c,[{key:"destroy",value:function(){this._debugHandle&&this._debugHandle.remove()}},{key:"registerTask",value:function(e,t){var n=T(e),i=new r(this,e,t,n);return this._tasks.push(i),this.performanceInfo.tasks.has(e)||this.performanceInfo.tasks.set(e,new h.a(e)),i}},{key:"registerIdleStateCallbacks",value:function(e,t){var r=this,n={idleBegin:e,idleEnd:t};this._idleStateCallbacks.push(n),2===this.state&&this._idleUpdatesStartFired&&n.idleBegin();var i=this;return{remove:function(){return r._removeIdleStateCallbacks(n)},set idleBegin(e){i._idleUpdatesStartFired&&(n.idleEnd(),2===i._state&&e()),n.idleBegin=e},set idleEnd(e){n.idleEnd=e}}}},{key:"now",get:function(){return this.nowFunc()}},{key:"load",get:function(){return this._load}},{key:"state",get:function(){return Object(d.i)(this._test.state)?this._state:this._test.state},set:function(e){this._state!==e&&(this._state=e,2!==this.state&&this._idleUpdatesStartFired&&(this._idleUpdatesStartFired=!1,this._idleStateCallbacks.forAll((function(e){return e.idleEnd()}))))}},{key:"updateBudget",value:function(e){this._test.usedBudget=0;var t=P,r=e.frameDuration,n=A;switch(this.state){case 2:t=Object(b.a)(0),r=Object(b.a)(Math.max(I,e.frameDuration)),n=E;break;case 1:r=Object(b.a)(Math.max(R,e.frameDuration))}return r=Object(b.a)(r-e.elapsedFrameTime-t),2!==this.state&&r<A&&!this._forceTask?(this._forceTask=!0,!1):(r=Object(b.a)(Math.max(r,n)),this._budget.reset(r,this.state),this._maxReschedule=L,this._updateLoad(),this._schedule())}},{key:"frame",value:function(){switch(this._forceTask=!1,this.state){case 2:this._idleUpdatesStartFired||(this._idleUpdatesStartFired=!0,this._idleStateCallbacks.forAll((function(e){return e.idleBegin()}))),this._runIdle();break;case 1:this._runInteracting();break;default:this._runAnimating()}this._test.usedBudget=this._budget.elapsed}},{key:"stopFrame",value:function(){this._budget.reset(Object(b.a)(0),this._state),this._budget.madeProgress()}},{key:"_removeIdleStateCallbacks",value:function(e){this._idleUpdatesStartFired&&e.idleEnd(),this._idleStateCallbacks.removeUnordered(e)}},{key:"removeTask",value:function(e){this._tasks.removeUnordered(e),this._runQueue.removeUnordered(e)}},{key:"_updateTask",value:function(e){this._tasks.forAll((function(t){t.name===e&&t.setPriority(e)}))}},{key:"_getState",value:function(e){if(this._runQueue.some((function(t){return t.name===e})))return M.SCHEDULED;var t=M.IDLE;return this._tasks.forAll((function(r){r.name===e&&r.needsUpdate&&(r.schedulePriority<=1?t=M.READY:t!==M.READY&&(t=M.WAITING))})),t}},{key:"_getRuntime",value:function(e){var t=0;return this._tasks.forAll((function(r){r.name===e&&(t+=r.runtime)})),t}},{key:"_resetRuntimes",value:function(){this._tasks.forAll((function(e){return e.runtime=0}))}},{key:"_getRunning",value:function(){var e=new Map;if(this._tasks.forAll((function(t){t.needsUpdate&&e.set(t.name,(e.get(t.name)||0)+1)})),0===e.size)return null;var t="";return e.forEach((function(e,r){t+=e>1?" ".concat(e,"x ").concat(r):" ".concat(r)})),t}},{key:"_runIdle",value:function(){this._run()}},{key:"_runInteracting",value:function(){this._run()}},{key:"_runAnimating",value:function(){this._run()}},{key:"_updateLoad",value:function(){var e=this._tasks.reduce((function(e,t){return t.needsUpdate?++e:e}),0);this._load=.9*this._load+e*(1-.9)}},{key:"_schedule",value:function(){var e=this;if(this._maxReschedule<=0)return!1;var t=function(){var t=!1,r=0;if(e._tasks.forAll((function(n){if(n.needsUpdate&&0!==n.schedulePriority&&0!==n.basePriority)switch(t=!0,r=Math.max(r,n.basePriority),n.schedulePriority){case 1:n.schedulePriority=0,e._runQueue.push(n);break;default:--n.schedulePriority}})),!t)return{v:(e.updating=!1,!1)};e._maxReschedule===L&&(e._maxReschedule=r),--e._maxReschedule};for(this._runQueue.filterInPlace((function(e){return!!e.needsUpdate||(e.schedulePriority=e.basePriority,!1)})),this._tasks.forAll((function(t){0===t.basePriority&&t.needsUpdate&&!e._runQueue.some((function(e){return e===t}))&&e._runQueue.unshift(t)}));0===this._runQueue.length;){var r=t();if("object"===typeof r)return r.v}return this.updating=!0,!0}},{key:"_run",value:function(){var e=this._budget.now();this._startFrameTaskTimes();do{for(;this._runQueue.length>0;){var t=this._budget.now(),r=this._runQueue.pop();this._budget.resetProgress();try{r.task.runTask(this._budget)}catch(i){x.error('Exception in task "'.concat(r.name,'"'),i)}r.schedulePriority=r.basePriority;var n=this._budget.now()-t;if(r.runtime+=n,this._frameTaskTimes.set(r.priority,this._frameTaskTimes.get(r.priority)+n),this._debug&&this._budget.elapsed>2*this._budget.budget&&console.log("Task",r.name,"used",this._budget.elapsed,"of max",this._budget.budget,"ms"),this._budget.remaining<=0)return void this._recordFrameTaskTimes(this._budget.now()-e)}}while(this._schedule());this._recordFrameTaskTimes(this._budget.now()-e)}},{key:"_startFrameTaskTimes",value:function(){for(var e=0,t=Object.keys(j);e<t.length;e++){var r=t[e];this._frameTaskTimes.set(j[r],0)}}},{key:"_recordFrameTaskTimes",value:function(e){var t=this;this._frameTaskTimes.forEach((function(e,r){return t.performanceInfo.tasks.get(r).record(e)})),this.performanceInfo.total.record(e)}},{key:"test",get:function(){return this._test}}]),c}(l.a);Object(c.a)([Object(m.b)()],t.prototype,"updating",void 0),Object(c.a)([Object(m.b)()],t.prototype,"nowFunc",void 0),t=Object(c.a)([Object(y.a)("esri.views.support.Scheduler")],t),e.Scheduler=t;var r=function(e){Object(o.a)(r,e);var t=Object(s.a)(r);function r(e,i,a,o){var s;return Object(n.a)(this,r),(s=t.call(this,{}))._scheduler=e,s.name=i,s._basePriority=o,s.runtime=0,s._queue=new g.a,s.updating=!1,s.schedulePriority=s._basePriority,s.task=Object(d.j)(a)?a:{running:!1,runTask:function(e){return s.processQueue(e)}},s}return Object(i.a)(r,[{key:"normalizeCtorArgs",value:function(){return{}}},{key:"remove",value:function(){this.processQueue(D),this._scheduler.removeTask(this),this.schedule=F.schedule,this.reschedule=F.reschedule}},{key:"basePriority",get:function(){return this._basePriority}},{key:"setPriority",value:function(e){this.name=e;var t=T(e);0!==this._basePriority&&0===this.schedulePriority||(this.schedulePriority=t),this._basePriority=t}},{key:"priority",get:function(){return this.name},set:function(e){this.setPriority(e)}},{key:"needsUpdate",get:function(){return this.updating||this.task.running}},{key:"schedule",value:function(e,t,r){return this.updating=!0,this._queue.push(e,t,r)}},{key:"reschedule",value:function(e,t,r){return this.updating=!0,this._queue.unshift(e,t,r)}},{key:"processQueue",value:function(e){for(;!e.done&&this._queue.process();)e.madeProgress();this.updating=this._queue.length>0}}]),r}(l.a);Object(c.a)([Object(m.b)()],r.prototype,"updating",void 0),r=Object(c.a)([Object(y.a)("esri.views.support.SchedulerTask")],r);var u=function(){function e(t){Object(n.a)(this,e),this.now=t,this._begin=0,this._budget=0,this._state=2,this._didWork=!1,this._enabled=!0}return Object(i.a)(e,[{key:"run",value:function(e){return!this.done&&(!0===e()&&(this._didWork=!0),!0)}},{key:"done",get:function(){return this._didWork&&this.elapsed>=this._budget&&this._enabled}},{key:"budget",get:function(){return this._budget}},{key:"madeProgress",value:function(){this._didWork=!0}},{key:"state",get:function(){return this._state}},{key:"enabled",get:function(){return this._enabled},set:function(e){this._enabled=e}},{key:"reset",value:function(e,t){this._begin=this.now(),this._budget=e,this._state=t,this._didWork=!1}},{key:"remaining",get:function(){return Math.max(this._budget-this.elapsed,0)}},{key:"elapsed",get:function(){return this.now()-this._begin}},{key:"resetProgress",value:function(){this._didWork=!1}},{key:"hasProgressed",get:function(){return this._didWork}}]),e}();e.Budget=u}(C||(C={})),function(e){e.SCHEDULED="s",e.READY="r",e.WAITING="w",e.IDLE="i"}(M||(M={}));var D=function(){var e=new C.Budget((function(){return performance.now()}));return e.enabled=!1,e}(),F=new(function(){function e(){Object(n.a)(this,e)}return Object(i.a)(e,[{key:"remove",value:function(){}},{key:"processQueue",value:function(){}},{key:"schedule",value:function(e,t,r){try{if(Object(p.o)(t)){var n=Object(p.f)();return r?Promise.resolve(r(n)):Promise.reject(n)}return Object(p.z)(e())}catch(i){return Promise.reject(i)}}},{key:"reschedule",value:function(e,t,r){return this.schedule(e,t,r)}}]),e}()),L=Number.MAX_SAFE_INTEGER},function(e,t,r){"use strict";r.d(t,"a",(function(){return q})),r.d(t,"b",(function(){return D})),r.d(t,"c",(function(){return F})),r.d(t,"d",(function(){return V})),r.d(t,"e",(function(){return L})),r.d(t,"f",(function(){return z})),r.d(t,"g",(function(){return U})),r.d(t,"h",(function(){return G})),r.d(t,"i",(function(){return N})),r.d(t,"j",(function(){return B}));var n,i=r(18),a=r(257),o=r(290),s=(r(350),r(386)),c=(r(275),r(330),r(201),r(303)),l=r(304),u=(r(264),r(389),r(353)),d=(r(292),r(351),r(2)),h=r(5),f=r(45),p=r(42),b=r(6),v=r(7),m=r(0),y=r(25),g=r(28),O=r(1),j=(r(17),r(15),r(52)),_=r(10),w=r(403),x=n=function(e){Object(b.a)(r,e);var t=Object(v.a)(r);function r(){var e;Object(d.a)(this,r);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return(e=t.call.apply(t,[this].concat(i))).type="picture-fill",e.url=null,e.xscale=1,e.yscale=1,e.width=12,e.height=12,e.xoffset=0,e.yoffset=0,e.source=null,e}return Object(h.a)(r,[{key:"normalizeCtorArgs",value:function(e,t,r,n){if(e&&"string"!=typeof e&&null==e.imageData)return e;var i={};return e&&(i.url=e),t&&(i.outline=t),null!=r&&(i.width=Object(g.j)(r)),null!=n&&(i.height=Object(g.j)(n)),i}},{key:"clone",value:function(){var e=new n({color:Object(y.a)(this.color),height:this.height,outline:this.outline&&this.outline.clone(),url:this.url,width:this.width,xoffset:this.xoffset,xscale:this.xscale,yoffset:this.yoffset,yscale:this.yscale});return e._set("source",Object(y.a)(this.source)),e}},{key:"hash",value:function(){var e;return"".concat(Object(f.a)(Object(p.a)(r.prototype),"hash",this).call(this),".").concat(null==(e=this.color)?void 0:e.hash(),".").concat(this.height,".").concat(this.url,".").concat(this.width,".").concat(this.xoffset,".").concat(this.xscale,".").concat(this.yoffset,".").concat(this.yscale)}}]),r}(s.a);Object(m.a)([Object(j.a)({esriPFS:"picture-fill"},{readOnly:!0})],x.prototype,"type",void 0),Object(m.a)([Object(O.b)(w.b)],x.prototype,"url",void 0),Object(m.a)([Object(O.b)({type:Number,json:{write:!0}})],x.prototype,"xscale",void 0),Object(m.a)([Object(O.b)({type:Number,json:{write:!0}})],x.prototype,"yscale",void 0),Object(m.a)([Object(O.b)({type:Number,cast:g.j,json:{write:!0}})],x.prototype,"width",void 0),Object(m.a)([Object(O.b)({type:Number,cast:g.j,json:{write:!0}})],x.prototype,"height",void 0),Object(m.a)([Object(O.b)({type:Number,cast:g.j,json:{write:!0}})],x.prototype,"xoffset",void 0),Object(m.a)([Object(O.b)({type:Number,cast:g.j,json:{write:!0}})],x.prototype,"yoffset",void 0),Object(m.a)([Object(O.b)(w.a)],x.prototype,"source",void 0);var k=x=n=Object(m.a)([Object(_.a)("esri.symbols.PictureFillSymbol")],x),S=r(317),T=r(218),C=r(256),M=r(222),P=r(166),A=r(234),E=r(135),R=(r(223),r(161),r(258)),I=(r(219),r(352),r(227));r(485),r(486),r(388);function D(e){if(!e)return!1;switch(e.type){case"picture-fill":case"picture-marker":case"simple-fill":case"simple-line":case"simple-marker":case"text":case"cim":return!0;default:return!1}}function F(e){if(!e)return!1;switch(e.type){case"label-3d":case"line-3d":case"mesh-3d":case"point-3d":case"polygon-3d":return!0;default:return!1}}var L={base:E.a,key:"type",typeMap:{"simple-fill":M.a,"picture-fill":k,"picture-marker":S.a,"simple-line":P.a,"simple-marker":A.a,text:R.a,"label-3d":c.a,"line-3d":l.a,"mesh-3d":u.a,"point-3d":T.a,"polygon-3d":C.a,"web-style":I.a,cim:o.a},errorContext:"symbol"},z={base:E.a,key:"type",typeMap:{"picture-marker":S.a,"simple-marker":A.a,text:R.a,"web-style":I.a,cim:o.a},errorContext:"symbol"},V=Object(a.b)({types:L}),N={base:E.a,key:"type",typeMap:{"simple-fill":M.a,"picture-fill":k,"picture-marker":S.a,"simple-line":P.a,"simple-marker":A.a,text:R.a,"line-3d":l.a,"mesh-3d":u.a,"point-3d":T.a,"polygon-3d":C.a,"web-style":I.a,cim:o.a},errorContext:"symbol"},U={base:E.a,key:"type",typeMap:{text:R.a,"label-3d":c.a},errorContext:"symbol"},B=(E.a,c.a,l.a,u.a,T.a,C.a,I.a,{base:E.a,key:"type",typeMap:{"line-3d":l.a,"mesh-3d":u.a,"point-3d":T.a,"polygon-3d":C.a,"web-style":I.a},errorContext:"symbol"}),G={base:E.a,key:"type",typeMap:{"label-3d":c.a},errorContext:"symbol"},q=Object(i.k)(L)},function(e,t,r){"use strict";r.r(t);var n,i=r(33),a=r(8),o=r.n(a),s=r(14),c=r(13),l=r(16),u=r(123),d=r(129),h=r(22),f=r(71),p=r(17),b=r(25),v=r(3),m=r(23),y=r(39),g=r(638),O=r(505);function j(e,t){return _.apply(this,arguments)}function _(){return(_=Object(l.a)(o.a.mark((function e(t,r){var i,a,c,l,u,d,h,f;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=Object(y.u)(t),(a=Object(y.t)(t))||i||(t=Object(y.D)(t)),c={url:t,requestOptions:Object(s.a)({},Object(v.s)(r))},!(l=Object(y.l)(t))){e.next=11;break}return e.next=7,B(l,c);case 7:if(null==(u=e.sent)){e.next=10;break}return e.abrupt("return",{data:u,getHeader:C,requestOptions:c.requestOptions,url:c.url});case 10:l.after||l.error||(l=null);case 11:if(t=c.url,"image"!==(r=c.requestOptions).responseType){e.next=16;break}if(!Object(p.a)("host-webworker")&&!Object(p.a)("host-node")){e.next=14;break}throw E("request:invalid-parameters",new Error("responseType 'image' is not supported in Web Workers or Node environment"),c);case 14:e.next=18;break;case 16:if(!i){e.next=18;break}throw E("request:invalid-parameters",new Error("Data URLs are not supported for responseType = "+r.responseType),c);case 18:if("head"!==r.method){e.next=23;break}if(!r.body){e.next=21;break}throw E("request:invalid-parameters",new Error("body parameter cannot be set when method is 'head'"),c);case 21:if(!i&&!a){e.next=23;break}throw E("request:invalid-parameters",new Error("data and blob URLs are not supported for method 'head'"),c);case 23:return e.next=25,R();case 25:if(!n){e.next=27;break}return e.abrupt("return",n.execute(t,r));case 27:return d=Object(m.e)(),Object(m.s)(r,(function(){return d.abort()})),h={controller:d,credential:null,credentialToken:null,fetchOptions:null,hasToken:!1,interceptor:l,params:c,redoRequest:!1,useIdentity:w.useIdentity,useProxy:!1,useSSL:!1,withCredentials:!1},e.next=32,W(h);case 32:return f=e.sent,e.abrupt("return",(l&&l.after&&l.after(f),f));case 34:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var w=u.a.request,x="FormData"in f.a,k=[499,498,403,401],S=["COM_0056","COM_0057","SB_0008"],T=[/\/arcgis\/tokens/i,/\/sharing(\/rest)?\/generatetoken/i,/\/rest\/info/i],C=function(){return null},M=Symbol();function P(e){var t=Object(y.m)(e);t&&!j._corsServers.includes(t)&&j._corsServers.push(t)}function A(e){var t=Object(y.m)(e);return!t||t.endsWith(".arcgis.com")||j._corsServers.includes(t)||Object(y.y)(t)}function E(e,t,r,n){var i="Error",a={url:r.url,requestOptions:r.requestOptions,getHeader:C,ssl:!1};if(t instanceof h.a)return t.details?(t.details=Object(b.a)(t.details),t.details.url=r.url,t.details.requestOptions=r.requestOptions):t.details=a,t;if(t){var o=n&&function(e){return n.headers.get(e)},s=n&&n.status,c=t.message;c&&(i=c),o&&(a.getHeader=o),a.httpStatus=(null!=t.httpCode?t.httpCode:t.code)||s||0,a.subCode=t.subcode,a.messageCode=t.messageCode,"string"==typeof t.details?a.messages=[t.details]:a.messages=t.details,a.raw=M in t?t[M]:t}return Object(m.n)(t)?Object(m.f)():new h.a(e,i,a)}function R(){return I.apply(this,arguments)}function I(){return(I=Object(l.a)(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!Object(p.a)("host-webworker")){e.next=8;break}if(e.t0=n,e.t0){e.next=6;break}return e.next=5,r.e(154).then(r.bind(null,703));case 5:n=e.sent;case 6:e.next=9;break;case 8:j._abortableFetch||(j._abortableFetch=f.a.fetch.bind(f.a));case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function D(){return F.apply(this,arguments)}function F(){return(F=Object(l.a)(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=d.b,e.t0){e.next=4;break}return e.next=4,r.e(157).then(r.bind(null,709));case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function L(e){return z.apply(this,arguments)}function z(){return(z=Object(l.a)(o.a.mark((function e(t){var r,n,i,a,s,c,l,h;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.params.url,n=t.params.requestOptions,i=t.controller.signal,a=n.body,s=null,c=null,l=null,x&&"HTMLFormElement"in f.a&&(a instanceof FormData?s=a:a instanceof HTMLFormElement&&(c=a,s=new FormData(c))),"string"==typeof a&&(l=a),t.fetchOptions={cache:n.cacheBust&&!j._abortableFetch.polyfill?"no-cache":"default",credentials:"same-origin",headers:n.headers||{},method:"head"===n.method?"HEAD":"GET",mode:"cors",redirect:"follow",signal:i},(s||l)&&(t.fetchOptions.body=s||l),"anonymous"===n.authMode&&(t.useIdentity=!1),t.hasToken=!!(/token=/i.test(r)||n.query&&n.query.token||s&&s.get&&s.get("token")||c&&c.elements.token),!t.hasToken&&u.a.apiKey&&Object(g.a)(r)&&(n.query||(n.query={}),n.query.token=u.a.apiKey,t.hasToken=!0),!t.useIdentity||t.hasToken||t.credentialToken||V(r)||Object(m.o)(i)){e.next=23;break}if("immediate"!==n.authMode){e.next=12;break}return e.next=6,D();case 6:return e.next=8,d.b.getCredential(r,{signal:i});case 8:h=e.sent,t.credential=h,e.next=22;break;case 12:if("no-prompt"!==n.authMode){e.next=21;break}return e.next=15,D();case 15:return e.next=17,d.b.getCredential(r,{prompt:!1,signal:i}).catch((function(){}));case 17:h=e.sent,t.credential=h,e.next=22;break;case 21:d.b&&(h=d.b.findCredential(r));case 22:h&&(t.credentialToken=h.token,t.useSSL=!!h.ssl);case 23:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function V(e){return T.some((function(t){return t.test(e)}))}function N(e){return U.apply(this,arguments)}function U(){return(U=Object(l.a)(o.a.mark((function e(t){var r,n,i,a,c,l,u,h,f,b,v,g,O,_,k,S,T,C,M,R,I;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.params.url,n=t.params.requestOptions,i=t.fetchOptions,a=Object(y.t)(r)||Object(y.u)(r),c=n.responseType||"json",l=a?0:null!=n.timeout?n.timeout:w.timeout,u=!1,a){e.next=23;break}if(t.useSSL&&(r=Object(y.J)(r)),n.cacheBust&&"default"===i.cache&&(r=Object(y.d)(r,"request.preventCache",Date.now())),h=Object(s.a)({},n.query),t.credentialToken&&(h.token=t.credentialToken),f=Object(y.E)(h),Object(p.a)("esri-url-encodes-apostrophe")&&(f=f.replace(/'/g,"%27")),b=r.length+1+f.length,u="delete"===n.method||"post"===n.method||"put"===n.method||!!n.body||b>w.maxUrlLength,(g=n.useProxy||!!Object(y.o)(r))&&(O=Object(y.p)(r),v=O.path,!u&&v.length+1+b>w.maxUrlLength&&(u=!0),O.query&&(h=Object(s.a)(Object(s.a)({},O.query),h))),"HEAD"!==i.method||!u&&!g){e.next=20;break}if(!u){e.next=18;break}if(!(b>w.maxUrlLength)){e.next=17;break}throw E("request:invalid-parameters",new Error("URL exceeds maximum length"),t.params);case 17:throw E("request:invalid-parameters",new Error("cannot use POST request when method is 'head'"),t.params);case 18:if(!g){e.next=20;break}throw E("request:invalid-parameters",new Error("cannot use proxy when method is 'head'"),t.params);case 20:u?(i.method="delete"===n.method?"DELETE":"put"===n.method?"PUT":"POST",n.body?r=Object(y.e)(r,h):(i.body=Object(y.E)(h),i.headers["Content-Type"]="application/x-www-form-urlencoded")):r=Object(y.e)(r,h),g&&(t.useProxy=!0,r="".concat(v,"?").concat(r)),h.token&&x&&i.body instanceof FormData&&((_=i.body).set?_.set("token",h.token):_.append("token",h.token)),n.hasOwnProperty("withCredentials")?t.withCredentials=n.withCredentials:Object(y.q)(r,y.g)||(Object(y.y)(r)||d.b&&(k=d.b.findServerInfo(r))&&k.webTierAuth)&&(t.withCredentials=!0),t.withCredentials&&(i.credentials="include");case 23:if(C=0,M=!1,l>0&&(C=setTimeout((function(){M=!0,t.controller.abort()}),l)),e.prev=25,"native-request-init"!==n.responseType){e.next=30;break}(T=i).url=r,e.next=96;break;case 30:if("image"===n.responseType&&"default"===i.cache&&"GET"===i.method&&!u&&!q(n.headers)&&(a||t.useProxy||!w.proxyUrl||A(r))){e.next=93;break}return e.next=33,j._abortableFetch(r,i);case 33:if(S=e.sent,t.useProxy||P(r),"native"!==n.responseType){e.next=39;break}T=S,e.next=91;break;case 39:if("HEAD"===i.method){e.next=91;break}if(!S.ok){e.next=88;break}e.t0=c,e.next="array-buffer"===e.t0?44:"blob"===e.t0||"image"===e.t0?48:52;break;case 44:return e.next=46,S.arrayBuffer();case 46:return T=e.sent,e.abrupt("break",55);case 48:return e.next=50,S.blob();case 50:return T=e.sent,e.abrupt("break",55);case 52:return e.next=54,S.text();case 54:T=e.sent;case 55:if(C&&(clearTimeout(C),C=0),"json"!==c&&"xml"!==c&&"document"!==c){e.next=68;break}if(!T){e.next=67;break}e.t1=c,e.next="json"===e.t1?60:"xml"===e.t1?62:"document"===e.t1?64:65;break;case 60:return T=JSON.parse(T),e.abrupt("break",65);case 62:return T=H(T,"application/xml"),e.abrupt("break",65);case 64:T=H(T,"text/html");case 65:e.next=68;break;case 67:T=null;case 68:if(!T){e.next=86;break}if("array-buffer"!==c&&"blob"!==c){e.next=81;break}if(R=S.headers.get("Content-Type"),!(/application\/json|text\/plain/i.test(R)&&T["blob"===c?"size":"byteLength"]<=750)){e.next=81;break}return e.prev=72,e.next=75,new Response(T).json();case 75:(I=e.sent).error&&(T=I),e.next=81;break;case 79:e.prev=79,e.t2=e.catch(72);case 81:if(e.t3="image"===c&&T instanceof Blob,!e.t3){e.next=86;break}return e.next=85,Y(URL.createObjectURL(T),t,!0);case 85:T=e.sent;case 86:e.next=91;break;case 88:return e.next=90,S.text();case 90:T=e.sent;case 91:e.next=96;break;case 93:return e.next=95,Y(r,t);case 95:T=e.sent;case 96:e.next=107;break;case 98:if(e.prev=98,e.t4=e.catch(25),"AbortError"!==e.t4.name){e.next=104;break}if(!M){e.next=103;break}throw new Error("Timeout exceeded");case 103:throw Object(m.f)("Request canceled");case 104:if(!S&&e.t4 instanceof TypeError&&w.proxyUrl&&!n.body&&"delete"!==n.method&&"head"!==n.method&&"post"!==n.method&&"put"!==n.method&&!t.useProxy&&!A(r)){e.next=106;break}throw e.t4;case 106:t.redoRequest=!0,Object(y.c)({proxyUrl:w.proxyUrl,urlPrefix:Object(y.m)(r)});case 107:return e.prev=107,C&&clearTimeout(C),e.finish(107);case 110:return e.abrupt("return",[S,T]);case 111:case"end":return e.stop()}}),e,null,[[25,98,107,110],[72,79]])})))).apply(this,arguments)}function B(e,t){return G.apply(this,arguments)}function G(){return(G=Object(l.a)(o.a.mark((function e(t,r){var n,i;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null==t.responseData){e.next=2;break}return e.abrupt("return",t.responseData);case 2:if(t.headers&&(r.requestOptions.headers=Object(s.a)(Object(s.a)({},r.requestOptions.headers),t.headers)),t.query&&(r.requestOptions.query=Object(s.a)(Object(s.a)({},r.requestOptions.query),t.query)),!t.before){e.next=15;break}return e.prev=3,e.next=6,t.before(r);case 6:i=e.sent,e.next=12;break;case 9:e.prev=9,e.t0=e.catch(3),n=E("request:interceptor",e.t0,r);case 12:if((i instanceof Error||i instanceof h.a)&&(n=E("request:interceptor",i,r)),!n){e.next=14;break}throw t.error&&t.error(n),n;case 14:return e.abrupt("return",i);case 15:case"end":return e.stop()}}),e,null,[[3,9]])})))).apply(this,arguments)}function q(e){if(e){var t,r=Object(c.a)(Object.getOwnPropertyNames(e));try{for(r.s();!(t=r.n()).done;){if(e[t.value])return!0}}catch(n){r.e(n)}finally{r.f()}}return!1}function H(e,t){var r;try{r=(new DOMParser).parseFromString(e,t)}catch(n){}if(!r||r.getElementsByTagName("parsererror").length)throw new SyntaxError("XML Parse error");return r}function W(e){return Q.apply(this,arguments)}function Q(){return(Q=Object(l.a)(o.a.mark((function e(t){var r,n,a,s,c,l,u,h,f,p,b,v,m;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,L(t);case 2:e.prev=2;case 3:return e.next=5,N(t);case 5:c=e.sent,l=Object(i.a)(c,2),a=l[0],s=l[1];case 9:return e.next=11,Z(t,a,s);case 11:if(!e.sent){e.next=3;break}case 12:e.next=18;break;case 14:throw e.prev=14,e.t0=e.catch(2),(u=E("request:server",e.t0,t.params,a)).details.ssl=t.useSSL,t.interceptor&&t.interceptor.error&&t.interceptor.error(u),u;case 18:return h=t.params.url,!/\/sharing\/rest\/(accounts|portals)\/self/i.test(h)||t.hasToken||t.credentialToken||null==(r=s)||null==(n=r.user)||!n.username||Object(y.y)(h)||(f=Object(y.m)(h,!0))&&w.trustedServers.push(f),(p=t.credential)&&d.b&&(b=d.b.findServerInfo(p.server),(v=b&&b.owningSystemUrl)&&(v=v.replace(/\/?$/,"/sharing"),(m=d.b.findCredential(v,p.userId))&&-1===d.b._getIdenticalSvcIdx(v,m)&&m.resources.unshift(v))),e.abrupt("return",{data:s,getHeader:a?function(e){return a.headers.get(e)}:C,requestOptions:t.params.requestOptions,ssl:t.useSSL,url:t.params.url});case 23:case"end":return e.stop()}}),e,null,[[2,14]])})))).apply(this,arguments)}function Z(e,t,r){return X.apply(this,arguments)}function X(){return(X=Object(l.a)(o.a.mark((function e(t,r,n){var i,a,s,c,l,u,h;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.redoRequest){e.next=2;break}return e.abrupt("return",(t.redoRequest=!1,!1));case 2:if(i=t.params.requestOptions,r&&"native"!==i.responseType&&"native-request-init"!==i.responseType){e.next=5;break}return e.abrupt("return",!0);case 5:if(r.ok){e.next=7;break}throw(a=new Error("Unable to load ".concat(r.url," status: ").concat(r.status)))[M]=n,a;case 7:if(null!=n&&n.error&&(a=n.error),a&&(s=Number(a.code),c=a.hasOwnProperty("subcode")?Number(a.subcode):null,l=(l=a.messageCode)&&l.toUpperCase()),u=i.authMode,403!==s||!(4===c||a.message&&a.message.toLowerCase().indexOf("ssl")>-1&&-1===a.message.toLowerCase().indexOf("permission"))){e.next=14;break}if(t.useSSL){e.next=12;break}return e.abrupt("return",(t.useSSL=!0,!1));case 12:e.next=29;break;case 14:if(t.hasToken||!t.useIdentity||"no-prompt"===u&&498!==s||-1===k.indexOf(s)||V(t.params.url)||!(403!==s||-1===S.indexOf(l)&&(null==c||2===c&&t.credentialToken))){e.next=29;break}return e.next=17,D();case 17:return e.prev=17,e.next=20,d.b.getCredential(t.params.url,{error:E("request:server",a,t.params),prompt:"no-prompt"!==u,signal:t.controller.signal,token:t.credentialToken});case 20:return h=e.sent,e.abrupt("return",(t.credential=h,t.credentialToken=h.token,t.useSSL=t.useSSL||h.ssl,!1));case 24:if(e.prev=24,e.t0=e.catch(17),"no-prompt"!==u){e.next=28;break}return e.abrupt("return",(t.credential=null,t.credentialToken=null,!1));case 28:a=e.t0;case 29:if(!a){e.next=31;break}throw a;case 31:return e.abrupt("return",!0);case 32:case"end":return e.stop()}}),e,null,[[17,24]])})))).apply(this,arguments)}function Y(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=t.controller.signal,i=new Image;return t.withCredentials?i.crossOrigin="use-credentials":i.crossOrigin="anonymous",i.alt="",i.src=e,Object(O.a)(i,e,r,n)}j._abortableFetch=null,j._corsServers=["https://server.arcgisonline.com","https://services.arcgisonline.com"],t.default=j},function(e,t,r){"use strict";r.d(t,"a",(function(){return p})),r.d(t,"b",(function(){return m})),r.d(t,"c",(function(){return b})),r.d(t,"d",(function(){return l})),r.d(t,"e",(function(){return u})),r.d(t,"f",(function(){return d})),r.d(t,"g",(function(){return f})),r.d(t,"h",(function(){return h}));var n=r(66),i=r(160),a=r(254),o=r(56),s=r(158),c=r(176);function l(e){return void 0!==e.xmin&&void 0!==e.ymin&&void 0!==e.xmax&&void 0!==e.ymax}function u(e){return void 0!==e.points}function d(e){return void 0!==e.x&&void 0!==e.y}function h(e){return void 0!==e.paths}function f(e){return void 0!==e.rings}function p(e){return e?e instanceof i.a?e:d(e)?o.a.fromJSON(e):h(e)?c.a.fromJSON(e):f(e)?s.a.fromJSON(e):u(e)?a.a.fromJSON(e):l(e)?n.a.fromJSON(e):null:null}function b(e){return e?d(e)?"esriGeometryPoint":h(e)?"esriGeometryPolyline":f(e)?"esriGeometryPolygon":l(e)?"esriGeometryEnvelope":u(e)?"esriGeometryMultipoint":null:null}var v={esriGeometryPoint:o.a,esriGeometryPolyline:c.a,esriGeometryPolygon:s.a,esriGeometryEnvelope:n.a,esriGeometryMultipoint:a.a};function m(e){return e&&v[e]||null}},function(e,t,r){"use strict";r.d(t,"a",(function(){return v})),r.d(t,"b",(function(){return p})),r.d(t,"c",(function(){return h})),r.d(t,"d",(function(){return c})),r.d(t,"e",(function(){return s})),r.d(t,"f",(function(){return b})),r.d(t,"g",(function(){return y})),r.d(t,"h",(function(){return l})),r.d(t,"i",(function(){return f})),r.d(t,"j",(function(){return k})),r.d(t,"k",(function(){return g})),r.d(t,"l",(function(){return j})),r.d(t,"m",(function(){return w})),r.d(t,"n",(function(){return u})),r.d(t,"o",(function(){return o}));var n=r(2),i=r(3),a=r(467);function o(e,t){return t?e.filter((function(e,r,n){return n.findIndex(t.bind(null,e))===r})):e.filter((function(e,t,r){return r.indexOf(e)===t}))}function s(e,t,r){if(Object(i.i)(e)&&Object(i.i)(t))return!0;if(Object(i.i)(e)||Object(i.i)(t)||e.length!==t.length)return!1;if(r){for(var n=0;n<e.length;n++)if(!r(e[n],t[n]))return!1}else for(var a=0;a<e.length;a++)if(e[a]!==t[a])return!1;return!0}function c(e,t,r){var n,i;return r?(n=t.filter((function(t){return!e.some((function(e){return r(e,t)}))})),i=e.filter((function(e){return!t.some((function(t){return r(t,e)}))}))):(n=t.filter((function(t){return!e.includes(t)})),i=e.filter((function(e){return!t.includes(e)}))),{added:n,removed:i}}function l(e,t,r){return e&&t?r?e.filter((function(e){return t.findIndex((function(t){return r(e,t)}))>-1})):e.filter((function(e){return t.indexOf(e)>-1})):[]}function u(e,t){var r=e.length;if(0===r)return[];for(var n=[],i=0;i<r;i+=t)n.push(e.slice(i,i+t));return n}var d=!!Array.prototype.fill;function h(e,t){if(d)return new Array(e).fill(t);for(var r=new Array(e),n=0;n<e;n++)r[n]=t;return r}function f(e,t){void 0===t&&(t=e,e=0);for(var r=new Array(t-e),n=e;n<t;n++)r[n-e]=n;return r}function p(e,t,r){for(var n=e.length,i=0,a=n-1;i<a;){var o=i+Math.floor((a-i)/2);t>e[o]?i=o+1:a=o}var s=e[i];return r?t>=e[n-1]?-1:s===t?i:i-1:s===t?i:-1}function b(e){return e.reduce((function(e,t){return e.concat(t||[])}),[])}var v=function e(){Object(n.a)(this,e),this.last=0},m=new v;function y(e,t,r,n){n=n||m;for(var i=Math.max(0,n.last-10),a=i;a<r;++a)if(e[a]===t)return n.last=a,a;for(var o=Math.min(i,r),s=0;s<o;++s)if(e[s]===t)return n.last=s,s;return-1}function g(e,t,r,n){var i=null==r?e.length:r,a=y(e,t,i,n);if(-1!==a)return e[a]=e[i-1],null==r&&e.pop(),t}var O=new Set;function j(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e.length,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:t.length,i=arguments.length>4?arguments[4]:void 0,a=arguments.length>5?arguments[5]:void 0;if(0===n||0===r)return r;O.clear();for(var o=0;o<n;++o)O.add(t[o]);i=i||m;for(var s=Math.max(0,i.last-10),c=s;c<r;++c)if(O.has(e[c])&&(a&&a.push(e[c]),O.delete(e[c]),e[c]=e[r-1],--r,--c,0===O.size||0===r))return O.clear(),r;for(var l=0;l<s;++l)if(O.has(e[l])&&(a&&a.push(e[l]),O.delete(e[l]),e[l]=e[r-1],--r,--l,0===O.size||0===r))return O.clear(),r;return O.clear(),r}function _(e){return e?(x.seed=e,function(){return x.getFloat()}):Math.random}function w(e,t){for(var r=_(t),n=e.length-1;n>0;n--){var i=Math.floor(r()*(n+1)),a=e[n];e[n]=e[i],e[i]=a}return e}var x=new a.a;function k(e,t){var r=e.indexOf(t);return-1!==r?(e.splice(r,1),t):null}},function(e,t,r){"use strict";r.d(t,"a",(function(){return k})),r.d(t,"b",(function(){return P})),r.d(t,"c",(function(){return j})),r.d(t,"d",(function(){return O})),r.d(t,"e",(function(){return S})),r.d(t,"f",(function(){return _})),r.d(t,"g",(function(){return w})),r.d(t,"h",(function(){return C})),r.d(t,"i",(function(){return f})),r.d(t,"j",(function(){return m})),r.d(t,"k",(function(){return T})),r.d(t,"l",(function(){return x}));var n=r(33),i=r(20),a=r(3),o=r(4),s=r(9),c=r(34),l=r(230),u=r(46),d=r(136),h=Object(c.h)();function f(e,t,r,n,i,a,o){if(!Object(d.e)(t))if(e.boundingInfo){Object(u.a)(0===e.primitiveType);var s=r.tolerance;b(e.boundingInfo,n,i,s,a,o)}else{var c=e.indices.get("position"),l=e.vertexAttributes.get("position");m(n,i,0,c.length/3,c,l,void 0,a,o)}}var p=Object(s.e)();function b(e,t,r,n,i,o){if(!Object(a.i)(e)){var s=j(t,r,p);if(Object(c.D)(h,e.getBBMin()),Object(c.C)(h,e.getBBMax()),Object(a.j)(i)&&i.applyToAabb(h),_(h,t,s,n)){var l=e.primitiveIndices,u=e.indices,d=e.position,f=l?l.length:u.length/3;if(f>A){var v=e.getChildren();if(void 0!==v){for(var y=0;y<8;++y)void 0!==v[y]&&b(v[y],t,r,n,i,o);return}}m(t,r,0,f,u,d,l,i,o)}}}var v=Object(s.e)();function m(e,t,r,i,o,s,c,l,u){if(c)return function(e,t,r,i,o,s,c,l,u){for(var d=s.data,h=s.stride||s.size,f=e[0],p=e[1],b=e[2],m=t[0]-f,y=t[1]-p,g=t[2]-b,j=r;j<i;++j){var _,w,x,k,S,T,C=c[j],M=3*C,P=h*o[M++],A=d[P++],E=d[P++],R=d[P];P=h*o[M++];var I=d[P++],D=d[P++],F=d[P];P=h*o[M];var L=d[P++],z=d[P++],V=d[P];Object(a.j)(l)&&(_=l.applyToVertex(A,E,R,j),A=(w=Object(n.a)(_,3))[0],E=w[1],R=w[2],x=l.applyToVertex(I,D,F,j),I=(k=Object(n.a)(x,3))[0],D=k[1],F=k[2],S=l.applyToVertex(L,z,V,j),L=(T=Object(n.a)(S,3))[0],z=T[1],V=T[2]);var N=I-A,U=D-E,B=F-R,G=L-A,q=z-E,H=V-R,W=y*H-q*g,Q=g*G-H*m,Z=m*q-G*y,X=N*W+U*Q+B*Z;if(!(Math.abs(X)<=Number.EPSILON)){var Y=f-A,$=p-E,J=b-R,K=Y*W+$*Q+J*Z;if(X>0){if(K<0||K>X)continue}else if(K>0||K<X)continue;var ee=$*B-U*J,te=J*N-B*Y,re=Y*U-N*$,ne=m*ee+y*te+g*re;if(X>0){if(ne<0||K+ne>X)continue}else if(ne>0||K+ne<X)continue;var ie=(G*ee+q*te+H*re)/X;ie>=0&&u(ie,O(N,U,B,G,q,H,v),C)}}}(e,t,r,i,o,s,c,l,u);for(var d=s.data,h=s.stride||s.size,f=e[0],p=e[1],b=e[2],m=t[0]-f,y=t[1]-p,g=t[2]-b,j=r,_=3*r;j<i;++j){var w,x,k,S,T,C,M=h*o[_++],P=d[M++],A=d[M++],E=d[M];M=h*o[_++];var R=d[M++],I=d[M++],D=d[M];M=h*o[_++];var F=d[M++],L=d[M++],z=d[M];Object(a.j)(l)&&(w=l.applyToVertex(P,A,E,j),P=(x=Object(n.a)(w,3))[0],A=x[1],E=x[2],k=l.applyToVertex(R,I,D,j),R=(S=Object(n.a)(k,3))[0],I=S[1],D=S[2],T=l.applyToVertex(F,L,z,j),F=(C=Object(n.a)(T,3))[0],L=C[1],z=C[2]);var V=R-P,N=I-A,U=D-E,B=F-P,G=L-A,q=z-E,H=y*q-G*g,W=g*B-q*m,Q=m*G-B*y,Z=V*H+N*W+U*Q;if(!(Math.abs(Z)<=Number.EPSILON)){var X=f-P,Y=p-A,$=b-E,J=X*H+Y*W+$*Q;if(Z>0){if(J<0||J>Z)continue}else if(J>0||J<Z)continue;var K=Y*U-N*$,ee=$*V-U*X,te=X*N-V*Y,re=m*K+y*ee+g*te;if(Z>0){if(re<0||J+re>Z)continue}else if(re>0||J+re<Z)continue;var ne=(B*K+G*ee+q*te)/Z;ne>=0&&u(ne,O(V,N,U,B,G,q,v),j)}}}var y=Object(s.e)(),g=Object(s.e)();function O(e,t,r,n,i,a,s){return Object(o.y)(y,e,t,r),Object(o.y)(g,n,i,a),Object(o.i)(s,y,g),Object(o.t)(s,s),s}function j(e,t,r){return Object(o.y)(r,1/(t[0]-e[0]),1/(t[1]-e[1]),1/(t[2]-e[2]))}function _(e,t,r,n){return w(e,t,r,n,1/0)}function w(e,t,r,n,i){var a=(e[0]-n-t[0])*r[0],o=(e[3]+n-t[0])*r[0],s=Math.min(a,o),c=Math.max(a,o),l=(e[1]-n-t[1])*r[1],u=(e[4]+n-t[1])*r[1];if((c=Math.min(c,Math.max(l,u)))<0)return!1;if((s=Math.max(s,Math.min(l,u)))>c)return!1;var d=(e[2]-n-t[2])*r[2],h=(e[5]+n-t[2])*r[2];return!((c=Math.min(c,Math.max(d,h)))<0)&&(!((s=Math.max(s,Math.min(d,h)))>c)&&s<i)}function x(e,t,r,n,a){var o=(r.screenLength||0)*e.pixelRatio;a&&(o=Object(l.f)(o,n,t,a));var s=o*Math.tan(.5*e.fovY)/(.5*e.fullHeight);return Object(i.e)(s*t,r.minWorldLength||0,null!=r.maxWorldLength?r.maxWorldLength:1/0)}function k(e,t,r){if(e){var n=e.parameters,i=e.paddingPixelsOverride;t.setUniform4f(r,n.divisor,n.offset,n.minPixelSize,i)}}function S(e,t){var r=t?S(t):{};for(var n in e){var i=e[n];i&&i.forEach&&(i=M(i)),null==i&&n in r||(r[n]=i)}return r}function T(e,t){var r=!1;for(var n in t){var i=t[n];void 0!==i&&(r=!0,Array.isArray(i)?e[n]=i.slice():e[n]=i)}return r}function C(e,t,r,n,a){if(t.options.selectionMode){for(var o=e.vertexAttributes.get("position").data,s=e.vertexAttributes.get("size"),c=s&&s.data[0],l=r[0],u=r[1],d=((c+n)/2+4)*e.screenToWorldRatio,h=Number.MAX_VALUE,f=0;f<o.length-5;f+=3){var p=o[f],b=o[f+1],v=l-p,m=u-b,y=o[f+3]-p,g=o[f+4]-b,O=Object(i.e)((y*v+g*m)/(y*y+g*g),0,1),j=y*O-v,_=g*O-m,w=j*j+_*_;w<h&&(h=w)}h<d*d&&a()}}function M(e){var t=[];return e.forEach((function(e){return t.push(e)})),t}var P={multiply:1,ignore:2,replace:3,tint:4},A=1e3},function(e,t,r){"use strict";r.d(t,"a",(function(){return _})),r.d(t,"b",(function(){return C})),r.d(t,"c",(function(){return E})),r.d(t,"d",(function(){return O})),r.d(t,"e",(function(){return g})),r.d(t,"f",(function(){return I})),r.d(t,"g",(function(){return L})),r.d(t,"h",(function(){return ue})),r.d(t,"i",(function(){return y})),r.d(t,"j",(function(){return p})),r.d(t,"k",(function(){return v})),r.d(t,"l",(function(){return S})),r.d(t,"m",(function(){return F})),r.d(t,"n",(function(){return U})),r.d(t,"o",(function(){return ee})),r.d(t,"p",(function(){return te})),r.d(t,"q",(function(){return J})),r.d(t,"r",(function(){return de})),r.d(t,"s",(function(){return re})),r.d(t,"t",(function(){return j})),r.d(t,"u",(function(){return ne})),r.d(t,"v",(function(){return le}));var n=r(8),i=r.n(n),a=r(16),o=r(13),s=r(22),c=r(3),l=r(113),u=r(249),d=r(153),h=["field","field2","field3","normalizationField","rotationInfo.field","proportionalSymbolInfo.field","proportionalSymbolInfo.normalizationField","colorInfo.field","colorInfo.normalizationField"],f=["field","normalizationField"];function p(e,t){if(null!=e&&null!=t){var r,n=Object(o.a)(Array.isArray(e)?e:[e]);try{for(n.s();!(r=n.n()).done;){var i=r.value;if(b(h,i,t),"visualVariables"in i&&i.visualVariables){var a,s=Object(o.a)(i.visualVariables);try{for(s.s();!(a=s.n()).done;){var c=a.value;b(f,c,t)}}catch(l){s.e(l)}finally{s.f()}}}}catch(l){n.e(l)}finally{n.f()}}}function b(e,t,r){if(e){var n,i=Object(o.a)(e);try{for(i.s();!(n=i.n()).done;){var a=n.value,s=Object(l.b)(a,t),c=s&&"function"!=typeof s&&r.get(s);c&&Object(l.c)(a,c.name,t)}}catch(u){i.e(u)}finally{i.f()}}}function v(e,t){if(null!=e&&null!=t&&t.fields.length)if("startField"in e){var r=t.get(e.startField),n=t.get(e.endField);e.startField=r&&r.name||null,e.endField=n&&n.name||null}else{var i=t.get(e.startTimeField),a=t.get(e.endTimeField);e.startTimeField=i&&i.name||null,e.endTimeField=a&&a.name||null}}var m=new Set;function y(e,t){return e&&t?(m.clear(),g(m,e,t),Array.from(m).sort()):[]}function g(e,t,r){var n;if(r)if(null!=t&&null!=(n=t.fields)&&n.length)if(r.includes("*")){var i,a=Object(o.a)(t.fields);try{for(a.s();!(i=a.n()).done;){var s=i.value.name;e.add(s)}}catch(f){a.e(f)}finally{a.f()}}else{var c,l=Object(o.a)(r);try{for(l.s();!(c=l.n()).done;){O(e,t,c.value)}}catch(f){l.e(f)}finally{l.f()}}else{if(r.includes("*"))return e.clear(),void e.add("*");var u,d=Object(o.a)(r);try{for(d.s();!(u=d.n()).done;){var h=u.value;e.add(h)}}catch(f){d.e(f)}finally{d.f()}}}function O(e,t,r){if("string"==typeof r)if(t){var n=t.get(r);n&&e.add(n.name)}else e.add(r)}function j(e,t){return Object(c.i)(t)||Object(c.i)(e)?[]:t.includes("*")?e.fields.map((function(e){return e.name})):t}function _(e,t,r){return w.apply(this,arguments)}function w(){return(w=Object(a.a)(i.a.mark((function e(t,r,n){var a,s,c,l,u,h;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,Object(d.e)();case 4:a=e.sent,s=a.arcadeUtils,c=s.extractFieldNames(n),l=Object(o.a)(c);try{for(l.s();!(u=l.n()).done;)h=u.value,O(t,r,h)}catch(i){l.e(i)}finally{l.f()}case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function x(e,t,r){return k.apply(this,arguments)}function k(){return(k=Object(a.a)(i.a.mark((function e(t,n,a){var o;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!a||"1=1"===a){e.next=7;break}return e.next=3,r.e(1).then(r.bind(null,683));case 3:if((o=e.sent.WhereClause.create(a,n)).isStandardized){e.next=6;break}throw new s.a("fieldUtils:collectFilterFields","Where clause is not standardized");case 6:g(t,n,o.fieldNames);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function S(e){var t=e.displayField,r=e.fields;return t||(r&&r.length?T(r,"name-or-title")||T(r,"unique-identifier")||T(r,"type-or-category")||function(e){var t,r=Object(o.a)(e);try{for(r.s();!(t=r.n()).done;){var n=t.value;if(n&&n.name){var i=n.name.toLowerCase();if(i.indexOf("name")>-1||i.indexOf("title")>-1)return n.name}}}catch(a){r.e(a)}finally{r.f()}return null}(r):null)}function T(e,t){var r,n=Object(o.a)(e);try{for(n.s();!(r=n.n()).done;){var i=r.value;if(i&&i.valueType&&i.valueType===t)return i.name}}catch(a){n.e(a)}finally{n.f()}return null}function C(e,t){return M.apply(this,arguments)}function M(){return(M=Object(a.a)(i.a.mark((function e(t,r){var n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r){e.next=2;break}return e.abrupt("return");case 2:return n=Object(l.b)("elevationInfo.featureExpressionInfo",r),e.abrupt("return",n?n.collectRequiredFields(t,r.fieldsIndex):void 0);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function P(e,t,r){return A.apply(this,arguments)}function A(){return(A=Object(a.a)(i.a.mark((function e(t,r,n){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n.outStatistic.onStatisticValueExpression?_(t,r,n.outStatistic.onStatisticValueExpression):t.add(n.outStatistic.onStatisticField);case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function E(e,t,r){return R.apply(this,arguments)}function R(){return(R=Object(a.a)(i.a.mark((function e(t,r,n){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=r&&n&&"cluster"===n.type&&n.fields,!e.t0){e.next=4;break}return e.next=4,Promise.all(n.fields.map((function(e){return P(t,r.fieldsIndex,e)})));case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function I(e,t,r){return D.apply(this,arguments)}function D(){return(D=Object(a.a)(i.a.mark((function e(t,r,n){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=r,!e.t0){e.next=8;break}if(r.timeInfo&&Object(c.j)(n)&&n.timeExtent&&g(t,r.fieldsIndex,[r.timeInfo.startField,r.timeInfo.endField]),r.floorInfo&&g(t,r.fieldsIndex,[r.floorInfo.floorField]),e.t1=Object(c.j)(n)&&Object(c.j)(n.where),!e.t1){e.next=8;break}return e.next=8,x(t,r.fieldsIndex,n.where);case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function F(e){if(!e)return[];var t="editFieldsInfo"in e&&e.editFieldsInfo;return t?y(e.fieldsIndex,[t&&t.creatorField,t&&t.creationDateField,t&&t.editorField,t&&t.editDateField]):[]}function L(e,t){return z.apply(this,arguments)}function z(){return(z=Object(a.a)(i.a.mark((function e(t,r){var n,a;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=r.labelingInfo,a=r.fieldsIndex,e.t0=n&&n.length,!e.t0){e.next=5;break}return e.next=5,Promise.all(n.map((function(e){return V(t,a,e)})));case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function V(e,t,r){return N.apply(this,arguments)}function N(){return(N=Object(a.a)(i.a.mark((function e(t,r,n){var a,o,s;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n){e.next=2;break}return e.abrupt("return");case 2:if(a=n.getLabelExpression(),o=n.where,"arcade"!==a.type){e.next=8;break}return e.next=6,_(t,r,a.expression);case 6:e.next=10;break;case 8:(s=a.expression.match(/{[^}]*}/g))&&s.forEach((function(e){O(t,r,e.slice(1,-1))}));case 10:return e.next=12,x(t,r,o);case 12:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function U(e){var t=e.defaultValue;return void 0!==t&&X(e,t)?t:e.nullable?null:void 0}function B(e){return"number"==typeof e&&!isNaN(e)&&isFinite(e)}function G(e){return null===e||B(e)}var q="isInteger"in Number?Number.isInteger:function(e){return"number"==typeof e&&isFinite(e)&&Math.floor(e)===e};function H(e){return null===e||q(e)}function W(e){return null!=e&&"string"==typeof e}function Q(e){return null===e||W(e)}function Z(){return!0}function X(e,t){var r;switch(e.type){case"date":case"integer":case"long":case"small-integer":case"esriFieldTypeDate":case"esriFieldTypeInteger":case"esriFieldTypeLong":case"esriFieldTypeSmallInteger":r=e.nullable?H:q;break;case"double":case"single":case"esriFieldTypeSingle":case"esriFieldTypeDouble":r=e.nullable?G:B;break;case"string":case"esriFieldTypeString":r=e.nullable?Q:W;break;default:r=Z}return 1===arguments.length?r:r(t)}var Y,$,J=["integer","small-integer","single","double"],K=new Set([].concat(J,["esriFieldTypeInteger","esriFieldTypeSmallInteger","esriFieldTypeSingle","esriFieldTypeDouble"]));function ee(e){return null!=e&&K.has(e.type)}function te(e){return null!=e&&("string"===e.type||"esriFieldTypeString"===e.type)}function re(e){return null==e||"number"==typeof e&&isNaN(e)?null:e}function ne(e,t){return e.nullable&&null===t?null:ee(e)&&!function(e,t){var r="string"==typeof e?ie(e):e;return!!r&&(r.isInteger?q(t)&&t>=r.min&&t<=r.max:t>=r.min&&t<=r.max)}(e.type,Number(t))?Y.OUT_OF_RANGE:X(e,t)?e.domain?Object(u.e)(e.domain,t):null:$.INVALID_TYPE}function ie(e){switch(e){case"esriFieldTypeSmallInteger":case"small-integer":return ae;case"esriFieldTypeInteger":case"integer":return oe;case"esriFieldTypeSingle":case"single":return se;case"esriFieldTypeDouble":case"double":return ce}}(Y||(Y={})).OUT_OF_RANGE="numeric-range-validation-error::out-of-range",function(e){e.INVALID_TYPE="type-validation-error::invalid-type"}($||($={}));var ae={min:-32768,max:32767,isInteger:!0},oe={min:-2147483648,max:2147483647,isInteger:!0},se={min:-34e37,max:12e37,isInteger:!1},ce={min:-Number.MAX_VALUE,max:Number.MAX_VALUE,isInteger:!1};function le(e,t,r){switch(e){case u.a.INVALID_CODED_VALUE:return"Value ".concat(r," is not in the coded domain - field: ").concat(t.name,", domain: ").concat(JSON.stringify(t.domain));case u.a.VALUE_OUT_OF_RANGE:return"Value ".concat(r," is out of the range of valid values - field: ").concat(t.name,", domain: ").concat(JSON.stringify(t.domain));case $.INVALID_TYPE:return"Value ".concat(r," is not a valid value for the field type - field: ").concat(t.name,", type: ").concat(t.type,", nullable: ").concat(t.nullable);case Y.OUT_OF_RANGE:var n=ie(t.type),i=n.min,a=n.max;return"Value ".concat(r," is out of range for the number type - field: ").concat(t.name,", type: ").concat(t.type,", value range is ").concat(i," to ").concat(a)}}function ue(e,t){return!de(e,t,null)}function de(e,t,r){if(!t||!t.attributes||!e){if(Object(c.j)(r)){var n,i=Object(o.a)(e);try{for(i.s();!(n=i.n()).done;){var a=n.value;r.add(a)}}catch(f){i.e(f)}finally{i.f()}}return!0}var s,l=t.attributes,u=!1,d=Object(o.a)(e);try{for(d.s();!(s=d.n()).done;){var h=s.value;if(!(h in l)){if(u=!0,!Object(c.j)(r))break;r.add(h)}}}catch(f){d.e(f)}finally{d.f()}return u}},function(e,t,r){"use strict";var n=r(2),i=r(5),a=r(15),o=r(3),s=r(122),c=r(92),l=a.a.getLogger("esri.views.webgl.VertexArrayObject"),u=function(){function e(t,r,i,a){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;Object(n.a)(this,e),this._context=t,this._locations=r,this._layout=i,this._buffers=a,this._indexBuffer=o,this._glName=null,this._initialized=!1,t.instanceCounter.increment(s.b.VAO,this)}return Object(i.a)(e,[{key:"glName",get:function(){return this._glName}},{key:"vertexBuffers",get:function(){return this._buffers}},{key:"indexBuffer",get:function(){return this._indexBuffer}},{key:"size",get:function(){var e=this;return Object.keys(this._buffers).reduce((function(t,r){return t+e._buffers[r].size}),Object(o.j)(this._indexBuffer)?this._indexBuffer.size:0)}},{key:"layout",get:function(){return this._layout}},{key:"locations",get:function(){return this._locations}},{key:"dispose",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(this._context){if(this._glName){var t,r,n=null==(t=this._context)||null==(r=t.capabilities)?void 0:r.vao;n?(n.deleteVertexArray(this._glName),this._glName=null):l.warn("Leaked WebGL VAO")}if(this._context.getBoundVAO()===this&&this._context.bindVAO(null),e){for(var i in this._buffers)this._buffers[i].dispose(),delete this._buffers[i];this._indexBuffer=Object(o.f)(this._indexBuffer)}this._context.instanceCounter.decrement(s.b.VAO,this),this._context=null}else(this._glName||e&&Object.getOwnPropertyNames(this._buffers).length>0)&&l.warn("Leaked WebGL VAO")}},{key:"initialize",value:function(){if(!this._initialized){var e=this._context.capabilities.vao;if(e){var t=e.createVertexArray();e.bindVertexArray(t),this._bindLayout(),e.bindVertexArray(null),this._glName=t}this._initialized=!0}}},{key:"bind",value:function(){this.initialize();var e=this._context.capabilities.vao;e?e.bindVertexArray(this.glName):(this._context.bindVAO(null),this._bindLayout())}},{key:"_bindLayout",value:function(){var e=this._buffers,t=this._layout,r=this._indexBuffer;e||l.error("Vertex buffer dictionary is empty!");var n=this._context.gl;for(var i in e){var a=e[i];a||l.error("Vertex buffer is uninitialized!");var s=t[i];s||l.error("Vertex element descriptor is empty!"),Object(c.a)(this._context,this._locations,a,s)}Object(o.j)(r)&&(this._context.capabilities.vao?n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,r.glName):this._context.bindBuffer(r))}},{key:"unbind",value:function(){this.initialize();var e=this._context.capabilities.vao;e?e.bindVertexArray(null):this._unbindLayout()}},{key:"_unbindLayout",value:function(){var e=this._buffers,t=this._layout;for(var r in e||l.error("Vertex buffer dictionary is empty!"),e){var n=e[r];n||l.error("Vertex buffer is uninitialized!");var i=t[r];Object(c.e)(this._context,this._locations,n,i)}Object(o.j)(this._indexBuffer)&&this._context.unbindBuffer(this._indexBuffer.bufferType)}}]),e}();t.a=u},function(e,t,r){"use strict";r.d(t,"a",(function(){return g})),r.d(t,"b",(function(){return M})),r.d(t,"c",(function(){return S})),r.d(t,"d",(function(){return P})),r.d(t,"e",(function(){return _})),r.d(t,"f",(function(){return C})),r.d(t,"g",(function(){return x})),r.d(t,"h",(function(){return A})),r.d(t,"i",(function(){return k})),r.d(t,"j",(function(){return w})),r.d(t,"k",(function(){return T}));var n=r(13),i=r(20),a=r(3),o=r(26),s=r(31),c=r(38),l=r(9),u=r(54),d=r(43),h=r(51),f=r(34),p=r(40),b=r(507),v=r(235),m=r(202),y=r(342);function g(e,t){if("point"===e.type)return j(e,t,!1);if(Object(y.d)(e))switch(e.type){case"extent":return j(e.center,t,!1);case"polygon":return j(e.centroid,t,!1);case"polyline":return j(O(e),t,!0);case"mesh":return j(e.origin,t,!1)}else switch(e.type){case"extent":return j(function(e){var t=Object(i.j)(e.zmin);return Object(m.j)(.5*(e.xmax+e.xmin),.5*(e.ymax+e.ymin),t?.5*(e.zmax+e.zmin):void 0,e.spatialReference)}(e),t,!0);case"polygon":return j(function(e){var t=e.rings[0];if(!t||0===t.length)return null;var r=Object(b.b)(e.rings,e.hasZ);return Object(m.j)(r[0],r[1],r[2],e.spatialReference)}(e),t,!0);case"polyline":return j(O(e),t,!0)}}function O(e){var t=e.paths[0];if(!t||0===t.length)return null;var r=Object(v.d)(t,Object(v.c)(t)/2);return Object(m.j)(r[0],r[1],r[2],e.spatialReference)}function j(e,t,r){var n=r?e:Object(y.a)(e);return t&&e?Object(h.t)(e,n,t)?n:null:n}function _(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;if(e){t||(t=Object(p.k)());var i=e,a=.5*i.width*(r-1),o=.5*i.height*(r-1);return i.width<1e-7*i.height?a+=o/20:i.height<1e-7*i.width&&(o+=a/20),Object(u.l)(t,i.xmin-a-n,i.ymin-o-n,i.xmax+a+n,i.ymax+o+n),t}return null}function w(e,t){for(var r=0;r<e.geometries.length;++r){var n=e.geometries[r].getMutableAttribute("auxpos1");n&&n.data[3]!==t&&(n.data[3]=t,e.geometryVertexAttrsUpdated(r))}}function x(e,t){var r=Object(d.f)(d.a);return Object(a.j)(e)&&(r[0]=e[0],r[1]=e[1],r[2]=e[2]),Object(a.j)(t)?r[3]=t:Object(a.j)(e)&&e.length>3&&(r[3]=e[3]),r}function k(e,t,r,n,i){for(var o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[0,0,0,0],s=0;s<3;++s)Object(a.j)(e)&&null!=e[s]?o[s]=e[s]:Object(a.j)(r)&&null!=r[s]?o[s]=r[s]:o[s]=i[s];return Object(a.j)(t)?o[3]=t:Object(a.j)(n)?o[3]=n:o[3]=i[3],o}function S(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:l.a,t=arguments.length>1?arguments[1]:void 0,r=arguments.length>2?arguments[2]:void 0,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,i=new Array(3);if(Object(a.i)(t)||Object(a.i)(r))i[0]=1,i[1]=1,i[2]=1;else{for(var o,s=0,c=2;c>=0;c--){var u=e[c],d=void 0,h=null!=u,f=0===c&&!o&&!h,p=r[c];"symbol-value"===u||f?d=0!==p?t[c]/p:1:h&&"proportional"!==u&&isFinite(u)&&(d=0!==p?u/p:1),null!=d&&(i[c]=d,o=d,s=Math.max(s,Math.abs(d)))}for(var b=2;b>=0;b--)null==i[b]?i[b]=o:0===i[b]&&(i[b]=.001*s)}for(var v=2;v>=0;v--)i[v]/=n;return Object(l.f)(i)}function T(e){return function(e){return null!=e.isPrimitive}(e)&&(e=[e.width,e.depth,e.height]),C(e)?null:"Symbol sizes may not be negative values"}function C(e){if(Array.isArray(e)){var t,r=Object(n.a)(e);try{for(r.s();!(t=r.n()).done;){if(!C(t.value))return!1}}catch(i){r.e(i)}finally{r.f()}return!0}return null==e||e>=0}function M(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Object(s.d)(),i=e||0,a=t||0,c=r||0;return 0!==i&&Object(o.r)(n,n,-i/180*Math.PI),0!==a&&Object(o.b)(n,n,a/180*Math.PI),0!==c&&Object(o.j)(n,n,c/180*Math.PI),n}function P(e,t){return null!=t.minDemResolution?t.minDemResolution:Object(f.x)(e)?t.minDemResolutionForPoints:.01*Object(f.y)(e)}var A={"bottom-left":Object(c.f)(0,0),bottom:Object(c.f)(.5,0),"bottom-right":Object(c.f)(1,0),left:Object(c.f)(0,.5),center:Object(c.f)(.5,.5),right:Object(c.f)(1,.5),"top-left":Object(c.f)(0,1),top:Object(c.f)(.5,1),"top-right":Object(c.f)(1,1)}},function(e,t,r){"use strict";r.d(t,"a",(function(){return a})),r.d(t,"b",(function(){return s})),r.d(t,"c",(function(){return o})),r.d(t,"d",(function(){return l})),r.d(t,"e",(function(){return c})),r.d(t,"f",(function(){return u}));var n=r(26),i=r(650);function a(e,t,r){e.setUniform3f("camPos",r[3]-t[0],r[7]-t[1],r[11]-t[2])}function o(e,t){e.setUniformMatrix4fv("proj",t)}function s(e,t){e.setUniform2fv("nearFar",t)}function c(e,t,r){Object(n.t)(d,r,t),e.setUniform3fv("localOrigin",t),e.setUniformMatrix4fv("view",d)}function l(e,t){c(e,t.origin,t.camera.viewMatrix)}function u(e,t){e.setUniform4fv("viewport",t.camera.fullViewport)}var d=Object(i.a)()},function(e,t,r){"use strict";var n=r(14),i=r(2),a=r(5),o=r(15),s=r(122),c=r(366),l=r(159),u=r(60),d=r(92),h=o.a.getLogger("esri.views.webgl.FrameBufferObject"),f=function(){function e(t,r,a,o){if(Object(i.a)(this,e),this._context=t,this._glName=null,this._depthAttachment=null,this._stencilAttachment=null,this._colorAttachments=new Map,this._initialized=!1,this._desc=Object(n.a)({},r),t.instanceCounter.increment(s.b.Framebuffer,this),a){Array.isArray(a)||(a=[a]);for(var l=0;l<a.length;++l){var d,h=a[l],f=void 0;p(h)?(f=h.descriptor,this._colorAttachments.set(36064+l,h)):(f=h,this._colorAttachments.set(36064+l,new u.a(t,h))),0!==(null==(d=this._desc)?void 0:d.colorTarget)&&console.error("Framebuffer is initialized with a texture however the descriptor indicates using a renderbuffer color attachment!"),this._validateColorAttachmentPoint(36064+l),this._validateTextureDimensions(f,this._desc)}}if(o instanceof c.a){var v,m=null!=(v=this._desc.depthStencilTarget)?v:3;2===m?this._stencilAttachment=o:1===m||3===m?this._depthAttachment=o:console.error('If a Renderbuffer is provided, "depthStencilTarget" must be one of STENCIL_RENDER_BUFFER, DEPTH_RENDER_BUFFER or DEPTH_STENCIL_RENDER_BUFFER'),b(o.descriptor,this._desc)}else if(o){var y;this._context.capabilities.depthTexture||console.error("Extension WEBGL_depth_texture isn't supported therefore it is no possible to set the depth/stencil texture as an attachment!"),p(o)?(this._depthStencilTexture=o,y=o.descriptor):this._depthStencilTexture=new u.a(this._context,o),this._validateTextureDimensions(y,this._desc)}}return Object(a.a)(e,[{key:"dispose",value:function(){if(this._desc){var e=this._context.getBoundFramebufferObject();this._disposeColorAttachments(),this._disposeDepthStencilAttachments(),this._glName&&(this._context.gl.deleteFramebuffer(this._glName),this._glName=null),this._context.bindFramebuffer(e),this._context.instanceCounter.decrement(s.b.Framebuffer,this),this._desc=null}}},{key:"glName",get:function(){return this._glName}},{key:"descriptor",get:function(){return this._desc}},{key:"colorTexture",get:function(){var e=this._colorAttachments.get(36064);return e&&p(e)?e:null}},{key:"colorAttachment",get:function(){return this._colorAttachments.get(36064)}},{key:"depthStencilAttachment",get:function(){return this._depthStencilTexture||this._depthAttachment||this._stencilAttachment}},{key:"depthStencilTexture",get:function(){return this._depthStencilTexture}},{key:"width",get:function(){return this._desc.width}},{key:"height",get:function(){return this._desc.height}},{key:"gpuMemoryUsage",get:function(){return Object(d.c)(this.colorAttachment)+Object(d.c)(this.depthStencilAttachment)}},{key:"getColorTexture",value:function(e){var t=this._colorAttachments.get(e);return t&&p(t)?t:null}},{key:"attachColorTexture",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:36064;if(e){this._validateColorAttachmentPoint(t);var r=e.descriptor;if(this._validateTextureDimensions(r,this._desc),this._disposeColorAttachments(),this._initialized){this._context.bindFramebuffer(this);var n=this._context.gl;n.framebufferTexture2D(n.FRAMEBUFFER,t,n.TEXTURE_2D,e.glName,0)}this._colorAttachments.set(t,e)}}},{key:"detachColorTexture",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:36064,t=this._colorAttachments.get(e);if(p(t)){var r=t;if(this._initialized){this._context.bindFramebuffer(this);var n=this._context.gl;n.framebufferTexture2D(n.FRAMEBUFFER,e,n.TEXTURE_2D,null,0)}return this._colorAttachments.delete(e),r}}},{key:"attachDepthStencilTexture",value:function(e){if(e){var t=e.descriptor;if(34041!==t.pixelFormat&&console.error("Depth/Stencil texture must have a pixel type of DEPTH_STENCIL!"),34042!==t.dataType&&console.error("Depth/Stencil texture must have data type of UNSIGNED_INT_24_8!"),this._context.capabilities.depthTexture||console.error("Extension WEBGL_depth_texture isn't supported therefore it is no possible to set the depth/stencil texture!"),this._validateTextureDimensions(t,this._desc),this._desc.depthStencilTarget&&4!==this._desc.depthStencilTarget&&(this._desc.depthStencilTarget=4),this._disposeDepthStencilAttachments(),this._initialized){this._context.bindFramebuffer(this);var r=this._context.gl;r.framebufferTexture2D(r.FRAMEBUFFER,r.DEPTH_STENCIL_ATTACHMENT,r.TEXTURE_2D,e.glName,0)}this._depthStencilTexture=e}}},{key:"detachDepthStencilTexture",value:function(){var e=this._depthStencilTexture;if(e&&this._initialized){this._context.bindFramebuffer(this);var t=this._context.gl;this._context.gl.framebufferTexture2D(t.FRAMEBUFFER,t.DEPTH_STENCIL_ATTACHMENT,t.TEXTURE_2D,null,0)}return this._depthStencilTexture=null,e}},{key:"attachDepthStencilBuffer",value:function(e){if(e){var t=e.descriptor;if(34041!==t.internalFormat&&33189!==t.internalFormat&&console.error("Depth/Stencil buffer must have correct internalFormat"),b(t,this._desc),this._disposeDepthStencilAttachments(),this._desc.depthStencilTarget=34041===t.internalFormat?3:1,this._initialized){this._context.bindFramebuffer(this);var r=this._context.gl,n=1===this._desc.depthStencilTarget?r.DEPTH_ATTACHMENT:r.DEPTH_STENCIL_ATTACHMENT;r.framebufferRenderbuffer(r.FRAMEBUFFER,n,r.RENDERBUFFER,e.glName)}this._depthAttachment=e}}},{key:"detachDepthStencilBuffer",value:function(){var e=this._context.gl,t=this._depthAttachment;if(t&&this._initialized){this._context.bindFramebuffer(this);var r=1===this._desc.depthStencilTarget?e.DEPTH_ATTACHMENT:e.DEPTH_STENCIL_ATTACHMENT;e.framebufferRenderbuffer(e.FRAMEBUFFER,r,e.RENDERBUFFER,null)}return this._depthAttachment=null,t}},{key:"detachAll",value:function(){this.detachColorTexture(),this.detachDepthStencilBuffer(),this.detachDepthStencilTexture()}},{key:"copyToTexture",value:function(e,t,r,n,i,a,o){(e<0||t<0||i<0||a<0)&&console.error("Offsets cannot be negative!"),(r<=0||n<=0)&&console.error("Copy width and height must be greater than zero!");var s=this._desc,c=o.descriptor;3553!==o.descriptor.target&&console.error("Texture target must be TEXTURE_2D!"),(e+r>s.width||t+n>s.height||i+r>c.width||a+n>c.height)&&console.error("Bad dimensions, the current input values will attempt to read or copy out of bounds!");var l=this._context,d=l.bindTexture(o,u.a.TEXTURE_UNIT_FOR_UPDATES);l.bindFramebuffer(this),l.gl.copyTexSubImage2D(3553,0,i,a,e,t,r,n),l.bindTexture(d,u.a.TEXTURE_UNIT_FOR_UPDATES)}},{key:"readPixels",value:function(e,t,r,n,i,a,o){(r<=0||n<=0)&&console.error("Copy width and height must be greater than zero!"),o||console.error("Target memory is not initialized!"),this._context.bindFramebuffer(this),this._context.gl.readPixels(e,t,r,n,i,a,o)}},{key:"resize",value:function(e,t){var r=this._desc;if(r.width!==e||r.height!==t){if(!this._initialized)return r.width=e,r.height=t,this._colorAttachments.forEach((function(r){r&&r.resize(e,t)})),void(this._depthStencilTexture&&this._depthStencilTexture.resize(e,t));r.width=e,r.height=t,this._colorAttachments.forEach((function(r){r&&r.resize(e,t)})),null!=this._depthStencilTexture?this._depthStencilTexture.resize(e,t):(this._depthAttachment||this._stencilAttachment)&&(this._depthAttachment&&this._depthAttachment.resize(e,t),this._stencilAttachment&&this._stencilAttachment.resize(e,t)),this._context.getBoundFramebufferObject()===this&&this._context.bindFramebuffer(null),this._initialized=!1}}},{key:"initializeAndBind",value:function(){var e,t,r,n,i=this._context.gl;if(this._initialized)i.bindFramebuffer(i.FRAMEBUFFER,this.glName);else{this._glName&&i.deleteFramebuffer(this._glName);var a=this._context,o=i.createFramebuffer(),s=this._desc,d=null!=(e=s.colorTarget)?e:1,h=null!=(t=s.width)?t:1,f=null!=(r=s.height)?r:1;if(i.bindFramebuffer(i.FRAMEBUFFER,o),0===this._colorAttachments.size)if(0===d)this._colorAttachments.set(36064,function(e,t){return new u.a(e,{target:3553,pixelFormat:6408,dataType:5121,samplingMode:9728,wrapMode:33071,width:t.width,height:t.height})}(a,s));else{var b=new c.a(a,{internalFormat:32854,width:h,height:f});this._colorAttachments.set(36064,b)}this._colorAttachments.forEach((function(e,t){e&&(p(e)?i.framebufferTexture2D(i.FRAMEBUFFER,t,i.TEXTURE_2D,e.glName,0):i.framebufferRenderbuffer(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0,i.RENDERBUFFER,e.glName))}));var v=null!=(n=s.depthStencilTarget)?n:0;switch(v){case 1:case 3:this._depthAttachment||(this._depthAttachment=new c.a(a,{internalFormat:1===s.depthStencilTarget?33189:34041,width:h,height:f}));var m=1===v?i.DEPTH_ATTACHMENT:i.DEPTH_STENCIL_ATTACHMENT;i.framebufferRenderbuffer(i.FRAMEBUFFER,m,i.RENDERBUFFER,this._depthAttachment.glName);break;case 2:this._stencilAttachment||(this._stencilAttachment=new c.a(a,{internalFormat:36168,width:h,height:f})),i.framebufferRenderbuffer(i.FRAMEBUFFER,i.STENCIL_ATTACHMENT,i.RENDERBUFFER,this._stencilAttachment.glName);break;case 4:if(!this._depthStencilTexture){a.capabilities.depthTexture||console.error("Extension WEBGL_depth_texture isn't supported therefore it is no possible to set the depth/stencil texture as an attachment!");var y={target:3553,pixelFormat:34041,dataType:34042,samplingMode:9728,wrapMode:33071,width:h,height:f};this._depthStencilTexture=new u.a(a,y)}i.framebufferTexture2D(i.FRAMEBUFFER,i.DEPTH_STENCIL_ATTACHMENT,i.TEXTURE_2D,this._depthStencilTexture.glName,0)}Object(l.c)()&&i.checkFramebufferStatus(i.FRAMEBUFFER)!==i.FRAMEBUFFER_COMPLETE&&console.error("Framebuffer is incomplete!"),this._glName=o,this._initialized=!0}}},{key:"_disposeColorAttachments",value:function(){var e=this;this._colorAttachments.forEach((function(t,r){if(p(t)){if(e._initialized){e._context.bindFramebuffer(e);var n=e._context.gl;n.framebufferTexture2D(n.FRAMEBUFFER,r,n.TEXTURE_2D,null,0)}t.dispose()}else if(t instanceof WebGLRenderbuffer){var i=e._context.gl;e._initialized&&(e._context.bindFramebuffer(e),i.framebufferRenderbuffer(i.FRAMEBUFFER,r,i.RENDERBUFFER,null)),e._context.gl.deleteRenderbuffer(t)}})),this._colorAttachments.clear()}},{key:"_disposeDepthStencilAttachments",value:function(){var e=this._context.gl;if(this._depthAttachment){if(this._initialized){this._context.bindFramebuffer(this);var t=1===this._desc.depthStencilTarget?e.DEPTH_ATTACHMENT:e.DEPTH_STENCIL_ATTACHMENT;e.framebufferRenderbuffer(e.FRAMEBUFFER,t,e.RENDERBUFFER,null)}this._depthAttachment.dispose(),this._depthAttachment=null}this._stencilAttachment&&(this._initialized&&(this._context.bindFramebuffer(this),e.framebufferRenderbuffer(e.FRAMEBUFFER,e.STENCIL_ATTACHMENT,e.RENDERBUFFER,null)),this._stencilAttachment.dispose(),this._stencilAttachment=null),this._depthStencilTexture&&(this._initialized&&(this._context.bindFramebuffer(this),e.framebufferTexture2D(e.FRAMEBUFFER,e.DEPTH_STENCIL_ATTACHMENT,e.TEXTURE_2D,null,0)),this._depthStencilTexture.dispose(),this._depthStencilTexture=null)}},{key:"_validateTextureDimensions",value:function(e,t){3553!==e.target&&console.error("Texture type must be TEXTURE_2D!"),void 0!==t.width&&t.width>=0&&void 0!==t.height&&t.height>=0?t.width===e.width&&t.height===e.height||console.error("Color attachment texture must match the framebuffer's!"):(t.width=e.width,t.height=e.height)}},{key:"_validateColorAttachmentPoint",value:function(t){if(-1===e._MAX_COLOR_ATTACHMENTS){var r=this._context.capabilities.drawBuffers;if(r){var n=this._context.gl;e._MAX_COLOR_ATTACHMENTS=n.getParameter(r.MAX_COLOR_ATTACHMENTS)}else e._MAX_COLOR_ATTACHMENTS=1}var i=t-36064;i+1>e._MAX_COLOR_ATTACHMENTS&&h.error("esri.FrameBufferObject","illegal attachment point for color attachment: ".concat(i+1,". Implementation supports up to ").concat(e._MAX_COLOR_ATTACHMENTS," color attachments"))}}]),e}();function p(e){return"type"in e&&"texture"===e.type}function b(e,t){void 0!==t.width&&t.width>=0&&void 0!==t.height&&t.height>=0?t.width===e.width&&t.height===e.height||console.error("Renderbuffer dimensions must match the framebuffer's!"):(t.width=e.width,t.height=e.height)}f._MAX_COLOR_ATTACHMENTS=-1,t.a=f},function(e,t,r){"use strict";r.d(t,"a",(function(){return u}));var n=r(13),i=r(2),a=r(5),o=r(32),s=r(335),c=function(){function e(t,r){Object(i.a)(this,e),this.layout=t,this.buffer="number"==typeof r?new ArrayBuffer(r*t.stride):r;var a,o=Object(n.a)(t.fieldNames);try{for(o.s();!(a=o.n()).done;){var s=a.value,c=t.fields.get(s);this[s]=new c.constructor(this.buffer,c.offset,this.stride)}}catch(l){o.e(l)}finally{o.f()}}return Object(a.a)(e,[{key:"stride",get:function(){return this.layout.stride}},{key:"count",get:function(){return this.buffer.byteLength/this.stride}},{key:"byteLength",get:function(){return this.buffer.byteLength}},{key:"getField",value:function(e,t){var r=this[e];return r&&r.elementCount===t.ElementCount&&r.elementType===t.ElementType?r:null}},{key:"slice",value:function(t,r){return new e(this.layout,this.buffer.slice(t*this.stride,r*this.stride))}},{key:"copyFrom",value:function(e,t,r,n){var i=this.stride;if(i%4==0){var a=new Uint32Array(e.buffer,t*i,n*i/4);new Uint32Array(this.buffer,r*i,n*i/4).set(a)}else{var o=new Uint8Array(e.buffer,t*i,n*i);new Uint8Array(this.buffer,r*i,n*i).set(o)}}}]),e}(),l=function(){function e(){Object(i.a)(this,e),this.stride=0,this.fields=new Map,this.fieldNames=[]}return Object(a.a)(e,[{key:"vec2f",value:function(e,t){return this.appendField(e,o.m,t),this}},{key:"vec2f64",value:function(e,t){return this.appendField(e,o.n,t),this}},{key:"vec3f",value:function(e,t){return this.appendField(e,o.u,t),this}},{key:"vec3f64",value:function(e,t){return this.appendField(e,o.v,t),this}},{key:"vec4f",value:function(e,t){return this.appendField(e,o.C,t),this}},{key:"vec4f64",value:function(e,t){return this.appendField(e,o.D,t),this}},{key:"mat3f",value:function(e,t){return this.appendField(e,o.f,t),this}},{key:"mat3f64",value:function(e,t){return this.appendField(e,o.g,t),this}},{key:"mat4f",value:function(e,t){return this.appendField(e,o.h,t),this}},{key:"mat4f64",value:function(e,t){return this.appendField(e,o.i,t),this}},{key:"vec4u8",value:function(e,t){return this.appendField(e,o.J,t),this}},{key:"f32",value:function(e,t){return this.appendField(e,o.a,t),this}},{key:"f64",value:function(e,t){return this.appendField(e,o.b,t),this}},{key:"u8",value:function(e,t){return this.appendField(e,o.l,t),this}},{key:"u16",value:function(e,t){return this.appendField(e,o.j,t),this}},{key:"i8",value:function(e,t){return this.appendField(e,o.e,t),this}},{key:"vec2i8",value:function(e,t){return this.appendField(e,o.q,t),this}},{key:"vec2i16",value:function(e,t){return this.appendField(e,o.o,t),this}},{key:"vec2u8",value:function(e,t){return this.appendField(e,o.t,t),this}},{key:"vec4u16",value:function(e,t){return this.appendField(e,o.H,t),this}},{key:"u32",value:function(e,t){return this.appendField(e,o.k,t),this}},{key:"appendField",value:function(e,t,r){var n=t.ElementCount*Object(s.a)(t.ElementType),i=this.stride;this.fields.set(e,{size:n,constructor:t,offset:i,optional:r}),this.stride+=n,this.fieldNames.push(e)}},{key:"alignTo",value:function(e){return this.stride=Math.floor((this.stride+e-1)/e)*e,this}},{key:"hasField",value:function(e){return this.fieldNames.indexOf(e)>=0}},{key:"createBuffer",value:function(e){return new c(this,e)}},{key:"createView",value:function(e){return new c(this,e)}},{key:"clone",value:function(){var t=new e;return t.stride=this.stride,t.fields=new Map,this.fields.forEach((function(e,r){return t.fields.set(r,e)})),t.fieldNames=this.fieldNames.slice(),t.BufferType=this.BufferType,t}}]),e}();function u(){return new l}},function(e,t,r){"use strict";r.d(t,"a",(function(){return l})),r.d(t,"b",(function(){return u})),r.d(t,"c",(function(){return c}));var n,i=r(12),a=r(43),o=r(11),s=Object(a.g)(1,1,0,1),c=Object(a.g)(1,0,1,1);function l(e){e.fragment.uniforms.add("depthTex","sampler2D"),e.fragment.uniforms.add("highlightViewportPixelSz","vec4"),e.fragment.constants.add("occludedHighlightFlag","vec4",s).add("unoccludedHighlightFlag","vec4",c),e.fragment.code.add(Object(o.a)(n||(n=Object(i.a)(["void outputHighlight() {\nvec4 fragCoord = gl_FragCoord;\nfloat sceneDepth = texture2D(depthTex, (fragCoord.xy - highlightViewportPixelSz.xy) * highlightViewportPixelSz.zw).r;\nif (fragCoord.z > sceneDepth + 5e-7) {\ngl_FragColor = occludedHighlightFlag;\n}\nelse {\ngl_FragColor = unoccludedHighlightFlag;\n}\n}"]))))}function u(e,t){e.bindTexture(t.highlightDepthTexture,"depthTex"),e.setUniform4f("highlightViewportPixelSz",0,0,t.inverseViewport[0],t.inverseViewport[1])}},function(e,t,r){"use strict";r.d(t,"a",(function(){return d})),r.d(t,"b",(function(){return l})),r.d(t,"c",(function(){return u}));var n,i,a,o,s=r(12),c=r(11),l=.1,u=.001;function d(e,t){var r=e.fragment;switch(t.alphaDiscardMode){case 0:r.code.add(Object(c.a)(n||(n=Object(s.a)(["\n        #define discardOrAdjustAlpha(color) { if (color.a < ",") { discard; } }\n      "])),c.a.float(u)));break;case 1:r.code.add(Object(c.a)(i||(i=Object(s.a)(["void discardOrAdjustAlpha(inout vec4 color) {\ncolor.a = 1.0;\n}"]))));break;case 2:r.uniforms.add("textureAlphaCutoff","float"),r.code.add(Object(c.a)(a||(a=Object(s.a)(["#define discardOrAdjustAlpha(color) { if (color.a < textureAlphaCutoff) { discard; } else { color.a = 1.0; } }"]))));break;case 3:e.fragment.uniforms.add("textureAlphaCutoff","float"),e.fragment.code.add(Object(c.a)(o||(o=Object(s.a)(["#define discardOrAdjustAlpha(color) { if (color.a < textureAlphaCutoff) { discard; } }"]))))}}},function(e,t,r){"use strict";r.d(t,"a",(function(){return i})),r.d(t,"b",(function(){return n})),r.d(t,"c",(function(){return s})),r.d(t,"d",(function(){return c})),r.d(t,"e",(function(){return l})),r.d(t,"f",(function(){return u})),r.d(t,"g",(function(){return d})),r.d(t,"h",(function(){return h})),r.d(t,"i",(function(){return o})),r.d(t,"j",(function(){return a}));var n={func:513},i={func:519},a={mask:255},o={mask:0},s=function(e){return{function:{func:517,ref:e,mask:e},operation:{fail:7680,zFail:7680,zPass:7680}}},c=function(e){return{function:{func:519,ref:e,mask:e},operation:{fail:7680,zFail:7680,zPass:7681}}},l={function:{func:519,ref:2,mask:2},operation:{fail:7680,zFail:7680,zPass:0}},u={function:{func:519,ref:2,mask:2},operation:{fail:7680,zFail:7680,zPass:7681}},d={function:{func:514,ref:2,mask:2},operation:{fail:7680,zFail:7680,zPass:7680}},h={function:{func:517,ref:2,mask:2},operation:{fail:7680,zFail:7680,zPass:7680}}},function(e,t,r){"use strict";r.d(t,"a",(function(){return s})),r.d(t,"b",(function(){return o}));var n,i=r(12),a=r(11);function o(e,t){e.fragment.uniforms.add("terrainDepthTexture","sampler2D"),e.fragment.uniforms.add("cameraNearFar","vec2"),e.fragment.uniforms.add("inverseViewport","vec2"),e.fragment.code.add(Object(a.a)(n||(n=Object(i.a)(["\n    // Compare the linearized depths of fragment and terrain. Discard fragments on the wrong side of the terrain.\n    void terrainDepthTest(vec4 fragCoord, float fragmentDepth){\n\n      float terrainDepth = linearDepthFromTexture(terrainDepthTexture, fragCoord.xy * inverseViewport, cameraNearFar);\n      if(fragmentDepth "," terrainDepth){\n        discard;\n      }\n    }\n  "])),t.cullAboveGround?">":"<="))}function s(e,t){t.multipassTerrainEnabled&&t.terrainLinearDepthTexture&&e.bindTexture(t.terrainLinearDepthTexture,"terrainDepthTexture")}},function(e,t,r){"use strict";r.d(t,"a",(function(){return a})),r.d(t,"b",(function(){return o})),r.d(t,"c",(function(){return s}));var n=r(13),i=r(25);function a(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return l(e,t,r)}function o(e,t){if(null!=t)return t[e]||c(e.split("."),!1,t)}function s(e,t,r){var n=e.split("."),i=n.pop(),a=c(n,!0,r);a&&i&&(a[i]=t)}function c(e,t,r){var i,a=r,o=Object(n.a)(e);try{for(o.s();!(i=o.n()).done;){var s=i.value;if(null==a)return;if(!(s in a)){if(!t)return;a[s]={}}a=a[s]}}catch(c){o.e(c)}finally{o.f()}return a}function l(e,t,r){return t?Object.keys(t).reduce((function(e,n){var a=e[n],o=t[n];return a===o?e:void 0===a?(e[n]=Object(i.a)(o),e):(Array.isArray(o)||Array.isArray(e)?(a=a?Array.isArray(a)?e[n]=a.concat():e[n]=[a]:e[n]=[],o&&(Array.isArray(o)||(o=[o]),r?o.forEach((function(e){-1===a.indexOf(e)&&a.push(e)})):e[n]=o.concat())):o&&"object"==typeof o?e[n]=l(a,o,r):e.hasOwnProperty(n)&&!t.hasOwnProperty(n)||(e[n]=o),e)}),e||{}):e}},function(e,t,r){"use strict";r.d(t,"a",(function(){return c})),r.d(t,"b",(function(){return l})),r.d(t,"c",(function(){return u})),r.d(t,"d",(function(){return v})),r.d(t,"e",(function(){return b})),r.d(t,"f",(function(){return f})),r.d(t,"g",(function(){return h}));var n=r(50),i=r(13),a=r(191),o=r(25),s=r(3);function c(e){return e?e.__accessor__?e.__accessor__:e.propertyInvalidated?e:null:null}function l(e,t){return null!=e&&e.metadatas&&null!=e.metadatas[t]}function u(e,t,r){return d(e,t,r?{policy:r,path:""}:null)}function d(e,t,r){return t?Object.keys(t).reduce((function(e,n){var i=null,a="merge";if(r&&(i=r.path?"".concat(r.path,".").concat(n):n,a=r.policy(i)),"replace"===a)return e[n]=t[n],e;if(void 0===e[n])return e[n]=Object(o.a)(t[n]),e;var c=e[n],l=t[n];if(c===l)return e;if(Array.isArray(l)||Array.isArray(e))c=c?Array.isArray(c)?e[n]=c.concat():e[n]=[c]:e[n]=[],l&&(Array.isArray(l)||(l=[l]),l.forEach((function(e){-1===c.indexOf(e)&&c.push(e)})));else if(l&&"object"==typeof l)if(r){var u=r.path;r.path=Object(s.d)(i),e[n]=d(c,l,r),r.path=u}else e[n]=d(c,l,null);else e.hasOwnProperty(n)&&!t.hasOwnProperty(n)||(e[n]=l);return e}),e||{}):e}function h(e){return e?"string"==typeof e&&-1===e.indexOf(".")?e:f(e):e}function f(e){return Array.isArray(e)?e:e.split(".")}function p(e){return e.indexOf(",")>-1?e.split(",").map((function(e){return e.trim()})):[e.trim()]}function b(e,t,r,o){var s=function(e){if(Array.isArray(e)){var t,r=[],a=Object(i.a)(e);try{for(a.s();!(t=a.n()).done;){var o=t.value;r.push.apply(r,Object(n.a)(p(o)))}}catch(s){a.e(s)}finally{a.f()}return r}return p(e)}(t);if(1!==s.length){var c=s.map((function(t){return o(e,t,r)}));return Object(a.a)(c)}return o(e,s[0],r)}function v(e){var t=!1;return function(){t||(t=!0,e())}}},function(e,t,r){"use strict";r.d(t,"a",(function(){return b}));var n=r(14),i=r(33),a=r(13),o=r(2),s=r(5),c=r(6),l=r(7),u=r(3),d=r(520),h=r(247),f=r(150),p=r(46),b=function(e){Object(c.a)(r,e);var t=Object(l.a)(r);function r(e){var s,c=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,u=arguments.length>3&&void 0!==arguments[3]?arguments[3]:-1;Object(o.a)(this,r),(s=t.call(this))._primitiveType=l,s.edgeIndicesLength=u,s.type=2,s._vertexAttributes=new Map,s._indices=new Map,s._boundingInfo=null;var d,h=Object(a.a)(e);try{for(h.s();!(d=h.n()).done;){var p=Object(i.a)(d.value,2),b=p[0],y=p[1];y&&s._vertexAttributes.set(b,Object(n.a)({},y))}}catch(M){h.e(M)}finally{h.f()}if(null==c||0===c.length){var g=v(s._vertexAttributes),O=Object(f.d)(g);s.edgeIndicesLength=s.edgeIndicesLength<0?g:s.edgeIndicesLength;var j,_=Object(a.a)(s._vertexAttributes.keys());try{for(_.s();!(j=_.n()).done;){var w=j.value;s._indices.set(w,O)}}catch(M){_.e(M)}finally{_.f()}}else{var x,k=Object(a.a)(c);try{for(k.s();!(x=k.n()).done;){var S=Object(i.a)(x.value,2),T=S[0],C=S[1];C&&(s._indices.set(T,m(C)),"position"===T&&(s.edgeIndicesLength=s.edgeIndicesLength<0?s._indices.get(T).length:s.edgeIndicesLength))}}catch(M){k.e(M)}finally{k.f()}}return s}return Object(s.a)(r,[{key:"vertexAttributes",get:function(){return this._vertexAttributes}},{key:"getMutableAttribute",value:function(e){var t=this._vertexAttributes.get(e);return t&&!t.exclusive&&(t.data=Array.from(t.data),t.exclusive=!0),t}},{key:"indices",get:function(){return this._indices}},{key:"indexCount",get:function(){var e=this._indices.values().next().value;return e?e.length:0}},{key:"primitiveType",get:function(){return this._primitiveType}},{key:"faceCount",get:function(){return this.indexCount/3}},{key:"boundingInfo",get:function(){return Object(u.i)(this._boundingInfo)&&(this._boundingInfo=this._calculateBoundingInfo()),this._boundingInfo}},{key:"computeAttachmentOrigin",value:function(e){return 0===this.primitiveType?this.computeAttachmentOriginTriangles(e):this.computeAttachmentOriginPoints(e)}},{key:"computeAttachmentOriginTriangles",value:function(e){var t=this.indices.get("position"),r=this.vertexAttributes.get("position");return Object(f.c)(r,t,e)}},{key:"computeAttachmentOriginPoints",value:function(e){var t=this.indices.get("position"),r=this.vertexAttributes.get("position");return Object(f.b)(r,t,e)}},{key:"invalidateBoundingInfo",value:function(){this._boundingInfo=null}},{key:"_calculateBoundingInfo",value:function(){var e=this.indices.get("position");if(0===e.length)return null;var t=0===this.primitiveType?3:1;Object(p.a)(e.length%t==0,"Indexing error: "+e.length+" not divisible by "+t);var r=Object(f.d)(e.length/t),n=this.vertexAttributes.get("position");return new d.a(r,t,e,n)}}]),r}(h.a);function v(e){var t=e.values().next().value;return null==t?0:t.data.length/t.size}function m(e){if(e.BYTES_PER_ELEMENT===Uint16Array.BYTES_PER_ELEMENT)return e;var t,r=Object(a.a)(e);try{for(r.s();!(t=r.n()).done;){if(t.value>=65536)return e}}catch(n){r.e(n)}finally{r.f()}return new Uint16Array(e)}},function(e,t,r){"use strict";r.d(t,"a",(function(){return d})),r.d(t,"b",(function(){return f})),r.d(t,"c",(function(){return h}));var n=r(2),i=r(5),a=r(6),o=r(7),s=r(3),c=r(247),l=r(77),u=r(102),d=function(e){Object(a.a)(r,e);var t=Object(o.a)(r);function r(e,i){var a;return Object(n.a)(this,r),(a=t.call(this)).type=3,a.supportsEdges=!1,a._visible=!0,a._renderPriority=0,a._insertOrder=0,a._vertexAttributeLocations=l.a,a._params=Object(u.e)(e,i),a.validateParameterValues(a._params),a}return Object(i.a)(r,[{key:"dispose",value:function(){}},{key:"params",get:function(){return this._params}},{key:"update",value:function(e){return!1}},{key:"setParameterValues",value:function(e){Object(u.k)(this._params,e)&&(this.validateParameterValues(this._params),this.parametersChanged())}},{key:"validateParameterValues",value:function(e){}},{key:"visible",get:function(){return this._visible},set:function(e){e!==this._visible&&(this._visible=e,this.parametersChanged())}},{key:"isVisibleInPass",value:function(e){return!0}},{key:"renderOccluded",get:function(){return this.params.renderOccluded}},{key:"renderPriority",get:function(){return this._renderPriority},set:function(e){e!==this._renderPriority&&(this._renderPriority=e,this.parametersChanged())}},{key:"insertOrder",get:function(){return this._insertOrder},set:function(e){e!==this._insertOrder&&(this._insertOrder=e,this.parametersChanged())}},{key:"vertexAttributeLocations",get:function(){return this._vertexAttributeLocations}},{key:"isVisible",value:function(){return this._visible}},{key:"parametersChanged",value:function(){Object(s.j)(this.materialRepository)&&this.materialRepository.materialChanged(this)}}]),r}(c.a);function h(e,t){return e.isVisible()&&e.isVisibleInPass(t.pass)&&0!=(e.renderOccluded&t.renderOccludedMask)}var f={renderOccluded:1}},function(e,t,r){"use strict";var n=r(2),i=r(5);function a(e){return e&&e.acquire&&"function"==typeof e.acquire}var o=function(){function e(t,r,i){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;if(Object(n.a)(this,e),this.ctor=t,this.acquireFunction=r,this.releaseFunction=i,this.allocationSize=a,this._pool=new Array(o),this._initialSize=o,this.ctor)for(var s=0;s<o;s++)this._pool[s]=new this.ctor;this.allocationSize=Math.max(a,1)}return Object(i.a)(e,[{key:"destroy",value:function(){this.prune(0)}},{key:"acquire",value:function(){var t,r;if(e.test.disabled)r=new this.ctor;else{if(0===this._pool.length)for(var n=this.allocationSize,i=0;i<n;i++)this._pool[i]=new this.ctor;r=this._pool.pop()}for(var o=arguments.length,s=new Array(o),c=0;c<o;c++)s[c]=arguments[c];return this.acquireFunction?this.acquireFunction.apply(this,[r].concat(s)):a(r)&&(t=r).acquire.apply(t,s),r}},{key:"release",value:function(t){t&&!e.test.disabled&&(this.releaseFunction?this.releaseFunction(t):function(e){return e&&e.release&&"function"==typeof e.release}(t)&&t.release(),this._pool.push(t))}},{key:"prune",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this._initialSize;if(!(e>=this._pool.length)){for(var t=e;t<this._pool.length;++t){var r=this._pool[t];this._dispose(r)}this._pool.length=e}}},{key:"_dispose",value:function(e){e.dispose&&"function"==typeof e.dispose&&e.dispose()}}]),e}();o.test={disabled:!1},t.a=o},function(e,t,r){"use strict";r.d(t,"a",(function(){return y})),r.d(t,"b",(function(){return v})),r.d(t,"c",(function(){return p})),r.d(t,"d",(function(){return b})),r.d(t,"e",(function(){return m})),r.d(t,"f",(function(){return w})),r.d(t,"g",(function(){return j})),r.d(t,"h",(function(){return _})),r.d(t,"i",(function(){return O})),r.d(t,"j",(function(){return g})),r.d(t,"k",(function(){return k}));var n=r(212),i=r(26),a=r(4),o=r(9),s=r(54),c=r(43),l=r(79),u=r(47);function d(e){return e?{ray:Object(l.c)(e.ray),c0:e.c0,c1:e.c1}:{ray:Object(l.c)(),c0:0,c1:Number.MAX_VALUE}}function h(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:d(),n=Object(a.r)(e.vector);return Object(l.f)(e.origin,t,r.ray),r.c0=0,r.c1=n,r}new n.a((function(){return{c0:0,c1:0,ray:null}}));var f=r(37);function p(e){return e?[Object(f.d)(e[0]),Object(f.d)(e[1]),Object(f.d)(e[2]),Object(f.d)(e[3]),Object(f.d)(e[4]),Object(f.d)(e[5])]:[Object(f.d)(),Object(f.d)(),Object(f.d)(),Object(f.d)(),Object(f.d)(),Object(f.d)()]}function b(){return[Object(o.e)(),Object(o.e)(),Object(o.e)(),Object(o.e)(),Object(o.e)(),Object(o.e)(),Object(o.e)(),Object(o.e)()]}function v(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:p(),r=0;r<6;r++)Object(f.c)(e[r],t[r])}function m(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:C,o=Object(i.m)(u.a.get(),t,e);Object(i.a)(o,o);for(var c=0;c<8;++c){var l=Object(s.m)(u.d.get(),S[c],o);Object(a.y)(n[c],l[0]/l[3],l[1]/l[3],l[2]/l[3])}y(r,n)}function y(e,t){Object(f.g)(t[4],t[0],t[3],e[0]),Object(f.g)(t[1],t[5],t[6],e[1]),Object(f.g)(t[4],t[5],t[1],e[2]),Object(f.g)(t[3],t[2],t[6],e[3]),Object(f.g)(t[0],t[1],t[2],e[4]),Object(f.g)(t[5],t[4],t[7],e[5])}function g(e,t){for(var r=0;r<6;r++)if(Object(f.q)(e[r],t))return!1;return!0}function O(e,t){return x(e,function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:d();return Object(l.b)(e,t.ray),t.c0=0,t.c1=Number.MAX_VALUE,t}(t,T.get()))}function j(e,t,r){return x(e,h(t,r,T.get()))}function _(e,t){for(var r=0;r<6;r++)if(Object(f.w)(e[r],t)>0)return!1;return!0}function w(e,t){for(var r=0;r<6;r++)if(Object(f.n)(e[r],t))return!1;return!0}function x(e,t){for(var r=0;r<6;r++)if(!Object(f.a)(e[r],t))return!1;return!0}var k={bottom:[5,1,0,4],near:[0,1,2,3],far:[5,4,7,6],right:[1,5,6,2],left:[4,0,3,7],top:[7,3,2,6]},S=[Object(c.g)(-1,-1,-1,1),Object(c.g)(1,-1,-1,1),Object(c.g)(1,1,-1,1),Object(c.g)(-1,1,-1,1),Object(c.g)(-1,-1,1,1),Object(c.g)(1,-1,1,1),Object(c.g)(1,1,1,1),Object(c.g)(-1,1,1,1)],T=new n.a(d),C=b()},function(e,t,r){"use strict";r.d(t,"a",(function(){return l})),r.d(t,"b",(function(){return c})),r.d(t,"c",(function(){return u}));var n=r(13),i=r(2),a=r(5),o=r(6),s=r(7),c=function(e){return function(e){Object(o.a)(r,e);var t=Object(s.a)(r);function r(){var e;return Object(i.a)(this,r),(e=t.apply(this,arguments))._isDisposed=!1,e}return Object(a.a)(r,[{key:"dispose",value:function(){var e,t=Object(n.a)(null!=(r=this._managedDisposables)?r:[]);try{for(t.s();!(e=t.n()).done;){var r,i=e.value,a=this[i];this[i]=null,a&&"function"==typeof a.dispose&&a.dispose()}}catch(o){t.e(o)}finally{t.f()}this._isDisposed=!0}},{key:"isDisposed",get:function(){return this._isDisposed}}]),r}(e)},l=function(e){Object(o.a)(r,e);var t=Object(s.a)(r);function r(){return Object(i.a)(this,r),t.apply(this,arguments)}return r}(c(function(){return function e(){Object(i.a)(this,e)}}()));function u(){return function(e,t){var r,n;e.hasOwnProperty("_managedDisposables")||(e._managedDisposables=null!=(r=null==(n=e._managedDisposables)?void 0:n.slice())?r:[]),e._managedDisposables.unshift(t)}}},function(e,t,r){"use strict";r.d(t,"a",(function(){return s}));var n,i=r(12),a=r(194),o=r(11);function s(e){e.include(a.a),e.code.add(Object(o.a)(n||(n=Object(i.a)(["float linearDepthFromFloat(float depth, vec2 nearFar) {\nreturn -(depth * (nearFar[1] - nearFar[0]) + nearFar[0]);\n}\nfloat linearDepthFromTexture(sampler2D depthTex, vec2 uv, vec2 nearFar) {\nreturn linearDepthFromFloat(rgba2float(texture2D(depthTex, uv)), nearFar);\n}"]))))}},function(e,t,r){"use strict";r.d(t,"a",(function(){return o})),r.d(t,"b",(function(){return a}));var n=r(33),i=r(13);function a(e,t){var r,a=Object(i.a)(e);try{for(a.s();!(r=a.n()).done;){var o=Object(n.a)(r.value,2),s=o[0];if(t(o[1],s))return!0}}catch(c){a.e(c)}finally{a.f()}return!1}function o(e,t){var r,a=Object(i.a)(e);try{for(a.s();!(r=a.n()).done;){var o=Object(n.a)(r.value,2),s=o[0],c=o[1];if(t(c,s))return c}}catch(l){a.e(l)}finally{a.f()}return null}},function(e,t,r){"use strict";r.d(t,"a",(function(){return i})),r.d(t,"b",(function(){return n}));var n,i=33984;!function(e){e[e.Texture=0]="Texture",e[e.Buffer=1]="Buffer",e[e.VAO=2]="VAO",e[e.Program=3]="Program",e[e.Framebuffer=4]="Framebuffer",e[e.Renderbuffer=5]="Renderbuffer",e[e.COUNT=6]="COUNT"}(n||(n={}))},function(e,t,r){"use strict";var n=r(71),i=(r(17),r(113)),a={apiKey:void 0,applicationUrl:n.a.location&&n.a.location.href,assetsPath:"",fontsUrl:"https://static.arcgis.com/fonts",geometryService:null,geometryServiceUrl:"https://utility.arcgisonline.com/arcgis/rest/services/Geometry/GeometryServer",geoRSSServiceUrl:"https://utility.arcgis.com/sharing/rss",kmlServiceUrl:"https://utility.arcgis.com/sharing/kml",portalUrl:"https://www.arcgis.com",workers:{loaderConfig:{has:{},paths:{},map:{},packages:[]}},request:{httpsDomains:["arcgis.com","arcgisonline.com","esrikr.com","premiumservices.blackbridge.com","esripremium.accuweather.com","gbm.digitalglobe.com","firstlook.digitalglobe.com","msi.digitalglobe.com"],interceptors:[],maxUrlLength:2e3,proxyRules:[],proxyUrl:null,timeout:6e4,trustedServers:[],useIdentity:!0},log:{interceptors:[],level:null}};if(n.a.esriConfig&&(Object(i.a)(a,n.a.esriConfig,!0),delete a.has),!a.assetsPath){a.assetsPath="https://js.arcgis.com/".concat("4.20.2".slice(0,-2),"/@arcgis/core/assets")}a.baseUrl&&console.warn("[esri.config]","baseUrl has been replaced by assetsPath"),Object.defineProperty(a,"baseUrl",{set:function(){console.warn("[esri.config]","baseUrl has been replaced by assetsPath")}}),a.request.corsEnabledServers=[],a.request.corsEnabledServers.push=function(){return console.warn("[esri.config]","request.corsEnabledServers is not supported and will be removed in a future release. See http://esriurl.com/cors8664"),0},t.a=a},function(e,t,r){"use strict";r.d(t,"a",(function(){return d})),r.d(t,"b",(function(){return h})),r.d(t,"c",(function(){return u})),r.d(t,"d",(function(){return c})),r.d(t,"e",(function(){return l}));var n=r(77),i=r(268),a=r(81),o=r(60),s=r(104);function c(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:i.a,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:n.a,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:-1,c=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1,l=null;switch(t){case i.b:l=new Float32Array([o,o,0,0,c,o,1,0,o,c,0,1,c,c,1,1]);break;case i.a:default:l=new Float32Array([o,o,c,o,o,c,c,c])}return new s.a(e,r,{geometry:t},{geometry:a.a.createVertex(e,35044,l)})}function l(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:i.a,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:n.a,o=new Float32Array([-1,-1,3,-1,-1,3]);return new s.a(e,r,{geometry:t},{geometry:a.a.createVertex(e,35044,o)})}function u(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:4;return new o.a(e,{target:3553,pixelFormat:6408,dataType:5121,samplingMode:9728,width:t,height:t})}function d(e,t){for(var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:4,n=new Uint8Array(r*r*4),i=0;i<n.length;i+=4)n[i+0]=255*t[0],n[i+1]=255*t[1],n[i+2]=255*t[2],n[i+3]=255*t[3];return new o.a(e,{target:3553,pixelFormat:6408,dataType:5121,samplingMode:9728,width:r,height:r},n)}function h(e){return new o.a(e,{target:3553,pixelFormat:6408,dataType:5121,samplingMode:9728,width:1,height:1},new Uint8Array([255,255,255,255]))}},function(e,t,r){"use strict";r.d(t,"a",(function(){return p})),r.d(t,"b",(function(){return f})),r.d(t,"c",(function(){return c})),r.d(t,"d",(function(){return d})),r.d(t,"e",(function(){return u})),r.d(t,"f",(function(){return l})),r.d(t,"g",(function(){return h}));var n=r(20),i=r(212),a=r(4),o=r(9),s=r(47);function c(e){return e?{origin:Object(o.c)(e.origin),vector:Object(o.c)(e.vector)}:{origin:Object(o.e)(),vector:Object(o.e)()}}function l(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:c();return Object(a.m)(r.origin,e),Object(a.m)(r.vector,t),r}function u(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:c();return Object(a.m)(r.origin,e),Object(a.l)(r.vector,t,e),r}function d(e,t){var r=Object(a.l)(s.c.get(),t,e.origin),i=Object(a.j)(e.vector,r),o=Object(a.j)(e.vector,e.vector),c=Object(n.e)(i/o,0,1),l=Object(a.l)(s.c.get(),Object(a.g)(s.c.get(),e.vector,c),r);return Object(a.j)(l,l)}function h(e,t,r,i,o){var c=e.vector,l=e.origin,u=Object(a.l)(s.c.get(),t,l),d=Object(a.j)(c,u)/Object(a.v)(c);return Object(a.g)(o,c,Object(n.e)(d,r,i)),Object(a.h)(o,o,e.origin)}function f(e,t){if(b(e,function(e,t){var r=m.get();return r.origin=e,r.vector=t,r}(t.origin,t.direction),!1,v)){var r=v.tA,n=v.pB,i=v.distance2;if(r>=0&&r<=1)return i;if(r<0)return Object(a.n)(e.origin,n);if(r>1)return Object(a.n)(Object(a.h)(s.c.get(),e.origin,e.vector),n)}return null}function p(e,t,r){return!!b(e,t,!0,v)&&(Object(a.m)(r,v.pA),!0)}function b(e,t,r,i){var o=1e-6,c=e.origin,l=Object(a.h)(s.c.get(),c,e.vector),u=t.origin,d=Object(a.h)(s.c.get(),u,t.vector),h=s.c.get(),f=s.c.get();if(h[0]=c[0]-u[0],h[1]=c[1]-u[1],h[2]=c[2]-u[2],f[0]=d[0]-u[0],f[1]=d[1]-u[1],f[2]=d[2]-u[2],Math.abs(f[0])<o&&Math.abs(f[1])<o&&Math.abs(f[2])<o)return!1;var p=s.c.get();if(p[0]=l[0]-c[0],p[1]=l[1]-c[1],p[2]=l[2]-c[2],Math.abs(p[0])<o&&Math.abs(p[1])<o&&Math.abs(p[2])<o)return!1;var b=h[0]*f[0]+h[1]*f[1]+h[2]*f[2],v=f[0]*p[0]+f[1]*p[1]+f[2]*p[2],m=h[0]*p[0]+h[1]*p[1]+h[2]*p[2],y=f[0]*f[0]+f[1]*f[1]+f[2]*f[2],g=(p[0]*p[0]+p[1]*p[1]+p[2]*p[2])*y-v*v;if(Math.abs(g)<o)return!1;var O=(b*v-m*y)/g,j=(b+v*O)/y;r&&(O=Object(n.e)(O,0,1),j=Object(n.e)(j,0,1));var _=s.c.get(),w=s.c.get();return _[0]=c[0]+O*p[0],_[1]=c[1]+O*p[1],_[2]=c[2]+O*p[2],w[0]=u[0]+j*f[0],w[1]=u[1]+j*f[1],w[2]=u[2]+j*f[2],i.tA=O,i.tB=j,i.pA=_,i.pB=w,i.distance2=Object(a.n)(_,w),!0}var v={tA:0,tB:0,pA:Object(o.e)(),pB:Object(o.e)(),distance2:0},m=new i.a((function(){return{origin:null,vector:null}}))},function(e,t,r){"use strict";r.d(t,"a",(function(){return u}));var n=r(18),i=r(66),a=r(160),o=r(254),s=r(56),c=r(158),l=r(176);r(55),r(241),r(100);var u={base:a.a,key:"type",typeMap:{extent:i.a,multipoint:o.a,point:s.a,polyline:l.a,polygon:c.a}};Object(n.k)(u)},function(e,t,r){"use strict";e.exports=r(693)},function(e,t,r){"use strict";r.d(t,"a",(function(){return l})),r.d(t,"b",(function(){return a})),r.d(t,"c",(function(){return o})),r.d(t,"d",(function(){return s})),r.d(t,"e",(function(){return c}));var n=r(3),i=r(23);function a(e,t,r){return Object(i.k)(e.map((function(e,n){return t.apply(r,[e,n])})))}function o(e,t,r){return Object(i.k)(e.map((function(e,n){return t.apply(r,[e,n])}))).then((function(e){return e.map((function(e){return e.value}))}))}function s(e){return Object(n.i)(e)?Object(i.v)():e.then((function(e){return{ok:!0,value:e}})).catch((function(e){return{ok:!1,error:e}}))}function c(e){return e.then((function(e){return{ok:!0,value:e}})).catch((function(e){return Object(i.w)(e),{ok:!1,error:e}}))}function l(e){if(!0===e.ok)return e.value;throw e.error}},function(e,t,r){"use strict";r.d(t,"a",(function(){return l})),r.d(t,"b",(function(){return n})),r.d(t,"c",(function(){return c})),r.d(t,"d",(function(){return o})),r.d(t,"e",(function(){return s}));var n,i=r(17),a=r(39),o=(r(301),"4.20"),s={request:function(e,t){var n,i=null==(n=e.options)?void 0:n.responseType;return Promise.resolve().then(r.bind(null,99)).then((function(r){var n=r.default,a=e.options||{};return a.responseType="native"===i||"native-request-init"===i?"native-request-init":"array-buffer",a.signal=null==t?void 0:t.signal,n(e.url,a)})).then((function(e){var t={data:e.data,ssl:e.ssl};return"native-request-init"===e.requestOptions.responseType?(delete t.data.signal,t):{result:t,transferList:[t.data]}}))}};function c(e){n=e}function l(e){var t=n&&n.findCredential(e);return t&&t.token?Object(a.d)(e,"token",t.token):e}Object(i.a)("host-webworker")||(Object(i.a)("edge")||Object(i.a)("trident"))&&console.warn("Deprecated browser - see http://esriurl.com/oldbrowser")},function(e,t,r){"use strict";r.d(t,"a",(function(){return a})),r.d(t,"b",(function(){return d})),r.d(t,"c",(function(){return p})),r.d(t,"d",(function(){return s})),r.d(t,"e",(function(){return o})),r.d(t,"f",(function(){return c}));var n=r(3),i=r(39);function a(e,t){var r=t&&t.url&&t.url.path;if(e&&r&&(e=Object(i.A)(e,r,{preserveProtocolRelative:!0}),t.portalItem&&t.readResourcePaths)){var n=Object(i.C)(e,t.portalItem.itemUrl);u.test(n)&&t.readResourcePaths.push(t.portalItem.resourceFromPath(n).path)}return f(e,t&&t.portal)}function o(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if(!e)return e;!Object(i.s)(e)&&t&&t.blockedRelativeUrls&&t.blockedRelativeUrls.push(e);var n=Object(i.A)(e);if(t){var a=t.verifyItemRelativeUrls&&t.verifyItemRelativeUrls.rootPath||t.url&&t.url.path;if(a){var o=f(a,t.portal);(n=Object(i.C)(f(n,t.portal),o,o))!==e&&t.verifyItemRelativeUrls&&t.verifyItemRelativeUrls.writtenUrls.push(n)}}return n=h(n,t&&t.portal),Object(i.s)(n)&&(n=Object(i.D)(n)),null!=t&&t.resources&&null!=t&&t.portalItem&&!Object(i.s)(n)&&!Object(i.u)(n)&&0===r&&t.resources.toKeep.push({resource:t.portalItem.resourceFromPath(n)}),n}function s(e,t,r){return a(e,r)}function c(e,t,r,n){var i=o(e,n);void 0!==i&&(t[r]=i)}var l=/\/items\/([^\/]+)\/resources\//,u=/^\.\/resources\//;function d(e){var t=Object(n.j)(e)?e.match(l):null;return Object(n.j)(t)?t[1]:null}function h(e,t){return t&&!t.isPortal&&t.urlKey&&t.customBaseUrl?Object(i.h)(e,"".concat(t.urlKey,".").concat(t.customBaseUrl),t.portalHostname):e}function f(e,t){if(!t||t.isPortal||!t.urlKey||!t.customBaseUrl)return e;var r="".concat(t.urlKey,".").concat(t.customBaseUrl);return Object(i.q)(i.g,"".concat(i.g.scheme,"://").concat(r))?Object(i.h)(e,t.portalHostname,r):Object(i.h)(e,r,t.portalHostname)}var p=Object.freeze({__proto__:null,fromJSON:a,toJSON:o,read:s,write:c,itemIdFromResourceUrl:d})},function(e,t,r){"use strict";r.d(t,"a",(function(){return s})),r.d(t,"b",(function(){return c})),r.d(t,"c",(function(){return l}));var n=r(49),i=r(28),a=r(18),o=r(248);var s={type:n.a,json:{type:[a.a],default:null,read:{source:["color","transparency"],reader:function(e,t){var r=null!=t.transparency?Object(o.b)(t.transparency):1,i=t.color;return i&&Array.isArray(i)?new n.a([i[0]||0,i[1]||0,i[2]||0,r]):null}},write:{target:{color:{type:[a.a]},transparency:{type:a.a}},writer:function(e,t){t.color=e.toJSON().slice(0,3);var r=Object(o.a)(e.a);0!==r&&(t.transparency=r)}}}},c={type:Number,cast:i.j,json:{write:!0}},l={type:[Number],cast:function(e){return null!=e?e:Array.isArray(e)?e.map(i.j):null},json:{read:!1,write:!1}}},function(e,t,r){"use strict";r.d(t,"a",(function(){return s}));var n,i,a=r(12),o=r(11);function s(e,t){t.linearDepth?e.vertex.code.add(Object(o.a)(n||(n=Object(a.a)(["vec4 transformPositionWithDepth(mat4 proj, mat4 view, vec3 pos, vec2 nearFar, out float depth) {\nvec4 eye = view * vec4(pos, 1.0);\ndepth = (-eye.z - nearFar[0]) / (nearFar[1] - nearFar[0]) ;\nreturn proj * eye;\n}"])))):e.vertex.code.add(Object(o.a)(i||(i=Object(a.a)(["vec4 transformPosition(mat4 proj, mat4 view, vec3 pos) {\nreturn proj * (view * vec4(pos, 1.0));\n}"]))))}},function(e,t,r){"use strict";var n=r(14),i=r(13),a=r(8),o=r.n(a),s=r(16),c=r(2),l=r(5),u=r(19),d=r(6),h=r(7),f=r(0),p=(r(343),r(306)),b=r(214),v=r(82),m=r(57),y=(r(17),r(25)),g=r(15),O=r(238),j=r(23),_=r(582),w=r(35),x=r(1),k=r(64),S=r(10),T=r(80),C=r(384),M=r(271),P=(r(463),{handleInterceptedEvent:function(e,t,r,n){return e.scheduleRender(),t.properties["on".concat(n.type)].apply(t.properties.bind||r,[n])}}),A={namespace:void 0,performanceLogger:function(){},eventHandlerInterceptor:void 0,styleApplyer:function(e,t,r){e.style[t]=r}},E=function(e,t){return e.find(t)},R=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=e;return t.forEach((function(e,i){var a,o=null!=(a=n)&&a.children?E(n.children,(function(t){return t.domNode===e})):void 0;r&&!o&&i!==t.length-1||(n=o)})),n},I=r(33),D=r(50),F=r(21),L=r(42),z=r(392);var V=r(517);function N(e){var t="function"===typeof Map?new Map:void 0;return(N=function(e){if(null===e||(r=e,-1===Function.toString.call(r).indexOf("[native code]")))return e;var r;if("function"!==typeof e)throw new TypeError("Super expression must either be null or a function");if("undefined"!==typeof t){if(t.has(e))return t.get(e);t.set(e,n)}function n(){return Object(V.a)(e,arguments,Object(L.a)(this).constructor)}return n.prototype=Object.create(e.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),Object(z.a)(n,e)})(e)}var U,B,G,q,H=!1,W=!0,Q=!0,Z=!0,X=!0,Y=!0,$=!0,J=!0,K=!0,ee=!0,te=!0,re=!0,ne=!0,ie=!0,ae=!0,oe=!0,se=!0,ce=!0,le=!0,ue=!0,de=!0,he=!0,fe=!0,pe=!0,be=!0,ve=!0,me=!0,ye=!0,ge=!0,Oe=!0,je=!0,_e=!1,we=!1,xe=!1,ke=!1,Se=!1,Te=!1,Ce=!1,Me=!1,Pe=!1,Ae=!0,Ee=!1,Re=!0,Ie=!1,De=!1,Fe=!0,Le=!1,ze=!1,Ve=!0,Ne="app",Ue=0,Be=!1,Ge=!1,qe=!1,He=!1,We=0,Qe=!1,Ze="undefined"!==typeof window?window:{},Xe=(De&&Ze.CSS,Ze.document||{head:{}}),Ye=(Ze.HTMLElement,{$flags$:0,$resourcesUrl$:"",jmp:function(e){return e()},raf:function(e){return requestAnimationFrame(e)},ael:function(e,t,r,n){return e.addEventListener(t,r,n)},rel:function(e,t,r,n){return e.removeEventListener(t,r,n)},ce:function(e,t){return new CustomEvent(e,t)}}),$e=!Ie||!ie||function(){return(Xe.head.attachShadow+"").indexOf("[native")>-1}(),Je="sty-id",Ke="http://www.w3.org/1999/xlink",et=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";if(Pe&&performance.mark){var r="st:".concat(e,":").concat(t,":").concat(Ue++);return performance.mark(r),function(){return performance.measure("[Stencil] ".concat(e,"() <").concat(t,">"),r)}}return function(){}},tt=new WeakMap,rt=function(e,t,r,n){var i=it(t,r),a=or.get(i);if(!Ve)return i;if(e=11===e.nodeType?e:Xe,a)if("string"===typeof a){e=e.head||e;var o,s=tt.get(e);if(s||tt.set(e,s=new Set),!s.has(i)){if(Te&&e.host&&(o=e.querySelector("[".concat(Je,'="').concat(i,'"]'))))o.innerHTML=a;else{if(De&&Ye.$cssShim$){var c=(o=Ye.$cssShim$.createHostStyle(n,i,a,!!(10&t.$flags$)))["s-sc"];c&&(i=c,s=null)}else(o=Xe.createElement("style")).innerHTML=a;(Se||_e)&&o.setAttribute(Je,i),e.insertBefore(o,e.querySelector("link"))}s&&s.add(i)}}else Fe&&!e.adoptedStyleSheets.includes(a)&&(e.adoptedStyleSheets=[].concat(Object(D.a)(e.adoptedStyleSheets),[a]));return i},nt=function(e){var t=e.$cmpMeta$,r=e.$hostElement$,n=t.$flags$,i=et("attachStyles",t.$tagName$),a=rt(ie&&$e&&r.shadowRoot?r.shadowRoot:r.getRootNode(),t,e.$modeName$,r);(ie||ne)&&oe&&10&n&&(r["s-sc"]=a,r.classList.add(a+"-h"),ne&&2&n&&r.classList.add(a+"-s")),i()},it=function(e,t){return"sc-"+(te&&t&&32&e.$flags$?e.$tagName$+"-"+t:e.$tagName$)},at={},ot=function(e){return"object"===(e=typeof e)||"function"===e},st=function(e,t){for(var r=null,n=null,i=null,a=!1,o=!1,s=[],c=function t(n){for(var i=0;i<n.length;i++)r=n[i],Array.isArray(r)?t(r):null!=r&&"boolean"!==typeof r&&((a="function"!==typeof e&&!ot(r))?r=String(r):xe&&"function"!==typeof e&&void 0===r.$flags$&&ir("vNode passed as children has unexpected type.\nMake sure it's using the correct h() function.\nEmpty objects can also be the cause, look for JSX comments that became objects."),a&&o?s[s.length-1].$text$+=r:s.push(a?ct(null,r):r),o=a)},l=arguments.length,u=new Array(l>2?l-2:0),d=2;d<l;d++)u[d-2]=arguments[d];if(c(u),t&&(xe&&"input"===e&&pt(t),pe&&t.key&&(n=t.key),Ae&&t.name&&(i=t.name),he)){var h=t.className||t.class;h&&(t.class="object"!==typeof h?h:Object.keys(h).filter((function(e){return h[e]})).join(" "))}if(xe&&s.some(ut)&&ir("The <Host> must be the single root component. Make sure:\n- You are NOT using hostData() and <Host> in the same component.\n- <Host> is used once, and it's the single root component of the render() function."),fe&&"function"===typeof e)return e(null===t?{}:t,s,dt);var f=ct(e,null);return f.$attrs$=t,s.length>0&&(f.$children$=s),pe&&(f.$key$=n),Ae&&(f.$name$=i),f},ct=function(e,t){var r={$flags$:0,$tag$:e,$text$:t,$elm$:null,$children$:null};return ue&&(r.$attrs$=null),pe&&(r.$key$=null),Ae&&(r.$name$=null),r},lt={},ut=function(e){return e&&e.$tag$===lt},dt={forEach:function(e,t){return e.map(ht).forEach(t)},map:function(e,t){return e.map(ht).map(t).map(ft)}},ht=function(e){return{vattrs:e.$attrs$,vchildren:e.$children$,vkey:e.$key$,vname:e.$name$,vtag:e.$tag$,vtext:e.$text$}},ft=function(e){if("function"===typeof e.vtag){var t=Object.assign({},e.vattrs);return e.vkey&&(t.key=e.vkey),e.vname&&(t.name=e.vname),st.apply(void 0,[e.vtag,t].concat(Object(D.a)(e.vchildren||[])))}var r=ct(e.vtag,e.vtext);return r.$attrs$=e.vattrs,r.$children$=e.vchildren,r.$key$=e.vkey,r.$name$=e.vname,r},pt=function(e){var t=Object.keys(e),r=t.indexOf("type"),n=t.indexOf("min"),i=t.indexOf("max"),a=t.indexOf("min"),o=t.indexOf("value");-1!==o&&(o<r||o<n||o<i||o<a)&&ar('The "value" prop of <input> should be set after "min", "max", "type" and "step"')},bt=function(e,t,r,n,i,a){if(r!==n){var o=tr(e,t),s=t.toLowerCase();if(he&&"class"===t){var c=e.classList,l=mt(r),u=mt(n);c.remove.apply(c,Object(D.a)(l.filter((function(e){return e&&!u.includes(e)})))),c.add.apply(c,Object(D.a)(u.filter((function(e){return e&&!l.includes(e)}))))}else if(ge&&"style"===t){if(le)for(var d in r)n&&null!=n[d]||(!Se&&d.includes("-")?e.style.removeProperty(d):e.style[d]="");for(var h in n)r&&n[h]===r[h]||(!Se&&h.includes("-")?e.style.setProperty(h,n[h]):e.style[h]=n[h])}else if(pe&&"key"===t);else if(ve&&"ref"===t)n&&n(e);else if(!be||(Me?o:e.__lookupSetter__(t))||"o"!==t[0]||"n"!==t[1]){if(me){var f=ot(n);if((o||f&&null!==n)&&!i)try{if(e.tagName.includes("-"))e[t]=n;else{var p=null==n?"":n;"list"===t?o=!1:null!=r&&e[t]==p||(e[t]=p)}}catch(v){}var b=!1;de&&s!==(s=s.replace(/^xlink\:?/,""))&&(t=s,b=!0),null==n||!1===n?!1===n&&""!==e.getAttribute(t)||(de&&b?e.removeAttributeNS(Ke,t):e.removeAttribute(t)):(!o||4&a||i)&&!f&&(n=!0===n?"":n,de&&b?e.setAttributeNS(Ke,t,n):e.setAttribute(t,n))}}else t="-"===t[2]?t.slice(3):tr(Ze,s)?s.slice(2):s[2]+t.slice(3),r&&Ye.rel(e,t,r,!1),n&&Ye.ael(e,t,n,!1)}},vt=/\s/,mt=function(e){return e?e.split(vt):[]},yt=function(e,t,r,n){var i=11===t.$elm$.nodeType&&t.$elm$.host?t.$elm$.host:t.$elm$,a=e&&e.$attrs$||at,o=t.$attrs$||at;if(le)for(n in a)n in o||bt(i,n,a[n],void 0,r,t.$flags$);for(n in o)bt(i,n,a[n],o[n],r,t.$flags$)},gt=function e(t,r,n,i){var a,o,s,c=r.$children$[n],l=0;if(Ae&&!Be&&(qe=!0,"slot"===c.$tag$&&(U&&i.classList.add(U+"-s"),c.$flags$|=c.$children$?2:1)),xe&&c.$elm$&&ir("The JSX ".concat(null!==c.$text$?'"'.concat(c.$text$,'" text'):'"'.concat(c.$tag$,'" element')," node should not be shared within the same renderer. The renderer caches element lookups in order to improve performance. However, a side effect from this is that the exact same JSX node should not be reused. For more information please see https://stenciljs.com/docs/templating-jsx#avoid-shared-jsx-nodes")),Oe&&null!==c.$text$)a=c.$elm$=Xe.createTextNode(c.$text$);else if(Ae&&1&c.$flags$)a=c.$elm$=we||Se?Rt(c):Xe.createTextNode("");else{if(ce&&!He&&(He="svg"===c.$tag$),a=c.$elm$=ce?Xe.createElementNS(He?"http://www.w3.org/2000/svg":"http://www.w3.org/1999/xhtml",Ae&&2&c.$flags$?"slot-fb":c.$tag$):Xe.createElement(Ae&&2&c.$flags$?"slot-fb":c.$tag$),ce&&He&&"foreignObject"===c.$tag$&&(He=!1),ue&&yt(null,c,He),(ie||ne)&&null!=U&&a["s-si"]!==U&&a.classList.add(a["s-si"]=U),c.$children$)for(l=0;l<c.$children$.length;++l)(o=e(t,c,l,a))&&a.appendChild(o);ce&&("svg"===c.$tag$?He=!1:"foreignObject"===a.tagName&&(He=!0))}return Ae&&(a["s-hn"]=G,3&c.$flags$&&(a["s-sr"]=!0,a["s-cr"]=B,a["s-sn"]=c.$name$||"",(s=t&&t.$children$&&t.$children$[n])&&s.$tag$===c.$tag$&&t.$elm$&&Ot(t.$elm$,!1))),a},Ot=function e(t,r){Ye.$flags$|=1;for(var n=t.childNodes,i=n.length-1;i>=0;i--){var a=n[i];a["s-hn"]!==G&&a["s-ol"]&&(kt(a).insertBefore(a,xt(a)),a["s-ol"].remove(),a["s-ol"]=void 0,qe=!0),r&&e(a,r)}Ye.$flags$&=-2},jt=function(e,t,r,n,i,a){var o,s=Ae&&e["s-cr"]&&e["s-cr"].parentNode||e;for(ie&&s.shadowRoot&&s.tagName===G&&(s=s.shadowRoot);i<=a;++i)n[i]&&(o=gt(null,r,i,e))&&(n[i].$elm$=o,s.insertBefore(o,Ae?xt(t):t))},_t=function(e,t,r,n,i){for(;t<=r;++t)(n=e[t])&&(i=n.$elm$,At(n),Ae&&(Ge=!0,i["s-ol"]?i["s-ol"].remove():Ot(i,!0)),i.remove())},wt=function(e,t){return e.$tag$===t.$tag$&&(Ae&&"slot"===e.$tag$?e.$name$===t.$name$:!pe||e.$key$===t.$key$)},xt=function(e){return e&&e["s-ol"]||e},kt=function(e){return(e["s-ol"]?e["s-ol"]:e).parentNode},St=function(e,t){var r,n=t.$elm$=e.$elm$,i=e.$children$,a=t.$children$,o=t.$tag$,s=t.$text$;Oe&&null!==s?Oe&&Ae&&(r=n["s-cr"])?r.parentNode.textContent=s:Oe&&e.$text$!==s&&(n.data=s):(ce&&(He="svg"===o||"foreignObject"!==o&&He),(ue||re)&&(ae&&"slot"===o||yt(e,t,He)),le&&null!==i&&null!==a?function(e,t,r,n){for(var i,a,o=0,s=0,c=0,l=0,u=t.length-1,d=t[0],h=t[u],f=n.length-1,p=n[0],b=n[f];o<=u&&s<=f;)if(null==d)d=t[++o];else if(null==h)h=t[--u];else if(null==p)p=n[++s];else if(null==b)b=n[--f];else if(wt(d,p))St(d,p),d=t[++o],p=n[++s];else if(wt(h,b))St(h,b),h=t[--u],b=n[--f];else if(wt(d,b))!Ae||"slot"!==d.$tag$&&"slot"!==b.$tag$||Ot(d.$elm$.parentNode,!1),St(d,b),e.insertBefore(d.$elm$,h.$elm$.nextSibling),d=t[++o],b=n[--f];else if(wt(h,p))!Ae||"slot"!==d.$tag$&&"slot"!==b.$tag$||Ot(h.$elm$.parentNode,!1),St(h,p),e.insertBefore(h.$elm$,d.$elm$),h=t[--u],p=n[++s];else{if(c=-1,pe)for(l=o;l<=u;++l)if(t[l]&&null!==t[l].$key$&&t[l].$key$===p.$key$){c=l;break}pe&&c>=0?((a=t[c]).$tag$!==p.$tag$?i=gt(t&&t[s],r,c,e):(St(a,p),t[c]=void 0,i=a.$elm$),p=n[++s]):(i=gt(t&&t[s],r,s,e),p=n[++s]),i&&(Ae?kt(d.$elm$).insertBefore(i,xt(d.$elm$)):d.$elm$.parentNode.insertBefore(i,d.$elm$))}o>u?jt(e,null==n[f+1]?null:n[f+1].$elm$,r,n,s,f):le&&s>f&&_t(t,o,u)}(n,i,t,a):null!==a?(le&&Oe&&null!==e.$text$&&(n.textContent=""),jt(n,null,t,a,0,a.length-1)):le&&null!==i&&_t(i,0,i.length-1),ce&&He&&"svg"===o&&(He=!1))},Tt=function e(t){var r,n,i,a,o,s,c=t.childNodes;for(n=0,i=c.length;n<i;n++)if(1===(r=c[n]).nodeType){if(r["s-sr"])for(o=r["s-sn"],r.hidden=!1,a=0;a<i;a++)if(s=c[a].nodeType,c[a]["s-hn"]!==r["s-hn"]||""!==o){if(1===s&&o===c[a].getAttribute("slot")){r.hidden=!0;break}}else if(1===s||3===s&&""!==c[a].textContent.trim()){r.hidden=!0;break}e(r)}},Ct=[],Mt=function e(t){for(var r,n,i,a,o,s,c=0,l=t.childNodes,u=l.length;c<u;c++){if((r=l[c])["s-sr"]&&(n=r["s-cr"])&&n.parentNode)for(i=n.parentNode.childNodes,a=r["s-sn"],s=i.length-1;s>=0;s--)(n=i[s])["s-cn"]||n["s-nr"]||n["s-hn"]===r["s-hn"]||(Pt(n,a)?(o=Ct.find((function(e){return e.$nodeToRelocate$===n})),Ge=!0,n["s-sn"]=n["s-sn"]||a,o?o.$slotRefNode$=r:Ct.push({$slotRefNode$:r,$nodeToRelocate$:n}),n["s-sr"]&&Ct.map((function(e){Pt(e.$nodeToRelocate$,n["s-sn"])&&(o=Ct.find((function(e){return e.$nodeToRelocate$===n})))&&!e.$slotRefNode$&&(e.$slotRefNode$=o.$slotRefNode$)}))):Ct.some((function(e){return e.$nodeToRelocate$===n}))||Ct.push({$nodeToRelocate$:n}));1===r.nodeType&&e(r)}},Pt=function(e,t){return 1===e.nodeType?null===e.getAttribute("slot")&&""===t||e.getAttribute("slot")===t:e["s-sn"]===t||""===t},At=function e(t){ve&&(t.$attrs$&&t.$attrs$.ref&&t.$attrs$.ref(null),t.$children$&&t.$children$.map(e))},Et=function(e,t){var r=e.$hostElement$,n=e.$cmpMeta$,i=e.$vnode$||ct(null,null),a=ut(t)?t:st(null,null,t);if(G=r.tagName,xe&&Array.isArray(t)&&t.some(ut))throw new Error('The <Host> must be the single root component.\nLooks like the render() function of "'.concat(G.toLowerCase(),'" is returning an array that contains the <Host>.\n\nThe render() function should look like this instead:\n\nrender() {\n  // Do not return an array\n  return (\n    <Host>{content}</Host>\n  );\n}\n  '));if(re&&n.$attrsToReflect$&&(a.$attrs$=a.$attrs$||{},n.$attrsToReflect$.map((function(e){var t=Object(I.a)(e,2),n=t[0],i=t[1];return a.$attrs$[i]=r[n]}))),a.$tag$=null,a.$flags$|=4,e.$vnode$=a,a.$elm$=i.$elm$=ie&&r.shadowRoot||r,(ne||ie)&&(U=r["s-sc"]),Ae&&(B=r["s-cr"],Be=$e&&0!==(1&n.$flags$),Ge=!1),St(i,a),Ae){if(Ye.$flags$|=1,qe){var o,s,c,l,u,d;Mt(a.$elm$);for(var h=0;h<Ct.length;h++)(s=(o=Ct[h]).$nodeToRelocate$)["s-ol"]||((c=we||Se?It(s):Xe.createTextNode(""))["s-nr"]=s,s.parentNode.insertBefore(s["s-ol"]=c,s));for(h=0;h<Ct.length;h++)if(s=(o=Ct[h]).$nodeToRelocate$,o.$slotRefNode$){for(l=o.$slotRefNode$.parentNode,u=o.$slotRefNode$.nextSibling,c=s["s-ol"];c=c.previousSibling;)if((d=c["s-nr"])&&d["s-sn"]===s["s-sn"]&&l===d.parentNode&&(!(d=d.nextSibling)||!d["s-nr"])){u=d;break}(!u&&l!==s.parentNode||s.nextSibling!==u)&&s!==u&&(!s["s-hn"]&&s["s-ol"]&&(s["s-hn"]=s["s-ol"].parentNode.nodeName),l.insertBefore(s,u))}else 1===s.nodeType&&(s.hidden=!0)}Ge&&Tt(a.$elm$),Ye.$flags$&=-2,Ct.length=0}},Rt=function(e){return Xe.createComment("<slot".concat(e.$name$?' name="'+e.$name$+'"':"","> (host=").concat(G.toLowerCase(),")"))},It=function(e){return Xe.createComment("org-location for "+(e.localName?"<".concat(e.localName,"> (host=").concat(e["s-hn"],")"):"[".concat(e.textContent,"]")))},Dt=function(e,t,r){var n=function(e){return Me?er(e).$hostElement$:e}(e);return{emit:function(e){return xe&&!n.isConnected&&ar('The "'.concat(t,'" event was emitted, but the dispatcher node is no longer connected to the dom.')),Ft(n,t,{bubbles:!!(4&r),composed:!!(2&r),cancelable:!!(1&r),detail:e})}}},Ft=function(e,t,r){var n=Ye.ce(t,r);return e.dispatchEvent(n),n},Lt=function(e,t){Le&&t&&!e.$onRenderResolve$&&t["s-p"]&&t["s-p"].push(new Promise((function(t){return e.$onRenderResolve$=t})))},zt=function(e,t){if(je&&le&&(e.$flags$|=16),!(Le&&4&e.$flags$)){Lt(e,e.$ancestorComponent$);var r=function(){return Vt(e,t)};return je?br(r):r()}e.$flags$|=512},Vt=function(e,t){var r,n=e.$hostElement$,i=et("scheduleUpdate",e.$cmpMeta$.$tagName$),a=Me?e.$lazyInstance$:n;return t?(Me&&K&&(e.$flags$|=256,e.$queuedListeners$&&(e.$queuedListeners$.map((function(e){var t=Object(I.a)(e,2),r=t[0],n=t[1];return Ht(a,r,n)})),e.$queuedListeners$=null)),Qt(n,"componentWillLoad"),X&&(r=Ht(a,"componentWillLoad"))):(Qt(n,"componentWillUpdate"),Y&&(r=Ht(a,"componentWillUpdate"))),Qt(n,"componentWillRender"),$&&(r=Wt(r,(function(){return Ht(a,"componentWillRender")}))),i(),Wt(r,(function(){return Nt(e,a,t)}))},Nt=function(){var e=Object(s.a)(o.a.mark((function e(t,r,n){var i,a,s,c,l,u;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=t.$hostElement$,a=et("update",t.$cmpMeta$.$tagName$),s=i["s-rc"],se&&n&&nt(t),c=et("render",t.$cmpMeta$.$tagName$),xe&&(t.$flags$|=1024),!Se){e.next=11;break}return e.next=9,Ut(t,r,i);case 9:e.next=12;break;case 11:Ut(t,r,i);case 12:if(De&&Ye.$cssShim$&&Ye.$cssShim$.updateHost(i),xe&&(t.$renderCount$++,t.$flags$&=-1025),Se)try{Xt(i),n&&(1&t.$cmpMeta$.$flags$?i["s-en"]="":2&t.$cmpMeta$.$flags$&&(i["s-en"]="c"))}catch(o){rr(o,i)}Le&&s&&(s.map((function(e){return e()})),i["s-rc"]=void 0),c(),a(),Le?(l=i["s-p"],u=function(){return Bt(t)},0===l.length?u():(Promise.all(l).then(u),t.$flags$|=4,l.length=0)):Bt(t);case 19:case"end":return e.stop()}}),e)})));return function(t,r,n){return e.apply(this,arguments)}}(),Ut=function(e,t,r){var n=!!H,i=!!Me,a=!!je,o=!!le;try{if(t,t=(n||t.render)&&t.render(),o&&a&&(e.$flags$&=-17),(o||i)&&(e.$flags$|=2),J||re)if(ye||re){if(Se)return Promise.resolve(t).then((function(t){return Et(e,t)}));Et(e,t)}else r.textContent=t}catch(s){rr(s,e.$hostElement$)}return null,null},Bt=function(e){var t=e.$cmpMeta$.$tagName$,r=e.$hostElement$,n=et("postUpdate",t),i=Me?e.$lazyInstance$:r,a=e.$ancestorComponent$;Z&&(xe&&(e.$flags$|=1024),Ht(i,"componentDidRender"),xe&&(e.$flags$&=-1025)),Qt(r,"componentDidRender"),64&e.$flags$?(Q&&(xe&&(e.$flags$|=1024),Ht(i,"componentDidUpdate"),xe&&(e.$flags$&=-1025)),Qt(r,"componentDidUpdate"),n()):(e.$flags$|=64,Le&&oe&&Zt(r),W&&(xe&&(e.$flags$|=2048),Ht(i,"componentDidLoad"),xe&&(e.$flags$&=-2049)),Qt(r,"componentDidLoad"),n(),Le&&(e.$onReadyResolve$(r),a||qt(t))),_e&&r["s-hmr-load"]&&r["s-hmr-load"](),ee&&Me&&e.$onInstanceResolve$(r),Le&&(e.$onRenderResolve$&&(e.$onRenderResolve$(),e.$onRenderResolve$=void 0),512&e.$flags$&&pr((function(){return zt(e,!1)})),e.$flags$&=-517)},Gt=function(e){if(le){var t=er(e),r=t.$hostElement$.isConnected;return r&&2===(18&t.$flags$)&&zt(t,!1),r}return!1},qt=function(e){oe&&Zt(Xe.documentElement),ze&&(Ye.$flags$|=2),pr((function(){return Ft(Ze,"appload",{detail:{namespace:Ne}})})),Pe&&performance.measure&&performance.measure("[Stencil] ".concat(Ne," initial load (by ").concat(e,")"),"st:app:start")},Ht=function(e,t,r){if(e&&e[t])try{return e[t](r)}catch(n){rr(n)}},Wt=function(e,t){return e&&e.then?e.then(t):t()},Qt=function(e,t){Ce&&Ft(e,"stencil_"+t,{bubbles:!0,composed:!0,detail:{namespace:Ne}})},Zt=function(e){return Re?e.classList.add("hydrated"):Ee?e.setAttribute("hydrated",""):void 0},Xt=function e(t){var r=t.children;if(null!=r)for(var n=0,i=r.length;n<i;n++){var a=r[n];"function"===typeof a.connectedCallback&&a.connectedCallback(),e(a)}},Yt=function(e){$e?e.attachShadow({mode:"open"}):e.shadowRoot=e},$t=function(e){var t=new URL(e,Ye.$resourcesUrl$);return t.origin!==Ze.location.origin?t.href:t.pathname},Jt=function(e,t){return t},Kt=new WeakMap,er=function(e){return Kt.get(e)},tr=function(e,t){return t in e},rr=function(e,t){return(q||console.error)(e,t)},nr=ke?["STENCIL:"]:["%cstencil","color: white;background:#4c47ff;font-weight: bold; font-size:10px; padding:2px 6px; border-radius: 5px"],ir=function(){for(var e,t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return(e=console).error.apply(e,nr.concat(r))},ar=function(){for(var e,t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return(e=console).warn.apply(e,nr.concat(r))},or=new Map,sr=[],cr=[],lr=[],ur=function(e,t){return function(r){e.push(r),Qe||(Qe=!0,t&&4&Ye.$flags$?pr(fr):Ye.raf(fr))}},dr=function(e){for(var t=0;t<e.length;t++)try{e[t](performance.now())}catch(r){rr(r)}e.length=0},hr=function(e,t){for(var r=0,n=0;r<e.length&&(n=performance.now())<t;)try{e[r++](n)}catch(i){rr(i)}r===e.length?e.length=0:0!==r&&e.splice(0,r)},fr=function e(){if(ze&&We++,dr(sr),ze){var t=2===(6&Ye.$flags$)?performance.now()+14*Math.ceil(.1*We):1/0;hr(cr,t),hr(lr,t),cr.length>0&&(lr.push.apply(lr,cr),cr.length=0),(Qe=sr.length+cr.length+lr.length>0)?Ye.raf(e):We=0}else dr(cr),(Qe=sr.length>0)&&Ye.raf(e)},pr=function(e){return Promise.resolve(t).then(e);var t},br=ur(cr,!0),vr=!0;function mr(e,t){var r={Up:"ArrowUp",Down:"ArrowDown",Left:"ArrowLeft",Right:"ArrowRight",Spacebar:" ",Esc:"Escape"}[e]||e,n="rtl"===t;return n&&"ArrowLeft"===r?"ArrowRight":n&&"ArrowRight"===r?"ArrowLeft":r}function yr(e){var t=mr(e);return" "===t||"Spacebar"===t}var gr=["0","1","2","3","4","5","6","7","8","9"],Or=(HTMLElement,"calcite-theme-dark"),jr="calcite--rtl";var _r=function(){return[2,1,1,1,3].map((function(e){for(var t="",r=0;r<e;r++)t+=(65536*(1+Math.random())|0).toString(16).substring(1);return t})).join("-")};function wr(e){return e?e.id=e.id||"".concat(e.tagName.toLowerCase(),"-").concat(_r()):""}function xr(e){return Array.isArray(e)?e:Array.from(e)}function kr(e,t){return Array.from(e.attributes).filter((function(e){return e&&!t.includes(e.name)})).reduce((function(e,t){var r=t.name,n=t.value;return Object.assign(Object.assign({},e),Object(F.a)({},r,n))}),{})}function Sr(e){return Er(".".concat(Or),e)?"dark":"light"}function Tr(e){return Cr(e,"dir","ltr",!0)}function Cr(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i="[".concat(t,"]"),a=n?Er(i,e):e.closest(i);return a?a.getAttribute(t):r}function Mr(e){return e.getRootNode()}function Pr(e){return e.host||null}function Ar(e,t){return function e(r){if(!r)return null;r.assignedSlot&&(r=r.assignedSlot);var n=Mr(r),i=n.querySelector(t),a=Pr(n);return i||(a?e(a):null)}(e)}function Er(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this;function r(t){if(!t||t===document||t===window)return null;var n=t.closest(e);return n||r(t.getRootNode().host)}return r(t)}function Rr(e){return Ir.apply(this,arguments)}function Ir(){return(Ir=Object(s.a)(a.mark((function e(t){return a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return");case 2:"function"===typeof t.setFocus?t.setFocus():t.focus();case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Dr(e,t,r){var n='[slot="'.concat(t,'"]');return(null===r||void 0===r?void 0:r.all)?function(e,t,r){var n=Array.from(e.querySelectorAll(t));n=r&&!1===r.direct?n:n.filter((function(t){return t.parentElement===e}));var i=null===r||void 0===r?void 0:r.selector;return i?n.map((function(e){return Array.from(e.querySelectorAll(i))})).reduce((function(e,t){return[].concat(Object(D.a)(e),Object(D.a)(t))}),[]).filter((function(e){return!!e})):n}(e,n,r):function(e,t,r){var n=e.querySelector(t);n=r&&!1===r.direct||(null===n||void 0===n?void 0:n.parentElement)===e?n:null;var i=null===r||void 0===r?void 0:r.selector;return i?n.querySelector(i):n}(e,n,r)}function Fr(e,t){return Array.from(e.children).filter((function(e){return e.matches(t)}))}function Lr(e,t){return e.contains(t)}function zr(e,t,r){return"string"===typeof t&&""!==t?t:""===t?e[r]:void 0}HTMLElement;var Vr="button",Nr="button--text-visible",Ur="button--compact",Br="icon-container",Gr="slot-container",qr="slot-container--hidden",Hr="text-container",Wr="text-container--visible",Qr="Loading",Zr=(HTMLElement,"chevrons-left"),Xr="chevrons-right";function Yr(e){var t=e.parent,r=e.expanded;Array.from(t.querySelectorAll("calcite-action")).filter((function(e){return"menu-actions"!==e.slot})).forEach((function(e){return e.textEnabled=r})),t.querySelectorAll("calcite-action-group").forEach((function(e){return e.expanded=r}))}var $r=function(e){var t=e.expanded,r=e.intlExpand,n=e.intlCollapse,i=e.toggle,a=e.el,o=e.position,s=e.tooltip,c=e.ref,l="rtl"===Tr(a),u=t?n:r,d=[Zr,Xr];l&&d.reverse();var h="end"===function(e,t){var r;return e||(null===(r=t.closest("calcite-shell-panel"))||void 0===r?void 0:r.position)||"start"}(o,a),f=h?d[1]:d[0],p=h?d[0]:d[1],b=st("calcite-action",{dir:l?"rtl":"ltr",icon:t?f:p,onClick:i,ref:function(e){return function(e){var t=e.tooltip,r=e.referenceElement,n=e.expanded,i=e.ref;return t&&(t.referenceElement=!n&&r),i&&i(r),r}({tooltip:s,referenceElement:e,expanded:t,ref:c})},text:u,textEnabled:t});return s?st("calcite-tooltip-manager",null,b):b},Jr="action-group--bottom",Kr="bottom-actions",en="expand-tooltip",tn="Expand",rn="Collapse",nn=function(e){var t=e.actionCount,r=e.height,n=e.groupCount;return Math.max(t-function(e){var t=e.height,r=e.groupCount;return Math.floor((t-18*r)/50)}({height:r,groupCount:n}),0)},an=(HTMLElement,"menu-actions"),on="menu-tooltip",sn="More",cn="menu-button",ln="menu",un="ellipsis",dn="tooltip";HTMLElement;function hn(e,t){return(e+t)%t}var fn,pn=["ArrowUp","ArrowDown"],bn=["ArrowUp","ArrowDown","End","Home"],vn=(HTMLElement,"action-group--bottom"),mn="container",yn="Expand",gn="Collapse",On="expand-tooltip",jn=(HTMLElement,"close"),_n={slow:14e3,medium:1e4,fast:6e3},wn="title",xn="message",kn="link";!function(e){e.green="checkCircle",e.yellow="exclamationMarkTriangle",e.red="exclamationMarkTriangle",e.blue="lightbulb"}(fn||(fn={}));HTMLElement;function Sn(e){var t=e.r,r=e.g,n=e.b;return"#".concat(t.toString(16).padStart(2,"0")).concat(r.toString(16).padStart(2,"0")).concat(n.toString(16).padStart(2,"0")).toLowerCase()}var Tn=/^[0-9A-F]$/i,Cn=/^#[0-9A-F]{3}$/i,Mn=/^#[0-9A-F]{6}$/i;function Pn(e){return An(e)||En(e)}function An(e){return e&&4===e.length&&Cn.test(e)}function En(e){return e&&7===e.length&&Mn.test(e)}function Rn(e){return(e=e.toLowerCase()).startsWith("#")||(e="#".concat(e)),An(e)?Sn(In(e)):e}function In(e){if(!Pn(e))return null;if(3===(e=e.replace("#","")).length){var t=e.split(""),r=Object(I.a)(t,3),n=r[0],i=r[1],a=r[2];return{r:parseInt("".concat(n).concat(n),16),g:parseInt("".concat(i).concat(i),16),b:parseInt("".concat(a).concat(a),16)}}return{r:parseInt(e.slice(0,2),16),g:parseInt(e.slice(2,4),16),b:parseInt(e.slice(4,6),16)}}var Dn={HEX:"hex",HEXA:"hexa",RGB_CSS:"rgb-css",RGBA_CSS:"rgba-css",HSL_CSS:"hsl-css",HSLA_CSS:"hsla-css"},Fn={RGB:"rgb",RGBA:"rgba",HSL:"hsl",HSLA:"hsla",HSV:"hsv",HSVA:"hsva"};function Ln(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return r.every((function(t){return t&&e&&"".concat(t)in e}))}function zn(e,t){return(null===e||void 0===e?void 0:e.rgbNumber())===(null===t||void 0===t?void 0:t.rgbNumber())}function Vn(e){return function(e){var t=e.r,r=e.g,n=e.b;t/=255,r/=255,n/=255;var i=Math.max(t,r,n),a=Math.min(t,r,n),o=i-a;if(i===a)return 0;var s=(i+a)/2;switch(i){case t:s=(r-n)/o+(r<n?6:0);break;case r:s=(n-t)/o+2;break;case n:s=(t-r)/o+4}return Math.round(60*s)}(In(e))}HTMLElement;var Nn="article",Un="content",Bn="header-container",Gn="icon",qn="toggle",Hn="toggle-icon",Wn="title",Qn="heading",Zn="header",Xn="summary",Yn="control-container",$n="Collapse",Jn="Expand",Kn="Loading",ei="icon",ti="control",ri="chevron-up",ni="chevron-down";function ii(e){return Math.min(Math.max(Math.ceil(e),1),6)}var ai=function(e,t){var r="h".concat(e.level);return delete e.level,st(r,Object.assign({},e),t)},oi=(HTMLElement,"content"),si="toggle",ci="toggle--switch",li="toggle--switch__text",ui="section-header",di="section-header__text",hi="Collapse",fi="Expand",pi="chevron-down",bi="chevron-left",vi="chevron-right",mi=(HTMLElement,"calcite-button--loader"),yi="content",gi="content--slotted",Oi="icon",ji="icon--start",_i="icon--end",wi="Loading",xi=(HTMLElement,"container"),ki="header",Si="footer",Ti="thumbnail-wrapper",Ci="checkbox-wrapper",Mi="thumbnail",Pi="title",Ai="subtitle",Ei="footer-leading",Ri="footer-trailing",Ii="Select",Di="Deselect",Fi="Loading",Li=(HTMLElement,"\n  bottom: 0 !important;\n  left: 0 !important;\n  margin: 0 !important;\n  opacity: 0 !important;\n  outline: none !important;\n  padding: 0 !important;\n  position: absolute !important;\n  right: 0 !important;\n  top: 0 !important;\n  transform: none !important;\n  -webkit-appearance: none !important;\n  z-index: -1 !important;\n"),zi=(HTMLElement,"close"),Vi="close";HTMLElement;function Ni(e,t,r){return e(r={path:t,exports:{},require:function(e,t){return function(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}()}},r.exports),r.exports}var Ui={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]},Bi=Ni((function(e){var t=Array.prototype.concat,r=Array.prototype.slice,n=e.exports=function(e){for(var n,i=[],a=0,o=e.length;a<o;a++){var s=e[a];(n=s)&&"string"!==typeof n&&(n instanceof Array||Array.isArray(n)||n.length>=0&&(n.splice instanceof Function||Object.getOwnPropertyDescriptor(n,n.length-1)&&"String"!==n.constructor.name))?i=t.call(i,r.call(s)):i.push(s)}return i};n.wrap=function(e){return function(){return e(n(arguments))}}})),Gi=Ni((function(e){var t={};for(var r in Ui)Ui.hasOwnProperty(r)&&(t[Ui[r]]=r);var n=e.exports={to:{},get:{}};function i(e,t,r){return Math.min(Math.max(t,e),r)}function a(e){var t=e.toString(16).toUpperCase();return t.length<2?"0"+t:t}n.get=function(e){var t,r;switch(e.substring(0,3).toLowerCase()){case"hsl":t=n.get.hsl(e),r="hsl";break;case"hwb":t=n.get.hwb(e),r="hwb";break;default:t=n.get.rgb(e),r="rgb"}return t?{model:r,value:t}:null},n.get.rgb=function(e){if(!e)return null;var t,r,n,a=[0,0,0,1];if(t=e.match(/^#([a-f0-9]{6})([a-f0-9]{2})?$/i)){for(n=t[2],t=t[1],r=0;r<3;r++){var o=2*r;a[r]=parseInt(t.slice(o,o+2),16)}n&&(a[3]=parseInt(n,16)/255)}else if(t=e.match(/^#([a-f0-9]{3,4})$/i)){for(n=(t=t[1])[3],r=0;r<3;r++)a[r]=parseInt(t[r]+t[r],16);n&&(a[3]=parseInt(n+n,16)/255)}else if(t=e.match(/^rgba?\(\s*([+-]?\d+)\s*,\s*([+-]?\d+)\s*,\s*([+-]?\d+)\s*(?:,\s*([+-]?[\d\.]+)\s*)?\)$/)){for(r=0;r<3;r++)a[r]=parseInt(t[r+1],0);t[4]&&(a[3]=parseFloat(t[4]))}else{if(!(t=e.match(/^rgba?\(\s*([+-]?[\d\.]+)\%\s*,\s*([+-]?[\d\.]+)\%\s*,\s*([+-]?[\d\.]+)\%\s*(?:,\s*([+-]?[\d\.]+)\s*)?\)$/)))return(t=e.match(/(\D+)/))?"transparent"===t[1]?[0,0,0,0]:(a=Ui[t[1]])?(a[3]=1,a):null:null;for(r=0;r<3;r++)a[r]=Math.round(2.55*parseFloat(t[r+1]));t[4]&&(a[3]=parseFloat(t[4]))}for(r=0;r<3;r++)a[r]=i(a[r],0,255);return a[3]=i(a[3],0,1),a},n.get.hsl=function(e){if(!e)return null;var t=e.match(/^hsla?\(\s*([+-]?(?:\d*\.)?\d+)(?:deg)?\s*,\s*([+-]?[\d\.]+)%\s*,\s*([+-]?[\d\.]+)%\s*(?:,\s*([+-]?[\d\.]+)\s*)?\)$/);if(t){var r=parseFloat(t[4]);return[(parseFloat(t[1])+360)%360,i(parseFloat(t[2]),0,100),i(parseFloat(t[3]),0,100),i(isNaN(r)?1:r,0,1)]}return null},n.get.hwb=function(e){if(!e)return null;var t=e.match(/^hwb\(\s*([+-]?\d*[\.]?\d+)(?:deg)?\s*,\s*([+-]?[\d\.]+)%\s*,\s*([+-]?[\d\.]+)%\s*(?:,\s*([+-]?[\d\.]+)\s*)?\)$/);if(t){var r=parseFloat(t[4]);return[(parseFloat(t[1])%360+360)%360,i(parseFloat(t[2]),0,100),i(parseFloat(t[3]),0,100),i(isNaN(r)?1:r,0,1)]}return null},n.to.hex=function(){var e=Bi(arguments);return"#"+a(e[0])+a(e[1])+a(e[2])+(e[3]<1?a(Math.round(255*e[3])):"")},n.to.rgb=function(){var e=Bi(arguments);return e.length<4||1===e[3]?"rgb("+Math.round(e[0])+", "+Math.round(e[1])+", "+Math.round(e[2])+")":"rgba("+Math.round(e[0])+", "+Math.round(e[1])+", "+Math.round(e[2])+", "+e[3]+")"},n.to.rgb.percent=function(){var e=Bi(arguments),t=Math.round(e[0]/255*100),r=Math.round(e[1]/255*100),n=Math.round(e[2]/255*100);return e.length<4||1===e[3]?"rgb("+t+"%, "+r+"%, "+n+"%)":"rgba("+t+"%, "+r+"%, "+n+"%, "+e[3]+")"},n.to.hsl=function(){var e=Bi(arguments);return e.length<4||1===e[3]?"hsl("+e[0]+", "+e[1]+"%, "+e[2]+"%)":"hsla("+e[0]+", "+e[1]+"%, "+e[2]+"%, "+e[3]+")"},n.to.hwb=function(){var e=Bi(arguments),t="";return e.length>=4&&1!==e[3]&&(t=", "+e[3]),"hwb("+e[0]+", "+e[1]+"%, "+e[2]+"%"+t+")"},n.to.keyword=function(e){return t[e.slice(0,3)]}})),qi=Ni((function(e){var t={};for(var r in Ui)Ui.hasOwnProperty(r)&&(t[Ui[r]]=r);var n=e.exports={rgb:{channels:3,labels:"rgb"},hsl:{channels:3,labels:"hsl"},hsv:{channels:3,labels:"hsv"},hwb:{channels:3,labels:"hwb"},cmyk:{channels:4,labels:"cmyk"},xyz:{channels:3,labels:"xyz"},lab:{channels:3,labels:"lab"},lch:{channels:3,labels:"lch"},hex:{channels:1,labels:["hex"]},keyword:{channels:1,labels:["keyword"]},ansi16:{channels:1,labels:["ansi16"]},ansi256:{channels:1,labels:["ansi256"]},hcg:{channels:3,labels:["h","c","g"]},apple:{channels:3,labels:["r16","g16","b16"]},gray:{channels:1,labels:["gray"]}};for(var i in n)if(n.hasOwnProperty(i)){if(!("channels"in n[i]))throw new Error("missing channels property: "+i);if(!("labels"in n[i]))throw new Error("missing channel labels property: "+i);if(n[i].labels.length!==n[i].channels)throw new Error("channel and label counts mismatch: "+i);var a=n[i].channels,o=n[i].labels;delete n[i].channels,delete n[i].labels,Object.defineProperty(n[i],"channels",{value:a}),Object.defineProperty(n[i],"labels",{value:o})}n.rgb.hsl=function(e){var t,r,n=e[0]/255,i=e[1]/255,a=e[2]/255,o=Math.min(n,i,a),s=Math.max(n,i,a),c=s-o;return s===o?t=0:n===s?t=(i-a)/c:i===s?t=2+(a-n)/c:a===s&&(t=4+(n-i)/c),(t=Math.min(60*t,360))<0&&(t+=360),r=(o+s)/2,[t,100*(s===o?0:r<=.5?c/(s+o):c/(2-s-o)),100*r]},n.rgb.hsv=function(e){var t,r,n,i,a,o=e[0]/255,s=e[1]/255,c=e[2]/255,l=Math.max(o,s,c),u=l-Math.min(o,s,c),d=function(e){return(l-e)/6/u+.5};return 0===u?i=a=0:(a=u/l,t=d(o),r=d(s),n=d(c),o===l?i=n-r:s===l?i=1/3+t-n:c===l&&(i=2/3+r-t),i<0?i+=1:i>1&&(i-=1)),[360*i,100*a,100*l]},n.rgb.hwb=function(e){var t=e[0],r=e[1],i=e[2];return[n.rgb.hsl(e)[0],100*(1/255*Math.min(t,Math.min(r,i))),100*(i=1-1/255*Math.max(t,Math.max(r,i)))]},n.rgb.cmyk=function(e){var t,r=e[0]/255,n=e[1]/255,i=e[2]/255;return[100*((1-r-(t=Math.min(1-r,1-n,1-i)))/(1-t)||0),100*((1-n-t)/(1-t)||0),100*((1-i-t)/(1-t)||0),100*t]},n.rgb.keyword=function(e){var r=t[e];if(r)return r;var n,i,a,o=1/0;for(var s in Ui)if(Ui.hasOwnProperty(s)){var c=Ui[s],l=(i=e,a=c,Math.pow(i[0]-a[0],2)+Math.pow(i[1]-a[1],2)+Math.pow(i[2]-a[2],2));l<o&&(o=l,n=s)}return n},n.keyword.rgb=function(e){return Ui[e]},n.rgb.xyz=function(e){var t=e[0]/255,r=e[1]/255,n=e[2]/255;return[100*(.4124*(t=t>.04045?Math.pow((t+.055)/1.055,2.4):t/12.92)+.3576*(r=r>.04045?Math.pow((r+.055)/1.055,2.4):r/12.92)+.1805*(n=n>.04045?Math.pow((n+.055)/1.055,2.4):n/12.92)),100*(.2126*t+.7152*r+.0722*n),100*(.0193*t+.1192*r+.9505*n)]},n.rgb.lab=function(e){var t=n.rgb.xyz(e),r=t[0],i=t[1],a=t[2];return i/=100,a/=108.883,r=(r/=95.047)>.008856?Math.pow(r,1/3):7.787*r+16/116,[116*(i=i>.008856?Math.pow(i,1/3):7.787*i+16/116)-16,500*(r-i),200*(i-(a=a>.008856?Math.pow(a,1/3):7.787*a+16/116))]},n.hsl.rgb=function(e){var t,r,n,i,a,o=e[0]/360,s=e[1]/100,c=e[2]/100;if(0===s)return[a=255*c,a,a];t=2*c-(r=c<.5?c*(1+s):c+s-c*s),i=[0,0,0];for(var l=0;l<3;l++)(n=o+1/3*-(l-1))<0&&n++,n>1&&n--,a=6*n<1?t+6*(r-t)*n:2*n<1?r:3*n<2?t+(r-t)*(2/3-n)*6:t,i[l]=255*a;return i},n.hsl.hsv=function(e){var t=e[0],r=e[1]/100,n=e[2]/100,i=r,a=Math.max(n,.01);return r*=(n*=2)<=1?n:2-n,i*=a<=1?a:2-a,[t,100*(0===n?2*i/(a+i):2*r/(n+r)),100*((n+r)/2)]},n.hsv.rgb=function(e){var t=e[0]/60,r=e[1]/100,n=e[2]/100,i=Math.floor(t)%6,a=t-Math.floor(t),o=255*n*(1-r),s=255*n*(1-r*a),c=255*n*(1-r*(1-a));switch(n*=255,i){case 0:return[n,c,o];case 1:return[s,n,o];case 2:return[o,n,c];case 3:return[o,s,n];case 4:return[c,o,n];case 5:return[n,o,s]}},n.hsv.hsl=function(e){var t,r,n,i=e[0],a=e[1]/100,o=e[2]/100,s=Math.max(o,.01);return n=(2-a)*o,r=a*s,[i,100*(r=(r/=(t=(2-a)*s)<=1?t:2-t)||0),100*(n/=2)]},n.hwb.rgb=function(e){var t,r,n,i,a,o,s,c=e[0]/360,l=e[1]/100,u=e[2]/100,d=l+u;switch(d>1&&(l/=d,u/=d),n=6*c-(t=Math.floor(6*c)),0!==(1&t)&&(n=1-n),i=l+n*((r=1-u)-l),t){default:case 6:case 0:a=r,o=i,s=l;break;case 1:a=i,o=r,s=l;break;case 2:a=l,o=r,s=i;break;case 3:a=l,o=i,s=r;break;case 4:a=i,o=l,s=r;break;case 5:a=r,o=l,s=i}return[255*a,255*o,255*s]},n.cmyk.rgb=function(e){var t=e[0]/100,r=e[1]/100,n=e[2]/100,i=e[3]/100;return[255*(1-Math.min(1,t*(1-i)+i)),255*(1-Math.min(1,r*(1-i)+i)),255*(1-Math.min(1,n*(1-i)+i))]},n.xyz.rgb=function(e){var t,r,n,i=e[0]/100,a=e[1]/100,o=e[2]/100;return r=-.9689*i+1.8758*a+.0415*o,n=.0557*i+-.204*a+1.057*o,t=(t=3.2406*i+-1.5372*a+-.4986*o)>.0031308?1.055*Math.pow(t,1/2.4)-.055:12.92*t,r=r>.0031308?1.055*Math.pow(r,1/2.4)-.055:12.92*r,n=n>.0031308?1.055*Math.pow(n,1/2.4)-.055:12.92*n,[255*(t=Math.min(Math.max(0,t),1)),255*(r=Math.min(Math.max(0,r),1)),255*(n=Math.min(Math.max(0,n),1))]},n.xyz.lab=function(e){var t=e[0],r=e[1],n=e[2];return r/=100,n/=108.883,t=(t/=95.047)>.008856?Math.pow(t,1/3):7.787*t+16/116,[116*(r=r>.008856?Math.pow(r,1/3):7.787*r+16/116)-16,500*(t-r),200*(r-(n=n>.008856?Math.pow(n,1/3):7.787*n+16/116))]},n.lab.xyz=function(e){var t,r,n,i=e[0];t=e[1]/500+(r=(i+16)/116),n=r-e[2]/200;var a=Math.pow(r,3),o=Math.pow(t,3),s=Math.pow(n,3);return r=a>.008856?a:(r-16/116)/7.787,t=o>.008856?o:(t-16/116)/7.787,n=s>.008856?s:(n-16/116)/7.787,[t*=95.047,r*=100,n*=108.883]},n.lab.lch=function(e){var t,r=e[0],n=e[1],i=e[2];return(t=360*Math.atan2(i,n)/2/Math.PI)<0&&(t+=360),[r,Math.sqrt(n*n+i*i),t]},n.lch.lab=function(e){var t,r=e[0],n=e[1];return t=e[2]/360*2*Math.PI,[r,n*Math.cos(t),n*Math.sin(t)]},n.rgb.ansi16=function(e){var t=e[0],r=e[1],i=e[2],a=1 in arguments?arguments[1]:n.rgb.hsv(e)[2];if(0===(a=Math.round(a/50)))return 30;var o=30+(Math.round(i/255)<<2|Math.round(r/255)<<1|Math.round(t/255));return 2===a&&(o+=60),o},n.hsv.ansi16=function(e){return n.rgb.ansi16(n.hsv.rgb(e),e[2])},n.rgb.ansi256=function(e){var t=e[0],r=e[1],n=e[2];return t===r&&r===n?t<8?16:t>248?231:Math.round((t-8)/247*24)+232:16+36*Math.round(t/255*5)+6*Math.round(r/255*5)+Math.round(n/255*5)},n.ansi16.rgb=function(e){var t=e%10;if(0===t||7===t)return e>50&&(t+=3.5),[t=t/10.5*255,t,t];var r=.5*(1+~~(e>50));return[(1&t)*r*255,(t>>1&1)*r*255,(t>>2&1)*r*255]},n.ansi256.rgb=function(e){if(e>=232){var t=10*(e-232)+8;return[t,t,t]}var r;return e-=16,[Math.floor(e/36)/5*255,Math.floor((r=e%36)/6)/5*255,r%6/5*255]},n.rgb.hex=function(e){var t=(((255&Math.round(e[0]))<<16)+((255&Math.round(e[1]))<<8)+(255&Math.round(e[2]))).toString(16).toUpperCase();return"000000".substring(t.length)+t},n.hex.rgb=function(e){var t=e.toString(16).match(/[a-f0-9]{6}|[a-f0-9]{3}/i);if(!t)return[0,0,0];var r=t[0];3===t[0].length&&(r=r.split("").map((function(e){return e+e})).join(""));var n=parseInt(r,16);return[n>>16&255,n>>8&255,255&n]},n.rgb.hcg=function(e){var t,r=e[0]/255,n=e[1]/255,i=e[2]/255,a=Math.max(Math.max(r,n),i),o=Math.min(Math.min(r,n),i),s=a-o;return t=s<=0?0:a===r?(n-i)/s%6:a===n?2+(i-r)/s:4+(r-n)/s+4,t/=6,[360*(t%=1),100*s,100*(s<1?o/(1-s):0)]},n.hsl.hcg=function(e){var t=e[1]/100,r=e[2]/100,n=1,i=0;return(n=r<.5?2*t*r:2*t*(1-r))<1&&(i=(r-.5*n)/(1-n)),[e[0],100*n,100*i]},n.hsv.hcg=function(e){var t=e[1]/100,r=e[2]/100,n=t*r,i=0;return n<1&&(i=(r-n)/(1-n)),[e[0],100*n,100*i]},n.hcg.rgb=function(e){var t=e[0]/360,r=e[1]/100,n=e[2]/100;if(0===r)return[255*n,255*n,255*n];var i,a=[0,0,0],o=t%1*6,s=o%1,c=1-s;switch(Math.floor(o)){case 0:a[0]=1,a[1]=s,a[2]=0;break;case 1:a[0]=c,a[1]=1,a[2]=0;break;case 2:a[0]=0,a[1]=1,a[2]=s;break;case 3:a[0]=0,a[1]=c,a[2]=1;break;case 4:a[0]=s,a[1]=0,a[2]=1;break;default:a[0]=1,a[1]=0,a[2]=c}return i=(1-r)*n,[255*(r*a[0]+i),255*(r*a[1]+i),255*(r*a[2]+i)]},n.hcg.hsv=function(e){var t=e[1]/100,r=t+e[2]/100*(1-t),n=0;return r>0&&(n=t/r),[e[0],100*n,100*r]},n.hcg.hsl=function(e){var t=e[1]/100,r=e[2]/100*(1-t)+.5*t,n=0;return r>0&&r<.5?n=t/(2*r):r>=.5&&r<1&&(n=t/(2*(1-r))),[e[0],100*n,100*r]},n.hcg.hwb=function(e){var t=e[1]/100,r=t+e[2]/100*(1-t);return[e[0],100*(r-t),100*(1-r)]},n.hwb.hcg=function(e){var t=e[1]/100,r=1-e[2]/100,n=r-t,i=0;return n<1&&(i=(r-n)/(1-n)),[e[0],100*n,100*i]},n.apple.rgb=function(e){return[e[0]/65535*255,e[1]/65535*255,e[2]/65535*255]},n.rgb.apple=function(e){return[e[0]/255*65535,e[1]/255*65535,e[2]/255*65535]},n.gray.rgb=function(e){return[e[0]/100*255,e[0]/100*255,e[0]/100*255]},n.gray.hsl=n.gray.hsv=function(e){return[0,0,e[0]]},n.gray.hwb=function(e){return[0,100,e[0]]},n.gray.cmyk=function(e){return[0,0,0,e[0]]},n.gray.lab=function(e){return[e[0],0,0]},n.gray.hex=function(e){var t=255&Math.round(e[0]/100*255),r=((t<<16)+(t<<8)+t).toString(16).toUpperCase();return"000000".substring(r.length)+r},n.rgb.gray=function(e){return[(e[0]+e[1]+e[2])/3/255*100]}}));function Hi(e){var t=function(){for(var e={},t=Object.keys(qi),r=t.length,n=0;n<r;n++)e[t[n]]={distance:-1,parent:null};return e}(),r=[e];for(t[e].distance=0;r.length;)for(var n=r.pop(),i=Object.keys(qi[n]),a=i.length,o=0;o<a;o++){var s=i[o],c=t[s];-1===c.distance&&(c.distance=t[n].distance+1,c.parent=n,r.unshift(s))}return t}function Wi(e,t){return function(r){return t(e(r))}}function Qi(e,t){for(var r=[t[e].parent,e],n=qi[t[e].parent][e],i=t[e].parent;t[i].parent;)r.unshift(t[i].parent),n=Wi(qi[t[i].parent][i],n),i=t[i].parent;return n.conversion=r,n}var Zi={};Object.keys(qi).forEach((function(e){Zi[e]={},Object.defineProperty(Zi[e],"channels",{value:qi[e].channels}),Object.defineProperty(Zi[e],"labels",{value:qi[e].labels});var t=function(e){for(var t=Hi(e),r={},n=Object.keys(t),i=n.length,a=0;a<i;a++){var o=n[a];null!==t[o].parent&&(r[o]=Qi(o,t))}return r}(e);Object.keys(t).forEach((function(r){var n=t[r];Zi[e][r]=function(e){var t=function(t){if(void 0===t||null===t)return t;arguments.length>1&&(t=Array.prototype.slice.call(arguments));var r=e(t);if("object"===typeof r)for(var n=r.length,i=0;i<n;i++)r[i]=Math.round(r[i]);return r};return"conversion"in e&&(t.conversion=e.conversion),t}(n),Zi[e][r].raw=function(e){var t=function(t){return void 0===t||null===t?t:(arguments.length>1&&(t=Array.prototype.slice.call(arguments)),e(t))};return"conversion"in e&&(t.conversion=e.conversion),t}(n)}))}));var Xi=Zi,Yi=[].slice,$i=["keyword","gray","hex"],Ji={};Object.keys(Xi).forEach((function(e){Ji[Yi.call(Xi[e].labels).sort().join("")]=e}));var Ki={};function ea(e,t){if(!(this instanceof ea))return new ea(e,t);if(t&&t in $i&&(t=null),t&&!(t in Xi))throw new Error("Unknown model: "+t);var r,n;if(null==e)this.model="rgb",this.color=[0,0,0],this.valpha=1;else if(e instanceof ea)this.model=e.model,this.color=e.color.slice(),this.valpha=e.valpha;else if("string"===typeof e){var i=Gi.get(e);if(null===i)throw new Error("Unable to parse color from string: "+e);this.model=i.model,n=Xi[this.model].channels,this.color=i.value.slice(0,n),this.valpha="number"===typeof i.value[n]?i.value[n]:1}else if(e.length){this.model=t||"rgb",n=Xi[this.model].channels;var a=Yi.call(e,0,n);this.color=ia(a,n),this.valpha="number"===typeof e[n]?e[n]:1}else if("number"===typeof e)e&=16777215,this.model="rgb",this.color=[e>>16&255,e>>8&255,255&e],this.valpha=1;else{this.valpha=1;var o=Object.keys(e);"alpha"in e&&(o.splice(o.indexOf("alpha"),1),this.valpha="number"===typeof e.alpha?e.alpha:0);var s=o.sort().join("");if(!(s in Ji))throw new Error("Unable to parse color from object: "+JSON.stringify(e));this.model=Ji[s];var c=Xi[this.model].labels,l=[];for(r=0;r<c.length;r++)l.push(e[c[r]]);this.color=ia(l)}if(Ki[this.model])for(n=Xi[this.model].channels,r=0;r<n;r++){var u=Ki[this.model][r];u&&(this.color[r]=u(this.color[r]))}this.valpha=Math.max(0,Math.min(1,this.valpha)),Object.freeze&&Object.freeze(this)}function ta(e,t,r){return(e=Array.isArray(e)?e:[e]).forEach((function(e){(Ki[e]||(Ki[e]=[]))[t]=r})),e=e[0],function(n){var i;return arguments.length?(r&&(n=r(n)),(i=this[e]()).color[t]=n,i):(i=this[e]().color[t],r&&(i=r(i)),i)}}function ra(e){return function(t){return Math.max(0,Math.min(e,t))}}function na(e){return Array.isArray(e)?e:[e]}function ia(e,t){for(var r=0;r<t;r++)"number"!==typeof e[r]&&(e[r]=0);return e}ea.prototype={toString:function(){return this.string()},toJSON:function(){return this[this.model]()},string:function(e){var t=this.model in Gi.to?this:this.rgb(),r=1===(t=t.round("number"===typeof e?e:1)).valpha?t.color:t.color.concat(this.valpha);return Gi.to[t.model](r)},percentString:function(e){var t=this.rgb().round("number"===typeof e?e:1),r=1===t.valpha?t.color:t.color.concat(this.valpha);return Gi.to.rgb.percent(r)},array:function(){return 1===this.valpha?this.color.slice():this.color.concat(this.valpha)},object:function(){for(var e={},t=Xi[this.model].channels,r=Xi[this.model].labels,n=0;n<t;n++)e[r[n]]=this.color[n];return 1!==this.valpha&&(e.alpha=this.valpha),e},unitArray:function(){var e=this.rgb().color;return e[0]/=255,e[1]/=255,e[2]/=255,1!==this.valpha&&e.push(this.valpha),e},unitObject:function(){var e=this.rgb().object();return e.r/=255,e.g/=255,e.b/=255,1!==this.valpha&&(e.alpha=this.valpha),e},round:function(e){return e=Math.max(e||0,0),new ea(this.color.map(function(e){return function(t){return function(e,t){return Number(e.toFixed(t))}(t,e)}}(e)).concat(this.valpha),this.model)},alpha:function(e){return arguments.length?new ea(this.color.concat(Math.max(0,Math.min(1,e))),this.model):this.valpha},red:ta("rgb",0,ra(255)),green:ta("rgb",1,ra(255)),blue:ta("rgb",2,ra(255)),hue:ta(["hsl","hsv","hsl","hwb","hcg"],0,(function(e){return(e%360+360)%360})),saturationl:ta("hsl",1,ra(100)),lightness:ta("hsl",2,ra(100)),saturationv:ta("hsv",1,ra(100)),value:ta("hsv",2,ra(100)),chroma:ta("hcg",1,ra(100)),gray:ta("hcg",2,ra(100)),white:ta("hwb",1,ra(100)),wblack:ta("hwb",2,ra(100)),cyan:ta("cmyk",0,ra(100)),magenta:ta("cmyk",1,ra(100)),yellow:ta("cmyk",2,ra(100)),black:ta("cmyk",3,ra(100)),x:ta("xyz",0,ra(100)),y:ta("xyz",1,ra(100)),z:ta("xyz",2,ra(100)),l:ta("lab",0,ra(100)),a:ta("lab",1),b:ta("lab",2),keyword:function(e){return arguments.length?new ea(e):Xi[this.model].keyword(this.color)},hex:function(e){return arguments.length?new ea(e):Gi.to.hex(this.rgb().round().color)},rgbNumber:function(){var e=this.rgb().color;return(255&e[0])<<16|(255&e[1])<<8|255&e[2]},luminosity:function(){for(var e=this.rgb().color,t=[],r=0;r<e.length;r++){var n=e[r]/255;t[r]=n<=.03928?n/12.92:Math.pow((n+.055)/1.055,2.4)}return.2126*t[0]+.7152*t[1]+.0722*t[2]},contrast:function(e){var t=this.luminosity(),r=e.luminosity();return t>r?(t+.05)/(r+.05):(r+.05)/(t+.05)},level:function(e){var t=this.contrast(e);return t>=7.1?"AAA":t>=4.5?"AA":""},isDark:function(){var e=this.rgb().color;return(299*e[0]+587*e[1]+114*e[2])/1e3<128},isLight:function(){return!this.isDark()},negate:function(){for(var e=this.rgb(),t=0;t<3;t++)e.color[t]=255-e.color[t];return e},lighten:function(e){var t=this.hsl();return t.color[2]+=t.color[2]*e,t},darken:function(e){var t=this.hsl();return t.color[2]-=t.color[2]*e,t},saturate:function(e){var t=this.hsl();return t.color[1]+=t.color[1]*e,t},desaturate:function(e){var t=this.hsl();return t.color[1]-=t.color[1]*e,t},whiten:function(e){var t=this.hwb();return t.color[1]+=t.color[1]*e,t},blacken:function(e){var t=this.hwb();return t.color[2]+=t.color[2]*e,t},grayscale:function(){var e=this.rgb().color,t=.3*e[0]+.59*e[1]+.11*e[2];return ea.rgb(t,t,t)},fade:function(e){return this.alpha(this.valpha-this.valpha*e)},opaquer:function(e){return this.alpha(this.valpha+this.valpha*e)},rotate:function(e){var t=this.hsl(),r=t.color[0];return r=(r=(r+e)%360)<0?360+r:r,t.color[0]=r,t},mix:function(e,t){if(!e||!e.rgb)throw new Error('Argument to "mix" was not a Color instance, but rather an instance of '+typeof e);var r=e.rgb(),n=this.rgb(),i=void 0===t?.5:t,a=2*i-1,o=r.alpha()-n.alpha(),s=((a*o===-1?a:(a+o)/(1+a*o))+1)/2,c=1-s;return ea.rgb(s*r.red()+c*n.red(),s*r.green()+c*n.green(),s*r.blue()+c*n.blue(),r.alpha()*i+n.alpha()*(1-i))}},Object.keys(Xi).forEach((function(e){if(-1===$i.indexOf(e)){var t=Xi[e].channels;ea.prototype[e]=function(){if(this.model===e)return new ea(this);if(arguments.length)return new ea(arguments,e);var r="number"===typeof arguments[t]?t:this.valpha;return new ea(na(Xi[this.model][e].raw(this.color)).concat(r),e)},ea[e]=function(r){return"number"===typeof r&&(r=ia(Yi.call(arguments),t)),new ea(r,e)}}}));var aa=ea,oa="container",sa="control-section",ca="color-hex-options",la="section",ua="header",da="control",ha="section--split",fa="header--underlined",pa="color-mode-container",ba="color-mode",va="channels",ma="channel",ya="saved-colors",ga="saved-colors-section",Oa="save-color",ja="delete-color",_a="saved-colors-buttons",wa="header--hex",xa="color-field-and-slider",ka="color-field-and-slider--interactive",Sa="color-field-and-slider-wrap",Ta="scope",Ca="saved-color",Ma=aa("#007AC2"),Pa="calcite-color-",Aa={r:255,g:255,b:255},Ea={h:360,s:100,v:100},Ra="B",Ia="Blue",Da="Delete color",Fa="G",La="Green",za="H",Va="HSV",Na="Hex",Ua="Hue",Ba="No color",Ga="R",qa="Red",Ha="RGB",Wa="S",Qa="Saturation",Za="Save color",Xa="Saved",Ya="V",$a="Value",Ja={s:{slider:{height:10,width:156},colorField:{height:80,width:156},thumb:{radius:8}},m:{slider:{height:14,width:272},colorField:{height:150,width:272},thumb:{radius:10}},l:{slider:{height:16,width:420},colorField:{height:200,width:420},thumb:{radius:12}}},Ka="object"==typeof global&&global&&global.Object===Object&&global,eo="object"==typeof self&&self&&self.Object===Object&&self,to=Ka||eo||Function("return this")(),ro=to.Symbol,no=Object.prototype,io=no.hasOwnProperty,ao=no.toString,oo=ro?ro.toStringTag:void 0;var so=Object.prototype.toString;var co=ro?ro.toStringTag:void 0;function lo(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":co&&co in Object(e)?function(e){var t=io.call(e,oo),r=e[oo];try{e[oo]=void 0;var n=!0}catch(a){}var i=ao.call(e);return n&&(t?e[oo]=r:delete e[oo]),i}(e):function(e){return so.call(e)}(e)}function uo(e){return null!=e&&"object"==typeof e}function ho(e){return"symbol"==typeof e||uo(e)&&"[object Symbol]"==lo(e)}var fo=Array.isArray,po=ro?ro.prototype:void 0,bo=po?po.toString:void 0;function vo(e){if("string"==typeof e)return e;if(fo(e))return function(e,t){for(var r=-1,n=null==e?0:e.length,i=Array(n);++r<n;)i[r]=t(e[r],r,e);return i}(e,vo)+"";if(ho(e))return bo?bo.call(e):"";var t=e+"";return"0"==t&&1/e==-Infinity?"-0":t}var mo=/\s/;var yo=/^\s+/;function go(e){return e?e.slice(0,function(e){for(var t=e.length;t--&&mo.test(e.charAt(t)););return t}(e)+1).replace(yo,""):e}function Oo(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}var jo=/^[-+]0x[0-9a-f]+$/i,_o=/^0b[01]+$/i,wo=/^0o[0-7]+$/i,xo=parseInt;function ko(e){if("number"==typeof e)return e;if(ho(e))return NaN;if(Oo(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=Oo(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=go(e);var r=_o.test(e);return r||wo.test(e)?xo(e.slice(2),r?2:8):jo.test(e)?NaN:+e}function So(e){return e}var To=/^(?:0|[1-9]\d*)$/;function Co(e,t){var r=typeof e;return!!(t=null==t?9007199254740991:t)&&("number"==r||"symbol"!=r&&To.test(e))&&e>-1&&e%1==0&&e<t}function Mo(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=9007199254740991}function Po(e){return null!=e&&Mo(e.length)&&!function(e){if(!Oo(e))return!1;var t=lo(e);return"[object Function]"==t||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t}(e)}var Ao=Object.prototype;function Eo(e){return uo(e)&&"[object Arguments]"==lo(e)}var Ro=Object.prototype,Io=Ro.hasOwnProperty,Do=Ro.propertyIsEnumerable,Fo=Eo(function(){return arguments}())?Eo:function(e){return uo(e)&&Io.call(e,"callee")&&!Do.call(e,"callee")};var Lo="object"==typeof exports&&exports&&!exports.nodeType&&exports,zo=Lo&&"object"==typeof e&&e&&!e.nodeType&&e,Vo=zo&&zo.exports===Lo?to.Buffer:void 0,No=(Vo?Vo.isBuffer:void 0)||function(){return!1},Uo={};Uo["[object Float32Array]"]=Uo["[object Float64Array]"]=Uo["[object Int8Array]"]=Uo["[object Int16Array]"]=Uo["[object Int32Array]"]=Uo["[object Uint8Array]"]=Uo["[object Uint8ClampedArray]"]=Uo["[object Uint16Array]"]=Uo["[object Uint32Array]"]=!0,Uo["[object Arguments]"]=Uo["[object Array]"]=Uo["[object ArrayBuffer]"]=Uo["[object Boolean]"]=Uo["[object DataView]"]=Uo["[object Date]"]=Uo["[object Error]"]=Uo["[object Function]"]=Uo["[object Map]"]=Uo["[object Number]"]=Uo["[object Object]"]=Uo["[object RegExp]"]=Uo["[object Set]"]=Uo["[object String]"]=Uo["[object WeakMap]"]=!1;var Bo,Go="object"==typeof exports&&exports&&!exports.nodeType&&exports,qo=Go&&"object"==typeof e&&e&&!e.nodeType&&e,Ho=qo&&qo.exports===Go&&Ka.process,Wo=function(){try{var e=qo&&qo.require&&qo.require("util").types;return e||Ho&&Ho.binding&&Ho.binding("util")}catch(t){}}(),Qo=Wo&&Wo.isTypedArray,Zo=Qo?(Bo=Qo,function(e){return Bo(e)}):function(e){return uo(e)&&Mo(e.length)&&!!Uo[lo(e)]},Xo=Object.prototype.hasOwnProperty;function Yo(e,t){var r=fo(e),n=!r&&Fo(e),i=!r&&!n&&No(e),a=!r&&!n&&!i&&Zo(e),o=r||n||i||a,s=o?function(e,t){for(var r=-1,n=Array(e);++r<e;)n[r]=t(r);return n}(e.length,String):[],c=s.length;for(var l in e)!t&&!Xo.call(e,l)||o&&("length"==l||i&&("offset"==l||"parent"==l)||a&&("buffer"==l||"byteLength"==l||"byteOffset"==l)||Co(l,c))||s.push(l);return s}var $o=Object.prototype.hasOwnProperty;function Jo(e){if(!Oo(e))return function(e){var t=[];if(null!=e)for(var r in Object(e))t.push(r);return t}(e);var t=function(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||Ao)}(e),r=[];for(var n in e)("constructor"!=n||!t&&$o.call(e,n))&&r.push(n);return r}function Ko(e){return Po(e)?Yo(e,!0):Jo(e)}var es,ts=function(e,t,r){for(var n=-1,i=Object(e),a=r(e),o=a.length;o--;){var s=a[es?o:++n];if(!1===t(i[s],s,i))break}return e},rs=function(){return to.Date.now()},ns=Math.max,is=Math.min;function as(e,t,r){var n,i,a,o,s,c,l=0,u=!1,d=!1,h=!0;if("function"!=typeof e)throw new TypeError("Expected a function");function f(t){var r=n,a=i;return n=i=void 0,l=t,o=e.apply(a,r)}function p(e){return l=e,s=setTimeout(v,t),u?f(e):o}function b(e){var r=e-c;return void 0===c||r>=t||r<0||d&&e-l>=a}function v(){var e=rs();if(b(e))return m(e);s=setTimeout(v,function(e){var r=t-(e-c);return d?is(r,a-(e-l)):r}(e))}function m(e){return s=void 0,h&&n?f(e):(n=i=void 0,o)}function y(){var e=rs(),r=b(e);if(n=arguments,i=this,c=e,r){if(void 0===s)return p(c);if(d)return clearTimeout(s),s=setTimeout(v,t),f(c)}return void 0===s&&(s=setTimeout(v,t)),o}return t=ko(t)||0,Oo(r)&&(u=!!r.leading,a=(d="maxWait"in r)?ns(ko(r.maxWait)||0,t):a,h="trailing"in r?!!r.trailing:h),y.cancel=function(){void 0!==s&&clearTimeout(s),l=0,n=c=i=s=void 0},y.flush=function(){return void 0===s?o:m(rs())},y}var os=/[\\^$.*+?()[\]{}|]/g,ss=RegExp(os.source);function cs(e){var t;return(e=null==(t=e)?"":vo(t))&&ss.test(e)?e.replace(os,"\\$&"):e}function ls(e,t){return null==e?e:ts(e,"function"==typeof(r=t)?r:So,Ko);var r}var us=function(e,t,r){return Math.max(t,Math.min(e,r))},ds=Rn(Ma.hex()),hs=(HTMLElement,"container"),fs="preview",ps="input",bs=aa(),vs=(HTMLElement,"swatch"),ms="rgba(0, 0, 0, 0.15)",ys="rgba(255, 255, 255, 0.15)",gs=(HTMLElement,function(e,t){var r=cs(t),n=new RegExp(r,"ig");0===e.length&&console.warn("No data was passed to the filter function.\n    The data argument should be an array of objects");var i=function e(t,r){var n;if(null===(n=t)||void 0===n?void 0:n.constant)return!0;var i=!1;return ls(t,(function(t){"function"!==typeof t&&(Array.isArray(t)||"object"===typeof t&&null!==t?e(t,r)&&(i=!0):r.test(t)&&(i=!0))})),i};return e.filter((function(e){return i(e,n)}))}),Os="top",js="bottom",_s="right",ws="left",xs="auto",ks=[Os,js,_s,ws],Ss="start",Ts="end",Cs="viewport",Ms="popper",Ps=ks.reduce((function(e,t){return e.concat([t+"-"+Ss,t+"-"+Ts])}),[]),As=[].concat(ks,[xs]).reduce((function(e,t){return e.concat([t,t+"-"+Ss,t+"-"+Ts])}),[]),Es=["beforeRead","read","afterRead","beforeMain","main","afterMain","beforeWrite","write","afterWrite"];function Rs(e){return e?(e.nodeName||"").toLowerCase():null}function Is(e){if(null==e)return window;if("[object Window]"!==e.toString()){var t=e.ownerDocument;return t&&t.defaultView||window}return e}function Ds(e){return e instanceof Is(e).Element||e instanceof Element}function Fs(e){return e instanceof Is(e).HTMLElement||e instanceof HTMLElement}function Ls(e){return"undefined"!==typeof ShadowRoot&&(e instanceof Is(e).ShadowRoot||e instanceof ShadowRoot)}var zs={name:"applyStyles",enabled:!0,phase:"write",fn:function(e){var t=e.state;Object.keys(t.elements).forEach((function(e){var r=t.styles[e]||{},n=t.attributes[e]||{},i=t.elements[e];Fs(i)&&Rs(i)&&(Object.assign(i.style,r),Object.keys(n).forEach((function(e){var t=n[e];!1===t?i.removeAttribute(e):i.setAttribute(e,!0===t?"":t)})))}))},effect:function(e){var t=e.state,r={popper:{position:t.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(t.elements.popper.style,r.popper),t.styles=r,t.elements.arrow&&Object.assign(t.elements.arrow.style,r.arrow),function(){Object.keys(t.elements).forEach((function(e){var n=t.elements[e],i=t.attributes[e]||{},a=Object.keys(t.styles.hasOwnProperty(e)?t.styles[e]:r[e]).reduce((function(e,t){return e[t]="",e}),{});Fs(n)&&Rs(n)&&(Object.assign(n.style,a),Object.keys(i).forEach((function(e){n.removeAttribute(e)})))}))}},requires:["computeStyles"]};function Vs(e){return e.split("-")[0]}function Ns(e){var t=e.getBoundingClientRect();return{width:t.width,height:t.height,top:t.top,right:t.right,bottom:t.bottom,left:t.left,x:t.left,y:t.top}}function Us(e){var t=Ns(e),r=e.offsetWidth,n=e.offsetHeight;return Math.abs(t.width-r)<=1&&(r=t.width),Math.abs(t.height-n)<=1&&(n=t.height),{x:e.offsetLeft,y:e.offsetTop,width:r,height:n}}function Bs(e,t){var r=t.getRootNode&&t.getRootNode();if(e.contains(t))return!0;if(r&&Ls(r)){var n=t;do{if(n&&e.isSameNode(n))return!0;n=n.parentNode||n.host}while(n)}return!1}function Gs(e){return Is(e).getComputedStyle(e)}function qs(e){return["table","td","th"].indexOf(Rs(e))>=0}function Hs(e){return((Ds(e)?e.ownerDocument:e.document)||window.document).documentElement}function Ws(e){return"html"===Rs(e)?e:e.assignedSlot||e.parentNode||(Ls(e)?e.host:null)||Hs(e)}function Qs(e){return Fs(e)&&"fixed"!==Gs(e).position?e.offsetParent:null}function Zs(e){for(var t=Is(e),r=Qs(e);r&&qs(r)&&"static"===Gs(r).position;)r=Qs(r);return r&&("html"===Rs(r)||"body"===Rs(r)&&"static"===Gs(r).position)?t:r||function(e){var t=-1!==navigator.userAgent.toLowerCase().indexOf("firefox");if(-1!==navigator.userAgent.indexOf("Trident")&&Fs(e)&&"fixed"===Gs(e).position)return null;for(var r=Ws(e);Fs(r)&&["html","body"].indexOf(Rs(r))<0;){var n=Gs(r);if("none"!==n.transform||"none"!==n.perspective||"paint"===n.contain||-1!==["transform","perspective"].indexOf(n.willChange)||t&&"filter"===n.willChange||t&&n.filter&&"none"!==n.filter)return r;r=r.parentNode}return null}(e)||t}function Xs(e){return["top","bottom"].indexOf(e)>=0?"x":"y"}var Ys=Math.max,$s=Math.min,Js=Math.round;function Ks(e,t,r){return Ys(e,$s(t,r))}function ec(e){return Object.assign({},{top:0,right:0,bottom:0,left:0},e)}function tc(e,t){return t.reduce((function(t,r){return t[r]=e,t}),{})}var rc={top:"auto",right:"auto",bottom:"auto",left:"auto"};function nc(e){var t,r=e.popper,n=e.popperRect,i=e.placement,a=e.offsets,o=e.position,s=e.gpuAcceleration,c=e.adaptive,l=e.roundOffsets,u=!0===l?function(e){var t=e.x,r=e.y,n=window.devicePixelRatio||1;return{x:Js(Js(t*n)/n)||0,y:Js(Js(r*n)/n)||0}}(a):"function"===typeof l?l(a):a,d=u.x,h=void 0===d?0:d,f=u.y,p=void 0===f?0:f,b=a.hasOwnProperty("x"),v=a.hasOwnProperty("y"),m=ws,y=Os,g=window;if(c){var O=Zs(r),j="clientHeight",_="clientWidth";O===Is(r)&&"static"!==Gs(O=Hs(r)).position&&(j="scrollHeight",_="scrollWidth"),O=O,i===Os&&(y=js,p-=O[j]-n.height,p*=s?1:-1),i===ws&&(m=_s,h-=O[_]-n.width,h*=s?1:-1)}var w,x=Object.assign({position:o},c&&rc);return s?Object.assign({},x,((w={})[y]=v?"0":"",w[m]=b?"0":"",w.transform=(g.devicePixelRatio||1)<2?"translate("+h+"px, "+p+"px)":"translate3d("+h+"px, "+p+"px, 0)",w)):Object.assign({},x,((t={})[y]=v?p+"px":"",t[m]=b?h+"px":"",t.transform="",t))}var ic={passive:!0};var ac={left:"right",right:"left",bottom:"top",top:"bottom"};function oc(e){return e.replace(/left|right|bottom|top/g,(function(e){return ac[e]}))}var sc={start:"end",end:"start"};function cc(e){return e.replace(/start|end/g,(function(e){return sc[e]}))}function lc(e){var t=Is(e);return{scrollLeft:t.pageXOffset,scrollTop:t.pageYOffset}}function uc(e){return Ns(Hs(e)).left+lc(e).scrollLeft}function dc(e){var t=Gs(e),r=t.overflow,n=t.overflowX,i=t.overflowY;return/auto|scroll|overlay|hidden/.test(r+i+n)}function hc(e){return["html","body","#document"].indexOf(Rs(e))>=0?e.ownerDocument.body:Fs(e)&&dc(e)?e:hc(Ws(e))}function fc(e,t){var r;void 0===t&&(t=[]);var n=hc(e),i=n===(null==(r=e.ownerDocument)?void 0:r.body),a=Is(n),o=i?[a].concat(a.visualViewport||[],dc(n)?n:[]):n,s=t.concat(o);return i?s:s.concat(fc(Ws(o)))}function pc(e){return Object.assign({},e,{left:e.x,top:e.y,right:e.x+e.width,bottom:e.y+e.height})}function bc(e,t){return t===Cs?pc(function(e){var t=Is(e),r=Hs(e),n=t.visualViewport,i=r.clientWidth,a=r.clientHeight,o=0,s=0;return n&&(i=n.width,a=n.height,/^((?!chrome|android).)*safari/i.test(navigator.userAgent)||(o=n.offsetLeft,s=n.offsetTop)),{width:i,height:a,x:o+uc(e),y:s}}(e)):Fs(t)?function(e){var t=Ns(e);return t.top=t.top+e.clientTop,t.left=t.left+e.clientLeft,t.bottom=t.top+e.clientHeight,t.right=t.left+e.clientWidth,t.width=e.clientWidth,t.height=e.clientHeight,t.x=t.left,t.y=t.top,t}(t):pc(function(e){var t,r=Hs(e),n=lc(e),i=null==(t=e.ownerDocument)?void 0:t.body,a=Ys(r.scrollWidth,r.clientWidth,i?i.scrollWidth:0,i?i.clientWidth:0),o=Ys(r.scrollHeight,r.clientHeight,i?i.scrollHeight:0,i?i.clientHeight:0),s=-n.scrollLeft+uc(e),c=-n.scrollTop;return"rtl"===Gs(i||r).direction&&(s+=Ys(r.clientWidth,i?i.clientWidth:0)-a),{width:a,height:o,x:s,y:c}}(Hs(e)))}function vc(e,t,r){var n="clippingParents"===t?function(e){var t=fc(Ws(e)),r=["absolute","fixed"].indexOf(Gs(e).position)>=0&&Fs(e)?Zs(e):e;return Ds(r)?t.filter((function(e){return Ds(e)&&Bs(e,r)&&"body"!==Rs(e)})):[]}(e):[].concat(t),i=[].concat(n,[r]),a=i[0],o=i.reduce((function(t,r){var n=bc(e,r);return t.top=Ys(n.top,t.top),t.right=$s(n.right,t.right),t.bottom=$s(n.bottom,t.bottom),t.left=Ys(n.left,t.left),t}),bc(e,a));return o.width=o.right-o.left,o.height=o.bottom-o.top,o.x=o.left,o.y=o.top,o}function mc(e){return e.split("-")[1]}function yc(e){var t,r=e.reference,n=e.element,i=e.placement,a=i?Vs(i):null,o=i?mc(i):null,s=r.x+r.width/2-n.width/2,c=r.y+r.height/2-n.height/2;switch(a){case Os:t={x:s,y:r.y-n.height};break;case js:t={x:s,y:r.y+r.height};break;case _s:t={x:r.x+r.width,y:c};break;case ws:t={x:r.x-n.width,y:c};break;default:t={x:r.x,y:r.y}}var l=a?Xs(a):null;if(null!=l){var u="y"===l?"height":"width";switch(o){case Ss:t[l]=t[l]-(r[u]/2-n[u]/2);break;case Ts:t[l]=t[l]+(r[u]/2-n[u]/2)}}return t}function gc(e,t){void 0===t&&(t={});var r=t,n=r.placement,i=void 0===n?e.placement:n,a=r.boundary,o=void 0===a?"clippingParents":a,s=r.rootBoundary,c=void 0===s?Cs:s,l=r.elementContext,u=void 0===l?Ms:l,d=r.altBoundary,h=void 0!==d&&d,f=r.padding,p=void 0===f?0:f,b=ec("number"!==typeof p?p:tc(p,ks)),v=u===Ms?"reference":Ms,m=e.elements.reference,y=e.rects.popper,g=e.elements[h?v:u],O=vc(Ds(g)?g:g.contextElement||Hs(e.elements.popper),o,c),j=Ns(m),_=yc({reference:j,element:y,strategy:"absolute",placement:i}),w=pc(Object.assign({},y,_)),x=u===Ms?w:j,k={top:O.top-x.top+b.top,bottom:x.bottom-O.bottom+b.bottom,left:O.left-x.left+b.left,right:x.right-O.right+b.right},S=e.modifiersData.offset;if(u===Ms&&S){var T=S[i];Object.keys(k).forEach((function(e){var t=[_s,js].indexOf(e)>=0?1:-1,r=[Os,js].indexOf(e)>=0?"y":"x";k[e]+=T[r]*t}))}return k}function Oc(e,t){void 0===t&&(t={});var r=t,n=r.placement,i=r.boundary,a=r.rootBoundary,o=r.padding,s=r.flipVariations,c=r.allowedAutoPlacements,l=void 0===c?As:c,u=mc(n),d=u?s?Ps:Ps.filter((function(e){return mc(e)===u})):ks,h=d.filter((function(e){return l.indexOf(e)>=0}));0===h.length&&(h=d);var f=h.reduce((function(t,r){return t[r]=gc(e,{placement:r,boundary:i,rootBoundary:a,padding:o})[Vs(r)],t}),{});return Object.keys(f).sort((function(e,t){return f[e]-f[t]}))}function jc(e,t,r){return void 0===r&&(r={x:0,y:0}),{top:e.top-t.height-r.y,right:e.right-t.width+r.x,bottom:e.bottom-t.height+r.y,left:e.left-t.width-r.x}}function _c(e){return[Os,_s,js,ws].some((function(t){return e[t]>=0}))}function wc(e,t,r){void 0===r&&(r=!1);var n=Hs(t),i=Ns(e),a=Fs(t),o={scrollLeft:0,scrollTop:0},s={x:0,y:0};return(a||!a&&!r)&&(("body"!==Rs(t)||dc(n))&&(o=function(e){return e!==Is(e)&&Fs(e)?{scrollLeft:(t=e).scrollLeft,scrollTop:t.scrollTop}:lc(e);var t}(t)),Fs(t)?((s=Ns(t)).x+=t.clientLeft,s.y+=t.clientTop):n&&(s.x=uc(n))),{x:i.left+o.scrollLeft-s.x,y:i.top+o.scrollTop-s.y,width:i.width,height:i.height}}function xc(e){var t=new Map,r=new Set,n=[];function i(e){r.add(e.name),[].concat(e.requires||[],e.requiresIfExists||[]).forEach((function(e){if(!r.has(e)){var n=t.get(e);n&&i(n)}})),n.push(e)}return e.forEach((function(e){t.set(e.name,e)})),e.forEach((function(e){r.has(e.name)||i(e)})),n}function kc(e){var t;return function(){return t||(t=new Promise((function(r){Promise.resolve().then((function(){t=void 0,r(e())}))}))),t}}var Sc={placement:"bottom",modifiers:[],strategy:"absolute"};function Tc(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return!t.some((function(e){return!(e&&"function"===typeof e.getBoundingClientRect)}))}function Cc(e){void 0===e&&(e={});var t=e,r=t.defaultModifiers,n=void 0===r?[]:r,i=t.defaultOptions,a=void 0===i?Sc:i;return function(e,t,r){void 0===r&&(r=a);var i={placement:"bottom",orderedModifiers:[],options:Object.assign({},Sc,a),modifiersData:{},elements:{reference:e,popper:t},attributes:{},styles:{}},o=[],s=!1,c={state:i,setOptions:function(r){l(),i.options=Object.assign({},a,i.options,r),i.scrollParents={reference:Ds(e)?fc(e):e.contextElement?fc(e.contextElement):[],popper:fc(t)};var s=function(e){var t=xc(e);return Es.reduce((function(e,r){return e.concat(t.filter((function(e){return e.phase===r})))}),[])}(function(e){var t=e.reduce((function(e,t){var r=e[t.name];return e[t.name]=r?Object.assign({},r,t,{options:Object.assign({},r.options,t.options),data:Object.assign({},r.data,t.data)}):t,e}),{});return Object.keys(t).map((function(e){return t[e]}))}([].concat(n,i.options.modifiers)));return i.orderedModifiers=s.filter((function(e){return e.enabled})),i.orderedModifiers.forEach((function(e){var t=e.name,r=e.options,n=void 0===r?{}:r,a=e.effect;if("function"===typeof a){var s=a({state:i,name:t,instance:c,options:n}),l=function(){};o.push(s||l)}})),c.update()},forceUpdate:function(){if(!s){var e=i.elements,t=e.reference,r=e.popper;if(Tc(t,r)){i.rects={reference:wc(t,Zs(r),"fixed"===i.options.strategy),popper:Us(r)},i.reset=!1,i.placement=i.options.placement,i.orderedModifiers.forEach((function(e){return i.modifiersData[e.name]=Object.assign({},e.data)}));for(var n=0;n<i.orderedModifiers.length;n++)if(!0!==i.reset){var a=i.orderedModifiers[n],o=a.fn,l=a.options,u=void 0===l?{}:l,d=a.name;"function"===typeof o&&(i=o({state:i,options:u,name:d,instance:c})||i)}else i.reset=!1,n=-1}}},update:kc((function(){return new Promise((function(e){c.forceUpdate(),e(i)}))})),destroy:function(){l(),s=!0}};if(!Tc(e,t))return c;function l(){o.forEach((function(e){return e()})),o=[]}return c.setOptions(r).then((function(e){!s&&r.onFirstUpdate&&r.onFirstUpdate(e)})),c}}var Mc=Cc({defaultModifiers:[{name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:function(e){var t=e.state,r=e.instance,n=e.options,i=n.scroll,a=void 0===i||i,o=n.resize,s=void 0===o||o,c=Is(t.elements.popper),l=[].concat(t.scrollParents.reference,t.scrollParents.popper);return a&&l.forEach((function(e){e.addEventListener("scroll",r.update,ic)})),s&&c.addEventListener("resize",r.update,ic),function(){a&&l.forEach((function(e){e.removeEventListener("scroll",r.update,ic)})),s&&c.removeEventListener("resize",r.update,ic)}},data:{}},{name:"popperOffsets",enabled:!0,phase:"read",fn:function(e){var t=e.state,r=e.name;t.modifiersData[r]=yc({reference:t.rects.reference,element:t.rects.popper,strategy:"absolute",placement:t.placement})},data:{}},{name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:function(e){var t=e.state,r=e.options,n=r.gpuAcceleration,i=void 0===n||n,a=r.adaptive,o=void 0===a||a,s=r.roundOffsets,c=void 0===s||s,l={placement:Vs(t.placement),popper:t.elements.popper,popperRect:t.rects.popper,gpuAcceleration:i};null!=t.modifiersData.popperOffsets&&(t.styles.popper=Object.assign({},t.styles.popper,nc(Object.assign({},l,{offsets:t.modifiersData.popperOffsets,position:t.options.strategy,adaptive:o,roundOffsets:c})))),null!=t.modifiersData.arrow&&(t.styles.arrow=Object.assign({},t.styles.arrow,nc(Object.assign({},l,{offsets:t.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:c})))),t.attributes.popper=Object.assign({},t.attributes.popper,{"data-popper-placement":t.placement})},data:{}},zs,{name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:function(e){var t=e.state,r=e.options,n=e.name,i=r.offset,a=void 0===i?[0,0]:i,o=As.reduce((function(e,r){return e[r]=function(e,t,r){var n=Vs(e),i=[ws,Os].indexOf(n)>=0?-1:1,a="function"===typeof r?r(Object.assign({},t,{placement:e})):r,o=a[0],s=a[1];return o=o||0,s=(s||0)*i,[ws,_s].indexOf(n)>=0?{x:s,y:o}:{x:o,y:s}}(r,t.rects,a),e}),{}),s=o[t.placement],c=s.x,l=s.y;null!=t.modifiersData.popperOffsets&&(t.modifiersData.popperOffsets.x+=c,t.modifiersData.popperOffsets.y+=l),t.modifiersData[n]=o}},{name:"flip",enabled:!0,phase:"main",fn:function(e){var t=e.state,r=e.options,n=e.name;if(!t.modifiersData[n]._skip){for(var i=r.mainAxis,a=void 0===i||i,o=r.altAxis,s=void 0===o||o,c=r.fallbackPlacements,l=r.padding,u=r.boundary,d=r.rootBoundary,h=r.altBoundary,f=r.flipVariations,p=void 0===f||f,b=r.allowedAutoPlacements,v=t.options.placement,m=Vs(v),y=c||(m===v||!p?[oc(v)]:function(e){if(Vs(e)===xs)return[];var t=oc(e);return[cc(e),t,cc(t)]}(v)),g=[v].concat(y).reduce((function(e,r){return e.concat(Vs(r)===xs?Oc(t,{placement:r,boundary:u,rootBoundary:d,padding:l,flipVariations:p,allowedAutoPlacements:b}):r)}),[]),O=t.rects.reference,j=t.rects.popper,_=new Map,w=!0,x=g[0],k=0;k<g.length;k++){var S=g[k],T=Vs(S),C=mc(S)===Ss,M=[Os,js].indexOf(T)>=0,P=M?"width":"height",A=gc(t,{placement:S,boundary:u,rootBoundary:d,altBoundary:h,padding:l}),E=M?C?_s:ws:C?js:Os;O[P]>j[P]&&(E=oc(E));var R=oc(E),I=[];if(a&&I.push(A[T]<=0),s&&I.push(A[E]<=0,A[R]<=0),I.every((function(e){return e}))){x=S,w=!1;break}_.set(S,I)}if(w)for(var D=function(e){var t=g.find((function(t){var r=_.get(t);if(r)return r.slice(0,e).every((function(e){return e}))}));if(t)return x=t,"break"},F=p?3:1;F>0;F--){if("break"===D(F))break}t.placement!==x&&(t.modifiersData[n]._skip=!0,t.placement=x,t.reset=!0)}},requiresIfExists:["offset"],data:{_skip:!1}},{name:"preventOverflow",enabled:!0,phase:"main",fn:function(e){var t=e.state,r=e.options,n=e.name,i=r.mainAxis,a=void 0===i||i,o=r.altAxis,s=void 0!==o&&o,c=r.boundary,l=r.rootBoundary,u=r.altBoundary,d=r.padding,h=r.tether,f=void 0===h||h,p=r.tetherOffset,b=void 0===p?0:p,v=gc(t,{boundary:c,rootBoundary:l,padding:d,altBoundary:u}),m=Vs(t.placement),y=mc(t.placement),g=!y,O=Xs(m),j="x"===O?"y":"x",_=t.modifiersData.popperOffsets,w=t.rects.reference,x=t.rects.popper,k="function"===typeof b?b(Object.assign({},t.rects,{placement:t.placement})):b,S={x:0,y:0};if(_){if(a||s){var T="y"===O?Os:ws,C="y"===O?js:_s,M="y"===O?"height":"width",P=_[O],A=_[O]+v[T],E=_[O]-v[C],R=f?-x[M]/2:0,I=y===Ss?w[M]:x[M],D=y===Ss?-x[M]:-w[M],F=t.elements.arrow,L=f&&F?Us(F):{width:0,height:0},z=t.modifiersData["arrow#persistent"]?t.modifiersData["arrow#persistent"].padding:{top:0,right:0,bottom:0,left:0},V=z[T],N=z[C],U=Ks(0,w[M],L[M]),B=g?w[M]/2-R-U-V-k:I-U-V-k,G=g?-w[M]/2+R+U+N+k:D+U+N+k,q=t.elements.arrow&&Zs(t.elements.arrow),H=q?"y"===O?q.clientTop||0:q.clientLeft||0:0,W=t.modifiersData.offset?t.modifiersData.offset[t.placement][O]:0,Q=_[O]+B-W-H,Z=_[O]+G-W;if(a){var X=Ks(f?$s(A,Q):A,P,f?Ys(E,Z):E);_[O]=X,S[O]=X-P}if(s){var Y="x"===O?Os:ws,$="x"===O?js:_s,J=_[j],K=J+v[Y],ee=J-v[$],te=Ks(f?$s(K,Q):K,J,f?Ys(ee,Z):ee);_[j]=te,S[j]=te-J}}t.modifiersData[n]=S}},requiresIfExists:["offset"]},{name:"arrow",enabled:!0,phase:"main",fn:function(e){var t,r=e.state,n=e.name,i=e.options,a=r.elements.arrow,o=r.modifiersData.popperOffsets,s=Vs(r.placement),c=Xs(s),l=[ws,_s].indexOf(s)>=0?"height":"width";if(a&&o){var u=function(e,t){return ec("number"!==typeof(e="function"===typeof e?e(Object.assign({},t.rects,{placement:t.placement})):e)?e:tc(e,ks))}(i.padding,r),d=Us(a),h="y"===c?Os:ws,f="y"===c?js:_s,p=r.rects.reference[l]+r.rects.reference[c]-o[c]-r.rects.popper[l],b=o[c]-r.rects.reference[c],v=Zs(a),m=v?"y"===c?v.clientHeight||0:v.clientWidth||0:0,y=p/2-b/2,g=u[h],O=m-d[l]-u[f],j=m/2-d[l]/2+y,_=Ks(g,j,O),w=c;r.modifiersData[n]=((t={})[w]=_,t.centerOffset=_-j,t)}},effect:function(e){var t=e.state,r=e.options.element,n=void 0===r?"[data-popper-arrow]":r;null!=n&&("string"!==typeof n||(n=t.elements.popper.querySelector(n)))&&Bs(t.elements.popper,n)&&(t.elements.arrow=n)},requires:["popperOffsets"],requiresIfExists:["preventOverflow"]},{name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:function(e){var t=e.state,r=e.name,n=t.rects.reference,i=t.rects.popper,a=t.modifiersData.preventOverflow,o=gc(t,{elementContext:"reference"}),s=gc(t,{altBoundary:!0}),c=jc(o,n),l=jc(s,i,a),u=_c(c),d=_c(l);t.modifiersData[r]={referenceClippingOffsets:c,popperEscapeOffsets:l,isReferenceHidden:u,hasPopperEscaped:d},t.attributes.popper=Object.assign({},t.attributes.popper,{"data-popper-reference-hidden":u,"data-popper-escaped":d})}}]}),Pc="calcite-popper-anim",Ac="calcite-popper-anim--active";function Ec(e,t){var r=["left","right"],n=["start","end"];return"rtl"===Tr(e)&&(r.reverse(),n.reverse()),t.replace(/-leading/gi,"-".concat(n[0])).replace(/-trailing/gi,"-".concat(n[1])).replace(/leading/gi,r[0]).replace(/trailing/gi,r[1])}function Rc(e){var t=e.referenceEl,r=e.el,n=e.placement,i=e.overlayPositioning,a=void 0===i?"absolute":i,o=e.modifiers;return t?Mc(t,r,{strategy:a,placement:Ec(r,n),modifiers:o}):null}function Ic(e){var t=e.el,r=e.modifiers,n=e.placement,i=e.popper,a=Ec(t,n);i.setOptions({modifiers:r,placement:a})}var Dc,Fc,Lc=Math.ceil((Dc=4,Fc=4,Math.sqrt(Math.pow(Dc,2)+Math.pow(Fc,2)))),zc="CALCITE-COMBOBOX-ITEM",Vc="CALCITE-COMBOBOX-ITEM-GROUP",Nc="".concat(zc,", ").concat(Vc),Uc="bottom-leading";function Bc(e){var t,r,n=null===(t=e.parentElement)||void 0===t?void 0:t.closest(Nc);return[n,null===(r=null===n||void 0===n?void 0:n.parentElement)||void 0===r?void 0:r.closest(Nc)].filter((function(e){return e}))}function Gc(e){var t;return(null===(t=e.ancestors)||void 0===t?void 0:t.filter((function(e){return"CALCITE-COMBOBOX-ITEM"===e.nodeName})))||[]}function qc(e){return xr(e.querySelectorAll("calcite-combobox-item")).filter((function(e){return e.selected})).length>0}function Hc(e){var t=Bc(e),r=Object(I.a)(t,2),n=r[0],i=r[1];return n?i?2:1:0}HTMLElement;var Wc="icon",Qc="icon--active",Zc="icon--custom",Xc="icon--dot",Yc="label--single",$c="label",Jc="label--active",Kc="label--selected",el="title",tl=(HTMLElement,"list"),rl="label",nl="title",il=(HTMLElement,["ar","bs","ca","cs","da","de","de-CH","el","en","en-AU","en-CA","en-GB","es","es-MX","et","fi","fr","fr-CH","he","hi","hr","hu","id","it","it-CH","ja","ko","lt","lv","mk","nb","nl","pl","pt","pt-PT","ro","ru","sk","sl","sr","sv","th","tr","uk","vi","zh-CN","zh-HK","zh-TW"]);function al(e){return new Intl.NumberFormat(e,{minimumFractionDigits:0,maximumFractionDigits:20})}function ol(e,t){if(e){var r=sl(t),n=cl(t),i=e.split(""),a=i.lastIndexOf(n),o=i.map((function(e,t){return e===r||e===n&&t!==a?"":e})).reduce((function(e,t){return e+t})).replace(n,".");return isNaN(Number(o))?e:o}return e}function sl(e){var t=al(e).formatToParts(1234567.8).find((function(e){return"group"===e.type})).value;return 0===t.trim().length?" ":t}function cl(e){var t=al(e).formatToParts(1234567.8).find((function(e){return"decimal"===e.type})).value;return 0===t.trim().length?" ":t}function ll(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(e){var n=Number(ul(e));if(!isNaN(n)){var i=al(t),a=i.formatToParts(n),o=a.map((function(e){var n=e.type,i=e.value;switch(n){case"group":return r?sl(t):"";case"decimal":return cl(t);default:return i}})).reduce((function(e,t){return e+t}));return o}}return e}function ul(e){return(null===e||void 0===e?void 0:e.endsWith("."))?e.replace(".",""):e}function dl(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";if(il.indexOf(e)>-1)return e;var t=e.split("-")[0];return il.indexOf(t)>-1?t:"en"}var hl={},fl={};function pl(e){return bl.apply(this,arguments)}function bl(){return(bl=Object(s.a)(a.mark((function e(t){var r,n;return a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=dl(t),!hl[r]){e.next=3;break}return e.abrupt("return",hl[r]);case 3:return fl[r]||(fl[r]=fetch($t("./assets/calcite-date-picker/nls/".concat(r,".json"))).then((function(e){return e.json()})).catch((function(){return console.error('Translations for "'.concat(r,'" not found or invalid, falling back to english')),pl("en")}))),e.next=6,fl[r];case 6:return n=e.sent,hl[r]=n,e.abrupt("return",n);case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function vl(e,t,r){var n=e.getTime(),i=!(t instanceof Date)||n>=t.getTime(),a=!(r instanceof Date)||n<=r.getTime();return i&&a}function ml(e,t,r){if(!(e instanceof Date))return null;var n=e.getTime(),i=t instanceof Date&&n<t.getTime(),a=r instanceof Date&&n>r.getTime();return i?t:a?r:e}function yl(e){if(e instanceof Date)return e;if(!e||"string"!==typeof e)return null;var t=e.split(/[: T-]/).map(parseFloat),r=new Date(t[0],(t[1]||1)-1,t[2]||1);if(r.setFullYear(t[0]),isNaN(r.getTime()))throw new Error('Invalid ISO 8601 date: "'.concat(e,'"'));return r}function gl(e){return"string"===typeof e?e:e instanceof Date?e.toISOString().split("T")[0]:""}function Ol(e,t){return e instanceof Date&&t instanceof Date&&e.getDate()===t.getDate()&&e.getMonth()===t.getMonth()&&e.getFullYear()===t.getFullYear()}function jl(e,t){return String(e).split("").map((function(e){return t.numerals[e]})).join("")}function _l(e,t){return parseInt(e.split("").map((function(e){return"0123456789"[t.numerals.indexOf(e)]})).filter((function(e){return e})).join(""))}function wl(e,t){var r=t.separator,n=xl(t.unitOrder),i=function(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"").replace(/[\u0660-\u0669]/g,(function(e){return e.charCodeAt(0)-1632})).replace(/[\u06f0-\u06f9]/g,(function(e){return e.charCodeAt(0)-1776}))}(e).split(r);return{day:parseInt(i[n.indexOf("d")]),month:parseInt(i[n.indexOf("m")])-1,year:parseInt(i[n.indexOf("y")])}}function xl(e){var t=e.toLowerCase();return["d","m","y"].sort((function(e,r){return t.indexOf(e)-t.indexOf(r)}))}function kl(e,t){var r=e.getTime(),n=t.getTime();return 1e3*Math.abs(r-n)*60*60*24}var Sl="next month",Tl="previous month",Cl=(HTMLElement,HTMLElement,HTMLElement,HTMLElement,HTMLElement,"container--s"),Ml="container--m",Pl="container--l",Al=(HTMLElement,"container--link"),El="container--s",Rl="container--m",Il="container--l",Dl="container--multi-selection",Fl="container--single-selection",Ll="container--none-selection",zl=(HTMLElement,"button"),Vl="plus",Nl=(HTMLElement,"container"),Ul="search-icon",Bl="clear-button",Gl="filter",ql="Clear filter",Hl="search",Wl="x",Ql=(HTMLElement,"frame"),Zl="frame--advancing",Xl="frame--retreating";HTMLElement;function Yl(e){return e<0?-1:1}function $l(e,t,r){var n=t[0]-e[0],i=t[1]-e[1];return n?(3*i/n-r)/2:r}function Jl(e,t,r,n,i){var a=Object(I.a)(e,2),o=a[0],s=a[1],c=Object(I.a)(t,2),l=c[0],u=c[1],d=(l-o)/3,h=i([o+d,s+d*r]).join(","),f=i([l-d,u-d*n]).join(","),p=i([l,u]).join(",");return"C ".concat(h," ").concat(f," ").concat(p)}function Kl(e){var t=e.data,r=e.min,n=e.max,i=e.t;if(0===t.length)return"";var a,o,s,c=i(t[0]),l=Object(I.a)(c,2),u=l[0],d=l[1],h=i(r),f=Object(I.a)(h,2),p=f[0],b=f[1],v=i(n),m=Object(I.a)(v,1)[0],y=t.reduce((function(e,r,n){if(o=t[n-2],s=t[n-1],n>1){var c=function(e,t,r){var n=t[0]-e[0],i=r[0]-t[0],a=(t[1]-e[1])/(n||i<0&&0),o=(r[1]-t[1])/(i||n<0&&0),s=(a*i+o*n)/(n+i);return(Yl(a)+Yl(o))*Math.min(Math.abs(a),Math.abs(o),.5*Math.abs(s))||0}(o,s,r),l=void 0===a?$l(o,s,c):a,u=Jl(o,s,l,c,i);return a=c,"".concat(e," ").concat(u)}return e}),"M ".concat(p,",").concat(b," L ").concat(p,",").concat(d," L ").concat(u,",").concat(d)),g=t[t.length-1],O=Jl(s,g,a,$l(s,g,a),i);return"".concat(y," ").concat(O," L ").concat(m,",").concat(b," Z")}HTMLElement;var eu="handle",tu="handle--activated",ru="drag",nu=(HTMLElement,"flip-rtl"),iu={},au={},ou={s:16,m:24,l:32};function su(e){return cu.apply(this,arguments)}function cu(){return(cu=Object(s.a)(a.mark((function e(t){var r,n,i,o,s,c,l,u;return a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.icon,n=t.scale,i=ou[n],o=lu(r),s="F"===o.charAt(o.length-1),c=s?o.substring(0,o.length-1):o,l="".concat(c).concat(i).concat(s?"F":""),!iu[l]){e.next=8;break}return e.abrupt("return",iu[l]);case 8:return au[l]||(au[l]=fetch($t("./assets/calcite-icon/".concat(l,".json"))).then((function(e){return e.json()})).catch((function(){return console.error('"'.concat(l,'" is not a valid calcite-ui-icon name')),""}))),e.next=11,au[l];case 11:return u=e.sent,iu[l]=u,e.abrupt("return",u);case 14:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function lu(e){var t=!isNaN(Number(e.charAt(0))),r=e.split("-");return 1===r.length?t?"i".concat(e):e:r.map((function(e,r){return 0===r?t?"i".concat(e.toUpperCase()):e:e.charAt(0).toUpperCase()+e.slice(1)})).join("")}HTMLElement;var uu="Click to edit",du="Cancel",hu="Save",fu=(HTMLElement,{tel:"phone",password:"lock",email:"email-address",date:"calendar",time:"clock",search:"search"}),pu="action";function bu(e){return!(!e||isNaN(Number(e)))}function vu(e){if(!e||(t=e,!gr.some((function(e){return t.includes(e)}))))return null;var t,r=!1,n=e.split("").filter((function(e,t){return e.match(/\./g)&&!r?(r=!0,!0):!(!e.match(/\-/g)||0!==t)||gr.includes(e)})).reduce((function(e,t){return e+t}));return bu(n)?Number(n).toString():null}HTMLElement;var mu,yu="bottom-leading";HTMLElement;!function(e){e.valid="check-circle",e.invalid="exclamation-mark-triangle",e.idle="information"}(mu||(mu={}));HTMLElement;function gu(e){if(!bu(e))return null;var t=parseInt(e);return t>=0&&t<=11?"AM":"PM"}function Ou(e){if(!e||e.endsWith(":")||e.startsWith(":"))return null;var t=e.split(":");if(t.length>1){var r=Object(I.a)(t,3),n=r[0],i=r[1],a=r[2],o=parseInt(t[0]),s=parseInt(t[1]),c=parseInt(t[2]),l=bu(n)&&o>=0&&o<24,u=bu(i)&&s>=0&&s<60,d=bu(a)&&c>=0&&c<60;if(l&&u&&!a||l&&u&&d){var h="".concat(ju(o),":").concat(ju(s));return d&&(h="".concat(h,":").concat(ju(c))),h}}return null}function ju(e){var t=e.toString();return e>=0&&e<=9?t.padStart(2,"0"):t}HTMLElement,HTMLElement,HTMLElement,HTMLElement;function _u(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:20,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,a=[];if(i>=n)return a;for(var o=function(e){var a=e.assignedNodes().filter((function(e){return 1===e.nodeType}));return a.length>0?_u(a[0].parentElement,t,r,n,i+1):[]},s=Array.from(e.children||[]),c=0,l=s;c<l.length;c++){var u=l[c];t(u)||(r(u)&&a.push(u),null!=u.shadowRoot?a.push.apply(a,Object(D.a)(_u(u.shadowRoot,t,r,n,i+1))):"SLOT"===u.tagName?a.push.apply(a,Object(D.a)(o(u))):a.push.apply(a,Object(D.a)(_u(u,t,r,n,i+1))))}return a}function wu(e){return e.hasAttribute("hidden")||e.hasAttribute("aria-hidden")&&"false"!==e.getAttribute("aria-hidden")||"none"===e.style.display||"0"===e.style.opacity||"hidden"===e.style.visibility||"collapse"===e.style.visibility}function xu(e){return"function"===typeof e.setFocus||"-1"!==(t=e).getAttribute("tabindex")&&!wu(t)&&!function(e){return e.hasAttribute("disabled")||e.hasAttribute("aria-disabled")&&"false"!==e.getAttribute("aria-disabled")}(t)&&(t.hasAttribute("tabindex")||(t instanceof HTMLAnchorElement||t instanceof HTMLAreaElement)&&t.hasAttribute("href")||t instanceof HTMLButtonElement||t instanceof HTMLInputElement||t instanceof HTMLTextAreaElement||t instanceof HTMLSelectElement||t instanceof HTMLIFrameElement);var t}function ku(e){return _u(e,wu,xu)}HTMLElement;var Su,Tu="Close",Cu="title",Mu="message",Pu="link",Au=(HTMLElement,HTMLElement,HTMLElement,"page"),Eu="is-selected",Ru="previous",Iu="next",Du="is-disabled",Fu="ellipsis",Lu="ellipsis--start",zu="ellipsis--end",Vu="next",Nu="previous",Uu=(HTMLElement,"back-button"),Bu="container",Gu="header",qu="heading",Hu="summary",Wu="header-content",Qu="header-actions",Zu="header-actions--end",Xu="header-actions--start",Yu="content-container",$u="fab-container",Ju="footer",Ku="x",ed="chevron-left",td="chevron-right",rd="header-actions-start",nd="header-actions-end",id="header-menu-actions",ad="header-content",od="fab",sd="footer",cd="footer-actions",ld="Back",ud="Close",dd="Options",hd=(HTMLElement,"sticky");function fd(){this.setUpItems(),this.setUpFilter()}!function(e){e.circle="circle",e.square="square",e.grip="grip"}(Su||(Su={}));var pd,bd=["ArrowUp","ArrowDown"];function vd(){this.setUpItems(),this.setUpFilter(),this.emitCalciteListChange=as(wd.bind(this),0)}function md(){this.observer.observe(this.el,{childList:!0,subtree:!0})}function yd(){this.observer.disconnect()}function gd(e){var t=this.selectedValues,r=e.detail,n=r.item,i=r.value,a=r.selected,o=r.shiftPressed;a?(this.multiple&&o&&this.selectSiblings(n),this.multiple||this.deselectSiblingItems(n),t.set(i,n)):(t.delete(i),this.multiple&&o&&this.selectSiblings(n,!0)),this.multiple||(kd(n,a),a&&Rr(n)),this.lastSelectedItem=n,this.emitCalciteListChange()}function Od(e){e.stopPropagation();var t=e.detail.oldValue,r=this.selectedValues;if(r.has(t)){var n=r.get(t);r.delete(t),r.set(e.detail.newValue,n)}}function jd(e){var t=this.el,r=this.items,n=this.multiple,i=this.selectedValues;n||(!!t.contains(e.relatedTarget)?kd(e.target,!1):r.forEach((function(t){return kd(t,0===i.size?e.target===t:t.selected)})))}function _d(e){var t=e.key,r=e.target;if(function(e){return!!bd.find((function(t){return t===e}))}(t)){var n=this.items,i=n.length,a=n.indexOf(r);if(i&&-1!==a){e.preventDefault();var o=n[hn(a+("ArrowUp"===t?-1:1),i)];kd(o,!0),Rr(o)}}}function wd(){this.calciteListChange.emit(this.selectedValues)}function xd(e){if(!e.defaultPrevented){var t=e.target,r=this.selectedValues;"CALCITE-PICK-LIST-GROUP"===t.parentElement.tagName?(t.parentElement.remove(),Array.from(t.parentElement.children).forEach((function(e){return r.delete(e.value)}))):(t.remove(),r.delete(t.value)),this.emitCalciteListChange()}}function kd(e,t){t?e.removeAttribute("tabindex"):e.setAttribute("tabindex","-1")}function Sd(e){return Td.apply(this,arguments)}function Td(){return(Td=Object(s.a)(a.mark((function e(t){var r,n,i;return a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.filterEnabled||"filter"!==t){e.next=4;break}return e.next=3,Rr(this.filterEl);case 3:return e.abrupt("return");case 4:if(r=this.multiple,0!==(n=this.items).length){e.next=7;break}return e.abrupt("return");case 7:if(!r){e.next=9;break}return e.abrupt("return",n[0].setFocus());case 9:return i=n.find((function(e){return e.selected})),e.abrupt("return",(i||n[0]).setFocus());case 11:case"end":return e.stop()}}),e,this)})))).apply(this,arguments)}function Cd(e){var t=this;this.items=Array.from(this.el.querySelectorAll(e));var r=!1,n=this.items;n.forEach((function(e){e.icon=t.getIconType(),t.multiple||(e.disableDeselect=!0,kd(e,!1)),e.selected&&(r=!0,kd(e,!0),t.selectedValues.set(e.value,e))}));var i=Object(I.a)(n,1)[0];!r&&i&&kd(i,!0)}function Md(e){var t=this;this.items.forEach((function(r){r.value!==e.value&&(r.toggleSelected(!1),t.selectedValues.has(r.value)&&t.selectedValues.delete(r.value))}))}function Pd(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(this.lastSelectedItem){var n=this.items,i=n.findIndex((function(e){return e.value===t.lastSelectedItem.value})),a=n.findIndex((function(t){return t.value===e.value}));n.slice(Math.min(i,a),Math.max(i,a)).forEach((function(e){e.toggleSelected(!r),r?t.selectedValues.delete(e.value):t.selectedValues.set(e.value,e)}))}}function Ad(e){var t=e.detail.map((function(e){return e.value})),r=!1;pd||(pd=new Set);var n=this.items.filter((function(e){var n=e.parentElement;n.matches("calcite-pick-list-group")&&pd.add(n);var i=t.includes(e.value);return e.hidden=!i,r||(r=i&&e.selected),i}));pd.forEach((function(e){var t=n.some((function(t){return e.contains(t)}));if(e.hidden=!t,t){var r=Dr(e,"parent-item");r&&(r.hidden=!1,n.includes(r)&&Array.from(e.children).forEach((function(e){return e.hidden=!1})))}})),pd.clear(),n.length>0&&!r&&!this.multiple&&kd(n[0],!0)}function Ed(){return this.items.map((function(e){return{label:e.label,description:e.description,metadata:e.metadata,value:e.value}}))}var Rd=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]])}return r},Id=function(e){var t=e.props,r=t.disabled,n=t.loading,i=t.filterEnabled,a=t.dataForFilter,o=t.handleFilter,s=t.filterPlaceholder,c=t.el,l=t.setFilterEl,u=Rd(e,["props"]),d=st("slot",null);return st(lt,Object.assign({"aria-busy":n.toString(),"aria-disabled":r.toString(),role:"menu"},u),st("section",null,st("header",{class:Object(F.a)({},hd,!0)},i?st("calcite-filter",{"aria-label":s,data:a,dir:Tr(c),disabled:n||r,onCalciteFilterChange:o,placeholder:s,ref:l}):null,st("slot",{name:"menu-actions"})),n||r?st("calcite-scrim",{loading:n}):null,d))},Dd=(HTMLElement,"heading"),Fd="container",Ld="container--indented",zd="parent-item",Vd=(HTMLElement,"actions"),Nd="actions--end",Ud="actions--start",Bd="description",Gd="handle",qd="handle--activated",Hd="icon",Wd="icon-dot",Qd="label",Zd="remove",Xd="title",Yd="text-container",$d="check",Jd="x",Kd="actions-end",eh="actions-start",th="remove",rh=(HTMLElement,"container"),nh="arrow",ih="close-button",ah="content",oh="has-header",sh="header",ch="heading",lh="Close",uh="data-calcite-popover-reference",dh="aria-controls",hh="aria-expanded",fh=(HTMLElement,HTMLElement,HTMLElement,HTMLElement,HTMLElement,HTMLElement,HTMLElement,HTMLElement,"Rating"),ph="stars: ${num}",bh=(HTMLElement,"scrim"),vh="Loading",mh=(HTMLElement,"icon"),yh="icon-container",gh="select";function Oh(e){return"CALCITE-OPTION"===e.tagName}HTMLElement;var jh="main",_h="main--reversed",wh="content",xh="content--behind",kh="footer",Sh="primary-panel",Th="contextual-panel",Ch="header",Mh="footer",Ph=(HTMLElement,"action-bar-container"),Ah="content",Eh="action-bar",Rh=(HTMLElement,"content"),Ih="content__header",Dh="content__body",Fh="content--detached",Lh="action-bar",zh="header";HTMLElement,HTMLElement;function Vh(e){return(Vh="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Nh(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Uh(){return(Uh=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function Bh(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"===typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){Nh(e,t,r[t])}))}return e}function Gh(e,t){if(null==e)return{};var r,n,i=function(e,t){if(null==e)return{};var r,n,i={},a=Object.keys(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||(i[r]=e[r]);return i}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function qh(e){if("undefined"!==typeof window&&window.navigator)return!!navigator.userAgent.match(e)}var Hh=qh(/(?:Trident.*rv[ :]?11\.|msie|iemobile|Windows Phone)/i),Wh=qh(/Edge/i),Qh=qh(/firefox/i),Zh=qh(/safari/i)&&!qh(/chrome/i)&&!qh(/android/i),Xh=qh(/iP(ad|od|hone)/i),Yh=qh(/chrome/i)&&qh(/android/i),$h={capture:!1,passive:!1};function Jh(e,t,r){e.addEventListener(t,r,!Hh&&$h)}function Kh(e,t,r){e.removeEventListener(t,r,!Hh&&$h)}function ef(e,t){if(t){if(">"===t[0]&&(t=t.substring(1)),e)try{if(e.matches)return e.matches(t);if(e.msMatchesSelector)return e.msMatchesSelector(t);if(e.webkitMatchesSelector)return e.webkitMatchesSelector(t)}catch(r){return!1}return!1}}function tf(e){return e.host&&e!==document&&e.host.nodeType?e.host:e.parentNode}function rf(e,t,r,n){if(e){r=r||document;do{if(null!=t&&(">"===t[0]?e.parentNode===r&&ef(e,t):ef(e,t))||n&&e===r)return e;if(e===r)break}while(e=tf(e))}return null}var nf,af=/\s+/g;function of(e,t,r){if(e&&t)if(e.classList)e.classList[r?"add":"remove"](t);else{var n=(" "+e.className+" ").replace(af," ").replace(" "+t+" "," ");e.className=(n+(r?" "+t:"")).replace(af," ")}}function sf(e,t,r){var n=e&&e.style;if(n){if(void 0===r)return document.defaultView&&document.defaultView.getComputedStyle?r=document.defaultView.getComputedStyle(e,""):e.currentStyle&&(r=e.currentStyle),void 0===t?r:r[t];t in n||-1!==t.indexOf("webkit")||(t="-webkit-"+t),n[t]=r+("string"===typeof r?"":"px")}}function cf(e,t){var r="";if("string"===typeof e)r=e;else do{var n=sf(e,"transform");n&&"none"!==n&&(r=n+" "+r)}while(!t&&(e=e.parentNode));var i=window.DOMMatrix||window.WebKitCSSMatrix||window.CSSMatrix||window.MSCSSMatrix;return i&&new i(r)}function lf(e,t,r){if(e){var n=e.getElementsByTagName(t),i=0,a=n.length;if(r)for(;i<a;i++)r(n[i],i);return n}return[]}function uf(){var e=document.scrollingElement;return e||document.documentElement}function df(e,t,r,n,i){if(e.getBoundingClientRect||e===window){var a,o,s,c,l,u,d;if(e!==window&&e.parentNode&&e!==uf()?(o=(a=e.getBoundingClientRect()).top,s=a.left,c=a.bottom,l=a.right,u=a.height,d=a.width):(o=0,s=0,c=window.innerHeight,l=window.innerWidth,u=window.innerHeight,d=window.innerWidth),(t||r)&&e!==window&&(i=i||e.parentNode,!Hh))do{if(i&&i.getBoundingClientRect&&("none"!==sf(i,"transform")||r&&"static"!==sf(i,"position"))){var h=i.getBoundingClientRect();o-=h.top+parseInt(sf(i,"border-top-width")),s-=h.left+parseInt(sf(i,"border-left-width")),c=o+a.height,l=s+a.width;break}}while(i=i.parentNode);if(n&&e!==window){var f=cf(i||e),p=f&&f.a,b=f&&f.d;f&&(c=(o/=b)+(u/=b),l=(s/=p)+(d/=p))}return{top:o,left:s,bottom:c,right:l,width:d,height:u}}}function hf(e,t,r){for(var n=mf(e,!0),i=df(e)[t];n;){var a=df(n)[r];if(!("top"===r||"left"===r?i>=a:i<=a))return n;if(n===uf())break;n=mf(n,!1)}return!1}function ff(e,t,r){for(var n=0,i=0,a=e.children;i<a.length;){if("none"!==a[i].style.display&&a[i]!==gp.ghost&&a[i]!==gp.dragged&&rf(a[i],r.draggable,e,!1)){if(n===t)return a[i];n++}i++}return null}function pf(e,t){for(var r=e.lastElementChild;r&&(r===gp.ghost||"none"===sf(r,"display")||t&&!ef(r,t));)r=r.previousElementSibling;return r||null}function bf(e,t){var r=0;if(!e||!e.parentNode)return-1;for(;e=e.previousElementSibling;)"TEMPLATE"===e.nodeName.toUpperCase()||e===gp.clone||t&&!ef(e,t)||r++;return r}function vf(e){var t=0,r=0,n=uf();if(e)do{var i=cf(e),a=i.a,o=i.d;t+=e.scrollLeft*a,r+=e.scrollTop*o}while(e!==n&&(e=e.parentNode));return[t,r]}function mf(e,t){if(!e||!e.getBoundingClientRect)return uf();var r=e,n=!1;do{if(r.clientWidth<r.scrollWidth||r.clientHeight<r.scrollHeight){var i=sf(r);if(r.clientWidth<r.scrollWidth&&("auto"==i.overflowX||"scroll"==i.overflowX)||r.clientHeight<r.scrollHeight&&("auto"==i.overflowY||"scroll"==i.overflowY)){if(!r.getBoundingClientRect||r===document.body)return uf();if(n||t)return r;n=!0}}}while(r=r.parentNode);return uf()}function yf(e,t){return Math.round(e.top)===Math.round(t.top)&&Math.round(e.left)===Math.round(t.left)&&Math.round(e.height)===Math.round(t.height)&&Math.round(e.width)===Math.round(t.width)}function gf(e,t){return function(){if(!nf){var r=arguments,n=this;1===r.length?e.call(n,r[0]):e.apply(n,r),nf=setTimeout((function(){nf=void 0}),t)}}}function Of(e,t,r){e.scrollLeft+=t,e.scrollTop+=r}function jf(e){var t=window.Polymer,r=window.jQuery||window.Zepto;return t&&t.dom?t.dom(e).cloneNode(!0):r?r(e).clone(!0)[0]:e.cloneNode(!0)}var _f="Sortable"+(new Date).getTime();function wf(){var e,t=[];return{captureAnimationState:function(){(t=[],this.options.animation)&&[].slice.call(this.el.children).forEach((function(e){if("none"!==sf(e,"display")&&e!==gp.ghost){t.push({target:e,rect:df(e)});var r=Bh({},t[t.length-1].rect);if(e.thisAnimationDuration){var n=cf(e,!0);n&&(r.top-=n.f,r.left-=n.e)}e.fromRect=r}}))},addAnimationState:function(e){t.push(e)},removeAnimationState:function(e){t.splice(function(e,t){for(var r in e)if(e.hasOwnProperty(r))for(var n in t)if(t.hasOwnProperty(n)&&t[n]===e[r][n])return Number(r);return-1}(t,{target:e}),1)},animateAll:function(r){var n=this;if(!this.options.animation)return clearTimeout(e),void("function"===typeof r&&r());var i=!1,a=0;t.forEach((function(e){var t=0,r=e.target,o=r.fromRect,s=df(r),c=r.prevFromRect,l=r.prevToRect,u=e.rect,d=cf(r,!0);d&&(s.top-=d.f,s.left-=d.e),r.toRect=s,r.thisAnimationDuration&&yf(c,s)&&!yf(o,s)&&(u.top-s.top)/(u.left-s.left)===(o.top-s.top)/(o.left-s.left)&&(t=function(e,t,r,n){return Math.sqrt(Math.pow(t.top-e.top,2)+Math.pow(t.left-e.left,2))/Math.sqrt(Math.pow(t.top-r.top,2)+Math.pow(t.left-r.left,2))*n.animation}(u,c,l,n.options)),yf(s,o)||(r.prevFromRect=o,r.prevToRect=s,t||(t=n.options.animation),n.animate(r,u,s,t)),t&&(i=!0,a=Math.max(a,t),clearTimeout(r.animationResetTimer),r.animationResetTimer=setTimeout((function(){r.animationTime=0,r.prevFromRect=null,r.fromRect=null,r.prevToRect=null,r.thisAnimationDuration=null}),t),r.thisAnimationDuration=t)})),clearTimeout(e),i?e=setTimeout((function(){"function"===typeof r&&r()}),a):"function"===typeof r&&r(),t=[]},animate:function(e,t,r,n){if(n){sf(e,"transition",""),sf(e,"transform","");var i=cf(this.el),a=i&&i.a,o=i&&i.d,s=(t.left-r.left)/(a||1),c=(t.top-r.top)/(o||1);e.animatingX=!!s,e.animatingY=!!c,sf(e,"transform","translate3d("+s+"px,"+c+"px,0)"),this.forRepaintDummy=function(e){return e.offsetWidth}(e),sf(e,"transition","transform "+n+"ms"+(this.options.easing?" "+this.options.easing:"")),sf(e,"transform","translate3d(0,0,0)"),"number"===typeof e.animated&&clearTimeout(e.animated),e.animated=setTimeout((function(){sf(e,"transition",""),sf(e,"transform",""),e.animated=!1,e.animatingX=!1,e.animatingY=!1}),n)}}}}var xf=[],kf={initializeByDefault:!0},Sf={mount:function(e){for(var t in kf)kf.hasOwnProperty(t)&&!(t in e)&&(e[t]=kf[t]);xf.forEach((function(t){if(t.pluginName===e.pluginName)throw"Sortable: Cannot mount plugin ".concat(e.pluginName," more than once")})),xf.push(e)},pluginEvent:function(e,t,r){var n=this;this.eventCanceled=!1,r.cancel=function(){n.eventCanceled=!0};var i=e+"Global";xf.forEach((function(n){t[n.pluginName]&&(t[n.pluginName][i]&&t[n.pluginName][i](Bh({sortable:t},r)),t.options[n.pluginName]&&t[n.pluginName][e]&&t[n.pluginName][e](Bh({sortable:t},r)))}))},initializePlugins:function(e,t,r,n){for(var i in xf.forEach((function(n){var i=n.pluginName;if(e.options[i]||n.initializeByDefault){var a=new n(e,t,e.options);a.sortable=e,a.options=e.options,e[i]=a,Uh(r,a.defaults)}})),e.options)if(e.options.hasOwnProperty(i)){var a=this.modifyOption(e,i,e.options[i]);"undefined"!==typeof a&&(e.options[i]=a)}},getEventProperties:function(e,t){var r={};return xf.forEach((function(n){"function"===typeof n.eventProperties&&Uh(r,n.eventProperties.call(t[n.pluginName],e))})),r},modifyOption:function(e,t,r){var n;return xf.forEach((function(i){e[i.pluginName]&&i.optionListeners&&"function"===typeof i.optionListeners[t]&&(n=i.optionListeners[t].call(e[i.pluginName],r))})),n}};var Tf=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=r.evt,i=Gh(r,["evt"]);Sf.pluginEvent.bind(gp)(e,t,Bh({dragEl:Mf,parentEl:Pf,ghostEl:Af,rootEl:Ef,nextEl:Rf,lastDownEl:If,cloneEl:Df,cloneHidden:Ff,dragStarted:Xf,putSortable:Bf,activeSortable:gp.active,originalEvent:n,oldIndex:Lf,oldDraggableIndex:Vf,newIndex:zf,newDraggableIndex:Nf,hideGhostForTarget:bp,unhideGhostForTarget:vp,cloneNowHidden:function(){Ff=!0},cloneNowShown:function(){Ff=!1},dispatchSortableEvent:function(e){Cf({sortable:t,name:e,originalEvent:n})}},i))};function Cf(e){!function(e){var t=e.sortable,r=e.rootEl,n=e.name,i=e.targetEl,a=e.cloneEl,o=e.toEl,s=e.fromEl,c=e.oldIndex,l=e.newIndex,u=e.oldDraggableIndex,d=e.newDraggableIndex,h=e.originalEvent,f=e.putSortable,p=e.extraEventProperties;if(t=t||r&&r[_f]){var b,v=t.options,m="on"+n.charAt(0).toUpperCase()+n.substr(1);!window.CustomEvent||Hh||Wh?(b=document.createEvent("Event")).initEvent(n,!0,!0):b=new CustomEvent(n,{bubbles:!0,cancelable:!0}),b.to=o||r,b.from=s||r,b.item=i||r,b.clone=a,b.oldIndex=c,b.newIndex=l,b.oldDraggableIndex=u,b.newDraggableIndex=d,b.originalEvent=h,b.pullMode=f?f.lastPutMode:void 0;var y=Bh({},p,Sf.getEventProperties(n,t));for(var g in y)b[g]=y[g];r&&r.dispatchEvent(b),v[m]&&v[m].call(t,b)}}(Bh({putSortable:Bf,cloneEl:Df,targetEl:Mf,rootEl:Ef,oldIndex:Lf,oldDraggableIndex:Vf,newIndex:zf,newDraggableIndex:Nf},e))}var Mf,Pf,Af,Ef,Rf,If,Df,Ff,Lf,zf,Vf,Nf,Uf,Bf,Gf,qf,Hf,Wf,Qf,Zf,Xf,Yf,$f,Jf,Kf,ep=!1,tp=!1,rp=[],np=!1,ip=!1,ap=[],op=!1,sp=[],cp="undefined"!==typeof document,lp=Xh,up=Wh||Hh?"cssFloat":"float",dp=cp&&!Yh&&!Xh&&"draggable"in document.createElement("div"),hp=function(){if(cp){if(Hh)return!1;var e=document.createElement("x");return e.style.cssText="pointer-events:auto","auto"===e.style.pointerEvents}}(),fp=function(e,t){var r=sf(e),n=parseInt(r.width)-parseInt(r.paddingLeft)-parseInt(r.paddingRight)-parseInt(r.borderLeftWidth)-parseInt(r.borderRightWidth),i=ff(e,0,t),a=ff(e,1,t),o=i&&sf(i),s=a&&sf(a),c=o&&parseInt(o.marginLeft)+parseInt(o.marginRight)+df(i).width,l=s&&parseInt(s.marginLeft)+parseInt(s.marginRight)+df(a).width;if("flex"===r.display)return"column"===r.flexDirection||"column-reverse"===r.flexDirection?"vertical":"horizontal";if("grid"===r.display)return r.gridTemplateColumns.split(" ").length<=1?"vertical":"horizontal";if(i&&o.float&&"none"!==o.float){var u="left"===o.float?"left":"right";return!a||"both"!==s.clear&&s.clear!==u?"horizontal":"vertical"}return i&&("block"===o.display||"flex"===o.display||"table"===o.display||"grid"===o.display||c>=n&&"none"===r[up]||a&&"none"===r[up]&&c+l>n)?"vertical":"horizontal"},pp=function(e){function t(e,r){return function(n,i,a,o){var s=n.options.group.name&&i.options.group.name&&n.options.group.name===i.options.group.name;if(null==e&&(r||s))return!0;if(null==e||!1===e)return!1;if(r&&"clone"===e)return e;if("function"===typeof e)return t(e(n,i,a,o),r)(n,i,a,o);var c=(r?n:i).options.group.name;return!0===e||"string"===typeof e&&e===c||e.join&&e.indexOf(c)>-1}}var r={},n=e.group;n&&"object"==Vh(n)||(n={name:n}),r.name=n.name,r.checkPull=t(n.pull,!0),r.checkPut=t(n.put),r.revertClone=n.revertClone,e.group=r},bp=function(){!hp&&Af&&sf(Af,"display","none")},vp=function(){!hp&&Af&&sf(Af,"display","")};cp&&document.addEventListener("click",(function(e){if(tp)return e.preventDefault(),e.stopPropagation&&e.stopPropagation(),e.stopImmediatePropagation&&e.stopImmediatePropagation(),tp=!1,!1}),!0);var mp=function(e){if(Mf){var t=function(e,t){var r;return rp.some((function(n){if(!pf(n)){var i=df(n),a=n[_f].options.emptyInsertThreshold,o=e>=i.left-a&&e<=i.right+a,s=t>=i.top-a&&t<=i.bottom+a;return a&&o&&s?r=n:void 0}})),r}((e=e.touches?e.touches[0]:e).clientX,e.clientY);if(t){var r={};for(var n in e)e.hasOwnProperty(n)&&(r[n]=e[n]);r.target=r.rootEl=t,r.preventDefault=void 0,r.stopPropagation=void 0,t[_f]._onDragOver(r)}}},yp=function(e){Mf&&Mf.parentNode[_f]._isOutsideThisEl(e.target)};function gp(e,t){if(!e||!e.nodeType||1!==e.nodeType)throw"Sortable: `el` must be an HTMLElement, not ".concat({}.toString.call(e));this.el=e,this.options=t=Uh({},t),e[_f]=this;var r={group:null,sort:!0,disabled:!1,store:null,handle:null,draggable:/^[uo]l$/i.test(e.nodeName)?">li":">*",swapThreshold:1,invertSwap:!1,invertedSwapThreshold:null,removeCloneOnHide:!0,direction:function(){return fp(e,this.options)},ghostClass:"sortable-ghost",chosenClass:"sortable-chosen",dragClass:"sortable-drag",ignore:"a, img",filter:null,preventOnFilter:!0,animation:0,easing:null,setData:function(e,t){e.setData("Text",t.textContent)},dropBubble:!1,dragoverBubble:!1,dataIdAttr:"data-id",delay:0,delayOnTouchOnly:!1,touchStartThreshold:(Number.parseInt?Number:window).parseInt(window.devicePixelRatio,10)||1,forceFallback:!1,fallbackClass:"sortable-fallback",fallbackOnBody:!1,fallbackTolerance:0,fallbackOffset:{x:0,y:0},supportPointer:!1!==gp.supportPointer&&"PointerEvent"in window&&!Zh,emptyInsertThreshold:5};for(var n in Sf.initializePlugins(this,e,r),r)!(n in t)&&(t[n]=r[n]);for(var i in pp(t),this)"_"===i.charAt(0)&&"function"===typeof this[i]&&(this[i]=this[i].bind(this));this.nativeDraggable=!t.forceFallback&&dp,this.nativeDraggable&&(this.options.touchStartThreshold=1),t.supportPointer?Jh(e,"pointerdown",this._onTapStart):(Jh(e,"mousedown",this._onTapStart),Jh(e,"touchstart",this._onTapStart)),this.nativeDraggable&&(Jh(e,"dragover",this),Jh(e,"dragenter",this)),rp.push(this.el),t.store&&t.store.get&&this.sort(t.store.get(this)||[]),Uh(this,wf())}function Op(e,t,r,n,i,a,o,s){var c,l,u=e[_f],d=u.options.onMove;return!window.CustomEvent||Hh||Wh?(c=document.createEvent("Event")).initEvent("move",!0,!0):c=new CustomEvent("move",{bubbles:!0,cancelable:!0}),c.to=t,c.from=e,c.dragged=r,c.draggedRect=n,c.related=i||t,c.relatedRect=a||df(t),c.willInsertAfter=s,c.originalEvent=o,e.dispatchEvent(c),d&&(l=d.call(u,c,o)),l}function jp(e){e.draggable=!1}function _p(){op=!1}function wp(e){for(var t=e.tagName+e.className+e.src+e.href+e.textContent,r=t.length,n=0;r--;)n+=t.charCodeAt(r);return n.toString(36)}function xp(e){return setTimeout(e,0)}function kp(e){return clearTimeout(e)}gp.prototype={constructor:gp,_isOutsideThisEl:function(e){this.el.contains(e)||e===this.el||(Yf=null)},_getDirection:function(e,t){return"function"===typeof this.options.direction?this.options.direction.call(this,e,t,Mf):this.options.direction},_onTapStart:function(e){if(e.cancelable){var t=this,r=this.el,n=this.options,i=n.preventOnFilter,a=e.type,o=e.touches&&e.touches[0]||e.pointerType&&"touch"===e.pointerType&&e,s=(o||e).target,c=e.target.shadowRoot&&(e.path&&e.path[0]||e.composedPath&&e.composedPath()[0])||s,l=n.filter;if(function(e){sp.length=0;var t=e.getElementsByTagName("input"),r=t.length;for(;r--;){var n=t[r];n.checked&&sp.push(n)}}(r),!Mf&&!(/mousedown|pointerdown/.test(a)&&0!==e.button||n.disabled)&&!c.isContentEditable&&(this.nativeDraggable||!Zh||!s||"SELECT"!==s.tagName.toUpperCase())&&(!(s=rf(s,n.draggable,r,!1))||!s.animated)&&If!==s){if(Lf=bf(s),Vf=bf(s,n.draggable),"function"===typeof l){if(l.call(this,e,s,this))return Cf({sortable:t,rootEl:c,name:"filter",targetEl:s,toEl:r,fromEl:r}),Tf("filter",t,{evt:e}),void(i&&e.cancelable&&e.preventDefault())}else if(l&&(l=l.split(",").some((function(n){if(n=rf(c,n.trim(),r,!1))return Cf({sortable:t,rootEl:n,name:"filter",targetEl:s,fromEl:r,toEl:r}),Tf("filter",t,{evt:e}),!0}))))return void(i&&e.cancelable&&e.preventDefault());n.handle&&!rf(c,n.handle,r,!1)||this._prepareDragStart(e,o,s)}}},_prepareDragStart:function(e,t,r){var n,i=this,a=i.el,o=i.options,s=a.ownerDocument;if(r&&!Mf&&r.parentNode===a){var c=df(r);if(Ef=a,Pf=(Mf=r).parentNode,Rf=Mf.nextSibling,If=r,Uf=o.group,gp.dragged=Mf,Gf={target:Mf,clientX:(t||e).clientX,clientY:(t||e).clientY},Qf=Gf.clientX-c.left,Zf=Gf.clientY-c.top,this._lastX=(t||e).clientX,this._lastY=(t||e).clientY,Mf.style["will-change"]="all",n=function(){Tf("delayEnded",i,{evt:e}),gp.eventCanceled?i._onDrop():(i._disableDelayedDragEvents(),!Qh&&i.nativeDraggable&&(Mf.draggable=!0),i._triggerDragStart(e,t),Cf({sortable:i,name:"choose",originalEvent:e}),of(Mf,o.chosenClass,!0))},o.ignore.split(",").forEach((function(e){lf(Mf,e.trim(),jp)})),Jh(s,"dragover",mp),Jh(s,"mousemove",mp),Jh(s,"touchmove",mp),Jh(s,"mouseup",i._onDrop),Jh(s,"touchend",i._onDrop),Jh(s,"touchcancel",i._onDrop),Qh&&this.nativeDraggable&&(this.options.touchStartThreshold=4,Mf.draggable=!0),Tf("delayStart",this,{evt:e}),!o.delay||o.delayOnTouchOnly&&!t||this.nativeDraggable&&(Wh||Hh))n();else{if(gp.eventCanceled)return void this._onDrop();Jh(s,"mouseup",i._disableDelayedDrag),Jh(s,"touchend",i._disableDelayedDrag),Jh(s,"touchcancel",i._disableDelayedDrag),Jh(s,"mousemove",i._delayedDragTouchMoveHandler),Jh(s,"touchmove",i._delayedDragTouchMoveHandler),o.supportPointer&&Jh(s,"pointermove",i._delayedDragTouchMoveHandler),i._dragStartTimer=setTimeout(n,o.delay)}}},_delayedDragTouchMoveHandler:function(e){var t=e.touches?e.touches[0]:e;Math.max(Math.abs(t.clientX-this._lastX),Math.abs(t.clientY-this._lastY))>=Math.floor(this.options.touchStartThreshold/(this.nativeDraggable&&window.devicePixelRatio||1))&&this._disableDelayedDrag()},_disableDelayedDrag:function(){Mf&&jp(Mf),clearTimeout(this._dragStartTimer),this._disableDelayedDragEvents()},_disableDelayedDragEvents:function(){var e=this.el.ownerDocument;Kh(e,"mouseup",this._disableDelayedDrag),Kh(e,"touchend",this._disableDelayedDrag),Kh(e,"touchcancel",this._disableDelayedDrag),Kh(e,"mousemove",this._delayedDragTouchMoveHandler),Kh(e,"touchmove",this._delayedDragTouchMoveHandler),Kh(e,"pointermove",this._delayedDragTouchMoveHandler)},_triggerDragStart:function(e,t){t=t||"touch"==e.pointerType&&e,!this.nativeDraggable||t?this.options.supportPointer?Jh(document,"pointermove",this._onTouchMove):Jh(document,t?"touchmove":"mousemove",this._onTouchMove):(Jh(Mf,"dragend",this),Jh(Ef,"dragstart",this._onDragStart));try{document.selection?xp((function(){document.selection.empty()})):window.getSelection().removeAllRanges()}catch(r){}},_dragStarted:function(e,t){if(ep=!1,Ef&&Mf){Tf("dragStarted",this,{evt:t}),this.nativeDraggable&&Jh(document,"dragover",yp);var r=this.options;!e&&of(Mf,r.dragClass,!1),of(Mf,r.ghostClass,!0),gp.active=this,e&&this._appendGhost(),Cf({sortable:this,name:"start",originalEvent:t})}else this._nulling()},_emulateDragOver:function(){if(qf){this._lastX=qf.clientX,this._lastY=qf.clientY,bp();for(var e=document.elementFromPoint(qf.clientX,qf.clientY),t=e;e&&e.shadowRoot&&(e=e.shadowRoot.elementFromPoint(qf.clientX,qf.clientY))!==t;)t=e;if(Mf.parentNode[_f]._isOutsideThisEl(e),t)do{if(t[_f]){if(t[_f]._onDragOver({clientX:qf.clientX,clientY:qf.clientY,target:e,rootEl:t})&&!this.options.dragoverBubble)break}e=t}while(t=t.parentNode);vp()}},_onTouchMove:function(e){if(Gf){var t=this.options,r=t.fallbackTolerance,n=t.fallbackOffset,i=e.touches?e.touches[0]:e,a=Af&&cf(Af,!0),o=Af&&a&&a.a,s=Af&&a&&a.d,c=lp&&Kf&&vf(Kf),l=(i.clientX-Gf.clientX+n.x)/(o||1)+(c?c[0]-ap[0]:0)/(o||1),u=(i.clientY-Gf.clientY+n.y)/(s||1)+(c?c[1]-ap[1]:0)/(s||1);if(!gp.active&&!ep){if(r&&Math.max(Math.abs(i.clientX-this._lastX),Math.abs(i.clientY-this._lastY))<r)return;this._onDragStart(e,!0)}if(Af){a?(a.e+=l-(Hf||0),a.f+=u-(Wf||0)):a={a:1,b:0,c:0,d:1,e:l,f:u};var d="matrix(".concat(a.a,",").concat(a.b,",").concat(a.c,",").concat(a.d,",").concat(a.e,",").concat(a.f,")");sf(Af,"webkitTransform",d),sf(Af,"mozTransform",d),sf(Af,"msTransform",d),sf(Af,"transform",d),Hf=l,Wf=u,qf=i}e.cancelable&&e.preventDefault()}},_appendGhost:function(){if(!Af){var e=this.options.fallbackOnBody?document.body:Ef,t=df(Mf,!0,lp,!0,e),r=this.options;if(lp){for(Kf=e;"static"===sf(Kf,"position")&&"none"===sf(Kf,"transform")&&Kf!==document;)Kf=Kf.parentNode;Kf!==document.body&&Kf!==document.documentElement?(Kf===document&&(Kf=uf()),t.top+=Kf.scrollTop,t.left+=Kf.scrollLeft):Kf=uf(),ap=vf(Kf)}of(Af=Mf.cloneNode(!0),r.ghostClass,!1),of(Af,r.fallbackClass,!0),of(Af,r.dragClass,!0),sf(Af,"transition",""),sf(Af,"transform",""),sf(Af,"box-sizing","border-box"),sf(Af,"margin",0),sf(Af,"top",t.top),sf(Af,"left",t.left),sf(Af,"width",t.width),sf(Af,"height",t.height),sf(Af,"opacity","0.8"),sf(Af,"position",lp?"absolute":"fixed"),sf(Af,"zIndex","100000"),sf(Af,"pointerEvents","none"),gp.ghost=Af,e.appendChild(Af),sf(Af,"transform-origin",Qf/parseInt(Af.style.width)*100+"% "+Zf/parseInt(Af.style.height)*100+"%")}},_onDragStart:function(e,t){var r=this,n=e.dataTransfer,i=r.options;Tf("dragStart",this,{evt:e}),gp.eventCanceled?this._onDrop():(Tf("setupClone",this),gp.eventCanceled||((Df=jf(Mf)).draggable=!1,Df.style["will-change"]="",this._hideClone(),of(Df,this.options.chosenClass,!1),gp.clone=Df),r.cloneId=xp((function(){Tf("clone",r),gp.eventCanceled||(r.options.removeCloneOnHide||Ef.insertBefore(Df,Mf),r._hideClone(),Cf({sortable:r,name:"clone"}))})),!t&&of(Mf,i.dragClass,!0),t?(tp=!0,r._loopId=setInterval(r._emulateDragOver,50)):(Kh(document,"mouseup",r._onDrop),Kh(document,"touchend",r._onDrop),Kh(document,"touchcancel",r._onDrop),n&&(n.effectAllowed="move",i.setData&&i.setData.call(r,n,Mf)),Jh(document,"drop",r),sf(Mf,"transform","translateZ(0)")),ep=!0,r._dragStartId=xp(r._dragStarted.bind(r,t,e)),Jh(document,"selectstart",r),Xf=!0,Zh&&sf(document.body,"user-select","none"))},_onDragOver:function(e){var t,r,n,i,a=this.el,o=e.target,s=this.options,c=s.group,l=gp.active,u=Uf===c,d=s.sort,h=Bf||l,f=this,p=!1;if(!op){if(void 0!==e.preventDefault&&e.cancelable&&e.preventDefault(),o=rf(o,s.draggable,a,!0),C("dragOver"),gp.eventCanceled)return p;if(Mf.contains(e.target)||o.animated&&o.animatingX&&o.animatingY||f._ignoreWhileAnimating===o)return P(!1);if(tp=!1,l&&!s.disabled&&(u?d||(n=!Ef.contains(Mf)):Bf===this||(this.lastPutMode=Uf.checkPull(this,l,Mf,e))&&c.checkPut(this,l,Mf,e))){if(i="vertical"===this._getDirection(e,o),t=df(Mf),C("dragOverValid"),gp.eventCanceled)return p;if(n)return Pf=Ef,M(),this._hideClone(),C("revert"),gp.eventCanceled||(Rf?Ef.insertBefore(Mf,Rf):Ef.appendChild(Mf)),P(!0);var b=pf(a,s.draggable);if(!b||function(e,t,r){var n=df(pf(r.el,r.options.draggable)),i=10;return t?e.clientX>n.right+i||e.clientX<=n.right&&e.clientY>n.bottom&&e.clientX>=n.left:e.clientX>n.right&&e.clientY>n.top||e.clientX<=n.right&&e.clientY>n.bottom+i}(e,i,this)&&!b.animated){if(b===Mf)return P(!1);if(b&&a===e.target&&(o=b),o&&(r=df(o)),!1!==Op(Ef,a,Mf,t,o,r,e,!!o))return M(),a.appendChild(Mf),Pf=a,A(),P(!0)}else if(o.parentNode===a){r=df(o);var v,m,y,g=Mf.parentNode!==a,O=!function(e,t,r){var n=r?e.left:e.top,i=r?e.right:e.bottom,a=r?e.width:e.height,o=r?t.left:t.top,s=r?t.right:t.bottom,c=r?t.width:t.height;return n===o||i===s||n+a/2===o+c/2}(Mf.animated&&Mf.toRect||t,o.animated&&o.toRect||r,i),j=i?"top":"left",_=hf(o,"top","top")||hf(Mf,"top","top"),w=_?_.scrollTop:void 0;if(Yf!==o&&(m=r[j],np=!1,ip=!O&&s.invertSwap||g),0!==(v=function(e,t,r,n,i,a,o,s){var c=n?e.clientY:e.clientX,l=n?r.height:r.width,u=n?r.top:r.left,d=n?r.bottom:r.right,h=!1;if(!o)if(s&&Jf<l*i){if(!np&&(1===$f?c>u+l*a/2:c<d-l*a/2)&&(np=!0),np)h=!0;else if(1===$f?c<u+Jf:c>d-Jf)return-$f}else if(c>u+l*(1-i)/2&&c<d-l*(1-i)/2)return function(e){return bf(Mf)<bf(e)?1:-1}(t);if((h=h||o)&&(c<u+l*a/2||c>d-l*a/2))return c>u+l/2?1:-1;return 0}(e,o,r,i,O?1:s.swapThreshold,null==s.invertedSwapThreshold?s.swapThreshold:s.invertedSwapThreshold,ip,Yf===o))){var x=bf(Mf);do{x-=v,y=Pf.children[x]}while(y&&("none"===sf(y,"display")||y===Af))}if(0===v||y===o)return P(!1);Yf=o,$f=v;var k=o.nextElementSibling,S=!1,T=Op(Ef,a,Mf,t,o,r,e,S=1===v);if(!1!==T)return 1!==T&&-1!==T||(S=1===T),op=!0,setTimeout(_p,30),M(),S&&!k?a.appendChild(Mf):o.parentNode.insertBefore(Mf,S?k:o),_&&Of(_,0,w-_.scrollTop),Pf=Mf.parentNode,void 0===m||ip||(Jf=Math.abs(m-df(o)[j])),A(),P(!0)}if(a.contains(Mf))return P(!1)}return!1}function C(s,c){Tf(s,f,Bh({evt:e,isOwner:u,axis:i?"vertical":"horizontal",revert:n,dragRect:t,targetRect:r,canSort:d,fromSortable:h,target:o,completed:P,onMove:function(r,n){return Op(Ef,a,Mf,t,r,df(r),e,n)},changed:A},c))}function M(){C("dragOverAnimationCapture"),f.captureAnimationState(),f!==h&&h.captureAnimationState()}function P(t){return C("dragOverCompleted",{insertion:t}),t&&(u?l._hideClone():l._showClone(f),f!==h&&(of(Mf,Bf?Bf.options.ghostClass:l.options.ghostClass,!1),of(Mf,s.ghostClass,!0)),Bf!==f&&f!==gp.active?Bf=f:f===gp.active&&Bf&&(Bf=null),h===f&&(f._ignoreWhileAnimating=o),f.animateAll((function(){C("dragOverAnimationComplete"),f._ignoreWhileAnimating=null})),f!==h&&(h.animateAll(),h._ignoreWhileAnimating=null)),(o===Mf&&!Mf.animated||o===a&&!o.animated)&&(Yf=null),s.dragoverBubble||e.rootEl||o===document||(Mf.parentNode[_f]._isOutsideThisEl(e.target),!t&&mp(e)),!s.dragoverBubble&&e.stopPropagation&&e.stopPropagation(),p=!0}function A(){zf=bf(Mf),Nf=bf(Mf,s.draggable),Cf({sortable:f,name:"change",toEl:a,newIndex:zf,newDraggableIndex:Nf,originalEvent:e})}},_ignoreWhileAnimating:null,_offMoveEvents:function(){Kh(document,"mousemove",this._onTouchMove),Kh(document,"touchmove",this._onTouchMove),Kh(document,"pointermove",this._onTouchMove),Kh(document,"dragover",mp),Kh(document,"mousemove",mp),Kh(document,"touchmove",mp)},_offUpEvents:function(){var e=this.el.ownerDocument;Kh(e,"mouseup",this._onDrop),Kh(e,"touchend",this._onDrop),Kh(e,"pointerup",this._onDrop),Kh(e,"touchcancel",this._onDrop),Kh(document,"selectstart",this)},_onDrop:function(e){var t=this.el,r=this.options;zf=bf(Mf),Nf=bf(Mf,r.draggable),Tf("drop",this,{evt:e}),Pf=Mf&&Mf.parentNode,zf=bf(Mf),Nf=bf(Mf,r.draggable),gp.eventCanceled||(ep=!1,ip=!1,np=!1,clearInterval(this._loopId),clearTimeout(this._dragStartTimer),kp(this.cloneId),kp(this._dragStartId),this.nativeDraggable&&(Kh(document,"drop",this),Kh(t,"dragstart",this._onDragStart)),this._offMoveEvents(),this._offUpEvents(),Zh&&sf(document.body,"user-select",""),sf(Mf,"transform",""),e&&(Xf&&(e.cancelable&&e.preventDefault(),!r.dropBubble&&e.stopPropagation()),Af&&Af.parentNode&&Af.parentNode.removeChild(Af),(Ef===Pf||Bf&&"clone"!==Bf.lastPutMode)&&Df&&Df.parentNode&&Df.parentNode.removeChild(Df),Mf&&(this.nativeDraggable&&Kh(Mf,"dragend",this),jp(Mf),Mf.style["will-change"]="",Xf&&!ep&&of(Mf,Bf?Bf.options.ghostClass:this.options.ghostClass,!1),of(Mf,this.options.chosenClass,!1),Cf({sortable:this,name:"unchoose",toEl:Pf,newIndex:null,newDraggableIndex:null,originalEvent:e}),Ef!==Pf?(zf>=0&&(Cf({rootEl:Pf,name:"add",toEl:Pf,fromEl:Ef,originalEvent:e}),Cf({sortable:this,name:"remove",toEl:Pf,originalEvent:e}),Cf({rootEl:Pf,name:"sort",toEl:Pf,fromEl:Ef,originalEvent:e}),Cf({sortable:this,name:"sort",toEl:Pf,originalEvent:e})),Bf&&Bf.save()):zf!==Lf&&zf>=0&&(Cf({sortable:this,name:"update",toEl:Pf,originalEvent:e}),Cf({sortable:this,name:"sort",toEl:Pf,originalEvent:e})),gp.active&&(null!=zf&&-1!==zf||(zf=Lf,Nf=Vf),Cf({sortable:this,name:"end",toEl:Pf,originalEvent:e}),this.save())))),this._nulling()},_nulling:function(){Tf("nulling",this),Ef=Mf=Pf=Af=Rf=Df=If=Ff=Gf=qf=Xf=zf=Nf=Lf=Vf=Yf=$f=Bf=Uf=gp.dragged=gp.ghost=gp.clone=gp.active=null,sp.forEach((function(e){e.checked=!0})),sp.length=Hf=Wf=0},handleEvent:function(e){switch(e.type){case"drop":case"dragend":this._onDrop(e);break;case"dragenter":case"dragover":Mf&&(this._onDragOver(e),function(e){e.dataTransfer&&(e.dataTransfer.dropEffect="move");e.cancelable&&e.preventDefault()}(e));break;case"selectstart":e.preventDefault()}},toArray:function(){for(var e,t=[],r=this.el.children,n=0,i=r.length,a=this.options;n<i;n++)rf(e=r[n],a.draggable,this.el,!1)&&t.push(e.getAttribute(a.dataIdAttr)||wp(e));return t},sort:function(e,t){var r={},n=this.el;this.toArray().forEach((function(e,t){var i=n.children[t];rf(i,this.options.draggable,n,!1)&&(r[e]=i)}),this),t&&this.captureAnimationState(),e.forEach((function(e){r[e]&&(n.removeChild(r[e]),n.appendChild(r[e]))})),t&&this.animateAll()},save:function(){var e=this.options.store;e&&e.set&&e.set(this)},closest:function(e,t){return rf(e,t||this.options.draggable,this.el,!1)},option:function(e,t){var r=this.options;if(void 0===t)return r[e];var n=Sf.modifyOption(this,e,t);r[e]="undefined"!==typeof n?n:t,"group"===e&&pp(r)},destroy:function(){Tf("destroy",this);var e=this.el;e[_f]=null,Kh(e,"mousedown",this._onTapStart),Kh(e,"touchstart",this._onTapStart),Kh(e,"pointerdown",this._onTapStart),this.nativeDraggable&&(Kh(e,"dragover",this),Kh(e,"dragenter",this)),Array.prototype.forEach.call(e.querySelectorAll("[draggable]"),(function(e){e.removeAttribute("draggable")})),this._onDrop(),this._disableDelayedDragEvents(),rp.splice(rp.indexOf(this.el),1),this.el=e=null},_hideClone:function(){if(!Ff){if(Tf("hideClone",this),gp.eventCanceled)return;sf(Df,"display","none"),this.options.removeCloneOnHide&&Df.parentNode&&Df.parentNode.removeChild(Df),Ff=!0}},_showClone:function(e){if("clone"===e.lastPutMode){if(Ff){if(Tf("showClone",this),gp.eventCanceled)return;Mf.parentNode!=Ef||this.options.group.revertClone?Rf?Ef.insertBefore(Df,Rf):Ef.appendChild(Df):Ef.insertBefore(Df,Mf),this.options.group.revertClone&&this.animate(Mf,Df),sf(Df,"display",""),Ff=!1}}else this._hideClone()}},cp&&Jh(document,"touchmove",(function(e){(gp.active||ep)&&e.cancelable&&e.preventDefault()})),gp.utils={on:Jh,off:Kh,css:sf,find:lf,is:function(e,t){return!!rf(e,t,e,!1)},extend:function(e,t){if(e&&t)for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);return e},throttle:gf,closest:rf,toggleClass:of,clone:jf,index:bf,nextTick:xp,cancelNextTick:kp,detectDirection:fp,getChild:ff},gp.get=function(e){return e[_f]},gp.mount=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];t[0].constructor===Array&&(t=t[0]),t.forEach((function(e){if(!e.prototype||!e.prototype.constructor)throw"Sortable: Mounted plugin must be a constructor function, not ".concat({}.toString.call(e));e.utils&&(gp.utils=Bh({},gp.utils,e.utils)),Sf.mount(e)}))},gp.create=function(e,t){return new gp(e,t)},gp.version="1.13.0";var Sp,Tp,Cp,Mp,Pp,Ap,Ep=[],Rp=!1;function Ip(){Ep.forEach((function(e){clearInterval(e.pid)})),Ep=[]}function Dp(){clearInterval(Ap)}var Fp=gf((function(e,t,r,n){if(t.scroll){var i,a=(e.touches?e.touches[0]:e).clientX,o=(e.touches?e.touches[0]:e).clientY,s=t.scrollSensitivity,c=t.scrollSpeed,l=uf(),u=!1;Tp!==r&&(Tp=r,Ip(),Sp=t.scroll,i=t.scrollFn,!0===Sp&&(Sp=mf(r,!0)));var d=0,h=Sp;do{var f=h,p=df(f),b=p.top,v=p.bottom,m=p.left,y=p.right,g=p.width,O=p.height,j=void 0,_=void 0,w=f.scrollWidth,x=f.scrollHeight,k=sf(f),S=f.scrollLeft,T=f.scrollTop;f===l?(j=g<w&&("auto"===k.overflowX||"scroll"===k.overflowX||"visible"===k.overflowX),_=O<x&&("auto"===k.overflowY||"scroll"===k.overflowY||"visible"===k.overflowY)):(j=g<w&&("auto"===k.overflowX||"scroll"===k.overflowX),_=O<x&&("auto"===k.overflowY||"scroll"===k.overflowY));var C=j&&(Math.abs(y-a)<=s&&S+g<w)-(Math.abs(m-a)<=s&&!!S),M=_&&(Math.abs(v-o)<=s&&T+O<x)-(Math.abs(b-o)<=s&&!!T);if(!Ep[d])for(var P=0;P<=d;P++)Ep[P]||(Ep[P]={});Ep[d].vx==C&&Ep[d].vy==M&&Ep[d].el===f||(Ep[d].el=f,Ep[d].vx=C,Ep[d].vy=M,clearInterval(Ep[d].pid),0==C&&0==M||(u=!0,Ep[d].pid=setInterval(function(){n&&0===this.layer&&gp.active._onTouchMove(Pp);var t=Ep[this.layer].vy?Ep[this.layer].vy*c:0,r=Ep[this.layer].vx?Ep[this.layer].vx*c:0;"function"===typeof i&&"continue"!==i.call(gp.dragged.parentNode[_f],r,t,e,Pp,Ep[this.layer].el)||Of(Ep[this.layer].el,r,t)}.bind({layer:d}),24))),d++}while(t.bubbleScroll&&h!==l&&(h=mf(h,!1)));Rp=u}}),30),Lp=function(e){var t=e.originalEvent,r=e.putSortable,n=e.dragEl,i=e.activeSortable,a=e.dispatchSortableEvent,o=e.hideGhostForTarget,s=e.unhideGhostForTarget;if(t){var c=r||i;o();var l=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:t,u=document.elementFromPoint(l.clientX,l.clientY);s(),c&&!c.el.contains(u)&&(a("spill"),this.onSpill({dragEl:n,putSortable:r}))}};function zp(){}function Vp(){}zp.prototype={startIndex:null,dragStart:function(e){var t=e.oldDraggableIndex;this.startIndex=t},onSpill:function(e){var t=e.dragEl,r=e.putSortable;this.sortable.captureAnimationState(),r&&r.captureAnimationState();var n=ff(this.sortable.el,this.startIndex,this.options);n?this.sortable.el.insertBefore(t,n):this.sortable.el.appendChild(t),this.sortable.animateAll(),r&&r.animateAll()},drop:Lp},Uh(zp,{pluginName:"revertOnSpill"}),Vp.prototype={onSpill:function(e){var t=e.dragEl,r=e.putSortable||this.sortable;r.captureAnimationState(),t.parentNode&&t.parentNode.removeChild(t),r.animateAll()},drop:Lp},Uh(Vp,{pluginName:"removeOnSpill"}),gp.mount(new function(){function e(){for(var e in this.defaults={scroll:!0,scrollSensitivity:30,scrollSpeed:10,bubbleScroll:!0},this)"_"===e.charAt(0)&&"function"===typeof this[e]&&(this[e]=this[e].bind(this))}return e.prototype={dragStarted:function(e){var t=e.originalEvent;this.sortable.nativeDraggable?Jh(document,"dragover",this._handleAutoScroll):this.options.supportPointer?Jh(document,"pointermove",this._handleFallbackAutoScroll):t.touches?Jh(document,"touchmove",this._handleFallbackAutoScroll):Jh(document,"mousemove",this._handleFallbackAutoScroll)},dragOverCompleted:function(e){var t=e.originalEvent;this.options.dragOverBubble||t.rootEl||this._handleAutoScroll(t)},drop:function(){this.sortable.nativeDraggable?Kh(document,"dragover",this._handleAutoScroll):(Kh(document,"pointermove",this._handleFallbackAutoScroll),Kh(document,"touchmove",this._handleFallbackAutoScroll),Kh(document,"mousemove",this._handleFallbackAutoScroll)),Dp(),Ip(),clearTimeout(nf),nf=void 0},nulling:function(){Pp=Tp=Sp=Rp=Ap=Cp=Mp=null,Ep.length=0},_handleFallbackAutoScroll:function(e){this._handleAutoScroll(e,!0)},_handleAutoScroll:function(e,t){var r=this,n=(e.touches?e.touches[0]:e).clientX,i=(e.touches?e.touches[0]:e).clientY,a=document.elementFromPoint(n,i);if(Pp=e,t||Wh||Hh||Zh){Fp(e,this.options,a,t);var o=mf(a,!0);!Rp||Ap&&n===Cp&&i===Mp||(Ap&&Dp(),Ap=setInterval((function(){var a=mf(document.elementFromPoint(n,i),!0);a!==o&&(o=a,Ip()),Fp(e,r.options,a,t)}),10),Cp=n,Mp=i)}else{if(!this.options.bubbleScroll||mf(a,!0)===uf())return void Ip();Fp(e,this.options,mf(a,!1),!1)}}},Uh(e,{pluginName:"scroll",initializeByDefault:!0})}),gp.mount(Vp,zp);HTMLElement,HTMLElement;var Np,Up=JSON.stringify({display:"flex",flexDirection:"column",flexWrap:"wrap",width:"100%",minWidth:"100%"}).replace(/([a-z0-9])([A-Z])/g,"$1-$2").replace(/[,]/g,";").replace(/["{}]/g,"").toLowerCase(),Bp=(HTMLElement,HTMLElement,HTMLElement,HTMLElement,HTMLElement,HTMLElement,HTMLElement,HTMLElement,HTMLElement,HTMLElement,"button--bottom-left"),Gp="button--bottom-right",qp="button",Hp="delimiter",Wp="hour",Qp="button--hour-down",Zp="button--hour-up",Xp="input",Yp="meridiem",$p="button--meridiem-down",Jp="button--meridiem-up",Kp="minute",eb="button--minute-down",tb="button--minute-up",rb="second",nb="button--second-down",ib="button--second-up",ab="time-picker",ob="button--top-left",sb="button--top-right",cb="Hour",lb="Decrease hour",ub="Increase hour",db="AM/PM",hb="Decrease AM/PM",fb="Increase AM/PM",pb="Minute",bb="Decrease minute",vb="Increase minute",mb="Second",yb="Decrease second",gb="Increase second",Ob=(HTMLElement,"header"),jb="heading",_b="close",wb="container",xb="tip-container",kb="tip-container--advancing",Sb="tip-container--retreating",Tb="pagination",Cb="page-position",Mb="page-next",Pb="page-previous",Ab="chevron-left",Eb="chevron-right",Rb="x",Ib="Tips",Db="Tip",Fb="Close",Lb="Previous",zb="Next",Vb="container",Nb="header",Ub="heading",Bb="close",Gb="image-frame",qb="content",Hb="info",Wb="x",Qb="thumbnail",Zb="Close",Xb=(HTMLElement,HTMLElement,HTMLElement,"container"),Yb="arrow",$b="data-calcite-tooltip-reference",Jb="aria-describedby";HTMLElement,HTMLElement;!function(e){e.Single="single",e.Multi="multi",e.Children="children",e.MultiChildren="multi-children",e.Ancestors="ancestors"}(Np||(Np={}));HTMLElement,HTMLElement;var Kb,ev="handle";!function(e){e.grip="grip"}(Kb||(Kb={}));HTMLElement;var tv="drag",rv="actions-end",nv="actions-start";HTMLElement;function iv(e){!function(e){Ye.$resourcesUrl$=e}(e)}var av,ov=r(93),sv=r(39);av="components/assets";var cv=r(404),lv=r(83),uv=r(138),dv=r(242),hv="esri.widgets.Widget",fv=g.a.getLogger(hv),pv=0,bv="esri-icon-checkbox-unchecked";function vv(e,t){for(var r in t)null!=e[r]&&("object"==typeof e[r]&&"object"==typeof t[r]?vv(e[r],t[r]):e[r]=t[r]);return e}var mv=function(e){var t,r,i,a=Object(n.a)(Object(n.a)({},P),e),o=(r=a,Object(n.a)(Object(n.a)({},A),r)),s=o.performanceLogger,c=!0,l=!1,u=[],d=[],h=function(e,r,n){var i;o.eventHandlerInterceptor=function(e,r,n,o){return function(e){var r;s("domEvent",e);var n,o=function(e,t){for(var r=[];e&&e!==t;)r.push(e),e=e.parentNode;return r}(e.currentTarget,i.domNode),c=o.some((function(e){var t;return customElements.get(null==e||null==(t=e.tagName)?void 0:t.toLowerCase())}));if(e.eventPhase!==Event.CAPTURING_PHASE&&c){var l=e.composedPath(),u=l.slice(l.indexOf(e.currentTarget),l.indexOf(i.domNode)).filter((function(e){return e.getRootNode()===e.ownerDocument})).reverse();r=R(i.getLastRender(),u,!0)}else o.reverse(),r=R(i.getLastRender(),o);return r&&(n=a.handleInterceptedEvent(t,r,this,e)),s("domEventProcessed",e),n}},null==a.postProcessProjectionOptions||a.postProcessProjectionOptions(o);var c=n();i=e(r,c,o),u.push(i),d.push(n),a.afterFirstVNodeRendered&&a.afterFirstVNodeRendered(i,c)},f=function(){if(i=void 0,c){c=!1,s("renderStart",void 0);for(var e=0;e<u.length;e++){var t=d[e]();s("rendered",void 0),u[e].update(t),s("patched",void 0)}s("renderDone",void 0),c=!0}};return a.modifyDoRenderImplementation&&(f=a.modifyDoRenderImplementation(f,u,d)),t={renderNow:f,scheduleRender:function(){i||l||(i=requestAnimationFrame(f))},stop:function(){i&&(cancelAnimationFrame(i),i=void 0),l=!0},resume:function(){l=!1,c=!0,t.scheduleRender()},append:function(e,t){h(M.b.append,e,t)},insertBefore:function(e,t){h(M.b.insertBefore,e,t)},merge:function(e,t){h(M.b.merge,e,t)},replace:function(e,t){h(M.b.replace,e,t)},detach:function(e){for(var t=0;t<d.length;t++)if(d[t]===e)return d.splice(t,1),u.splice(t,1)[0];throw new Error("renderFunction was not found")}},t}({postProcessProjectionOptions:function(e){var t=e.eventHandlerInterceptor,r=/capture$/i;e.eventHandlerInterceptor=function(e,n,i,a){var o=t(e,n,i,a),s=r.test(e);if(!((e=e.replace(r,"")).toLowerCase()in i)||s){var c=e[2].toLowerCase()+e.slice(3),l=function(e){return o.call(i,e)};i.addEventListener(c,l,s);var u=a.afterRemoved;a.afterRemoved=function(e){null==u||u(e),i.removeEventListener(c,l,s)}}return o}},handleInterceptedEvent:function(e,t,r,n){var i=n.eventPhase,a=n.type,o=i===Event.CAPTURING_PHASE,s="on".concat(a).concat(o?"capture":""),c=t.properties;(s in c||(s="on".concat(a[0].toUpperCase()).concat(a.slice(1)).concat(o?"Capture":""))in c)&&(e.scheduleRender(),c[s].call(c.bind||r,n))}}),yv=!1,gv=function(e){Object(d.a)(r,e);var t=Object(h.a)(r);function r(e,n){var a;Object(c.a)(this,r),(a=t.call(this,e,n))._attached=!1,a._internalHandles=new m.a,a._projector=mv,a.domNode=null,a.iconClass=bv,a.label=a.declaredClass.split(".").pop(),a.visible=!0,a.key=Object(u.a)(a),a._loadLocale=Object(j.j)(Object(s.a)(o.a.mark((function e(){var t,r,n,c;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!a._messageBundleProps||!a._messageBundleProps.length){e.next=6;break}return e.next=3,Object(j.k)(a._messageBundleProps.map(function(){var e=Object(s.a)(o.a.mark((function e(t){var r,n,i;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.bundlePath,n=t.propertyName,e.next=3,Object(dv.a)(r);case 3:i=e.sent,a.localeStrings&&Object.keys(a.localeStrings)&&(i=vv(Object(y.a)(i),a.localeStrings)),a[n]=i;case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 3:t=e.sent,r=Object(i.a)(t);try{for(r.s();!(n=r.n()).done;)(c=n.value).error&&fv.error("widget-intl:locale-error",a.declaredClass,c.error)}catch(l){r.e(l)}finally{r.f()}case 6:return e.next=8,a.loadLocale();case 8:case"end":return e.stop()}}),e)})))),iv(Object(sv.A)(Object(ov.b)(av)));var l=Object(lv.e)()||"light";["light","dark"].includes(l)||Object(p.a)(fv,"The following themes are deprecated: light-blue, dark-blue, light-green, dark-green, light-purple, dark-purple, light-red, and dark-red.",{version:"4.19",warnOnce:!0,see:"https://developers.arcgis.com/javascript/latest/styling/"});var d="esri-widget-uid-"+Object(_.a)(),h=a.render.bind(Object(u.a)(a)),f=!1;a._trackingTarget=new C.a((function(){return a.scheduleRender()}));var b=function(){var e;if(!f||a.destroyed)return null;if(!a.visible)return{vnodeSelector:"div",properties:{key:d,class:"",styles:{display:"none"}},domNode:void 0,children:void 0,text:void 0};var t=h(),r=t.properties;r||(t.properties=r={});var n=r,i=n.key,o=n.styles;i||(r.key=d),o||(r.styles=o={}),o.display||(o.display="");var s=0;return null==(e=t.children)||e.forEach((function(e){if(!Object(cv.b)(e.vnodeSelector)){var t=e.properties;t||(e.properties=t={}),t.key||(t.key="".concat(a.id,"--").concat(s++))}})),Object(cv.c)(Object(u.a)(a),t)};return a.render=function(){if(yv)return b();var e;a._trackingTarget.clear(),yv=!0;try{e=Object(T.b)(a._trackingTarget,b)}finally{yv=!1}return e},a.addResolvingPromise(a._resourcesFetch=a.beforeFirstRender().then((function(){f=!0,a._postInitialize()}))),a}return Object(l.a)(r,[{key:"normalizeCtorArgs",value:function(e,t){var r=Object(n.a)({},e);return t&&(r.container=t),r}},{key:"postInitialize",value:function(){}},{key:"beforeFirstRender",value:function(){return this._loadLocale().catch(j.y)}},{key:"loadLocale",value:function(){var e=Object(s.a)(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"destroy",value:function(){this.destroyed||(this._trackingTarget.destroy(),this._trackingTarget=null,this.viewModel&&(this.viewModel.destroy(),this.viewModel=null),this._detach(this.container),this._set("container",null),this._internalHandles.destroy(),this._emitter.clear(),this.render=function(){return null},this._projector=null)}},{key:"container",set:function(e){this._get("container")||this._set("container",e)}},{key:"castContainer",value:function(e){return Object(b.a)(e)}},{key:"id",get:function(){return this._get("id")||this.get("container.id")||Date.now().toString(16)+"-widget-"+pv++},set:function(e){e&&this._set("id",e)}},{key:"renderable",get:function(){return this._resourcesFetch}},{key:"test",get:function(){return{projector:this._projector,handles:this._internalHandles}}},{key:"render",value:function(){throw new Error("not implemented")}},{key:"scheduleRender",value:function(){this.destroyed||this._projector.scheduleRender()}},{key:"classes",value:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return lv.a.apply(this,t)}},{key:"own",value:function(e){arguments.length>1&&(e=Array.prototype.slice.call(arguments)),this._internalHandles.add(e)}},{key:"renderNow",value:function(){this._projector.renderNow()}},{key:"_postInitialize",value:function(){var e,t=this;if(!this.destroyed){this.scheduleRender(),null!=(e=this._delegatedEventNames)&&e.length&&this._internalHandles.add(Object(w.a)(this,"viewModel",(function(e,r){r&&t._internalHandles.remove("delegated-events"),e&&t._internalHandles.add(t._delegatedEventNames.map((function(r){return e.on(r,(function(e){t.emit(r,e)}))})),"delegated-events")}))),this.postInitialize();var r=function(){var e=Object(s.a)(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t._loadLocale().catch(j.y);case 2:t.scheduleRender();case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();this._internalHandles.add([Object(uv.c)(r),this.watch("localeStrings",r),Object(w.j)(this,"container",function(){var e=Object(s.a)(o.a.mark((function e(r){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.destroyed||t._attach(r);case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())])}}},{key:"_attach",value:function(e){e&&(this._projector.merge(e,this.render),this._attached=!0)}},{key:"_detach",value:function(e){e&&this._attached&&(this._projector.detach(this.render),e.parentNode&&e.parentNode.removeChild(e),this._attached=!1)}}]),r}(Object(O.b)(v.a.EventedAccessor));gv[cv.a]=!0,Object(f.a)([Object(x.b)({value:null})],gv.prototype,"container",null),Object(f.a)([Object(k.a)("container")],gv.prototype,"castContainer",null),Object(f.a)([Object(x.b)({aliasOf:"container"})],gv.prototype,"domNode",void 0),Object(f.a)([Object(x.b)()],gv.prototype,"iconClass",void 0),Object(f.a)([Object(x.b)()],gv.prototype,"id",null),Object(f.a)([Object(x.b)()],gv.prototype,"label",void 0),Object(f.a)([Object(x.b)()],gv.prototype,"localeStrings",void 0),Object(f.a)([Object(x.b)()],gv.prototype,"renderable",null),Object(f.a)([Object(x.b)()],gv.prototype,"viewModel",void 0),Object(f.a)([Object(x.b)()],gv.prototype,"visible",void 0),Object(f.a)([Object(x.b)()],gv.prototype,"key",void 0),Object(f.a)([Object(x.b)()],gv.prototype,"afterCreate",void 0),Object(f.a)([Object(x.b)()],gv.prototype,"afterUpdate",void 0),Object(f.a)([Object(x.b)()],gv.prototype,"afterRemoved",void 0);var Ov=gv=Object(f.a)([Object(S.a)(hv)],gv);t.a=Ov},function(e,t,r){"use strict";r.d(t,"a",(function(){return n})),r.d(t,"b",(function(){return i}));r(17);function n(e){}function i(e){return function(){return e}}},function(e,t,r){"use strict";var n=r(8),i=r.n(n),a=r(16),o=r(2),s=r(5),c=r(6),l=r(7),u=r(0),d=r(49),h=r(58),f=r(27),p=r(1),b=(r(17),r(18),r(15),r(48)),v=r(10),m=new h.a({esriSMS:"simple-marker",esriPMS:"picture-marker",esriSLS:"simple-line",esriSFS:"simple-fill",esriPFS:"picture-fill",esriTS:"text",esriSHD:"shield-label-symbol",PointSymbol3D:"point-3d",LineSymbol3D:"line-3d",PolygonSymbol3D:"polygon-3d",WebStyleSymbol:"web-style",MeshSymbol3D:"mesh-3d",LabelSymbol3D:"label-3d",CIMSymbolReference:"cim"}),y=0,g=function(e){Object(c.a)(r,e);var t=Object(l.a)(r);function r(e){var n;return Object(o.a)(this,r),(n=t.call(this,e)).id="sym"+y++,n.type=null,n}return Object(s.a)(r,[{key:"color",set:function(e){this._set("color",e)}},{key:"readColor",value:function(e){return e&&null!=e[0]?[e[0],e[1],e[2],e[3]/255]:e}},{key:"collectRequiredFields",value:function(){var e=Object(a.a)(i.a.mark((function e(t,r){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"hash",value:function(){return JSON.stringify(this.toJSON())}},{key:"clone",value:function(){}}]),r}(f.a);Object(u.a)([Object(p.b)({type:m.apiValues,readOnly:!0,json:{read:!1,write:{ignoreOrigin:!0,writer:m.write}}})],g.prototype,"type",void 0),Object(u.a)([Object(p.b)({type:d.a,value:new d.a([0,0,0,1]),json:{write:{allowNull:!0}}})],g.prototype,"color",null),Object(u.a)([Object(b.a)("color")],g.prototype,"readColor",null);var O=g=Object(u.a)([Object(v.a)("esri.symbols.Symbol")],g);t.a=O},function(e,t,r){"use strict";r.d(t,"a",(function(){return d})),r.d(t,"b",(function(){return c})),r.d(t,"c",(function(){return f})),r.d(t,"d",(function(){return p})),r.d(t,"e",(function(){return u})),r.d(t,"f",(function(){return h})),r.d(t,"g",(function(){return l}));var n=r(3),i=r(26),a=r(31),o=r(360),s=r(46);function c(e,t){return Object(n.i)(e)&&(e=[]),e.push(t),e}function l(e,t){if(Object(n.i)(e))return e;var r=e.filter((function(e){return e!==t}));return 0===r.length?null:r}function u(e){return!!Object(n.j)(e)&&!e.visible}function d(e,t){var r=new Map;return r.set(0,t.acquire(e,0)),r.set(1,t.acquire(e,7)),r.set(4,t.acquire(e,3)),r.set(3,t.acquire(e,2)),r.set(2,t.acquire(e,1)),r.set(5,t.acquire(e,4)),r.set(7,t.acquire(e,3)),r.set(6,t.acquire(e,3)),r}function h(e,t){t.release(e,0),t.release(e,7),t.release(e,3),t.release(e,2),t.release(e,1),t.release(e,4)}function f(e,t,r){var a=e.origin.vec3;Object(s.m)(m,-a[0],-a[1],-a[2]),Object(n.j)(e.transformation)?Object(i.m)(t,m,e.transformation):Object(i.d)(t,m),r&&(Object(i.a)(r,t),Object(i.e)(r,r))}function p(e,t,r,n,i){b[0]=e.get(t,0),b[1]=e.get(t,1),b[2]=e.get(t,2),Object(o.a)(b,v,3),r.set(i,0,v[0]),n.set(i,0,v[1]),r.set(i,1,v[2]),n.set(i,1,v[3]),r.set(i,2,v[4]),n.set(i,2,v[5])}var b=new Float64Array(3),v=new Float32Array(6),m=Object(a.d)()},function(e,t,r){"use strict";var n,i=r(14),a=r(21),o=r(2),s=r(5),c=r(19),l=r(6),u=r(7),d=r(0),h=r(126),f=r(272),p=r(98),b=r(27),v=r(25),m=r(3),y=r(182),g=r(1),O=(r(18),r(17),r(15),r(10)),j=r(100),_=n=function(e){Object(l.a)(r,e);var t=Object(u.a)(r);function r(){var e;Object(o.a)(this,r);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return(e=t.call.apply(t,[this].concat(i))).isAggregate=!1,e.layer=null,e.popupTemplate=null,e.sourceLayer=null,Object.defineProperty(Object(c.a)(e),"uid",{value:Object(y.b)(),configurable:!0}),e}return Object(s.a)(r,[{key:"normalizeCtorArgs",value:function(e,t,r,n){return e&&!e.declaredClass?e:{geometry:e,symbol:t,attributes:r,popupTemplate:n}}},{key:"attributes",set:function(e){var t=this._get("attributes");t!==e&&(this._set("attributes",e),this._notifyLayer("attributes",t,e))}},{key:"geometry",set:function(e){var t=this._get("geometry");t!==e&&(this._set("geometry",e),this._notifyLayer("geometry",t,e))}},{key:"symbol",set:function(e){var t=this._get("symbol");t!==e&&(this._set("symbol",e),this._notifyLayer("symbol",t,e))}},{key:"visible",set:function(e){var t=this._get("visible");t!==e&&(this._set("visible",e),this._notifyLayer("visible",t,e))}},{key:"getEffectivePopupTemplate",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.popupTemplate)return this.popupTemplate;for(var t=0,r=[this.sourceLayer,this.layer];t<r.length;t++){var n=r[t];if(n){if("popupTemplate"in n&&n.popupTemplate)return n.popupTemplate;if(e&&"defaultPopupTemplate"in n&&Object(m.j)(n.defaultPopupTemplate))return n.defaultPopupTemplate}}return null}},{key:"getAttribute",value:function(e){return this.attributes&&this.attributes[e]}},{key:"setAttribute",value:function(e,t){if(this.attributes){var r=this.getAttribute(e);this.attributes[e]=t,this._notifyLayer("attributes",r,t,e)}else this.attributes=Object(a.a)({},e,t),this._notifyLayer("attributes",void 0,t,e)}},{key:"getObjectId",value:function(){return this.sourceLayer&&"objectIdField"in this.sourceLayer&&this.sourceLayer.objectIdField?this.getAttribute(this.sourceLayer.objectIdField):null}},{key:"toJSON",value:function(){return{geometry:Object(m.j)(this.geometry)?this.geometry.toJSON():null,symbol:Object(m.j)(this.symbol)?this.symbol.toJSON():null,attributes:Object(i.a)({},this.attributes),popupTemplate:this.popupTemplate&&this.popupTemplate.toJSON()}}},{key:"clone",value:function(){return new n(this.cloneProperties())}},{key:"notifyGeometryChanged",value:function(){this._notifyLayer("geometry",this.geometry,this.geometry)}},{key:"cloneProperties",value:function(){return{attributes:Object(v.a)(this.attributes),geometry:Object(v.a)(this.geometry),layer:this.layer,popupTemplate:this.popupTemplate&&this.popupTemplate.clone(),sourceLayer:this.sourceLayer,symbol:Object(v.a)(this.symbol),visible:this.visible}}},{key:"_notifyLayer",value:function(e,t,r,n){if(this.layer&&"graphicChanged"in this.layer){var i={graphic:this,property:e,oldValue:t,newValue:r};"attributes"===e&&(i.attributeName=n),this.layer.graphicChanged(i)}}}]),r}(b.a);Object(d.a)([Object(g.b)({value:null})],_.prototype,"attributes",null),Object(d.a)([Object(g.b)({value:null,types:h.a,json:{read:j.a}})],_.prototype,"geometry",null),Object(d.a)([Object(g.b)({type:Boolean})],_.prototype,"isAggregate",void 0),Object(d.a)([Object(g.b)()],_.prototype,"layer",void 0),Object(d.a)([Object(g.b)({type:f.a})],_.prototype,"popupTemplate",void 0),Object(d.a)([Object(g.b)()],_.prototype,"sourceLayer",void 0),Object(d.a)([Object(g.b)({value:null,types:p.e})],_.prototype,"symbol",null),Object(d.a)([Object(g.b)({type:Boolean,value:!0})],_.prototype,"visible",null),_=n=Object(d.a)([Object(O.a)("esri.Graphic")],_),(_||(_={})).generateUID=y.b;var w=_;t.a=w},function(e,t,r){"use strict";r.d(t,"a",(function(){return b})),r.d(t,"b",(function(){return d})),r.d(t,"c",(function(){return f}));var n,i,a,o,s,c=r(71),l=null!=(n=null==(i=c.a.esriConfig)?void 0:i.locale)?n:null==(a=c.a.dojoConfig)?void 0:a.locale;function u(){var e,t;return null!=(e=null!=l?l:null==(t=c.a.navigator)?void 0:t.language)?e:"en"}function d(){return void 0===s&&(s=u()),s}var h=[];function f(e){return h.push(e),{remove:function(){h.splice(h.indexOf(e),1)}}}var p=[];function b(e){return p.push(e),{remove:function(){h.splice(p.indexOf(e),1)}}}function v(){var e,t=null!=(e=o)?e:u();s!==t&&(s=t,[].concat(p).forEach((function(e){e.call(null,t)})),[].concat(h).forEach((function(e){e.call(null,t)})))}null==c.a.addEventListener||c.a.addEventListener("languagechange",v)},function(e,t,r){"use strict";r.d(t,"a",(function(){return c})),r.d(t,"b",(function(){return s})),r.d(t,"c",(function(){return h})),r.d(t,"d",(function(){return p})),r.d(t,"e",(function(){return u})),r.d(t,"f",(function(){return b})),r.d(t,"g",(function(){return d})),r.d(t,"h",(function(){return f})),r.d(t,"i",(function(){return l})),r.d(t,"j",(function(){return v}));r(13);var n=r(2),i=r(5),a=r(3),o=r(74),s=function(){function e(){Object(n.a)(this,e),this._queue=new o.a,this._last=null,this.remove=function(){}}return Object(i.a)(e,[{key:"done",get:function(){return 0===this._queue.length&&(!this._last||this._last.isLeaf)}},{key:"resetOne",value:function(e){this._queue.clear(),this._queue.push(e),this._last=null}},{key:"reset",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this._queue.clear(),Object(a.j)(e)&&this._queue.pushArray(e),this._last=null}},{key:"skipSubtree",value:function(){this._last=null}},{key:"next",value:function(){return this._last&&!this._last.isLeaf&&this._queue.pushArray(this._last.children),this._last=this._queue.pop(),this._last}}]),e}(),c=function(){function e(){Object(n.a)(this,e),this.q=new o.a}return Object(i.a)(e,[{key:"done",get:function(){return 0===this.q.length}},{key:"reset",value:function(e){if(this.q.clear(),e){this.q.pushArray(e);for(var t=0;t<this.q.length;++t){var r=this.q.data[t];r.isLeaf||this.q.pushArray(r.children)}}}},{key:"next",value:function(){return this.q.pop()}}]),e}();function l(e){return Object(a.j)(e)?e.lij.toString():"null"}function u(e,t,r){if(Object(a.i)(t))return!1;var n=t.fullExtent,i=e.extent;if(r){if(i[0]<n.xmin||i[1]<n.ymin||i[2]>n.xmax||i[3]>n.ymax)return!1}else if(n.xmin>i[2]||n.ymin>i[3]||n.xmax<i[0]||n.ymax<i[1])return!1;var o=e.surface.tilingScheme.levels[e.lij[0]].scale;return!(t.minScale>0&&o>1.00000001*t.minScale)&&!(t.maxScale>0&&o<.99999999*t.maxScale)}function d(e,t){t.sort((function(t,r){return h(t,r,e)}))}function h(e,t,r){var n=e.screenDepth,i=t.screenDepth;return n<i?-r:n>i?r:0}function f(e,t){var r=new Map;e.forAll((function(e){return r.set(e,e.distanceToSquared(t))})),e.sort((function(e,t){return r.get(e)-r.get(t)}))}function p(e,t,r){for(var n=1,i=0,a=0;e!==t;)if(n*=.5,i*=.5,a*=.5,1&e.lij[2]&&(i+=.5),0==(1&e.lij[1])&&(a+=.5),null==(e=e.parent))throw new Error("tile was not a descendant of upsampleTile");r.init(t,i,a,n)}function b(e){for(var t=0;t<e.length;t++){var r=e[t],n=r.parent;if(n)for(var i=0;i<4;i++){var a=n.children[i];if(a&&a!==r&&a.loadable)return!0}}return!1}function v(e,t){if(!e||!t||e[0]===t[0])return!1;var r=e[0]<t[0],n=r?e:t,i=r?t:e,a=1<<i[0]-n[0];return Math.floor(i[1]/a)===n[1]&&Math.floor(i[2]/a)===n[2]}},function(e,t,r){"use strict";r.d(t,"a",(function(){return O})),r.d(t,"b",(function(){return j}));var n=r(2),i=r(5),a=r(6),o=r(7),s=r(49),c=(r(17),r(15)),l=r(20),u=r(3),d=r(9),h=r(43),f=r(65),p=r(154),b=r(233),v=r(105),m=r(396),y=r(285),g=c.a.getLogger("esri.views.3d.layers.graphics.Graphics3DSymbolLayer"),O=function(e){Object(a.a)(r,e);var t=Object(o.a)(r);function r(e,i,a,o){var s;return Object(n.a)(this,r),(s=t.call(this,a.schedule))._context=a,s._elevationInfoOverride=null,s.complexity=null,s.logger=g,s._elevationOptions={supportsOffsetAdjustment:!1,supportsOnTheGround:!0},s.symbol=e,s.symbolLayer=i,s._renderPriority=o.renderPriority,s._renderPriorityStep=o.renderPriorityStep,s._elevationContext=new p.a,s.complexity=s.computeComplexity(),s._updateDrivenProperties(o.ignoreDrivers),s._updateElevationContext(),s}return Object(i.a)(r,[{key:"getCachedSize",value:function(){return null}},{key:"extentPadding",get:function(){return 0}},{key:"needsDrivenTransparentPass",get:function(){return this._drivenProperties.opacity&&!this._drivenProperties.opacityAlwaysOpaque}},{key:"_logGeometryCreationWarnings",value:function(e,t,r,n){var i=e.projectionSuccess,a="polygons"in e?e.polygons:null,o="".concat(n," geometry failed to be created"),s=null;i?!t.length||1===t.length&&!t[0].length?s="".concat(o," (no ").concat(r," were defined)"):Array.isArray(t)&&Array.isArray(t[0])?a&&0===a.length&&"rings"===r&&t.length>0&&t[0].length>2&&(s="".concat(o," (filled rings should use clockwise winding - try reversing the order of vertices)")):s="".concat(o," (").concat(r," should be defined as a 2D array)"):s="".concat(o," (failed to project geometry to view spatial reference)"),s&&g.warnOncePerTick(s)}},{key:"_validateGeometry",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(Object(u.j)(t)&&!t.includes(e.type))return this.logger.warn("unsupported geometry type for "+r+" symbol: ".concat(e.type)),!1;if("point"===e.type){var n=e;if(!Object(l.j)(n.x)||!Object(l.j)(n.y))return g.warn("point coordinate is not a valid number, graphic skipped"),!1}return!0}},{key:"_defaultElevationInfoNoZ",value:function(){return _}},{key:"_defaultElevationInfoZ",value:function(){return w}},{key:"_updateElevationContext",value:function(){Object(u.j)(this._elevationInfoOverride)?(this._elevationContext.setFromElevationInfo(this._elevationInfoOverride),this._elevationContext.updateFeatureExpressionInfoContext(null)):this._context.layer.elevationInfo?(this._elevationContext.setFromElevationInfo(this._context.layer.elevationInfo),this._elevationContext.updateFeatureExpressionInfoContext(this._context.featureExpressionInfoContext)):this._elevationContext.reset()}},{key:"getDefaultElevationInfo",value:function(e){return e.hasZ?this._defaultElevationInfoZ():this._defaultElevationInfoNoZ()}},{key:"getGeometryElevationMode",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.getDefaultElevationInfo(e);return this._elevationContext.mode||t.mode}},{key:"setElevationInfoOverride",value:function(e){this._elevationInfoOverride=e,this._updateElevationContext()}},{key:"setGraphicElevationContext",value:function(e,t){var r=Object(u.s)(e.geometry),n=this.getDefaultElevationInfo(r);t.unit=null!=this._elevationContext.unit?this._elevationContext.unit:n.unit,t.mode=this.getGeometryElevationMode(r,n),t.offsetMeters=Object(u.t)(this._elevationContext.meterUnitOffset,Object(u.t)(n.offset,0));var i=!this._elevationOptions.supportsOnTheGround&&"on-the-ground"===t.mode;i&&(t.mode="relative-to-ground",t.offsetMeters=0);var a=i?b.h:this._elevationContext.featureExpressionInfoContext;return t.updateFeatureExpressionInfoContext(a,e,this._context.layer),t}},{key:"prepareSymbolLayerPatch",value:function(e){}},{key:"updateGeometry",value:function(e,t){return!1}},{key:"onRemoveGraphic",value:function(e){}},{key:"_updateDrivenProperties",value:function(e){var t={color:!1,opacity:!1,opacityAlwaysOpaque:!0,size:!1};if(e)this._drivenProperties=t;else{var r=this._context.renderer;r&&"visualVariables"in r&&r.visualVariables&&r.visualVariables.forEach((function(e){switch(e.type){case"color":if(t.color=!0,e.stops)for(var r=0;r<e.stops.length;r++){var n=e.stops[r].color;n&&(t.opacity=!0,n.a<1&&(t.opacityAlwaysOpaque=!1))}break;case"opacity":t.opacity=!0,t.opacityAlwaysOpaque=!1;break;case"size":t.size=!0}})),this._drivenProperties=t}}},{key:"_getLayerOpacity",value:function(){if(this._context.layerView&&"fullOpacity"in this._context.layerView)return this._context.layerView.fullOpacity;var e=this._context.layer.opacity;return null==e?1:e}},{key:"_getCombinedOpacity",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:x,r=1;return this.draped||(r*=this._getLayerOpacity()),this._drivenProperties.opacity||(Object(u.j)(e)?r*=e.a:t.hasIntrinsicColor||(r=0)),r}},{key:"_getCombinedOpacityAndColor",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:x,r=this._getCombinedOpacity(e,t);if(this._drivenProperties.color)return Object(v.g)(null,r);var n=Object(u.j)(e)?s.a.toUnitRGB(e):d.a;return Object(v.g)(n,r)}},{key:"_getVertexOpacityAndColor",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=this._drivenProperties.color?e.color:null,n=this._drivenProperties.opacity?e.opacity:null,i=Object(v.g)(r,n);return Object(u.j)(t)&&(i[0]*=t,i[1]*=t,i[2]*=t,i[3]*=t),i}},{key:"isFastUpdatesEnabled",value:function(){return this._fastUpdates&&this._fastUpdates.enabled}},{key:"computeComplexity",value:function(){return Object(y.c)(this.symbol,this.symbolLayer)}},{key:"destroy",value:function(){this.abortLoad()}},{key:"globalPropertyChanged",value:function(e,t,r){switch(e){case"opacity":return this.layerOpacityChanged(t,r);case"elevationInfo":var n=this._elevationContext.mode;return this._updateElevationContext(),this.layerElevationInfoChanged(t,r,n)!==f.a.RECREATE;case"slicePlaneEnabled":return this.slicePlaneEnabledChanged(t,r);case"physicalBasedRenderingEnabled":return this.physicalBasedRenderingChanged();case"pixelRatio":return this.pixelRatioChanged();default:return!1}}},{key:"updateGraphics3DGraphicElevationInfo",value:function(e,t,r){var n=this,i=f.a.UPDATE;return e.forEach((function(e){var a=t(e);if(Object(u.j)(a)){var o=e.graphic;n.setGraphicElevationContext(o,a.elevationContext),a.needsElevationUpdates=r(a.elevationContext.mode)}else i=f.a.RECREATE})),i}},{key:"applyRendererDiff",value:function(e,t){return!1}},{key:"getFastUpdateAttrValues",value:function(e){if(!this._fastUpdates.enabled)return null;var t=this._fastUpdates.visualVariables,r=t.size?j(t.size.field,e):0,n=t.color?j(t.color.field,e):0,i=t.opacity?j(t.opacity.field,e):0;return Object(h.g)(r,n,i,0)}},{key:"draped",get:function(){return this._draped}},{key:"ensureDrapedStatus",value:function(e){return null==this._draped?(this._draped=e,!0):(e!==this.draped&&g.warnOnce("A symbol can only produce either draped or non-draped visualizations. Use two separate symbol instances for draped and non-draped graphics if necessary."),!1)}}]),r}(m.a);function j(e,t){var r=null!=e?t.attributes[e]:0;return null!=r&&isFinite(r)?r:0}var _={mode:"on-the-ground",offset:0,unit:"meters"},w={mode:"absolute-height",offset:0,unit:"meters"},x={hasIntrinsicColor:!1}},function(e,t,r){"use strict";r.d(t,"a",(function(){return _})),r.d(t,"b",(function(){return j})),r.d(t,"c",(function(){return x})),r.d(t,"d",(function(){return M}));var n=r(5),i=r(2),a=r(3),o=r(310),s=r(269),c=r(74),l=r(23),u=r(75),d=function e(t){Object(i.a)(this,e),this.phases=t,this.paused=!1,this.ticks=-1,this.removed=!1},h=function(){function e(t){Object(i.a)(this,e),this.callback=t,this.isActive=!0}return Object(n.a)(e,[{key:"remove",value:function(){this.isActive=!1}}]),e}(),f=0,p=0,b={time:Object(u.a)(0),deltaTime:Object(u.a)(0),elapsedFrameTime:Object(u.a)(0),frameDuration:Object(u.a)(0)},v=["prepare","preRender","render","postRender","update"],m=[],y=new c.a,g=function(){function e(t){Object(i.a)(this,e),this._task=t}return Object(n.a)(e,[{key:"remove",value:function(){this._task.removed=!0}},{key:"pause",value:function(){this._task.paused=!0}},{key:"resume",value:function(){this._task.paused=!1}}]),e}(),O={frameTasks:y,willDispatch:!1,clearFrameTasks:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];y.forAll((function(e){e.removed=!0})),e&&T()},dispatch:C,executeFrameTasks:function(e){var t=Object(u.a)(e-f);f=e;for(var r=p>0?p:1e3/60,n=Math.max(0,t-r),i=function(i){var a=performance.now(),o=v[i];y.forAll((function(a){var s;a.paused||a.removed||(0===i&&a.ticks++,a.phases[o]&&(b.time=e,b.deltaTime=0===a.ticks?Object(u.a)(0):t,b.elapsedFrameTime=Object(u.a)(performance.now()-e),b.frameDuration=Object(u.a)(r-n),null==(s=a.phases[o])||s.call(a,b)))})),P[i].record(performance.now()-a)},a=0;a<v.length;a++)i(a);T(),A.record(performance.now()-e)}};function j(e){var t=new h(e);return m.push(t),O.willDispatch||(O.willDispatch=!0,Object(o.a)(C)),t}function _(e){var t=new d(e);return y.push(t),null==w&&(f=performance.now(),w=requestAnimationFrame(k)),new g(t)}var w=null;function x(e){p=Math.max(0,e)}function k(){var e=performance.now();w=null,w=y.length>0?requestAnimationFrame(k):null,O.executeFrameTasks(e)}var S=new c.a;function T(){y.forAll((function(e){e.removed&&S.push(e)})),y.removeUnorderedMany(S.data,S.length),S.clear()}function C(){for(;m.length;){var e=Object(a.d)(m.shift());e.isActive&&e.callback()}O.willDispatch=!1}function M(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1?arguments[1]:void 0,r=Object(l.h)(),n=function n(){Object(l.o)(t)?r.reject(Object(l.f)()):0===e?r():(--e,Object(o.a)((function(){return n()})))};return n(),r.promise}var P=v.map((function(e){return new s.a(e)})),A=new s.a("total")},function(e,t,r){"use strict";function n(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=e.stride;return e.fieldNames.filter((function(t){var r=e.fields.get(t).optional;return!(r&&r.glPadding)})).map((function(n){var a=e.fields.get(n),o=a.constructor.ElementCount,s=i(a.constructor.ElementType),c=a.offset,l=!(!a.optional||!a.optional.glNormalized);return{name:n,stride:r,count:o,type:s,offset:c,normalized:l,divisor:t}}))}function i(e){var t=a[e];if(t)return t;throw new Error("BufferType not supported in WebGL")}r.d(t,"a",(function(){return n}));var a={u8:5121,u16:5123,u32:5125,i8:5120,i16:5122,i32:5124,f32:5126}},function(e,t,r){"use strict";function n(e){return function(t,r){t.hasOwnProperty("_messageBundleProps")||(t._messageBundleProps=t._messageBundleProps?t._messageBundleProps.slice():[]),t._messageBundleProps.push({bundlePath:e,propertyName:r})}}r.d(t,"a",(function(){return n}))},function(e,t,r){"use strict";r.d(t,"a",(function(){return v}));var n=r(13),i=r(2),a=r(5),o=(r(17),r(3)),s=r(31),c=r(4),l=r(9),u=r(79),d=function e(){Object(i.a)(this,e),this.verticalOffset=0,this.selectionMode=!1,this.hud=!0,this.selectOpaqueTerrainOnly=!0,this.invisibleTerrain=!1,this.backfacesTerrain=!0,this.isFiltered=!1,this.store=2},h=r(243),f=r(183),p=r(136),b=1e-5,v=function(){function e(t){Object(i.a)(this,e),this.options=new d,this.results=new h.b,this.transform=new f.a,this.performanceInfo={queryDuration:0,numObjectsTested:0},this.tolerance=b,this.verticalOffset=null,this._ray={origin:Object(l.e)(),direction:Object(l.e)()},this._rayEndPoint=Object(l.e)(),this._rayStartPointTransformed=Object(l.e)(),this._rayEndPointTransformed=Object(l.e)(),this.viewingMode=null==t?1:t}return Object(a.a)(e,[{key:"ray",get:function(){return this._ray}},{key:"rayBeginPoint",get:function(){return this._ray.origin}},{key:"rayEndPoint",get:function(){return this._rayEndPoint}},{key:"reset",value:function(e,t){this.resetWithRay(Object(u.e)(e,t,this._ray))}},{key:"resetWithRay",value:function(e){e!==this._ray&&Object(u.b)(e,this._ray),0!==this.options.verticalOffset?2===this.viewingMode?this._ray.origin[2]-=this.options.verticalOffset:this.verticalOffset=this.options.verticalOffset:this.verticalOffset=null,Object(c.h)(this._rayEndPoint,this._ray.origin,this._ray.direction),this._numObjectsTested=0,this.results.init(this._ray)}},{key:"intersect",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,r=arguments.length>1?arguments[1]:void 0,i=arguments.length>2?arguments[2]:void 0,a=arguments.length>3?arguments[3]:void 0,s=arguments.length>4?arguments[4]:void 0,c=arguments.length>5?arguments[5]:void 0;this.point=r,this.camera=i,this.filterPredicate=s,this.tolerance=null==a?b:a;var l=Object(f.d)(this.verticalOffset);Object(o.j)(t)&&t.length>0&&function(){var r,i=c?function(t){c(t)&&e.intersectObject(t)}:function(t){e.intersectObject(t)},a=Object(n.a)(t);try{for(a.s();!(r=a.n()).done;){var s=r.value,u=s.getSpatialQueryAccelerator&&s.getSpatialQueryAccelerator();Object(o.j)(u)?(Object(o.j)(l)?u.forEachAlongRayWithVerticalOffset(e._ray.origin,e._ray.direction,i,l):u.forEachAlongRay(e._ray.origin,e._ray.direction,i),e.options.selectionMode&&e.options.hud&&u.forEachDegenerateObject(i)):s.objects.forAll((function(e){return i(e)}))}}catch(d){a.e(d)}finally{a.f()}}(),this.sortResults()}},{key:"intersectObject",value:function(e){var t=this;this._numObjectsTested++;var r=e.geometryRecords;if(r){var i,a,l=e.id,u=e.transformation,d=Object(f.d)(this.verticalOffset),b=Object(n.a)(r);try{var v=function(){var r=a.value,n=r.geometry,f=r.material,b=r.instanceParameters;if(Object(p.e)(b))return"continue";i=n.id,t.transform.setAndInvalidateLazyTransforms(u,r.getShaderTransformation()),Object(c.s)(t._rayStartPointTransformed,t._ray.origin,t.transform.inverse),Object(c.s)(t._rayEndPointTransformed,t._rayEndPoint,t.transform.inverse);var v=t.transform.transform;Object(o.j)(d)&&(d.objectTransform=t.transform),f.intersect(n,b,t.transform.transform,t,t._rayStartPointTransformed,t._rayEndPointTransformed,(function(r,n,a,c,u,d){if(r>=0){if(Object(o.j)(t.filterPredicate)&&!t.filterPredicate(t._ray.origin,t._rayEndPoint,r))return;var f="Object3D ".concat(l);if(u)return void((null==t.results.hud.dist||r<t.results.hud.dist)&&t.results.hud.set(e,f,r,n,s.a,c,d,i,a));var p=function(t){return t.set(e,f,r,n,v,c,null,i,a)};if((null==t.results.min.drapedLayerOrder||c>=t.results.min.drapedLayerOrder)&&(null==t.results.min.dist||r<t.results.min.dist)&&p(t.results.min),0!==t.options.store&&(null==t.results.max.drapedLayerOrder||c<t.results.max.drapedLayerOrder)&&(null==t.results.max.dist||r>t.results.max.dist)&&p(t.results.max),2===t.options.store){var b=new h.a(t._ray);p(b),t.results.all.push(b)}}}),r.shaderTransformation)};for(b.s();!(a=b.n()).done;)v()}catch(m){b.e(m)}finally{b.f()}}}},{key:"sortResults",value:function(){this.results.all.sort((function(e,t){return e.dist!==t.dist?e.dist-t.dist:e.drapedLayerOrder!==t.drapedLayerOrder?(void 0!==e.drapedLayerOrder?e.drapedLayerOrder:Number.MAX_VALUE)-(void 0!==t.drapedLayerOrder?t.drapedLayerOrder:Number.MAX_VALUE):(void 0!==t.drapedLayerGraphicOrder?t.drapedLayerGraphicOrder:Number.MIN_VALUE)-(void 0!==e.drapedLayerGraphicOrder?e.drapedLayerGraphicOrder:Number.MIN_VALUE)}))}}]),e}();v.DEFAULT_TOLERANCE=b},function(e,t,r){"use strict";r.d(t,"a",(function(){return f}));var n,i,a=r(2),o=r(12),s=r(96),c=r(31),l=r(9),u=r(319),d=r(228),h=r(11);function f(e,t){e.include(u.a),e.vertex.include(d.a,t),e.varyings.add("vPositionWorldCameraRelative","vec3"),e.varyings.add("vPosition_view","vec3"),e.vertex.uniforms.add("uTransform_WorldFromModel_RS","mat3"),e.vertex.uniforms.add("uTransform_WorldFromModel_TH","vec3"),e.vertex.uniforms.add("uTransform_WorldFromModel_TL","vec3"),e.vertex.uniforms.add("uTransform_WorldFromView_TH","vec3"),e.vertex.uniforms.add("uTransform_WorldFromView_TL","vec3"),e.vertex.uniforms.add("uTransform_ViewFromCameraRelative_RS","mat3"),e.vertex.uniforms.add("uTransform_ProjFromView","mat4"),e.vertex.code.add(Object(h.a)(n||(n=Object(o.a)(["vec3 positionWorldCameraRelative() {\nvec3 rotatedModelPosition = uTransform_WorldFromModel_RS * positionModel();\nvec3 transform_CameraRelativeFromModel = dpAdd(\nuTransform_WorldFromModel_TL,\nuTransform_WorldFromModel_TH,\n-uTransform_WorldFromView_TL,\n-uTransform_WorldFromView_TH\n);\nreturn transform_CameraRelativeFromModel + rotatedModelPosition;\n}\nvec3 position_view() {\nreturn uTransform_ViewFromCameraRelative_RS * positionWorldCameraRelative();\n}\nvoid forwardPosition() {\nvPositionWorldCameraRelative = positionWorldCameraRelative();\nvPosition_view = position_view();\ngl_Position = uTransform_ProjFromView * vec4(vPosition_view, 1.0);\n}\nvec3 positionWorld() {\nreturn uTransform_WorldFromView_TL + vPositionWorldCameraRelative;\n}"])))),e.fragment.uniforms.add("uTransform_WorldFromView_TL","vec3"),e.fragment.code.add(Object(h.a)(i||(i=Object(o.a)(["vec3 positionWorld() {\nreturn uTransform_WorldFromView_TL + vPositionWorldCameraRelative;\n}"]))))}!function(e){e.ModelTransform=function e(){Object(a.a)(this,e),this.worldFromModel_RS=Object(s.b)(),this.worldFromModel_TH=Object(l.e)(),this.worldFromModel_TL=Object(l.e)()};e.ViewProjectionTransform=function e(){Object(a.a)(this,e),this.worldFromView_TH=Object(l.e)(),this.worldFromView_TL=Object(l.e)(),this.viewFromCameraRelative_RS=Object(s.b)(),this.projFromView=Object(c.d)()},e.bindModelTransform=function(e,t){e.setUniformMatrix3fv("uTransform_WorldFromModel_RS",t.worldFromModel_RS),e.setUniform3fv("uTransform_WorldFromModel_TH",t.worldFromModel_TH),e.setUniform3fv("uTransform_WorldFromModel_TL",t.worldFromModel_TL)},e.bindViewProjTransform=function(e,t){e.setUniform3fv("uTransform_WorldFromView_TH",t.worldFromView_TH),e.setUniform3fv("uTransform_WorldFromView_TL",t.worldFromView_TL),e.setUniformMatrix4fv("uTransform_ProjFromView",t.projFromView),e.setUniformMatrix3fv("uTransform_ViewFromCameraRelative_RS",t.viewFromCameraRelative_RS)}}(f||(f={}))},function(e,t,r){"use strict";r.d(t,"a",(function(){return a})),r.d(t,"b",(function(){return s})),r.d(t,"c",(function(){return o}));var n=r(14),i=r(39);function a(e,t){return t?Object(n.a)(Object(n.a)({},t),{},{query:Object(n.a)(Object(n.a)({},e),t.query)}):{query:e}}function o(e){return"string"==typeof e?Object(i.K)(e):e}function s(e,t,r){var n={};for(var i in e)if("declaredClass"!==i){var a=e[i];if(null!=a&&"function"!=typeof a)if(Array.isArray(a)){n[i]=[];for(var o=0;o<a.length;o++)n[i][o]=s(a[o])}else if("object"==typeof a)if(a.toJSON){var c=a.toJSON(r&&r[i]);n[i]=t?c:JSON.stringify(c)}else n[i]=t?a:JSON.stringify(a);else n[i]=a}return n}},function(e,t,r){"use strict";r.d(t,"a",(function(){return s})),r.d(t,"b",(function(){return c})),r.d(t,"c",(function(){return o})),r.d(t,"d",(function(){return l}));var n=r(113),i=/\{([^\}]+)\}/g;function a(e){return null==e?"":e}function o(e,t){return e.replace(i,"object"==typeof t?function(e,r){return a(Object(n.b)(r,t))}:function(e,r){return a(t(r))})}function s(e,t){return e.replace(/([\.$?*|{}\(\)\[\]\\\/\+\-^])/g,(function(e){return t&&-1!==t.indexOf(e)?e:"\\".concat(e)}))}function c(e){for(var t=0,r=0;r<e.length;r++)t=(t<<5)-t+e.charCodeAt(r),t|=0;return t}function l(e){return(new DOMParser).parseFromString(e||"","text/html").body.innerText||""}},function(e,t,r){"use strict";r.d(t,"a",(function(){return s})),r.d(t,"b",(function(){return c})),r.d(t,"c",(function(){return u})),r.d(t,"d",(function(){return l}));var n,i=r(12),a=r(194),o=r(11);function s(e){e.fragment.include(a.a),e.fragment.uniforms.add("uShadowMapTex","sampler2D"),e.fragment.uniforms.add("uShadowMapNum","int"),e.fragment.uniforms.add("uShadowMapDistance","vec4"),e.fragment.uniforms.add("uShadowMapMatrix","mat4",4),e.fragment.uniforms.add("uDepthHalfPixelSz","float"),e.fragment.code.add(Object(o.a)(n||(n=Object(i.a)(["int chooseCascade(float _linearDepth, out mat4 mat) {\nvec4 distance = uShadowMapDistance;\nfloat depth = _linearDepth;\nint i = depth < distance[1] ? 0 : depth < distance[2] ? 1 : depth < distance[3] ? 2 : 3;\nmat = i == 0 ? uShadowMapMatrix[0] : i == 1 ? uShadowMapMatrix[1] : i == 2 ? uShadowMapMatrix[2] : uShadowMapMatrix[3];\nreturn i;\n}\nvec3 lightSpacePosition(vec3 _vpos, mat4 mat) {\nvec4 lv = mat * vec4(_vpos, 1.0);\nlv.xy /= lv.w;\nreturn 0.5 * lv.xyz + vec3(0.5);\n}\nvec2 cascadeCoordinates(int i, vec3 lvpos) {\nreturn vec2(float(i - 2 * (i / 2)) * 0.5, float(i / 2) * 0.5) + 0.5 * lvpos.xy;\n}\nfloat readShadowMapDepth(vec2 uv, sampler2D _depthTex) {\nreturn rgba2float(texture2D(_depthTex, uv));\n}\nfloat posIsInShadow(vec2 uv, vec3 lvpos, sampler2D _depthTex) {\nreturn readShadowMapDepth(uv, _depthTex) < lvpos.z ? 1.0 : 0.0;\n}\nfloat filterShadow(vec2 uv, vec3 lvpos, float halfPixelSize, sampler2D _depthTex) {\nfloat texSize = 0.5 / halfPixelSize;\nvec2 st = fract((vec2(halfPixelSize) + uv) * texSize);\nfloat s00 = posIsInShadow(uv + vec2(-halfPixelSize, -halfPixelSize), lvpos, _depthTex);\nfloat s10 = posIsInShadow(uv + vec2(halfPixelSize, -halfPixelSize), lvpos, _depthTex);\nfloat s11 = posIsInShadow(uv + vec2(halfPixelSize, halfPixelSize), lvpos, _depthTex);\nfloat s01 = posIsInShadow(uv + vec2(-halfPixelSize, halfPixelSize), lvpos, _depthTex);\nreturn mix(mix(s00, s10, st.x), mix(s01, s11, st.x), st.y);\n}\nfloat readShadowMap(const in vec3 _vpos, float _linearDepth) {\nmat4 mat;\nint i = chooseCascade(_linearDepth, mat);\nif (i >= uShadowMapNum) { return 0.0; }\nvec3 lvpos = lightSpacePosition(_vpos, mat);\nif (lvpos.z >= 1.0) { return 0.0; }\nif (lvpos.x < 0.0 || lvpos.x > 1.0 || lvpos.y < 0.0 || lvpos.y > 1.0) { return 0.0; }\nvec2 uv = cascadeCoordinates(i, lvpos);\nreturn filterShadow(uv, lvpos, uDepthHalfPixelSz, uShadowMapTex);\n}"]))))}function c(e,t){t.shadowMappingEnabled&&(t.shadowMap.bind(e),t.shadowMap.bindView(e,t.origin))}function l(e,t,r){t.shadowMappingEnabled&&t.shadowMap.bindView(e,r)}function u(e,t){t.shadowMappingEnabled&&t.shadowMap.bindView(e,t.origin)}},function(e,t,r){"use strict";var n=r(14),i=r(8),a=r.n(i),o=r(16),s=r(13),c=r(2),l=r(5),u=r(6),d=r(7),h=r(0),f=r(123),p=(r(343),r(129)),b=r(99),v=r(22),m=r(27),y=r(180),g=r(3),O=r(23),j=r(1),_=(r(17),r(18)),w=(r(15),r(48)),x=r(10),k=r(66),S=r(250),T=function(e){Object(u.a)(r,e);var t=Object(d.a)(r);function r(e){var n;return Object(c.a)(this,r),(n=t.call(this,e)).nextQueryParams=null,n.queryParams=null,n.results=null,n.total=null,n}return r}(r(30).a);Object(h.a)([Object(j.b)()],T.prototype,"nextQueryParams",void 0),Object(h.a)([Object(j.b)()],T.prototype,"queryParams",void 0),Object(h.a)([Object(j.b)()],T.prototype,"results",void 0),Object(h.a)([Object(j.b)()],T.prototype,"total",void 0);var C,M,P=T=Object(h.a)([Object(x.a)("esri.portal.PortalQueryResult")],T),A=r(541),E=r(138),R={PortalGroup:function(){return Promise.resolve().then(r.bind(null,566))},PortalItem:function(){return Promise.resolve().then(r.bind(null,418))},PortalUser:function(){return Promise.resolve().then(r.bind(null,541))}},I=C=function(e){Object(u.a)(i,e);var t=Object(d.a)(i);function i(e){var r;return Object(c.a)(this,i),(r=t.call(this,e)).access=null,r.allSSL=!1,r.authMode="auto",r.authorizedCrossOriginDomains=null,r.basemapGalleryGroupQuery=null,r.bingKey=null,r.canListApps=!1,r.canListData=!1,r.canListPreProvisionedItems=!1,r.canProvisionDirectPurchase=!1,r.canSearchPublic=!0,r.canShareBingPublic=!1,r.canSharePublic=!1,r.canSignInArcGIS=!1,r.canSignInIDP=!1,r.colorSetsGroupQuery=null,r.commentsEnabled=!1,r.created=null,r.culture=null,r.customBaseUrl=null,r.defaultBasemap=null,r.defaultExtent=null,r.defaultVectorBasemap=null,r.description=null,r.eueiEnabled=null,r.featuredGroups=null,r.featuredItemsGroupQuery=null,r.galleryTemplatesGroupQuery=null,r.livingAtlasGroupQuery=null,r.hasCategorySchema=!1,r.helperServices=null,r.homePageFeaturedContent=null,r.homePageFeaturedContentCount=null,r.httpPort=null,r.httpsPort=null,r.id=null,r.ipCntryCode=null,r.isPortal=!1,r.isReadOnly=!1,r.layerTemplatesGroupQuery=null,r.maxTokenExpirationMinutes=null,r.modified=null,r.name=null,r.portalHostname=null,r.portalMode=null,r.portalProperties=null,r.region=null,r.rotatorPanels=null,r.showHomePageDescription=!1,r.sourceJSON=null,r.supportsHostedServices=!1,r.symbolSetsGroupQuery=null,r.templatesGroupQuery=null,r.units=null,r.url=f.a.portalUrl,r.urlKey=null,r.user=null,r.useStandardizedQuery=!1,r.useVectorBasemaps=!1,r.vectorBasemapGalleryGroupQuery=null,r}return Object(l.a)(i,[{key:"normalizeCtorArgs",value:function(e){return"string"==typeof e?{url:e}:e}},{key:"destroy",value:function(){this._esriId_credentialCreateHandle&&(this._esriId_credentialCreateHandle.remove(),this._esriId_credentialCreateHandle=null)}},{key:"readAuthorizedCrossOriginDomains",value:function(e){if(e){var t,r=Object(s.a)(e);try{for(r.s();!(t=r.n()).done;){var n=t.value;-1===f.a.request.trustedServers.indexOf(n)&&f.a.request.trustedServers.push(n)}}catch(i){r.e(i)}finally{r.f()}}return e}},{key:"readDefaultBasemap",value:function(e){if(e){var t=M.fromJSON(e);return t.portalItem={portal:this},t}return null}},{key:"readDefaultVectorBasemap",value:function(e){if(e){var t=M.fromJSON(e);return t.portalItem={portal:this},t}return null}},{key:"extraQuery",get:function(){var e=!(this.user&&this.user.orgId)||this.canSearchPublic;return this.id&&!e?" AND orgid:".concat(this.id):null}},{key:"isOrganization",get:function(){return!!this.access}},{key:"restUrl",get:function(){var e=this.url;if(e){var t=e.indexOf("/sharing");e=t>0?e.substring(0,t):this.url.replace(/\/+$/,""),e+="/sharing/rest"}return e}},{key:"thumbnailUrl",get:function(){var e=this.restUrl,t=this.thumbnail;return e&&t?this._normalizeSSL(e+"/portals/self/resources/"+t):null}},{key:"readUrlKey",value:function(e){return e?e.toLowerCase():e}},{key:"readUser",value:function(e){var t=null;return e&&((t=A.default.fromJSON(e)).portal=this),t}},{key:"load",value:function(e){var t=this,n=Promise.resolve().then(r.bind(null,402)).then((function(t){var r=t.default;Object(O.x)(e),M=r})).then((function(){return t.sourceJSON?t.sourceJSON:t._fetchSelf(t.authMode,!1,e)})).then((function(e){if(p.b){var r=p.b;t.credential=r.findCredential(t.restUrl),t.credential||t.authMode!==C.AUTH_MODE_AUTO||(t._esriId_credentialCreateHandle=r.on("credential-create",(function(){r.findCredential(t.restUrl)&&t._signIn()})))}t.sourceJSON=e,t.read(e)}));return this.addResolvingPromise(n),Promise.resolve(this)}},{key:"createClosestFacilityTask",value:function(){var e=Object(o.a)(a.a.mark((function e(){var t;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.load();case 2:return t=this._getHelperServiceUrl("closestFacility"),e.next=6,Promise.all([r.e(16),r.e(173)]).then(r.bind(null,1181));case 6:return e.t0=e.sent.default,e.t1=t,e.abrupt("return",new e.t0(e.t1));case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"createElevationLayers",value:function(){var e=Object(o.a)(a.a.mark((function e(){var t,n;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.load();case 2:return t=this._getHelperService("defaultElevationLayers"),e.next=5,r.e(30).then(r.bind(null,917));case 5:return n=e.sent.default,e.abrupt("return",t?t.map((function(e){return new n({id:e.id,url:e.url})})):[]);case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"createGeometryService",value:function(){var e=Object(o.a)(a.a.mark((function e(){var t;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.load();case 2:return t=this._getHelperServiceUrl("geometry"),e.next=6,r.e(20).then(r.bind(null,684));case 6:return e.t0=e.sent.default,e.t1={url:t},e.abrupt("return",new e.t0(e.t1));case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"createPrintTask",value:function(){var e=Object(o.a)(a.a.mark((function e(){var t;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.load();case 2:return t=this._getHelperServiceUrl("printTask"),e.next=6,r.e(141).then(r.bind(null,1168));case 6:return e.t0=e.sent.default,e.t1=t,e.abrupt("return",new e.t0(e.t1));case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"createRouteTask",value:function(){var e=Object(o.a)(a.a.mark((function e(){var t;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.load();case 2:return t=this._getHelperServiceUrl("route"),e.next=6,Promise.all([r.e(16),r.e(174)]).then(r.bind(null,1191));case 6:return e.t0=e.sent.default,e.t1=t,e.abrupt("return",new e.t0(e.t1));case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"createServiceAreaTask",value:function(){var e=Object(o.a)(a.a.mark((function e(){var t;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.load();case 2:return t=this._getHelperServiceUrl("serviceArea"),e.next=6,Promise.all([r.e(16),r.e(175)]).then(r.bind(null,1182));case 6:return e.t0=e.sent.default,e.t1=t,e.abrupt("return",new e.t0(e.t1));case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"fetchBasemaps",value:function(e,t){var r=new S.a;return r.query=e||(this.useVectorBasemaps?this.vectorBasemapGalleryGroupQuery:this.basemapGalleryGroupQuery),r.disableExtraQuery=!0,this.queryGroups(r,t).then((function(e){if(r.num=100,r.query='type:"Web Map" -type:"Web Application"',e.total){var n=e.results[0];return r.sortField=n.sortField||"name",r.sortOrder=n.sortOrder||"desc",n.queryItems(r,t)}return null})).then((function(e){return e&&e.total?e.results.filter((function(e){return"Web Map"===e.type})).map((function(e){return new M({portalItem:e})})):[]}))}},{key:"fetchCategorySchema",value:function(e){return this.hasCategorySchema?this._request(this.restUrl+"/portals/self/categorySchema",e).then((function(e){return e.categorySchema})):Object(O.o)(e)?Promise.reject(Object(O.f)()):Promise.resolve([])}},{key:"fetchFeaturedGroups",value:function(e){var t=this.featuredGroups,r=new S.a;if(r.num=100,r.sortField="title",t&&t.length){var n,i=[],a=Object(s.a)(t);try{for(a.s();!(n=a.n()).done;){var o=n.value;i.push('(title:"'.concat(o.title,'" AND owner:').concat(o.owner,")"))}}catch(c){a.e(c)}finally{a.f()}return r.query=i.join(" OR "),this.queryGroups(r,e).then((function(e){return e.results}))}return Object(O.o)(e)?Promise.reject(Object(O.f)()):Promise.resolve([])}},{key:"fetchRegions",value:function(e){var t=this.user&&this.user.culture||this.culture||Object(E.b)();return this._request(this.restUrl+"/portals/regions",Object(n.a)(Object(n.a)({},e),{},{query:{culture:t}}))}},{key:"queryGroups",value:function(e,t){return this._queryPortal("/community/groups",e,"PortalGroup",t)}},{key:"queryItems",value:function(e,t){return this._queryPortal("/search",e,"PortalItem",t)}},{key:"queryUsers",value:function(e,t){return e.sortField||(e.sortField="username"),this._queryPortal("/community/users",e,"PortalUser",t)}},{key:"toJSON",value:function(){throw new v.a("internal:not-yet-implemented","Portal.toJSON is not yet implemented")}},{key:"_getHelperService",value:function(e){var t=this.helperServices&&this.helperServices[e];if(!t)throw new v.a("portal:service-not-found",'The `helperServices` do not include an entry named "'.concat(e,'"'));return t}},{key:"_getHelperServiceUrl",value:function(e){var t=this._getHelperService(e);if(!t.url)throw new v.a("portal:service-url-not-found",'The `helperServices` entry "'.concat(e,'" does not include a `url` value'));return t.url}},{key:"_fetchSelf",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.authMode,t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2?arguments[2]:void 0,i=this.restUrl+"/portals/self",a=Object(n.a)({authMode:e,query:{culture:Object(E.b)().toLowerCase()}},r);return"auto"===a.authMode&&(a.authMode="no-prompt"),t&&(a.query.default=!0),this._request(i,a)}},{key:"_queryPortal",value:function(e,t,r,i){var a=this,o=Object(_.m)(S.a,t),s=function(t){return a._request(a.restUrl+e,Object(n.a)(Object(n.a)({},o.toRequestOptions(a)),i)).then((function(e){var r=o.clone();return r.start=e.nextStart,new P({nextQueryParams:r,queryParams:o,total:e.total,results:C._resultsToTypedArray(t,{portal:a},e,i)})})).then((function(e){return Promise.all(e.results.map((function(t){return"function"==typeof t.when?t.when():e}))).then((function(){return e}),(function(t){return Object(O.w)(t),e}))}))};return r&&R[r]?R[r]().then((function(e){var t=e.default;return Object(O.x)(i),s(t)})):s()}},{key:"_signIn",value:function(){var e=this;if(this.authMode===C.AUTH_MODE_ANONYMOUS)return Promise.reject(new v.a("portal:invalid-auth-mode",'Current "authMode"\' is "'.concat(this.authMode,'"')));if("failed"===this.loadStatus)return Promise.reject(this.loadError);var t=function(t){return Promise.resolve().then((function(){return"not-loaded"===e.loadStatus?(t||(e.authMode="immediate"),e.load().then((function(){return null}))):"loading"===e.loadStatus?e.load().then((function(){return e.credential?null:(e.credential=t,e._fetchSelf("immediate"))})):e.user&&e.credential===t?null:(e.credential=t,e._fetchSelf("immediate"))})).then((function(t){t&&(e.sourceJSON=t,e.read(t))}))};return p.b?p.b.getCredential(this.restUrl).then((function(e){return t(e)})):t(this.credential)}},{key:"_normalizeSSL",value:function(e){return e.replace(/^http:/i,"https:").replace(":7080",":7443")}},{key:"_normalizeUrl",value:function(e){var t=this.credential&&this.credential.token;return this._normalizeSSL(t?e+(e.indexOf("?")>-1?"&":"?")+"token="+t:e)}},{key:"_requestToTypedArray",value:function(e,t,r){var n=this;return this._request(e,t).then((function(e){var t=C._resultsToTypedArray(r,{portal:n},e);return Promise.all(t.map((function(t){return"function"==typeof t.when?t.when():e}))).then((function(){return t}),(function(){return t}))}))}},{key:"_request",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=Object(n.a)({f:"json"},t.query),i=t.authMode,a=void 0===i?this.authMode===C.AUTH_MODE_ANONYMOUS?"anonymous":"auto":i,o=t.body,s=void 0===o?null:o,c=t.cacheBust,l=void 0!==c&&c,u=t.method,d=void 0===u?"auto":u,h=t.responseType,f=void 0===h?"json":h,p=t.signal,v={authMode:a,body:s,cacheBust:l,method:d,query:r,responseType:f,timeout:0,signal:p};return Object(b.default)(this._normalizeSSL(e),v).then((function(e){return e.data}))}}],[{key:"getDefault",value:function(){return C._default&&!C._default.destroyed||(C._default=new C),C._default}},{key:"fromJSON",value:function(e){if(!e)return null;if(e.declaredClass)throw new Error("JSON object is already hydrated");return new C({sourceJSON:e})}},{key:"_resultsToTypedArray",value:function(e,t,r,n){var i;if(r){var a=Object(g.j)(n)?n.signal:null;i=r.listings||r.notifications||r.userInvitations||r.tags||r.items||r.groups||r.comments||r.provisions||r.results||r.relatedItems||r,(e||t)&&(i=i.map((function(r){var n=Object.assign(e?e.fromJSON(r):r,t);return"function"==typeof n.load&&n.load(a),n})))}else i=[];return i}}]),i}(Object(m.b)(y.a));I.AUTH_MODE_ANONYMOUS="anonymous",I.AUTH_MODE_AUTO="auto",I.AUTH_MODE_IMMEDIATE="immediate",Object(h.a)([Object(j.b)()],I.prototype,"access",void 0),Object(h.a)([Object(j.b)()],I.prototype,"allSSL",void 0),Object(h.a)([Object(j.b)()],I.prototype,"authMode",void 0),Object(h.a)([Object(j.b)()],I.prototype,"authorizedCrossOriginDomains",void 0),Object(h.a)([Object(w.a)("authorizedCrossOriginDomains")],I.prototype,"readAuthorizedCrossOriginDomains",null),Object(h.a)([Object(j.b)()],I.prototype,"basemapGalleryGroupQuery",void 0),Object(h.a)([Object(j.b)()],I.prototype,"bingKey",void 0),Object(h.a)([Object(j.b)()],I.prototype,"canListApps",void 0),Object(h.a)([Object(j.b)()],I.prototype,"canListData",void 0),Object(h.a)([Object(j.b)()],I.prototype,"canListPreProvisionedItems",void 0),Object(h.a)([Object(j.b)()],I.prototype,"canProvisionDirectPurchase",void 0),Object(h.a)([Object(j.b)()],I.prototype,"canSearchPublic",void 0),Object(h.a)([Object(j.b)()],I.prototype,"canShareBingPublic",void 0),Object(h.a)([Object(j.b)()],I.prototype,"canSharePublic",void 0),Object(h.a)([Object(j.b)()],I.prototype,"canSignInArcGIS",void 0),Object(h.a)([Object(j.b)()],I.prototype,"canSignInIDP",void 0),Object(h.a)([Object(j.b)()],I.prototype,"colorSetsGroupQuery",void 0),Object(h.a)([Object(j.b)()],I.prototype,"commentsEnabled",void 0),Object(h.a)([Object(j.b)({type:Date})],I.prototype,"created",void 0),Object(h.a)([Object(j.b)()],I.prototype,"credential",void 0),Object(h.a)([Object(j.b)()],I.prototype,"culture",void 0),Object(h.a)([Object(j.b)()],I.prototype,"currentVersion",void 0),Object(h.a)([Object(j.b)()],I.prototype,"customBaseUrl",void 0),Object(h.a)([Object(j.b)()],I.prototype,"defaultBasemap",void 0),Object(h.a)([Object(w.a)("defaultBasemap")],I.prototype,"readDefaultBasemap",null),Object(h.a)([Object(j.b)({type:k.a})],I.prototype,"defaultExtent",void 0),Object(h.a)([Object(j.b)()],I.prototype,"defaultVectorBasemap",void 0),Object(h.a)([Object(w.a)("defaultVectorBasemap")],I.prototype,"readDefaultVectorBasemap",null),Object(h.a)([Object(j.b)()],I.prototype,"description",void 0),Object(h.a)([Object(j.b)()],I.prototype,"eueiEnabled",void 0),Object(h.a)([Object(j.b)({readOnly:!0})],I.prototype,"extraQuery",null),Object(h.a)([Object(j.b)()],I.prototype,"featuredGroups",void 0),Object(h.a)([Object(j.b)()],I.prototype,"featuredItemsGroupQuery",void 0),Object(h.a)([Object(j.b)()],I.prototype,"galleryTemplatesGroupQuery",void 0),Object(h.a)([Object(j.b)()],I.prototype,"livingAtlasGroupQuery",void 0),Object(h.a)([Object(j.b)()],I.prototype,"hasCategorySchema",void 0),Object(h.a)([Object(j.b)()],I.prototype,"helpBase",void 0),Object(h.a)([Object(j.b)()],I.prototype,"helperServices",void 0),Object(h.a)([Object(j.b)()],I.prototype,"helpMap",void 0),Object(h.a)([Object(j.b)()],I.prototype,"homePageFeaturedContent",void 0),Object(h.a)([Object(j.b)()],I.prototype,"homePageFeaturedContentCount",void 0),Object(h.a)([Object(j.b)()],I.prototype,"httpPort",void 0),Object(h.a)([Object(j.b)()],I.prototype,"httpsPort",void 0),Object(h.a)([Object(j.b)()],I.prototype,"id",void 0),Object(h.a)([Object(j.b)()],I.prototype,"ipCntryCode",void 0),Object(h.a)([Object(j.b)({readOnly:!0})],I.prototype,"isOrganization",null),Object(h.a)([Object(j.b)()],I.prototype,"isPortal",void 0),Object(h.a)([Object(j.b)()],I.prototype,"isReadOnly",void 0),Object(h.a)([Object(j.b)()],I.prototype,"layerTemplatesGroupQuery",void 0),Object(h.a)([Object(j.b)()],I.prototype,"maxTokenExpirationMinutes",void 0),Object(h.a)([Object(j.b)({type:Date})],I.prototype,"modified",void 0),Object(h.a)([Object(j.b)()],I.prototype,"name",void 0),Object(h.a)([Object(j.b)()],I.prototype,"portalHostname",void 0),Object(h.a)([Object(j.b)()],I.prototype,"portalMode",void 0),Object(h.a)([Object(j.b)()],I.prototype,"portalProperties",void 0),Object(h.a)([Object(j.b)()],I.prototype,"region",void 0),Object(h.a)([Object(j.b)({readOnly:!0})],I.prototype,"restUrl",null),Object(h.a)([Object(j.b)()],I.prototype,"rotatorPanels",void 0),Object(h.a)([Object(j.b)()],I.prototype,"showHomePageDescription",void 0),Object(h.a)([Object(j.b)()],I.prototype,"sourceJSON",void 0),Object(h.a)([Object(j.b)()],I.prototype,"staticImagesUrl",void 0),Object(h.a)([Object(j.b)()],I.prototype,"stylesGroupQuery",void 0),Object(h.a)([Object(j.b)()],I.prototype,"supportsHostedServices",void 0),Object(h.a)([Object(j.b)()],I.prototype,"symbolSetsGroupQuery",void 0),Object(h.a)([Object(j.b)()],I.prototype,"templatesGroupQuery",void 0),Object(h.a)([Object(j.b)()],I.prototype,"thumbnail",void 0),Object(h.a)([Object(j.b)({readOnly:!0})],I.prototype,"thumbnailUrl",null),Object(h.a)([Object(j.b)()],I.prototype,"units",void 0),Object(h.a)([Object(j.b)()],I.prototype,"url",void 0),Object(h.a)([Object(j.b)()],I.prototype,"urlKey",void 0),Object(h.a)([Object(w.a)("urlKey")],I.prototype,"readUrlKey",null),Object(h.a)([Object(j.b)()],I.prototype,"user",void 0),Object(h.a)([Object(w.a)("user")],I.prototype,"readUser",null),Object(h.a)([Object(j.b)()],I.prototype,"useStandardizedQuery",void 0),Object(h.a)([Object(j.b)()],I.prototype,"useVectorBasemaps",void 0),Object(h.a)([Object(j.b)()],I.prototype,"vectorBasemapGalleryGroupQuery",void 0);var D=I=C=Object(h.a)([Object(x.a)("esri.portal.Portal")],I);t.a=D},function(e,t,r){"use strict";r.d(t,"a",(function(){return f})),r.d(t,"b",(function(){return h})),r.d(t,"c",(function(){return d})),r.d(t,"d",(function(){return l})),r.d(t,"e",(function(){return u}));var n=r(4),i=r(9),a=r(437),o=function(){for(var e=new Uint32Array(131072),t=0;t<e.length;++t)e[t]=t;return e}(),s=new Uint16Array([0]),c=function(){for(var e=new Uint16Array(65536),t=0;t<e.length;++t)e[t]=t;return e}();function l(e){if(1===e)return s;if(e<c.length)return new Uint16Array(c.buffer,0,e);if(e>o.length){var t=Math.max(2*o.length,e);o=new Uint32Array(t);for(var r=0;r<o.length;r++)o[r]=r}return new Uint32Array(o.buffer,0,e)}function u(e){if(1===e)return new Uint16Array(s);if(e<c.length)return new Uint16Array(c.slice(0,e));if(e>o.length){for(var t=new Uint32Array(e),r=0;r<t.length;r++)t[r]=r;return t}return new Uint32Array(o.slice(0,e))}function d(e,t,r){if(!e)return!1;var i=e.size,o=e.data;Object(n.y)(r,0,0,0),Object(n.y)(m,0,0,0);for(var s=0,c=0,l=0;l<t.length-2;l+=3){var u=t[l+0]*i,d=t[l+1]*i,h=t[l+2]*i;Object(n.y)(p,o[u+0],o[u+1],o[u+2]),Object(n.y)(b,o[d+0],o[d+1],o[d+2]),Object(n.y)(v,o[h+0],o[h+1],o[h+2]);var f=Object(a.b)(p,b,v);f?(Object(n.h)(p,p,b),Object(n.h)(p,p,v),Object(n.g)(p,p,1/3*f),Object(n.h)(r,r,p),s+=f):(Object(n.h)(m,m,p),Object(n.h)(m,m,b),Object(n.h)(m,m,v),c+=3)}return(0!==c||0!==s)&&(0!==s?(Object(n.g)(r,r,1/s),!0):0!==c&&(Object(n.g)(r,m,1/c),!0))}function h(e,t,r){if(!e||!t)return!1;var i=e.size,a=e.data;Object(n.y)(r,0,0,0);for(var o=-1,s=0,c=0;c<t.length;c++){var l=t[c]*i;o!==l&&(r[0]+=a[l+0],r[1]+=a[l+1],r[2]+=a[l+2],s++),o=l}return s>1&&Object(n.g)(r,r,1/s),s>0}function f(e,t,r,i){if(!e)return!1;var a=e.size,o=e.data;Object(n.y)(i,0,0,0),Object(n.y)(m,0,0,0);for(var s=0,c=0,l=t?t.length-1:o.length/a-1,u=l+(r?2:0),d=0;d<u;d+=2){var h=d<l?d:l,f=d<l?d+1:0,v=(t?t[h]:h)*a,y=(t?t[f]:f)*a;p[0]=o[v+0],p[1]=o[v+1],p[2]=o[v+2],b[0]=o[y+0],b[1]=o[y+1],b[2]=o[y+2],Object(n.g)(p,Object(n.h)(p,p,b),.5);var g=Object(n.p)(p,b);g>0?(Object(n.h)(i,i,Object(n.g)(p,p,g)),s+=g):(Object(n.h)(m,m,p),c++)}return 0!==s?(Object(n.g)(i,i,1/s),!0):0!==c&&(Object(n.g)(i,m,1/c),!0)}var p=Object(i.e)(),b=Object(i.e)(),v=Object(i.e)(),m=Object(i.e)()},function(e,t,r){"use strict";r.d(t,"a",(function(){return l})),r.d(t,"b",(function(){return f})),r.d(t,"c",(function(){return p})),r.d(t,"d",(function(){return d})),r.d(t,"e",(function(){return u}));var n=r(13),i=r(26),a=r(32),o=r(46);function s(e,t,r,n){var i=r.typedBuffer,a=r.typedBufferStride,o=e.length;n*=a;for(var s=0;s<o;++s){var c=2*e[s];i[n]=t[c],i[n+1]=t[c+1],n+=a}}function c(e,t,r,n,i){var a=r.typedBuffer,o=r.typedBufferStride,s=e.length;if(n*=o,null==i||1===i)for(var c=0;c<s;++c){var l=3*e[c];a[n]=t[l],a[n+1]=t[l+1],a[n+2]=t[l+2],n+=o}else for(var u=0;u<s;++u)for(var d=3*e[u],h=0;h<i;++h)a[n]=t[d],a[n+1]=t[d+1],a[n+2]=t[d+2],n+=o}function l(e,t,r,n){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1,a=r.typedBuffer,o=r.typedBufferStride,s=e.length;if(n*=o,1===i)for(var c=0;c<s;++c){var l=4*e[c];a[n]=t[l],a[n+1]=t[l+1],a[n+2]=t[l+2],a[n+3]=t[l+3],n+=o}else for(var u=0;u<s;++u)for(var d=4*e[u],h=0;h<i;++h)a[n]=t[d],a[n+1]=t[d+1],a[n+2]=t[d+2],a[n+3]=t[d+3],n+=o}function u(e,t,r,n,i){var a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1;if(r){var o=n.typedBuffer,s=n.typedBufferStride,l=e.length,u=r[0],d=r[1],h=r[2],f=r[4],p=r[5],b=r[6],v=r[8],m=r[9],y=r[10],g=r[12],O=r[13],j=r[14];if(i*=s,1===a)for(var _=0;_<l;++_){var w=3*e[_],x=t[w],k=t[w+1],S=t[w+2];o[i]=u*x+f*k+v*S+g,o[i+1]=d*x+p*k+m*S+O,o[i+2]=h*x+b*k+y*S+j,i+=s}else for(var T=0;T<l;++T)for(var C=3*e[T],M=t[C],P=t[C+1],A=t[C+2],E=u*M+f*P+v*A+g,R=d*M+p*P+m*A+O,I=h*M+b*P+y*A+j,D=0;D<a;++D)o[i]=E,o[i+1]=R,o[i+2]=I,i+=s}else c(e,t,n,i,a)}function d(e,t,r,n,a){var o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1;if(r){var s=r,l=n.typedBuffer,u=n.typedBufferStride,d=e.length,h=s[0],f=s[1],p=s[2],b=s[4],v=s[5],m=s[6],y=s[8],g=s[9],O=s[10],j=!Object(i.p)(s),_=1e-6,w=1-_;if(a*=u,1===o)for(var x=0;x<d;++x){var k=3*e[x],S=t[k],T=t[k+1],C=t[k+2],M=h*S+b*T+y*C,P=f*S+v*T+g*C,A=p*S+m*T+O*C;if(j){var E=M*M+P*P+A*A;if(E<w&&E>_){var R=1/Math.sqrt(E);M*=R,P*=R,A*=R}}l[a+0]=M,l[a+1]=P,l[a+2]=A,a+=u}else for(var I=0;I<d;++I){var D=3*e[I],F=t[D],L=t[D+1],z=t[D+2],V=h*F+b*L+y*z,N=f*F+v*L+g*z,U=p*F+m*L+O*z;if(j){var B=V*V+N*N+U*U;if(B<w&&B>_){var G=1/Math.sqrt(B);V*=G,N*=G,U*=G}}for(var q=0;q<o;++q)l[a+0]=V,l[a+1]=N,l[a+2]=U,a+=u}}else c(e,t,n,a,o)}function h(e,t,r,n,a){var o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1;if(r){var s=r,c=n.typedBuffer,u=n.typedBufferStride,d=e.length,h=s[0],f=s[1],p=s[2],b=s[4],v=s[5],m=s[6],y=s[8],g=s[9],O=s[10],j=!Object(i.p)(s),_=1e-6,w=1-_;if(a*=u,1===o)for(var x=0;x<d;++x){var k=4*e[x],S=t[k],T=t[k+1],C=t[k+2],M=t[k+3],P=h*S+b*T+y*C,A=f*S+v*T+g*C,E=p*S+m*T+O*C;if(j){var R=P*P+A*A+E*E;if(R<w&&R>_){var I=1/Math.sqrt(R);P*=I,A*=I,E*=I}}c[a+0]=P,c[a+1]=A,c[a+2]=E,c[a+3]=M,a+=u}else for(var D=0;D<d;++D){var F=4*e[D],L=t[F],z=t[F+1],V=t[F+2],N=t[F+3],U=h*L+b*z+y*V,B=f*L+v*z+g*V,G=p*L+m*z+O*V;if(j){var q=U*U+B*B+G*G;if(q<w&&q>_){var H=1/Math.sqrt(q);U*=H,B*=H,G*=H}}for(var W=0;W<o;++W)c[a+0]=U,c[a+1]=B,c[a+2]=G,c[a+3]=N,a+=u}}else l(e,t,n,a,o)}function f(e,t,r,n,i){var a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1,o=n.typedBuffer,s=n.typedBufferStride,c=e.length;if(i*=s,1===a){if(4===r)for(var l=0;l<c;++l){var u=4*e[l];o[i]=t[u],o[i+1]=t[u+1],o[i+2]=t[u+2],o[i+3]=t[u+3],i+=s}else if(3===r)for(var d=0;d<c;++d){var h=3*e[d];o[i]=t[h],o[i+1]=t[h+1],o[i+2]=t[h+2],o[i+3]=255,i+=s}}else if(4===r)for(var f=0;f<c;++f)for(var p=4*e[f],b=0;b<a;++b)o[i]=t[p],o[i+1]=t[p+1],o[i+2]=t[p+2],o[i+3]=t[p+3],i+=s;else if(3===r)for(var v=0;v<c;++v)for(var m=3*e[v],y=0;y<a;++y)o[i]=t[m],o[i+1]=t[m+1],o[i+2]=t[m+2],o[i+3]=255,i+=s}function p(e,t,r,i,c,l){var p,b=Object(n.a)(t.fieldNames);try{for(b.s();!(p=b.n()).done;){var v=p.value,m=e.vertexAttributes.get(v),y=e.indices.get(v);if(m&&y)switch(v){case"position":Object(o.a)(3===m.size);var g=c.getField(v,a.u);g&&u(y,m.data,r,g,l);break;case"normal":Object(o.a)(3===m.size);var O=c.getField(v,a.u);O&&d(y,m.data,i,O,l);break;case"uv0":Object(o.a)(2===m.size);var j=c.getField(v,a.m);j&&s(y,m.data,j,l);break;case"color":Object(o.a)(3===m.size||4===m.size);var _=c.getField(v,a.J);_&&f(y,m.data,m.size,_,l);break;case"symbolColor":Object(o.a)(3===m.size||4===m.size);var w=c.getField(v,a.J);w&&f(y,m.data,m.size,w,l);break;case"tangent":Object(o.a)(4===m.size);var x=c.getField(v,a.C);x&&h(y,m.data,i,x,l)}}}catch(k){b.e(k)}finally{b.f()}}},function(e,t,r){"use strict";var n,i=r(2),a=r(5),o=r(6),s=r(7),c=r(0),l=r(126),u=r(232),d=r(58),h=r(27),f=r(25),p=r(3),b=r(1),v=r(64),m=(r(17),r(15),r(52)),y=r(10),g=r(44),O=r(18),j=r(100),_=r(305),w=r(583),x=r(456),k=r(55),S=r(56),T=new d.a({esriSpatialRelIntersects:"intersects",esriSpatialRelContains:"contains",esriSpatialRelCrosses:"crosses",esriSpatialRelDisjoint:"disjoint",esriSpatialRelEnvelopeIntersects:"envelope-intersects",esriSpatialRelIndexIntersects:"index-intersects",esriSpatialRelOverlaps:"overlaps",esriSpatialRelTouches:"touches",esriSpatialRelWithin:"within",esriSpatialRelRelation:"relation"}),C=new d.a({esriSRUnit_Meter:"meters",esriSRUnit_Kilometer:"kilometers",esriSRUnit_Foot:"feet",esriSRUnit_StatuteMile:"miles",esriSRUnit_NauticalMile:"nautical-miles",esriSRUnit_USNauticalMile:"us-nautical-miles"}),M=n=function(e){Object(o.a)(r,e);var t=Object(s.a)(r);function r(e){var n;return Object(i.a)(this,r),(n=t.call(this,e)).aggregateIds=null,n.cacheHint=void 0,n.datumTransformation=null,n.distance=void 0,n.dynamicDataSource=void 0,n.formatOf3DObjects=null,n.gdbVersion=null,n.geometry=null,n.geometryPrecision=void 0,n.groupByFieldsForStatistics=null,n.having=null,n.historicMoment=null,n.maxAllowableOffset=void 0,n.maxRecordCountFactor=1,n.multipatchOption=null,n.num=void 0,n.objectIds=null,n.orderByFields=null,n.outFields=null,n.outSpatialReference=null,n.outStatistics=null,n.parameterValues=null,n.pixelSize=null,n.quantizationParameters=null,n.rangeValues=null,n.relationParameter=null,n.resultType=null,n.returnCentroid=!1,n.returnDistinctValues=!1,n.returnExceededLimitFeatures=!0,n.returnGeometry=!1,n.returnQueryGeometry=!1,n.returnM=void 0,n.returnZ=void 0,n.sourceSpatialReference=null,n.spatialRelationship="intersects",n.start=void 0,n.sqlFormat=null,n.text=null,n.timeExtent=null,n.units=null,n.where=null,n}return Object(a.a)(r,[{key:"castDatumTransformation",value:function(e){return"number"==typeof e||"object"==typeof e?e:null}},{key:"writeHistoricMoment",value:function(e,t){t.historicMoment=e&&e.getTime()}},{key:"writeParameterValues",value:function(e,t){if(e){var r={};for(var n in e){var i=e[n];Array.isArray(i)?r[n]=i.map((function(e){return e instanceof Date?e.getTime():e})):i instanceof Date?r[n]=i.getTime():r[n]=i}t.parameterValues=r}}},{key:"writeStart",value:function(e,t){t.resultOffset=this.start,t.resultRecordCount=this.num||10,t.where="1=1"}},{key:"writeWhere",value:function(e,t){t.where=e||"1=1"}},{key:"clone",value:function(){return new n(Object(f.a)({aggregateIds:this.aggregateIds,cacheHint:this.cacheHint,datumTransformation:this.datumTransformation,distance:this.distance,gdbVersion:this.gdbVersion,geometry:this.geometry,geometryPrecision:this.geometryPrecision,groupByFieldsForStatistics:this.groupByFieldsForStatistics,having:this.having,historicMoment:Object(p.j)(this.historicMoment)?new Date(this.historicMoment.getTime()):null,maxAllowableOffset:this.maxAllowableOffset,maxRecordCountFactor:this.maxRecordCountFactor,multipatchOption:this.multipatchOption,num:this.num,objectIds:this.objectIds,orderByFields:this.orderByFields,outFields:this.outFields,outSpatialReference:this.outSpatialReference,outStatistics:this.outStatistics,parameterValues:this.parameterValues,pixelSize:this.pixelSize,quantizationParameters:this.quantizationParameters,rangeValues:this.rangeValues,relationParameter:this.relationParameter,resultType:this.resultType,returnDistinctValues:this.returnDistinctValues,returnGeometry:this.returnGeometry,returnCentroid:this.returnCentroid,returnExceededLimitFeatures:this.returnExceededLimitFeatures,returnQueryGeometry:this.returnQueryGeometry,returnM:this.returnM,returnZ:this.returnZ,dynamicDataSource:this.dynamicDataSource,sourceSpatialReference:this.sourceSpatialReference,spatialRelationship:this.spatialRelationship,start:this.start,sqlFormat:this.sqlFormat,text:this.text,timeExtent:this.timeExtent,units:this.units,where:this.where}))}}],[{key:"from",value:function(e){return Object(O.d)(n,e)}}]),r}(h.a);M.MAX_MAX_RECORD_COUNT_FACTOR=5,Object(c.a)([Object(b.b)({json:{write:!0}})],M.prototype,"aggregateIds",void 0),Object(c.a)([Object(b.b)({type:Boolean,json:{write:!0}})],M.prototype,"cacheHint",void 0),Object(c.a)([Object(b.b)({json:{write:!0}})],M.prototype,"datumTransformation",void 0),Object(c.a)([Object(v.a)("datumTransformation")],M.prototype,"castDatumTransformation",null),Object(c.a)([Object(b.b)({type:Number,json:{write:{overridePolicy:function(e){return{enabled:e>0}}}}})],M.prototype,"distance",void 0),Object(c.a)([Object(b.b)({type:_.a,json:{write:!0}})],M.prototype,"dynamicDataSource",void 0),Object(c.a)([Object(b.b)({type:String,json:{write:!0}})],M.prototype,"formatOf3DObjects",void 0),Object(c.a)([Object(b.b)({type:String,json:{write:!0}})],M.prototype,"gdbVersion",void 0),Object(c.a)([Object(b.b)({types:l.a,json:{read:j.a,write:!0}})],M.prototype,"geometry",void 0),Object(c.a)([Object(b.b)({type:Number,json:{write:!0}})],M.prototype,"geometryPrecision",void 0),Object(c.a)([Object(b.b)({type:[String],json:{write:!0}})],M.prototype,"groupByFieldsForStatistics",void 0),Object(c.a)([Object(b.b)({type:String,json:{write:!0}})],M.prototype,"having",void 0),Object(c.a)([Object(b.b)({type:Date})],M.prototype,"historicMoment",void 0),Object(c.a)([Object(g.a)("historicMoment")],M.prototype,"writeHistoricMoment",null),Object(c.a)([Object(b.b)({type:Number,json:{write:!0}})],M.prototype,"maxAllowableOffset",void 0),Object(c.a)([Object(b.b)({type:Number,cast:function(e){return e<1?1:e>n.MAX_MAX_RECORD_COUNT_FACTOR?n.MAX_MAX_RECORD_COUNT_FACTOR:e},json:{write:{overridePolicy:function(e){return{enabled:e>1}}}}})],M.prototype,"maxRecordCountFactor",void 0),Object(c.a)([Object(b.b)({type:["xyFootprint"],json:{write:!0}})],M.prototype,"multipatchOption",void 0),Object(c.a)([Object(b.b)({type:Number,json:{read:{source:"resultRecordCount"}}})],M.prototype,"num",void 0),Object(c.a)([Object(b.b)({json:{write:!0}})],M.prototype,"objectIds",void 0),Object(c.a)([Object(b.b)({type:[String],json:{write:!0}})],M.prototype,"orderByFields",void 0),Object(c.a)([Object(b.b)({type:[String],json:{write:!0}})],M.prototype,"outFields",void 0),Object(c.a)([Object(b.b)({type:k.a,json:{name:"outSR",write:!0}})],M.prototype,"outSpatialReference",void 0),Object(c.a)([Object(b.b)({type:[x.a],json:{write:{enabled:!0,overridePolicy:function(){return{enabled:Object(p.j)(this.outStatistics)&&this.outStatistics.length>0}}}}})],M.prototype,"outStatistics",void 0),Object(c.a)([Object(b.b)({json:{write:!0}})],M.prototype,"parameterValues",void 0),Object(c.a)([Object(g.a)("parameterValues")],M.prototype,"writeParameterValues",null),Object(c.a)([Object(b.b)({type:S.a,json:{write:!0}})],M.prototype,"pixelSize",void 0),Object(c.a)([Object(b.b)({type:w.a,json:{write:!0}})],M.prototype,"quantizationParameters",void 0),Object(c.a)([Object(b.b)({type:[Object],json:{write:!0}})],M.prototype,"rangeValues",void 0),Object(c.a)([Object(b.b)({type:String,json:{read:{source:"relationParam"},write:{target:"relationParam",overridePolicy:function(){return{enabled:"relation"===this.spatialRelationship}}}}})],M.prototype,"relationParameter",void 0),Object(c.a)([Object(b.b)({type:String,json:{write:!0}})],M.prototype,"resultType",void 0),Object(c.a)([Object(b.b)({type:Boolean,json:{default:!1,write:!0}})],M.prototype,"returnCentroid",void 0),Object(c.a)([Object(b.b)({type:Boolean,json:{default:!1,write:!0}})],M.prototype,"returnDistinctValues",void 0),Object(c.a)([Object(b.b)({type:Boolean,json:{default:!0,write:!0}})],M.prototype,"returnExceededLimitFeatures",void 0),Object(c.a)([Object(b.b)({type:Boolean,json:{write:!0}})],M.prototype,"returnGeometry",void 0),Object(c.a)([Object(b.b)({type:Boolean,json:{default:!1,write:!0}})],M.prototype,"returnQueryGeometry",void 0),Object(c.a)([Object(b.b)({type:Boolean,json:{default:!1,write:!0}})],M.prototype,"returnM",void 0),Object(c.a)([Object(b.b)({type:Boolean,json:{write:{overridePolicy:function(e){return{enabled:e}}}}})],M.prototype,"returnZ",void 0),Object(c.a)([Object(b.b)({type:k.a,json:{write:!0}})],M.prototype,"sourceSpatialReference",void 0),Object(c.a)([Object(m.a)(T,{ignoreUnknown:!1,name:"spatialRel"})],M.prototype,"spatialRelationship",void 0),Object(c.a)([Object(b.b)({type:Number,json:{read:{source:"resultOffset"}}})],M.prototype,"start",void 0),Object(c.a)([Object(g.a)("start"),Object(g.a)("num")],M.prototype,"writeStart",null),Object(c.a)([Object(b.b)({type:String,json:{write:!0}})],M.prototype,"sqlFormat",void 0),Object(c.a)([Object(b.b)({type:String,json:{write:!0}})],M.prototype,"text",void 0),Object(c.a)([Object(b.b)({type:u.a,json:{write:!0}})],M.prototype,"timeExtent",void 0),Object(c.a)([Object(m.a)(C,{ignoreUnknown:!1}),Object(b.b)({json:{write:{overridePolicy:function(e){return{enabled:e&&this.distance>0}}}}})],M.prototype,"units",void 0),Object(c.a)([Object(b.b)({type:String,json:{write:{overridePolicy:function(e){return{enabled:null!=e||this.start>0}}}}})],M.prototype,"where",void 0),Object(c.a)([Object(g.a)("where")],M.prototype,"writeWhere",null);var P=M=n=Object(c.a)([Object(y.a)("esri.rest.support.Query")],M);t.a=P},function(e,t,r){"use strict";r.d(t,"a",(function(){return y})),r.d(t,"b",(function(){return m})),r.d(t,"c",(function(){return b})),r.d(t,"d",(function(){return v})),r.d(t,"e",(function(){return f}));var n,i=r(8),a=r.n(i),o=r(21),s=r(14),c=r(2),l=r(5),u=r(16),d=(r(126),r(3)),h=r(55);function f(){return p.apply(this,arguments)}function p(){return(p=Object(u.a)(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(n||(n=Object(u.a)(a.a.mark((function e(){var t;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.e(21).then(r.bind(null,708));case 2:return t=e.sent,e.next=5,t.arcade.load();case 5:return e.abrupt("return",{arcade:t.arcade,arcadeUtils:t,Dictionary:t.Dictionary,Feature:t.arcadeFeature});case 6:case"end":return e.stop()}}),e)})))()),n));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var b=function(e,t,r){return y.create(e,t,r,null,["$feature"])},v=function(e,t,r){return y.create(e,t,r,null,["$feature","$view"])},m=function(e,t,r,n){return y.create(e,t,r,n,["$feature","$view"])},y=function(){function e(t,r,n,i,a,o,s,l){Object(c.a)(this,e),this.script=t,this.evaluate=a;var u=Array.isArray(s)?s:s.fields;this.fields=u,this._syntaxTree=i,this._arcade=r,this._arcadeDictionary=n,this._arcadeFeature=o,this._spatialReference=l,this._referencesGeometry=r.scriptTouchesGeometry(this._syntaxTree),this._referencesScale=this._arcade.referencesMember(this._syntaxTree,"scale")}return Object(l.a)(e,[{key:"repurposeFeature",value:function(e){return e.geometry&&!e.geometry.spatialReference&&(e.geometry.spatialReference=this._spatialReference),this._arcadeFeature.repurposeFromGraphicLikeObject(e.geometry,e.attributes,{fields:this.fields}),this._arcadeFeature}},{key:"repurposeAdapter",value:function(e){return this._arcadeFeature.repurposeFromAdapter(e,{fields:this.fields}),this._arcadeFeature}},{key:"createDictionary",value:function(){return new this._arcadeDictionary}},{key:"referencesMember",value:function(e){return this._arcade.referencesMember(this._syntaxTree,e)}},{key:"referencesFunction",value:function(e){return this._arcade.referencesFunction(this._syntaxTree,e)}},{key:"referencesGeometry",value:function(){return this._referencesGeometry}},{key:"referencesScale",value:function(){return this._referencesScale}},{key:"extractFieldLiterals",value:function(e){return this._arcade.extractFieldLiterals(this._syntaxTree,e)}}],[{key:"create",value:function(){var t=Object(u.a)(a.a.mark((function t(r,n,i,c,l,u){var p,b,v,m,y,g,O,j,_,w,x,k,S,T,C;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,f();case 2:return p=t.sent,b=p.arcade,v=p.Feature,m=p.Dictionary,y=h.a.fromJSON(n),g=b.parseScript(r,u),O=l.reduce((function(e,t){return Object(s.a)(Object(s.a)({},e),{},Object(o.a)({},t,null))}),{}),j=null,Object(d.j)(c)&&((j=new m(c)).immutable=!0,O.$config=null),_=b.scriptUsesGeometryEngine(g)&&b.enableGeometrySupport(),w=b.scriptUsesFeatureSet(g)&&b.enableFeatureSetSupport(),x=b.scriptIsAsync(g)&&b.enableAsyncSupport(),k={vars:O,spatialReference:y,useAsync:!!x},(S=new m).immutable=!1,S.setField("scale",0),T=b.compileScript(g,k),C=function(e){return"$view"in e&&e.$view&&(S.setField("scale",e.$view.scale),e.$view=S),j&&(e.$config=j),T({vars:e,spatialReference:y})},t.next=16,Promise.all([_,w,x]);case 16:return t.abrupt("return",new e(r,b,m,g,C,new v,i,y));case 17:case"end":return t.stop()}}),t)})));return function(e,r,n,i,a,o){return t.apply(this,arguments)}}()}]),e}()},function(e,t,r){"use strict";r.d(t,"a",(function(){return c}));var n=r(2),i=r(5),a=r(3),o=r(421),s=r(233),c=function(){function e(){Object(n.a)(this,e),this._meterUnitOffset=0,this._renderUnitOffset=0,this._unit="meters",this._metersPerElevationInfoUnit=1,this._featureExpressionInfoContext=null,this.centerPointInElevationSR=null,this.mode=null}return Object(i.a)(e,[{key:"featureExpressionInfoContext",get:function(){return this._featureExpressionInfoContext}},{key:"meterUnitOffset",get:function(){return this._meterUnitOffset}},{key:"unit",get:function(){return this._unit},set:function(e){this._unit=e,this._metersPerElevationInfoUnit=Object(o.a)(e)}},{key:"reset",value:function(){this.mode=null,this._meterUnitOffset=0,this._renderUnitOffset=0,this._featureExpressionInfoContext=null,this.unit="meters"}},{key:"offsetMeters",set:function(e){this._meterUnitOffset=e,this._renderUnitOffset=0}},{key:"offsetElevationInfoUnits",set:function(e){this._meterUnitOffset=e*this._metersPerElevationInfoUnit,this._renderUnitOffset=0}},{key:"addOffsetRenderUnits",value:function(e){this._renderUnitOffset+=e}},{key:"geometryZWithOffset",value:function(e,t){var r=this.calculateOffsetRenderUnits(t);return null!=this.featureExpressionInfoContext?r:e+r}},{key:"calculateOffsetRenderUnits",value:function(e){var t=this._meterUnitOffset,r=this.featureExpressionInfoContext;return null!=r&&(t+=Object(s.e)(r)*this._metersPerElevationInfoUnit),t/e.unitInMeters+this._renderUnitOffset}},{key:"setFromElevationInfo",value:function(e){this.mode=e.mode,this.unit=Object(o.c)(e.unit)?e.unit:"meters",this.offsetElevationInfoUnits=Object(a.t)(e.offset,0)}},{key:"updateFeatureExpressionInfoContext",value:function(e,t,r){if(Object(a.i)(e))this._featureExpressionInfoContext=null;else{var n=e&&e.arcade;n&&Object(a.j)(t)&&Object(a.j)(r)?(this._featureExpressionInfoContext=Object(s.a)(e),Object(s.g)(this._featureExpressionInfoContext,Object(s.d)(n.modules,t,r))):this._featureExpressionInfoContext=e}}}],[{key:"fromElevationInfo",value:function(t){var r=new e;return Object(a.j)(t)&&r.setFromElevationInfo(t),r}}]),e}()},function(e,t,r){"use strict";r.d(t,"a",(function(){return y})),r.d(t,"b",(function(){return g})),r.d(t,"c",(function(){return Y})),r.d(t,"d",(function(){return O})),r.d(t,"e",(function(){return j})),r.d(t,"f",(function(){return E})),r.d(t,"g",(function(){return _})),r.d(t,"h",(function(){return S})),r.d(t,"i",(function(){return F})),r.d(t,"j",(function(){return D})),r.d(t,"k",(function(){return I})),r.d(t,"l",(function(){return w}));var n=r(13),i=r(2),a=(r(17),r(15)),o=r(20),s=r(212),c=r(26),l=r(31),u=r(4),d=r(9),h=r(125),f=r(37),p=r(79),b=r(210),v=r(47),m=a.a.getLogger("esri.views.3d.support.geometryUtils.boundedPlane"),y=function e(){Object(i.a)(this,e),this.plane=Object(f.d)(),this.origin=Object(d.e)(),this.basis1=Object(d.e)(),this.basis2=Object(d.e)()};function g(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:B;return{plane:Object(f.d)(e.plane),origin:Object(d.c)(e.origin),basis1:Object(d.c)(e.basis1),basis2:Object(d.c)(e.basis2)}}function O(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:g();return _(e.origin,e.basis1,e.basis2,t)}function j(e,t){Object(u.m)(t.origin,e.origin),Object(u.m)(t.basis1,e.basis1),Object(u.m)(t.basis2,e.basis2),Object(f.c)(e.plane,t.plane)}function _(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:g();return Object(u.m)(n.origin,e),Object(u.m)(n.basis1,t),Object(u.m)(n.basis2,r),w(n),N(n,"fromValues()"),n}function w(e){Object(f.j)(e.basis2,e.basis1,e.origin,e.plane)}function x(e,t,r){e!==r&&O(e,r);var n=Object(u.g)(v.c.get(),F(e),t);return Object(u.h)(r.origin,r.origin,n),r.plane[3]-=t,r}function k(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:g(),r=(e[2]-e[0])/2,n=(e[3]-e[1])/2;return Object(u.y)(t.origin,e[0]+r,e[1]+n,0),Object(u.y)(t.basis1,r,0,0),Object(u.y)(t.basis2,0,n,0),Object(f.i)(0,0,1,0,t.plane),t}function S(e,t,r){return!!Object(f.m)(e.plane,t,r)&&L(e,r)}function T(e,t,r){var i=G.get();U(e,t,i,G.get());var a,s=Number.POSITIVE_INFINITY,c=Object(n.a)(Q);try{for(c.s();!(a=c.n()).done;){var l=V(e,a.value,q.get()),d=v.c.get();if(Object(f.k)(i,l,d)){var h=Object(u.x)(v.c.get(),t.origin,d),p=Math.abs(Object(o.b)(Object(u.j)(t.direction,h)));p<s&&(s=p,Object(u.m)(r,d))}}}catch(b){c.e(b)}finally{c.f()}return s===Number.POSITIVE_INFINITY?C(e,t,r):r}function C(e,t,r){if(S(e,t,r))return r;var i=G.get(),a=G.get();U(e,t,i,a);var o,s=Number.POSITIVE_INFINITY,c=Object(n.a)(Q);try{for(c.s();!(o=c.n()).done;){var l=V(e,o.value,q.get()),d=v.c.get();if(Object(f.l)(i,l,d)){var h=Object(p.d)(t,d);if(!Object(f.o)(a,d))continue;h<s&&(s=h,Object(u.m)(r,d))}}}catch(b){c.e(b)}finally{c.f()}return A(e,t.origin)<s&&M(e,t.origin,r),r}function M(e,t,r){var n=Object(f.t)(e.plane,t,v.c.get()),i=Object(h.g)(z(e,e.basis1),n,-1,1,v.c.get()),a=Object(h.g)(z(e,e.basis2),n,-1,1,v.c.get());return Object(u.l)(r,Object(u.h)(v.c.get(),i,a),e.origin),r}function P(e,t,r){var n=e.origin,i=e.basis1,a=e.basis2,o=Object(u.l)(v.c.get(),t,n),s=Object(b.c)(i,o),c=Object(b.c)(a,o),l=Object(b.c)(F(e),o);return Object(u.y)(r,s,c,l)}function A(e,t){var r=P(e,t,v.c.get()),n=e.basis1,i=e.basis2,a=Object(u.r)(n),o=Object(u.r)(i),s=Math.max(Math.abs(r[0])-a,0),c=Math.max(Math.abs(r[1])-o,0),l=r[2];return s*s+c*c+l*l}function E(e,t){return Object(f.o)(e.plane,t)&&L(e,t)}function R(e,t){var r=-e.plane[3];return Object(b.c)(F(e),t)-r}function I(e,t,r){return e!==r&&O(e,r),Object(c.a)(Z,t),Object(c.e)(Z,Z),Object(u.s)(r.basis1,e.basis1,Z),Object(u.s)(r.basis2,e.basis2,Z),Object(u.s)(Object(f.s)(r.plane),Object(f.s)(e.plane),Z),Object(u.s)(r.origin,e.origin,t),Object(f.v)(r.plane,r.origin,r.plane),r}function D(e,t,r,n){return e!==n&&O(e,n),Object(c.c)(X,Object(c.i)(X),t,r),Object(u.s)(n.basis1,e.basis1,X),Object(u.s)(n.basis2,e.basis2,X),w(n),n}function F(e){return Object(f.s)(e.plane)}function L(e,t){var r=Object(u.l)(v.c.get(),t,e.origin),n=Object(u.v)(e.basis1),i=Object(u.v)(e.basis2),a=Object(u.j)(e.basis1,r),o=Object(u.j)(e.basis2,r);return-a-n<0&&a-n<0&&-o-i<0&&o-i<0}function z(e,t){var r=q.get();return Object(u.m)(r.origin,e.origin),Object(u.m)(r.vector,t),r}function V(e,t,r){var n=e.basis1,i=e.basis2,a=e.origin,o=Object(u.g)(v.c.get(),n,t.origin[0]),s=Object(u.g)(v.c.get(),i,t.origin[1]);Object(u.h)(r.origin,o,s),Object(u.h)(r.origin,r.origin,a);var c=Object(u.g)(v.c.get(),n,t.direction[0]),l=Object(u.g)(v.c.get(),i,t.direction[1]);return Object(u.g)(r.vector,Object(u.h)(c,c,l),2),r}function N(e,t){Math.abs(Object(u.j)(e.basis1,e.basis2)/(Object(u.r)(e.basis1)*Object(u.r)(e.basis2)))>1e-6&&m.warn(t,"Provided basis vectors are not perpendicular"),Math.abs(Object(u.j)(e.basis1,F(e)))>1e-6&&m.warn(t,"Basis vectors and plane normal are not perpendicular"),Math.abs(-Object(u.j)(F(e),e.origin)-e.plane[3])>1e-6&&m.warn(t,"Plane offset is not consistent with plane origin")}function U(e,t,r,n){var i=F(e);Object(f.j)(i,t.direction,t.origin,r),Object(f.j)(Object(f.s)(r),i,t.origin,n)}var B={plane:Object(f.d)(),origin:Object(d.g)(0,0,0),basis1:Object(d.g)(1,0,0),basis2:Object(d.g)(0,1,0)},G=new s.a(f.d),q=new s.a(h.c),H=Object(d.e)(),W=new s.a((function(){return{origin:null,basis1:null,basis2:null,plane:null}})),Q=[{origin:[-1,-1],direction:[1,0]},{origin:[1,-1],direction:[0,1]},{origin:[1,1],direction:[-1,0]},{origin:[-1,1],direction:[0,-1]}],Z=Object(l.d)(),X=Object(l.d)(),Y=Object.freeze({__proto__:null,BoundedPlaneClass:y,create:g,wrap:function(e,t,r){var n=W.get();return n.origin=e,n.basis1=t,n.basis2=r,n.plane=Object(f.x)(0,0,0,0),w(n),n},copy:O,copyWithoutVerify:j,fromValues:_,updateUnboundedPlane:w,elevate:x,setExtent:function(e,t,r){return k(t,r),x(r,R(e,e.origin),r),r},fromAABoundingRect:k,intersectRay:S,intersectRayClosestSilhouette:function(e,t,r){if(S(e,t,r))return r;var n=T(e,t,v.c.get());return Object(u.h)(r,t.origin,Object(u.g)(v.c.get(),t.direction,Object(u.o)(t.origin,n)/Object(u.r)(t.direction))),r},closestPointOnSilhouette:T,closestPoint:C,projectPoint:M,projectPointLocal:P,distance2:A,distance:function(e,t){return Math.sqrt(A(e,t))},distanceToSilhouette:function(e,t){var r,i=Number.NEGATIVE_INFINITY,a=Object(n.a)(Q);try{for(a.s();!(r=a.n()).done;){var o=V(e,r.value,q.get()),s=Object(h.d)(o,t);s>i&&(i=s)}}catch(c){a.e(c)}finally{a.f()}return Math.sqrt(i)},extrusionContainsPoint:E,axisAt:function(e,t,r,n){return function(e,t,r){switch(t){case 0:Object(u.m)(r,e.basis1),Object(u.t)(r,r);break;case 1:Object(u.m)(r,e.basis2),Object(u.t)(r,r);break;case 2:Object(u.m)(r,F(e))}return r}(e,r,n)},altitudeAt:R,setAltitudeAt:function(e,t,r,n){var i=R(e,t),a=Object(u.g)(H,F(e),r-i);return Object(u.h)(n,t,a),n},equals:function(e,t){return Object(u.q)(e.basis1,t.basis1)&&Object(u.q)(e.basis2,t.basis2)&&Object(u.q)(e.origin,t.origin)},transform:I,rotate:D,normal:F,UP:B})},function(e,t,r){"use strict";r.d(t,"a",(function(){return c}));var n=r(8),i=r.n(n),a=r(14),o=r(16),s=r(99);function c(e,t){return l.apply(this,arguments)}function l(){return(l=Object(o.a)(i.a.mark((function e(t,r){var n,o;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(s.default)(t,Object(a.a)({responseType:"image"},r));case 2:return n=e.sent,o=n.data,e.abrupt("return",o);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}},function(e,t,r){"use strict";t.a=function(e){return window.WebGL2RenderingContext&&e instanceof window.WebGL2RenderingContext}},function(e,t,r){"use strict";var n,i=r(2),a=r(5),o=r(6),s=r(7),c=r(0),l=r(25),u=r(1),d=(r(18),r(17),r(15),r(10)),h=r(44),f=r(66),p=r(160),b=r(56),v=r(55),m=r(507),y=r(169),g=r(235),O=r(482),j=r(449),_=r(61),w=r(311);function x(e){return!Array.isArray(e[0])}var k=n=function(e){Object(o.a)(r,e);var t=Object(s.a)(r);function r(){var e;Object(i.a)(this,r);for(var n=arguments.length,a=new Array(n),o=0;o<n;o++)a[o]=arguments[o];return(e=t.call.apply(t,[this].concat(a))).rings=[],e.type="polygon",e}return Object(a.a)(r,[{key:"normalizeCtorArgs",value:function(e,t){var r,n,i,a=null;return e&&!Array.isArray(e)?(a=e.rings?e.rings:null,t||(e.spatialReference?t=e.spatialReference:e.rings||(t=e)),r=e.hasZ,n=e.hasM):a=e,a=a||[],t=t||v.a.WGS84,a.length&&a[0]&&null!=a[0][0]&&"number"==typeof a[0][0]&&(a=[a]),(i=a[0]&&a[0][0])&&(void 0===r&&void 0===n?(r=i.length>2,n=i.length>3):void 0===r?r=n?i.length>3:i.length>2:void 0===n&&(n=r?i.length>3:i.length>2)),{rings:a,spatialReference:t,hasZ:r,hasM:n}}},{key:"cache",get:function(){return this.commitProperty("rings"),this.commitProperty("hasZ"),this.commitProperty("hasM"),this.commitProperty("spatialReference"),{}}},{key:"centroid",get:function(){var e=Object(m.a)(this);if(!e||isNaN(e[0])||isNaN(e[1])||this.hasZ&&isNaN(e[2]))return null;var t=new b.a;return t.x=e[0],t.y=e[1],t.spatialReference=this.spatialReference,this.hasZ&&(t.z=e[2]),t}},{key:"extent",get:function(){var e=this.spatialReference,t=Object(O.b)(this);if(!t)return null;var r=new f.a(t);return r.spatialReference=e,r}},{key:"isSelfIntersecting",get:function(){return Object(j.c)(this.rings)}},{key:"writeRings",value:function(e,t){t.rings=Object(l.a)(this.rings)}},{key:"addRing",value:function(e){if(e){var t=this.rings,r=t.length;if(x(e)){for(var n=[],i=0,a=e.length;i<a;i++)n[i]=e[i].toArray();t[r]=n}else t[r]=e.concat();return this.notifyChange("rings"),this}}},{key:"clone",value:function(){var e=new n;return e.spatialReference=this.spatialReference,e.rings=Object(l.a)(this.rings),e.hasZ=this.hasZ,e.hasM=this.hasM,e}},{key:"contains",value:function(e){return!!e&&(Object(_.a)(e,this.spatialReference)&&(e=Object(_.d)(e,this.spatialReference)),Object(y.g)(this,e))}},{key:"isClockwise",value:function(e){var t,r=this;return t=x(e)?e.map((function(e){return r.hasZ?r.hasM?[e.x,e.y,e.z,e.m]:[e.x,e.y,e.z]:[e.x,e.y]})):e,Object(g.e)(t,this.hasM,this.hasZ)}},{key:"getPoint",value:function(e,t){if(!this._validateInputs(e,t))return null;var r=this.rings[e][t],n=this.hasZ,i=this.hasM;return n&&!i?new b.a(r[0],r[1],r[2],void 0,this.spatialReference):i&&!n?new b.a(r[0],r[1],void 0,r[2],this.spatialReference):n&&i?new b.a(r[0],r[1],r[2],r[3],this.spatialReference):new b.a(r[0],r[1],this.spatialReference)}},{key:"insertPoint",value:function(e,t,r){return this._validateInputs(e,t,!0)?(Object(w.a)(this,r),Array.isArray(r)||(r=r.toArray()),this.rings[e].splice(t,0,r),this.notifyChange("rings"),this):this}},{key:"removePoint",value:function(e,t){if(!this._validateInputs(e,t))return null;var r=new b.a(this.rings[e].splice(t,1)[0],this.spatialReference);return this.notifyChange("rings"),r}},{key:"removeRing",value:function(e){if(!this._validateInputs(e,null))return null;var t=this.rings.splice(e,1)[0],r=this.spatialReference,n=t.map((function(e){return new b.a(e,r)}));return this.notifyChange("rings"),n}},{key:"setPoint",value:function(e,t,r){return this._validateInputs(e,t)?(Object(w.a)(this,r),Array.isArray(r)||(r=r.toArray()),this.rings[e][t]=r,this.notifyChange("rings"),this):this}},{key:"_validateInputs",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(null==e||e<0||e>=this.rings.length)return!1;if(null!=t){var n=this.rings[e];if(r&&(t<0||t>n.length))return!1;if(!r&&(t<0||t>=n.length))return!1}return!0}},{key:"toJSON",value:function(e){return this.write(null,e)}}],[{key:"fromExtent",value:function(e){var t=e.clone().normalize(),r=e.spatialReference,i=!1,a=!1;t.map((function(e){e.hasZ&&(i=!0),e.hasM&&(a=!0)}));var o={rings:t.map((function(e){var t=[[e.xmin,e.ymin],[e.xmin,e.ymax],[e.xmax,e.ymax],[e.xmax,e.ymin],[e.xmin,e.ymin]];if(i&&e.hasZ)for(var r=e.zmin+.5*(e.zmax-e.zmin),n=0;n<t.length;n++)t[n].push(r);if(a&&e.hasM)for(var o=e.mmin+.5*(e.mmax-e.mmin),s=0;s<t.length;s++)t[s].push(o);return t})),spatialReference:r};return i&&(o.hasZ=!0),a&&(o.hasM=!0),new n(o)}}]),r}(p.a);Object(c.a)([Object(u.b)({readOnly:!0})],k.prototype,"cache",null),Object(c.a)([Object(u.b)({readOnly:!0})],k.prototype,"centroid",null),Object(c.a)([Object(u.b)({readOnly:!0})],k.prototype,"extent",null),Object(c.a)([Object(u.b)({readOnly:!0})],k.prototype,"isSelfIntersecting",null),Object(c.a)([Object(u.b)({type:[[[Number]]],json:{write:{isRequired:!0}}})],k.prototype,"rings",void 0),Object(c.a)([Object(h.a)("rings")],k.prototype,"writeRings",null),(k=n=Object(c.a)([Object(d.a)("esri.geometry.Polygon")],k)).prototype.toJSON.isDefaultToJSON=!0;var S=k;t.a=S},function(e,t,r){"use strict";r.d(t,"b",(function(){return O})),r.d(t,"c",(function(){return j}));var n=r(2),i=r(5),a=r(17),o=r(3),s=r(122),c=function(){function e(){for(Object(n.a)(this,e),this._current=new Array,this._max=new Array,this._allocations=new Map;this._current.length<s.b.COUNT;)this._current.push(0),this._max.push(0)}return Object(i.a)(e,[{key:"resetMax",value:function(){for(this._max.length=0;this._max.length<this._current.length;)this._max.push(0)}},{key:"increment",value:function(e,t){var r=++this._current[e];this._max[e]=Math.max(r,this._max[e])}},{key:"decrement",value:function(e,t){--this._current[e]}},{key:"max",get:function(){return this._max}},{key:"current",get:function(){return this._current}},{key:"total",get:function(){return this.current.reduce((function(e,t){return e+t}),0)}},{key:"printResourceCount",value:function(){if(this.total>0){console.log("Live objects:");for(var e=0;e<s.b.COUNT;++e){var t=this._current[e];t>0&&console.log("".concat(s.b[e],": ").concat(t))}}if(this._allocations.size>0){console.log("".concat(this._allocations.size," live object allocations:"));var r=new Map;this._allocations.forEach((function(e){var t;r.set(e,(null!=(t=r.get(e))?t:0)+1)})),r.forEach((function(e,t){return console.log(e," : ",t)}))}}}]),e}(),l=r(41),u=r(60),d=r(157),h=r(13),f=function e(t,r,i,a,o,s,c,l){Object(n.a)(this,e),this.createQuery=t,this.resultAvailable=r,this.getResult=i,this.disjoint=a,this.beginTimeElapsed=o,this.endTimeElapsed=s,this.createTimestamp=c,this.timestampBits=l};function p(e,t){var r,n,i,a,o,s,c,l,u,h,p,v=t.disabledExtensions||{},m=t.debugWebGLExtensions||{},y=null,g=null,O=null,j=null;return{get drawBuffers(){return p||(p=function(e,t){if(t.disjointTimerQuery)return null;if(Object(d.a)(e))return{drawBuffers:e.drawBuffers.bind(e),MAX_DRAW_BUFFERS:e.MAX_DRAW_BUFFERS,MAX_COLOR_ATTACHMENTS:e.MAX_COLOR_ATTACHMENTS};if(t.drawBuffers)return null;var r=e.getExtension("WEBGL_draw_buffers");return r?{drawBuffers:r.drawBuffersWEBGL.bind(r),MAX_DRAW_BUFFERS:r.MAX_DRAW_BUFFERS_WEBGL,MAX_COLOR_ATTACHMENTS:r.MAX_COLOR_ATTACHMENTS_WEBGL}:null}(e,v)),p},get instancing(){return r||(r=function(e){if(Object(d.a)(e))return{drawArraysInstanced:e.drawArraysInstanced.bind(e),drawElementsInstanced:e.drawElementsInstanced.bind(e),vertexAttribDivisor:e.vertexAttribDivisor.bind(e)};var t=e.getExtension("ANGLE_instanced_arrays");return t?{drawArraysInstanced:t.drawArraysInstancedANGLE.bind(t),drawElementsInstanced:t.drawElementsInstancedANGLE.bind(t),vertexAttribDivisor:t.vertexAttribDivisorANGLE.bind(t)}:null}(e)),r},get vao(){return n||(n=function(e,t){if(Object(d.a)(e))return{createVertexArray:e.createVertexArray.bind(e),deleteVertexArray:e.deleteVertexArray.bind(e),bindVertexArray:e.bindVertexArray.bind(e)};if(t.vao)return null;var r=e.getExtension("OES_vertex_array_object")||e.getExtension("MOZ_OES_vertex_array_object")||e.getExtension("WEBKIT_OES_vertex_array_object");return r?{createVertexArray:r.createVertexArrayOES.bind(r),deleteVertexArray:r.deleteVertexArrayOES.bind(r),bindVertexArray:r.bindVertexArrayOES.bind(r)}:null}(e,v)),n},get compressedTextureETC(){return i||(i=function(e,t){if(t.compressedTextureETC)return null;var r=e.getExtension("WEBGL_compressed_texture_etc");return r?{COMPRESSED_R11_EAC:r.COMPRESSED_R11_EAC,COMPRESSED_SIGNED_R11_EAC:r.COMPRESSED_SIGNED_R11_EAC,COMPRESSED_RG11_EAC:r.COMPRESSED_RG11_EAC,COMPRESSED_SIGNED_RG11_EAC:r.COMPRESSED_SIGNED_RG11_EAC,COMPRESSED_RGB8_ETC2:r.COMPRESSED_RGB8_ETC2,COMPRESSED_SRGB8_ETC2:r.COMPRESSED_SRGB8_ETC2,COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2:r.COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2,COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2:r.COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2,COMPRESSED_RGBA8_ETC2_EAC:r.COMPRESSED_RGBA8_ETC2_EAC,COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:r.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC}:null}(e,v)),i},get compressedTextureS3TC(){return a||(a=function(e,t){if(t.compressedTextureS3TC)return null;var r=e.getExtension("WEBGL_compressed_texture_s3tc");return r?{COMPRESSED_RGB_S3TC_DXT1:r.COMPRESSED_RGB_S3TC_DXT1_EXT,COMPRESSED_RGBA_S3TC_DXT1:r.COMPRESSED_RGBA_S3TC_DXT1_EXT,COMPRESSED_RGBA_S3TC_DXT3:r.COMPRESSED_RGBA_S3TC_DXT3_EXT,COMPRESSED_RGBA_S3TC_DXT5:r.COMPRESSED_RGBA_S3TC_DXT5_EXT}:null}(e,v)),a},get textureFilterAnisotropic(){return o||(o=function(e,t){if(t.textureFilterAnisotropic)return null;var r=e.getExtension("EXT_texture_filter_anisotropic")||e.getExtension("MOZ_EXT_texture_filter_anisotropic")||e.getExtension("WEBKIT_EXT_texture_filter_anisotropic");return r?{MAX_TEXTURE_MAX_ANISOTROPY:r.MAX_TEXTURE_MAX_ANISOTROPY_EXT,TEXTURE_MAX_ANISOTROPY:r.TEXTURE_MAX_ANISOTROPY_EXT}:null}(e,v)),o},get disjointTimerQuery(){return s||(s=function(e,t){if(t.disjointTimerQuery)return null;var r=e.getExtension("EXT_disjoint_timer_query_webgl2");return r&&Object(d.a)(e)?new f((function(){return e.createQuery()}),(function(t){return e.getQueryParameter(t,e.QUERY_RESULT_AVAILABLE)}),(function(t){return e.getQueryParameter(t,e.QUERY_RESULT)}),(function(){return e.getParameter(r.GPU_DISJOINT_EXT)}),(function(t){return e.beginQuery(r.TIME_ELAPSED_EXT,t)}),(function(){return e.endQuery(r.TIME_ELAPSED_EXT)}),(function(e){return r.queryCounterEXT(e,r.TIMESTAMP_EXT)}),(function(){return e.getQuery(r.TIMESTAMP_EXT,r.QUERY_COUNTER_BITS_EXT)})):(r=e.getExtension("EXT_disjoint_timer_query"))?new f((function(){return r.createQueryEXT()}),(function(e){return r.getQueryObjectEXT(e,r.QUERY_RESULT_AVAILABLE_EXT)}),(function(e){return r.getQueryObjectEXT(e,r.QUERY_RESULT_EXT)}),(function(){return e.getParameter(r.GPU_DISJOINT_EXT)}),(function(e){return r.beginQueryEXT(r.TIME_ELAPSED_EXT,e)}),(function(){return r.endQueryEXT(r.TIME_ELAPSED_EXT)}),(function(e){return r.queryCounterEXT(e,r.TIMESTAMP_EXT)}),(function(){return r.getQueryEXT(r.TIMESTAMP_EXT,r.QUERY_COUNTER_BITS_EXT)})):null}(e,v)),s},get textureFloat(){return c||(c=function(e,t){if(Object(d.a)(e))return{textureFloat:!0,textureFloatLinear:!t.textureFloatLinear&&!!e.getExtension("OES_texture_float_linear"),textureHalfFloat:!0,textureHalfFloatLinear:!t.textureHalfFloatLinear&&!!e.getExtension("OES_texture_half_float_linear"),HALF_FLOAT:e.HALF_FLOAT};if(e instanceof WebGLRenderingContext){var r=!t.textureHalfFloat&&e.getExtension("OES_texture_half_float");return{textureFloat:!t.textureFloat&&!!e.getExtension("OES_texture_float"),textureFloatLinear:!t.textureFloatLinear&&!!e.getExtension("OES_texture_float_linear"),textureHalfFloat:!!r,textureHalfFloatLinear:!t.textureHalfFloatLinear&&!!e.getExtension("OES_texture_half_float_linear"),HALF_FLOAT:r?r.HALF_FLOAT_OES:void 0}}return null}(e,v)),c},get colorBufferFloat(){return l||(l=function(e,t){if(Object(d.a)(e)){var r=!t.colorBufferFloat&&e.getExtension("EXT_color_buffer_half_float"),n=!t.colorBufferFloat&&e.getExtension("EXT_color_buffer_float"),i=!t.colorBufferFloat&&e.getExtension("EXT_float_blend");return r||n||i?{textureFloat:!!n,textureHalfFloat:!!r,R16F:e.R16F,RG16F:e.RG16F,RGBA16F:e.RGBA16F,R32F:e.R32F,RG32F:e.RG32F,RGBA32F:e.RGBA32F,R11F_G11F_B10F:e.R11F_G11F_B10F,RGB16F:e.RGB16F}:null}if(e instanceof WebGLRenderingContext){var a=!t.colorBufferFloat&&e.getExtension("EXT_color_buffer_half_float"),o=!t.colorBufferFloat&&e.getExtension("WEBGL_color_buffer_float"),s=!t.colorBufferFloat&&e.getExtension("EXT_float_blend");return a||o||s?{textureFloat:!!o,textureHalfFloat:!!a,RGBA16F:a?a.RGBA16F_EXT:void 0,RGB16F:a?a.RGB16F_EXT:void 0,RGBA32F:o?o.RGBA32F_EXT:void 0}:null}return null}(e,v)),l},get blendMinMax(){return u||(u=function(e,t){if(Object(d.a)(e))return{MIN:e.MIN,MAX:e.MAX};if(t.blendMinMax)return null;var r=e.getExtension("EXT_blend_minmax");return r?{MIN:r.MIN_EXT,MAX:r.MAX_EXT}:null}(e,v)),u},get depthTexture(){return null===y&&(y=b(e,v,"depthTexture",!0,["WEBGL_depth_texture","MOZ_WEBGL_depth_texture","WEBKIT_WEBGL_depth_texture"])),y},get standardDerivatives(){return null===g&&(g=b(e,v,"standardDerivatives",!0,["OES_standard_derivatives"])),g},get shaderTextureLOD(){return null===O&&(O=b(e,v,"shaderTextureLOD",!0,["EXT_shader_texture_lod"])),O},get fragDepth(){return null===j&&(j=b(e,v,"fragDepth",!0,["EXT_frag_depth"])),j},get loseContext(){return h||(h=function(e,t){var r=t.loseContext&&e.getExtension("WEBGL_lose_context");return r?{loseRenderingContext:function(){return r.loseContext()}}:null}(e,m)),h},enable:function(e){return this[e]}}}function b(e,t,r,n,i){if(n&&Object(d.a)(e))return!0;if(t[r])return!1;var a,o=Object(h.a)(i);try{for(o.s();!(a=o.n()).done;){var s=a.value;if(e.getExtension(s))return!0}}catch(c){o.e(c)}finally{o.f()}return!1}var v=function(){function e(t){var r=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Object(n.a)(this,e),this.gl=t,this.instanceCounter=new c,this._blendEnabled=!1,this._blendColorState={r:0,g:0,b:0,a:0},this._blendFunctionState={srcRGB:1,dstRGB:0,srcAlpha:1,dstAlpha:0},this._blendEquationState={mode:32774,modeAlpha:32774},this._colorMaskState={r:!0,g:!0,b:!0,a:!0},this._polygonCullingEnabled=!1,this._cullFace=1029,this._frontFace=2305,this._scissorTestEnabled=!1,this._scissorRect={x:0,y:0,width:0,height:0},this._depthTestEnabled=!1,this._depthFunction=513,this._clearDepth=1,this._depthWriteEnabled=!0,this._depthRange={zNear:0,zFar:1},this._viewport=null,this._stencilTestEnabled=!1,this._polygonOffsetFillEnabled=!1,this._polygonOffset=[0,0],this._stencilFunction={face:1032,func:519,ref:0,mask:1},this._clearStencil=0,this._stencilWriteMask=1,this._stencilOperation={face:1032,fail:7680,zFail:7680,zPass:7680},this._clearColor={r:0,g:0,b:0,a:0},this._activeShaderProgram=null,this._activeVertexBuffer=null,this._activeIndexBuffer=null,this._activeFramebuffer=null,this._activeRenderbuffer=null,this._activeTextureUnit=0,this._textureUnitMap=new Array,this._numOfDrawCalls=0,this._numOfTriangles=0,this.webglVersion=Object(d.a)(t)?"webgl2":"webgl",t instanceof WebGLRenderingContext&&this.gl.getExtension("OES_element_index_uint"),this._capabilities=p(t,i),this._parameters=this._loadParameters(i);var a=this.gl.getParameter(this.gl.VIEWPORT);this._viewport={x:a[0],y:a[1],width:a[2],height:a[3]},this._stateTracker=new l.a({setBlending:function(e){if(e){r.setBlendingEnabled(!0),r.setBlendEquationSeparate(e.opRgb,e.opAlpha),r.setBlendFunctionSeparate(e.srcRgb,e.dstRgb,e.srcAlpha,e.dstAlpha);var t=e.color;r.setBlendColor(t.r,t.g,t.b,t.a)}else r.setBlendingEnabled(!1)},setCulling:function(e){e?(r.setFaceCullingEnabled(!0),r.setCullFace(e.face),r.setFrontFace(e.mode)):r.setFaceCullingEnabled(!1)},setPolygonOffset:function(e){e?(r.setPolygonOffsetFillEnabled(!0),r.setPolygonOffset(e.factor,e.units)):r.setPolygonOffsetFillEnabled(!1)},setDepthTest:function(e){e?(r.setDepthTestEnabled(!0),r.setDepthFunction(e.func)):r.setDepthTestEnabled(!1)},setStencilTest:function(e){if(e){r.setStencilTestEnabled(!0);var t=e.function;r.setStencilFunction(t.func,t.ref,t.mask);var n=e.operation;r.setStencilOp(n.fail,n.zFail,n.zPass)}else r.setStencilTestEnabled(!1)},setDepthWrite:function(e){e?(r.setDepthWriteEnabled(!0),r.setDepthRange(e.zNear,e.zFar)):r.setDepthWriteEnabled(!1)},setColorWrite:function(e){e?r.setColorMask(e.r,e.g,e.b,e.a):r.setColorMask(!1,!1,!1,!1)},setStencilWrite:function(e){e?r.setStencilWriteMask(e.mask):r.setStencilWriteMask(0)}}),this.enforceState()}return Object(i.a)(e,[{key:"contextAttributes",get:function(){return this.gl.getContextAttributes()}},{key:"parameters",get:function(){return this._parameters}},{key:"dispose",value:function(){this.bindVAO(null),this.unbindBuffer(34962),this.unbindBuffer(34963),this._textureUnitMap.length=0,O()&&this.instanceCounter.printResourceCount()}},{key:"setPipelineState",value:function(e){this._stateTracker.setPipeline(e)}},{key:"setBlendingEnabled",value:function(e){this._blendEnabled!==e&&(!0===e?this.gl.enable(this.gl.BLEND):this.gl.disable(this.gl.BLEND),this._blendEnabled=e,this._stateTracker.invalidateBlending())}},{key:"externalTextureUnitUpdate",value:function(e,t){for(var r=0;r<e.length;++r)this._textureUnitMap[e[r]]=null;t>=0&&(this._activeTextureUnit=t)}},{key:"externalVertexArrayObjectUpdate",value:function(){var e=this.capabilities.vao;e&&(e.bindVertexArray(null),this._activeVertexArrayObject=null),this._activeVertexBuffer=null,this._activeIndexBuffer=null}},{key:"externalVertexBufferUpdate",value:function(){this._activeVertexBuffer=null}},{key:"externalIndexBufferUpdate",value:function(){this._activeIndexBuffer=null}},{key:"setBlendColor",value:function(e,t,r,n){e===this._blendColorState.r&&t===this._blendColorState.g&&r===this._blendColorState.b&&n===this._blendColorState.a||(this.gl.blendColor(e,t,r,n),this._blendColorState.r=e,this._blendColorState.g=t,this._blendColorState.b=r,this._blendColorState.a=n,this._stateTracker.invalidateBlending())}},{key:"setBlendFunction",value:function(e,t){e===this._blendFunctionState.srcRGB&&t===this._blendFunctionState.dstRGB||(this.gl.blendFunc(e,t),this._blendFunctionState.srcRGB=e,this._blendFunctionState.srcAlpha=e,this._blendFunctionState.dstRGB=t,this._blendFunctionState.dstAlpha=t,this._stateTracker.invalidateBlending())}},{key:"setBlendFunctionSeparate",value:function(e,t,r,n){this._blendFunctionState.srcRGB===e&&this._blendFunctionState.srcAlpha===r&&this._blendFunctionState.dstRGB===t&&this._blendFunctionState.dstAlpha===n||(this.gl.blendFuncSeparate(e,t,r,n),this._blendFunctionState.srcRGB=e,this._blendFunctionState.srcAlpha=r,this._blendFunctionState.dstRGB=t,this._blendFunctionState.dstAlpha=n,this._stateTracker.invalidateBlending())}},{key:"setBlendEquation",value:function(e){this._blendEquationState.mode!==e&&(this.gl.blendEquation(e),this._blendEquationState.mode=e,this._blendEquationState.modeAlpha=e,this._stateTracker.invalidateBlending())}},{key:"setBlendEquationSeparate",value:function(e,t){this._blendEquationState.mode===e&&this._blendEquationState.modeAlpha===t||(this.gl.blendEquationSeparate(e,t),this._blendEquationState.mode=e,this._blendEquationState.modeAlpha=t,this._stateTracker.invalidateBlending())}},{key:"setColorMask",value:function(e,t,r,n){this._colorMaskState.r===e&&this._colorMaskState.g===t&&this._colorMaskState.b===r&&this._colorMaskState.a===n||(this.gl.colorMask(e,t,r,n),this._colorMaskState.r=e,this._colorMaskState.g=t,this._colorMaskState.b=r,this._colorMaskState.a=n,this._stateTracker.invalidateColorWrite())}},{key:"setClearColor",value:function(e,t,r,n){this._clearColor.r===e&&this._clearColor.g===t&&this._clearColor.b===r&&this._clearColor.a===n||(this.gl.clearColor(e,t,r,n),this._clearColor.r=e,this._clearColor.g=t,this._clearColor.b=r,this._clearColor.a=n)}},{key:"setFaceCullingEnabled",value:function(e){this._polygonCullingEnabled!==e&&(!0===e?this.gl.enable(this.gl.CULL_FACE):this.gl.disable(this.gl.CULL_FACE),this._polygonCullingEnabled=e,this._stateTracker.invalidateCulling())}},{key:"setPolygonOffsetFillEnabled",value:function(e){this._polygonOffsetFillEnabled!==e&&(!0===e?this.gl.enable(this.gl.POLYGON_OFFSET_FILL):this.gl.disable(this.gl.POLYGON_OFFSET_FILL),this._polygonOffsetFillEnabled=e,this._stateTracker.invalidatePolygonOffset())}},{key:"setPolygonOffset",value:function(e,t){this._polygonOffset[0]===e&&this._polygonOffset[1]===t||(this._polygonOffset[0]=e,this._polygonOffset[1]=t,this.gl.polygonOffset(e,t),this._stateTracker.invalidatePolygonOffset())}},{key:"setCullFace",value:function(e){this._cullFace!==e&&(this.gl.cullFace(e),this._cullFace=e,this._stateTracker.invalidateCulling())}},{key:"setFrontFace",value:function(e){this._frontFace!==e&&(this.gl.frontFace(e),this._frontFace=e,this._stateTracker.invalidateCulling())}},{key:"setScissorTestEnabled",value:function(e){this._scissorTestEnabled!==e&&(!0===e?this.gl.enable(this.gl.SCISSOR_TEST):this.gl.disable(this.gl.SCISSOR_TEST),this._scissorTestEnabled=e)}},{key:"setScissorRect",value:function(e,t,r,n){this._scissorRect.x===e&&this._scissorRect.y===t&&this._scissorRect.width===r&&this._scissorRect.height===n||(this.gl.scissor(e,t,r,n),this._scissorRect.x=e,this._scissorRect.y=t,this._scissorRect.width=r,this._scissorRect.height=n)}},{key:"setDepthTestEnabled",value:function(e){this._depthTestEnabled!==e&&(!0===e?this.gl.enable(this.gl.DEPTH_TEST):this.gl.disable(this.gl.DEPTH_TEST),this._depthTestEnabled=e,this._stateTracker.invalidateDepthTest())}},{key:"setClearDepth",value:function(e){this._clearDepth!==e&&(this.gl.clearDepth(e),this._clearDepth=e)}},{key:"setDepthFunction",value:function(e){this._depthFunction!==e&&(this.gl.depthFunc(e),this._depthFunction=e,this._stateTracker.invalidateDepthTest())}},{key:"setDepthWriteEnabled",value:function(e){this._depthWriteEnabled!==e&&(this.gl.depthMask(e),this._depthWriteEnabled=e,this._stateTracker.invalidateDepthWrite())}},{key:"setDepthRange",value:function(e,t){this._depthRange.zNear===e&&this._depthRange.zFar===t||(this.gl.depthRange(e,t),this._depthRange.zNear=e,this._depthRange.zFar=t,this._stateTracker.invalidateDepthWrite())}},{key:"setStencilTestEnabled",value:function(e){this._stencilTestEnabled!==e&&(!0===e?this.gl.enable(this.gl.STENCIL_TEST):this.gl.disable(this.gl.STENCIL_TEST),this._stencilTestEnabled=e,this._stateTracker.invalidateStencilTest())}},{key:"setClearStencil",value:function(e){e!==this._clearStencil&&(this.gl.clearStencil(e),this._clearStencil=e)}},{key:"setStencilFunction",value:function(e,t,r){this._stencilFunction.func===e&&this._stencilFunction.ref===t&&this._stencilFunction.mask===r||(this.gl.stencilFunc(e,t,r),this._stencilFunction.face=1032,this._stencilFunction.func=e,this._stencilFunction.ref=t,this._stencilFunction.mask=r,this._stateTracker.invalidateStencilTest())}},{key:"setStencilFunctionSeparate",value:function(e,t,r,n){this._stencilFunction.face===e&&this._stencilFunction.func===t&&this._stencilFunction.ref===r&&this._stencilFunction.mask===n||(this.gl.stencilFuncSeparate(e,t,r,n),this._stencilFunction.face=e,this._stencilFunction.func=t,this._stencilFunction.ref=r,this._stencilFunction.mask=n,this._stateTracker.invalidateStencilTest())}},{key:"setStencilWriteMask",value:function(e){this._stencilWriteMask!==e&&(this.gl.stencilMask(e),this._stencilWriteMask=e,this._stateTracker.invalidateStencilWrite())}},{key:"setStencilOp",value:function(e,t,r){this._stencilOperation.fail===e&&this._stencilOperation.zFail===t&&this._stencilOperation.zPass===r||(this.gl.stencilOp(e,t,r),this._stencilOperation.face=1032,this._stencilOperation.fail=e,this._stencilOperation.zFail=t,this._stencilOperation.zPass=r,this._stateTracker.invalidateStencilTest())}},{key:"setStencilOpSeparate",value:function(e,t,r,n){this._stencilOperation.face===e&&this._stencilOperation.fail===t&&this._stencilOperation.zFail===r&&this._stencilOperation.zPass===n||(this.gl.stencilOpSeparate(e,t,r,n),this._stencilOperation.face=e,this._stencilOperation.face=e,this._stencilOperation.fail=t,this._stencilOperation.zFail=r,this._stencilOperation.zPass=n,this._stateTracker.invalidateStencilTest())}},{key:"setActiveTexture",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=this._activeTextureUnit;return e>=0&&(t||e!==this._activeTextureUnit)&&(this.gl.activeTexture(s.a+e),this._activeTextureUnit=e),r}},{key:"clear",value:function(e){e&&this.gl.clear(e)}},{key:"clearSafe",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:255;e&&(16384&e&&this.setColorMask(!0,!0,!0,!0),256&e&&this.setDepthWriteEnabled(!0),1024&e&&this.setStencilWriteMask(t),this.gl.clear(e))}},{key:"drawArrays",value:function(e,t,r){O()&&(this._numOfDrawCalls++,this._numOfTriangles+=y(e,r)),this.gl.drawArrays(e,t,r)}},{key:"drawElements",value:function(e,t,r,n){O()&&(this._numOfDrawCalls++,this._numOfTriangles+=y(e,t)),this.gl.drawElements(e,t,r,n)}},{key:"logIno",value:function(){O()&&console.log("DrawCalls: ".concat(this._numOfDrawCalls,", Triangles: ").concat(this._numOfTriangles))}},{key:"capabilities",get:function(){return this._capabilities}},{key:"setViewport",value:function(e,t,r,n){r=Math.max(Math.round(r),1),n=Math.max(Math.round(n),1);var i=this._viewport;i.x===e&&i.y===t&&i.width===r&&i.height===n||(i.x=e,i.y=t,i.width=r,i.height=n,this.gl.viewport(e,t,r,n))}},{key:"getViewport",value:function(){return{x:this._viewport.x,y:this._viewport.y,width:this._viewport.width,height:this._viewport.height}}},{key:"useProgram",value:function(e){var t,r;if(!e)return null==(r=this._activeShaderProgram)||r.stop(),this._activeShaderProgram=null,void this.gl.useProgram(null);this._activeShaderProgram!==e&&(null==(t=this._activeShaderProgram)||t.stop(),this._activeShaderProgram=e,this.gl.useProgram(e.glName))}},{key:"bindTexture",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];(t>=this.parameters.maxTextureImageUnits||t<0)&&console.error("Input texture unit is out of range of available units!");var n=this._textureUnitMap[t];return this.setActiveTexture(t,r),Object(o.i)(e)||null==e.glName?(Object(o.j)(n)&&this.gl.bindTexture(n.descriptor.target,null),this._textureUnitMap[t]=null,n):r||n!==e?(this.gl.bindTexture(e.descriptor.target,e.glName),e.applyChanges(),this._textureUnitMap[t]=e,n):(e.applyChanges(),n)}},{key:"unbindTextureAllUnits",value:function(e){for(var t=0;t<this.parameters.maxTextureImageUnits;t++)this._textureUnitMap[t]===e&&(this.bindTexture(null,t),this._textureUnitMap[t]=null)}},{key:"bindFramebuffer",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(Object(o.i)(e))return this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,null),void(this._activeFramebuffer=null);(t||this._activeFramebuffer!==e)&&(e.initializeAndBind(),this._activeFramebuffer=e)}},{key:"bindBuffer",value:function(e){e&&(34962===e.bufferType?this._activeVertexBuffer=m(this.gl,e,e.bufferType,this._activeVertexBuffer):this._activeIndexBuffer=m(this.gl,e,e.bufferType,this._activeIndexBuffer))}},{key:"bindRenderbuffer",value:function(e){var t=this.gl;e||(t.bindRenderbuffer(t.RENDERBUFFER,null),this._activeRenderbuffer=null),this._activeRenderbuffer!==e&&(t.bindRenderbuffer(t.RENDERBUFFER,e.glName),this._activeRenderbuffer=e)}},{key:"unbindBuffer",value:function(e){34962===e?this._activeVertexBuffer=m(this.gl,null,e,this._activeVertexBuffer):this._activeIndexBuffer=m(this.gl,null,e,this._activeIndexBuffer)}},{key:"bindVAO",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;Object(o.i)(e)?this._activeVertexArrayObject&&(this._activeVertexArrayObject.unbind(),this._activeVertexArrayObject=null):this._activeVertexArrayObject!==e&&(e.bind(),this._activeVertexArrayObject=e)}},{key:"getBoundFramebufferObject",value:function(){return this._activeFramebuffer}},{key:"getBoundVAO",value:function(){return this._activeVertexArrayObject}},{key:"resetState",value:function(){this.useProgram(null),this.bindVAO(null),this.bindFramebuffer(null),this.unbindBuffer(34962),this.unbindBuffer(34963);for(var e=0;e<this.parameters.maxTextureImageUnits;++e)this.bindTexture(null,e);this.setBlendingEnabled(!1),this.setBlendFunction(1,0),this.setBlendEquation(32774),this.setBlendColor(0,0,0,0),this.setFaceCullingEnabled(!1),this.setCullFace(1029),this.setFrontFace(2305),this.setPolygonOffsetFillEnabled(!1),this.setPolygonOffset(0,0),this.setScissorTestEnabled(!1),this.setScissorRect(0,0,this.gl.canvas.width,this.gl.canvas.height),this.setDepthTestEnabled(!1),this.setDepthFunction(513),this.setDepthRange(0,1),this.setStencilTestEnabled(!1),this.setStencilFunction(519,0,0),this.setStencilOp(7680,7680,7680),this.setClearColor(0,0,0,0),this.setClearDepth(1),this.setClearStencil(0),this.setColorMask(!0,!0,!0,!0),this.setStencilWriteMask(4294967295),this.setDepthWriteEnabled(!0),this.setViewport(0,0,this.gl.canvas.width,this.gl.canvas.height)}},{key:"enforceState",value:function(){var e=this.gl,t=this.capabilities.vao;t&&t.bindVertexArray(null);for(var r=0;r<this.parameters.maxVertexAttributes;r++)e.disableVertexAttribArray(r);if(this._activeVertexBuffer?e.bindBuffer(this._activeVertexBuffer.bufferType,this._activeVertexBuffer.glName):e.bindBuffer(34962,null),this._activeIndexBuffer?e.bindBuffer(this._activeIndexBuffer.bufferType,this._activeIndexBuffer.glName):e.bindBuffer(34963,null),t&&this._activeVertexArrayObject){var n=this._activeVertexArrayObject;this._activeVertexArrayObject&&(this._activeVertexArrayObject.unbind(),this._activeVertexArrayObject=null),this.bindVAO(n)}e.bindFramebuffer(e.FRAMEBUFFER,this._activeFramebuffer?this._activeFramebuffer.glName:null),e.useProgram(this._activeShaderProgram?this._activeShaderProgram.glName:null),e.blendColor(this._blendColorState.r,this._blendColorState.g,this._blendColorState.b,this._blendColorState.a),e.bindRenderbuffer(e.RENDERBUFFER,this._activeRenderbuffer?this._activeRenderbuffer.glName:null),!0===this._blendEnabled?e.enable(this.gl.BLEND):e.disable(this.gl.BLEND),e.blendEquationSeparate(this._blendEquationState.mode,this._blendEquationState.modeAlpha),e.blendFuncSeparate(this._blendFunctionState.srcRGB,this._blendFunctionState.dstRGB,this._blendFunctionState.srcAlpha,this._blendFunctionState.dstAlpha),e.clearColor(this._clearColor.r,this._clearColor.g,this._clearColor.b,this._clearColor.a),e.clearDepth(this._clearDepth),e.clearStencil(this._clearStencil),e.colorMask(this._colorMaskState.r,this._colorMaskState.g,this._colorMaskState.b,this._colorMaskState.a),e.cullFace(this._cullFace),e.depthFunc(this._depthFunction),e.depthRange(this._depthRange.zNear,this._depthRange.zFar),!0===this._depthTestEnabled?e.enable(e.DEPTH_TEST):e.disable(e.DEPTH_TEST),e.depthMask(this._depthWriteEnabled),e.frontFace(this._frontFace),e.lineWidth(1),!0===this._polygonCullingEnabled?e.enable(e.CULL_FACE):e.disable(e.CULL_FACE),e.polygonOffset(this._polygonOffset[0],this._polygonOffset[1]),!0===this._polygonOffsetFillEnabled?e.enable(e.POLYGON_OFFSET_FILL):e.disable(e.POLYGON_OFFSET_FILL),e.scissor(this._scissorRect.x,this._scissorRect.y,this._scissorRect.width,this._scissorRect.height),!0===this._scissorTestEnabled?e.enable(e.SCISSOR_TEST):e.disable(e.SCISSOR_TEST),e.stencilFunc(this._stencilFunction.func,this._stencilFunction.ref,this._stencilFunction.mask),e.stencilOpSeparate(this._stencilOperation.face,this._stencilOperation.fail,this._stencilOperation.zFail,this._stencilOperation.zPass),!0===this._stencilTestEnabled?e.enable(e.STENCIL_TEST):e.disable(e.STENCIL_TEST),e.stencilMask(this._stencilWriteMask);for(var i=0;i<this.parameters.maxTextureImageUnits;i++){e.activeTexture(s.a+i),e.bindTexture(3553,null),Object(d.a)(e)&&e.bindTexture(32879,null);var a=this._textureUnitMap[i];Object(o.j)(a)&&e.bindTexture(a.descriptor.target,a.glName)}e.activeTexture(s.a+this._activeTextureUnit),e.viewport(this._viewport.x,this._viewport.y,this._viewport.width,this._viewport.height),O()&&(this._numOfDrawCalls=0,this._numOfTriangles=0)}},{key:"_loadParameters",value:function(e){var t,r=this.capabilities.textureFilterAnisotropic,n=null!=(t=e.maxAnisotropy)?t:1/0,i={versionString:this.gl.getParameter(this.gl.VERSION),maxVertexTextureImageUnits:this.gl.getParameter(this.gl.MAX_VERTEX_TEXTURE_IMAGE_UNITS),maxVertexAttributes:this.gl.getParameter(this.gl.MAX_VERTEX_ATTRIBS),maxMaxAnisotropy:r?Math.min(this.gl.getParameter(r.MAX_TEXTURE_MAX_ANISOTROPY),n):1,maxTextureImageUnits:this.gl.getParameter(this.gl.MAX_TEXTURE_IMAGE_UNITS),maxTextureSize:this.gl.getParameter(this.gl.MAX_TEXTURE_SIZE)};return u.a.TEXTURE_UNIT_FOR_UPDATES=i.maxTextureImageUnits-1,i}}]),e}();function m(e,t,r,n){return t?n!==t&&e.bindBuffer(r,t.glName):e.bindBuffer(r,null),t}function y(e,t){switch(e){case 0:return 2*t;case 4:return t/3;case 5:case 6:return t-2;default:return 0}}var g=!!Object(a.a)("enable-feature:webgl-debug");function O(){return g}function j(){return g}t.a=v},function(e,t,r){"use strict";var n=r(2),i=r(5),a=r(6),o=r(7),s=r(0),c=r(27),l=r(1),u=(r(17),r(18),r(15),r(48)),d=r(10),h=r(55),f=function(e){Object(a.a)(r,e);var t=Object(o.a)(r);function r(){var e;Object(n.a)(this,r);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return(e=t.call.apply(t,[this].concat(a))).type=null,e.hasM=!1,e.hasZ=!1,e.spatialReference=h.a.WGS84,e}return Object(i.a)(r,[{key:"cache",get:function(){return this.commitProperty("spatialReference"),{}}},{key:"extent",get:function(){return null}},{key:"readSpatialReference",value:function(e,t){if(e instanceof h.a)return e;if(null!=e){var r=new h.a;return r.read(e,t),r}return e}},{key:"clone",value:function(){return console.warn(".clone() is not implemented for "+this.declaredClass),null}},{key:"clearCache",value:function(){this.notifyChange("cache")}},{key:"getCacheValue",value:function(e){return this.cache[e]}},{key:"setCacheValue",value:function(e,t){this.cache[e]=t}}]),r}(c.a);Object(s.a)([Object(l.b)()],f.prototype,"type",void 0),Object(s.a)([Object(l.b)({readOnly:!0})],f.prototype,"cache",null),Object(s.a)([Object(l.b)({readOnly:!0})],f.prototype,"extent",null),Object(s.a)([Object(l.b)({type:Boolean,json:{write:{overridePolicy:function(e){return{enabled:e}}}}})],f.prototype,"hasM",void 0),Object(s.a)([Object(l.b)({type:Boolean,json:{write:{overridePolicy:function(e){return{enabled:e}}}}})],f.prototype,"hasZ",void 0),Object(s.a)([Object(l.b)({type:h.a,json:{write:!0}})],f.prototype,"spatialReference",void 0),Object(s.a)([Object(u.a)("spatialReference")],f.prototype,"readSpatialReference",null);var p=f=Object(s.a)([Object(d.a)("esri.geometry.Geometry")],f);t.a=p},function(e,t,r){"use strict";var n=r(2),i=r(5),a=r(6),o=r(7),s=r(0),c=r(27),l=r(1),u=(r(17),r(18),r(15),r(10)),d=r(44),h=function(e){Object(a.a)(r,e);var t=Object(o.a)(r);function r(e){var i;return Object(n.a)(this,r),(i=t.call(this,e)).enabled=!0,i.type=null,i}return Object(i.a)(r,[{key:"writeEnabled",value:function(e,t,r){e||(t[r]=e)}}]),r}(c.a);Object(s.a)([Object(l.b)({type:Boolean,json:{read:{source:"enable"},write:{target:"enable"}}})],h.prototype,"enabled",void 0),Object(s.a)([Object(d.a)("enabled")],h.prototype,"writeEnabled",null),Object(s.a)([Object(l.b)({type:["icon","object","line","path","fill","water","extrude","text"],readOnly:!0})],h.prototype,"type",void 0);var f=h=Object(s.a)([Object(u.a)("esri.symbols.Symbol3DLayer")],h);t.a=f},function(e,t,r){"use strict";r.d(t,"a",(function(){return o})),r.d(t,"b",(function(){return c})),r.d(t,"c",(function(){return s}));var n=r(2),i=r(3),a=r(359),o=function e(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;Object(n.a)(this,e),this.array=t,this.spatialReference=r,this.offset=i};function s(e){return"array"in e}function c(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"ground";if(Object(a.a)(t))return e.getElevation(t.x,t.y,t.z||0,t.spatialReference,r);if(s(t)){var n=t.offset;return e.getElevation(t.array[n++],t.array[n++],t.array[n]||0,Object(i.t)(t.spatialReference,e.spatialReference),r)}return e.getElevation(t[0],t[1],t[2]||0,e.spatialReference,r)}},function(e,t,r){"use strict";r.d(t,"a",(function(){return O}));var n=r(13),i=r(2),a=r(5),o=r(6),s=r(7),c=r(3),l=r(26),u=r(31),d=r(4),h=r(9),f=r(70),p=r(85),b=r(247),v=r(336),m=r(354),y=r(46),g=r(136),O=function(e){Object(o.a)(r,e);var t=Object(s.a)(r);function r(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object(i.a)(this,r),(e=t.call(this)).type=1,e._geometryRecords=new Array,e._geometries=new Array,e._objectTransformation=Object(u.d)(),e._bvObjectSpace=new _,e._bvWorldSpace=new _,e._bvDirty=!0,e._hasVolatileTransformation=!1,e._visible=!0,e.castShadow=null==n.castShadow||n.castShadow,e.metadata=n.metadata,e.metadata&&e.metadata.isElevationSource&&(e.metadata.lastValidElevationBB=new j),e.transformation=Object(u.d)();var a=n.geometries,o=n.materials,s=n.transformations,c=n.origins;if(Array.isArray(a)){Object(y.a)(o.length===a.length,"Object3D: materials don't match geometries"),Object(y.a)(s.length===a.length,"Object3D: transformations don't match geometries"),e._geometryRecords.length=a.length,e._geometries.length=a.length;for(var l=0;l<a.length;l++)e._geometries[l]=a[l],e._geometryRecords[l]=v.a.pool.acquire(a[l],o[l],Object(u.c)(s[l]),{highlights:null,occludees:null,visible:!0},c&&c[l])}return e}return Object(a.a)(r,[{key:"geometryRecords",get:function(){return this._geometryRecords}},{key:"geometries",get:function(){return this._geometries}},{key:"transformation",get:function(){return this._objectTransformation},set:function(e){Object(l.d)(this._objectTransformation,e),this._invalidateBoundingVolume(),this._emit("objectTransformation",this)}},{key:"dispose",value:function(){this._geometryRecords.length=0,this._geometries.length=0}},{key:"parentLayer",get:function(){return this._parentLayer},set:function(e){Object(y.a)(null==this._parentLayer||null==e,"Object3D can only be added to a single Layer"),this._parentLayer=e}},{key:"getNumGeometryRecords",value:function(){return this._geometryRecords.length}},{key:"getGeometryRecord",value:function(e){return Object(y.a)(e>=0&&e<this._geometryRecords.length,"Object3d.getGeometryDataByIndex: index out of range"),this._geometryRecords[e]}},{key:"addGeometry",value:function(e,t,r,n,i,a){r=r||u.a,this._geometries.push(e);var o=v.a.pool.acquire(e,t,r,n||{highlights:null,occludees:null,visible:!0},i,a);return this._geometryRecords.push(o),this._hasVolatileTransformation=this._hasVolatileTransformation||Object(c.j)(o.shaderTransformation),this._emit("objectGeometryAdded",{object:this,record:o}),this._invalidateBoundingVolume(),o}},{key:"removeGeometry",value:function(e){var t=this._geometryRecords.splice(e,1)[0];return this._hasVolatileTransformation=Object(c.j)(t.shaderTransformation)?this._geometryRecords.some((function(e){return Object(c.j)(e.shaderTransformation)})):this._hasVolatileTransformation,t.dispose(),this._geometries.splice(e,1),this._emit("objectGeometryRemoved",{object:this,record:t}),this._invalidateBoundingVolume(),t}},{key:"removeAllGeometries",value:function(){for(;this.getNumGeometryRecords()>0;)this.removeGeometry(0)}},{key:"geometryVertexAttrsUpdated",value:function(e){this._emit("vertexAttrsUpdated",{object:this,record:this._geometryRecords[e]}),this._invalidateBoundingVolume()}},{key:"isVisible",get:function(){return this._visible}},{key:"setVisible",value:function(e){this._visible=e;var t,r=Object(n.a)(this._geometryRecords);try{for(r.s();!(t=r.n()).done;){t.value.instanceParameters.visible=this._visible}}catch(i){r.e(i)}finally{r.f()}this._emit("visibilityChanged",this)}},{key:"maskOccludee",value:function(){var e,t=new m.a(1),r=Object(n.a)(this._geometryRecords);try{for(r.s();!(e=r.n()).done;){var i=e.value;i.instanceParameters.occludees=Object(g.b)(i.instanceParameters.occludees,t)}}catch(a){r.e(a)}finally{r.f()}return this._emit("occlusionChanged",this),t}},{key:"removeOcclude",value:function(e){var t,r=Object(n.a)(this._geometryRecords);try{for(r.s();!(t=r.n()).done;){var i=t.value;i.instanceParameters.occludees=Object(g.g)(i.instanceParameters.occludees,e)}}catch(a){r.e(a)}finally{r.f()}this._emit("occlusionChanged",this)}},{key:"highlight",value:function(){var e,t=new m.a(0),r=Object(n.a)(this._geometryRecords);try{for(r.s();!(e=r.n()).done;){var i=e.value;i.instanceParameters.highlights=Object(g.b)(i.instanceParameters.highlights,t)}}catch(a){r.e(a)}finally{r.f()}return this._emit("highlightChanged",this),t}},{key:"removeHighlight",value:function(e){var t,r=Object(n.a)(this._geometryRecords);try{for(r.s();!(t=r.n()).done;){var i=t.value;i.instanceParameters.highlights=Object(g.g)(i.instanceParameters.highlights,e)}}catch(a){r.e(a)}finally{r.f()}this._emit("highlightChanged",this)}},{key:"getCombinedStaticTransformation",value:function(e,t){return Object(l.m)(Object(c.t)(t,Object(u.d)()),this.transformation,e.getStaticTransformation())}},{key:"getCombinedShaderTransformation",value:function(e,t){return t=t||Object(u.d)(),Object(l.m)(t,this.transformation,e.getShaderTransformation()),t}},{key:"hasVolativeTransformation",value:function(){return this._hasVolatileTransformation}},{key:"boundingVolumeWorldSpace",get:function(){return this._validateBoundingVolume(),this._bvWorldSpace}},{key:"boundingVolumeObjectSpace",get:function(){return this._validateBoundingVolume(),this._bvObjectSpace}},{key:"_validateBoundingVolume",value:function(){if(this._bvDirty||this._hasVolatileTransformation){this._bvObjectSpace.init(),this._bvWorldSpace.init();for(var e=0;e<this._geometryRecords.length;++e){var t=this._geometries[e],r=this._geometryRecords[e],n=t.boundingInfo;Object(c.j)(n)&&(this._calculateTransformedBoundingVolume(n,this._bvObjectSpace,r.getShaderTransformation()),this._calculateTransformedBoundingVolume(n,this._bvWorldSpace,this.getCombinedShaderTransformation(r)))}Object(d.k)(this._bvObjectSpace.bounds,this._bvObjectSpace.min,this._bvObjectSpace.max,.5),Object(d.k)(this._bvWorldSpace.bounds,this._bvWorldSpace.min,this._bvWorldSpace.max,.5);for(var i=Object(h.e)(),a=Object(h.e)(),o=Object(p.i)(this.transformation),s=0;s<this._geometryRecords.length;++s){var l=this._geometries[s].boundingInfo;if(!Object(c.i)(l)){var u=this._geometryRecords[s].getShaderTransformation(),f=Object(p.i)(u);Object(d.s)(i,l.getCenter(),u);var b=Object(d.o)(i,this._bvObjectSpace.bounds),v=l.getBSRadius()*f;this._bvObjectSpace.bounds[3]=Math.max(this._bvObjectSpace.bounds[3],b+v),Object(d.s)(a,i,this.transformation);var m=Object(d.o)(a,this._bvWorldSpace.bounds),y=v*o;this._bvWorldSpace.bounds[3]=Math.max(this._bvWorldSpace.bounds[3],m+y)}}this._bvDirty=!1}}},{key:"_calculateTransformedBoundingVolume",value:function(e,t,r){var n=e.getBBMin(),i=e.getBBMax(),a=Object(h.c)(n),o=Object(h.c)(i);Object(d.s)(a,a,r),Object(d.s)(o,o,r);for(var s=0;s<3;++s)t.min[s]=Math.min(t.min[s],a[s],o[s]),t.max[s]=Math.max(t.max[s],a[s],o[s]);for(var c=0;c<3;++c){Object(d.m)(a,n),Object(d.m)(o,i),a[c]=i[c],o[c]=n[c],Object(d.s)(a,a,r),Object(d.s)(o,o,r);for(var l=0;l<3;++l)t.min[l]=Math.min(t.min[l],a[l],o[l]),t.max[l]=Math.max(t.max[l],a[l],o[l])}}},{key:"_invalidateBoundingVolume",value:function(){this._bvDirty=!0,Object(c.j)(this._parentLayer)&&this._parentLayer.notifyObjectBBChanged(this,this._bvWorldSpace.bounds)}},{key:"_emit",value:function(e,t){Object(c.j)(this._parentLayer)&&this._parentLayer.events.emit(e,t)}},{key:"test",get:function(){var e=this;return{hasGeometry:function(t){return e._geometries.indexOf(t)>-1},getGeometryIndex:function(t){return e._geometries.indexOf(t)}}}}]),r}(b.a),j=function(){function e(){Object(i.a)(this,e),this.min=Object(h.g)(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE),this.max=Object(h.g)(-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE)}return Object(a.a)(e,[{key:"isEmpty",value:function(){return this.max[0]<this.min[0]&&this.max[1]<this.min[1]&&this.max[2]<this.min[2]}}]),e}(),_=function(e){Object(o.a)(r,e);var t=Object(s.a)(r);function r(){var e;return Object(i.a)(this,r),(e=t.apply(this,arguments)).bounds=Object(f.c)(),e}return Object(a.a)(r,[{key:"init",value:function(){Object(d.y)(this.min,Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE),Object(d.y)(this.max,-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE),Object(f.a)(this.bounds)}}]),r}(j)},function(e,t,r){"use strict";r.d(t,"a",(function(){return i})),r.d(t,"b",(function(){return o})),r.d(t,"c",(function(){return s})),r.d(t,"d",(function(){return a}));var n=r(3),i=7;function a(e){switch(e){case"defaults":return 0;case"service":return 2;case"portal-item":return 3;case"web-scene":return 4;case"web-map":return 5;case"user":return 6}}function o(e){switch(e){case 0:return"defaults";case 2:return"service";case 3:return"portal-item";case 4:return"web-scene";case 5:return"web-map";case 6:return"user"}return Object(n.d)(void 0)}function s(e){return o(e)}},function(e,t,r){"use strict";r.d(t,"a",(function(){return c})),r.d(t,"b",(function(){return l}));var n=r(3),i=r(138),a={ar:"ar-u-nu-latn"},o=new WeakMap,s={};function c(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t={};return null!=e.digitSeparator&&(t.useGrouping=e.digitSeparator),null!=e.places&&(t.minimumFractionDigits=t.maximumFractionDigits=e.places),t}function l(e,t){return function(e){var t=e||s;if(!o.has(t)){var r=Object(i.b)(),c=a[Object(i.b)()]||r;o.set(t,new Intl.NumberFormat(c,e))}return Object(n.d)(o.get(t))}(t).format(e)}Object(i.a)((function(){o=new WeakMap,s={}}))},function(e,t,r){"use strict";var n=r(2),i=r(5),a=r(45),o=r(42),s=r(6),c=r(7),l=r(0),u=r(58),d=r(25),h=r(28),f=r(1),p=(r(18),r(17),r(15),r(52)),b=r(10),v=function(e){Object(s.a)(r,e);var t=Object(c.a)(r);function r(e){var i;return Object(n.a)(this,r),(i=t.call(this,e)).type="simple-line",i.width=.75,i}return Object(i.a)(r,[{key:"hash",value:function(){return"".concat(this.type,".").concat(this.width)}}]),r}(r(135).a);Object(l.a)([Object(p.a)({esriSLS:"simple-line"},{readOnly:!0})],v.prototype,"type",void 0),Object(l.a)([Object(f.b)({type:Number,cast:h.j,json:{write:!0}})],v.prototype,"width",void 0);var m,y=v=Object(l.a)([Object(b.a)("esri.symbols.LineSymbol")],v),g=r(49),O=r(27),j=r(48),_=r(44),w=m=function(e){Object(s.a)(r,e);var t=Object(c.a)(r);function r(e){var i;return Object(n.a)(this,r),(i=t.call(this,e)).placement="begin-end",i.type="line-marker",i.style="arrow",i}return Object(i.a)(r,[{key:"writeStyle",value:function(e,t,r,n){"web-map"===(null==n?void 0:n.origin)?t[r]="arrow":t[r]=e}},{key:"color",set:function(e){this._set("color",e)}},{key:"readColor",value:function(e){return e&&null!=e[0]?[e[0],e[1],e[2],e[3]/255]:e}},{key:"writeColor",value:function(e,t,r,n){"web-map"===(null==n?void 0:n.origin)||(t[r]=e)}},{key:"clone",value:function(){return new m({color:Object(d.a)(this.color),placement:this.placement,style:this.style})}},{key:"hash",value:function(){var e;return"".concat(this.placement,".").concat(null==(e=this.color)?void 0:e.hash(),".").concat(this.style)}}]),r}(O.a);Object(l.a)([Object(f.b)({type:["begin","end","begin-end"],json:{write:!0}})],w.prototype,"placement",void 0),Object(l.a)([Object(p.a)({"line-marker":"line-marker"},{readOnly:!0}),Object(f.b)({json:{origins:{"web-map":{write:!1}}}})],w.prototype,"type",void 0),Object(l.a)([Object(f.b)({type:["arrow","circle","square","diamond","cross","x"]})],w.prototype,"style",void 0),Object(l.a)([Object(_.a)("style")],w.prototype,"writeStyle",null),Object(l.a)([Object(f.b)({type:g.a,value:null,json:{write:{allowNull:!0}}})],w.prototype,"color",null),Object(l.a)([Object(j.a)("color")],w.prototype,"readColor",null),Object(l.a)([Object(_.a)("color")],w.prototype,"writeColor",null);var x,k=w=m=Object(l.a)([Object(b.a)("esri.symbols.LineSymbolMarker")],w),S=new u.a({esriSLSSolid:"solid",esriSLSDash:"dash",esriSLSDot:"dot",esriSLSDashDot:"dash-dot",esriSLSDashDotDot:"long-dash-dot-dot",esriSLSNull:"none",esriSLSInsideFrame:"inside-frame",esriSLSShortDash:"short-dash",esriSLSShortDot:"short-dot",esriSLSShortDashDot:"short-dash-dot",esriSLSShortDashDotDot:"short-dash-dot-dot",esriSLSLongDash:"long-dash",esriSLSLongDashDot:"long-dash-dot"}),T=x=function(e){Object(s.a)(r,e);var t=Object(c.a)(r);function r(){var e;Object(n.a)(this,r);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return(e=t.call.apply(t,[this].concat(a))).type="simple-line",e.style="solid",e.cap="round",e.join="round",e.marker=null,e.miterLimit=2,e}return Object(i.a)(r,[{key:"normalizeCtorArgs",value:function(e,t,r,n,i,a){if(e&&"string"!=typeof e)return e;var o={};return null!=e&&(o.style=e),null!=t&&(o.color=t),null!=r&&(o.width=Object(h.j)(r)),null!=n&&(o.cap=n),null!=i&&(o.join=i),null!=a&&(o.miterLimit=Object(h.j)(a)),o}},{key:"clone",value:function(){var e;return new x({color:Object(d.a)(this.color),style:this.style,width:this.width,cap:this.cap,join:this.join,miterLimit:this.miterLimit,marker:null==(e=this.marker)?void 0:e.clone()})}},{key:"hash",value:function(){var e,t;return"".concat(Object(a.a)(Object(o.a)(r.prototype),"hash",this).call(this),".").concat(null==(e=this.color)?void 0:e.hash(),".").concat(this.style,".").concat(this.cap,".").concat(this.join,".").concat(this.miterLimit,".").concat(null==(t=this.marker)?void 0:t.hash())}}]),r}(y);Object(l.a)([Object(p.a)({esriSLS:"simple-line"},{readOnly:!0})],T.prototype,"type",void 0),Object(l.a)([Object(f.b)({type:S.apiValues,json:{read:S.read,write:S.write}})],T.prototype,"style",void 0),Object(l.a)([Object(f.b)({type:["butt","round","square"],json:{write:{overridePolicy:function(e,t,r){return{enabled:"round"!==e&&(null==r||null==r.origin)}}}}})],T.prototype,"cap",void 0),Object(l.a)([Object(f.b)({type:["miter","round","bevel"],json:{write:{overridePolicy:function(e,t,r){return{enabled:"round"!==e&&(null==r||null==r.origin)}}}}})],T.prototype,"join",void 0),Object(l.a)([Object(f.b)({types:{key:"type",base:null,defaultKeyValue:"line-marker",typeMap:{"line-marker":k}},json:{write:!0,origins:{"web-scene":{write:!1}}}})],T.prototype,"marker",void 0),Object(l.a)([Object(f.b)({type:Number,json:{read:!1,write:!1}})],T.prototype,"miterLimit",void 0);var C=T=x=Object(l.a)([Object(b.a)("esri.symbols.SimpleLineSymbol")],T);t.a=C},function(e,t,r){"use strict";r.d(t,"a",(function(){return v}));var n=r(8),i=r.n(n),a=r(16),o=r(13),s=r(2),c=r(5),l=r(3),u=r(4),d=r(9),h=r(34),f=r(70),p=r(233),b=r(105),v=function(){function e(t,r,n,i,a,o,c){var l=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null;Object(s.a)(this,e),this.graphics3DSymbolLayer=t,this.stageObject=r,this._uniqueGeometries=n,this._uniqueMaterials=i,this._uniqueTextures=a,this.elevationAligner=o,this.elevationContext=c,this._edgeState=l,this.type="object3d",this.stageLayer=null,this.stage=null,this._visible=!1,this._addedToStage=!1,this.alignedSampledElevation=0,this.needsElevationUpdates=!1,this.useObjectOriginAsAttachmentOrigin=!1,this.graphics3DSymbolLayer=t,this.stageObject=r}return Object(c.a)(e,[{key:"isElevationSource",get:function(){return!(!this.stageObject.metadata||!this.stageObject.metadata.isElevationSource)}},{key:"initialize",value:function(e,t){this.stageLayer=t,this.stage=e,e.addMany(this._uniqueMaterials),e.addMany(this._uniqueGeometries),e.addMany(this._uniqueTextures),e.add(this.stageObject)}},{key:"destroy",value:function(){var e=this.stage;this.stageLayer&&(e.removeMany(this._uniqueMaterials),e.removeMany(this._uniqueGeometries),e.removeMany(this._uniqueTextures)),e.remove(this.stageObject),this._addedToStage&&(this.stageLayer.remove(this.stageObject),this._addedToStage=!1);var t=this.stage.renderView.ensureEdgeView();t.hasObject(this.stageObject)&&t.removeObject(this.stageObject),this.stageObject.dispose(),this._visible=!1,this.stageLayer=null,this.stage=null}},{key:"layerOpacityChanged",value:function(e,t){if(!Object(l.i)(this._edgeState)){var r,n=m(this._edgeState.baseMaterial),i=!1,a=Object(o.a)(this._edgeState.edgeMaterials);try{for(a.s();!(r=a.n()).done;){var s=r.value;s.objectTransparency!==n&&(s.objectTransparency=n,i=!0)}}catch(c){a.e(c)}finally{a.f()}i&&this.resetEdgeObject(t),this.stage.renderView.ensureEdgeView().updateAllComponentOpacities(this.stageObject,[e])}}},{key:"slicePlaneEnabledChanged",value:function(e,t){Object(l.i)(this._edgeState)||(this.stage.renderView.ensureEdgeView().updateAllComponentMaterials(this.stageObject,this._edgeState.edgeMaterials,{slicePlaneEnabled:e},!t),this._edgeState.properties.slicePlaneEnabled=e)}},{key:"setVisibility",value:function(e){if(null!=this.stage&&this._visible!==e&&(this._visible=e,this._visible?this._addedToStage?this.stageObject.setVisible(!0):(this.stageLayer.add(this.stageObject),this._addedToStage=!0):this.stageObject.setVisible(!1),Object(l.j)(this._edgeState))){var t=this.stage.renderView.ensureEdgeView();t.hasObject(this.stageObject)?t.updateObjectVisibility(this.stageObject,e):e&&this.addOrUpdateEdgeObject(t,!1)}}},{key:"visible",get:function(){return this._visible}},{key:"alignWithElevation",value:function(e,t,r,n){if(null!=this.elevationAligner){Object(l.j)(r)&&Object(p.g)(this.elevationContext.featureExpressionInfoContext,r);var i=this.elevationAligner(this,this.elevationContext,e,t);null!=i&&(this.alignedSampledElevation=i),this.resetEdgeObject(n)}}},{key:"getCenterObjectSpace",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Object(d.e)();return Object(u.m)(e,Object(f.g)(this.stageObject.boundingVolumeObjectSpace.bounds))}},{key:"getBoundingBoxObjectSpace",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Object(h.h)(),t=this.stageObject.boundingVolumeObjectSpace;return Object(h.D)(e,t.min),Object(h.C)(e,t.max),e}},{key:"computeAttachmentOrigin",value:function(e){if(this.useObjectOriginAsAttachmentOrigin){var t=this.stageObject.transformation;e.render.origin[0]+=t[12],e.render.origin[1]+=t[13],e.render.origin[2]+=t[14],e.render.num++}else{var r,n=Object(o.a)(this.stageObject.geometryRecords);try{for(n.s();!(r=n.n()).done;){r.value.computeAttachmentOrigin(O)&&(Object(u.s)(O,O,this.stageObject.transformation),Object(u.h)(e.render.origin,e.render.origin,O),e.render.num++)}}catch(i){n.e(i)}finally{n.f()}}}},{key:"getProjectedBoundingBox",value:function(){var e=Object(a.a)(i.a.mark((function e(t,r,n,a,o){var s,c,d,f,p,v,m,_,w,x,k;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(s=this.getBoundingBoxObjectSpace(o),c=j,d=Object(h.x)(s)?1:c.length,f=0;f<d;f++)p=c[f],g[0]=s[p[0]],g[1]=s[p[1]],g[2]=s[p[2]],Object(u.s)(g,g,this.stageObject.transformation),y[3*f+0]=g[0],y[3*f+1]=g[1],y[3*f+2]=g[2];if(t(y,0,d)){e.next=4;break}return e.abrupt("return",null);case 4:for(Object(h.k)(s),v=null,this.calculateRelativeScreenBounds&&(v=this.calculateRelativeScreenBounds()),m=0;m<3*d;m+=3){for(_=0;_<3;_++)s[_]=Math.min(s[_],y[m+_]),s[_+3]=Math.max(s[_+3],y[m+_]);v&&n.push({location:y.slice(m,m+3),screenSpaceBoundingRect:v})}if(!r||!r.service||"absolute-height"===this.elevationContext.mode){e.next=28;break}if(Object(h.e)(s,O),w="relative-to-scene"===this.elevationContext.mode?"scene":"ground",x=0,!r.useViewElevation){e.next=16;break}x=Object(l.t)(r.service.getElevation(O[0],O[1],w),0),e.next=27;break;case 16:return e.prev=16,k=Object(b.d)(s,r),e.t0=l.t,e.next=21,r.service.queryElevation(O[0],O[1],a,k,w);case 21:e.t1=e.sent,x=(0,e.t0)(e.t1,0),e.next=27;break;case 25:e.prev=25,e.t2=e.catch(16);case 27:Object(h.z)(s,0,0,-this.alignedSampledElevation+x);case 28:return e.abrupt("return",s);case 29:case"end":return e.stop()}}),e,this,[[16,25]])})));return function(t,r,n,i,a){return e.apply(this,arguments)}}()},{key:"addObjectState",value:function(e,t){0===e&&t.addObject(this.stageObject,this.stageObject.highlight()),1===e&&t.addObject(this.stageObject,this.stageObject.maskOccludee())}},{key:"removeObjectState",value:function(e){e.removeObject(this.stageObject)}},{key:"resetEdgeObject",value:function(e){if(!Object(l.i)(this._edgeState)){var t=this.stage.renderView.ensureEdgeView();this._visible?this.addOrUpdateEdgeObject(t,e):t.removeObject(this.stageObject)}}},{key:"addOrUpdateEdgeObject",value:function(e,t){var r=this,n=this._edgeState;if(!Object(l.i)(n)){var i,a=m(n.baseMaterial),s=Object(o.a)(n.edgeMaterials);try{for(s.s();!(i=s.n()).done;){i.value.objectTransparency=a}}catch(c){s.e(c)}finally{s.f()}e.addOrUpdateObject3D(this.stageObject,n.edgeMaterials,n.properties,!t).then((function(){var e;return null==(e=r.stageLayer)?void 0:e.sync()}))}}}]),e}();function m(e){return e.isVisible?e.params.transparent?1:2:0}var y=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],g=Object(d.e)(),O=Object(d.e)(),j=[[0,1,2],[3,1,2],[0,4,2],[3,4,2],[0,1,5],[3,1,5],[0,4,5],[3,4,5]]},function(e,t,r){"use strict";r.d(t,"a",(function(){return c})),r.d(t,"b",(function(){return i})),r.d(t,"c",(function(){return a})),r.d(t,"d",(function(){return o}));var n=r(13);function i(e){return e&&("function"==typeof e.on||"function"==typeof e.addEventListener)}function a(e,t,r){if(!i(e))throw new TypeError("target is not a Evented or EventTarget object");if("on"in e)return e.on(t,r);if(Array.isArray(t)){var a,o=t.slice(),s=Object(n.a)(o);try{for(s.s();!(a=s.n()).done;){var c=a.value;e.addEventListener(c,r)}}catch(l){s.e(l)}finally{s.f()}return{remove:function(){var t,i=Object(n.a)(o);try{for(i.s();!(t=i.n()).done;){var a=t.value;e.removeEventListener(a,r)}}catch(l){i.e(l)}finally{i.f()}}}}return e.addEventListener(t,r),{remove:function(){e.removeEventListener(t,r)}}}function o(e,t,r){if(!i(e))throw new TypeError("target is not a Evented or EventTarget object");if("once"in e)return e.once(t,r);var n=a(e,t,(function(t){n.remove(),r.call(e,t)}));return{remove:function(){n.remove()}}}var s={Win:"Meta",Scroll:"ScrollLock",Spacebar:" ",Down:"ArrowDown",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Del:"Delete",Apps:"ContextMenu",Esc:"Escape",Multiply:"*",Add:"+",Subtract:"-",Decimal:".",Divide:"/"};function c(e){var t=e.key;return s[t]||t}},function(e,t,r){"use strict";r.d(t,"a",(function(){return l})),r.d(t,"b",(function(){return u})),r.d(t,"c",(function(){return c})),r.d(t,"d",(function(){return s})),r.d(t,"e",(function(){return o})),r.d(t,"f",(function(){return f})),r.d(t,"g",(function(){return h}));var n=r(33),i=r(13),a=[0,0];function o(e,t){return d(e,t.x,t.y,t.z)}function s(e,t){if(!t.points||t.points.length)return!1;var r,n=Object(i.a)(t.points);try{for(n.s();!(r=n.n()).done;){if(!l(e,r.value))return!1}}catch(a){n.e(a)}finally{n.f()}return!0}function c(e,t){var r=t.xmin,n=t.ymin,i=t.zmin,a=t.xmax,o=t.ymax,s=t.zmax;return e.hasZ&&t.hasZ?d(e,r,n,i)&&d(e,r,o,i)&&d(e,a,o,i)&&d(e,a,n,i)&&d(e,r,n,s)&&d(e,r,o,s)&&d(e,a,o,s)&&d(e,a,n,s):d(e,r,n)&&d(e,r,o)&&d(e,a,o)&&d(e,a,n)}function l(e,t){return d(e,t[0],t[1])}function u(e,t){return d(e,t[0],t[1],t[2])}function d(e,t,r,n){return t>=e.xmin&&t<=e.xmax&&r>=e.ymin&&r<=e.ymax&&(null==n||!e.hasZ||n>=e.zmin&&n<=e.zmax)}function h(e,t){return a[1]=t.y,a[0]=t.x,f(e,a)}function f(e,t){return function(e,t){if(!e)return!1;if(function(e){return!Array.isArray(e[0][0])}(e))return p(!1,e,t);for(var r=!1,n=0,i=e.length;n<i;n++)r=p(r,e[n],t);return r}(e.rings,t)}function p(e,t,r){for(var i=Object(n.a)(r,2),a=i[0],o=i[1],s=e,c=0,l=0,u=t.length;l<u;l++){++c===u&&(c=0);var d=Object(n.a)(t[l],2),h=d[0],f=d[1],p=Object(n.a)(t[c],2),b=p[0],v=p[1];(f<o&&v>=o||v<o&&f>=o)&&h+(o-f)/(v-f)*(b-h)<a&&(s=!s)}return s}},function(e,t,r){"use strict";r.d(t,"a",(function(){return a})),r.d(t,"b",(function(){return d})),r.d(t,"c",(function(){return l})),r.d(t,"d",(function(){return u})),r.d(t,"e",(function(){return o})),r.d(t,"f",(function(){return s}));var n=r(142),i=r(108),a=Object(i.a)().vec3f("position").u16("componentIndex").u16("u16padding"),o=Object(i.a)().vec2u8("sideness"),s=Object(n.a)(o),c=Object(i.a)().vec3f("position0").vec3f("position1").u16("componentIndex").u8("variantOffset",{glNormalized:!0}).u8("variantStroke").u8("variantExtension",{glNormalized:!0}).u8("u8padding",{glPadding:!0}).u16("u16padding",{glPadding:!0}),l=c.clone().vec3f("normal"),u=c.clone().vec3f("normalA").vec3f("normalB"),d=new Map([["position0",0],["position1",1],["componentIndex",2],["variantOffset",3],["variantStroke",4],["variantExtension",5],["normal",6],["normalA",6],["normalB",7],["sideness",8]])},function(e,t,r){"use strict";var n,i,a=r(4),o=r(73),s=r(9),c=r(37),l=r(79);(i=n||(n={})).length=function(e,t){var r=e[t],n=e[t+1],i=e[t+2];return Math.sqrt(r*r+n*n+i*i)},i.normalize=function(e,t){var r=e[t],n=e[t+1],i=e[t+2],a=1/Math.sqrt(r*r+n*n+i*i);e[t]*=a,e[t+1]*=a,e[t+2]*=a},i.scale=function(e,t,r){e[t]*=r,e[t+1]*=r,e[t+2]*=r},i.add=function(e,t,r,n,i){var a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:t;(i=i||e)[a]=e[t]+r[n],i[a+1]=e[t+1]+r[n+1],i[a+2]=e[t+2]+r[n+2]},i.subtract=function(e,t,r,n,i){var a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:t;(i=i||e)[a]=e[t]-r[n],i[a+1]=e[t+1]-r[n+1],i[a+2]=e[t+2]-r[n+2]};var u,d,h,f,p=r(115),b=r(150),v=r(46),m=n;!function(e){for(var t=.5,r=[[-t,-t,t],[t,-t,t],[t,t,t],[-t,t,t],[-t,-t,-t],[t,-t,-t],[t,t,-t],[-t,t,-t]],n=[0,0,1,-1,0,0,1,0,0,0,-1,0,0,1,0,0,0,-1],i=[0,0,1,0,1,1,0,1],a=new Uint16Array([0,1,2,2,3,0,4,0,3,3,7,4,1,5,6,6,2,1,1,0,4,4,5,1,3,2,6,6,7,3,5,4,7,7,6,5]),o=new Uint16Array(36),s=0;s<6;s++)for(var c=0;c<6;c++)o[6*s+c]=s;for(var l=new Uint16Array(36),u=0;u<6;u++)l[6*u+0]=0,l[6*u+1]=1,l[6*u+2]=2,l[6*u+3]=2,l[6*u+4]=3,l[6*u+5]=0;e.createGeometry=function(e){Array.isArray(e)||(e=[e,e,e]);for(var t=new Array(24),s=0;s<8;s++)t[3*s]=r[s][0]*e[0],t[3*s+1]=r[s][1]*e[1],t[3*s+2]=r[s][2]*e[2];return new p.a([["position",{size:3,data:t,exclusive:!0}],["normal",{size:3,data:n}],["uv0",{size:2,data:i}]],[["position",a],["normal",o],["uv0",l]])}}(u||(u={})),function(e){var t=.5,r=[[-t,0,-t],[t,0,-t],[t,0,t],[-t,0,t],[0,-t,0],[0,t,0]],n=[0,1,-1,1,1,0,0,1,1,-1,1,0,0,-1,-1,1,-1,0,0,-1,1,-1,-1,0],i=new Uint16Array([5,1,0,5,2,1,5,3,2,5,0,3,4,0,1,4,1,2,4,2,3,4,3,0]),a=new Uint16Array([0,0,0,1,1,1,2,2,2,3,3,3,4,4,4,5,5,5,6,6,6,7,7,7]);e.createGeometry=function(e){Array.isArray(e)||(e=[e,e,e]);for(var t=new Array(18),o=0;o<6;o++)t[3*o]=r[o][0]*e[0],t[3*o+1]=r[o][1]*e[1],t[3*o+2]=r[o][2]*e[2];return new p.a([["position",{size:3,data:t,exclusive:!0}],["normal",{size:3,data:n}]],[["position",i],["normal",a]])}}(d||(d={})),function(e){var t=.5,r=Object(o.d)(-t,0,-t),n=Object(o.d)(t,0,-t),i=Object(o.d)(0,0,t),s=Object(o.d)(0,.5,0),c=Object(o.c)(),l=Object(o.c)(),u=Object(o.c)(),d=Object(o.c)(),h=Object(o.c)();Object(a.l)(c,r,s),Object(a.l)(l,r,n),Object(a.i)(u,c,l),Object(a.t)(u,u),Object(a.l)(c,n,s),Object(a.l)(l,n,i),Object(a.i)(d,c,l),Object(a.t)(d,d),Object(a.l)(c,i,s),Object(a.l)(l,i,r),Object(a.i)(h,c,l),Object(a.t)(h,h);var f=[r,n,i,s],b=[0,-1,0,u[0],u[1],u[2],d[0],d[1],d[2],h[0],h[1],h[2]],v=[0,1,2,3,1,0,3,2,1,3,0,2],m=[0,0,0,1,1,1,2,2,2,3,3,3];e.createGeometry=function(e){Array.isArray(e)||(e=[e,e,e]);for(var t=new Array(12),r=0;r<4;r++)t[3*r]=f[r][0]*e[0],t[3*r+1]=f[r][1]*e[1],t[3*r+2]=f[r][2]*e[2];return new p.a([["position",{size:3,data:t,exclusive:!0}],["normal",{size:3,data:b}]],[["position",new Uint16Array(v)],["normal",new Uint16Array(m)]])}}(h||(h={})),function(e){e.createBoxGeometry=u.createGeometry,e.createDiamondGeometry=d.createGeometry,e.createTetrahedronGeometry=h.createGeometry,e.createSphereGeometry=function(e,t,r){for(var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{uv:!0},i=-Math.PI,a=2*Math.PI,o=-Math.PI/2,s=Math.PI,c=Math.max(3,Math.floor(t)),l=Math.max(2,Math.floor(r)),u=(c+1)*(l+1),d=new Float32Array(3*u),h=new Float32Array(3*u),f=new Float32Array(2*u),b=[],v=0,m=0;m<=l;m++){for(var y=[],g=m/l,O=o+g*s,j=Math.cos(O),_=0;_<=c;_++){var w=_/c,x=i+w*a,k=Math.cos(x)*j,S=Math.sin(O),T=-Math.sin(x)*j;d[3*v]=k*e,d[3*v+1]=S*e,d[3*v+2]=T*e,h[3*v]=k,h[3*v+1]=S,h[3*v+2]=T,f[2*v]=w,f[2*v+1]=g,y.push(v),++v}b.push(y)}var C=new Uint32Array(2*c*(l-1)*3);v=0;for(var M=0;M<l;M++)for(var P=0;P<c;P++){var A=b[M][P],E=b[M][P+1],R=b[M+1][P+1],I=b[M+1][P];0===M?(C[v++]=A,C[v++]=R,C[v++]=I):M===l-1?(C[v++]=A,C[v++]=E,C[v++]=R):(C[v++]=A,C[v++]=E,C[v++]=R,C[v++]=R,C[v++]=I,C[v++]=A)}var D=[["position",C],["normal",C]],F=[["position",{size:3,data:d,exclusive:!0}],["normal",{size:3,data:h,exclusive:!0}]];return n.uv&&(F.push(["uv0",{size:2,data:f,exclusive:!0}]),D.push(["uv0",C])),n.offset&&(D[0][0]="offset",F[0][0]="offset",D.push(["position",new Uint32Array(C.length)]),F.push(["position",{size:3,data:Float64Array.from(n.offset),exclusive:!0}])),new p.a(F,D)},e.createPolySphereGeometry=function(e,t,r){var n,i,a=e;if(r)n=[0,-1,0,1,0,0,0,0,1,-1,0,0,0,0,-1,0,1,0],i=new Uint32Array([0,1,2,0,2,3,0,3,4,0,4,1,1,5,2,2,5,3,3,5,4,4,5,1]);else{var o=a*(1+Math.sqrt(5))/2;n=[-a,o,0,a,o,0,-a,-o,0,a,-o,0,0,-a,o,0,a,o,0,-a,-o,0,a,-o,o,0,-a,o,0,a,-o,0,-a,-o,0,a],i=new Uint32Array([0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1])}for(var s=0;s<n.length;s+=3)m.scale(n,s,e/m.length(n,s));var c={};function l(t,r){var i;t>r&&(t=(i=[r,t])[0],r=i[1]);var a=t.toString()+"."+r.toString();if(c[a])return c[a];var o=n.length;return n.length+=3,m.add(n,3*t,n,3*r,n,o),m.scale(n,o,e/m.length(n,o)),o/=3,c[a]=o,o}for(var u=0;u<t;u++){for(var d=i.length,h=new Uint32Array(4*d),f=0;f<d;f+=3){var b=i[f],v=i[f+1],y=i[f+2],g=l(b,v),O=l(v,y),j=l(y,b),_=4*f;h[_]=b,h[_+1]=g,h[_+2]=j,h[_+3]=v,h[_+4]=O,h[_+5]=g,h[_+6]=y,h[_+7]=j,h[_+8]=O,h[_+9]=g,h[_+10]=O,h[_+11]=j}i=h,c={}}for(var w=new Float32Array(n),x=0;x<w.length;x+=3)m.normalize(w,x);var k=[["position",i],["normal",i]],S=[["position",{size:3,data:new Float32Array(n),exclusive:!0}],["normal",{size:3,data:w,exclusive:!0}]];return new p.a(S,k)},e.createPointGeometry=function(e,t,r,n,i,a,o){var s=t?[t[0],t[1],t[2]]:[0,0,0],c=e?[e[0],e[1],e[2]]:[0,0,1];a=a||[0,0];var l=r?[255*r[0],255*r[1],255*r[2],r.length>3?255*r[3]:255]:[255,255,255,255],u=null!=n&&2===n.length?n:[1,1],d=[["position",{size:3,data:s,exclusive:!0}],["normal",{size:3,data:c,exclusive:!0}],["uv0",{size:a.length,data:a}],["color",{size:4,data:l,exclusive:!0}],["size",{size:2,data:u}]];if(null!=i){var h=new Float32Array([i[0],i[1],i[2],i[3]]);d.push(["auxpos1",{size:4,data:h}])}if(null!=o){var f=new Float32Array([o[0],o[1],o[2],o[3]]);d.push(["auxpos2",{size:4,data:f}])}return new p.a(d,null,1)},e.updatePointGeometry=function(e,t,r,n,i,a,o,s){if(null!=e){var c=s.getMutableAttribute("normal").data;c[0]=e[0],c[1]=e[1],c[2]=e[2]}if(null!=t){var l=s.getMutableAttribute("position").data;l[0]=t[0],l[1]=t[1],l[2]=t[2]}if(null!=r){var u=s.getMutableAttribute("color").data;u[0]=r[0],u[1]=r[1],u[2]=r[2],u[3]=r[3]}if(null!=n){var d=s.getMutableAttribute("size").data;d[0]=n[0],d[1]=n[1]}if(null!=i){var h=s.getMutableAttribute("auxpos1").data;h[0]=i[0],h[1]=i[1],h[2]=i[2],h[3]=i[3]}if(null!=a){var f=s.getMutableAttribute("uv0").data;f[0]=a[0],f[1]=a[1]}if(null!=o){var p=s.getMutableAttribute("auxpos2").data;p[0]=o[0],p[1]=o[1],p[2]=o[2],p[3]=o[3]}},e.createPointArrayGeometry=function(e,t){for(var r=new Float32Array(3*e.length),n=new Float32Array(t?3*e.length:3),i=new Uint32Array(e.length),a=new Uint32Array(e.length),o=0;o<e.length;o++)r[3*o]=e[o][0],r[3*o+1]=e[o][1],r[3*o+2]=e[o][2],t&&(n[3*o]=t[o][0],n[3*o+1]=t[o][1],n[3*o+2]=t[o][2]),i[o]=o,a[o]=0;return t||(n[0]=0,n[1]=1,n[2]=0),new p.a([["position",{size:3,data:r,exclusive:!0}],["normal",{size:3,data:n,exclusive:!0}],["uv0",{size:2,data:[0,0],exclusive:!0}]],[["position",i],["normal",t?i:a],["uv0",a]],1)},e.createTriangleGeometry=function(){var e=new Uint16Array([0,1,2]),t=new Uint16Array([0,0,0]),r=new Uint16Array([0,0,0]);return new p.a([["position",{size:3,data:[0,0,0,0,0,100,100,0,0],exclusive:!0}],["normal",{size:3,data:[0,1,0],exclusive:!0}],["uv0",{size:2,data:[0,0],exclusive:!0}]],[["position",e],["normal",t],["uv0",r]])};var t=[[-1,-1,0],[1,-1,0],[1,1,0],[-1,1,0]];function r(e,t,r,n,i){return!(Math.abs(Object(a.j)(t,e))>i)&&(Object(a.i)(r,e,t),Object(a.t)(r,r),Object(a.i)(n,r,e),Object(a.t)(n,n),!0)}function n(e,t,n,i,a,o,s){return r(e,t,a,o,s)||r(e,n,a,o,s)||r(e,i,a,o,s)}e.createSquareGeometry=function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:t,r=new Array(12),n=0;n<4;n++)for(var i=0;i<3;i++)r[3*n+i]=e[n][i];var a=new Uint32Array([0,1,2,2,3,0]),o=[0,0,1],s=new Uint32Array([0,0,0,0,0,0]);return new p.a([["position",{size:3,data:r,exclusive:!0}],["normal",{size:3,data:o,exclusive:!0}],["uv0",{size:2,data:[0,0,1,0,1,1,0,1],exclusive:!0}],["color",{size:4,data:[255,255,255,255],exclusive:!0}]],[["position",a],["normal",s],["uv0",a],["color",s]])},e.createConeGeometry=function(e,t,r,n){var i=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],a=!(arguments.length>5&&void 0!==arguments[5])||arguments[5],s=0,c=t,l=e,u=Object(o.d)(0,s,0),d=Object(o.d)(0,s+l,0),h=Object(o.d)(0,-1,0),f=Object(o.d)(0,1,0);n&&(s=l,d=Object(o.d)(0,0,0),u=Object(o.d)(0,s,0),h=Object(o.d)(0,1,0),f=Object(o.d)(0,-1,0));var b=[d,u],v=[h,f],m=r+2,y=Math.sqrt(l*l+c*c);if(n)for(var g=r-1;g>=0;g--){var O=g*(2*Math.PI/r),j=Object(o.d)(Math.cos(O)*c,s,Math.sin(O)*c);b.push(j);var _=Object(o.d)(l*Math.cos(O)/y,-c/y,l*Math.sin(O)/y);v.push(_)}else for(var w=0;w<r;w++){var x=w*(2*Math.PI/r),k=Object(o.d)(Math.cos(x)*c,s,Math.sin(x)*c);b.push(k);var S=Object(o.d)(l*Math.cos(x)/y,c/y,l*Math.sin(x)/y);v.push(S)}var T=new Uint32Array(2*(r+2)*3),C=new Uint32Array(2*(r+2)*3),M=0,P=0;if(i){for(var A=3;A<b.length;A++)T[M++]=1,T[M++]=A-1,T[M++]=A,C[P++]=0,C[P++]=0,C[P++]=0;T[M++]=b.length-1,T[M++]=2,T[M++]=1,C[P++]=0,C[P++]=0,C[P++]=0}if(a){for(var E=3;E<b.length;E++)T[M++]=E,T[M++]=E-1,T[M++]=0,C[P++]=E,C[P++]=E-1,C[P++]=1;T[M++]=0,T[M++]=2,T[M++]=b.length-1,C[P++]=1,C[P++]=2,C[P++]=v.length-1}for(var R=new Float32Array(3*m),I=0;I<m;I++)R[3*I]=b[I][0],R[3*I+1]=b[I][1],R[3*I+2]=b[I][2];for(var D=new Float32Array(3*m),F=0;F<m;F++)D[3*F]=v[F][0],D[3*F+1]=v[F][1],D[3*F+2]=v[F][2];return new p.a([["position",{size:3,data:R,exclusive:!0}],["normal",{size:3,data:D,exclusive:!0}]],[["position",T],["normal",C]])},e.createCylinderGeometry=function(e,t,r,n,i,s){var c=n?Object(o.a)(n):Object(o.d)(1,0,0),l=i?Object(o.a)(i):Object(o.d)(0,0,0);s=null==s||s;var u=Object(o.c)();Object(a.t)(u,c);var d=Object(o.c)();Object(a.g)(d,u,Math.abs(e));var h=Object(o.c)();Object(a.g)(h,d,-.5),Object(a.h)(h,h,l);var f=Object(o.d)(0,1,0);Math.abs(1-Object(a.j)(u,f))<.2&&Object(a.y)(f,0,0,1);var b=Object(o.c)();Object(a.i)(b,u,f),Object(a.t)(b,b),Object(a.i)(f,b,u);var v=2*r+(s?2:0),m=r+(s?2:0),y=new Float32Array(3*v),g=new Float32Array(3*m),O=new Float32Array(2*v),j=new Uint32Array(3*r*(s?4:2)),_=new Uint32Array(3*r*(s?4:2));s&&(y[3*(v-2)+0]=h[0],y[3*(v-2)+1]=h[1],y[3*(v-2)+2]=h[2],O[2*(v-2)]=0,O[2*(v-2)+1]=0,y[3*(v-1)+0]=y[3*(v-2)+0]+d[0],y[3*(v-1)+1]=y[3*(v-2)+1]+d[1],y[3*(v-1)+2]=y[3*(v-2)+2]+d[2],O[2*(v-1)]=1,O[2*(v-1)+1]=1,g[3*(m-2)+0]=-u[0],g[3*(m-2)+1]=-u[1],g[3*(m-2)+2]=-u[2],g[3*(m-1)+0]=u[0],g[3*(m-1)+1]=u[1],g[3*(m-1)+2]=u[2]);for(var w=function(e,t,r){j[e]=t,_[e]=r},x=0,k=Object(o.c)(),S=Object(o.c)(),T=0;T<r;T++){var C=T*(2*Math.PI/r);Object(a.g)(k,f,Math.sin(C)),Object(a.g)(S,b,Math.cos(C)),Object(a.h)(k,k,S),g[3*T+0]=k[0],g[3*T+1]=k[1],g[3*T+2]=k[2],Object(a.g)(k,k,t),Object(a.h)(k,k,h),y[3*T+0]=k[0],y[3*T+1]=k[1],y[3*T+2]=k[2],O[2*T+0]=T/r,O[2*T+1]=0,y[3*(T+r)+0]=y[3*T+0]+d[0],y[3*(T+r)+1]=y[3*T+1]+d[1],y[3*(T+r)+2]=y[3*T+2]+d[2],O[2*(T+r)+0]=T/r,O[2*T+1]=1;var M=(T+1)%r;w(x++,T,T),w(x++,T+r,T),w(x++,M,M),w(x++,M,M),w(x++,T+r,T),w(x++,M+r,M)}if(s){for(var P=0;P<r;P++){var A=(P+1)%r;w(x++,v-2,m-2),w(x++,P,m-2),w(x++,A,m-2)}for(var E=0;E<r;E++){var R=(E+1)%r;w(x++,E+r,m-1),w(x++,v-1,m-1),w(x++,R+r,m-1)}}return new p.a([["position",{size:3,data:y,exclusive:!0}],["normal",{size:3,data:g,exclusive:!0}],["uv0",{size:2,data:O,exclusive:!0}]],[["position",j],["normal",_],["uv0",j]])},e.createTubeGeometry=function(t,r,n,i,a){n=n||10,i=null==i||i,Object(v.a)(t.length>1);for(var o=[],s=[],c=0;c<n;c++){o.push([0,-c-1,-(c+1)%n-1]);var l=c/n*2*Math.PI;s.push([Math.cos(l)*r,Math.sin(l)*r])}return e.createPathExtrusionGeometry(s,t,[[0,0,0]],o,i,a)},e.createPathExtrusionGeometry=function(e,t,r,i,u){var d=arguments.length>5&&void 0!==arguments[5]?arguments[5]:Object(o.d)(0,0,0),h=e.length,f=new Float32Array(t.length*h*3+(6*r.length||0)),b=new Float32Array(t.length*h*3+(r?6:0)),v=(t.length-1)*h*6+3*i.length*2,m=new Uint32Array(v),g=new Uint32Array(v),O=0,j=0,_=0,w=0,x=Object(o.c)(),k=Object(o.c)(),S=Object(o.c)(),T=Object(o.c)(),C=Object(o.c)(),M=Object(o.c)(),P=Object(o.c)(),A=Object(s.e)(),E=Object(o.c)(),R=Object(o.c)(),I=Object(o.c)(),D=Object(o.c)(),F=Object(o.c)(),L=Object(c.d)();Object(a.y)(E,0,1,0),Object(a.l)(k,t[1],t[0]),Object(a.t)(k,k),u?(Object(a.h)(A,t[0],d),Object(a.t)(S,A)):Object(a.y)(S,0,0,1),n(k,S,E,E,C,S,y),Object(a.m)(T,S),Object(a.m)(D,C);for(var z=0;z<r.length;z++)Object(a.g)(M,C,r[z][0]),Object(a.g)(A,S,r[z][2]),Object(a.h)(M,M,A),Object(a.h)(M,M,t[0]),f[O++]=M[0],f[O++]=M[1],f[O++]=M[2];b[j++]=-k[0],b[j++]=-k[1],b[j++]=-k[2];for(var V=0;V<i.length;V++)m[_++]=i[V][0]>0?i[V][0]:-i[V][0]-1+r.length,m[_++]=i[V][1]>0?i[V][1]:-i[V][1]-1+r.length,m[_++]=i[V][2]>0?i[V][2]:-i[V][2]-1+r.length,g[w++]=0,g[w++]=0,g[w++]=0;for(var N=r.length,U=r.length-1,B=0;B<t.length;B++){var G=!1;B>0&&(Object(a.m)(x,k),B<t.length-1?(Object(a.l)(k,t[B+1],t[B]),Object(a.t)(k,k)):G=!0,Object(a.h)(R,x,k),Object(a.t)(R,R),Object(a.h)(I,t[B-1],T),Object(c.h)(t[B],R,L),Object(c.m)(L,Object(l.g)(I,x),A)?(Object(a.l)(A,A,t[B]),Object(a.t)(S,A),Object(a.i)(C,R,S),Object(a.t)(C,C)):n(R,T,D,E,C,S,y),Object(a.m)(T,S),Object(a.m)(D,C)),u&&(Object(a.h)(A,t[B],d),Object(a.t)(F,A));for(var q=0;q<h;q++)if(Object(a.g)(M,C,e[q][0]),Object(a.g)(A,S,e[q][1]),Object(a.h)(M,M,A),Object(a.t)(P,M),b[j++]=P[0],b[j++]=P[1],b[j++]=P[2],Object(a.h)(M,M,t[B]),f[O++]=M[0],f[O++]=M[1],f[O++]=M[2],!G){var H=(q+1)%h;m[_++]=N+q,m[_++]=N+h+q,m[_++]=N+H,m[_++]=N+H,m[_++]=N+h+q,m[_++]=N+h+H;for(var W=0;W<6;W++)g[w++]=m[_-6+W]-U}N+=h}for(var Q=t[t.length-1],Z=0;Z<r.length;Z++)Object(a.g)(M,C,r[Z][0]),Object(a.g)(A,S,r[Z][1]),Object(a.h)(M,M,A),Object(a.h)(M,M,Q),f[O++]=M[0],f[O++]=M[1],f[O++]=M[2];var X=j/3;b[j++]=k[0],b[j++]=k[1],b[j++]=k[2];for(var Y=N-h,$=0;$<i.length;$++)m[_++]=i[$][0]>=0?N+i[$][0]:-i[$][0]-1+Y,m[_++]=i[$][2]>=0?N+i[$][2]:-i[$][2]-1+Y,m[_++]=i[$][1]>=0?N+i[$][1]:-i[$][1]-1+Y,g[w++]=X,g[w++]=X,g[w++]=X;return new p.a([["position",{size:3,data:f,exclusive:!0}],["normal",{size:3,data:b,exclusive:!0}]],[["position",m],["normal",g]])},e.createPolylineGeometry=function(e,t,r){Object(v.a)(e.length>1,"createPolylineGeometry(): polyline needs at least 2 points"),Object(v.a)(3===e[0].length,"createPolylineGeometry(): malformed vertex"),Object(v.a)(null==t||t.length===e.length,"createPolylineGeometry: need same number of points and normals"),Object(v.a)(null==t||3===t[0].length,"createPolylineGeometry(): malformed normal");for(var n=new Float64Array(3*e.length),i=new Uint32Array(2*(e.length-1)),a=0,o=0,s=0;s<e.length;s++){for(var c=0;c<3;c++)n[a++]=e[s][c];s>0&&(i[o++]=s-1,i[o++]=s)}var l=[],u=[];if(l.push(["position",i]),u.push(["position",{size:3,data:n,exclusive:!0}]),t){for(var d=new Float32Array(3*t.length),h=0,f=0;f<e.length;f++)for(var m=0;m<3;m++)d[h++]=t[f][m];l.push(["normal",i]),u.push(["normal",{size:3,data:d,exclusive:!0}])}return r&&(u.push(["color",{size:4,data:r}]),l.push(["color",Object(b.d)(r.length/4)])),new p.a(u,l,2)},e.createExtrudedTriangle=function(e,t,r,n){for(var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,a=new Array(18),o=[[-t,i,n/2],[r,i,n/2],[0,e+i,n/2],[-t,i,-n/2],[r,i,-n/2],[0,e+i,-n/2]],s=new Uint16Array([0,1,2,3,0,2,2,5,3,1,4,5,5,2,1,1,0,3,3,4,1,4,3,5]),c=0;c<6;c++)a[3*c]=o[c][0],a[3*c+1]=o[c][1],a[3*c+2]=o[c][2];return new p.a([["position",{size:3,data:a,exclusive:!0}]],[["position",s]])},e.transformInPlace=function(e,t){for(var r=e.getMutableAttribute("position").data,n=0;n<r.length;n+=3){var i=r[n],o=r[n+1],s=r[n+2];Object(a.y)(g,i,o,s),Object(a.s)(g,g,t),r[n]=g[0],r[n+1]=g[1],r[n+2]=g[2]}},e.cgToGIS=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e,r=e.vertexAttributes,n=r.get("position").data,i=r.get("normal").data;if(i)for(var a=t.getMutableAttribute("normal").data,o=0;o<i.length;o+=3){var s=i[o+1];a[o+1]=-i[o+2],a[o+2]=s}if(n)for(var c=t.getMutableAttribute("position").data,l=0;l<n.length;l+=3){var u=n[l+1];c[l+1]=-n[l+2],c[l+2]=u}return t},e.makeOrthoBasisDirUp=r,e.makeOrthoBasisDirUpFallback=n}(f||(f={}));var y=.99619469809,g=Object(o.c)(),O=f;t.a=O},function(e,t,r){"use strict";r.d(t,"a",(function(){return m})),r.d(t,"b",(function(){return y}));var n=r(14),i=r(58),a=r(138),o={year:"numeric",month:"numeric",day:"numeric"},s={year:"numeric",month:"long",day:"numeric"},c={year:"numeric",month:"short",day:"numeric"},l={year:"numeric",month:"long",weekday:"long",day:"numeric"},u={hour:"numeric",minute:"numeric"},d=Object(n.a)(Object(n.a)({},u),{},{second:"numeric"}),h={"short-date":o,"short-date-short-time":Object(n.a)(Object(n.a)({},o),u),"short-date-short-time-24":Object(n.a)(Object(n.a)(Object(n.a)({},o),u),{},{hour12:!1}),"short-date-long-time":Object(n.a)(Object(n.a)({},o),d),"short-date-long-time-24":Object(n.a)(Object(n.a)(Object(n.a)({},o),d),{},{hour12:!1}),"short-date-le":o,"short-date-le-short-time":Object(n.a)(Object(n.a)({},o),u),"short-date-le-short-time-24":Object(n.a)(Object(n.a)(Object(n.a)({},o),u),{},{hour12:!1}),"short-date-le-long-time":Object(n.a)(Object(n.a)({},o),d),"short-date-le-long-time-24":Object(n.a)(Object(n.a)(Object(n.a)({},o),d),{},{hour12:!1}),"long-month-day-year":s,"long-month-day-year-short-time":Object(n.a)(Object(n.a)({},s),u),"long-month-day-year-short-time-24":Object(n.a)(Object(n.a)(Object(n.a)({},s),u),{},{hour12:!1}),"long-month-day-year-long-time":Object(n.a)(Object(n.a)({},s),d),"long-month-day-year-long-time-24":Object(n.a)(Object(n.a)(Object(n.a)({},s),d),{},{hour12:!1}),"day-short-month-year":c,"day-short-month-year-short-time":Object(n.a)(Object(n.a)({},c),u),"day-short-month-year-short-time-24":Object(n.a)(Object(n.a)(Object(n.a)({},c),u),{},{hour12:!1}),"day-short-month-year-long-time":Object(n.a)(Object(n.a)({},c),d),"day-short-month-year-long-time-24":Object(n.a)(Object(n.a)(Object(n.a)({},c),d),{},{hour12:!1}),"long-date":l,"long-date-short-time":Object(n.a)(Object(n.a)({},l),u),"long-date-short-time-24":Object(n.a)(Object(n.a)(Object(n.a)({},l),u),{},{hour12:!1}),"long-date-long-time":Object(n.a)(Object(n.a)({},l),d),"long-date-long-time-24":Object(n.a)(Object(n.a)(Object(n.a)({},l),d),{},{hour12:!1}),"long-month-year":{month:"long",year:"numeric"},"short-month-year":{month:"short",year:"numeric"},year:{year:"numeric"},"short-time":u,"long-time":d},f=Object(i.b)()({shortDate:"short-date",shortDateShortTime:"short-date-short-time",shortDateShortTime24:"short-date-short-time-24",shortDateLongTime:"short-date-long-time",shortDateLongTime24:"short-date-long-time-24",shortDateLE:"short-date-le",shortDateLEShortTime:"short-date-le-short-time",shortDateLEShortTime24:"short-date-le-short-time-24",shortDateLELongTime:"short-date-le-long-time",shortDateLELongTime24:"short-date-le-long-time-24",longMonthDayYear:"long-month-day-year",longMonthDayYearShortTime:"long-month-day-year-short-time",longMonthDayYearShortTime24:"long-month-day-year-short-time-24",longMonthDayYearLongTime:"long-month-day-year-long-time",longMonthDayYearLongTime24:"long-month-day-year-long-time-24",dayShortMonthYear:"day-short-month-year",dayShortMonthYearShortTime:"day-short-month-year-short-time",dayShortMonthYearShortTime24:"day-short-month-year-short-time-24",dayShortMonthYearLongTime:"day-short-month-year-long-time",dayShortMonthYearLongTime24:"day-short-month-year-long-time-24",longDate:"long-date",longDateShortTime:"long-date-short-time",longDateShortTime24:"long-date-short-time-24",longDateLongTime:"long-date-long-time",longDateLongTime24:"long-date-long-time-24",longMonthYear:"long-month-year",shortMonthYear:"short-month-year",year:"year"}),p=(f.apiValues,f.toJSON.bind(f),f.fromJSON.bind(f),{ar:"ar-u-nu-latn-ca-gregory"}),b=new WeakMap,v=h["short-date-short-time"];function m(e){return h[e]||null}function y(e,t){return function(e){var t=e||v;if(!b.has(t)){var r=Object(a.b)(),n=p[Object(a.b)()]||r;b.set(t,new Intl.DateTimeFormat(n,t))}return b.get(t)}(t).format(e)}Object(a.a)((function(){b=new WeakMap,v=h["short-date-short-time"]}))},function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var n=r(83);function i(){return function(e,t){if(!e[t])throw new TypeError("Cannot auto bind undefined function '".concat(t,"'"));return{value:o(e[t])}}}function a(e){var t=e.type;return e instanceof KeyboardEvent||"keyup"===t||"keydown"===t||"keypress"===t}function o(e){return function(t){for(var r=arguments.length,i=new Array(r>1?r-1:0),o=1;o<r;o++)i[o-1]=arguments[o];a(t)?Object(n.f)(t.key)&&(t.preventDefault(),t.stopPropagation(),t.target.click()):e.call.apply(e,[this,t].concat(i))}}},function(e,t,r){"use strict";r.d(t,"a",(function(){return a})),r.d(t,"b",(function(){return u})),r.d(t,"c",(function(){return d})),r.d(t,"d",(function(){return i})),r.d(t,"e",(function(){return o})),r.d(t,"f",(function(){return s})),r.d(t,"g",(function(){return c})),r.d(t,"h",(function(){return l}));var n=r(63);function i(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e[4]=0,e[5]=0,e}function a(e,t){var r=t[0],n=t[1],i=t[2],a=t[3],o=t[4],s=t[5],c=r*a-n*i;return c?(c=1/c,e[0]=a*c,e[1]=-n*c,e[2]=-i*c,e[3]=r*c,e[4]=(i*s-a*o)*c,e[5]=(n*o-r*s)*c,e):null}function o(e,t,r){var n=t[0],i=t[1],a=t[2],o=t[3],s=t[4],c=t[5],l=r[0],u=r[1],d=r[2],h=r[3],f=r[4],p=r[5];return e[0]=n*l+a*u,e[1]=i*l+o*u,e[2]=n*d+a*h,e[3]=i*d+o*h,e[4]=n*f+a*p+s,e[5]=i*f+o*p+c,e}function s(e,t,r){var n=t[0],i=t[1],a=t[2],o=t[3],s=t[4],c=t[5],l=Math.sin(r),u=Math.cos(r);return e[0]=n*u+a*l,e[1]=i*u+o*l,e[2]=n*-l+a*u,e[3]=i*-l+o*u,e[4]=s,e[5]=c,e}function c(e,t,r){var n=t[0],i=t[1],a=t[2],o=t[3],s=t[4],c=t[5],l=r[0],u=r[1];return e[0]=n*l,e[1]=i*l,e[2]=a*u,e[3]=o*u,e[4]=s,e[5]=c,e}function l(e,t,r){var n=t[0],i=t[1],a=t[2],o=t[3],s=t[4],c=t[5],l=r[0],u=r[1];return e[0]=n,e[1]=i,e[2]=a,e[3]=o,e[4]=n*l+a*u+s,e[5]=i*l+o*u+c,e}function u(e,t){var r=Math.sin(t),n=Math.cos(t);return e[0]=n,e[1]=r,e[2]=-r,e[3]=n,e[4]=0,e[5]=0,e}function d(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=t[1],e[4]=0,e[5]=0,e}function h(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e[2]=t[2]-r[2],e[3]=t[3]-r[3],e[4]=t[4]-r[4],e[5]=t[5]-r[5],e}var f=o,p=h;Object.freeze({__proto__:null,copy:function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e},identity:i,set:function(e,t,r,n,i,a,o){return e[0]=t,e[1]=r,e[2]=n,e[3]=i,e[4]=a,e[5]=o,e},invert:a,determinant:function(e){return e[0]*e[3]-e[1]*e[2]},multiply:o,rotate:s,scale:c,translate:l,fromRotation:u,fromScaling:d,fromTranslation:function(e,t){return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e[4]=t[0],e[5]=t[1],e},str:function(e){return"mat2d("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+")"},frob:function(e){return Math.sqrt(Math.pow(e[0],2)+Math.pow(e[1],2)+Math.pow(e[2],2)+Math.pow(e[3],2)+Math.pow(e[4],2)+Math.pow(e[5],2)+1)},add:function(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e[3]=t[3]+r[3],e[4]=t[4]+r[4],e[5]=t[5]+r[5],e},subtract:h,multiplyScalar:function(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e[4]=t[4]*r,e[5]=t[5]*r,e},multiplyScalarAndAdd:function(e,t,r,n){return e[0]=t[0]+r[0]*n,e[1]=t[1]+r[1]*n,e[2]=t[2]+r[2]*n,e[3]=t[3]+r[3]*n,e[4]=t[4]+r[4]*n,e[5]=t[5]+r[5]*n,e},exactEquals:function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&e[4]===t[4]&&e[5]===t[5]},equals:function(e,t){var r=e[0],i=e[1],a=e[2],o=e[3],s=e[4],c=e[5],l=t[0],u=t[1],d=t[2],h=t[3],f=t[4],p=t[5];return Math.abs(r-l)<=n.a*Math.max(1,Math.abs(r),Math.abs(l))&&Math.abs(i-u)<=n.a*Math.max(1,Math.abs(i),Math.abs(u))&&Math.abs(a-d)<=n.a*Math.max(1,Math.abs(a),Math.abs(d))&&Math.abs(o-h)<=n.a*Math.max(1,Math.abs(o),Math.abs(h))&&Math.abs(s-f)<=n.a*Math.max(1,Math.abs(s),Math.abs(f))&&Math.abs(c-p)<=n.a*Math.max(1,Math.abs(c),Math.abs(p))},mul:f,sub:p})},function(e,t,r){"use strict";r.d(t,"a",(function(){return c})),r.d(t,"b",(function(){return o})),r.d(t,"c",(function(){return s})),r.d(t,"d",(function(){return a})),r.d(t,"e",(function(){return u})),r.d(t,"f",(function(){return p})),r.d(t,"g",(function(){return h})),r.d(t,"h",(function(){return b})),r.d(t,"i",(function(){return f})),r.d(t,"j",(function(){return l})),r.d(t,"k",(function(){return d}));var n=r(33),i=r(13);function a(e,t,r,n){return function(e){return"function"==typeof e}(e)?e(t,r,n):e}function o(e){return[e.r,e.g,e.b,e.a]}function s(e,t,r){var a=function(e){for(var t=e.length;t--;)if(-1===" /-,\n".indexOf(e.charAt(t)))return!1;return!0},o=[],s=0,l=-1;do{if((l=t.indexOf("[",s))>=s){if(l>s){var u=t.substr(s,l-s);o.push([u,null,a(u)])}if(s=l+1,(l=t.indexOf("]",s))>=s){if(l>s){var d=e[t.substr(s,l-s)];d&&o.push([null,d,!1])}s=l+1}}}while(-1!==l);if(s<t.length-1){var h=t.substr(s);o.push([h,null,a(h)])}return function(e){var t,a="",s=null,l=Object(i.a)(o);try{for(l.s();!(t=l.n()).done;){var u=t.value,d=Object(n.a)(u,3),h=d[0],f=d[1],p=d[2];if(h)p?s=h:(s&&(a+=s,s=null),a+=h);else{var b=e.attributes[f];b&&(s&&(a+=s,s=null),a+=b)}}}catch(v){l.e(v)}finally{l.f()}return c(a,r)}}function c(e,t){switch("string"!=typeof e&&(e=String(e)),t){case"LowerCase":return e.toLowerCase();case"Allcaps":return e.toUpperCase();default:return e}}function l(e,t,r,n,i,a){for(var o=!(arguments.length>6&&void 0!==arguments[6])||arguments[6],s=t/i,c=r/a,l=Math.ceil(s/2),u=Math.ceil(c/2),d=0;d<a;d++)for(var h=0;h<i;h++){for(var f=4*(h+(o?a-d-1:d)*i),p=0,b=0,v=0,m=0,y=0,g=0,O=0,j=(d+.5)*c,_=Math.floor(d*c);_<(d+1)*c;_++)for(var w=Math.abs(j-(_+.5))/u,x=(h+.5)*s,k=w*w,S=Math.floor(h*s);S<(h+1)*s;S++){var T=Math.abs(x-(S+.5))/l,C=Math.sqrt(k+T*T);C>=-1&&C<=1&&((p=2*C*C*C-3*C*C+1)>0&&(O+=p*e[(T=4*(S+_*t))+3],v+=p,e[T+3]<255&&(p=p*e[T+3]/250),m+=p*e[T],y+=p*e[T+1],g+=p*e[T+2],b+=p))}n[f]=m/b,n[f+1]=y/b,n[f+2]=g/b,n[f+3]=O/v}}function u(e){return e?{r:e[0],g:e[1],b:e[2],a:e[3]/255}:{r:0,g:0,b:0,a:0}}function d(e){var t;return null==(t=e.data)?void 0:t.symbol}function h(e){return"CIMVectorMarker"===e.type||"CIMPictureMarker"===e.type||"CIMBarChartMarker"===e.type||"CIMCharacterMarker"===e.type||"CIMPieChartMarker"===e.type||"CIMStackedBarChartMarker"===e.type}function f(e){return"CIMGradientStroke"===e.type||"CIMPictureStroke"===e.type||"CIMSolidStroke"===e.type}function p(e){return"CIMGradientFill"===e.type||"CIMHatchFill"===e.type||"CIMPictureFill"===e.type||"CIMSolidFill"===e.type||"CIMWaterFill"===e.type}function b(e){return"CIMMarkerPlacementAlongLineRandomSize"===e.type||"CIMMarkerPlacementAlongLineSameSize"===e.type||"CIMMarkerPlacementAlongLineVariableSize"===e.type||"CIMMarkerPlacementAtExtremities"===e.type||"CIMMarkerPlacementAtMeasuredUnits"===e.type||"CIMMarkerPlacementAtRatioPositions"===e.type||"CIMMarkerPlacementOnLine"===e.type||"CIMMarkerPlacementOnVertices"===e.type}},function(e,t,r){"use strict";var n,i=r(2),a=r(5),o=r(6),s=r(7),c=r(0),l=r(25),u=r(1),d=(r(18),r(17),r(15),r(10)),h=r(44),f=r(66),p=r(160),b=r(56),v=r(55),m=r(482),y=r(311);var g=n=function(e){Object(o.a)(r,e);var t=Object(s.a)(r);function r(){var e;Object(i.a)(this,r);for(var n=arguments.length,a=new Array(n),o=0;o<n;o++)a[o]=arguments[o];return(e=t.call.apply(t,[this].concat(a))).paths=[],e.type="polyline",e}return Object(a.a)(r,[{key:"normalizeCtorArgs",value:function(e,t){var r,n,i,a=null;return e&&!Array.isArray(e)?(a=e.paths?e.paths:null,t||(e.spatialReference?t=e.spatialReference:e.paths||(t=e)),r=e.hasZ,n=e.hasM):a=e,a=a||[],t=t||v.a.WGS84,a.length&&a[0]&&null!=a[0][0]&&"number"==typeof a[0][0]&&(a=[a]),(i=a[0]&&a[0][0])&&(void 0===r&&void 0===n?(r=i.length>2,n=!1):void 0===r?r=!n&&i.length>3:void 0===n&&(n=!r&&i.length>3)),{paths:a,spatialReference:t,hasZ:r,hasM:n}}},{key:"cache",get:function(){return this.commitProperty("paths"),this.commitProperty("hasZ"),this.commitProperty("hasM"),this.commitProperty("spatialReference"),{}}},{key:"extent",get:function(){var e=this.spatialReference,t=Object(m.c)(this);if(!t)return null;var r=new f.a(t);return r.spatialReference=e,r}},{key:"writePaths",value:function(e,t){t.paths=Object(l.a)(this.paths)}},{key:"addPath",value:function(e){if(e){var t=this.paths,r=t.length;if(function(e){return!Array.isArray(e[0])}(e)){for(var n=[],i=0,a=e.length;i<a;i++)n[i]=e[i].toArray();t[r]=n}else t[r]=e.concat();return this.notifyChange("paths"),this}}},{key:"clone",value:function(){var e=new n;return e.spatialReference=this.spatialReference,e.paths=Object(l.a)(this.paths),e.hasZ=this.hasZ,e.hasM=this.hasM,e}},{key:"getPoint",value:function(e,t){if(!this._validateInputs(e,t))return null;var r=this.paths[e][t],n=this.hasZ,i=this.hasM;return n&&!i?new b.a(r[0],r[1],r[2],void 0,this.spatialReference):i&&!n?new b.a(r[0],r[1],void 0,r[2],this.spatialReference):n&&i?new b.a(r[0],r[1],r[2],r[3],this.spatialReference):new b.a(r[0],r[1],this.spatialReference)}},{key:"insertPoint",value:function(e,t,r){return this._validateInputs(e,t,!0)?(Object(y.a)(this,r),Array.isArray(r)||(r=r.toArray()),this.paths[e].splice(t,0,r),this.notifyChange("paths"),this):this}},{key:"removePath",value:function(e){if(!this._validateInputs(e,null))return null;var t=this.paths.splice(e,1)[0],r=this.spatialReference,n=t.map((function(e){return new b.a(e,r)}));return this.notifyChange("paths"),n}},{key:"removePoint",value:function(e,t){if(!this._validateInputs(e,t))return null;var r=new b.a(this.paths[e].splice(t,1)[0],this.spatialReference);return this.notifyChange("paths"),r}},{key:"setPoint",value:function(e,t,r){return this._validateInputs(e,t)?(Object(y.a)(this,r),Array.isArray(r)||(r=r.toArray()),this.paths[e][t]=r,this.notifyChange("paths"),this):this}},{key:"_validateInputs",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(null==e||e<0||e>=this.paths.length)return!1;if(null!=t){var n=this.paths[e];if(r&&(t<0||t>n.length))return!1;if(!r&&(t<0||t>=n.length))return!1}return!0}},{key:"toJSON",value:function(e){return this.write(null,e)}}]),r}(p.a);Object(c.a)([Object(u.b)({readOnly:!0})],g.prototype,"cache",null),Object(c.a)([Object(u.b)({readOnly:!0})],g.prototype,"extent",null),Object(c.a)([Object(u.b)({type:[[[Number]]],json:{write:{isRequired:!0}}})],g.prototype,"paths",void 0),Object(c.a)([Object(h.a)("paths")],g.prototype,"writePaths",null),(g=n=Object(c.a)([Object(d.a)("esri.geometry.Polyline")],g)).prototype.toJSON.isDefaultToJSON=!0;var O=g;t.a=O},function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n,i=r(12),a=r(11);function o(e){e.code.add(Object(a.a)(n||(n=Object(i.a)(["vec4 premultiplyAlpha(vec4 v) {\nreturn vec4(v.rgb * v.a, v.a);\n}\nvec3 rgb2hsv(vec3 c) {\nvec4 K = vec4(0.0, -1.0 / 3.0, 2.0 / 3.0, -1.0);\nvec4 p = c.g < c.b ? vec4(c.bg, K.wz) : vec4(c.gb, K.xy);\nvec4 q = c.r < p.x ? vec4(p.xyw, c.r) : vec4(c.r, p.yzx);\nfloat d = q.x - min(q.w, q.y);\nfloat e = 1.0e-10;\nreturn vec3(abs(q.z + (q.w - q.y) / (6.0 * d + e)), min(d / (q.x + e), 1.0), q.x);\n}\nvec3 hsv2rgb(vec3 c) {\nvec4 K = vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0);\nvec3 p = abs(fract(c.xxx + K.xyz) * 6.0 - K.www);\nreturn c.z * mix(K.xxx, clamp(p - K.xxx, 0.0, 1.0), c.y);\n}\nfloat rgb2v(vec3 c) {\nreturn max(c.x, max(c.y, c.z));\n}"]))))}},function(e,t,r){"use strict";r.d(t,"a",(function(){return a})),r.d(t,"b",(function(){return c})),r.d(t,"c",(function(){return s})),r.d(t,"d",(function(){return o})),r.d(t,"e",(function(){return i}));var n=r(407);function i(e,t,r){if(e.count===t.count)for(var i=e.count,a=r[0],o=r[1],s=r[2],c=r[4],l=r[5],u=r[6],d=r[8],h=r[9],f=r[10],p=r[12],b=r[13],v=r[14],m=e.typedBuffer,y=e.typedBufferStride,g=t.typedBuffer,O=t.typedBufferStride,j=0;j<i;j++){var _=j*y,w=j*O,x=g[w],k=g[w+1],S=g[w+2];m[_]=a*x+c*k+d*S+p,m[_+1]=o*x+l*k+h*S+b,m[_+2]=s*x+u*k+f*S+v}else n.a.error("source and destination buffers need to have the same number of elements")}function a(e,t,r){if(e.count===t.count)for(var i=e.count,a=r[0],o=r[1],s=r[2],c=r[3],l=r[4],u=r[5],d=r[6],h=r[7],f=r[8],p=e.typedBuffer,b=e.typedBufferStride,v=t.typedBuffer,m=t.typedBufferStride,y=0;y<i;y++){var g=y*b,O=y*m,j=v[O],_=v[O+1],w=v[O+2];p[g]=a*j+c*_+d*w,p[g+1]=o*j+l*_+h*w,p[g+2]=s*j+u*_+f*w}else n.a.error("source and destination buffers need to have the same number of elements")}function o(e,t,r){for(var n=Math.min(e.count,t.count),i=e.typedBuffer,a=e.typedBufferStride,o=t.typedBuffer,s=t.typedBufferStride,c=0;c<n;c++){var l=c*a,u=c*s;i[l]=r*o[u],i[l+1]=r*o[u+1],i[l+2]=r*o[u+2]}}function s(e,t){for(var r=Math.min(e.count,t.count),n=e.typedBuffer,i=e.typedBufferStride,a=t.typedBuffer,o=t.typedBufferStride,s=0;s<r;s++){var c=s*i,l=s*o,u=a[l],d=a[l+1],h=a[l+2],f=Math.sqrt(u*u+d*d+h*h);if(f>0){var p=1/f;n[c]=p*u,n[c+1]=p*d,n[c+2]=p*h}}}function c(e,t,r){for(var n=Math.min(e.count,t.count),i=e.typedBuffer,a=e.typedBufferStride,o=t.typedBuffer,s=t.typedBufferStride,c=0;c<n;c++){var l=c*a,u=c*s;i[l]=o[u]>>r,i[l+1]=o[u+1]>>r,i[l+2]=o[u+2]>>r}}Object.freeze({__proto__:null,transformMat4:i,transformMat3:a,scale:o,normalize:s,shiftRight:c})},function(e,t,r){"use strict";r.d(t,"a",(function(){return s})),r.d(t,"b",(function(){return u})),r.d(t,"c",(function(){return d})),r.d(t,"d",(function(){return c})),r.d(t,"e",(function(){return l}));var n=r(13),i=r(176),a=r(55),o=r(100),s={102100:{maxX:20037508.342788905,minX:-20037508.342788905,plus180Line:new i.a({paths:[[[20037508.342788905,-20037508.342788905],[20037508.342788905,20037508.342788905]]],spatialReference:a.a.WebMercator}),minus180Line:new i.a({paths:[[[-20037508.342788905,-20037508.342788905],[-20037508.342788905,20037508.342788905]]],spatialReference:a.a.WebMercator})},4326:{maxX:180,minX:-180,plus180Line:new i.a({paths:[[[180,-180],[180,180]]],spatialReference:a.a.WGS84}),minus180Line:new i.a({paths:[[[-180,-180],[-180,180]]],spatialReference:a.a.WGS84})}};function c(e,t){return Math.ceil((e-t)/(2*t))}function l(e,t){var r,i=u(e),a=Object(n.a)(i);try{for(a.s();!(r=a.n()).done;){var o,s=r.value,c=Object(n.a)(s);try{for(c.s();!(o=c.n()).done;){o.value[0]+=t}}catch(l){c.e(l)}finally{c.f()}}}catch(l){a.e(l)}finally{a.f()}return e}function u(e){return Object(o.g)(e)?e.rings:e.paths}function d(e){var t=(null==e?void 0:e.isWebMercator)?102100:4326;return[s[t].minX,s[t].maxX]}},function(e,t,r){"use strict";var n,i=r(2),a=r(5),o=r(19),s=r(6),c=r(7),l=r(0),u=r(22),d=r(238),h=r(23),f=r(192),p=r(1),b=r(10),v="not-loaded",m="loading",y="failed",g="loaded",O=function(e){var t=function(e){Object(s.a)(r,e);var t=Object(c.a)(r);function r(){var e;Object(i.a)(this,r);for(var n=arguments.length,a=new Array(n),s=0;s<n;s++)a[s]=arguments[s];return(e=t.call.apply(t,[this].concat(a)))._loadController=null,e.loadError=null,e.loadStatus="not-loaded",e._set("loadWarnings",[]),e.addResolvingPromise(new Promise((function(t){var r=e.load.bind(Object(o.a)(e));e.load=function(n){var i=new Promise((function(t,r){var i=Object(h.t)(n,r);e.destroyed&&r(new u.a("load:instance-destroyed","Instance of '".concat(e.declaredClass||e.constructor.name,"' is already destroyed"),{instance:Object(o.a)(e)})),e._promiseProps.when(t,r).finally((function(){i&&i.remove()}))}));if(e.loadStatus===v){e._set("loadStatus",m);var a=e._loadController=Object(h.e)();r({signal:a.signal}),Object(h.s)(a.signal,(function(){e._promiseProps.abort()}))}return t(),i}}))),e.when((function(){e._set("loadStatus",g),e._loadController=null}),(function(t){e._set("loadStatus",y),e._set("loadError",t),e._loadController=null})),e}return Object(a.a)(r,[{key:"loaded",get:function(){return this.loadStatus===g}},{key:"loadWarnings",get:function(){return this._get("loadWarnings")}},{key:"load",value:function(){return null}},{key:"cancelLoad",value:function(){var e;return this.isFulfilled()||(this._set("loadError",new u.a("load:cancelled","Cancelled")),null==(e=this._loadController)||e.abort()),this}}]),r}(e);return Object(l.a)([Object(p.b)({readOnly:!0})],t.prototype,"loaded",null),Object(l.a)([Object(p.b)({readOnly:!0})],t.prototype,"loadError",void 0),Object(l.a)([Object(p.b)()],t.prototype,"loadStatus",void 0),Object(l.a)([Object(p.b)({type:[f.a],readOnly:!0})],t.prototype,"loadWarnings",null),t=Object(l.a)([Object(b.a)("esri.core.Loadable")],t),t},j=function(e){Object(s.a)(r,e);var t=Object(c.a)(r);function r(){return Object(i.a)(this,r),t.apply(this,arguments)}return r}(O(d.a));j=Object(l.a)([Object(b.a)("esri.core.Loadable")],j),(n=j||(j={})).LoadableMixin=O,n.isLoadable=function(e){return!(!e||!e.load)};var _=j;t.a=_},function(e,t,r){"use strict";var n=r(2),i=r(6),a=r(7),o=r(0),s=r(27),c=r(1),l=(r(17),r(18),r(15),r(10)),u=function(e){Object(i.a)(r,e);var t=Object(a.a)(r);function r(e){var i;return Object(n.a)(this,r),(i=t.call(this,e)).type=null,i}return r}(s.a);Object(o.a)([Object(c.b)({type:["attachments","custom","fields","media","text"],readOnly:!0,json:{read:!1,write:!0}})],u.prototype,"type",void 0);var d=u=Object(o.a)([Object(l.a)("esri.popup.content.Content")],u);t.a=d},function(e,t,r){"use strict";r.d(t,"a",(function(){return i})),r.d(t,"b",(function(){return a}));var n=0,i=0;function a(){return++n}},function(e,t,r){"use strict";r.d(t,"a",(function(){return m})),r.d(t,"b",(function(){return T})),r.d(t,"c",(function(){return x})),r.d(t,"d",(function(){return _})),r.d(t,"e",(function(){return S}));var n=r(2),i=r(5),a=r(3),o=r(67),s=r(96),c=r(26),l=r(31),u=r(193),d=r(196),h=r(4),f=r(73),p=r(9),b=r(43),v=r(70),m=function(){function e(){Object(n.a)(this,e),this._transform=Object(l.d)(),this._transformInverse=new y({value:this._transform},c.a,l.d),this._transformInverseTranspose=new y(this._transformInverse,c.e,l.d),this._transformTranspose=new y({value:this._transform},c.e,l.d),this._transformInverseRotation=new y({value:this._transform},o.k,s.b)}return Object(i.a)(e,[{key:"invalidateLazyTransforms",value:function(){this._transformInverse.invalidate(),this._transformInverseTranspose.invalidate(),this._transformTranspose.invalidate(),this._transformInverseRotation.invalidate()}},{key:"transform",get:function(){return this._transform}},{key:"inverse",get:function(){return this._transformInverse.value}},{key:"inverseTranspose",get:function(){return this._transformInverseTranspose.value}},{key:"inverseRotation",get:function(){return this._transformInverseRotation.value}},{key:"transpose",get:function(){return this._transformTranspose.value}},{key:"setTransformMatrix",value:function(e){Object(c.d)(this._transform,e)}},{key:"multiplyTransform",value:function(e){Object(c.m)(this._transform,this._transform,e)}},{key:"set",value:function(e){Object(c.d)(this._transform,e),this.invalidateLazyTransforms()}},{key:"setAndInvalidateLazyTransforms",value:function(e,t){this.setTransformMatrix(e),this.multiplyTransform(t),this.invalidateLazyTransforms()}}]),e}(),y=function(){function e(t,r,i){Object(n.a)(this,e),this.original=t,this.update=r,this.dirty=!0,this.transform=i()}return Object(i.a)(e,[{key:"invalidate",value:function(){this.dirty=!0}},{key:"value",get:function(){return this.dirty&&(this.update(this.transform,this.original.value),this.dirty=!1),this.transform}}]),e}(),g=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;Object(n.a)(this,e),this.offset=t,this.tmpVertex=Object(p.e)()}return Object(i.a)(e,[{key:"applyToVertex",value:function(e,t,r){var n=e+this.localOrigin[0],i=t+this.localOrigin[1],a=r+this.localOrigin[2],o=this.offset/Math.sqrt(n*n+i*i+a*a);return this.tmpVertex[0]=e+n*o,this.tmpVertex[1]=t+i*o,this.tmpVertex[2]=r+a*o,this.tmpVertex}},{key:"applyToAabb",value:function(e){var t=e[0]+this.localOrigin[0],r=e[1]+this.localOrigin[1],n=e[2]+this.localOrigin[2],i=e[3]+this.localOrigin[0],a=e[4]+this.localOrigin[1],o=e[5]+this.localOrigin[2],s=this.offset/Math.sqrt(t*t+r*r+n*n);e[0]+=t*s,e[1]+=r*s,e[2]+=n*s;var c=this.offset/Math.sqrt(i*i+a*a+o*o);return e[3]+=i*c,e[4]+=a*c,e[5]+=o*c,e}}]),e}(),O=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;Object(n.a)(this,e),this.offset=t,this.componentLocalOriginLength=0,this.tmpVertex=Object(p.e)(),this.mbs=Object(b.e)(),this.obb={center:Object(p.e)(),halfSize:Object(f.c)(),quaternion:null}}return Object(i.a)(e,[{key:"localOrigin",set:function(e){this.componentLocalOriginLength=Math.sqrt(e[0]*e[0]+e[1]*e[1]+e[2]*e[2])}},{key:"applyToVertex",value:function(e,t,r){var n=e,i=t,a=r+this.componentLocalOriginLength,o=this.offset/Math.sqrt(n*n+i*i+a*a);return this.tmpVertex[0]=e+n*o,this.tmpVertex[1]=t+i*o,this.tmpVertex[2]=r+a*o,this.tmpVertex}},{key:"applyToAabb",value:function(e){var t=e[0],r=e[1],n=e[2]+this.componentLocalOriginLength,i=e[3],a=e[4],o=e[5]+this.componentLocalOriginLength,s=this.offset/Math.sqrt(t*t+r*r+n*n);e[0]+=t*s,e[1]+=r*s,e[2]+=n*s;var c=this.offset/Math.sqrt(i*i+a*a+o*o);return e[3]+=i*c,e[4]+=a*c,e[5]+=o*c,e}},{key:"applyToMbs",value:function(e){var t=Math.sqrt(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]),r=this.offset/t;return this.mbs[0]=e[0]+e[0]*r,this.mbs[1]=e[1]+e[1]*r,this.mbs[2]=e[2]+e[2]*r,this.mbs[3]=e[3]+e[3]*this.offset/t,this.mbs}},{key:"applyToObb",value:function(e){var t=e.center,r=this.offset/Math.sqrt(t[0]*t[0]+t[1]*t[1]+t[2]*t[2]);this.obb.center[0]=t[0]+t[0]*r,this.obb.center[1]=t[1]+t[1]*r,this.obb.center[2]=t[2]+t[2]*r,Object(h.w)(this.obb.halfSize,e.halfSize,e.quaternion),Object(h.h)(this.obb.halfSize,this.obb.halfSize,e.center);var n=this.offset/Math.sqrt(this.obb.halfSize[0]*this.obb.halfSize[0]+this.obb.halfSize[1]*this.obb.halfSize[1]+this.obb.halfSize[2]*this.obb.halfSize[2]);return this.obb.halfSize[0]+=this.obb.halfSize[0]*n,this.obb.halfSize[1]+=this.obb.halfSize[1]*n,this.obb.halfSize[2]+=this.obb.halfSize[2]*n,Object(h.l)(this.obb.halfSize,this.obb.halfSize,e.center),Object(u.b)(C,e.quaternion),Object(h.w)(this.obb.halfSize,this.obb.halfSize,C),this.obb.halfSize[0]*=this.obb.halfSize[0]<0?-1:1,this.obb.halfSize[1]*=this.obb.halfSize[1]<0?-1:1,this.obb.halfSize[2]*=this.obb.halfSize[2]<0?-1:1,this.obb.quaternion=e.quaternion,this.obb}}]),e}(),j=new(function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;Object(n.a)(this,e),this.offset=t,this.sphere=Object(v.c)(),this.tmpVertex=Object(p.e)()}return Object(i.a)(e,[{key:"applyToVertex",value:function(e,t,r){var n=this.objectTransform.transform,i=n[0]*e+n[4]*t+n[8]*r+n[12],a=n[1]*e+n[5]*t+n[9]*r+n[13],o=n[2]*e+n[6]*t+n[10]*r+n[14],s=this.offset/Math.sqrt(i*i+a*a+o*o);i+=i*s,a+=a*s,o+=o*s;var c=this.objectTransform.inverse;return this.tmpVertex[0]=c[0]*i+c[4]*a+c[8]*o+c[12],this.tmpVertex[1]=c[1]*i+c[5]*a+c[9]*o+c[13],this.tmpVertex[2]=c[2]*i+c[6]*a+c[10]*o+c[14],this.tmpVertex}},{key:"applyToMinMax",value:function(e,t){var r=this.offset/Math.sqrt(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]);e[0]+=e[0]*r,e[1]+=e[1]*r,e[2]+=e[2]*r;var n=this.offset/Math.sqrt(t[0]*t[0]+t[1]*t[1]+t[2]*t[2]);t[0]+=t[0]*n,t[1]+=t[1]*n,t[2]+=t[2]*n}},{key:"applyToAabb",value:function(e){var t=this.offset/Math.sqrt(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]);e[0]+=e[0]*t,e[1]+=e[1]*t,e[2]+=e[2]*t;var r=this.offset/Math.sqrt(e[3]*e[3]+e[4]*e[4]+e[5]*e[5]);return e[3]+=e[3]*r,e[4]+=e[4]*r,e[5]+=e[5]*r,e}},{key:"applyToBoundingSphere",value:function(e){var t=Math.sqrt(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]),r=this.offset/t;return this.sphere[0]=e[0]+e[0]*r,this.sphere[1]=e[1]+e[1]*r,this.sphere[2]=e[2]+e[2]*r,this.sphere[3]=e[3]+e[3]*this.offset/t,this.sphere}}]),e}());function _(e){return Object(a.j)(e)?(j.offset=e,j):null}var w=new O;function x(e){return Object(a.j)(e)?(w.offset=e,w):null}var k=new g;function S(e){return Object(a.j)(e)?(k.offset=e,k):null}var T="terrain",C=Object(d.b)()},function(e,t,r){"use strict";var n=r(2),i=r(5),a=r(117);function o(e){e.length=0}var s=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:50,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:50;Object(n.a)(this,e),this._pool=new a.a(Array,void 0,o,r,t)}return Object(i.a)(e,[{key:"acquire",value:function(){return this._pool.acquire()}},{key:"release",value:function(e){this._pool.release(e)}},{key:"prune",value:function(){this._pool.prune(0)}}],[{key:"acquire",value:function(){return c.acquire()}},{key:"release",value:function(e){return c.release(e)}},{key:"prune",value:function(){c.prune()}}]),e}(),c=new s(100);t.a=s},function(e,t,r){"use strict";r.d(t,"a",(function(){return l})),r.d(t,"b",(function(){return c}));var n=r(98),i=r(22),a=r(223),o=r(227),s=r(606);function c(e,t,r,n){var c=function(e,t,r){if(!e)return null;if(r&&"web-scene"===r.origin&&!(e instanceof a.a)&&!(e instanceof o.a)){var n="cim"!==e.type?Object(s.a)(e):{symbol:null,error:new i.a("symbol-conversion:unsupported-cim-symbol","CIM symbol is unsupported in web scenes",{symbol:e})};return n.symbol?n.symbol.write(t,r):(r.messages&&r.messages.push(new i.a("symbol:unsupported","Symbols of type '".concat(e.declaredClass,"' are not supported in scenes. Use 3D symbology instead when working with WebScene and SceneView"),{symbol:e,context:r,error:n.error})),null)}return r&&"web-map"===r.origin&&"web-style"===e.type?(r.messages&&r.messages.push(new i.a("symbol:unsupported","Symbols of type '".concat(e.declaredClass,"' are not supported in webmaps. Use CIMSymbol instead when working with WebMap in MapView."),{symbol:e,context:r})),null):e.write(t,r)}(e,{},n);c&&(t[r]=c)}function l(e,t){return Object(n.d)(e,null,t)}},function(e,t,r){"use strict";r.d(t,"a",(function(){return p})),r.d(t,"b",(function(){return b})),r.d(t,"c",(function(){return v}));var n=r(3),i=r(31),a=r(9),o=r(51),s=r(34),c=r(235),l=r(202),u=r(65),d=r(105),h=r(163),f=Object(a.e)();function p(e,t,r,a,c,l,d,p,b,v){var m=r?r.length:0,y=e.clippingExtent;if(Object(o.u)(t,f,e.elevationProvider.spatialReference),Object(n.j)(y)&&!Object(s.g)(y,f))return null;var g=e.renderCoordsHelper.spatialReference;Object(o.u)(t,f,g);for(var O=e.localOriginFactory.getOrigin(f),j=new h.a({castShadow:!1,metadata:{layerUid:p,graphicUid:b,usesVerticalDistanceToGround:!0}}),_=0;_<m;_++){var w=c?c[_]:i.a;j.addGeometry(r[_],a[_],w,l,O,v)}return{object:j,sampledElevation:Object(u.b)(j,t,e.elevationProvider,e.renderCoordsHelper,d)}}function b(e,t,r){var n=e.elevationContext,i=r.spatialReference;Object(o.u)(t,f,i),n.centerPointInElevationSR=Object(l.j)(f[0],f[1],t.hasZ?f[2]:0,i)}function v(e){switch(e.type){case"point":return e;case"polygon":case"extent":return Object(d.a)(e);case"polyline":var t=e.paths[0];if(!t||0===t.length)return null;var r=Object(c.d)(t,Object(c.c)(t)/2);return Object(l.j)(r[0],r[1],r[2],e.spatialReference);case"mesh":return e.origin}return null}},function(e,t,r){"use strict";r.d(t,"a",(function(){return o})),r.d(t,"b",(function(){return i})),r.d(t,"c",(function(){return a})),r.d(t,"d",(function(){return l})),r.d(t,"e",(function(){return c})),r.d(t,"f",(function(){return s})),r.d(t,"g",(function(){return d})),r.d(t,"h",(function(){return u})),r.d(t,"i",(function(){return h})),r.d(t,"j",(function(){return p})),r.d(t,"k",(function(){return f}));r(107);var n=r(60);function i(e,t){var r,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"nearest",a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=!(a&&"u8"===t.pixelType),s=o?5126:5121,c=null==t.pixels||0===t.pixels.length?null:o?t.getAsRGBAFloat():t.getAsRGBA(),l=null==(r=e.capabilities.textureFloat)?void 0:r.textureFloatLinear,u={width:t.width,height:t.height,target:3553,pixelFormat:6408,internalFormat:"webgl2"===e.webglVersion&&o?34836:6408,samplingMode:!l||"bilinear"!==i&&"cubic"!==i?9728:9729,dataType:s,wrapMode:33071,flipped:!1};return new n.a(e,u,c)}function a(e,t){for(var r=4*t.size[0],i=t.size[1],a={width:r,height:i,target:3553,pixelFormat:6408,internalFormat:"webgl2"===e.webglVersion?34836:6408,dataType:5126,samplingMode:9728,wrapMode:33071,flipped:!1},o=new Float32Array(r*i*4),s=0,c=0;c<t.coefficients.length;c++)o[s++]=t.coefficients[c],c%3==2&&(o[s++]=1);return new n.a(e,a,o)}function o(e,t){var r={width:t.length/4,height:1,target:3553,pixelFormat:6408,internalFormat:6408,dataType:5121,samplingMode:9728,wrapMode:33071,flipped:!1};return new n.a(e,r,t)}function s(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,i=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],a=arguments.length>5&&void 0!==arguments[5]&&arguments[5];return{u_flipY:i,u_isFloatTexture:a,u_applyTransform:!!e,u_opacity:n,u_transformSpacing:e?e.spacing:null,u_transformGridSize:e?e.size:null,u_targetImageSize:t,u_srcImageSize:r}}function c(e,t){return{u_colormapOffset:t||0,u_colormapMaxIndex:e?e.length/4-1:null}}function l(e,t){return{u_scale:e,u_offset:t}}function u(e){return{u_bandCount:e.bandCount,u_minOutput:e.outMin,u_maxOutput:e.outMax,u_minCutOff:e.minCutOff,u_maxCutOff:e.maxCutOff,u_factor:e.factor,u_useGamma:e.useGamma,u_gamma:e.gamma,u_gammaCorrection:e.gammaCorrection}}function d(e){return{u_hillshadeType:e.hillshadeType,u_sinZcosAs:e.sinZcosAs,u_sinZsinAs:e.sinZsinAs,u_cosZs:e.cosZs,u_weights:e.weights,u_factor:e.factor,u_minValue:e.minValue,u_maxValue:e.maxValue}}function h(e,t){for(var r,n=e.gl,i=t.glName,a=n.getProgramParameter(i,n.ACTIVE_UNIFORMS),o=new Map,s=0;s<a;s++)(r=n.getActiveUniform(i,s))&&o.set(r.name,{location:n.getUniformLocation(i,r.name),info:r});return o}function f(e,t,r){Object.keys(r).forEach((function(n){var i=t.get(n)||t.get(n+"[0]");i&&function(e,t,r,n){if(null===n||null==r)return!1;var i=n.info;switch(i.type){case 5126:i.size>1?e.setUniform1fv(t,r):e.setUniform1f(t,r);break;case 35664:e.setUniform2fv(t,r);break;case 35665:e.setUniform3fv(t,r);break;case 35666:e.setUniform4fv(t,r);break;case 35675:e.setUniformMatrix3fv(t,r);break;case 35676:e.setUniformMatrix4fv(t,r);break;case 5124:i.size>1?e.setUniform1iv(t,r):e.setUniform1i(t,r);break;case 35670:e.setUniform1i(t,r?1:0);break;case 35667:case 35671:e.setUniform2iv(t,r);break;case 35668:case 35672:e.setUniform3iv(t,r);break;case 35669:case 35673:e.setUniform4iv(t,r);break;default:return!1}}(e,n,r[n],i)}))}function p(e,t,r,n){r.length===n.length&&(n.some((function(e){return null==e}))||r.some((function(e){return null==e}))||r.forEach((function(r,i){t.setUniform1i(r,i),e.bindTexture(n[i],i)})))}},function(e,t,r){"use strict";r.d(t,"a",(function(){return g})),r.d(t,"b",(function(){return b})),r.d(t,"c",(function(){return j})),r.d(t,"d",(function(){return h})),r.d(t,"e",(function(){return p})),r.d(t,"f",(function(){return w})),r.d(t,"g",(function(){return _})),r.d(t,"h",(function(){return m})),r.d(t,"i",(function(){return y})),r.d(t,"j",(function(){return d})),r.d(t,"k",(function(){return v})),r.d(t,"l",(function(){return O})),r.d(t,"m",(function(){return u})),r.d(t,"n",(function(){return f}));var n=r(14),i=r(232),a=r(66),o=r(55),s=r(130),c=r(586),l=r(248),u={type:Boolean,value:!0,json:{origins:{service:{read:!1,write:!1},"web-map":{read:!1,write:!1}},name:"screenSizePerspective",write:!0}},d={type:Boolean,value:!0,json:{name:"disablePopup",read:{reader:function(e,t){return!t.disablePopup}},write:{enabled:!0,writer:function(e,t,r){t[r]=!e}}}},h={type:Boolean,value:!0,json:{name:"showLabels",write:!0}},f={type:String,json:{origins:{"portal-item":{write:!1}},write:{isRequired:!0,ignoreOrigin:!0,writer:s.f}}},p={type:Boolean,value:!0,json:{origins:{service:{read:{enabled:!1}}},name:"showLegend",write:!0}},b={value:null,type:c.a,json:{origins:{service:{name:"elevationInfo",write:!0}},name:"layerDefinition.elevationInfo",write:!0}};function v(e){return{type:e,readOnly:!0,json:{origins:{service:{read:!0}},read:!1}}}var m={type:Number,json:{origins:{"web-document":{default:1,write:!0,read:!0},"portal-item":{write:!0}}}},y=Object(n.a)(Object(n.a)({},m),{},{json:Object(n.a)(Object(n.a)({},m.json),{},{origins:{"web-document":Object(n.a)(Object(n.a)({},m.json.origins["web-document"]),{},{write:{enabled:!0,target:{opacity:{type:Number},"layerDefinition.drawingInfo.transparency":{type:Number}}}})},read:{source:["layerDefinition.drawingInfo.transparency","drawingInfo.transparency"],reader:function(e,t,r){return r&&"service"!==r.origin||!t.drawingInfo||void 0===t.drawingInfo.transparency?t.layerDefinition&&t.layerDefinition.drawingInfo&&void 0!==t.layerDefinition.drawingInfo.transparency?Object(l.b)(t.layerDefinition.drawingInfo.transparency):void 0:Object(l.b)(t.drawingInfo.transparency)}}})}),g={type:i.a,readOnly:!0,get:function(){var e,t;if(null==(e=this.layer)||!e.timeInfo)return null;var r=null==(t=this.view)?void 0:t.timeExtent,n=this.layer.timeExtent,i=this.layer.useViewTime?r&&n?r.intersection(n):r||n:n;if(!i||i.isEmpty)return i;var a=this.layer.timeOffset,o=a?i.offset(-a.value,a.unit):i,s=this._get("timeExtent");return o.equals(s)?s:o}},O={type:a.a,readOnly:!0,json:{origins:{service:{read:{source:["fullExtent","spatialReference"],reader:function(e,t){var r=a.a.fromJSON(e);return null!=t.spatialReference&&"object"==typeof t.spatialReference&&(r.spatialReference=o.a.fromJSON(t.spatialReference)),r}}}},read:!1}},j={type:String,json:{origins:{service:{read:!1},"portal-item":{read:!1}}}},_={type:Number,json:{origins:{service:{write:{enabled:!1}}},read:{source:"layerDefinition.minScale"},write:{target:"layerDefinition.minScale"}}},w={type:Number,json:{origins:{service:{write:{enabled:!1}}},read:{source:"layerDefinition.maxScale"},write:{target:"layerDefinition.maxScale"}}}},function(e,t,r){"use strict";r.d(t,"a",(function(){return p})),r.d(t,"b",(function(){return f}));var n=r(2),i=r(5),a=r(6),o=r(7),s=r(0),c=r(30),l=r(57),u=r(1),d=r(10),h=r(240),f=function(e){var t=function(e){Object(a.a)(r,e);var t=Object(o.a)(r);function r(){return Object(n.a)(this,r),t.apply(this,arguments)}return Object(i.a)(r,[{key:"destroy",value:function(){this.destroyed||(this.handles.destroy(),this.updatingHandles.destroy())}},{key:"handles",get:function(){return this._get("handles")||new l.a}},{key:"updatingHandles",get:function(){return this._get("updatingHandles")||new h.a}}]),r}(e);return Object(s.a)([Object(u.b)({readOnly:!0})],t.prototype,"handles",null),Object(s.a)([Object(u.b)({readOnly:!0})],t.prototype,"updatingHandles",null),t=Object(s.a)([Object(d.a)("esri.core.HandleOwner")],t),t},p=function(e){Object(a.a)(r,e);var t=Object(o.a)(r);function r(){return Object(n.a)(this,r),t.apply(this,arguments)}return r}(f(c.a));p=Object(s.a)([Object(d.a)("esri.core.HandleOwner")],p)},function(e,t,r){"use strict";var n=r(8),i=r.n(n),a=r(16),o=r(2),s=r(5),c=r(6),l=r(7),u=r(0),d=r(58),h=r(27),f=r(1),p=(r(17),r(18),r(15),r(10)),b=r(673),v=new d.a({simple:"simple",uniqueValue:"unique-value",classBreaks:"class-breaks",heatmap:"heatmap",dotDensity:"dot-density",dictionary:"dictionary"},{ignoreUnknown:!0}),m=function(e){Object(c.a)(r,e);var t=Object(l.a)(r);function r(e){var n;return Object(o.a)(this,r),(n=t.call(this,e)).authoringInfo=null,n.type=null,n}return Object(s.a)(r,[{key:"getRequiredFields",value:function(){var e=Object(a.a)(i.a.mark((function e(t){var r;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.collectRequiredFields){e.next=2;break}return e.abrupt("return",[]);case 2:return r=new Set,e.next=5,this.collectRequiredFields(r,t);case 5:return e.abrupt("return",Array.from(r).sort());case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getSymbol",value:function(e,t){}},{key:"getSymbolAsync",value:function(){var e=Object(a.a)(i.a.mark((function e(t,r){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"getSymbols",value:function(){return[]}},{key:"getAttributeHash",value:function(){return JSON.stringify(this)}},{key:"getMeshHash",value:function(){return JSON.stringify(this)}}]),r}(h.a);Object(u.a)([Object(f.b)({type:b.a,json:{write:!0}})],m.prototype,"authoringInfo",void 0),Object(u.a)([Object(f.b)({type:v.apiValues,readOnly:!0,json:{type:v.jsonValues,read:!1,write:{writer:v.write,ignoreOrigin:!0}}})],m.prototype,"type",void 0);var y=m=Object(u.a)([Object(p.a)("esri.renderers.Renderer")],m);t.a=y},function(e,t,r){"use strict";r.d(t,"a",(function(){return i})),r.d(t,"b",(function(){return a})),r.d(t,"c",(function(){return o}));var n=r(3);function i(e){return a((function(){return e.forEach((function(e){return Object(n.j)(e)&&e.remove()}))}))}function a(e){return{remove:function(){e&&(e(),e=void 0)}}}function o(e,t){var r=setTimeout(e,t);return a((function(){return clearTimeout(r)}))}},function(e,t,r){"use strict";var n=r(2),i=r(287),a=r(19),o=r(6),s=r(7),c=function(e){Object(o.a)(r,e);var t=Object(s.a)(r);function r(e,o,s){var c;return Object(n.a)(this,r),c=t.call(this,e,o,s),Object(a.a)(c)instanceof r?Object(i.a)(c):Object(i.a)(c,new r(e,o,s))}return r}(r(503).a);c.prototype.type="warning",t.a=c},function(e,t,r){"use strict";r.d(t,"a",(function(){return v})),r.d(t,"b",(function(){return f})),r.d(t,"c",(function(){return u})),r.d(t,"d",(function(){return C})),r.d(t,"e",(function(){return b})),r.d(t,"f",(function(){return d})),r.d(t,"g",(function(){return P})),r.d(t,"h",(function(){return l}));var n=r(96),i=r(196),a=r(9),o=r(63),s=r(4),c=r(54);function l(e,t,r){r*=.5;var n=Math.sin(r);return e[0]=n*t[0],e[1]=n*t[1],e[2]=n*t[2],e[3]=Math.cos(r),e}function u(e,t){var r=2*Math.acos(t[3]),n=Math.sin(r/2);return n>o.a?(e[0]=t[0]/n,e[1]=t[1]/n,e[2]=t[2]/n):(e[0]=1,e[1]=0,e[2]=0),r}function d(e,t,r){var n=t[0],i=t[1],a=t[2],o=t[3],s=r[0],c=r[1],l=r[2],u=r[3];return e[0]=n*u+o*s+i*l-a*c,e[1]=i*u+o*c+a*s-n*l,e[2]=a*u+o*l+n*c-i*s,e[3]=o*u-n*s-i*c-a*l,e}function h(e,t,r,n){var i,a,s,c,l,u=t[0],d=t[1],h=t[2],f=t[3],p=r[0],b=r[1],v=r[2],m=r[3];return(a=u*p+d*b+h*v+f*m)<0&&(a=-a,p=-p,b=-b,v=-v,m=-m),1-a>o.a?(i=Math.acos(a),s=Math.sin(i),c=Math.sin((1-n)*i)/s,l=Math.sin(n*i)/s):(c=1-n,l=n),e[0]=c*u+l*p,e[1]=c*d+l*b,e[2]=c*h+l*v,e[3]=c*f+l*m,e}function f(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=t[3],e}function p(e,t){var r,n=t[0]+t[4]+t[8];if(n>0)r=Math.sqrt(n+1),e[3]=.5*r,r=.5/r,e[0]=(t[5]-t[7])*r,e[1]=(t[6]-t[2])*r,e[2]=(t[1]-t[3])*r;else{var i=0;t[4]>t[0]&&(i=1),t[8]>t[3*i+i]&&(i=2);var a=(i+1)%3,o=(i+2)%3;r=Math.sqrt(t[3*i+i]-t[3*a+a]-t[3*o+o]+1),e[i]=.5*r,r=.5/r,e[3]=(t[3*a+o]-t[3*o+a])*r,e[a]=(t[3*a+i]+t[3*i+a])*r,e[o]=(t[3*o+i]+t[3*i+o])*r}return e}function b(e,t,r,n){var i=.5*Math.PI/180;t*=i,r*=i,n*=i;var a=Math.sin(t),o=Math.cos(t),s=Math.sin(r),c=Math.cos(r),l=Math.sin(n),u=Math.cos(n);return e[0]=a*c*u-o*s*l,e[1]=o*s*u+a*c*l,e[2]=o*c*l-a*s*u,e[3]=o*c*u+a*s*l,e}var v=c.c,m=c.l,y=c.a,g=d,O=c.b,j=c.d,_=c.j,w=c.e,x=w,k=c.f,S=k,T=c.k,C=c.g,M=c.h;function P(e,t,r){var n=Object(s.j)(t,r);return n<-.999999?(Object(s.i)(A,E,t),Object(s.A)(A)<1e-6&&Object(s.i)(A,R,t),Object(s.t)(A,A),l(e,A,Math.PI),e):n>.999999?(e[0]=0,e[1]=0,e[2]=0,e[3]=1,e):(Object(s.i)(A,t,r),e[0]=A[0],e[1]=A[1],e[2]=A[2],e[3]=1+n,T(e,e))}var A=Object(a.e)(),E=Object(a.g)(1,0,0),R=Object(a.g)(0,1,0);var I=Object(i.b)(),D=Object(i.b)();var F=Object(n.b)();Object.freeze({__proto__:null,identity:function(e){return e[0]=0,e[1]=0,e[2]=0,e[3]=1,e},setAxisAngle:l,getAxisAngle:u,multiply:d,rotateX:function(e,t,r){r*=.5;var n=t[0],i=t[1],a=t[2],o=t[3],s=Math.sin(r),c=Math.cos(r);return e[0]=n*c+o*s,e[1]=i*c+a*s,e[2]=a*c-i*s,e[3]=o*c-n*s,e},rotateY:function(e,t,r){r*=.5;var n=t[0],i=t[1],a=t[2],o=t[3],s=Math.sin(r),c=Math.cos(r);return e[0]=n*c-a*s,e[1]=i*c+o*s,e[2]=a*c+n*s,e[3]=o*c-i*s,e},rotateZ:function(e,t,r){r*=.5;var n=t[0],i=t[1],a=t[2],o=t[3],s=Math.sin(r),c=Math.cos(r);return e[0]=n*c+i*s,e[1]=i*c-n*s,e[2]=a*c+o*s,e[3]=o*c-a*s,e},calculateW:function(e,t){var r=t[0],n=t[1],i=t[2];return e[0]=r,e[1]=n,e[2]=i,e[3]=Math.sqrt(Math.abs(1-r*r-n*n-i*i)),e},slerp:h,random:function(e){var t=Object(o.b)(),r=Object(o.b)(),n=Object(o.b)(),i=Math.sqrt(1-t),a=Math.sqrt(t);return e[0]=i*Math.sin(2*Math.PI*r),e[1]=i*Math.cos(2*Math.PI*r),e[2]=a*Math.sin(2*Math.PI*n),e[3]=a*Math.cos(2*Math.PI*n),e},invert:function(e,t){var r=t[0],n=t[1],i=t[2],a=t[3],o=r*r+n*n+i*i+a*a,s=o?1/o:0;return e[0]=-r*s,e[1]=-n*s,e[2]=-i*s,e[3]=a*s,e},conjugate:f,fromMat3:p,fromEuler:b,str:function(e){return"quat("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+")"},copy:v,set:m,add:y,mul:g,scale:O,dot:j,lerp:_,length:w,len:x,squaredLength:k,sqrLen:S,normalize:T,exactEquals:C,equals:M,rotationTo:P,sqlerp:function(e,t,r,n,i,a){return h(I,t,i,a),h(D,r,n,a),h(e,I,D,2*a*(1-a)),e},setAxes:function(e,t,r,n){var i=F;return i[0]=r[0],i[3]=r[1],i[6]=r[2],i[1]=n[0],i[4]=n[1],i[7]=n[2],i[2]=-t[0],i[5]=-t[1],i[8]=-t[2],T(e,p(e,i))}})},function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n,i=r(12),a=r(11);function o(e){e.code.add(Object(a.a)(n||(n=Object(i.a)(["const float MAX_RGBA_FLOAT =\n255.0 / 256.0 +\n255.0 / 256.0 / 256.0 +\n255.0 / 256.0 / 256.0 / 256.0 +\n255.0 / 256.0 / 256.0 / 256.0 / 256.0;\nconst vec4 FIXED_POINT_FACTORS = vec4(1.0, 256.0, 256.0 * 256.0, 256.0 * 256.0 * 256.0);\nvec4 float2rgba(const float value) {\nfloat valueInValidDomain = clamp(value, 0.0, MAX_RGBA_FLOAT);\nvec4 fixedPointU8 = floor(fract(valueInValidDomain * FIXED_POINT_FACTORS) * 256.0);\nconst float toU8AsFloat = 1.0 / 255.0;\nreturn fixedPointU8 * toU8AsFloat;\n}\nconst vec4 RGBA_2_FLOAT_FACTORS = vec4(\n255.0 / (256.0),\n255.0 / (256.0 * 256.0),\n255.0 / (256.0 * 256.0 * 256.0),\n255.0 / (256.0 * 256.0 * 256.0 * 256.0)\n);\nfloat rgba2float(vec4 rgba) {\nreturn dot(rgba, RGBA_2_FLOAT_FACTORS);\n}"]))))}},function(e,t,r){"use strict";var n=r(2),i=r(5),a=r(6),o=r(7),s=function(e){Object(a.a)(r,e);var t=Object(o.a)(r);function r(e){var i;return Object(n.a)(this,r),(i=t.call(this))._material=e.material,i._techniqueRep=e.techniqueRep,i._output=e.output,i}return Object(i.a)(r,[{key:"technique",get:function(){return this._technique}},{key:"getPipelineState",value:function(e,t){return this.technique.pipeline}},{key:"ensureResources",value:function(e){return 2}},{key:"ensureParameters",value:function(e){}}]),r}(r(119).a);t.a=s},function(e,t,r){"use strict";function n(){return[0,0,0,1]}function i(e){return[e[0],e[1],e[2],e[3]]}function a(e,t){return new Float64Array(e,t,4)}r.d(t,"a",(function(){return o})),r.d(t,"b",(function(){return n})),r.d(t,"c",(function(){return i})),r.d(t,"d",(function(){return a}));var o=[0,0,0,1];Object.freeze({__proto__:null,create:n,clone:i,fromValues:function(e,t,r,n){return[e,t,r,n]},createView:a,IDENTITY:o})},function(e,t,r){"use strict";r.d(t,"a",(function(){return h})),r.d(t,"b",(function(){return f})),r.d(t,"c",(function(){return b})),r.d(t,"d",(function(){return p}));var n,i,a,o,s,c,l,u=r(12),d=r(11);function h(e,t){t.vvInstancingEnabled&&(t.vvSize||t.vvColor)&&e.attributes.add("instanceFeatureAttribute","vec4"),t.vvSize?(e.vertex.uniforms.add("vvSizeMinSize","vec3"),e.vertex.uniforms.add("vvSizeMaxSize","vec3"),e.vertex.uniforms.add("vvSizeOffset","vec3"),e.vertex.uniforms.add("vvSizeFactor","vec3"),e.vertex.uniforms.add("vvSymbolRotationMatrix","mat3"),e.vertex.uniforms.add("vvSymbolAnchor","vec3"),e.vertex.code.add(Object(d.a)(n||(n=Object(u.a)(["vec3 vvScale(vec4 _featureAttribute) {\nreturn clamp(vvSizeOffset + _featureAttribute.x * vvSizeFactor, vvSizeMinSize, vvSizeMaxSize);\n}\nvec4 vvTransformPosition(vec3 position, vec4 _featureAttribute) {\nreturn vec4(vvSymbolRotationMatrix * ( vvScale(_featureAttribute) * (position + vvSymbolAnchor)), 1.0);\n}"])))),e.vertex.code.add(Object(d.a)(i||(i=Object(u.a)(["\n      const float eps = 1.192092896e-07;\n      vec4 vvTransformNormal(vec3 _normal, vec4 _featureAttribute) {\n        vec3 vvScale = clamp(vvSizeOffset + _featureAttribute.x * vvSizeFactor, vvSizeMinSize + eps, vvSizeMaxSize);\n        return vec4(vvSymbolRotationMatrix * _normal / vvScale, 1.0);\n      }\n\n      ","\n    "])),t.vvInstancingEnabled?Object(d.a)(a||(a=Object(u.a)(["\n      vec4 vvLocalNormal(vec3 _normal) {\n        return vvTransformNormal(_normal, instanceFeatureAttribute);\n      }\n\n      vec4 localPosition() {\n        return vvTransformPosition(position, instanceFeatureAttribute);\n      }"]))):""))):e.vertex.code.add(Object(d.a)(o||(o=Object(u.a)(["vec4 localPosition() { return vec4(position, 1.0); }\nvec4 vvLocalNormal(vec3 _normal) { return vec4(_normal, 1.0); }"])))),t.vvColor?(e.vertex.constants.add("vvColorNumber","int",8),e.vertex.code.add(Object(d.a)(s||(s=Object(u.a)(["\n      uniform float vvColorValues[vvColorNumber];\n      uniform vec4 vvColorColors[vvColorNumber];\n\n      vec4 vvGetColor(vec4 featureAttribute, float values[vvColorNumber], vec4 colors[vvColorNumber]) {\n        float value = featureAttribute.y;\n        if (value <= values[0]) {\n          return colors[0];\n        }\n\n        for (int i = 1; i < vvColorNumber; ++i) {\n          if (values[i] >= value) {\n            float f = (value - values[i-1]) / (values[i] - values[i-1]);\n            return mix(colors[i-1], colors[i], f);\n          }\n        }\n        return colors[vvColorNumber - 1];\n      }\n\n      ","\n    "])),t.vvInstancingEnabled?Object(d.a)(c||(c=Object(u.a)(["\n      vec4 vvColor() {\n        return vvGetColor(instanceFeatureAttribute, vvColorValues, vvColorColors);\n      }"]))):""))):e.vertex.code.add(Object(d.a)(l||(l=Object(u.a)(["vec4 vvColor() { return vec4(1.0); }"]))))}function f(e,t){t.vvSizeEnabled&&(e.setUniform3fv("vvSizeMinSize",t.vvSizeMinSize),e.setUniform3fv("vvSizeMaxSize",t.vvSizeMaxSize),e.setUniform3fv("vvSizeOffset",t.vvSizeOffset),e.setUniform3fv("vvSizeFactor",t.vvSizeFactor)),t.vvColorEnabled&&(e.setUniform1fv("vvColorValues",t.vvColorValues),e.setUniform4fv("vvColorColors",t.vvColorColors))}function p(e,t){f(e,t),t.vvOpacityEnabled&&(e.setUniform1fv("vvOpacityValues",t.vvOpacityValues),e.setUniform1fv("vvOpacityOpacities",t.vvOpacityOpacities))}function b(e,t){f(e,t),t.vvSizeEnabled&&(e.setUniform3fv("vvSymbolAnchor",t.vvSymbolAnchor),e.setUniformMatrix3fv("vvSymbolRotationMatrix",t.vvSymbolRotationMatrix))}},function(e,t,r){"use strict";var n,i=r(2),a=r(5),o=r(6),s=r(7),c=r(0),l=r(27),u=r(3),d=r(1),h=(r(17),r(18),r(15),r(10)),f=r(131),p=n=function(e){Object(o.a)(r,e);var t=Object(s.a)(r);function r(){var e;return Object(i.a)(this,r),(e=t.apply(this,arguments)).color=null,e}return Object(a.a)(r,[{key:"clone",value:function(){return new n({color:Object(u.j)(this.color)?this.color.clone():null})}}]),r}(l.a);Object(c.a)([Object(d.b)(f.a)],p.prototype,"color",void 0);var b=p=n=Object(c.a)([Object(h.a)("esri.symbols.support.Symbol3DMaterial")],p);t.a=b},function(e,t,r){"use strict";r.d(t,"a",(function(){return v})),r.d(t,"b",(function(){return p})),r.d(t,"c",(function(){return f}));var n=r(3),i=r(26),a=r(31),o=r(4),s=r(9),c=r(51),l=r(65),u=r(105),d=r(84),h=r(162);function f(e,t,r,n){for(var i=e.stageObject,a=r.spatialReference,o=i.geometryRecords,s=o.length,u="absolute-height"!==t.mode,f=0,p=0;p<s;p++){var b=o[p].geometry,v=o[p].getShaderTransformation();g[0]=v[12],g[1]=v[13],g[2]=v[14],b.invalidateBoundingInfo();for(var j=b.getMutableAttribute("position"),_=j.data,x=b.vertexAttributes.get("mapPos").data,k=j.size,S=_.length/k,T=new h.a(x,a),C=0,M=!1,P=0,A=0;A<S;A++){O[0]=_[C],O[1]=_[C+1],O[2]=_[C+2];var E=Object(l.e)(T,r,t,n,u?w:null);if(u&&(P+=w.sampledElevation),d.a.DISABLE_ELEVATION_ALIGNERS_ITERATIVE_UPDATES?(_[C]=T.array[T.offset],_[C+1]=T.array[T.offset+1],_[C+2]=E,Object(c.q)(_,a,C,_,n.spatialReference,C,1),_[C]-=g[0],_[C+1]-=g[1],_[C+2]-=g[2]):(y[0]=_[C]+g[0],y[1]=_[C+1]+g[1],y[2]=_[C+2]+g[2],n.setAltitude(y,E),_[C]=y[0]-g[0],_[C+1]=y[1]-g[1],_[C+2]=y[2]-g[2]),d.a.TESTS_DISABLE_UPDATE_THRESHOLDS)M=!0;else{var R=m/n.unitInMeters;(Math.abs(O[0]-_[C])>=R||Math.abs(O[1]-_[C+1])>=R||Math.abs(O[2]-_[C+2])>=R)&&(M=!0)}C+=k,T.offset+=3}f+=P/S,M&&i.geometryVertexAttrsUpdated(p)}return f/s}function p(e,t,r,n){var a=e.stageObject,s=t.centerPointInElevationSR,h=0,f=0;if(a.metadata.usesVerticalDistanceToGround)h=Object(l.e)(s,r,t,n,w),Object(u.j)(a,w.verticalDistanceToGround),f=w.sampledElevation;else{var p="absolute-height"!==t.mode;h=Object(l.e)(s,r,t,n,p?w:null),p&&(f=w.sampledElevation)}var v=Object(i.d)(b,a.transformation),g=Object(o.y)(_,v[12],v[13],v[14]);d.a.DISABLE_ELEVATION_ALIGNERS_ITERATIVE_UPDATES?(y[0]=s.x,y[1]=s.y,y[2]=h,Object(c.d)(s.spatialReference,y,v,n.spatialReference)&&(a.transformation=v)):n.setAltitudeOfTransformation(h,v);var O=m/n.unitInMeters;return(Math.abs(v[12]-g[0])>=O||Math.abs(v[13]-g[1])>=O||Math.abs(v[14]-g[2])>=O)&&(a.transformation=v),f}var b=Object(a.d)();function v(e,t,r,i){var a=e.graphics3DSymbolLayer.lodRenderer;if(Object(n.i)(a))return 0;var s,u=t.centerPointInElevationSR,h=0,f="absolute-height"!==t.mode;s=Object(l.e)(u,r,t,i,f?w:null),f&&(h=w.sampledElevation);var p=a.instanceData,b=e.instanceIndex,v=j;p.getGlobalTransform(b,v);var g=Object(o.y)(_,v[12],v[13],v[14]);d.a.DISABLE_ELEVATION_ALIGNERS_ITERATIVE_UPDATES?(y[0]=u.x,y[1]=u.y,y[2]=s,Object(c.d)(u.spatialReference,y,v,i.spatialReference)&&p.setGlobalTransform(b,v)):i.setAltitudeOfTransformation(s,v);var O=m/i.unitInMeters;return(d.a.TESTS_DISABLE_UPDATE_THRESHOLDS||Math.abs(v[12]-g[0])>=O||Math.abs(v[13]-g[1])>=O||Math.abs(v[14]-g[2])>=O)&&p.setGlobalTransform(b,v),h}var m=.01,y=Object(s.e)(),g=Object(s.e)(),O=Object(s.e)(),j=Object(a.d)(),_=Object(s.e)(),w={verticalDistanceToGround:0,sampledElevation:0}},function(e,t,r){"use strict";r.d(t,"a",(function(){return c})),r.d(t,"b",(function(){return s})),r.d(t,"c",(function(){return o}));var n=r(114);function i(e,t){var r="?"===e[e.length-1]?e.slice(0,-1):e;if(null!=t.getItemAt||Array.isArray(t)){var i=parseInt(r,10);if(!isNaN(i))return Array.isArray(t)?t[i]:t.getItemAt(i)}var a=Object(n.a)(t);return Object(n.b)(a,r)?a.get(r):t[r]}function a(e,t,r){if(null==e)return e;var n=i(t[r],e);return!n&&r<t.length-1?void 0:r===t.length-1?n:a(n,t,r+1)}function o(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return"string"==typeof t&&-1===t.indexOf(".")?i(t,e):a(e,Object(n.f)(t),r)}function s(e,t){return o(e,t)}function c(e,t){return void 0!==o(t,e)}},function(e,t,r){"use strict";var n,i=r(2),a=r(5),o=r(6),s=r(7),c=r(0),l=r(15),u=r(3),d=r(39),h=r(1),f=(r(17),r(18),r(52)),p=r(10),b=r(161),v=r(296),m=r(484),y=r(131),g=r(559),O=r(198),j=r(434),_=l.a.getLogger("esri.symbols.IconSymbol3DLayer"),w=n=function(e){Object(o.a)(r,e);var t=Object(s.a)(r);function r(e){var n;return Object(i.a)(this,r),(n=t.call(this,e)).material=null,n.resource=null,n.type="icon",n.size=12,n.anchor="center",n.anchorPosition=void 0,n.outline=void 0,n}return Object(a.a)(r,[{key:"clone",value:function(){return new n({anchor:this.anchor,anchorPosition:this.anchorPosition&&this.anchorPosition.clone(),enabled:this.enabled,material:Object(u.j)(this.material)?this.material.clone():null,outline:Object(u.j)(this.outline)?this.outline.clone():null,resource:this.resource&&this.resource.clone(),size:this.size})}}],[{key:"fromSimpleMarkerSymbol",value:function(e){var t=e.color||v.c,r=x(e),i=e.outline&&e.outline.width>0?{size:e.outline.width,color:(e.outline.color||v.c).clone()}:null;return new n({size:e.size,resource:{primitive:T(e.style)},material:{color:t},outline:i,anchor:r?"relative":void 0,anchorPosition:r})}},{key:"fromPictureMarkerSymbol",value:function(e){var t=!e.color||Object(v.a)(e.color)?v.c:e.color,r=x(e);return new n({size:e.width<=e.height?e.height:e.width,resource:{href:e.url},material:{color:t.clone()},anchor:r?"relative":void 0,anchorPosition:r})}},{key:"fromCIMSymbol",value:function(e){return new n({resource:{href:Object(d.B)({mediaType:"application/json",data:JSON.stringify(e.data)})}})}}]),r}(b.a);function x(e){var t="width"in e?e.width:e.size,r="height"in e?e.height:e.size,n=k(e.xoffset),i=k(e.yoffset);return(n||i)&&t&&r?{x:-n/t,y:i/r}:null}function k(e){return isFinite(e)?e:0}Object(c.a)([Object(h.b)({type:O.a,json:{write:!0}})],w.prototype,"material",void 0),Object(c.a)([Object(h.b)({type:m.a,json:{write:!0}})],w.prototype,"resource",void 0),Object(c.a)([Object(f.a)({Icon:"icon"},{readOnly:!0})],w.prototype,"type",void 0),Object(c.a)([Object(h.b)(y.b)],w.prototype,"size",void 0),Object(c.a)([Object(f.a)({center:"center",left:"left",right:"right",top:"top",bottom:"bottom",topLeft:"top-left",topRight:"top-right",bottomLeft:"bottom-left",bottomRight:"bottom-right",relative:"relative"}),Object(h.b)({json:{default:"center"}})],w.prototype,"anchor",void 0),Object(c.a)([Object(h.b)({type:g.a,json:{type:[Number],read:{reader:function(e){return new g.a({x:e[0],y:e[1]})}},write:{writer:function(e,t){t.anchorPosition=[e.x,e.y]},overridePolicy:function(){return{enabled:"relative"===this.anchor}}}}})],w.prototype,"anchorPosition",void 0),Object(c.a)([Object(h.b)({type:j.a,json:{write:!0}})],w.prototype,"outline",void 0),w=n=Object(c.a)([Object(p.a)("esri.symbols.IconSymbol3DLayer")],w);var S={circle:"circle",cross:"cross",diamond:"kite",square:"square",x:"x",triangle:"triangle",path:null};function T(e){return S[e]||(_.warn("".concat(e,' cannot be mapped to Icon symbol. Fallback to "circle"')),"circle")}var C=w;t.a=C},function(e,t,r){"use strict";r.d(t,"a",(function(){return b})),r.d(t,"b",(function(){return m})),r.d(t,"c",(function(){return x})),r.d(t,"d",(function(){return k})),r.d(t,"e",(function(){return j})),r.d(t,"f",(function(){return y})),r.d(t,"g",(function(){return S})),r.d(t,"h",(function(){return v})),r.d(t,"i",(function(){return w})),r.d(t,"j",(function(){return O})),r.d(t,"k",(function(){return _}));var n=r(13),i=r(2),a=r(461),o=(r(17),r(3)),s=r(94),c=r(182),l=r(55),u=r(34),d=r(40),h=r(293),f=r(241),p=r(314),b=(r(585),function e(t,r,n){Object(i.a)(this,e),this.uid=t,this.geometry=r,this.attributes=n,this.visible=!0,this.objectId=null,this.centroid=null});function v(e){return Object(o.j)(e.geometry)}var m=function e(){Object(i.a)(this,e),this.exceededTransferLimit=!1,this.features=[],this.fields=[],this.hasM=!1,this.hasZ=!1,this.geometryType=null,this.objectIdFieldName=null,this.globalIdFieldName=null,this.geometryProperties=null,this.geohashFieldName=null,this.spatialReference=null,this.transform=null};function y(e){var t=f.a.fromJSON(e.geometryType),r=l.a.fromJSON(e.spatialReference),n=e.transform,i=e.features.map((function(i){var a=function(e,t,r,n){return{uid:Object(c.b)(),objectId:n&&e.attributes?e.attributes[n]:null,attributes:e.attributes,geometry:g(e.geometry,t,r),visible:!0}}(i,t,r,e.objectIdFieldName),s=a.geometry;if(Object(o.j)(s)&&n)switch(s.type){case"point":a.geometry=Object(h.c)(n,s,s,s.hasZ,s.hasM);break;case"multipoint":a.geometry=Object(h.b)(n,s,s,s.hasZ,s.hasM);break;case"polygon":a.geometry=Object(h.d)(n,s,s,s.hasZ,s.hasM);break;case"polyline":a.geometry=Object(h.e)(n,s,s,s.hasZ,s.hasM);break;case"extent":case"mesh":a.geometry=s}return a}));return{geometryType:t,features:i,spatialReference:r,fields:e.fields?e.fields.map((function(e){return p.a.fromJSON(e)})):null,objectIdFieldName:e.objectIdFieldName,globalIdFieldName:e.globalIdFieldName,geohashFieldName:e.geohashFieldName,geometryProperties:e.geometryProperties,hasZ:e.hasZ,hasM:e.hasM,exceededTransferLimit:e.exceededTransferLimit,transform:null}}function g(e,t,r){if(!e)return null;switch(t){case"point":var n=e;return{x:n.x,y:n.y,z:n.z,m:n.m,hasZ:null!=n.z,hasM:null!=n.m,type:"point",spatialReference:r};case"polyline":var i=e;return{paths:i.paths,hasZ:!!i.hasZ,hasM:!!i.hasM,type:"polyline",spatialReference:r};case"polygon":var a=e;return{rings:a.rings,hasZ:!!a.hasZ,hasM:!!a.hasM,type:"polygon",spatialReference:r};case"multipoint":var o=e;return{points:o.points,hasZ:!!o.hasZ,hasM:!!o.hasM,type:"multipoint",spatialReference:r}}}function O(e,t,r,n){return{x:e,y:t,z:r,hasZ:null!=r,hasM:!1,spatialReference:n,type:"point"}}function j(e){var t=32;return t+=Object(a.a)(e.attributes),t+=3,t+=8+function(e){if(Object(o.i)(e))return 0;var t=32;switch(e.type){case"point":t+=42;break;case"polyline":case"polygon":var r,i=0,a=2+(e.hasZ?1:0)+(e.hasM?1:0),c="polyline"===e.type?e.paths:e.rings,l=Object(n.a)(c);try{for(l.s();!(r=l.n()).done;)i+=r.value.length}catch(h){l.e(h)}finally{l.f()}t+=8*i*a+64,t+=128*i,t+=34,t+=32*(c.length+1);break;case"multipoint":var u=2+(e.hasZ?1:0)+(e.hasM?1:0),d=e.points.length;t+=8*d*u+64,t+=128*d,t+=34,t+=32;break;case"extent":t+=98,e.hasM&&(t+=32),e.hasZ&&(t+=32);break;case"mesh":t+=Object(s.a)(e.vertexAttributes.position),t+=Object(s.a)(e.vertexAttributes.normal),t+=Object(s.a)(e.vertexAttributes.uv),t+=Object(s.a)(e.vertexAttributes.tangent)}return t}(e.geometry)}function _(e){if(Object(o.i)(e))return 0;switch(e.type){case"point":return 1;case"polyline":var t,r=0,i=Object(n.a)(e.paths);try{for(i.s();!(t=i.n()).done;){r+=t.value.length}}catch(u){i.e(u)}finally{i.f()}return r;case"polygon":var a,s=0,c=Object(n.a)(e.rings);try{for(c.s();!(a=c.n()).done;){s+=a.value.length}}catch(u){c.e(u)}finally{c.f()}return s;case"multipoint":return e.points.length;case"extent":return 2;case"mesh":var l=e.vertexAttributes&&e.vertexAttributes.position;return l?l.length/3:0;default:return}}function w(e){if(Object(o.i)(e))return!1;switch(e.type){case"extent":case"point":return!0;case"polyline":var t,r=Object(n.a)(e.paths);try{for(r.s();!(t=r.n()).done;){if(t.value.length>0)return!0}}catch(s){r.e(s)}finally{r.f()}return!1;case"polygon":var i,a=Object(n.a)(e.rings);try{for(a.s();!(i=a.n()).done;){if(i.value.length>0)return!0}}catch(s){a.e(s)}finally{a.f()}return!1;case"multipoint":return e.points.length>0;case"mesh":return!e.loaded||e.vertexAttributes.position.length>0}}function x(e,t){switch(Object(u.k)(t),"mesh"===e.type&&(e=e.extent),e.type){case"point":t[0]=t[3]=e.x,t[1]=t[4]=e.y,e.hasZ&&(t[2]=t[5]=e.z);break;case"polyline":for(var r=0;r<e.paths.length;r++)Object(u.o)(t,e.paths[r],e.hasZ);break;case"polygon":for(var n=0;n<e.rings.length;n++)Object(u.o)(t,e.rings[n],e.hasZ);break;case"multipoint":Object(u.o)(t,e.points,e.hasZ);break;case"extent":t[0]=e.xmin,t[1]=e.ymin,t[3]=e.xmax,t[4]=e.ymax,null!=e.zmin&&(t[2]=e.zmin),null!=e.zmax&&(t[5]=e.zmax)}}function k(e,t){switch(Object(d.m)(t),"mesh"===e.type&&(e=e.extent),e.type){case"point":t[0]=t[2]=e.x,t[1]=t[3]=e.y;break;case"polyline":for(var r=0;r<e.paths.length;r++)Object(d.q)(t,e.paths[r]);break;case"polygon":for(var n=0;n<e.rings.length;n++)Object(d.q)(t,e.rings[n]);break;case"multipoint":Object(d.q)(t,e.points);break;case"extent":t[0]=e.xmin,t[1]=e.ymin,t[2]=e.xmax,t[3]=e.ymax}}function S(e,t){return null!=e.objectId?e.objectId:e.attributes&&t?e.attributes[t]:null}Object(u.h)(),Object(d.k)()},function(e,t,r){"use strict";function n(){return new Float32Array(4)}function i(e){var t=new Float32Array(4);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t}function a(e,t,r,n){var i=new Float32Array(4);return i[0]=e,i[1]=t,i[2]=r,i[3]=n,i}function o(){return n()}function s(){return a(1,1,1,1)}function c(){return a(1,0,0,0)}function l(){return a(0,1,0,0)}function u(){return a(0,0,1,0)}function d(){return a(0,0,0,1)}r.d(t,"a",(function(){return i})),r.d(t,"b",(function(){return n})),r.d(t,"c",(function(){return a}));var h=o(),f=s(),p=c(),b=l(),v=u(),m=d();Object.freeze({__proto__:null,create:n,clone:i,fromValues:a,createView:function(e,t){return new Float32Array(e,t,4)},zeros:o,ones:s,unitX:c,unitY:l,unitZ:u,unitW:d,ZEROS:h,ONES:f,UNIT_X:p,UNIT_Y:b,UNIT_Z:v,UNIT_W:m})},function(e,t,r){"use strict";r.d(t,"a",(function(){return c})),r.d(t,"b",(function(){return u})),r.d(t,"c",(function(){return d}));var n=r(2),i=r(25),a=r(3),o=r(114),s=function e(t){Object(n.a)(this,e),this.autoDestroy=!1,this.properties=t};function c(e){var t=e.constructor.__accessorMetadata__,r=Object.prototype.hasOwnProperty.call(e.constructor,"__accessorMetadata__");if(t){if(!r){var n=Object.create(t.properties),o=t.autoDestroy;for(var c in n)n[c]=Object(i.a)(n[c]);(t=new s(n)).autoDestroy=o,Object.defineProperty(e.constructor,"__accessorMetadata__",{value:t,enumerable:!1,configurable:!0,writable:!0})}}else t=new s({}),Object.defineProperty(e.constructor,"__accessorMetadata__",{value:t,enumerable:!1,configurable:!0,writable:!0});return Object(a.d)(e.constructor.__accessorMetadata__)}function l(e){return c(e).properties}function u(e,t){var r=l(e),n=r[t];return n||(n=r[t]={}),n}function d(e,t){return Object(o.c)(e,t,f)}var h=/^(?:[^.]+\.)?(?:value|type|(?:json\.type|json\.origins\.[^.]\.type))$/;function f(e){return h.test(e)?"replace":"merge"}},function(e,t,r){"use strict";var n=r(2),i=r(5),a=r(22),o=r(20),s=r(3),c=r(69),l=r(66),u=r(51),d=r(55),h=r(40),f=r(59),p=r(61),b=r(413),v=function(){function e(t){Object(n.a)(this,e);var r=e.checkUnsupported(t);if(r)throw r;this.spatialReference=t.spatialReference,this._isWebMercator=this.spatialReference.isWebMercator,this._isGCS=Object(u.a)(this.spatialReference)||Object(f.h)(this.spatialReference)||Object(f.i)(this.spatialReference),this.origin=[t.origin.x,t.origin.y],this.pixelSize=t.size[0],this.dpi=t.dpi;var i=t.lods.reduce((function(e,t,r){return t.level<e.min&&(e.min=t.level,e.minIndex=r),e.max=Math.max(e.max,t.level),e}),{min:1/0,minIndex:0,max:-1/0}),a=t.lods[i.minIndex],o=Math.pow(2,a.level),s=a.resolution*o,c=a.scale*o;this.levels=new Array(i.max+1);for(var l=0;l<this.levels.length;l++)this.levels[l]={resolution:s,scale:c,tileSize:[s*t.size[0],s*t.size[1]]},s/=2,c/=2}return Object(i.a)(e,[{key:"clone",value:function(){return new e(this.toTileInfo())}},{key:"toTileInfo",value:function(){return new b.a({dpi:this.dpi,origin:{x:this.origin[0],y:this.origin[1],spatialReference:this.spatialReference},size:[this.pixelSize,this.pixelSize],spatialReference:this.spatialReference,lods:this.levels.map((function(e,t){return{level:t,scale:e.scale,resolution:e.resolution}}))})}},{key:"getExtent",value:function(e,t,r,n){var i=this.levels[e],a=i.tileSize[0],o=i.tileSize[1];n[0]=this.origin[0]+r*a,n[2]=n[0]+a,n[3]=this.origin[1]-t*o,n[1]=n[3]-o}},{key:"convertExtentToRadians",value:function(e,t){this._isWebMercator?(t[0]=Object(p.f)(e[0]),t[1]=Object(p.h)(e[1]),t[2]=Object(p.f)(e[2]),t[3]=Object(p.h)(e[3])):this._isGCS&&(t[0]=Object(o.g)(e[0]),t[1]=Object(o.g)(e[1]),t[2]=Object(o.g)(e[2]),t[3]=Object(o.g)(e[3]))}},{key:"getExtentGeometry",value:function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new l.a;return this.getExtent(e,t,r,m),n.spatialReference=this.spatialReference,n.xmin=m[0],n.ymin=m[1],n.xmax=m[2],n.ymax=m[3],n.zmin=void 0,n.zmax=void 0,n}},{key:"ensureMaxLod",value:function(e){if(null==e)return!1;for(var t=!1;this.levels.length<=e;){var r=this.levels[this.levels.length-1],n=r.resolution/2;this.levels.push({resolution:n,scale:r.scale/2,tileSize:[n*this.pixelSize,n*this.pixelSize]}),t=!0}return t}},{key:"capMaxLod",value:function(e){this.levels.length>e+1&&(this.levels.length=e+1)}},{key:"getMaxLod",value:function(){return this.levels.length-1}},{key:"scaleAtLevel",value:function(e){return this.levels[0].scale/Math.pow(2,e)}},{key:"levelAtScale",value:function(e){var t=this.levels[0].scale;return e>=t?0:Math.log(t/e)*Math.LOG2E}},{key:"resolutionAtLevel",value:function(e){return this.levels[0].resolution/Math.pow(2,e)}},{key:"compatibleWith",value:function(t){if(!(t instanceof e)){if(e.checkUnsupported(t))return!1;t=new e(t)}if(!t.spatialReference.equals(this.spatialReference))return!1;if(t.pixelSize!==this.pixelSize)return!1;var r=Math.min(this.levels.length,t.levels.length)-1,n=this.levels[r].resolution,i=.5*n;return!(!Object(o.h)(t.origin[0],this.origin[0],i)||!Object(o.h)(t.origin[1],this.origin[1],i))&&(i=.5*n/Math.pow(2,r)/this.pixelSize*12,Object(o.h)(n,t.levels[r].resolution,i))}},{key:"rootTilesInExtent",value:function(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1/0,i=this.levels[0].tileSize;if(0===i[0]||0===i[1])return[];e.computeRowColExtent(t,i,this.origin,m);var a=m[1],o=m[3],c=m[0],l=m[2],u=l-c,d=o-a;if(u*d>n){var h=Math.floor(Math.sqrt(n));d>h&&(o=(a=a+Math.floor(.5*d)-Math.floor(.5*h))+h),u>h&&(l=(c=c+Math.floor(.5*u)-Math.floor(.5*h))+h)}for(var f=[],p=a;p<o;p++)for(var b=c;b<l;b++)f.push([0,p,b]);return Object(s.j)(r)&&(r[0]=this.origin[0]+c*i[0],r[1]=this.origin[1]-o*i[1],r[2]=this.origin[0]+l*i[0],r[3]=this.origin[1]-a*i[1]),f}},{key:"test",get:function(){return{isWebMercator:this._isWebMercator,isGCS:this._isGCS}}}],[{key:"computeRowColExtent",value:function(e,t,r,n){var i=.001*(e[2]-e[0]+(e[3]-e[1]));n[0]=Math.max(0,Math.floor((e[0]+i-r[0])/t[0])),n[2]=Math.max(0,Math.ceil((e[2]-i-r[0])/t[0])),n[1]=Math.max(0,Math.floor((r[1]-e[3]+i)/t[1])),n[3]=Math.max(0,Math.ceil((r[1]-e[1]-i)/t[1]))}},{key:"isPowerOfTwo",value:function(e){var t=e.lods,r=t[0].resolution*Math.pow(2,t[0].level);return!t.some((function(e){return!Object(o.i)(e.resolution,r/Math.pow(2,e.level))}))}},{key:"hasGapInLevels",value:function(e){var t=e.lods.map((function(e){return e.level}));t.sort((function(e,t){return e-t}));for(var r=1;r<t.length;r++)if(t[r]!==t[0]+r)return!0;return!1}},{key:"tileSizeSupported",value:function(e){var t=e.size[1];return t===e.size[0]&&0==(t&t-1)&&t>=128&&t<=512}},{key:"checkUnsupported",value:function(t){return t?t.lods.length<1?new a.a("tilingscheme:generic","Tiling scheme must have at least one level"):e.isPowerOfTwo(t)?e.hasGapInLevels(t)?new a.a("tilingscheme:gaps","Tiling scheme levels must not have gaps between min and max level"):e.tileSizeSupported(t)?null:new a.a("tilingscheme:tile-size","Tiles must be square and size must be one of [128, 256, 512]"):new a.a("tilingscheme:power-of-two","Tiling scheme must be power of two"):new a.a("tilingscheme:tile-info-missing","Tiling scheme must have tiling information")}},{key:"fromExtent",value:function(t,r){var n=t[2]-t[0],i=t[3]-t[1],a=Object(c.f)(r),o=1.2*Math.max(n,i),s=256,l=new e(new b.a({size:[s,s],origin:{x:t[0]-.5*(o-n),y:t[3]+.5*(o-i)},lods:[{level:0,resolution:o/s,scale:1/(s/96*.0254/(o*a))}],spatialReference:r}));return l.ensureMaxLod(20),l}},{key:"makeWebMercatorAuxiliarySphere",value:function(t){var r=new e(e.WebMercatorAuxiliarySphereTileInfo);return r.ensureMaxLod(t),r}},{key:"makeGCSWithTileSize",value:function(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:256,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:16,i=256/r,a=new e(new b.a({size:[r,r],origin:{x:-180,y:90,spatialReference:t},spatialReference:t,lods:[{level:0,resolution:.703125*i,scale:295497598.570834*i}]}));return a.ensureMaxLod(n),a}}]),e}();v.WebMercatorAuxiliarySphereTileInfo=new b.a({size:[256,256],origin:{x:-20037508.342787,y:20037508.342787,spatialReference:d.a.WebMercator},spatialReference:d.a.WebMercator,lods:[{level:0,resolution:156543.03392800014,scale:591657527.591555}]}),v.WebMercatorAuxiliarySphere=v.makeWebMercatorAuxiliarySphere(19);var m=Object(h.k)();t.a=v},function(e,t,r){"use strict";r.d(t,"a",(function(){return L}));var n=r(8),i=r.n(n),a=r(16),o=r(2),s=r(5),c=r(6),l=r(7),u=r(134),d=r(22),h=r(82),f=r(20),p=r(3),b=r(23),v=r(94),m=r(39),y=r(156),g=r(505),O=r(427),j=r(247),_=r(15),w=r(60),x=_.a.getLogger("esri.views.3d.webgl-engine.lib.DDSUtil"),k=542327876,S=131072;function T(e){return e.charCodeAt(0)+(e.charCodeAt(1)<<8)+(e.charCodeAt(2)<<16)+(e.charCodeAt(3)<<24)}var C=T("DXT1"),M=T("DXT3"),P=T("DXT5");function A(e,t,r){var n=function(e,t){var r=new Int32Array(e,0,31);if(r[0]!==k)return x.error("Invalid magic number in DDS header"),null;if(!(4&r[20]))return x.error("Unsupported format, must contain a FourCC code"),null;var n,i,a=r[21];switch(a){case C:n=8,i=33776;break;case M:n=16,i=33778;break;case P:n=16,i=33779;break;default:return x.error("Unsupported FourCC code:",function(e){return String.fromCharCode(255&e,e>>8&255,e>>16&255,e>>24&255)}(a)),null}var o=1,s=r[4],c=r[3];0==(3&s)&&0==(3&c)||(x.warn("Rounding up compressed texture size to nearest multiple of 4."),s=s+3&-4,c=c+3&-4);var l,u,d=s,h=c;r[2]&S&&!1!==t&&(o=Math.max(1,r[7])),1===o||Object(f.l)(s)&&Object(f.l)(c)||(x.warn("Ignoring mipmaps of non power of two sized compressed texture."),o=1);for(var p=r[1]+4,b=[],v=0;v<o;++v)u=(s+3>>2)*(c+3>>2)*n,l=new Uint8Array(e,p,u),b.push(l),p+=u,s=Math.max(1,s>>1),c=Math.max(1,c>>1);return{textureData:{type:"compressed",levels:b},internalFormat:i,width:d,height:h}}(r,t.hasMipmap),i=n.textureData,a=n.internalFormat,o=n.width,s=n.height;return t.samplingMode=i.levels.length>1?9987:9729,t.hasMipmap=i.levels.length>1,t.internalFormat=a,t.width=o,t.height=s,new w.a(e,t,i)}var E=r(124),R=r(46),I=r(107),D=r(92),F=r(157),L=function(e){Object(c.a)(r,e);var t=Object(l.a)(r);function r(e,n){var i;return Object(o.a)(this,r),(i=t.call(this)).data=e,i.type=4,i.glTexture=null,i.powerOfTwoStretchInfo=null,i.loadingPromise=null,i.loadingController=null,i.events=new h.a,i.params=n||{},i.params.mipmap=!1!==i.params.mipmap,i.params.noUnpackFlip=i.params.noUnpackFlip||!1,i.params.preMultiplyAlpha=i.params.preMultiplyAlpha||!1,i.params.wrap=i.params.wrap||{s:10497,t:10497},i.params.powerOfTwoResizeMode=i.params.powerOfTwoResizeMode||1,i.estimatedTexMemRequired=r.estimateTexMemRequired(i.data,i.params),i.startPreload(),i}return Object(s.a)(r,[{key:"startPreload",value:function(){var e=this.data;Object(p.i)(e)||(e instanceof HTMLVideoElement?this.startPreloadVideoElement(e):e instanceof HTMLImageElement&&this.startPreloadImageElement(e))}},{key:"startPreloadVideoElement",value:function(e){Object(m.t)(e.src)||"auto"===e.preload&&e.crossOrigin||(e.preload="auto",e.crossOrigin="anonymous",e.src=e.src)}},{key:"startPreloadImageElement",value:function(e){Object(m.u)(e.src)||Object(m.t)(e.src)||e.crossOrigin||(e.crossOrigin="anonymous",e.src=e.src)}},{key:"dispose",value:function(){this.data=void 0}},{key:"width",get:function(){return this.params.width}},{key:"height",get:function(){return this.params.height}},{key:"createDescriptor",value:function(e){var t;return{target:3553,pixelFormat:6408,dataType:5121,wrapMode:this.params.wrap,flipped:!this.params.noUnpackFlip,samplingMode:this.params.mipmap?9987:9729,hasMipmap:this.params.mipmap,preMultiplyAlpha:this.params.preMultiplyAlpha,maxAnisotropy:null!=(t=this.params.maxAnisotropy)?t:this.params.mipmap?e.parameters.maxMaxAnisotropy:1}}},{key:"load",value:function(e,t){if(Object(p.j)(this.glTexture))return this.glTexture;if(Object(p.j)(this.loadingPromise))return this.loadingPromise;var n=this.data;return Object(p.i)(n)?(this.glTexture=new w.a(e,this.createDescriptor(e),null),this.glTexture):"string"==typeof n?this.loadFromURL(e,t,n):n instanceof Image?this.loadFromImageElement(e,t,n):n instanceof HTMLVideoElement?this.loadFromVideoElement(e,t,n):n instanceof ImageData||n instanceof HTMLCanvasElement?this.loadFromImage(e,n,t):(Object(v.c)(n)||Object(v.k)(n))&&this.params.encoding===r.DDS_ENCODING?this.loadFromDDSData(e,n):(Object(v.c)(n)||Object(v.k)(n))&&this.params.encoding===r.KTX2_ENCODING?this.loadFromKTX2(e,n):(Object(v.c)(n)||Object(v.k)(n))&&this.params.encoding===r.BASIS_ENCODING?this.loadFromBasis(e,n):Object(v.k)(n)?this.loadFromPixelData(e,n):Object(v.c)(n)?this.loadFromPixelData(e,new Uint8Array(n)):null}},{key:"requiresFrameUpdates",get:function(){return this.data instanceof HTMLVideoElement}},{key:"frameUpdate",value:function(e,t,r){if(!(this.data instanceof HTMLVideoElement)||Object(p.i)(this.glTexture))return r;if(this.data.readyState<2||r===this.data.currentTime)return r;if(Object(p.j)(this.powerOfTwoStretchInfo)){var n=this.powerOfTwoStretchInfo,i=n.framebuffer,a=n.vao,o=n.sourceTexture;o.setData(this.data),this.drawStretchedTexture(e,t,i,a,o,this.glTexture)}else{var s=this.data,c=s.width,l=s.height,u=this.glTexture.descriptor,d=u.width,h=u.height;c!==d||l!==h?this.glTexture.updateData(0,0,0,Math.min(c,d),Math.min(l,h),this.data):this.glTexture.setData(this.data)}return this.glTexture.descriptor.hasMipmap&&this.glTexture.generateMipmap(),this.data.currentTime}},{key:"loadFromDDSData",value:function(e,t){return this.glTexture=A(e,this.createDescriptor(e),t),this.glTexture}},{key:"loadFromKTX2",value:function(e,t){var r=this;return this.loadAsync((function(){return Object(O.b)(e,r.createDescriptor(e),t).then((function(e){return r.glTexture=e,e}))}))}},{key:"loadFromBasis",value:function(e,t){var r=this;return this.loadAsync((function(){return Object(O.a)(e,r.createDescriptor(e),t).then((function(e){return r.glTexture=e,e}))}))}},{key:"loadFromPixelData",value:function(e,t){Object(R.a)(this.params.width>0&&this.params.height>0);var r=this.createDescriptor(e);return r.pixelFormat=1===this.params.components?6409:3===this.params.components?6407:6408,r.width=this.params.width,r.height=this.params.height,this.glTexture=new w.a(e,r,t),this.glTexture}},{key:"loadAsync",value:function(e){var t=this,r=Object(b.e)();this.loadingController=r;var n=e(r.signal);this.loadingPromise=n;var i=function(){t.loadingController===r&&(t.loadingController=null),t.loadingPromise===n&&(t.loadingPromise=null)};return n.then(i,i),n}},{key:"loadFromURL",value:function(e,t,r){var n=this;return this.loadAsync(function(){var o=Object(a.a)(i.a.mark((function a(o){var s;return i.a.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,Object(y.a)(r,{signal:o});case 2:return s=i.sent,i.abrupt("return",n.loadFromImage(e,s,t));case 4:case"end":return i.stop()}}),a)})));return function(e){return o.apply(this,arguments)}}())}},{key:"loadFromImageElement",value:function(e,t,r){var n=this;return r.complete?this.loadFromImage(e,r,t):this.loadAsync(function(){var o=Object(a.a)(i.a.mark((function a(o){var s;return i.a.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,Object(g.a)(r,r.src,!1,o);case 2:return s=i.sent,i.abrupt("return",n.loadFromImage(e,s,t));case 4:case"end":return i.stop()}}),a)})));return function(e){return o.apply(this,arguments)}}())}},{key:"loadFromVideoElement",value:function(e,t,r){return r.readyState>=2?this.loadFromImage(e,r,t):this.loadFromVideoElementAsync(e,t,r)}},{key:"loadFromVideoElementAsync",value:function(e,t,r){var n=this;return this.loadAsync((function(i){return new Promise((function(a,o){var s=function(){r.removeEventListener("loadeddata",c),r.removeEventListener("error",l),Object(p.j)(u)&&u.remove()},c=function(){r.readyState>=2&&(s(),a(n.loadFromImage(e,r,t)))},l=function(e){s(),o(e||new d.a("Failed to load video"))};r.addEventListener("loadeddata",c),r.addEventListener("error",l);var u=Object(b.s)(i,(function(){return l(Object(b.f)())}))}))}))}},{key:"loadFromImage",value:function(e,t,n){var i=r.getDataDimensions(t);this.params.width=i.width,this.params.height=i.height;var a=this.createDescriptor(e);return a.pixelFormat=3===this.params.components?6407:6408,!this.requiresPowerOfTwo(e,a)||Object(f.l)(i.width)&&Object(f.l)(i.height)?(a.width=i.width,a.height=i.height,this.glTexture=new w.a(e,a,t),this.glTexture):(this.glTexture=this.makePowerOfTwoTexture(e,t,i,a,n),this.glTexture)}},{key:"requiresPowerOfTwo",value:function(e,t){var r=33071,n="number"==typeof t.wrapMode?t.wrapMode===r:t.wrapMode.s===r&&t.wrapMode.t===r;return!Object(F.a)(e.gl)&&(t.hasMipmap||!n)}},{key:"makePowerOfTwoTexture",value:function(e,t,r,n,i){var a,o=r.width,s=r.height,c=Object(f.p)(o),l=Object(f.p)(s);switch(n.width=c,n.height=l,this.params.powerOfTwoResizeMode){case 2:n.textureCoordinateScaleFactor=[o/c,s/l],(a=new w.a(e,n)).updateData(0,0,0,o,s,t);break;case 1:case null:case void 0:a=this.stretchToPowerOfTwo(e,t,n,i);break;default:Object(u.a)(this.params.powerOfTwoResizeMode)}return n.hasMipmap&&a.generateMipmap(),a}},{key:"stretchToPowerOfTwo",value:function(e,t,r,n){var i=new w.a(e,r),a=new I.a(e,{colorTarget:0,depthStencilTarget:0},i),o=new w.a(e,{target:3553,pixelFormat:r.pixelFormat,dataType:5121,wrapMode:33071,samplingMode:9729,flipped:!!r.flipped,maxAnisotropy:8,preMultiplyAlpha:r.preMultiplyAlpha},t),s=Object(E.d)(e);return this.drawStretchedTexture(e,n,a,s,o,i),this.requiresFrameUpdates?this.powerOfTwoStretchInfo={vao:s,sourceTexture:o,framebuffer:a}:(s.dispose(!0),o.dispose(),a.detachColorTexture(),e.bindFramebuffer(null),a.dispose()),i}},{key:"drawStretchedTexture",value:function(e,t,r,n,i,a){e.bindFramebuffer(r);var o=e.getViewport();e.setViewport(0,0,a.descriptor.width,a.descriptor.height);var s=t.program;e.useProgram(s),s.setUniform4f("color",1,1,1,1),s.bindTexture(i,"tex"),e.bindVAO(n),e.setPipelineState(t.pipeline),e.drawArrays(5,0,Object(D.f)(n,"geometry")),e.bindFramebuffer(null),e.setViewport(o.x,o.y,o.width,o.height)}},{key:"unload",value:function(){if(Object(p.j)(this.powerOfTwoStretchInfo)){var e=this.powerOfTwoStretchInfo,t=e.framebuffer,r=e.vao,n=e.sourceTexture;r.dispose(!0),n.dispose(),t.dispose(),this.glTexture=null,this.powerOfTwoStretchInfo=null}if(Object(p.j)(this.glTexture)&&(this.glTexture.dispose(),this.glTexture=null),Object(p.j)(this.loadingController)){var i=this.loadingController;this.loadingController=null,this.loadingPromise=null,i.abort()}this.events.emit("unloaded")}}],[{key:"getDataDimensions",value:function(e){return e instanceof HTMLVideoElement?{width:e.videoWidth,height:e.videoHeight}:e}},{key:"estimateTexMemRequired",value:function(e,t){if(Object(p.i)(e))return 0;if(Object(v.c)(e)||Object(v.k)(e))return t.encoding===r.KTX2_ENCODING?Object(O.d)(e,t.mipmap):t.encoding===r.BASIS_ENCODING?Object(O.c)(e,t.mipmap):e.byteLength;var n=e instanceof Image||e instanceof ImageData||e instanceof HTMLCanvasElement||e instanceof HTMLVideoElement?r.getDataDimensions(e):t,i=n.width,a=n.height;return(t.mipmap?4/3:1)*i*a*(t.components||4)||0}}]),r}(j.a);L.DDS_ENCODING="image/vnd-ms.dds",L.KTX2_ENCODING="image/ktx2",L.BASIS_ENCODING="image/x.basis"},function(e,t,r){"use strict";r.d(t,"a",(function(){return a})),r.d(t,"b",(function(){return i}));var n=r(53);function i(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:n.a;return t||(t=new r),t===e||(t.removeAll(),o(e)?t.addMany(e):e&&t.add(e)),t}function a(e){return e}function o(e){return e&&(Array.isArray(e)||"items"in e&&Array.isArray(e.items))}},function(e,t,r){"use strict";r.d(t,"a",(function(){return u})),r.d(t,"b",(function(){return h})),r.d(t,"c",(function(){return l})),r.d(t,"d",(function(){return d}));var n=r(3),i=r(28),a=r(29),o=r(4),s=r(79),c=r(47);function l(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Object(s.c)();return u(e,e.screenToRender(t,Object(i.b)(c.c.get())),r)}function u(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Object(s.c)(),l=Object(i.b)(Object(a.c)(c.c.get(),t));if(l[2]=0,!e.unprojectFromRenderScreen(l,r.origin))return null;var u=Object(i.b)(Object(a.c)(c.c.get(),t));u[2]=1;var d=e.unprojectFromRenderScreen(u,c.c.get());return Object(n.i)(d)?null:(Object(o.l)(r.direction,d,r.origin),r)}function d(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Object(s.c)();return h(e,e.screenToRender(t,Object(i.b)(c.c.get())),r)}function h(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Object(s.c)();Object(o.m)(r.origin,e.eye);var i=Object(o.y)(c.c.get(),t[0],t[1],1),a=e.unprojectFromRenderScreen(i,c.c.get());return Object(n.i)(a)?null:(Object(o.l)(r.direction,a,r.origin),r)}},function(e,t,r){"use strict";r.d(t,"a",(function(){return c}));var n=r(13),i=r(2),a=r(5),o=r(502),s=r(309),c=function(){function e(t,r){var n=this;for(var a in Object(i.a)(this,e),this.owner=r,this.properties={},this.afterDispatchHandle=null,t){var c=t[a],l=new o.a(c,null,null,2,2);this.properties[a]={pool:l,acquired:[]}}this.afterDispatchHandle=Object(s.a)((function(){return n.release()}))}return Object(a.a)(e,[{key:"destroy",value:function(){for(var e in this.afterDispatchHandle&&(this.afterDispatchHandle.remove(),this.afterDispatchHandle=null),this.properties){var t,r=this.properties[e],i=Object(n.a)(r.acquired);try{for(i.s();!(t=i.n()).done;){var a=t.value;Object(s.b)(a)||r.pool.release(a)}}catch(o){i.e(o)}finally{i.f()}r.pool.destroy(),r.pool=null,r.acquired=null}this.properties=null,this.owner=null}},{key:"get",value:function(e){var t=this.owner._get(e),r=this.properties[e],n=r.pool.acquire();for(r.acquired.push(n);n===t;)r.acquired.push(n),n=r.pool.acquire();return n}},{key:"release",value:function(){for(var e in this.properties){var t,r=this.properties[e],i=0,a=Object(n.a)(r.acquired);try{for(a.s();!(t=a.n()).done;){var o=t.value;Object(s.b)(o)?r.acquired[i++]=o:r.pool.release(o)}}catch(c){a.e(c)}finally{a.f()}r.acquired.length=i}}}]),e}()},function(e,t,r){"use strict";r.d(t,"a",(function(){return s})),r.d(t,"b",(function(){return c})),r.d(t,"c",(function(){return o}));var n=r(20),i=r(4),a=r(9);function o(e,t){return Object(i.j)(e,t)/Object(i.r)(e)}function s(e,t){var r=Object(i.j)(e,t)/(Object(i.r)(e)*Object(i.r)(t));return-Object(n.b)(r)}function c(e,t,r){Object(i.t)(l,e),Object(i.t)(u,t);var a=Object(i.j)(l,u),o=Object(n.b)(a),s=Object(i.i)(l,l,u);return Object(i.j)(s,r)<0?2*Math.PI-o:o}var l=Object(a.e)(),u=Object(a.e)()},function(e,t,r){"use strict";r.d(t,"a",(function(){return H}));var n=r(14),i=r(2),a=r(5),o=r(45),s=r(42),c=r(6),l=r(7),u=r(96),d=r(4),h=r(9),f=r(108),p=r(110),b=r(469),v=r(116),m=r(89),y=r(183),g=r(151),O=r(102),j=r(0),_=r(76),w=r(381),x=r(281),k=r(109),S=r(112),T=r(274),C=r(148),M=r(197),P=r(228),A=r(106),E=r(91),R=r(95),I=r(24),D=r(77),F=r(88),L=r(111),z=r(616),V=r(41),N=function(e){Object(c.a)(r,e);var t=Object(l.a)(r);function r(){return Object(i.a)(this,r),t.apply(this,arguments)}return Object(a.a)(r,[{key:"initializeProgram",value:function(e){var t=r.shader.get(),n=this.configuration,i=t.build({OITEnabled:0===n.transparencyPassType,output:n.output,viewingMode:e.viewingMode,receiveShadows:n.receiveShadows,slicePlaneEnabled:n.slicePlaneEnabled,sliceHighlightDisabled:n.sliceHighlightDisabled,sliceEnabledForVertexPrograms:!1,symbolColor:n.symbolColors,vvSize:n.vvSize,vvColor:n.vvColor,vvInstancingEnabled:!0,instanced:n.instanced,instancedColor:n.instancedColor,instancedDoublePrecision:n.instancedDoublePrecision,pbrMode:n.usePBR?n.isSchematic?2:1:0,hasMetalnessAndRoughnessTexture:n.hasMetalnessAndRoughnessTexture,hasEmissionTexture:n.hasEmissionTexture,hasOcclusionTexture:n.hasOcclusionTexture,hasNormalTexture:n.hasNormalTexture,hasColorTexture:n.hasColorTexture,receiveAmbientOcclusion:n.receiveAmbientOcclusion,useCustomDTRExponentForWater:!1,normalType:n.normalsTypeDerivate?3:0,doubleSidedMode:n.doubleSidedMode,vertexTangents:n.vertexTangents,attributeTextureCoordinates:n.hasMetalnessAndRoughnessTexture||n.hasEmissionTexture||n.hasOcclusionTexture||n.hasNormalTexture||n.hasColorTexture?1:0,textureAlphaPremultiplied:n.textureAlphaPremultiplied,attributeColor:n.vertexColors,screenSizePerspectiveEnabled:n.screenSizePerspective,verticalOffsetEnabled:n.verticalOffset,offsetBackfaces:n.offsetBackfaces,doublePrecisionRequiresObfuscation:Object(P.b)(e.rctx),alphaDiscardMode:n.alphaDiscardMode,supportsTextureAtlas:!1,multipassTerrainEnabled:n.multipassTerrainEnabled,cullAboveGround:n.cullAboveGround});return new F.a(e.rctx,i,D.a)}},{key:"bindPass",value:function(e,t){var r,n;Object(A.c)(this.program,t.camera.projectionMatrix);var i=this.configuration.output;(1===this.configuration.output||t.multipassTerrainEnabled||3===i)&&this.program.setUniform2fv("cameraNearFar",t.camera.nearFar),t.multipassTerrainEnabled&&(this.program.setUniform2fv("inverseViewport",t.inverseViewport),Object(S.a)(this.program,t)),7===i&&(this.program.setUniform1f("opacity",e.opacity),this.program.setUniform1f("layerOpacity",e.layerOpacity),this.program.setUniform4fv("externalColor",e.externalColor),this.program.setUniform1i("colorMixMode",O.b[e.colorMixMode])),0===i?(t.lighting.setUniforms(this.program,!1),this.program.setUniform3fv("ambient",e.ambient),this.program.setUniform3fv("diffuse",e.diffuse),this.program.setUniform4fv("externalColor",e.externalColor),this.program.setUniform1i("colorMixMode",O.b[e.colorMixMode]),this.program.setUniform1f("opacity",e.opacity),this.program.setUniform1f("layerOpacity",e.layerOpacity),this.configuration.usePBR&&Object(T.c)(this.program,e,this.configuration.isSchematic)):4===i&&Object(k.b)(this.program,t),Object(M.c)(this.program,e),Object(x.b)(this.program,e,t),Object(O.a)(e.screenSizePerspective,this.program,"screenSizePerspectiveAlignment"),2!==e.textureAlphaMode&&3!==e.textureAlphaMode||this.program.setUniform1f("textureAlphaCutoff",e.textureAlphaCutoff),null==(r=t.shadowMap)||r.bind(this.program),null==(n=t.ssaoHelper)||n.bind(this.program)}},{key:"bindDraw",value:function(e){var t=this.configuration.instancedDoublePrecision?Object(h.g)(e.camera.viewInverseTransposeMatrix[3],e.camera.viewInverseTransposeMatrix[7],e.camera.viewInverseTransposeMatrix[11]):e.origin;Object(A.e)(this.program,t,e.camera.viewMatrix),this.program.rebindTextures(),(0===this.configuration.output||7===this.configuration.output||1===this.configuration.output&&this.configuration.screenSizePerspective||2===this.configuration.output&&this.configuration.screenSizePerspective||4===this.configuration.output&&this.configuration.screenSizePerspective)&&Object(A.a)(this.program,t,e.camera.viewInverseTransposeMatrix),2===this.configuration.output&&this.program.setUniformMatrix4fv("viewNormal",e.camera.viewInverseTransposeMatrix),this.configuration.instancedDoublePrecision&&w.a.bindCustomOrigin(this.program,t),Object(_.b)(this.program,this.configuration,e.slicePlane,t),0===this.configuration.output&&Object(C.d)(this.program,e,t)}},{key:"setPipeline",value:function(e,t){var r=this.configuration,n=3===e,i=2===e;return Object(V.g)({blending:0!==r.output&&7!==r.output||!r.transparent?null:n?m.f:Object(m.a)(e),culling:U(r)&&Object(V.c)(r.cullFace),depthTest:{func:Object(m.b)(e)},depthWrite:n||i?r.writeDepth&&V.e:null,colorWrite:V.d,stencilWrite:r.sceneHasOcludees?L.j:null,stencilTest:r.sceneHasOcludees?t?L.f:L.e:null,polygonOffset:n||i?null:Object(m.g)(r.enableOffset)})}},{key:"initializePipeline",value:function(){return this._occludeePipelineState=this.setPipeline(this.configuration.transparencyPassType,!0),this.setPipeline(this.configuration.transparencyPassType,!1)}},{key:"getPipelineState",value:function(e){return e?this._occludeePipelineState:this.pipeline}}]),r}(R.a);function U(e){return e.cullFace?0!==e.cullFace:!e.slicePlaneEnabled&&!e.transparent&&!e.doubleSidedMode}N.shader=new E.a(z.a,(function(){return r.e(197).then(r.bind(null,1063))}));var B=function(e){Object(c.a)(r,e);var t=Object(l.a)(r);function r(){var e;return Object(i.a)(this,r),(e=t.apply(this,arguments)).output=0,e.alphaDiscardMode=1,e.doubleSidedMode=0,e.isSchematic=!1,e.vertexColors=!1,e.offsetBackfaces=!1,e.symbolColors=!1,e.vvSize=!1,e.vvColor=!1,e.verticalOffset=!1,e.receiveShadows=!1,e.slicePlaneEnabled=!1,e.sliceHighlightDisabled=!1,e.receiveAmbientOcclusion=!1,e.screenSizePerspective=!1,e.textureAlphaPremultiplied=!1,e.hasColorTexture=!1,e.usePBR=!1,e.hasMetalnessAndRoughnessTexture=!1,e.hasEmissionTexture=!1,e.hasOcclusionTexture=!1,e.hasNormalTexture=!1,e.instanced=!1,e.instancedColor=!1,e.instancedDoublePrecision=!1,e.vertexTangents=!1,e.normalsTypeDerivate=!1,e.writeDepth=!0,e.sceneHasOcludees=!1,e.transparent=!1,e.enableOffset=!0,e.cullFace=0,e.transparencyPassType=3,e.multipassTerrainEnabled=!1,e.cullAboveGround=!1,e}return r}(I.a);Object(j.a)([Object(I.b)({count:8})],B.prototype,"output",void 0),Object(j.a)([Object(I.b)({count:4})],B.prototype,"alphaDiscardMode",void 0),Object(j.a)([Object(I.b)({count:3})],B.prototype,"doubleSidedMode",void 0),Object(j.a)([Object(I.b)()],B.prototype,"isSchematic",void 0),Object(j.a)([Object(I.b)()],B.prototype,"vertexColors",void 0),Object(j.a)([Object(I.b)()],B.prototype,"offsetBackfaces",void 0),Object(j.a)([Object(I.b)()],B.prototype,"symbolColors",void 0),Object(j.a)([Object(I.b)()],B.prototype,"vvSize",void 0),Object(j.a)([Object(I.b)()],B.prototype,"vvColor",void 0),Object(j.a)([Object(I.b)()],B.prototype,"verticalOffset",void 0),Object(j.a)([Object(I.b)()],B.prototype,"receiveShadows",void 0),Object(j.a)([Object(I.b)()],B.prototype,"slicePlaneEnabled",void 0),Object(j.a)([Object(I.b)()],B.prototype,"sliceHighlightDisabled",void 0),Object(j.a)([Object(I.b)()],B.prototype,"receiveAmbientOcclusion",void 0),Object(j.a)([Object(I.b)()],B.prototype,"screenSizePerspective",void 0),Object(j.a)([Object(I.b)()],B.prototype,"textureAlphaPremultiplied",void 0),Object(j.a)([Object(I.b)()],B.prototype,"hasColorTexture",void 0),Object(j.a)([Object(I.b)()],B.prototype,"usePBR",void 0),Object(j.a)([Object(I.b)()],B.prototype,"hasMetalnessAndRoughnessTexture",void 0),Object(j.a)([Object(I.b)()],B.prototype,"hasEmissionTexture",void 0),Object(j.a)([Object(I.b)()],B.prototype,"hasOcclusionTexture",void 0),Object(j.a)([Object(I.b)()],B.prototype,"hasNormalTexture",void 0),Object(j.a)([Object(I.b)()],B.prototype,"instanced",void 0),Object(j.a)([Object(I.b)()],B.prototype,"instancedColor",void 0),Object(j.a)([Object(I.b)()],B.prototype,"instancedDoublePrecision",void 0),Object(j.a)([Object(I.b)()],B.prototype,"vertexTangents",void 0),Object(j.a)([Object(I.b)()],B.prototype,"normalsTypeDerivate",void 0),Object(j.a)([Object(I.b)()],B.prototype,"writeDepth",void 0),Object(j.a)([Object(I.b)()],B.prototype,"sceneHasOcludees",void 0),Object(j.a)([Object(I.b)()],B.prototype,"transparent",void 0),Object(j.a)([Object(I.b)()],B.prototype,"enableOffset",void 0),Object(j.a)([Object(I.b)({count:3})],B.prototype,"cullFace",void 0),Object(j.a)([Object(I.b)({count:4})],B.prototype,"transparencyPassType",void 0),Object(j.a)([Object(I.b)()],B.prototype,"multipassTerrainEnabled",void 0),Object(j.a)([Object(I.b)()],B.prototype,"cullAboveGround",void 0);var G=r(617),q=function(e){Object(c.a)(r,e);var t=Object(l.a)(r);function r(){return Object(i.a)(this,r),t.apply(this,arguments)}return Object(a.a)(r,[{key:"initializeProgram",value:function(e){var t=r.shader.get(),n=this.configuration,i=t.build({OITEnabled:0===n.transparencyPassType,output:n.output,viewingMode:e.viewingMode,receiveShadows:n.receiveShadows,slicePlaneEnabled:n.slicePlaneEnabled,sliceHighlightDisabled:n.sliceHighlightDisabled,sliceEnabledForVertexPrograms:!1,symbolColor:n.symbolColors,vvSize:n.vvSize,vvColor:n.vvColor,vvInstancingEnabled:!0,instanced:n.instanced,instancedColor:n.instancedColor,instancedDoublePrecision:n.instancedDoublePrecision,pbrMode:n.usePBR?1:0,hasMetalnessAndRoughnessTexture:!1,hasEmissionTexture:!1,hasOcclusionTexture:!1,hasNormalTexture:!1,hasColorTexture:n.hasColorTexture,receiveAmbientOcclusion:n.receiveAmbientOcclusion,useCustomDTRExponentForWater:!1,normalType:0,doubleSidedMode:2,vertexTangents:!1,attributeTextureCoordinates:n.hasColorTexture?1:0,textureAlphaPremultiplied:n.textureAlphaPremultiplied,attributeColor:n.vertexColors,screenSizePerspectiveEnabled:n.screenSizePerspective,verticalOffsetEnabled:n.verticalOffset,offsetBackfaces:n.offsetBackfaces,doublePrecisionRequiresObfuscation:Object(P.b)(e.rctx),alphaDiscardMode:n.alphaDiscardMode,supportsTextureAtlas:!1,multipassTerrainEnabled:n.multipassTerrainEnabled,cullAboveGround:n.cullAboveGround});return new F.a(e.rctx,i,D.a)}}]),r}(N);q.shader=new E.a(G.a,(function(){return r.e(187).then(r.bind(null,1064))}));var H=function(e){Object(c.a)(r,e);var t=Object(l.a)(r);function r(e){var n;return Object(i.a)(this,r),(n=t.call(this,e,Q)).supportsEdges=!0,n.techniqueConfig=new B,n.vertexBufferLayout=r.getVertexBufferLayout(n.params),n.instanceBufferLayout=e.instanced?r.getInstanceBufferLayout(n.params):null,n}return Object(a.a)(r,[{key:"isVisibleInPass",value:function(e){return 4!==e&&6!==e&&7!==e||this.params.castShadows}},{key:"isVisible",value:function(){var e=this.params;if(!Object(o.a)(Object(s.a)(r.prototype),"isVisible",this).call(this)||0===e.layerOpacity)return!1;var t=e.instanced,n=e.vertexColors,i=e.symbolColors,a=!!t&&t.indexOf("color")>-1,c=e.vvColorEnabled,l="replace"===e.colorMixMode,u=e.opacity>0,d=e.externalColor&&e.externalColor[3]>0;return n&&(a||c||i)?!!l||u:n?l?d:u:a||c||i?!!l||u:l?d:u}},{key:"getTechniqueConfig",value:function(e,t){return this.techniqueConfig.output=e,this.techniqueConfig.hasNormalTexture=!!this.params.normalTextureId,this.techniqueConfig.hasColorTexture=!!this.params.textureId,this.techniqueConfig.vertexTangents=this.params.vertexTangents,this.techniqueConfig.instanced=!!this.params.instanced,this.techniqueConfig.instancedDoublePrecision=this.params.instancedDoublePrecision,this.techniqueConfig.vvSize=this.params.vvSizeEnabled,this.techniqueConfig.verticalOffset=null!==this.params.verticalOffset,this.techniqueConfig.screenSizePerspective=null!==this.params.screenSizePerspective,this.techniqueConfig.slicePlaneEnabled=this.params.slicePlaneEnabled,this.techniqueConfig.sliceHighlightDisabled=this.params.sliceHighlightDisabled,this.techniqueConfig.alphaDiscardMode=this.params.textureAlphaMode,this.techniqueConfig.normalsTypeDerivate="screenDerivative"===this.params.normals,this.techniqueConfig.transparent=this.params.transparent,this.techniqueConfig.writeDepth=this.params.writeDepth,this.techniqueConfig.sceneHasOcludees=this.params.sceneHasOcludees,this.techniqueConfig.cullFace=this.params.slicePlaneEnabled?0:this.params.cullFace,this.techniqueConfig.multipassTerrainEnabled=!!t&&t.multipassTerrainEnabled,this.techniqueConfig.cullAboveGround=!!t&&t.cullAboveGround,0!==e&&7!==e||(this.techniqueConfig.vertexColors=this.params.vertexColors,this.techniqueConfig.symbolColors=this.params.symbolColors,this.params.treeRendering?this.techniqueConfig.doubleSidedMode=2:this.techniqueConfig.doubleSidedMode=this.params.doubleSided&&"normal"===this.params.doubleSidedType?1:this.params.doubleSided&&"winding-order"===this.params.doubleSidedType?2:0,this.techniqueConfig.instancedColor=!!this.params.instanced&&this.params.instanced.indexOf("color")>-1,this.techniqueConfig.receiveShadows=this.params.receiveShadows&&this.params.shadowMappingEnabled,this.techniqueConfig.receiveAmbientOcclusion=!(!t||!t.ssaoEnabled)&&this.params.receiveSSAO,this.techniqueConfig.vvColor=this.params.vvColorEnabled,this.techniqueConfig.textureAlphaPremultiplied=!!this.params.textureAlphaPremultiplied,this.techniqueConfig.usePBR=this.params.usePBR,this.techniqueConfig.hasMetalnessAndRoughnessTexture=!!this.params.metallicRoughnessTextureId,this.techniqueConfig.hasEmissionTexture=!!this.params.emissiveTextureId,this.techniqueConfig.hasOcclusionTexture=!!this.params.occlusionTextureId,this.techniqueConfig.offsetBackfaces=!(!this.params.transparent||!this.params.offsetTransparentBackfaces),this.techniqueConfig.isSchematic=this.params.usePBR&&this.params.isSchematic,this.techniqueConfig.transparencyPassType=t?t.transparencyPassType:3,this.techniqueConfig.enableOffset=!t||t.camera.relativeElevation<m.e),this.techniqueConfig}},{key:"intersect",value:function(e,t,r,n,i,a,o){if(null!==this.params.verticalOffset){var s=n.camera;Object(d.y)(ee,r[12],r[13],r[14]);var c=null;switch(n.viewingMode){case 1:c=Object(d.t)(J,ee);break;case 2:c=Object(d.m)(J,$)}var l=0;if(null!==this.params.verticalOffset){var u=Object(d.l)(te,ee,s.eye),h=Object(d.r)(u),f=Object(d.g)(u,u,1/h),p=null;this.params.screenSizePerspective&&(p=Object(d.j)(c,f)),l+=Object(O.l)(s,h,this.params.verticalOffset,p,this.params.screenSizePerspective)}Object(d.g)(c,c,l),Object(d.z)(K,c,n.transform.inverseRotation),i=Object(d.l)(X,i,K),a=Object(d.l)(Y,a,K)}Object(O.i)(e,t,n,i,a,Object(y.d)(n.verticalOffset),o)}},{key:"getGLMaterial",value:function(e){if(0===e.output||7===e.output||1===e.output||2===e.output||3===e.output||4===e.output)return new W(e)}},{key:"createBufferWriter",value:function(){return new Z(this.vertexBufferLayout,this.instanceBufferLayout)}}],[{key:"getVertexBufferLayout",value:function(e){var t=e.textureId||e.normalTextureId||e.metallicRoughnessTextureId||e.emissiveTextureId||e.occlusionTextureId,r=Object(f.a)().vec3f("position").vec3f("normal");return e.vertexTangents&&r.vec4f("tangent"),t&&r.vec2f("uv0"),e.vertexColors&&r.vec4u8("color"),e.symbolColors&&r.vec4u8("symbolColor"),r}},{key:"getInstanceBufferLayout",value:function(e){var t=Object(f.a)();return t=e.instancedDoublePrecision?t.vec3f("modelOriginHi").vec3f("modelOriginLo").mat3f("model").mat3f("modelNormal"):t.mat4f("model").mat4f("modelNormal"),e.instanced&&e.instanced.indexOf("color")>-1&&(t=t.vec4f("instanceColor")),e.instanced&&e.instanced.indexOf("featureAttribute")>-1&&(t=t.vec4f("instanceFeatureAttribute")),t}}]),r}(v.a),W=function(e){Object(c.a)(r,e);var t=Object(l.a)(r);function r(e){var a;Object(i.a)(this,r);var o=e.material;return(a=t.call(this,Object(n.a)(Object(n.a)({},e),o.params))).updateParameters(),a}return Object(a.a)(r,[{key:"updateParameters",value:function(e){var t=this._material.params;this.updateTexture(t.textureId),this._technique=this._techniqueRep.releaseAndAcquire(t.treeRendering?q:N,this._material.getTechniqueConfig(this._output,e),this._technique)}},{key:"selectPipelines",value:function(){}},{key:"_updateShadowState",value:function(e){e.shadowMappingEnabled!==this._material.params.shadowMappingEnabled&&this._material.setParameterValues({shadowMappingEnabled:e.shadowMappingEnabled})}},{key:"_updateOccludeeState",value:function(e){e.hasOccludees!==this._material.params.sceneHasOcludees&&this._material.setParameterValues({sceneHasOcludees:e.hasOccludees})}},{key:"ensureParameters",value:function(e){0!==this._output&&7!==this._output||(this._updateShadowState(e),this._updateOccludeeState(e)),this.updateParameters(e)}},{key:"bind",value:function(e){this._technique.bindPass(this._material.params,e),this.bindTextures(this._technique.program)}},{key:"beginSlot",value:function(e){return e===(this._material.params.transparent?this._material.params.writeDepth?5:8:3)}},{key:"getPipelineState",value:function(e,t){return this._technique.getPipelineState(t)}}]),r}(b.a),Q=Object(n.a)({textureId:void 0,initTextureTransparent:!1,isSchematic:!1,usePBR:!1,normalTextureId:void 0,vertexTangents:!1,occlusionTextureId:void 0,emissiveTextureId:void 0,metallicRoughnessTextureId:void 0,emissiveFactor:[0,0,0],mrrFactors:[0,1,.5],ambient:[.2,.2,.2],diffuse:[.8,.8,.8],externalColor:[1,1,1,1],colorMixMode:"multiply",opacity:1,layerOpacity:1,vertexColors:!1,symbolColors:!1,doubleSided:!1,doubleSidedType:"normal",cullFace:2,instanced:void 0,instancedDoublePrecision:!1,normals:"default",receiveSSAO:!0,receiveShadows:!0,castShadows:!0,shadowMappingEnabled:!1,verticalOffset:null,screenSizePerspective:null,slicePlaneEnabled:!1,sliceHighlightDisabled:!1,offsetTransparentBackfaces:!1,vvSizeEnabled:!1,vvSizeMinSize:[1,1,1],vvSizeMaxSize:[100,100,100],vvSizeOffset:[0,0,0],vvSizeFactor:[1,1,1],vvSizeValue:[1,1,1],vvColorEnabled:!1,vvColorValues:[0,0,0,0,0,0,0,0],vvColorColors:[1,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0],vvSymbolAnchor:[0,0,0],vvSymbolRotationMatrix:Object(u.b)(),transparent:!1,writeDepth:!0,textureAlphaMode:0,textureAlphaCutoff:p.b,textureAlphaPremultiplied:!1,sceneHasOcludees:!1},v.b),Z=function(){function e(t,r){Object(i.a)(this,e),this.vertexBufferLayout=t,this.instanceBufferLayout=r}return Object(a.a)(e,[{key:"allocate",value:function(e){return this.vertexBufferLayout.createBuffer(e)}},{key:"elementCount",value:function(e){return e.indices.get("position").length}},{key:"write",value:function(e,t,r,n){Object(g.c)(t,this.vertexBufferLayout,e.transformation,e.invTranspTransformation,r,n)}}]),e}(),X=Object(h.e)(),Y=Object(h.e)(),$=Object(h.g)(0,0,1),J=Object(h.e)(),K=Object(h.e)(),ee=Object(h.e)(),te=Object(h.e)()},function(e,t,r){"use strict";r.d(t,"a",(function(){return s}));var n=r(2),i=r(5),a=r(3),o=r(310),s=function(){function e(t){var r=this;Object(n.a)(this,e),this.allocator=t,this.items=[],this.itemsPtr=0,this.tickHandle=o.a.before((function(){return r.reset()})),this.grow()}return Object(i.a)(e,[{key:"destroy",value:function(){this.tickHandle&&(this.tickHandle.remove(),this.tickHandle=Object(a.p)(this.tickHandle)),this.items=Object(a.p)(this.items)}},{key:"get",value:function(){return 0===this.itemsPtr&&Object(o.a)((function(){})),this.itemsPtr===this.items.length&&this.grow(),this.items[this.itemsPtr++]}},{key:"reset",value:function(){var e=Math.min(3*Math.max(8,this.itemsPtr),this.itemsPtr+3*c);this.items.length=Math.min(e,this.items.length),this.itemsPtr=0}},{key:"grow",value:function(){for(var e=0;e<Math.max(8,Math.min(this.items.length,c));e++)this.items.push(this.allocator())}}]),e}(),c=1024},function(e,t,r){"use strict";var n,i=r(2),a=r(5),o=r(6),s=r(7),c=r(0),l=r(126),u=r(232),d=r(58),h=r(27),f=r(25),p=r(1),b=r(18),v=(r(17),r(15),r(10)),m=r(44),y=r(100),g=r(518),O=r(55),j=new d.a({esriSpatialRelIntersects:"intersects",esriSpatialRelContains:"contains",esriSpatialRelCrosses:"crosses",esriSpatialRelDisjoint:"disjoint",esriSpatialRelEnvelopeIntersects:"envelope-intersects",esriSpatialRelIndexIntersects:"index-intersects",esriSpatialRelOverlaps:"overlaps",esriSpatialRelTouches:"touches",esriSpatialRelWithin:"within",esriSpatialRelRelation:"relation"}),_=new d.a({esriSRUnit_Meter:"meters",esriSRUnit_Kilometer:"kilometers",esriSRUnit_Foot:"feet",esriSRUnit_StatuteMile:"miles",esriSRUnit_NauticalMile:"nautical-miles",esriSRUnit_USNauticalMile:"us-nautical-miles"}),w=n=function(e){Object(o.a)(r,e);var t=Object(s.a)(r);function r(e){var n;return Object(i.a)(this,r),(n=t.call(this,e)).cacheHint=void 0,n.distance=void 0,n.geometry=null,n.geometryPrecision=void 0,n.maxAllowableOffset=void 0,n.num=void 0,n.objectIds=null,n.orderByFields=null,n.outFields=null,n.outSpatialReference=null,n.resultType=null,n.returnGeometry=!1,n.returnM=void 0,n.returnZ=void 0,n.start=void 0,n.spatialRelationship="intersects",n.timeExtent=null,n.topFilter=void 0,n.units=null,n.where="1=1",n}return Object(a.a)(r,[{key:"writeStart",value:function(e,t){t.resultOffset=this.start,t.resultRecordCount=this.num||10}},{key:"clone",value:function(){return new n(Object(f.a)({cacheHint:this.cacheHint,distance:this.distance,geometry:this.geometry,geometryPrecision:this.geometryPrecision,maxAllowableOffset:this.maxAllowableOffset,num:this.num,objectIds:this.objectIds,orderByFields:this.orderByFields,outFields:this.outFields,outSpatialReference:this.outSpatialReference,resultType:this.resultType,returnGeometry:this.returnGeometry,returnZ:this.returnZ,returnM:this.returnM,start:this.start,spatialRelationship:this.spatialRelationship,timeExtent:this.timeExtent,topFilter:this.topFilter,units:this.units,where:this.where}))}}]),r}(h.a);Object(c.a)([Object(p.b)({type:Boolean,json:{write:!0}})],w.prototype,"cacheHint",void 0),Object(c.a)([Object(p.b)({type:Number,json:{write:{overridePolicy:function(e){return{enabled:e>0}}}}})],w.prototype,"distance",void 0),Object(c.a)([Object(p.b)({types:l.a,json:{read:y.a,write:!0}})],w.prototype,"geometry",void 0),Object(c.a)([Object(p.b)({type:Number,json:{write:!0}})],w.prototype,"geometryPrecision",void 0),Object(c.a)([Object(p.b)({type:Number,json:{write:!0}})],w.prototype,"maxAllowableOffset",void 0),Object(c.a)([Object(p.b)({type:Number,json:{read:{source:"resultRecordCount"}}})],w.prototype,"num",void 0),Object(c.a)([Object(p.b)({json:{write:!0}})],w.prototype,"objectIds",void 0),Object(c.a)([Object(p.b)({type:[String],json:{write:!0}})],w.prototype,"orderByFields",void 0),Object(c.a)([Object(p.b)({type:[String],json:{write:!0}})],w.prototype,"outFields",void 0),Object(c.a)([Object(p.b)({type:O.a,json:{read:{source:"outSR"},write:{target:"outSR"}}})],w.prototype,"outSpatialReference",void 0),Object(c.a)([Object(p.b)({type:String,json:{write:!0}})],w.prototype,"resultType",void 0),Object(c.a)([Object(p.b)({json:{write:!0}})],w.prototype,"returnGeometry",void 0),Object(c.a)([Object(p.b)({type:Boolean,json:{write:{overridePolicy:function(e){return{enabled:e}}}}})],w.prototype,"returnM",void 0),Object(c.a)([Object(p.b)({type:Boolean,json:{write:{overridePolicy:function(e){return{enabled:e}}}}})],w.prototype,"returnZ",void 0),Object(c.a)([Object(p.b)({type:Number,json:{read:{source:"resultOffset"}}})],w.prototype,"start",void 0),Object(c.a)([Object(m.a)("start"),Object(m.a)("num")],w.prototype,"writeStart",null),Object(c.a)([Object(p.b)({type:String,json:{read:{source:"spatialRel",reader:j.read},write:{target:"spatialRel",writer:j.write}}})],w.prototype,"spatialRelationship",void 0),Object(c.a)([Object(p.b)({type:u.a,json:{write:!0}})],w.prototype,"timeExtent",void 0),Object(c.a)([Object(p.b)({type:g.a,json:{write:!0}})],w.prototype,"topFilter",void 0),Object(c.a)([Object(p.b)({type:String,json:{read:_.read,write:{writer:_.write,overridePolicy:function(e){return{enabled:e&&this.distance>0}}}}})],w.prototype,"units",void 0),Object(c.a)([Object(p.b)({type:String,json:{write:!0}})],w.prototype,"where",void 0),(w=n=Object(c.a)([Object(v.a)("esri.rest.support.TopFeaturesQuery")],w)).from=Object(b.m)(w);var x=w;t.a=x},function(e,t,r){"use strict";function n(e){return"string"==typeof e?document.getElementById(e):e}function i(e){for(;e.hasChildNodes();)e.removeChild(e.firstChild)}function a(e,t){var r=t.parentNode;r&&r.insertBefore(e,t)}function o(e,t){for(;;){var r=e.firstChild;if(!r)break;t.appendChild(r)}}r.d(t,"a",(function(){return n})),r.d(t,"b",(function(){return i})),r.d(t,"c",(function(){return a})),r.d(t,"d",(function(){return o}));!function(){if("function"==typeof Element.prototype.closest)return function(e,t){return e.closest(t)};var e=Element.prototype.matches||Element.prototype.msMatchesSelector}()},function(e,t,r){"use strict";function n(e){return e&&"esri.renderers.visualVariables.SizeVariable"===e.declaredClass}function i(e){return null!=e&&!isNaN(e)&&isFinite(e)}function a(e){return e.valueExpression?"expression":e.field&&"string"==typeof e.field?"field":"unknown"}function o(e,t){var r=t||a(e),n=e.valueUnit||"unknown";return"unknown"===r?"constant":e.stops?"stops":null!=e.minSize&&null!=e.maxSize&&null!=e.minDataValue&&null!=e.maxDataValue?"clamped-linear":"unknown"===n?null!=e.minSize&&null!=e.minDataValue?e.minSize&&e.minDataValue?"proportional":"additive":"identity":"real-world-size"}r.d(t,"a",(function(){return a})),r.d(t,"b",(function(){return o})),r.d(t,"c",(function(){return n})),r.d(t,"d",(function(){return i}))},function(e,t,r){"use strict";r.r(t);var n=r(33),i=r(13),a=r(2),o=r(5),s=r(6),c=r(7),l=r(0),u=r(126),d=r(137),h=r(58),f=r(27),p=r(3),b=r(1),v=(r(17),r(18),r(15),r(48)),m=r(10),y=r(44),g=r(55),O=r(100),j=r(314),_=new h.a({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon",esriGeometryEnvelope:"extent",mesh:"mesh","":null}),w=function(e){Object(s.a)(r,e);var t=Object(c.a)(r);function r(e){var n;return Object(a.a)(this,r),(n=t.call(this,e)).displayFieldName=null,n.exceededTransferLimit=!1,n.features=[],n.fields=null,n.geometryType=null,n.hasM=!1,n.hasZ=!1,n.queryGeometry=null,n.spatialReference=null,n}return Object(o.a)(r,[{key:"readFeatures",value:function(e,t){for(var r=g.a.fromJSON(t.spatialReference),n=[],i=0;i<e.length;i++){var a=e[i],o=d.a.fromJSON(a),s=a.geometry&&a.geometry.spatialReference;Object(p.j)(o.geometry)&&!s&&(o.geometry.spatialReference=r),n.push(o)}return n}},{key:"writeGeometryType",value:function(e,t,r,n){if(e)_.write(e,t,r,n);else{var a=this.features;if(a){var o,s=Object(i.a)(a);try{for(s.s();!(o=s.n()).done;){var c=o.value;if(c&&Object(p.j)(c.geometry))return void _.write(c.geometry.type,t,r,n)}}catch(l){s.e(l)}finally{s.f()}}}}},{key:"readQueryGeometry",value:function(e,t){if(!e)return null;var r=!!e.spatialReference,n=Object(O.a)(e);return!r&&t.spatialReference&&(n.spatialReference=g.a.fromJSON(t.spatialReference)),n}},{key:"writeSpatialReference",value:function(e,t){if(e)t.spatialReference=e.toJSON();else{var r=this.features;if(r){var n,a=Object(i.a)(r);try{for(a.s();!(n=a.n()).done;){var o=n.value;if(o&&Object(p.j)(o.geometry)&&o.geometry.spatialReference)return void(t.spatialReference=o.geometry.spatialReference.toJSON())}}catch(s){a.e(s)}finally{a.f()}}}}},{key:"toJSON",value:function(e){var t=this.write(null);if(t.features&&Array.isArray(e)&&e.length>0)for(var r=0;r<t.features.length;r++){var n=t.features[r];if(n.geometry){var i=e&&e[r];n.geometry=i&&i.toJSON()||n.geometry}}return t}},{key:"quantize",value:function(e){for(var t=Object(n.a)(e.scale,2),r=t[0],i=t[1],a=Object(n.a)(e.translate,2),o=a[0],s=a[1],c=this.features,l=this._getQuantizationFunction(this.geometryType,(function(e){return Math.round((e-o)/r)}),(function(e){return Math.round((s-e)/i)})),u=0,d=c.length;u<d;u++)l(Object(p.s)(c[u].geometry))||(c.splice(u,1),u--,d--);return this.transform=e,this}},{key:"unquantize",value:function(){var e=this.geometryType,t=this.features,r=this.transform;if(!r)return this;var a,o=Object(n.a)(r.translate,2),s=o[0],c=o[1],l=Object(n.a)(r.scale,2),u=l[0],d=l[1],h=this._getHydrationFunction(e,(function(e){return e*u+s}),(function(e){return c-e*d})),f=Object(i.a)(t);try{for(f.s();!(a=f.n()).done;){var b=a.value.geometry;Object(p.j)(b)&&h(b)}}catch(v){f.e(v)}finally{f.f()}return this.transform=null,this}},{key:"_quantizePoints",value:function(e,t,r){for(var n,i,a=[],o=0,s=e.length;o<s;o++){var c=e[o];if(o>0){var l=t(c[0]),u=r(c[1]);l===n&&u===i||(a.push([l-n,u-i]),n=l,i=u)}else n=t(c[0]),i=r(c[1]),a.push([n,i])}return a.length>0?a:null}},{key:"_getQuantizationFunction",value:function(e,t,r){var n=this;return"point"===e?function(e){return e.x=t(e.x),e.y=r(e.y),e}:"polyline"===e||"polygon"===e?function(e){for(var i=Object(O.g)(e)?e.rings:e.paths,a=[],o=0,s=i.length;o<s;o++){var c=i[o],l=n._quantizePoints(c,t,r);l&&a.push(l)}return a.length>0?(Object(O.g)(e)?e.rings=a:e.paths=a,e):null}:"multipoint"===e?function(e){var i=n._quantizePoints(e.points,t,r);return i.length>0?(e.points=i,e):null}:"extent"===e?function(e){return e}:null}},{key:"_getHydrationFunction",value:function(e,t,r){return"point"===e?function(e){e.x=t(e.x),e.y=r(e.y)}:"polyline"===e||"polygon"===e?function(e){for(var n,i,a=Object(O.g)(e)?e.rings:e.paths,o=0,s=a.length;o<s;o++)for(var c=a[o],l=0,u=c.length;l<u;l++){var d=c[l];l>0?(n+=d[0],i+=d[1]):(n=d[0],i=d[1]),d[0]=t(n),d[1]=r(i)}}:"extent"===e?function(e){e.xmin=t(e.xmin),e.ymin=r(e.ymin),e.xmax=t(e.xmax),e.ymax=r(e.ymax)}:"multipoint"===e?function(e){for(var n,i,a=e.points,o=0,s=a.length;o<s;o++){var c=a[o];o>0?(n+=c[0],i+=c[1]):(n=c[0],i=c[1]),c[0]=t(n),c[1]=r(i)}}:void 0}}]),r}(f.a);Object(l.a)([Object(b.b)({type:String,json:{write:!0}})],w.prototype,"displayFieldName",void 0),Object(l.a)([Object(b.b)({type:Boolean,json:{write:{overridePolicy:function(e){return{enabled:e}}}}})],w.prototype,"exceededTransferLimit",void 0),Object(l.a)([Object(b.b)({type:[d.a],json:{write:!0}})],w.prototype,"features",void 0),Object(l.a)([Object(v.a)("features")],w.prototype,"readFeatures",null),Object(l.a)([Object(b.b)({type:[j.a],json:{write:!0}})],w.prototype,"fields",void 0),Object(l.a)([Object(b.b)({type:["point","multipoint","polyline","polygon","extent","mesh"],json:{read:{reader:_.read}}})],w.prototype,"geometryType",void 0),Object(l.a)([Object(y.a)("geometryType")],w.prototype,"writeGeometryType",null),Object(l.a)([Object(b.b)({type:Boolean,json:{write:{overridePolicy:function(e){return{enabled:e}}}}})],w.prototype,"hasM",void 0),Object(l.a)([Object(b.b)({type:Boolean,json:{write:{overridePolicy:function(e){return{enabled:e}}}}})],w.prototype,"hasZ",void 0),Object(l.a)([Object(b.b)({types:u.a,json:{write:!0}})],w.prototype,"queryGeometry",void 0),Object(l.a)([Object(v.a)("queryGeometry")],w.prototype,"readQueryGeometry",null),Object(l.a)([Object(b.b)({type:g.a,json:{write:!0}})],w.prototype,"spatialReference",void 0),Object(l.a)([Object(y.a)("spatialReference")],w.prototype,"writeSpatialReference",null),Object(l.a)([Object(b.b)({json:{write:!0}})],w.prototype,"transform",void 0),(w=Object(l.a)([Object(m.a)("esri.rest.support.FeatureSet")],w)).prototype.toJSON.isDefaultToJSON=!0,w||(w={});var x=w;t.default=x},function(e,t,r){"use strict";var n=r(2),i=r(5),a=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];Object(n.a)(this,e),this.lengths=null!=t?t:[],this.coords=null!=r?r:[],this.hasIndeterminateRingOrder=i}return Object(i.a)(e,[{key:"isPoint",get:function(){return 0===this.lengths.length}},{key:"forEachVertex",value:function(e){var t=0;this.lengths.length||e(this.coords[0],this.coords[1]);for(var r=0;r<this.lengths.length;r++){for(var n=this.lengths[r],i=0;i<n;i++)e(this.coords[2*(i+t)],this.coords[2*(i+t)+1]);t+=n}}},{key:"clone",value:function(){return new e(this.lengths.slice(),this.coords.slice(),this.hasIndeterminateRingOrder)}}]),e}();t.a=a},function(e,t,r){"use strict";var n,i=r(13),a=r(2),o=r(5),s=r(6),c=r(7),l=r(0),u=r(53),d=r(22),h=r(25),f=r(1),p=(r(18),r(17),r(15),r(52)),b=r(10),v=r(44),m=r(201),y=r(292),g=r(223),O=r(219),j=r(229),_=r(388),w=u.a.ofType({base:null,key:"type",typeMap:{icon:m.a,object:y.a,text:O.a}}),x=u.a.ofType({base:null,key:"type",typeMap:{icon:m.a,object:y.a}}),k=n=function(e){Object(s.a)(r,e);var t=Object(c.a)(r);function r(e){var n;return Object(a.a)(this,r),(n=t.call(this,e)).verticalOffset=null,n.callout=null,n.symbolLayers=new w,n.type="point-3d",n}return Object(o.a)(r,[{key:"writeSymbolLayers",value:function(e,t,r,n){var i=e.filter((function(e){return"text"!==e.type}));if(n&&n.messages&&i.length<e.length){var a=e.find((function(e){return"text"===e.type}));n.messages.push(new d.a("symbol-layer:unsupported","Symbol layers of type 'text' cannot be persisted in PointSymbol3D",{symbolLayer:a}))}t[r]=i.map((function(e){return e.write({},n)})).toArray()}},{key:"supportsCallout",value:function(){if((this.symbolLayers?this.symbolLayers.length:0)<1)return!1;var e,t=Object(i.a)(this.symbolLayers.items);try{for(t.s();!(e=t.n()).done;){switch(e.value.type){case"icon":case"text":case"object":continue;default:return!1}}}catch(r){t.e(r)}finally{t.f()}return!0}},{key:"hasVisibleCallout",value:function(){return Object(j.b)(this)}},{key:"hasVisibleVerticalOffset",value:function(){return Object(j.c)(this)}},{key:"clone",value:function(){return new n({verticalOffset:Object(h.a)(this.verticalOffset),callout:Object(h.a)(this.callout),styleOrigin:Object(h.a)(this.styleOrigin),symbolLayers:Object(h.a)(this.symbolLayers),thumbnail:Object(h.a)(this.thumbnail)})}}],[{key:"fromSimpleMarkerSymbol",value:function(e){return new n({symbolLayers:[m.a.fromSimpleMarkerSymbol(e)]})}},{key:"fromPictureMarkerSymbol",value:function(e){return new n({symbolLayers:[m.a.fromPictureMarkerSymbol(e)]})}},{key:"fromCIMSymbol",value:function(e){if(e.data&&e.data.symbol){var t=e.data.symbol;if("CIMPointSymbol"===t.type&&t.callout)return new n({symbolLayers:[m.a.fromCIMSymbol(e)],callout:{type:"line",size:.5,color:[0,0,0]},verticalOffset:{screenLength:40}})}return new n({symbolLayers:[m.a.fromCIMSymbol(e)]})}},{key:"fromTextSymbol",value:function(e){return new n({symbolLayers:[O.a.fromTextSymbol(e)]})}}]),r}(g.a);Object(l.a)([Object(f.b)({type:_.a,json:{write:!0}})],k.prototype,"verticalOffset",void 0),Object(l.a)([Object(f.b)(j.a)],k.prototype,"callout",void 0),Object(l.a)([Object(f.b)({type:w,json:{type:x,origins:{"web-scene":{type:x}}}})],k.prototype,"symbolLayers",void 0),Object(l.a)([Object(v.a)("web-scene","symbolLayers")],k.prototype,"writeSymbolLayers",null),Object(l.a)([Object(p.a)({PointSymbol3D:"point-3d"},{readOnly:!0})],k.prototype,"type",void 0);var S=k=n=Object(l.a)([Object(b.a)("esri.symbols.PointSymbol3D")],k);t.a=S},function(e,t,r){"use strict";var n,i=r(14),a=r(2),o=r(5),s=r(6),c=r(7),l=r(0),u=r(25),d=r(3),h=r(1),f=(r(18),r(17),r(15),r(52)),p=r(10),b=r(44),v=r(330),m=r(161),y=r(131),g=r(49),O=r(27),j=n=function(e){Object(s.a)(r,e);var t=Object(c.a)(r);function r(){var e;return Object(a.a)(this,r),(e=t.apply(this,arguments)).color=new g.a([0,0,0,1]),e.size=0,e}return Object(o.a)(r,[{key:"clone",value:function(){return new n({color:Object(u.a)(this.color),size:this.size})}}]),r}(O.a);Object(l.a)([Object(h.b)(y.a)],j.prototype,"color",void 0),Object(l.a)([Object(h.b)(y.b)],j.prototype,"size",void 0);var _,w=j=n=Object(l.a)([Object(p.a)("esri.symbols.support.Symbol3DHalo")],j),x=r(198),k=_=function(e){Object(s.a)(r,e);var t=Object(c.a)(r);function r(e){var n;return Object(a.a)(this,r),(n=t.call(this,e))._userSize=void 0,n.halo=null,n.material=null,n.text=void 0,n.type="text",n}return Object(o.a)(r,[{key:"font",get:function(){return this._get("font")||null},set:function(e){e&&this._userSize&&(e.size=this._userSize),this._set("font",e)}},{key:"writeFont",value:function(e,t,r,n){var a=Object(i.a)(Object(i.a)({},n),{},{textSymbol3D:!0});t.font=e.write({},a),delete t.font.size}},{key:"size",get:function(){return null!=this._userSize?this._userSize:this.font&&null!=this.font.size?this.font.size:9},set:function(e){this._userSize=e,this.font&&(this.font.size=this._userSize),this.notifyChange("size")}},{key:"clone",value:function(){return new _({enabled:this.enabled,font:this.font&&Object(u.a)(this.font),halo:this.halo&&Object(u.a)(this.halo),material:Object(d.j)(this.material)?this.material.clone():null,size:this.size,text:this.text})}}],[{key:"fromTextSymbol",value:function(e){var t=function(e,t){return e&&t>0?{color:Object(u.a)(e),size:t}:null}(e.haloColor,e.haloSize),r=e.font?e.font.clone():new v.a;return new _({size:r.size,font:r,halo:t,material:e.color?{color:e.color.clone()}:null,text:e.text})}}]),r}(m.a);Object(l.a)([Object(h.b)({type:v.a,json:{write:!0}})],k.prototype,"font",null),Object(l.a)([Object(b.a)("font")],k.prototype,"writeFont",null),Object(l.a)([Object(h.b)({type:w,json:{write:!0}})],k.prototype,"halo",void 0),Object(l.a)([Object(h.b)({type:x.a,json:{write:!0}})],k.prototype,"material",void 0),Object(l.a)([Object(h.b)(y.b),Object(h.b)()],k.prototype,"size",null),Object(l.a)([Object(h.b)({type:String,json:{write:!0}})],k.prototype,"text",void 0),Object(l.a)([Object(f.a)({Text:"text"},{readOnly:!0})],k.prototype,"type",void 0);var S=k=_=Object(l.a)([Object(p.a)("esri.symbols.TextSymbol3DLayer")],k);t.a=S},function(e,t,r){"use strict";r.d(t,"a",(function(){return c}));var n,i,a=r(12),o=r(194),s=r(11);function c(e,t){e.fragment.include(o.a),3===t.output?(e.extensions.add("GL_OES_standard_derivatives"),e.fragment.code.add(Object(s.a)(n||(n=Object(a.a)(["float _calculateFragDepth(const in float depth) {\nconst float SLOPE_SCALE = 2.0;\nconst float BIAS = 2.0 * .000015259;\nfloat m = max(abs(dFdx(depth)), abs(dFdy(depth)));\nfloat result = depth + SLOPE_SCALE * m + BIAS;\nreturn clamp(result, .0, .999999);\n}\nvoid outputDepth(float _linearDepth) {\ngl_FragColor = float2rgba(_calculateFragDepth(_linearDepth));\n}"]))))):1===t.output&&e.fragment.code.add(Object(s.a)(i||(i=Object(a.a)(["void outputDepth(float _linearDepth) {\ngl_FragColor = float2rgba(_linearDepth);\n}"]))))}},function(e,t,r){"use strict";r.d(t,"a",(function(){return c}));var n,i,a,o=r(12),s=r(11);function c(e,t){t.attributeColor?(e.attributes.add("color","vec4"),e.varyings.add("vColor","vec4"),e.vertex.code.add(Object(s.a)(n||(n=Object(o.a)(["void forwardVertexColor() { vColor = color; }"])))),e.vertex.code.add(Object(s.a)(i||(i=Object(o.a)(["void forwardNormalizedVertexColor() { vColor = color * 0.003921568627451; }"]))))):e.vertex.code.add(Object(s.a)(a||(a=Object(o.a)(["void forwardVertexColor() {}\nvoid forwardNormalizedVertexColor() {}"]))))}},function(e,t,r){"use strict";var n,i=r(2),a=r(5),o=r(45),s=r(42),c=r(6),l=r(7),u=r(0),d=r(49),h=r(58),f=r(25),p=r(1),b=(r(18),r(17),r(15),r(52)),v=r(10),m=r(386),y=r(166),g=new h.a({esriSFSSolid:"solid",esriSFSNull:"none",esriSFSHorizontal:"horizontal",esriSFSVertical:"vertical",esriSFSForwardDiagonal:"forward-diagonal",esriSFSBackwardDiagonal:"backward-diagonal",esriSFSCross:"cross",esriSFSDiagonalCross:"diagonal-cross"}),O=n=function(e){Object(c.a)(r,e);var t=Object(l.a)(r);function r(){var e;Object(i.a)(this,r);for(var n=arguments.length,a=new Array(n),o=0;o<n;o++)a[o]=arguments[o];return(e=t.call.apply(t,[this].concat(a))).color=new d.a([0,0,0,.25]),e.outline=new y.a,e.type="simple-fill",e.style="solid",e}return Object(a.a)(r,[{key:"normalizeCtorArgs",value:function(e,t,r){if(e&&"string"!=typeof e)return e;var n={};return e&&(n.style=e),t&&(n.outline=t),r&&(n.color=r),n}},{key:"clone",value:function(){return new n({color:Object(f.a)(this.color),outline:this.outline&&this.outline.clone(),style:this.style})}},{key:"hash",value:function(){return"".concat(Object(o.a)(Object(s.a)(r.prototype),"hash",this).call(this)).concat(this.style,".").concat(this.color&&this.color.hash())}}]),r}(m.a);Object(u.a)([Object(p.b)()],O.prototype,"color",void 0),Object(u.a)([Object(p.b)()],O.prototype,"outline",void 0),Object(u.a)([Object(b.a)({esriSFS:"simple-fill"},{readOnly:!0})],O.prototype,"type",void 0),Object(u.a)([Object(p.b)({type:g.apiValues,json:{read:g.read,write:g.write}})],O.prototype,"style",void 0);var j=O=n=Object(u.a)([Object(v.a)("esri.symbols.SimpleFillSymbol")],O);t.a=j},function(e,t,r){"use strict";var n=r(2),i=r(5),a=r(6),o=r(7),s=r(0),c=r(53),l=r(207),u=r(15),d=r(39),h=r(192),f=r(1),p=(r(17),r(64)),b=r(48),v=r(10),m=r(44),y=r(149),g=r(130),O=r(350),j=r(275),_=r(201),w=r(264),x=r(292),k=r(351),S=r(135),T=r(161),C=r(219),M=r(352),P=r(364),A=r(356),E={icon:_.a,object:x.a,line:w.a,path:k.a,fill:j.a,extrude:O.a,text:C.a,water:M.a},R=c.a.ofType({base:T.a,key:"type",typeMap:E,errorContext:"symbol-layer"}),I=u.a.getLogger("esri.symbols.Symbol3D"),D=function(e){Object(a.a)(r,e);var t=Object(o.a)(r);function r(e){var i;Object(n.a)(this,r),(i=t.call(this,e)).styleOrigin=null,i.thumbnail=null,i.type=null;var a=i.__accessor__&&i.__accessor__.metadatas&&i.__accessor__.metadatas.symbolLayers,o=a&&a.type||c.a;return i._set("symbolLayers",new o),i}return Object(i.a)(r,[{key:"color",get:function(){return null},set:function(e){I.error("Symbol3D does not support colors on the symbol level. Colors may be set on individual symbol layer materials instead.")}},{key:"symbolLayers",set:function(e){Object(l.b)(e,this._get("symbolLayers"))}},{key:"readStyleOrigin",value:function(e,t,r){if(e.styleUrl&&e.name){var n=Object(g.a)(e.styleUrl,r);return new P.a({styleUrl:n,name:e.name})}if(e.styleName&&e.name)return new P.a({portal:r&&r.portal||y.a.getDefault(),styleName:e.styleName,name:e.name});r&&r.messages&&r.messages.push(new h.a("symbol3d:incomplete-style-origin","Style origin requires either a 'styleUrl' or 'styleName' and a 'name' property",{context:r,definition:e}))}},{key:"writeStyleOrigin",value:function(e,t,r,n){if(e.styleUrl&&e.name){var i=Object(g.e)(e.styleUrl,n);Object(d.s)(i)&&(i=Object(d.D)(i)),t.styleOrigin={styleUrl:i,name:e.name}}else e.styleName&&e.name&&(e.portal&&n&&n.portal&&!Object(d.r)(e.portal.restUrl,n.portal.restUrl)?n&&n.messages&&n.messages.push(new h.a("symbol:cross-portal","The symbol style origin cannot be persisted because it refers to an item on a different portal than the one being saved to.",{symbol:this})):t.styleOrigin={styleName:e.styleName,name:e.name})}},{key:"normalizeCtorArgs",value:function(e){return e instanceof T.a||e&&E[e.type]?{symbolLayers:[e]}:Array.isArray(e)?{symbolLayers:e}:e}}]),r}(S.a);Object(s.a)([Object(f.b)({json:{read:!1,write:!1}})],D.prototype,"color",null),Object(s.a)([Object(f.b)({type:R,nonNullable:!0,json:{write:!0}}),Object(p.a)(l.a)],D.prototype,"symbolLayers",null),Object(s.a)([Object(f.b)({type:P.a})],D.prototype,"styleOrigin",void 0),Object(s.a)([Object(b.a)("styleOrigin")],D.prototype,"readStyleOrigin",null),Object(s.a)([Object(m.a)("styleOrigin",{"styleOrigin.styleUrl":{type:String},"styleOrigin.styleName":{type:String},"styleOrigin.name":{type:String}})],D.prototype,"writeStyleOrigin",null),Object(s.a)([Object(f.b)({type:A.a,json:{read:!1}})],D.prototype,"thumbnail",void 0),Object(s.a)([Object(f.b)({type:["point-3d","line-3d","polygon-3d","mesh-3d","label-3d"],readOnly:!0})],D.prototype,"type",void 0);var F=D=Object(s.a)([Object(v.a)("esri.symbols.Symbol3D")],D);t.a=F},function(e,t,r){"use strict";function n(){var e=new Float32Array(9);return e[0]=1,e[4]=1,e[8]=1,e}function i(e){var t=new Float32Array(9);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t}function a(e,t,r,n,i,a,o,s,c){var l=new Float32Array(9);return l[0]=e,l[1]=t,l[2]=r,l[3]=n,l[4]=i,l[5]=a,l[6]=o,l[7]=s,l[8]=c,l}r.d(t,"a",(function(){return i})),r.d(t,"b",(function(){return n})),r.d(t,"c",(function(){return a}));Object.freeze({__proto__:null,create:n,clone:i,fromValues:a,createView:function(e,t){return new Float32Array(e,t,9)}})},function(e,t,r){"use strict";e.exports=r(685)},function(e,t,r){"use strict";function n(e){return e&&"base-tile"===e.type||"tile"===e.type||"elevation"===e.type||"imagery-tile"===e.type||"base-elevation"===e.type||"open-street-map"===e.type||"wcs"===e.type||"web-tile"===e.type||"wmts"===e.type||"vector-tile"===e.type}function i(e){return e.parent&&"esri.Basemap"===e.parent.declaredClass&&e.parent.baseLayers.indexOf(e)>-1}function a(e){return!0===e.labelsVisible&&null!=e.labelingInfo&&e.labelingInfo.length>0}r.d(t,"a",(function(){return a})),r.d(t,"b",(function(){return i})),r.d(t,"c",(function(){return n}))},function(e,t,r){"use strict";var n,i=r(8),a=r.n(i),o=r(16),s=r(2),c=r(5),l=r(45),u=r(42),d=r(6),h=r(7),f=r(0),p=r(15),b=r(23),v=r(1),m=(r(17),r(18),r(52)),y=r(10),g=r(149),O=r(130),j=r(135),_=r(356),w=p.a.getLogger("esri.symbols.WebStyleSymbol"),x=n=function(e){Object(d.a)(i,e);var t=Object(h.a)(i);function i(e){var r;return Object(s.a)(this,i),(r=t.call(this,e)).styleName=null,r.portal=null,r.styleUrl=null,r.thumbnail=null,r.name=null,r.type="web-style",r}return Object(c.a)(i,[{key:"read",value:function(e,t){this.portal=t?t.portal:void 0,Object(l.a)(Object(u.a)(i.prototype),"read",this).call(this,e,t)}},{key:"clone",value:function(){return new n({name:this.name,styleUrl:this.styleUrl,styleName:this.styleName,portal:this.portal})}},{key:"fetchSymbol",value:function(e){return this._fetchSymbol("webRef",e)}},{key:"fetchCIMSymbol",value:function(e){return this._fetchSymbol("cimRef",e)}},{key:"_fetchSymbol",value:function(){var e=Object(o.a)(a.a.mark((function e(t,n){var i,o;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.resolve().then(r.bind(null,557));case 2:return i=e.sent,Object(b.x)(n),o=i.resolveWebStyleSymbol(this,{portal:this.portal},t,n),e.abrupt("return",(o.catch((function(e){w.error("#fetchSymbol()","Failed to create symbol from style",e)})),o));case 6:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()}]),i}(j.a);Object(f.a)([Object(v.b)({json:{write:!1}})],x.prototype,"color",void 0),Object(f.a)([Object(v.b)({type:String,json:{write:!0}})],x.prototype,"styleName",void 0),Object(f.a)([Object(v.b)({type:g.a,json:{write:!1}})],x.prototype,"portal",void 0),Object(f.a)([Object(v.b)({type:String,json:{read:O.d,write:O.f}})],x.prototype,"styleUrl",void 0),Object(f.a)([Object(v.b)({type:_.a,json:{read:!1}})],x.prototype,"thumbnail",void 0),Object(f.a)([Object(v.b)({type:String,json:{write:!0}})],x.prototype,"name",void 0),Object(f.a)([Object(m.a)({styleSymbolReference:"web-style"},{readOnly:!0})],x.prototype,"type",void 0);var k=x=n=Object(f.a)([Object(y.a)("esri.symbols.WebStyleSymbol")],x);t.a=k},function(e,t,r){"use strict";r.d(t,"a",(function(){return l})),r.d(t,"b",(function(){return u}));var n,i,a=r(12),o=r(17),s=r(11),c=r(308);function l(e,t){var r=e.code;t.doublePrecisionRequiresObfuscation?r.add(Object(s.a)(n||(n=Object(a.a)(["vec3 dpPlusFrc(vec3 a, vec3 b) {\nreturn mix(a, a + b, vec3(notEqual(b, vec3(0))));\n}\nvec3 dpMinusFrc(vec3 a, vec3 b) {\nreturn mix(vec3(0), a - b, vec3(notEqual(a, b)));\n}\nvec3 dpAdd(vec3 hiA, vec3 loA, vec3 hiB, vec3 loB) {\nvec3 t1 = dpPlusFrc(hiA, hiB);\nvec3 e = dpMinusFrc(t1, hiA);\nvec3 t2 = dpMinusFrc(hiB, e) + dpMinusFrc(hiA, dpMinusFrc(t1, e)) + loA + loB;\nreturn t1 + t2;\n}"])))):r.add(Object(s.a)(i||(i=Object(a.a)(["vec3 dpAdd(vec3 hiA, vec3 loA, vec3 hiB, vec3 loB) {\nvec3 t1 = hiA + hiB;\nvec3 e = t1 - hiA;\nvec3 t2 = ((hiB - e) + (hiA - (t1 - e))) + loA + loB;\nreturn t1 + t2;\n}"]))))}function u(e){return!!Object(o.a)("force-double-precision-obfuscation")||Object(c.b)(e).doublePrecisionRequiresObfuscation}},function(e,t,r){"use strict";r.d(t,"a",(function(){return c})),r.d(t,"b",(function(){return o})),r.d(t,"c",(function(){return a})),r.d(t,"d",(function(){return s}));var n=r(516),i=r(485);function a(e){if(!e)return!1;var t=e.verticalOffset;return!!t&&!(t.screenLength<=0||t.maxWorldLength<=0)}function o(e){if(!e)return!1;if(!e.supportsCallout||!e.supportsCallout())return!1;var t=e.callout;return!!t&&!!t.visible&&!!a(e)}function s(e){return"point-3d"===e.type||"label-3d"===e.type}var c={types:{key:"type",base:n.a,typeMap:{line:i.a}},json:{write:!0}}},function(e,t,r){"use strict";r.d(t,"a",(function(){return h})),r.d(t,"b",(function(){return u})),r.d(t,"c",(function(){return s})),r.d(t,"d",(function(){return o})),r.d(t,"e",(function(){return d})),r.d(t,"f",(function(){return f}));var n=r(2),i=r(5),a=r(20);function o(e,t){return new p(e,b,t)}function s(e,t){var r=b.curvatureDependent,n=b.scaleStart,i=b.scaleFallOffRange;return new p(e,{curvatureDependent:{min:{curvature:r.min.curvature,tiltAngle:r.min.tiltAngle,scaleFallOffFactor:v.curvatureDependent.min.scaleFallOffFactor},max:{curvature:r.max.curvature,tiltAngle:r.max.tiltAngle,scaleFallOffFactor:v.curvatureDependent.max.scaleFallOffFactor}},scaleStart:n,scaleFallOffRange:i,minPixelSize:v.minPixelSize},t)}function c(e,t,r){var n=r.parameters,i=r.paddingPixelsOverride;return m.scale=Math.min(n.divisor/(t-n.offset),1),m.factor=function(e){return Math.abs(e*e*e)}(e),m.minPixelSize=n.minPixelSize,m.paddingPixels=i,m}function l(e,t){return 0===e?t.minPixelSize:t.minPixelSize*(1+2*t.paddingPixels/e)}function u(e,t){return Math.max(Object(a.m)(e*t.scale,e,t.factor),l(e,t))}function d(e,t,r,n){n.scale=function(e,t,r){var n=c(e,t,r);return n.minPixelSize=0,n.paddingPixels=0,u(1,n)}(e,t,r),n.factor=0,n.minPixelSize=r.parameters.minPixelSize,n.paddingPixels=r.paddingPixelsOverride}function h(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[0,0],n=Math.min(Math.max(t.scale,l(e[1],t)/e[1]),1);return r[0]=e[0]*n,r[1]=e[1]*n,r}function f(e,t,r,n){return u(e,c(t,r,n))}var p=function(){function e(t,r,i){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{camera:{distance:0,fovY:0},divisor:0,offset:0,minPixelSize:0,paddingPixels:0},o=arguments.length>4?arguments[4]:void 0;Object(n.a)(this,e),this.viewingMode=t,this.description=r,this.ellipsoidRadius=i,this.parameters=a,this._paddingPixelsOverride=o,2===this.viewingMode?(this.coverageCompensation=this.surfaceCoverageCompensationLocal,this.calculateCurvatureDependentParameters=this.calculateCurvatureDependentParametersLocal):(this.coverageCompensation=this.surfaceCoverageCompensationGlobal,this.calculateCurvatureDependentParameters=this.calculateCurvatureDependentParametersGlobal)}return Object(i.a)(e,[{key:"paddingPixelsOverride",get:function(){return this._paddingPixelsOverride||this.parameters.paddingPixels}},{key:"update",value:function(e){return(!this.parameters||this.parameters.camera.fovY!==e.fovY||this.parameters.camera.distance!==e.distance)&&(this.calculateParameters(e,this.ellipsoidRadius,this.parameters),!0)}},{key:"overridePadding",value:function(t){return t!==this.paddingPixelsOverride?new e(this.viewingMode,this.description,this.ellipsoidRadius,this.parameters,t):this}},{key:"calculateParameters",value:function(e,t,r){var n=this.description,i=n.scaleStart,a=n.scaleFallOffRange,o=n.minPixelSize,s=e.fovY,c=e.distance,l=this.calculateCurvatureDependentParameters(e,t),u=this.coverageCompensation(e,t,l),d=l.tiltAngle,h=l.scaleFallOffFactor,f=Math.sin(d)*c,p=.5*Math.PI-d-s*(.5-i*u),b=f/Math.cos(p),v=p+s*a*u,m=(b-h*(f/Math.cos(v)))/(1-h);return r.camera.fovY=e.fovY,r.camera.distance=e.distance,r.offset=m,r.divisor=b-m,r.minPixelSize=o,r}},{key:"calculateCurvatureDependentParametersLocal",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:y;return r.tiltAngle=this.description.curvatureDependent.min.tiltAngle,r.scaleFallOffFactor=this.description.curvatureDependent.min.scaleFallOffFactor,r}},{key:"calculateCurvatureDependentParametersGlobal",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:y,n=this.description.curvatureDependent,i=1+e.distance/t,o=Math.sqrt(i*i-1),s=[n.min.curvature,n.max.curvature],c=s[0],l=s[1],u=Object(a.e)((o-c)/(l-c),0,1),d=[n.min,n.max],h=d[0],f=d[1];return r.tiltAngle=Object(a.m)(h.tiltAngle,f.tiltAngle,u),r.scaleFallOffFactor=Object(a.m)(h.scaleFallOffFactor,f.scaleFallOffFactor,u),r}},{key:"surfaceCoverageCompensationLocal",value:function(e,t,r){return(e.fovY-r.tiltAngle)/e.fovY}},{key:"surfaceCoverageCompensationGlobal",value:function(e,t,r){var n=t*t,i=r.tiltAngle+.5*Math.PI,a=e.fovY,o=e.distance,s=o*o+n-2*Math.cos(i)*o*t,c=Math.sqrt(s),l=Math.sqrt(s-n);return(Math.acos(l/c)-Math.asin(t/(c/Math.sin(i)))+.5*a)/a}}]),e}(),b={curvatureDependent:{min:{curvature:Object(a.g)(10),tiltAngle:Object(a.g)(12),scaleFallOffFactor:.5},max:{curvature:Object(a.g)(70),tiltAngle:Object(a.g)(40),scaleFallOffFactor:.8}},scaleStart:.3,scaleFallOffRange:.65,minPixelSize:0},v={curvatureDependent:{min:{scaleFallOffFactor:.7},max:{scaleFallOffFactor:.95}},minPixelSize:14};var m={scale:0,factor:0,minPixelSize:0,paddingPixels:0},y={tiltAngle:0,scaleFallOffFactor:0}},function(e,t,r){"use strict";r.d(t,"a",(function(){return a})),r.d(t,"b",(function(){return o})),r.d(t,"c",(function(){return s})),r.d(t,"d",(function(){return c}));var n=r(2),i=r(9),a=function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Object(i.e)();Object(n.a)(this,e),this.intensity=t},o=function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Object(i.e)(),r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Object(i.g)(.57735,.57735,.57735);Object(n.a)(this,e),this.intensity=t,this.direction=r},s=function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Object(i.e)(),r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Object(i.g)(.57735,.57735,.57735),a=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];Object(n.a)(this,e),this.intensity=t,this.direction=r,this.castShadows=a},c=function e(){Object(n.a)(this,e),this.r=[0],this.g=[0],this.b=[0]}},function(e,t,r){"use strict";var n,i=r(2),a=r(5),o=r(6),s=r(7),c=r(0),l=r(27),u=r(3),d=r(340),h=r(1),f=(r(17),r(18),r(15),r(48)),p=r(10),b=r(44),v=n=function(e){Object(o.a)(r,e);var t=Object(s.a)(r);function r(e){var n;return Object(i.a)(this,r),(n=t.call(this,e)).end=null,n.start=null,n}return Object(a.a)(r,[{key:"readEnd",value:function(e,t){return null!=t.end?new Date(t.end):null}},{key:"writeEnd",value:function(e,t){t.end=e?e.getTime():null}},{key:"isAllTime",get:function(){return this.equals(n.allTime)}},{key:"isEmpty",get:function(){return this.equals(n.empty)}},{key:"readStart",value:function(e,t){return null!=t.start?new Date(t.start):null}},{key:"writeStart",value:function(e,t){t.start=e?e.getTime():null}},{key:"clone",value:function(){return new n({end:this.end,start:this.start})}},{key:"expandTo",value:function(e){if(this.isEmpty||this.isAllTime)return this.clone();var t=Object(u.b)(this.start,(function(t){return Object(d.c)(t,e)})),r=Object(u.b)(this.end,(function(t){return Object(d.b)(Object(d.c)(t,e),1,e)}));return new n({start:t,end:r})}},{key:"intersection",value:function(e){if(!e)return this.clone();if(this.isEmpty||e.isEmpty)return n.empty;if(this.isAllTime)return e.clone();if(e.isAllTime)return this.clone();var t,r,i=Object(u.m)(this.start,-1/0,(function(e){return e.getTime()})),a=Object(u.m)(this.end,1/0,(function(e){return e.getTime()})),o=Object(u.m)(e.start,-1/0,(function(e){return e.getTime()})),s=Object(u.m)(e.end,1/0,(function(e){return e.getTime()}));if(o>=i&&o<=a?t=o:i>=o&&i<=s&&(t=i),a>=o&&a<=s?r=a:s>=i&&s<=a&&(r=s),!isNaN(t)&&!isNaN(r)){var c=new n;return c.start=t===-1/0?null:new Date(t),c.end=r===1/0?null:new Date(r),c}return n.empty}},{key:"offset",value:function(e,t){if(this.isEmpty||this.isAllTime)return this.clone();var r=new n,i=this.start,a=this.end;return Object(u.j)(i)&&(r.start=Object(d.b)(i,e,t)),Object(u.j)(a)&&(r.end=Object(d.b)(a,e,t)),r}},{key:"equals",value:function(e){if(!e)return!1;var t=Object(u.j)(this.start)?this.start.getTime():this.start,r=Object(u.j)(this.end)?this.end.getTime():this.end,n=Object(u.j)(e.start)?e.start.getTime():e.start,i=Object(u.j)(e.end)?e.end.getTime():e.end;return t===n&&r===i}},{key:"union",value:function(e){if(!e||e.isEmpty)return this.clone();if(this.isEmpty)return e.clone();if(this.isAllTime||e.isAllTime)return m.clone();var t=Object(u.j)(this.start)&&Object(u.j)(e.start)?new Date(Math.min(this.start.getTime(),e.start.getTime())):null,r=Object(u.j)(this.end)&&Object(u.j)(e.end)?new Date(Math.max(this.end.getTime(),e.end.getTime())):null;return new n({start:t,end:r})}}],[{key:"allTime",get:function(){return m}},{key:"empty",get:function(){return y}}]),r}(l.a);Object(c.a)([Object(h.b)({type:Date,json:{write:{allowNull:!0}}})],v.prototype,"end",void 0),Object(c.a)([Object(f.a)("end")],v.prototype,"readEnd",null),Object(c.a)([Object(b.a)("end")],v.prototype,"writeEnd",null),Object(c.a)([Object(h.b)({readOnly:!0,json:{read:!1}})],v.prototype,"isAllTime",null),Object(c.a)([Object(h.b)({readOnly:!0,json:{read:!1}})],v.prototype,"isEmpty",null),Object(c.a)([Object(h.b)({type:Date,json:{write:{allowNull:!0}}})],v.prototype,"start",void 0),Object(c.a)([Object(f.a)("start")],v.prototype,"readStart",null),Object(c.a)([Object(b.a)("start")],v.prototype,"writeStart",null);var m=new(v=n=Object(c.a)([Object(p.a)("esri.TimeExtent")],v)),y=new v({start:void 0,end:void 0}),g=v;t.a=g},function(e,t,r){"use strict";r.d(t,"a",(function(){return u})),r.d(t,"b",(function(){return h})),r.d(t,"c",(function(){return d})),r.d(t,"d",(function(){return p})),r.d(t,"e",(function(){return v})),r.d(t,"f",(function(){return m})),r.d(t,"g",(function(){return b})),r.d(t,"h",(function(){return y}));var n=r(8),i=r.n(n),a=r(16),o=r(15),s=r(342),c=r(153),l=o.a.getLogger("esri.views.3d.layers.graphics.featureExpressionInfoUtils");function u(e){return{cachedResult:e.cachedResult,arcade:e.arcade?{func:e.arcade.func,context:e.arcade.modules.arcadeUtils.createExecContext(null,{sr:e.arcade.context.spatialReference}),modules:e.arcade.modules}:null}}function d(e){var t=e&&e.expression;if("string"==typeof t){var r=O(t);if(null!=r)return{cachedResult:r}}return null}function h(e,t,r){return f.apply(this,arguments)}function f(){return(f=Object(a.a)(i.a.mark((function e(t,r,n){var a,o,s,l,u;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("string"==typeof(a=t&&t.expression)){e.next=3;break}return e.abrupt("return",null);case 3:if(null==(o=O(a))){e.next=6;break}return e.abrupt("return",{cachedResult:o});case 6:return e.next=8,Object(c.e)();case 8:return s=e.sent,l=s.arcadeUtils,u=l.createSyntaxTree(a),e.abrupt("return",l.dependsOnView(u)?(null!=n&&n.error("Expressions containing '$view' are not supported on ElevationInfo"),{cachedResult:0}):{arcade:{func:l.createFunction(u),context:l.createExecContext(null,{sr:r}),modules:s}});case 12:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function p(e,t,r){return e.arcadeUtils.createFeature(t.attributes,t.geometry,r)}function b(e,t){if(null!=e&&!g(e)){if(!t||!e.arcade)return void l.errorOncePerTick("Arcade support required but not provided");var r=t;r._geometry&&(r._geometry=Object(s.b)(r._geometry)),e.arcade.modules.arcadeUtils.updateExecContext(e.arcade.context,t)}}function v(e){if(null!=e){if(g(e))return e.cachedResult;var t=e.arcade,r=e.arcade.modules.arcadeUtils.executeFunction(t.func,t.context);return"number"!=typeof r&&(e.cachedResult=0,r=0),r}return 0}function m(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=e&&e.featureExpressionInfo,n=r&&r.expression;return t||"0"===n||(r=null),r}var y={cachedResult:0};function g(e){return null!=e.cachedResult}function O(e){return"0"===e?0:null}},function(e,t,r){"use strict";var n,i=r(2),a=r(5),o=r(45),s=r(42),c=r(6),l=r(7),u=r(0),d=r(49),h=r(58),f=r(25),p=r(28),b=r(1),v=(r(18),r(17),r(15),r(52)),m=r(10),y=r(44),g=r(389),O=r(166),j=new h.a({esriSMSCircle:"circle",esriSMSSquare:"square",esriSMSCross:"cross",esriSMSX:"x",esriSMSDiamond:"diamond",esriSMSTriangle:"triangle",esriSMSPath:"path"}),_=n=function(e){Object(c.a)(r,e);var t=Object(l.a)(r);function r(){var e;Object(i.a)(this,r);for(var n=arguments.length,a=new Array(n),o=0;o<n;o++)a[o]=arguments[o];return(e=t.call.apply(t,[this].concat(a))).color=new d.a([255,255,255,.25]),e.type="simple-marker",e.size=12,e.style="circle",e.outline=new O.a,e}return Object(a.a)(r,[{key:"normalizeCtorArgs",value:function(e,t,r,n){if(e&&"string"!=typeof e)return e;var i={};return e&&(i.style=e),null!=t&&(i.size=Object(p.j)(t)),r&&(i.outline=r),n&&(i.color=n),i}},{key:"writeColor",value:function(e,t){e&&"x"!==this.style&&"cross"!==this.style&&(t.color=e.toJSON()),null===e&&(t.color=null)}},{key:"path",set:function(e){this.style="path",this._set("path",e)}},{key:"clone",value:function(){return new n({angle:this.angle,color:Object(f.a)(this.color),outline:this.outline&&this.outline.clone(),path:this.path,size:this.size,style:this.style,xoffset:this.xoffset,yoffset:this.yoffset})}},{key:"hash",value:function(){var e;return"".concat(Object(o.a)(Object(s.a)(r.prototype),"hash",this).call(this),".").concat(this.color&&this.color.hash(),".").concat(this.path,".").concat(this.style,".").concat(null==(e=this.outline)?void 0:e.hash())}}]),r}(g.a);Object(u.a)([Object(b.b)()],_.prototype,"color",void 0),Object(u.a)([Object(y.a)("color")],_.prototype,"writeColor",null),Object(u.a)([Object(v.a)({esriSMS:"simple-marker"},{readOnly:!0})],_.prototype,"type",void 0),Object(u.a)([Object(b.b)()],_.prototype,"size",void 0),Object(u.a)([Object(b.b)({type:j.apiValues,json:{read:j.read,write:j.write}})],_.prototype,"style",void 0),Object(u.a)([Object(b.b)({type:String,json:{write:!0}})],_.prototype,"path",null),Object(u.a)([Object(b.b)({types:{key:"type",base:null,defaultKeyValue:"simple-line",typeMap:{"simple-line":O.a}},json:{default:null,write:!0}})],_.prototype,"outline",void 0);var w=_=n=Object(u.a)([Object(m.a)("esri.symbols.SimpleMarkerSymbol")],_);t.a=w},function(e,t,r){"use strict";r.d(t,"a",(function(){return n})),r.d(t,"b",(function(){return a})),r.d(t,"c",(function(){return o})),r.d(t,"d",(function(){return s})),r.d(t,"e",(function(){return c}));r(13),r(33),r(59);function n(e,t){var r=t[0]-e[0],n=t[1]-e[1];if(e.length>2&&t.length>2){var i=e[2]-t[2];return Math.sqrt(r*r+n*n+i*i)}return Math.sqrt(r*r+n*n)}function i(e,t,r){var n=e[0]+r*(t[0]-e[0]),i=e[1]+r*(t[1]-e[1]);return e.length>2&&t.length>2?[n,i,e[2]+r*(t[2]-e[2])]:[n,i]}function a(e,t){return i(e,t,.5)}function o(e){for(var t=e.length,r=0,i=0;i<t-1;++i)r+=n(e[i],e[i+1]);return r}function s(e,t){if(t<=0)return e[0];for(var r=e.length,a=0,o=0;o<r-1;++o){var s=n(e[o],e[o+1]);if(t-a<s){var c=(t-a)/s;return i(e[o],e[o+1],c)}a+=s}return e[r-1]}function c(e,t,r){for(var n=e.length,i=0,a=0,o=0,s=0;s<n;s++){var c=e[s],l=e[(s+1)%n],u=2;i+=c[0]*l[1]-l[0]*c[1],c.length>2&&l.length>2&&r&&(a+=c[0]*l[2]-l[0]*c[2],u=3),c.length>u&&l.length>u&&t&&(o+=c[0]*l[u]-l[0]*c[u])}return i<=0&&a<=0&&o<=0}},function(e,t,r){"use strict";r.d(t,"a",(function(){return l}));var n=r(15),i=r(113),a=r(147),o=r(172),s=r(165),c=n.a.getLogger("esri.intl");function l(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=r.format,i=void 0===n?{}:n;return Object(a.c)(e,(function(e){return u(e,t,i)}))}function u(e,t,r){var n,a,o=e.indexOf(":");if(-1===o?n=e.trim():(n=e.slice(0,o).trim(),a=e.slice(o+1).trim()),!n)return"";var s=Object(i.b)(n,t);if(null==s)return"";var c=r[a]||r[n];return c?d(s,c):a?h(s,a):f(s)}function d(e,t){switch(t.type){case"date":return Object(o.b)(e,t.intlOptions);case"number":return Object(s.b)(e,t.intlOptions);default:return c.warn("missing format descriptor for key {key}"),f(e)}}function h(e,t){switch(t.toLowerCase()){case"dateformat":return Object(o.b)(e);case"numberformat":return Object(s.b)(e);default:return c.warn("inline format is unsupported since 4.12: ".concat(t)),/^(dateformat|datestring)/i.test(t)?Object(o.b)(e):/^numberformat/i.test(t)?Object(s.b)(e):f(e)}}function f(e){switch(typeof e){case"string":return e;case"number":return Object(s.b)(e);case"boolean":return""+e;default:return e instanceof Date?Object(o.b)(e):""}}},function(e,t,r){"use strict";r.d(t,"a",(function(){return x})),r.d(t,"b",(function(){return C})),r.d(t,"c",(function(){return u})),r.d(t,"d",(function(){return w}));var n,i=r(13),a=r(83),o="http://www.w3.org/",s="".concat(o,"2000/svg"),c="".concat(o,"1999/xlink"),l=[],u=function(e,t){var r={};return Object.keys(e).forEach((function(t){r[t]=e[t]})),t&&Object.keys(t).forEach((function(e){r[e]=t[e]})),r},d=function(e,t){return e.vnodeSelector===t.vnodeSelector&&(e.properties&&t.properties?e.properties.key===t.properties.key&&e.properties.bind===t.properties.bind:!e.properties&&!t.properties)},h=function(e){if("string"!=typeof e)throw new Error("Style values must be strings")},f=function(e,t,r){if(""!==t.vnodeSelector)for(var n=r;n<e.length;n++)if(d(e[n],t))return n;return-1},p=function(e,t,r,n){var i=e[t];if(""!==i.vnodeSelector){var a=i.properties;if(!(a?void 0===a.key?a.bind:a.key:void 0))for(var o=0;o<e.length;o++)if(o!==t){var s=e[o];if(d(s,i))throw new Error("".concat(r.vnodeSelector," had a ").concat(i.vnodeSelector," child ").concat("added"===n?n:"removed",", but there is now more than one. You must add unique key properties to make them distinguishable."))}}},b=function(e){if(e.properties){var t=e.properties.enterAnimation;t&&t(e.domNode,e.properties)}},v=[],m=!1,y=function e(t){(t.children||[]).forEach(e),t.properties&&t.properties.afterRemoved&&t.properties.afterRemoved.apply(t.properties.bind||t.properties,[t.domNode])},g=function(){m=!1,v.forEach(y),v.length=0},O=function(e){v.push(e),m||(m=!0,"undefined"!=typeof window&&"requestIdleCallback"in window?window.requestIdleCallback(g,{timeout:16}):setTimeout(g,16))},j=function(e){var t=e.domNode;if(e.properties){var r=e.properties.exitAnimation;if(r){t.style.pointerEvents="none";return void r(t,(function(){t.parentNode&&(t.parentNode.removeChild(t),O(e))}),e.properties)}}t.parentNode&&(t.parentNode.removeChild(t),O(e))},_=function(e,t,r){if(t)for(var n=r.eventHandlerInterceptor,i=Object.keys(t),o=i.length,l=function(o){var l=i[o],u=t[l];if("className"===l)throw new Error('Property "className" is not supported, use "class".');if("class"===l)k(e,u,!0);else if("classes"===l)for(var d=Object.keys(u),f=d.length,p=0;p<f;p++){var b=d[p];u[b]&&e.classList.add(b)}else if("styles"===l)for(var v=Object.keys(u),m=v.length,y=0;y<m;y++){var g=v[y],O=u[g];O&&(h(O),r.styleApplyer(e,g,O))}else if("key"!==l&&null!=u){var j=typeof u;"function"===j?(0===l.lastIndexOf("on",0)&&(n&&(u=n(l,u,e,t)),"oninput"===l&&function(){var e=u;u=function(t){e.apply(this,[t]),t.target["oninput-value"]=t.target.value}}()),e[l]=u):r.namespace===s?"href"===l?e.setAttributeNS(c,l,u):e.setAttribute(l,u):"string"===j&&"value"!==l?"innerHTML"===l?e[l]=a.i.sanitize(u):e.setAttribute(l,u):e[l]=u}},u=0;u<o;u++)l(u)},w=function(e,t,r){(function(e,t,r){if(t){var n,a=Object(i.a)(t);try{for(a.s();!(n=a.n()).done;){var o=n.value;x(o,e,void 0,r)}}catch(s){a.e(s)}finally{a.f()}}})(e,t.children,r),t.text&&(e.textContent=t.text),_(e,t.properties,r),t.properties&&t.properties.afterCreate&&t.properties.afterCreate.apply(t.properties.bind||t.properties,[e,r,t.vnodeSelector,t.properties,t.children])},x=function(e,t,r,n){var i,a=0,o=e.vnodeSelector,c=t.ownerDocument;if(""===o)i=e.domNode=c.createTextNode(e.text),void 0!==r?t.insertBefore(i,r):t.appendChild(i);else{for(var l=0;l<=o.length;++l){var d=o.charAt(l);if(l===o.length||"."===d||"#"===d){var h=o.charAt(a-1),f=o.slice(a,l);"."===h?i.classList.add(f):"#"===h?i.id=f:("svg"===f&&(n=u(n,{namespace:s})),void 0!==n.namespace?i=e.domNode=c.createElementNS(n.namespace,f):(i=e.domNode=e.domNode||c.createElement(f),"input"===f&&e.properties&&void 0!==e.properties.type&&i.setAttribute("type",e.properties.type)),void 0!==r?t.insertBefore(i,r):i.parentNode!==t&&t.appendChild(i)),a=l+1}}w(i,e,n)}},k=function(e,t,r){t&&t.split(" ").forEach((function(t){t&&e.classList.toggle(t,r)}))},S=function(e,t,r,n){if(r){for(var i=!1,o=Object.keys(r),l=o.length,u=0;u<l;u++){var d=o[u],f=r[d],p=t[d];if("class"===d)p!==f&&(k(e,p,!1),k(e,f,!0));else if("classes"===d)for(var b=e.classList,v=Object.keys(f),m=v.length,y=0;y<m;y++){var g=v[y],O=!!f[g];O!==!!p[g]&&(i=!0,O?b.add(g):b.remove(g))}else if("styles"===d)for(var j=Object.keys(f),_=j.length,w=0;w<_;w++){var x=j[w],S=f[x];S!==p[x]&&(i=!0,S?(h(S),n.styleApplyer(e,x,S)):n.styleApplyer(e,x,""))}else if(f||"string"!=typeof p||(f=""),"value"===d){var T=e[d];T!==f&&(e["oninput-value"]?T===e["oninput-value"]:f!==p)&&(e[d]=f,e["oninput-value"]=void 0),f!==p&&(i=!0)}else if(f!==p){var C=typeof f;"function"===C&&n.eventHandlerInterceptor||(n.namespace===s?"href"===d?e.setAttributeNS(c,d,f):e.setAttribute(d,f):"string"===C?"innerHTML"===d?e[d]=a.i.sanitize(f):"role"===d&&""===f?e.removeAttribute(d):e.setAttribute(d,f):e[d]!==f&&(e[d]=f),i=!0)}}return i}},T=function(e,t,r,i,a){if(r===i)return!1;i=i||l;for(var o,s=(r=r||l).length,c=i.length,u=0,h=0,v=!1;h<c;){var m=u<s?r[u]:void 0,y=i[h];if(void 0!==m&&d(m,y))v=n(m,y,a)||v,u++;else{var g=f(r,y,u+1);if(g>=0){for(o=u;o<g;o++)j(r[o]),p(r,o,e,"removed");v=n(r[g],y,a)||v,u=g+1}else x(y,t,u<s?r[u].domNode:void 0,a),b(y),p(i,h,e,"added")}h++}if(s>u)for(o=u;o<s;o++)j(r[o]),p(r,o,e,"removed");return v};n=function(e,t,r){var n=e.domNode,i=!1;if(e===t)return!1;var a=!1;if(""===t.vnodeSelector){if(t.text!==e.text){var o=n.ownerDocument.createTextNode(t.text);return n.parentNode.replaceChild(o,n),t.domNode=o,i=!0}t.domNode=n}else 0===t.vnodeSelector.lastIndexOf("svg",0)&&(r=u(r,{namespace:s})),e.text!==t.text&&(a=!0,void 0===t.text?n.removeChild(n.firstChild):n.textContent=t.text),t.domNode=n,a=T(t,n,e.children,t.children,r)||a,a=S(n,e.properties,t.properties,r)||a,t.properties&&t.properties.afterUpdate&&t.properties.afterUpdate.apply(t.properties.bind||t.properties,[n,r,t.vnodeSelector,t.properties,t.children]);return a&&t.properties&&t.properties.updateAnimation&&t.properties.updateAnimation(n,t.properties,e.properties),i};var C=function(e,t){return{getLastRender:function(){return e},update:function(r){if(e.vnodeSelector!==r.vnodeSelector)throw new Error("The selector for the root VNode may not be changed. (consider using dom.merge and add one extra level to the virtual DOM)");var i=e;e=r,n(i,r,t)},domNode:e.domNode}}},function(e,t,r){"use strict";r.d(t,"a",(function(){return v})),r.d(t,"b",(function(){return b}));var n=r(19),i=r(6),a=r(7),o=r(50),s=r(2),c=r(5),l=r(0),u=r(30),d=r(3),h=r(23),f=r(10),p=function(){function e(t){var r=this;Object(s.a)(this,e),this.instance=t,this._resolver=Object(h.g)(),this._status=0,this._resolvingPromises=[],this._resolver.promise.then((function(){r._status=1,r._cleanUp()}),(function(){r._status=2,r._cleanUp()}))}return Object(c.a)(e,[{key:"addResolvingPromise",value:function(e){this._resolvingPromises.push(e),this._tryResolve()}},{key:"isResolved",value:function(){return 1===this._status}},{key:"isRejected",value:function(){return 2===this._status}},{key:"isFulfilled",value:function(){return 0!==this._status}},{key:"abort",value:function(){this._resolver.reject(Object(h.f)())}},{key:"when",value:function(e,t){return this._resolver.promise.then(e,t)}},{key:"_cleanUp",value:function(){this._allPromise=this._resolvingPromises=this._allPromise=null}},{key:"_tryResolve",value:function(){var e=this;if(!this.isFulfilled()){var t=Object(h.g)(),r=[].concat(Object(o.a)(this._resolvingPromises),[Object(d.d)(t.promise)]),n=this._allPromise=Promise.all(r);n.then((function(){e.isFulfilled()||e._allPromise!==n||e._resolver.resolve(e.instance)}),(function(t){e.isFulfilled()||e._allPromise!==n||Object(h.n)(t)||e._resolver.reject(t)})),t.resolve()}}}]),e}(),b=function(e){var t=function(e){Object(i.a)(r,e);var t=Object(a.a)(r);function r(){var e;Object(s.a)(this,r);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return(e=t.call.apply(t,[this].concat(a)))._promiseProps=new p(Object(n.a)(e)),e.addResolvingPromise(Promise.resolve()),e}return Object(c.a)(r,[{key:"isResolved",value:function(){return this._promiseProps.isResolved()}},{key:"isRejected",value:function(){return this._promiseProps.isRejected()}},{key:"isFulfilled",value:function(){return this._promiseProps.isFulfilled()}},{key:"when",value:function(e,t){var r=this;return new Promise((function(e,t){r._promiseProps.when(e,t)})).then(e,t)}},{key:"catch",value:function(e){return this.when(null,e)}},{key:"addResolvingPromise",value:function(e){e&&!this._promiseProps.isFulfilled()&&this._promiseProps.addResolvingPromise("_promiseProps"in e?e.when():e)}}]),r}(e);return t=Object(l.a)([Object(f.a)("esri.core.Promise")],t)},v=function(e){Object(i.a)(r,e);var t=Object(a.a)(r);function r(){return Object(s.a)(this,r),t.apply(this,arguments)}return r}(b(u.a));v=Object(l.a)([Object(f.a)("esri.core.Promise")],v)},function(e,t,r){"use strict";r.d(t,"a",(function(){return u})),r.d(t,"b",(function(){return o})),r.d(t,"c",(function(){return c}));var n,i={exports:{}};void 0!==(n=["precision","highp","mediump","lowp","attribute","const","uniform","varying","break","continue","do","for","while","if","else","in","out","inout","float","int","void","bool","true","false","discard","return","mat2","mat3","mat4","vec2","vec3","vec4","ivec2","ivec3","ivec4","bvec2","bvec3","bvec4","sampler1D","sampler2D","sampler3D","samplerCube","sampler1DShadow","sampler2DShadow","struct","asm","class","union","enum","typedef","template","this","packed","goto","switch","default","inline","noinline","volatile","public","static","extern","external","interface","long","short","double","half","fixed","unsigned","input","output","hvec2","hvec3","hvec4","dvec2","dvec3","dvec4","fvec2","fvec3","fvec4","sampler2DRect","sampler3DRect","sampler2DRectShadow","sizeof","cast","namespace","using"])&&(i.exports=n);var a,o=i.exports,s={exports:{}};a=s,function(e){var t=["<<=",">>=","++","--","<<",">>","<=",">=","==","!=","&&","||","+=","-=","*=","/=","%=","&=","^^","^=","|=","(",")","[","]",".","!","~","*","/","%","+","-","<",">","&","^","|","?",":","=",",",";","{","}"];void 0!==t&&(a.exports=t)}();var c=s.exports,l={exports:{}};!function(e){!function(t){var r=["abs","acos","all","any","asin","atan","ceil","clamp","cos","cross","dFdx","dFdy","degrees","distance","dot","equal","exp","exp2","faceforward","floor","fract","gl_BackColor","gl_BackLightModelProduct","gl_BackLightProduct","gl_BackMaterial","gl_BackSecondaryColor","gl_ClipPlane","gl_ClipVertex","gl_Color","gl_DepthRange","gl_DepthRangeParameters","gl_EyePlaneQ","gl_EyePlaneR","gl_EyePlaneS","gl_EyePlaneT","gl_Fog","gl_FogCoord","gl_FogFragCoord","gl_FogParameters","gl_FragColor","gl_FragCoord","gl_FragData","gl_FragDepth","gl_FragDepthEXT","gl_FrontColor","gl_FrontFacing","gl_FrontLightModelProduct","gl_FrontLightProduct","gl_FrontMaterial","gl_FrontSecondaryColor","gl_LightModel","gl_LightModelParameters","gl_LightModelProducts","gl_LightProducts","gl_LightSource","gl_LightSourceParameters","gl_MaterialParameters","gl_MaxClipPlanes","gl_MaxCombinedTextureImageUnits","gl_MaxDrawBuffers","gl_MaxFragmentUniformComponents","gl_MaxLights","gl_MaxTextureCoords","gl_MaxTextureImageUnits","gl_MaxTextureUnits","gl_MaxVaryingFloats","gl_MaxVertexAttribs","gl_MaxVertexTextureImageUnits","gl_MaxVertexUniformComponents","gl_ModelViewMatrix","gl_ModelViewMatrixInverse","gl_ModelViewMatrixInverseTranspose","gl_ModelViewMatrixTranspose","gl_ModelViewProjectionMatrix","gl_ModelViewProjectionMatrixInverse","gl_ModelViewProjectionMatrixInverseTranspose","gl_ModelViewProjectionMatrixTranspose","gl_MultiTexCoord0","gl_MultiTexCoord1","gl_MultiTexCoord2","gl_MultiTexCoord3","gl_MultiTexCoord4","gl_MultiTexCoord5","gl_MultiTexCoord6","gl_MultiTexCoord7","gl_Normal","gl_NormalMatrix","gl_NormalScale","gl_ObjectPlaneQ","gl_ObjectPlaneR","gl_ObjectPlaneS","gl_ObjectPlaneT","gl_Point","gl_PointCoord","gl_PointParameters","gl_PointSize","gl_Position","gl_ProjectionMatrix","gl_ProjectionMatrixInverse","gl_ProjectionMatrixInverseTranspose","gl_ProjectionMatrixTranspose","gl_SecondaryColor","gl_TexCoord","gl_TextureEnvColor","gl_TextureMatrix","gl_TextureMatrixInverse","gl_TextureMatrixInverseTranspose","gl_TextureMatrixTranspose","gl_Vertex","greaterThan","greaterThanEqual","inversesqrt","length","lessThan","lessThanEqual","log","log2","matrixCompMult","max","min","mix","mod","normalize","not","notEqual","pow","radians","reflect","refract","sign","sin","smoothstep","sqrt","step","tan","texture2D","texture2DLod","texture2DProj","texture2DProjLod","textureCube","textureCubeLod","texture2DLodEXT","texture2DProjLodEXT","textureCubeLodEXT","texture2DGradEXT","texture2DProjGradEXT","textureCubeGradEXT"];void 0!==r&&(e.exports=r)}()}(l);var u=l.exports},function(e,t,r){"use strict";r.d(t,"a",(function(){return m}));var n=r(2),i=r(5),a=r(6),o=r(7),s=r(0),c=r(30),l=r(57),u=r(3),d=r(141),h=r(35),f=r(200),p=r(300),b=r(1),v=r(10),m=function(e){Object(a.a)(r,e);var t=Object(o.a)(r);function r(){var e;return Object(n.a)(this,r),(e=t.apply(this,arguments)).updating=!1,e.handleId=0,e.handles=new l.a,e.scheduleHandleId=0,e.pendingPromises=new Set,e}return Object(i.a)(r,[{key:"destroy",value:function(){this.removeAll(),this.handles.destroy()}},{key:"add",value:function(e,t,r){var n=this,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,a=0!=(1&i),o=++this.handleId;a||this.installSyncUpdatingWatch(e,t,o);var s=0!=(2&i)?Object(h.a)(e,t,r,a):e.watch(t,r,a);return this.handles.add(s,o),{remove:function(){return n.handles.remove(o)}}}},{key:"addOnCollectionPropertyChange",value:function(e,t,r){var n=this,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,a=0!=(2&i),o=++this.handleId;return this.handles.add([Object(h.b)(e,t,"after-changes",this.createSyncUpdatingCallback()),Object(h.b)(e,t,"change",r,a?function(e){r({added:e.items,removed:[],moved:[],target:e})}:void 0)],o),{remove:function(){n.handles.remove(o)}}}},{key:"addOnCollectionChange",value:function(e,t){var r=this,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=0!=(2&n),a=++this.handleId;return this.handles.add([e.on("after-changes",this.createSyncUpdatingCallback()),e.on("change",t)],a),i&&t({added:e.items,removed:[],moved:[],target:e}),{remove:function(){r.handles.remove(a)}}}},{key:"addPromise",value:function(e){var t=this;if(Object(u.i)(e))return e;var r=++this.handleId;this.handles.add({remove:function(){t.pendingPromises.delete(e)&&(0!==t.pendingPromises.size||t.handles.has(y)||t._set("updating",!1))}},r),this.pendingPromises.add(e),this._set("updating",!0);var n=function(){return t.handles.remove(r)};return e.then(n,n),e}},{key:"removeAll",value:function(){this.pendingPromises.clear(),this.handles.removeAll(),this._set("updating",!1)}},{key:"installSyncUpdatingWatch",value:function(e,t,r){var n=this.createSyncUpdatingCallback(),i=Object(p.b)((function(){return Object(f.c)(e,t)}),n);return this.handles.add(i,r),i}},{key:"createSyncUpdatingCallback",value:function(){var e=this;return function(){e.handles.remove(y),++e.scheduleHandleId;var t=e.scheduleHandleId;e._get("updating")||e._set("updating",!0),e.handles.add(Object(d.b)((function(){t===e.scheduleHandleId&&(e._set("updating",e.pendingPromises.size>0),e.handles.remove(y))})),y)}}}]),r}(c.a);Object(s.a)([Object(b.b)({readOnly:!0})],m.prototype,"updating",void 0),m=Object(s.a)([Object(v.a)("esri.views.support.WatchUpdatingTracking")],m);var y=-42},function(e,t,r){"use strict";r.d(t,"a",(function(){return a})),r.d(t,"b",(function(){return i})),r.d(t,"c",(function(){return o}));var n=r(58);function i(e){return"point"===e||"multipoint"===e||"polyline"===e||"polygon"===e}var a=Object(n.b)()({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon"}),o=Object(n.b)()({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon",esriGeometryEnvelope:"extent",mesh:"mesh"})},function(e,t,r){"use strict";r.d(t,"a",(function(){return O})),r.d(t,"b",(function(){return _})),r.d(t,"c",(function(){return g}));var n=r(8),i=r.n(n),a=r(2),o=r(5),s=r(33),c=r(16),l=r(13),u=r(22),d=r(23),h=r(138),f=/^([a-z]{2})(?:[-_]([A-Za-z]{2}))?$/,p={ar:!0,bs:!0,ca:!0,cs:!0,da:!0,de:!0,el:!0,en:!0,es:!0,et:!0,fi:!0,fr:!0,he:!0,hr:!0,hu:!0,id:!0,it:!0,ja:!0,ko:!0,lt:!0,lv:!0,nb:!0,nl:!0,pl:!0,"pt-BR":!0,"pt-PT":!0,ro:!0,ru:!0,sk:!0,sl:!0,sr:!0,sv:!0,th:!0,tr:!0,uk:!0,vi:!0,"zh-CN":!0,"zh-HK":!0,"zh-TW":!0};function b(e){var t;return null!=(t=p[e])&&t}var v=[],m=new Map;function y(e){var t,r=Object(l.a)(m.keys());try{for(r.s();!(t=r.n()).done;){var n=t.value;k(e.pattern,n)&&m.delete(n)}}catch(i){r.e(i)}finally{r.f()}}function g(e){return v.includes(e)||(y(e),v.unshift(e)),{remove:function(){var t=v.indexOf(e);t>-1&&(v.splice(t,1),y(e))}}}function O(e){return j.apply(this,arguments)}function j(){return(j=Object(c.a)(i.a.mark((function e(t){var r,n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=Object(h.b)(),m.has(t)||m.set(t,w(t,r)),n=m.get(t),e.next=5,S.add(n);case 5:return e.abrupt("return",n);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function _(e){if(!f.test(e))return null;var t=f.exec(e),r=Object(s.a)(t,3),n=r[1],i=r[2],a=n+(i?"-"+i.toUpperCase():"");return b(a)?a:b(n)?n:null}function w(e,t){return x.apply(this,arguments)}function x(){return(x=Object(c.a)(i.a.mark((function e(t,r){var n,a,o,s;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=[],a=Object(l.a)(v),e.prev=2,a.s();case 4:if((o=a.n()).done){e.next=18;break}if(!k((s=o.value).pattern,t)){e.next=16;break}return e.prev=7,e.next=10,s.fetchMessageBundle(t,r);case 10:return e.abrupt("return",e.sent);case 13:e.prev=13,e.t0=e.catch(7),n.push(e.t0);case 16:e.next=4;break;case 18:e.next=23;break;case 20:e.prev=20,e.t1=e.catch(2),a.e(e.t1);case 23:return e.prev=23,a.f(),e.finish(23);case 26:if(!n.length){e.next=28;break}throw new u.a("intl:message-bundle-error",'Errors occurred while loading "'.concat(t,'"'),{errors:n});case 28:throw new u.a("intl:no-message-bundle-loader",'No loader found for message bundle "'.concat(t,'"'));case 29:case"end":return e.stop()}}),e,null,[[2,20,23,26],[7,13]])})))).apply(this,arguments)}function k(e,t){return"string"==typeof e?t.startsWith(e):e.test(t)}Object(h.a)((function(){m.clear()}));var S=new(function(){function e(){Object(a.a)(this,e),this._numLoading=0}return Object(o.a)(e,[{key:"waitForAll",value:function(){var e=Object(c.a)(i.a.mark((function e(){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=this._dfd,!e.t0){e.next=4;break}return e.next=4,this._dfd.promise;case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"add",value:function(e){var t=this;return this._increase(),e.then((function(){return t._decrease()}),(function(){return t._decrease()})),this.waitForAll()}},{key:"_increase",value:function(){this._numLoading++,this._dfd||(this._dfd=Object(d.g)())}},{key:"_decrease",value:function(){this._numLoading=Math.max(this._numLoading-1,0),this._dfd&&0===this._numLoading&&(this._dfd.resolve(),this._dfd=null)}}]),e}())},function(e,t,r){"use strict";r.d(t,"a",(function(){return v})),r.d(t,"b",(function(){return b})),r.d(t,"c",(function(){return p}));var n=r(2),i=r(5),a=r(26),o=r(31),s=r(4),c=r(9),l=r(54),u=r(43),d=r(155),h=r(79),f=r(163);function p(e){return function(t,r,n){return Object(s.k)(m,t,r,n),!Object(d.f)(e,m)}}var b=function(){function e(){Object(n.a)(this,e),this.min=new v,this.max=new v,this.hud=new v,this.ground=new v}return Object(i.a)(e,[{key:"init",value:function(e){this.min.init(e),this.max.init(e),this.hud.init(e),this.ground.init(e),this.all=[]}}]),e}(),v=function(){function e(t){Object(n.a)(this,e),this.normal=Object(c.e)(),this.transformation=Object(o.d)(),this._ray=Object(h.c)(),this.init(t)}return Object(i.a)(e,[{key:"ray",get:function(){return this._ray}},{key:"hasIntersectionPoint",get:function(){return null!=this.dist}},{key:"distanceInRenderSpace",get:function(){if(null!=this.dist)return Object(s.g)(y,this.ray.direction,this.dist),Object(s.r)(y)}},{key:"getIntersectionPoint",value:function(e){return!!this.hasIntersectionPoint&&(Object(s.g)(y,this.ray.direction,this.dist),Object(s.h)(e,this.ray.origin,y),!0)}},{key:"getTransformedNormal",value:function(e){return Object(s.m)(g,this.normal),g[3]=0,Object(l.m)(g,g,this.transformation),Object(s.m)(e,g),Object(s.t)(e,e),e}},{key:"init",value:function(e){this.dist=void 0,this.target=void 0,this.name=void 0,this.drapedLayerOrder=void 0,this.drapedLayerGraphicOrder=void 0,this.center=null,this.geometryId=null,this.triangleNr=null,this.intersector="Stage",e?Object(h.b)(e,this._ray):this._ray=Object(h.c)()}},{key:"set",value:function(e,t,r,n,i,o,l,u,d,h){e instanceof f.a&&(e={type:"stage",obj:e}),this.dist=r,Object(s.m)(this.normal,n),Object(a.d)(this.transformation,i),this.target=e,this.name=t,this.drapedLayerOrder=o,this.center=l?Object(c.c)(l):null,this.geometryId=u,this.triangleNr=d,this.drapedLayerGraphicOrder=h}},{key:"copyFrom",value:function(e){Object(h.b)(e.ray,this._ray),this.dist=e.dist,this.target=e.target,this.name=e.name,this.drapedLayerOrder=e.drapedLayerOrder,this.center=e.center?Object(c.c)(e.center):null,this.geometryId=e.geometryId,this.triangleNr=e.triangleNr,this.intersector=e.intersector,this.drapedLayerGraphicOrder=e.drapedLayerGraphicOrder,Object(s.m)(this.normal,e.normal),Object(a.d)(this.transformation,e.transformation)}}]),e}(),m=Object(c.e)(),y=Object(c.e)(),g=Object(u.e)()},function(e,t,r){"use strict";function n(){return new Float32Array(2)}function i(e,t){var r=new Float32Array(2);return r[0]=e,r[1]=t,r}function a(){return n()}function o(){return i(1,1)}function s(){return i(1,0)}function c(){return i(0,1)}r.d(t,"a",(function(){return n})),r.d(t,"b",(function(){return i}));var l=a(),u=o(),d=s(),h=c();Object.freeze({__proto__:null,create:n,clone:function(e){var t=new Float32Array(2);return t[0]=e[0],t[1]=e[1],t},fromValues:i,createView:function(e,t){return new Float32Array(e,t,2)},zeros:a,ones:o,unitX:s,unitY:c,ZEROS:l,ONES:u,UNIT_X:d,UNIT_Y:h})},function(e,t,r){"use strict";r.d(t,"a",(function(){return c}));var n,i,a,o=r(12),s=r(11);function c(e,t){1===t.attributeTextureCoordinates&&(e.attributes.add("uv0","vec2"),e.varyings.add("vuv0","vec2"),e.vertex.code.add(Object(s.a)(n||(n=Object(o.a)(["void forwardTextureCoordinates() {\nvuv0 = uv0;\n}"]))))),2===t.attributeTextureCoordinates&&(e.attributes.add("uv0","vec2"),e.varyings.add("vuv0","vec2"),e.attributes.add("uvRegion","vec4"),e.varyings.add("vuvRegion","vec4"),e.vertex.code.add(Object(s.a)(i||(i=Object(o.a)(["void forwardTextureCoordinates() {\nvuv0 = uv0;\nvuvRegion = uvRegion;\n}"]))))),0===t.attributeTextureCoordinates&&e.vertex.code.add(Object(s.a)(a||(a=Object(o.a)(["void forwardTextureCoordinates() {}"]))))}},function(e,t,r){"use strict";r.d(t,"a",(function(){return u})),r.d(t,"b",(function(){return l})),r.d(t,"c",(function(){return s})),r.d(t,"d",(function(){return c}));var n=r(2),i=r(5),a=r(108),o=r(151),s=Object(a.a)().vec3f("position"),c=Object(a.a)().vec3f("position").vec2f("uv0"),l=Object(a.a)().vec3f("position").vec4u8("color"),u=function(){function e(t){Object(n.a)(this,e),this.vertexBufferLayout=t}return Object(i.a)(e,[{key:"allocate",value:function(e){return this.vertexBufferLayout.createBuffer(e)}},{key:"elementCount",value:function(e){return e.indices.get("position").length}},{key:"write",value:function(e,t,r,n){Object(o.c)(t,this.vertexBufferLayout,e.transformation,e.invTranspTransformation,r,n)}}]),e}()},function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r(2),i=r(5),a=r(182),o=function(){function e(){Object(n.a)(this,e),this.id=Object(a.b)()}return Object(i.a)(e,[{key:"unload",value:function(){}}]),e}()},function(e,t,r){"use strict";r.d(t,"a",(function(){return i})),r.d(t,"b",(function(){return a}));var n=r(18);function i(e){var t=Object(n.e)(100*(1-e));return Math.max(0,Math.min(t,100))}function a(e){var t=1-e/100;return Math.max(0,Math.min(t,1))}},function(e,t,r){"use strict";r.d(t,"a",(function(){return n})),r.d(t,"b",(function(){return h})),r.d(t,"c",(function(){return d})),r.d(t,"d",(function(){return u})),r.d(t,"e",(function(){return l}));r(17);var n,i,a=r(345),o=r(284),s=r(348),c=r(349);function l(e,t){switch(e.type){case"range":var r="range"in e?e.range[0]:e.minValue,i="range"in e?e.range[1]:e.maxValue;if(+t<r||+t>i)return n.VALUE_OUT_OF_RANGE;break;case"coded-value":case"codedValue":if(null==e.codedValues||e.codedValues.every((function(e){return null==e||e.code!==t})))return n.INVALID_CODED_VALUE}return null}(i=n||(n={})).VALUE_OUT_OF_RANGE="domain-validation-error::value-out-of-range",i.INVALID_CODED_VALUE="domain-validation-error::invalid-coded-value";var u={key:"type",base:o.a,typeMap:{range:c.a,"coded-value":a.a,inherited:s.a}};function d(e){if(e&&"range"===e.type)return{min:"range"in e?e.range[0]:e.minValue,max:"range"in e?e.range[1]:e.maxValue}}function h(e){if(!e||!e.type)return null;switch(e.type){case"range":return c.a.fromJSON(e);case"codedValue":return a.a.fromJSON(e);case"inherited":return s.a.fromJSON(e)}return null}},function(e,t,r){"use strict";var n,i=r(14),a=r(2),o=r(5),s=r(6),c=r(7),l=r(0),u=r(30),d=r(58),h=r(25),f=r(1),p=(r(18),r(17),r(15),r(10)),b=r(66),v=r(55),m=r(61),y=new d.a({avgRating:"avg-rating",numRatings:"num-ratings",numComments:"num-comments",numViews:"num-views"}),g=n=function(e){Object(s.a)(r,e);var t=Object(c.a)(r);function r(e){var n;return Object(a.a)(this,r),(n=t.call(this,e)).categories=null,n.disableExtraQuery=!1,n.extent=null,n.num=10,n.query=null,n.sortField=null,n.start=1,n}return Object(o.a)(r,[{key:"sortOrder",get:function(){return this._get("sortOrder")||"asc"},set:function(e){"asc"!==e&&"desc"!==e||this._set("sortOrder",e)}},{key:"clone",value:function(){return new n({categories:this.categories?Object(h.a)(this.categories):null,disableExtraQuery:this.disableExtraQuery,extent:this.extent?this.extent.clone():null,num:this.num,query:this.query,sortField:this.sortField,sortOrder:this.sortOrder,start:this.start})}},{key:"toRequestOptions",value:function(e,t){var r,n;if(this.categories&&(r=this.categories.map((function(e){return Array.isArray(e)?JSON.stringify(e):e}))),this.extent){var a=Object(m.d)(this.extent,v.a.WGS84);a&&(n="".concat(a.xmin,",").concat(a.ymin,",").concat(a.xmax,",").concat(a.ymax))}var o=this.query;!this.disableExtraQuery&&e.extraQuery&&(o="("+o+")"+e.extraQuery);var s={categories:r,bbox:n,q:o,num:this.num,sortField:null,sortOrder:null,start:this.start};return this.sortField&&(s.sortField=this.sortField.split(",").map((function(e){return y.toJSON(e.trim())})).join(","),s.sortOrder=this.sortOrder),{query:Object(i.a)(Object(i.a)({},t),s)}}}]),r}(u.a);Object(l.a)([Object(f.b)()],g.prototype,"categories",void 0),Object(l.a)([Object(f.b)()],g.prototype,"disableExtraQuery",void 0),Object(l.a)([Object(f.b)({type:b.a})],g.prototype,"extent",void 0),Object(l.a)([Object(f.b)()],g.prototype,"num",void 0),Object(l.a)([Object(f.b)()],g.prototype,"query",void 0),Object(l.a)([Object(f.b)()],g.prototype,"sortField",void 0),Object(l.a)([Object(f.b)()],g.prototype,"sortOrder",null),Object(l.a)([Object(f.b)()],g.prototype,"start",void 0);var O=g=n=Object(l.a)([Object(p.a)("esri.portal.PortalQueryParams")],g);t.a=O},function(e,t,r){"use strict";r.d(t,"a",(function(){return b})),r.d(t,"b",(function(){return h})),r.d(t,"c",(function(){return f})),r.d(t,"d",(function(){return p})),r.d(t,"e",(function(){return O})),r.d(t,"f",(function(){return d}));var n=r(147),i="__begin__",a="__end__",o=new RegExp(i,"ig"),s=new RegExp(a,"ig"),c=new RegExp("^"+i,"i"),l=new RegExp(a+"$","i"),u='"';function d(e){return e.replace(new RegExp("\\{","g"),"[").replace(new RegExp("\\}","g"),"]")}function h(e){var t={expression:"",type:"none"};return e.labelExpressionInfo?e.labelExpressionInfo.value?(t.expression=e.labelExpressionInfo.value,t.type="conventional"):e.labelExpressionInfo.expression&&(t.expression=e.labelExpressionInfo.expression,t.type="arcade"):null!=e.labelExpression&&(t.expression=function(e){return e.replace(new RegExp("\\[","g"),"{").replace(new RegExp("\\]","g"),"}")}(e.labelExpression),t.type="conventional"),t}function f(e){var t=h(e);if(!t)return null;switch(t.type){case"conventional":return b(t.expression);case"arcade":return t.expression}return null}function p(e){var t=h(e);if(!t)return null;switch(t.type){case"conventional":return function(e){var t=e.match(v);return t&&t[1].trim()||null}(t.expression);case"arcade":return O(t.expression)}return null}function b(e){var t;return e?(t=Object(n.c)(e,(function(e){return i+'$feature["'+e+'"]'+a})),t=c.test(t)?t.replace(c,""):u+t,t=(t=l.test(t)?t.replace(l,""):t+u).replace(o,'" + ').replace(s,' + "')):t='""',t}var v=/^\s*\{([^}]+)\}\s*$/i;var m=/^\s*(?:(?:\$feature\.(\w+))|(?:\$feature\[(["'])([\w\s]+)(\2)\]));?\s*$/i,y=/^\s*(?:(?:\$feature\.(\w+))|(?:\$feature\[(["'])([\w\s]+)(\2)\]));?\s*(?:DomainName\(\s*\$feature\s*,\s*(["'])(\1|\3)(\5)\s*\));?\s*$/i,g=/^\s*(?:DomainName\(\s*\$feature\s*,\s*(["'])([\w\s]+)(\1)\s*\));?\s*$/i;function O(e){if(!e)return null;var t=m.exec(e)||y.exec(e);return t?t[1]||t[3]:(t=g.exec(e))?t[2]:null}},function(e,t,r){"use strict";r.d(t,"a",(function(){return l})),r.d(t,"b",(function(){return s})),r.d(t,"c",(function(){return c})),r.d(t,"d",(function(){return a})),r.d(t,"e",(function(){return o}));var n=r(50),i=r(101);function a(e){var t=[];return e.levels.forEach((function(e){e.components.forEach((function(e){t.push(e.material)}))})),Object(i.o)(t)}function o(e){var t=[];return e.levels.forEach((function(e){e.components.forEach((function(e){e.textures&&t.push.apply(t,Object(n.a)(e.textures))}))})),Object(i.o)(t)}function s(e){var t=[];return e.components.forEach((function(e){t.push(e.geometry)})),Object(i.o)(t)}function c(e){var t=[];return e.levels.forEach((function(e){e.components.forEach((function(e){t.push(e.geometry)}))})),Object(i.o)(t)}function l(e){return s(e).reduce((function(e,t){return e+t.indexCount/3}),0)}},function(e,t,r){"use strict";var n=r(2),i=r(5),a=function(){function e(t){Object(n.a)(this,e),this._texture=t,this._refCount=1}return Object(i.a)(e,[{key:"retain",value:function(){++this._refCount}},{key:"release",value:function(){--this._refCount,0===this._refCount&&this._texture.dispose()}},{key:"texture",get:function(){return this._texture}},{key:"generateMipmap",value:function(){this._texture.generateMipmap()}},{key:"descriptor",get:function(){return this._texture.descriptor}}]),e}();t.a=a},function(e,t,r){"use strict";var n,i=r(33),a=r(2),o=r(5),s=r(6),c=r(7),l=r(0),u=r(25),d=r(1),h=(r(18),r(17),r(15),r(10)),f=r(44),p=r(66),b=r(160),v=r(56),m=r(311);function y(e){return function(t,r){return null==t?r:null==r?t:e(t,r)}}var g=n=function(e){Object(s.a)(r,e);var t=Object(c.a)(r);function r(){var e;Object(a.a)(this,r);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))).points=[],e.type="multipoint",e}return Object(o.a)(r,[{key:"normalizeCtorArgs",value:function(e,t){if(!e&&!t)return null;var r={};Array.isArray(e)?(r.points=e,r.spatialReference=t):function(e){return e&&("esri.geometry.SpatialReference"===e.declaredClass||null!=e.wkid)}(e)?r.spatialReference=e:(e.points&&(r.points=e.points),e.spatialReference&&(r.spatialReference=e.spatialReference),e.hasZ&&(r.hasZ=e.hasZ),e.hasM&&(r.hasM=e.hasM));var n=r.points&&r.points[0];return n&&(void 0===r.hasZ&&void 0===r.hasM?(r.hasZ=n.length>2,r.hasM=!1):void 0===r.hasZ?r.hasZ=n.length>3:void 0===r.hasM&&(r.hasM=n.length>3)),r}},{key:"cache",get:function(){return this.commitProperty("points"),this.commitProperty("hasZ"),this.commitProperty("hasM"),this.commitProperty("spatialReference"),{}}},{key:"extent",get:function(){var e=this.points;if(!e.length)return null;for(var t,r,n,a,o=new p.a,s=this.hasZ,c=this.hasM,l=s?3:2,u=e[0],d=y(Math.min),h=y(Math.max),f=Object(i.a)(u,2),b=f[0],v=f[1],m=Object(i.a)(u,2),g=m[0],O=m[1],j=0,_=e.length;j<_;j++){var w=e[j],x=Object(i.a)(w,2),k=x[0],S=x[1];if(b=d(b,k),v=d(v,S),g=h(g,k),O=h(O,S),s&&w.length>2){var T=w[2];t=d(t,T),n=h(n,T)}if(c&&w.length>l){var C=w[l];r=d(r,C),a=h(a,C)}}return o.xmin=b,o.ymin=v,o.xmax=g,o.ymax=O,o.spatialReference=this.spatialReference,s?(o.zmin=t,o.zmax=n):(o.zmin=null,o.zmax=null),c?(o.mmin=r,o.mmax=a):(o.mmin=null,o.mmax=null),o}},{key:"writePoints",value:function(e,t){t.points=Object(u.a)(this.points)}},{key:"addPoint",value:function(e){return Object(m.a)(this,e),Array.isArray(e)?this.points.push(e):this.points.push(e.toArray()),this.notifyChange("points"),this}},{key:"clone",value:function(){var e={points:Object(u.a)(this.points),spatialReference:this.spatialReference};return this.hasZ&&(e.hasZ=!0),this.hasM&&(e.hasM=!0),new n(e)}},{key:"getPoint",value:function(e){if(!this._validateInputs(e))return null;var t=this.points[e],r={x:t[0],y:t[1],spatialReference:this.spatialReference},n=2;return this.hasZ&&(r.z=t[2],n=3),this.hasM&&(r.m=t[n]),new v.a(r)}},{key:"removePoint",value:function(e){if(!this._validateInputs(e))return null;var t=new v.a(this.points.splice(e,1)[0],this.spatialReference);return this.notifyChange("points"),t}},{key:"setPoint",value:function(e,t){return this._validateInputs(e)?(Object(m.a)(this,t),Array.isArray(t)||(t=t.toArray()),this.points[e]=t,this.notifyChange("points"),this):this}},{key:"toJSON",value:function(e){return this.write(null,e)}},{key:"_validateInputs",value:function(e){return null!=e&&e>=0&&e<this.points.length}}]),r}(b.a);Object(l.a)([Object(d.b)({readOnly:!0})],g.prototype,"cache",null),Object(l.a)([Object(d.b)()],g.prototype,"extent",null),Object(l.a)([Object(d.b)({type:[[Number]],json:{write:{isRequired:!0}}})],g.prototype,"points",void 0),Object(l.a)([Object(f.a)("points")],g.prototype,"writePoints",null),(g=n=Object(l.a)([Object(h.a)("esri.geometry.Multipoint")],g)).prototype.toJSON.isDefaultToJSON=!0;var O=g;t.a=O},function(e,t,r){"use strict";r.d(t,"a",(function(){return p})),r.d(t,"b",(function(){return d})),r.d(t,"c",(function(){return v})),r.d(t,"d",(function(){return O})),r.d(t,"e",(function(){return h})),r.d(t,"f",(function(){return f})),r.d(t,"g",(function(){return m})),r.d(t,"h",(function(){return y})),r.d(t,"i",(function(){return b})),r.d(t,"j",(function(){return g}));var n=r(33),i=r(3),a=r(39),o=r(130),s=["MapServer","ImageServer","FeatureServer","SceneServer","StreamServer","VectorTileServer"],c=new RegExp("^((?:https?:)?\\/\\/\\S+?\\/rest\\/services\\/(.+?)\\/(".concat(s.join("|"),"))(?:\\/(?:layers\\/)?(\\d+))?"),"i"),l=new RegExp("^((?:https?:)?\\/\\/\\S+?\\/([^\\/\\n]+)\\/(".concat(s.join("|"),"))(?:\\/(?:layers\\/)?(\\d+))?"),"i"),u=/(.*?)\/(?:layers\/)?(\d+)\/?$/i;function d(e){return!!c.test(e)}function h(e){var t=Object(a.K)(e),r=t.path.match(c)||t.path.match(l);if(!r)return null;var i=Object(n.a)(r,5),o=i[1],s=i[2],u=i[3],d=i[4],h=s.indexOf("/");return{title:p(-1!==h?s.slice(h+1):s),serverType:u,sublayer:null!=d&&""!==d?parseInt(d,10):null,url:{path:o}}}function f(e){var t=Object(a.K)(e).path.match(u);return t?{serviceUrl:t[1],sublayerId:Number(t[2])}:null}function p(e){return(e=e.replace(/\s*[/_]+\s*/g," "))[0].toUpperCase()+e.slice(1)}function b(e,t){var r=[];if(e){var n=h(e);Object(i.j)(n)&&n.title&&r.push(n.title)}if(t){var a=p(t);r.push(a)}if(2===r.length){if(-1!==r[0].toLowerCase().indexOf(r[1].toLowerCase()))return r[0];if(-1!==r[1].toLowerCase().indexOf(r[0].toLowerCase()))return r[1]}return r.join(" - ")}function v(e){if(!e)return!1;var t=-1!==(e=e.toLowerCase()).indexOf(".arcgis.com/"),r=-1!==e.indexOf("//services")||-1!==e.indexOf("//tiles")||-1!==e.indexOf("//features");return t&&r}function m(e,t){return e?Object(a.I)(Object(a.H)(e,t)):e}function y(e){var t=e.url;if(!t)return{url:t};t=Object(a.H)(t,e.logger);var r,n=Object(a.K)(t),o=h(n.path);if(Object(i.j)(o))null!=o.sublayer&&null==e.layer.layerId&&(r=o.sublayer),t=o.url.path;else if(e.nonStandardUrlAllowed){var s=f(n.path);Object(i.j)(s)&&(t=s.serviceUrl,r=s.sublayerId)}return{url:Object(a.I)(t),layerId:r}}function g(e,t,r,n,i){Object(o.f)(t,n,"url",i),n.url&&null!=e.layerId&&(n.url=Object(a.z)(n.url,r,e.layerId.toString()))}function O(e){if(!e)return!1;var t=e.toLowerCase(),r=-1!==t.indexOf("/services/"),n=-1!==t.indexOf("/mapserver/wmsserver"),i=-1!==t.indexOf("/imageserver/wmsserver"),a=-1!==t.indexOf("/wmsserver");return r&&(n||i||a)}},function(e,t,r){"use strict";var n,i=r(2),a=r(5),o=r(6),s=r(7),c=r(0),l=r(53),u=r(22),d=r(25),h=r(3),f=r(1),p=(r(18),r(17),r(15),r(52)),b=r(10),v=r(44),m=r(350),y=r(275),g=r(201),O=r(264),j=r(292),_=r(223),w=r(219),x=r(352),k=l.a.ofType({base:null,key:"type",typeMap:{extrude:m.a,fill:y.a,icon:g.a,line:O.a,object:j.a,text:w.a,water:x.a}}),S=l.a.ofType({base:null,key:"type",typeMap:{extrude:m.a,fill:y.a,icon:g.a,line:O.a,object:j.a,water:x.a}}),T=n=function(e){Object(o.a)(r,e);var t=Object(s.a)(r);function r(e){var n;return Object(i.a)(this,r),(n=t.call(this,e)).symbolLayers=new k,n.type="polygon-3d",n}return Object(a.a)(r,[{key:"writeSymbolLayers",value:function(e,t,r,n){var i=e.filter((function(e){return"text"!==e.type}));if(n&&n.messages&&i.length<e.length){var a=e.find((function(e){return"text"===e.type}));n.messages.push(new u.a("symbol-layer:unsupported","Symbol layers of type 'text' cannot be persisted in PolygonSymbol3D",{symbolLayer:a}))}t[r]=i.map((function(e){return e.write({},n)})).toArray()}},{key:"clone",value:function(){return new n({styleOrigin:Object(d.a)(this.styleOrigin),symbolLayers:Object(d.a)(this.symbolLayers),thumbnail:Object(d.a)(this.thumbnail)})}}],[{key:"fromJSON",value:function(e){var t=new n;if(t.read(e),2===t.symbolLayers.length&&"fill"===t.symbolLayers.getItemAt(0).type&&"line"===t.symbolLayers.getItemAt(1).type){var r=t.symbolLayers.getItemAt(0),i=t.symbolLayers.getItemAt(1);!i.enabled||e.symbolLayers&&e.symbolLayers[1]&&!1===e.symbolLayers[1].enable||(r.outline={size:i.size,color:Object(h.j)(i.material)?i.material.color:null}),t.symbolLayers.removeAt(1)}return t}},{key:"fromSimpleFillSymbol",value:function(e){return new n({symbolLayers:[y.a.fromSimpleFillSymbol(e)]})}}]),r}(_.a);Object(c.a)([Object(f.b)({type:k,json:{type:S}})],T.prototype,"symbolLayers",void 0),Object(c.a)([Object(v.a)("web-scene","symbolLayers")],T.prototype,"writeSymbolLayers",null),Object(c.a)([Object(p.a)({PolygonSymbol3D:"polygon-3d"},{readOnly:!0})],T.prototype,"type",void 0);var C=T=n=Object(c.a)([Object(b.a)("esri.symbols.PolygonSymbol3D")],T);t.a=C},function(e,t,r){"use strict";r.d(t,"a",(function(){return u})),r.d(t,"b",(function(){return d}));var n=r(13),i=r(15),a=r(113),o=r(192),s=r(204),c=r(504),l=i.a.getLogger("esri.core.accessorSupport.extensions.serializableProperty.reader");function u(e,t,r){var n,i;e&&(!r&&!t.read||null!=(n=t.read)&&n.reader||!1===(null==(i=t.read)?void 0:i.enabled)||function(e){return"types"in e?m(e.types):v(e.type)}(e)&&Object(a.c)("read.reader",d(e),t))}function d(e){var t,r=null!=(t=e.ndimArray)?t:0;if(r>1)return function(e){var t,r=h(e),n=f.bind(null,r),i=null!=(t=e.ndimArray)?t:0;return function(e,t,r){if(null==e)return e;e=n(e,r,i);for(var a=i,o=e;a>0&&Array.isArray(o);)a--,o=o[0];if(void 0!==o)for(var s=0;s<a;s++)e=[e];return e}}(e);if(1===r)return p(e);if("type"in e&&b(e.type)){var n,i,a=null==(n=e.type.prototype)||null==(i=n.itemType)?void 0:i.Type,o=p("function"==typeof a?{type:a}:{types:a});return function(t,r,n){var i=o(t,r,n);return i?new e.type(i):i}}return h(e)}function h(e){return"type"in e?function(e){return e.prototype.read?function(t,r,n){if(null==t)return t;var i=typeof t;if("object"===i){var a=new e;return a.read(t,n),a}l.error("Expected JSON value of type 'object' to deserialize type '".concat(e.prototype.declaredClass,"', but got '").concat(i,"'"))}:e.fromJSON}(e.type):function(e){var t,r=null,n=null!=(t=e.errorContext)?t:"type";return function(t,i,a){if(null==t)return t;var c=typeof t;if("object"===c){r||(r=function(e){var t={};for(var r in e.typeMap){var n,i,a=e.typeMap[r],o=Object(s.a)(a.prototype);if("function"!=typeof e.key){var c=o.properties[e.key];if(c){null!=(n=c.json)&&n.type&&Array.isArray(c.json.type)&&1===c.json.type.length&&"string"==typeof c.json.type[0]&&(t[c.json.type[0]]=a);var l=null==(i=c.json)?void 0:i.write;if(l&&l.writer){var u=l.target,d="string"==typeof u?u:e.key,h={};l.writer(r,h,d),h[d]&&(t[h[d]]=a)}else t[r]=a}}}return t}(e));var u=e.key;if("string"==typeof u){var d=t[u],h=d?r[d]:e.defaultKeyValue?e.typeMap[e.defaultKeyValue]:void 0;if(!h){var f="Type '".concat(d||"unknown","' is not supported");return a&&a.messages&&t&&a.messages.push(new o.a("".concat(n,":unsupported"),f,{definition:t,context:a})),void l.error(f)}var p=new h;return p.read(t,a),p}}else l.error("Expected JSON value of type 'object' to deserialize, but got '".concat(c,"'"))}}(e.types)}function f(e,t,r,n){return 0!==n&&Array.isArray(t)?t.map((function(t){return f(e,t,r,n-1)})):e(t,void 0,r)}function p(e){var t=h(e);return function(e,r,i){if(null==e)return e;if(Array.isArray(e)){var a,o=[],s=Object(n.a)(e);try{for(s.s();!(a=s.n()).done;){var c=a.value,l=t(c,void 0,i);void 0!==l&&o.push(l)}}catch(d){s.e(d)}finally{s.f()}return o}var u=t(e,void 0,i);return void 0!==u?[u]:void 0}}function b(e){if(!Object(c.a)(e))return!1;var t=e.prototype.itemType;return!(!t||!t.Type)&&("function"==typeof t.Type?v(t.Type):m(t.Type))}function v(e){return!Array.isArray(e)&&!!e&&e.prototype&&("read"in e.prototype||"fromJSON"in e||b(e))}function m(e){for(var t in e.typeMap)if(!v(e.typeMap[t]))return!1;return!0}},function(e,t,r){"use strict";var n,i=r(2),a=r(5),o=r(6),s=r(7),c=r(0),l=r(49),u=r(25),d=r(28),h=r(1),f=r(64),p=(r(17),r(15),r(52)),b=r(10),v=r(44),m=r(330),y=r(135),g=n=function(e){Object(o.a)(r,e);var t=Object(s.a)(r);function r(){var e;Object(i.a)(this,r);for(var n=arguments.length,a=new Array(n),o=0;o<n;o++)a[o]=arguments[o];return(e=t.call.apply(t,[this].concat(a))).backgroundColor=null,e.borderLineColor=null,e.borderLineSize=null,e.font=new m.a,e.horizontalAlignment="center",e.kerning=!0,e.haloColor=null,e.haloSize=null,e.rightToLeft=null,e.rotated=!1,e.text="",e.type="text",e.verticalAlignment=null,e.xoffset=0,e.yoffset=0,e.angle=0,e.width=null,e.lineWidth=192,e.lineHeight=1,e}return Object(a.a)(r,[{key:"normalizeCtorArgs",value:function(e,t,r){if(e&&"string"!=typeof e)return e;var n={};return e&&(n.text=e),t&&(n.font=t),r&&(n.color=r),n}},{key:"writeLineWidth",value:function(e,t,r,n){n&&"string"!=typeof n?n.origin:t[r]=e}},{key:"castLineWidth",value:function(e){return Object(d.j)(e)}},{key:"writeLineHeight",value:function(e,t,r,n){n&&"string"!=typeof n?n.origin:t[r]=e}},{key:"clone",value:function(){return new n({angle:this.angle,backgroundColor:Object(u.a)(this.backgroundColor),borderLineColor:Object(u.a)(this.borderLineColor),borderLineSize:this.borderLineSize,color:Object(u.a)(this.color),font:this.font&&this.font.clone(),haloColor:Object(u.a)(this.haloColor),haloSize:this.haloSize,horizontalAlignment:this.horizontalAlignment,kerning:this.kerning,lineHeight:this.lineHeight,lineWidth:this.lineWidth,rightToLeft:this.rightToLeft,rotated:this.rotated,text:this.text,verticalAlignment:this.verticalAlignment,width:this.width,xoffset:this.xoffset,yoffset:this.yoffset})}},{key:"hash",value:function(){return"".concat(this.backgroundColor&&this.backgroundColor.hash(),".").concat(this.borderLineColor,".").concat(this.borderLineSize,".").concat(this.color.hash(),".").concat(this.font&&this.font.hash(),".").concat(this.haloColor&&this.haloColor.hash(),".").concat(this.haloSize,".").concat(this.horizontalAlignment,".").concat(this.kerning,".").concat(this.rightToLeft,".").concat(this.rotated,".").concat(this.text,".").concat(this.verticalAlignment,".").concat(this.width,".").concat(this.xoffset,".").concat(this.yoffset,".").concat(this.lineHeight,".").concat(this.lineWidth,".").concat(this.angle)}}]),r}(y.a);Object(c.a)([Object(h.b)({type:l.a,json:{write:!0}})],g.prototype,"backgroundColor",void 0),Object(c.a)([Object(h.b)({type:l.a,json:{write:!0}})],g.prototype,"borderLineColor",void 0),Object(c.a)([Object(h.b)({type:Number,json:{write:!0}})],g.prototype,"borderLineSize",void 0),Object(c.a)([Object(h.b)({type:m.a,json:{write:!0}})],g.prototype,"font",void 0),Object(c.a)([Object(h.b)({type:["left","right","center","justify"],json:{write:!0}})],g.prototype,"horizontalAlignment",void 0),Object(c.a)([Object(h.b)({type:Boolean,json:{write:!0}})],g.prototype,"kerning",void 0),Object(c.a)([Object(h.b)({type:l.a,json:{write:!0}})],g.prototype,"haloColor",void 0),Object(c.a)([Object(h.b)({type:Number,cast:d.j,json:{write:!0}})],g.prototype,"haloSize",void 0),Object(c.a)([Object(h.b)({type:Boolean,json:{write:!0}})],g.prototype,"rightToLeft",void 0),Object(c.a)([Object(h.b)({type:Boolean,json:{write:!0}})],g.prototype,"rotated",void 0),Object(c.a)([Object(h.b)({type:String,json:{write:!0}})],g.prototype,"text",void 0),Object(c.a)([Object(p.a)({esriTS:"text"},{readOnly:!0})],g.prototype,"type",void 0),Object(c.a)([Object(h.b)({type:["baseline","top","middle","bottom"],json:{write:!0}})],g.prototype,"verticalAlignment",void 0),Object(c.a)([Object(h.b)({type:Number,cast:d.j,json:{write:!0}})],g.prototype,"xoffset",void 0),Object(c.a)([Object(h.b)({type:Number,cast:d.j,json:{write:!0}})],g.prototype,"yoffset",void 0),Object(c.a)([Object(h.b)({type:Number,json:{read:function(e){return e&&-1*e},write:function(e,t){return t.angle=e&&-1*e}}})],g.prototype,"angle",void 0),Object(c.a)([Object(h.b)({type:Number,json:{write:!0}})],g.prototype,"width",void 0),Object(c.a)([Object(h.b)({type:Number})],g.prototype,"lineWidth",void 0),Object(c.a)([Object(v.a)("lineWidth")],g.prototype,"writeLineWidth",null),Object(c.a)([Object(f.a)("lineWidth")],g.prototype,"castLineWidth",null),Object(c.a)([Object(h.b)({type:Number})],g.prototype,"lineHeight",void 0),Object(c.a)([Object(v.a)("lineHeight")],g.prototype,"writeLineHeight",null);var O=g=n=Object(c.a)([Object(b.a)("esri.symbols.TextSymbol")],g);t.a=O},function(e,t,r){"use strict";var n,i=r(2),a=r(5),o=r(6),s=r(7),c=r(0),l=r(1),u=(r(17),r(18),r(15),r(10)),d=r(181),h=n=function(e){Object(o.a)(r,e);var t=Object(s.a)(r);function r(e){var n;return Object(i.a)(this,r),(n=t.call(this,e)).text=null,n.type="text",n}return Object(a.a)(r,[{key:"clone",value:function(){return new n({text:this.text})}}]),r}(d.a);Object(c.a)([Object(l.b)({type:String,json:{write:!0}})],h.prototype,"text",void 0),Object(c.a)([Object(l.b)({type:["text"],readOnly:!0,json:{read:!1,write:!0}})],h.prototype,"type",void 0);var f=h=n=Object(c.a)([Object(u.a)("esri.popup.content.TextContent")],h);t.a=f},function(e,t,r){"use strict";var n,i=r(14),a=r(2),o=r(5),s=r(45),c=r(42),l=r(6),u=r(7),d=r(0),h=r(101),f=r(58),p=r(27),b=r(69),v=r(192),m=r(1),y=(r(17),r(18),r(15),r(48)),g=r(10),O=r(44),j=Object(f.b)()({orthometric:"gravity-related-height",gravity_related_height:"gravity-related-height",ellipsoidal:"ellipsoidal"}),_=j.jsonValues.slice();Object(h.k)(_,"orthometric");var w=Object(f.b)()({meter:"meters",foot:"feet","us-foot":"us-feet","clarke-foot":"clarke-feet","clarke-yard":"clarke-yards","clarke-link":"clarke-links","sears-yard":"sears-yards","sears-foot":"sears-feet","sears-chain":"sears-chains","benoit-1895-b-chain":"benoit-1895-b-chains","indian-yard":"indian-yards","indian-1937-yard":"indian-1937-yards","gold-coast-foot":"gold-coast-feet","sears-1922-truncated-chain":"sears-1922-truncated-chains","50-kilometers":"50-kilometers","150-kilometers":"150-kilometers"}),x=n=function(e){Object(l.a)(r,e);var t=Object(u.a)(r);function r(e){var n;return Object(a.a)(this,r),(n=t.call(this,e)).heightModel="gravity-related-height",n.heightUnit="meters",n.vertCRS=null,n}return Object(o.a)(r,[{key:"writeHeightModel",value:function(e,t,r){return j.write(e,t,r)}},{key:"readHeightModel",value:function(e,t,r){return j.read(e)||(r&&r.messages&&r.messages.push(function(e,t){return new v.a("height-model:unsupported","Height model of value '".concat(e,"' is not supported"),t)}(e,{context:r})),null)}},{key:"readHeightUnit",value:function(e,t,r){return w.read(e)||(r&&r.messages&&r.messages.push(k(e,{context:r})),null)}},{key:"readHeightUnitService",value:function(e,t,r){return Object(b.u)(e)||w.read(e)||(r&&r.messages&&r.messages.push(k(e,{context:r})),null)}},{key:"readVertCRS",value:function(e,t){return t.vertCRS||t.ellipsoid||t.geoid}},{key:"clone",value:function(){return new n({heightModel:this.heightModel,heightUnit:this.heightUnit,vertCRS:this.vertCRS})}},{key:"equals",value:function(e){return!!e&&(this===e||this.heightModel===e.heightModel&&this.heightUnit===e.heightUnit&&this.vertCRS===e.vertCRS)}},{key:"write",value:function(e,t){return t=Object(i.a)({origin:"web-scene"},t),Object(s.a)(Object(c.a)(r.prototype),"write",this).call(this,e,t)}}],[{key:"deriveUnitFromSR",value:function(e,t){var r=Object(b.i)(t);return new n({heightModel:e.heightModel,heightUnit:r,vertCRS:e.vertCRS})}},{key:"fromJSON",value:function(e){if(!e)return null;var t=new n;return t.read(e,{origin:"web-scene"}),t}}]),r}(p.a);function k(e,t){return new v.a("height-unit:unsupported","Height unit of value '".concat(e,"' is not supported"),t)}Object(d.a)([Object(m.b)({type:j.apiValues,constructOnly:!0,json:{origins:{"web-scene":{type:_,default:"ellipsoidal"}}}})],x.prototype,"heightModel",void 0),Object(d.a)([Object(O.a)("web-scene","heightModel")],x.prototype,"writeHeightModel",null),Object(d.a)([Object(y.a)(["web-scene","service"],"heightModel")],x.prototype,"readHeightModel",null),Object(d.a)([Object(m.b)({type:w.apiValues,constructOnly:!0,json:{origins:{"web-scene":{type:w.jsonValues,write:w.write}}}})],x.prototype,"heightUnit",void 0),Object(d.a)([Object(y.a)("web-scene","heightUnit")],x.prototype,"readHeightUnit",null),Object(d.a)([Object(y.a)("service","heightUnit")],x.prototype,"readHeightUnitService",null),Object(d.a)([Object(m.b)({type:String,constructOnly:!0,json:{origins:{"web-scene":{write:!0}}}})],x.prototype,"vertCRS",void 0),Object(d.a)([Object(y.a)("service","vertCRS",["vertCRS","ellipsoid","geoid"])],x.prototype,"readVertCRS",null);var S=x=n=Object(d.a)([Object(g.a)("esri.geometry.HeightModelInfo")],x);t.a=S},function(e,t,r){"use strict";r.d(t,"a",(function(){return l}));var n,i,a,o,s=r(12),c=r(11);function l(e,t){1===t.viewingMode?e.vertex.code.add(Object(c.a)(n||(n=Object(s.a)(["vec3 getLocalUp(in vec3 pos, in vec3 origin) {\nreturn normalize(pos + origin);\n}"])))):e.vertex.code.add(Object(c.a)(i||(i=Object(s.a)(["vec3 getLocalUp(in vec3 pos, in vec3 origin) {\nreturn vec3(0.0, 0.0, 1.0);\n}"])))),1===t.viewingMode?e.vertex.code.add(Object(c.a)(a||(a=Object(s.a)(["mat3 getTBNMatrix(in vec3 n) {\nvec3 t = normalize(cross(vec3(0.0, 0.0, 1.0), n));\nvec3 b = normalize(cross(n, t));\nreturn mat3(t, b, n);\n}"])))):e.vertex.code.add(Object(c.a)(o||(o=Object(s.a)(["mat3 getTBNMatrix(in vec3 n) {\nvec3 t = vec3(1.0, 0.0, 0.0);\nvec3 b = normalize(cross(n, t));\nreturn mat3(t, b, n);\n}"]))))}},function(e,t,r){"use strict";r.d(t,"a",(function(){return b}));r(6),r(7);var n=r(2),i=r(5),a=r(3),o=r(182),s=r(26),c=r(31),l=r(4),u=r(43),d=r(85),h=r(150),f=r(354),p=r(136),b=function(){function e(t,r){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Object(o.b)(),l=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,d=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,h=arguments.length>7&&void 0!==arguments[7]&&arguments[7];Object(n.a)(this,e),this.data=t,this.material=r,this.layerUid=i,this.graphicUid=a,this.id=s,this.boundingInfo=l,this.calculateShaderTransformation=d,this.castShadow=h,this.boundingSphere=Object(u.e)(),this.instanceParameters={highlights:null,occludees:null,visible:!0},this._transformation=Object(c.d)(),this._shaderTransformationDirty=!0}return Object(i.a)(e,[{key:"transformation",get:function(){return this._transformation}},{key:"updateTransformation",value:function(e){e(this._transformation),this._shaderTransformationDirty=!0,this.computeBoundingSphere(this._transformation,this.boundingSphere)}},{key:"shaderTransformationChanged",value:function(){this._shaderTransformationDirty=!0}},{key:"computeBoundingSphere",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Object(d.i)(e);Object(a.i)(this.boundingInfo)||(Object(l.s)(t,this.boundingInfo.getCenter(),e),t[3]=this.boundingInfo.getBSRadius()*r)}},{key:"hasShaderTransformation",get:function(){return Object(a.j)(this.calculateShaderTransformation)}},{key:"primitiveType",get:function(){return this.data.primitiveType}},{key:"getShaderTransformation",value:function(){return Object(a.i)(this.calculateShaderTransformation)?Object(a.t)(this.transformation,c.a):(this._shaderTransformationDirty&&(this._shaderTransformation||(this._shaderTransformation=Object(c.d)()),Object(s.d)(this._shaderTransformation,this.calculateShaderTransformation(Object(a.t)(this.transformation,c.a))),this._shaderTransformationDirty=!1),this._shaderTransformation)}},{key:"computeAttachmentOrigin",value:function(e){if(this.material.computeAttachmentOrigin)return!!this.material.computeAttachmentOrigin(this,e)&&(Object(a.j)(this._transformation)&&Object(l.s)(e,e,this._transformation),!0);var t=this.indices.get("position"),r=this.vertexAttributes.get("position");return!!Object(h.c)(r,t,e)&&(Object(a.j)(this._transformation)&&Object(l.s)(e,e,this._transformation),!0)}},{key:"indices",get:function(){return this.data.indices}},{key:"vertexAttributes",get:function(){return this.data.vertexAttributes}},{key:"addHighlight",value:function(){var e=new f.a(0),t=this.instanceParameters;return t.highlights=Object(p.b)(t.highlights,e),e}},{key:"removeHighlight",value:function(e){var t=this.instanceParameters;t.highlights=Object(p.g)(t.highlights,e)}}]),e}()},function(e,t,r){"use strict";var n,i=r(2),a=r(5),o=r(6),s=r(7),c=r(0),l=r(25),u=r(1),d=(r(18),r(17),r(15),r(10)),h=r(44),f=r(289),p=r(181),b=n=function(e){Object(o.a)(r,e);var t=Object(s.a)(r);function r(e){var n;return Object(i.a)(this,r),(n=t.call(this,e)).description=null,n.fieldInfos=null,n.title=null,n.type="fields",n}return Object(a.a)(r,[{key:"writeFieldInfos",value:function(e,t){t.fieldInfos=e&&e.map((function(e){return e.toJSON()}))}},{key:"clone",value:function(){return new n({description:this.description,fieldInfos:Array.isArray(this.fieldInfos)?Object(l.a)(this.fieldInfos):null,title:this.title})}}]),r}(p.a);Object(c.a)([Object(u.b)({json:{write:!0,origins:{"web-scene":{write:!1,read:!1}}}})],b.prototype,"description",void 0),Object(c.a)([Object(u.b)({type:[f.a]})],b.prototype,"fieldInfos",void 0),Object(c.a)([Object(h.a)("fieldInfos")],b.prototype,"writeFieldInfos",null),Object(c.a)([Object(u.b)({json:{write:!0,origins:{"web-scene":{write:!1,read:!1}}}})],b.prototype,"title",void 0),Object(c.a)([Object(u.b)({type:["fields"],readOnly:!0,json:{read:!1,write:!0}})],b.prototype,"type",void 0);var v=b=n=Object(c.a)([Object(d.a)("esri.popup.content.FieldsContent")],b);t.a=v},function(e,t,r){"use strict";var n,i=r(2),a=r(5),o=r(6),s=r(7),c=r(0),l=r(49),u=r(3),d=r(28),h=r(1),f=(r(17),r(18),r(15),r(52)),p=r(10),b=r(161),v=r(296),m=r(131),y=r(198),g=n=function(e){Object(o.a)(r,e);var t=Object(s.a)(r);function r(e){var n;return Object(i.a)(this,r),(n=t.call(this,e)).material=null,n.type="line",n.join="miter",n.cap="butt",n.size=Object(d.h)(1),n.stipplePattern=null,n.stippleOffColor=null,n}return Object(a.a)(r,[{key:"clone",value:function(){return new n({enabled:this.enabled,material:Object(u.j)(this.material)?this.material.clone():null,size:this.size,join:this.join,cap:this.cap,stipplePattern:this.stipplePattern?this.stipplePattern.slice():null,stippleOffColor:this.stippleOffColor?this.stippleOffColor.clone():null})}}],[{key:"fromSimpleLineSymbol",value:function(e){return new n({size:e.width||1,cap:e.cap||"butt",join:e.join||"miter",material:{color:(e.color||v.c).clone()}})}}]),r}(b.a);Object(c.a)([Object(h.b)({type:y.a,json:{write:!0}})],g.prototype,"material",void 0),Object(c.a)([Object(f.a)({Line:"line"},{readOnly:!0})],g.prototype,"type",void 0),Object(c.a)([Object(h.b)({type:["miter","bevel","round"],json:{write:!0,default:"miter"}})],g.prototype,"join",void 0),Object(c.a)([Object(h.b)({type:["butt","square","round"],json:{write:!0,default:"butt"}})],g.prototype,"cap",void 0),Object(c.a)([Object(h.b)(m.b)],g.prototype,"size",void 0),Object(c.a)([Object(h.b)(m.c)],g.prototype,"stipplePattern",void 0),Object(c.a)([Object(h.b)({type:l.a})],g.prototype,"stippleOffColor",void 0);var O=g=n=Object(c.a)([Object(p.a)("esri.symbols.LineSymbol3DLayer")],g);t.a=O},function(e,t,r){"use strict";var n,i=r(2),a=r(5),o=r(6),s=r(7),c=r(0),l=(r(126),r(27)),u=r(25),d=r(1),h=r(18),f=(r(17),r(15),r(10)),p=r(44),b=r(305),v=r(55),m=n=function(e){Object(o.a)(r,e);var t=Object(s.a)(r);function r(e){var n;return Object(i.a)(this,r),(n=t.call(this,e)).dynamicDataSource=void 0,n.gdbVersion=null,n.geometryPrecision=void 0,n.historicMoment=null,n.maxAllowableOffset=void 0,n.objectIds=null,n.orderByFields=null,n.outFields=null,n.outSpatialReference=null,n.relationshipId=void 0,n.start=void 0,n.num=void 0,n.returnGeometry=!1,n.returnM=void 0,n.returnZ=void 0,n.where=null,n}return Object(a.a)(r,[{key:"_writeHistoricMoment",value:function(e,t){t.historicMoment=e&&e.getTime()}},{key:"writeStart",value:function(e,t){t.resultOffset=this.start,t.resultRecordCount=this.num||10,t.where="1=1"}},{key:"clone",value:function(){return new n(Object(u.a)({dynamicDataSource:this.dynamicDataSource,gdbVersion:this.gdbVersion,geometryPrecision:this.geometryPrecision,historicMoment:this.historicMoment&&new Date(this.historicMoment.getTime()),maxAllowableOffset:this.maxAllowableOffset,objectIds:this.objectIds,orderByFields:this.orderByFields,outFields:this.outFields,outSpatialReference:this.outSpatialReference,relationshipId:this.relationshipId,start:this.start,num:this.num,returnGeometry:this.returnGeometry,where:this.where,returnZ:this.returnZ,returnM:this.returnM}))}}]),r}(l.a);Object(c.a)([Object(d.b)({type:b.a,json:{write:!0}})],m.prototype,"dynamicDataSource",void 0),Object(c.a)([Object(d.b)({type:String,json:{write:!0}})],m.prototype,"gdbVersion",void 0),Object(c.a)([Object(d.b)({type:Number,json:{write:!0}})],m.prototype,"geometryPrecision",void 0),Object(c.a)([Object(d.b)({type:Date})],m.prototype,"historicMoment",void 0),Object(c.a)([Object(p.a)("historicMoment")],m.prototype,"_writeHistoricMoment",null),Object(c.a)([Object(d.b)({type:Number,json:{write:!0}})],m.prototype,"maxAllowableOffset",void 0),Object(c.a)([Object(d.b)({type:[Number],json:{write:!0}})],m.prototype,"objectIds",void 0),Object(c.a)([Object(d.b)({type:[String],json:{write:!0}})],m.prototype,"orderByFields",void 0),Object(c.a)([Object(d.b)({type:[String],json:{write:!0}})],m.prototype,"outFields",void 0),Object(c.a)([Object(d.b)({type:v.a,json:{read:{source:"outSR"},write:{target:"outSR"}}})],m.prototype,"outSpatialReference",void 0),Object(c.a)([Object(d.b)({json:{write:!0}})],m.prototype,"relationshipId",void 0),Object(c.a)([Object(d.b)({type:Number,json:{read:{source:"resultOffset"}}})],m.prototype,"start",void 0),Object(c.a)([Object(p.a)("start"),Object(p.a)("num")],m.prototype,"writeStart",null),Object(c.a)([Object(d.b)({type:Number,json:{read:{source:"resultRecordCount"}}})],m.prototype,"num",void 0),Object(c.a)([Object(d.b)({json:{write:!0}})],m.prototype,"returnGeometry",void 0),Object(c.a)([Object(d.b)({type:Boolean,json:{write:{overridePolicy:function(e){return{enabled:e}}}}})],m.prototype,"returnM",void 0),Object(c.a)([Object(d.b)({type:Boolean,json:{write:{overridePolicy:function(e){return{enabled:e}}}}})],m.prototype,"returnZ",void 0),Object(c.a)([Object(d.b)({type:String,json:{read:{source:"definitionExpression"},write:{target:"definitionExpression"}}})],m.prototype,"where",void 0),(m=n=Object(c.a)([Object(f.a)("esri.rest.support.RelationshipQuery")],m)).from=Object(h.m)(m);var y=m;t.a=y},function(e,t,r){"use strict";r.d(t,"a",(function(){return se})),r.d(t,"b",(function(){return te})),r.d(t,"c",(function(){return ce}));var n=r(8),i=r.n(n),a=r(16),o=r(33),s=r(13),c=r(2),l=r(5),u=r(6),d=r(7),h=r(0),f=r(30),p=r(57),b=r(15),v=r(121),m=r(3),y=r(74),g=r(458),O=r(35),j=r(1),_=(r(17),r(18),r(10)),w=r(26),x=r(38),k=r(9),S=r(84),T=r(439),C=r(244),M=(r(81),r(107)),P=(r(122),r(159),r(239),r(60)),A=(r(104),function(){function e(t,r){Object(c.a)(this,e),this.size=Object(C.a)(),this._fbo=null,this._fbo=new M.a(t,{colorTarget:0,depthStencilTarget:0},{target:3553,pixelFormat:6408,dataType:5121,wrapMode:33071,samplingMode:9987,hasMipmap:r,maxAnisotropy:8,width:0,height:0})}return Object(l.a)(e,[{key:"dispose",value:function(){this._fbo=Object(m.f)(this._fbo)}},{key:"getTexture",value:function(){return this._fbo?this._fbo.colorTexture:null}},{key:"isValid",value:function(){return null!==this._fbo}},{key:"resize",value:function(e,t){this.size[0]=e,this.size[1]=t,this._fbo.resize(this.size[0],this.size[1])}},{key:"bind",value:function(e){e.bindFramebuffer(this._fbo)}},{key:"generateMipMap",value:function(){this._fbo.colorTexture.descriptor.hasMipmap&&this._fbo.colorTexture.generateMipmap()}},{key:"disposeRenderTargetMemory",value:function(){var e;null==(e=this._fbo)||e.resize(0,0)}},{key:"gpuMemoryUsage",get:function(){var e,t;return null!=(e=null==(t=this._fbo)?void 0:t.gpuMemoryUsage)?e:0}}]),e}()),E=function(){function e(t){Object(c.a)(this,e),this.renderTargets=null;var r=function(e,r){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return{type:r,fbo:new A(t,n),renderPass:e,valid:!1,lastUsed:1/0}};this.renderTargets=[r(0,0),r(0,1),r(5,2,!1),r(3,3),r(0,4)]}return Object(l.a)(e,[{key:"getTarget",value:function(e){return this.renderTargets[e].fbo}},{key:"dispose",value:function(){var e,t=Object(s.a)(this.renderTargets);try{for(t.s();!(e=t.n()).done;){e.value.fbo.dispose()}}catch(r){t.e(r)}finally{t.f()}}},{key:"disposeRenderTargetMemory",value:function(){var e,t=Object(s.a)(this.renderTargets);try{for(t.s();!(e=t.n()).done;){e.value.fbo.disposeRenderTargetMemory()}}catch(r){t.e(r)}finally{t.f()}}},{key:"validateUsageForTarget",value:function(e,t,r){if(e)t.lastUsed=r;else if(r-t.lastUsed>R)t.fbo.disposeRenderTargetMemory(),t.lastUsed=1/0;else if(t.lastUsed<1/0)return!0;return!1}},{key:"gpuMemoryUsage",get:function(){return this.renderTargets.reduce((function(e,t){return e+t.fbo.gpuMemoryUsage}),0)}}]),e}(),R=1e3,I=r(523),D=r(119),F=r(86),L=r(544),z=r(124),V=r(490),N=r(243),U=r(526),B=r(398),G=r(116),q=r(527),H=r(539),W=function(e){Object(u.a)(r,e);var t=Object(d.a)(r);function r(){var e;return Object(c.a)(this,r),(e=t.apply(this,arguments))._pending=new Q,e._changes=new B.a,e._materialRenderers=new Map,e._sortedMaterialRenderers=new y.a,e._hasHighlights=!1,e._hasWater=!1,e}return Object(l.a)(r,[{key:"dispose",value:function(){this._changes.prune(),this._materialRenderers.forEach((function(e){return e.dispose()})),this._materialRenderers.clear(),this._sortedMaterialRenderers.clear()}},{key:"updating",get:function(){return!this._pending.empty||this._changes.updates.length>0}},{key:"hasHighlights",get:function(){return this._hasHighlights}},{key:"hasWater",get:function(){return this._hasWater}},{key:"rendersOccluded",get:function(){return Object(v.b)(this._materialRenderers,(function(e){return e.rendersOccluded}))}},{key:"stopAnimationsAtTime",value:function(e){this._sortedMaterialRenderers.forAll((function(t){return Object(m.c)(t.material.animation,(function(t){return t.stopAtTime(e)}))}))}},{key:"isEmpty",get:function(){return!this.updating&&0===this._materialRenderers.size}},{key:"commitChanges",value:function(){var e=this;if(!this.updating)return!1;this._processAddsRemoves();var t=Object(q.a)(this._changes),r=!1,n=!1,i=!1;return t.forEach((function(t,a){var o=e._materialRenderers.get(a);if(!o&&t.adds.length>0&&(o=new H.a(e.rctx,e.materialRepository,a),e._materialRenderers.set(a,o),r=!0,n=!0,i=!0),o){var s=n||o.hasHighlights,c=i||o.hasWater;o.modify(t),n=n||s!==o.hasHighlights,i=i||c!==o.hasWater,o.isEmpty&&(e._materialRenderers.delete(a),o.dispose(),r=!0)}})),this._changes.clear(),r&&this.updateSortedMaterialRenderers(),n&&(this._hasHighlights=Object(v.b)(this._materialRenderers,(function(e){return e.hasHighlights}))),i&&(this._hasWater=Object(v.b)(this._materialRenderers,(function(e){return e.hasWater}))),this.notifyChange("updating"),!0}},{key:"add",value:function(e){if(0!==e.length){var t,r=this._pending.empty,n=Object(s.a)(e);try{for(n.s();!(t=n.n()).done;){var i=t.value;this._pending.adds.add(i)}}catch(a){n.e(a)}finally{n.f()}r&&this.notifyChange("updating")}}},{key:"remove",value:function(e){var t,r=this._pending.empty,n=Object(s.a)(e);try{for(n.s();!(t=n.n()).done;){var i=t.value;this._pending.adds.has(i)?(this._pending.removed.add(i),this._pending.adds.delete(i)):this._pending.removed.has(i)||this._pending.removes.add(i)}}catch(a){n.e(a)}finally{n.f()}r&&!this._pending.empty&&this.notifyChange("updating")}},{key:"modify",value:function(e,t){var r,n=0===this._changes.updates.length,i=Object(s.a)(e);try{for(i.s();!(r=i.n()).done;){var a=r.value,o=this._changes.updates.pushNew();o.renderGeometry=a,o.updateType=t}}catch(c){i.e(c)}finally{i.f()}n&&this._changes.updates.length>0&&this.notifyChange("updating")}},{key:"updateLogic",value:function(e){var t=!1;return this._sortedMaterialRenderers.forAll((function(r){var n=r.materialRenderer;n.updateLogic&&n.updateLogic(e)&&(t=!0)})),t}},{key:"render",value:function(e,t){for(var r=0;r<this._sortedMaterialRenderers.length;r++){var n=this._sortedMaterialRenderers.data[r];Object(G.c)(n.material,e)&&n.materialRenderer.render(null,e.pass,t,null)}}},{key:"updateSortedMaterialRenderers",value:function(){var e=this;this._sortedMaterialRenderers.clear();var t=0;this._materialRenderers.forEach((function(r,n){n.insertOrder=t++,e._sortedMaterialRenderers.push({material:n,materialRenderer:r})})),this._sortedMaterialRenderers.sort((function(e,t){var r=t.material.renderPriority-e.material.renderPriority;return 0!==r?r:e.material.insertOrder-t.material.insertOrder}))}},{key:"_processAddsRemoves",value:function(){this._changes.adds.clear(),this._changes.removes.clear(),this._changes.adds.pushArray(Array.from(this._pending.adds)),this._changes.removes.pushArray(Array.from(this._pending.removes));for(var e=0;e<this._changes.updates.length;){var t=this._changes.updates.data[e];this._pending.has(t.renderGeometry)?this._changes.updates.removeUnorderedIndex(e):e++}this._pending.clear()}},{key:"test",get:function(){return{sortedMaterialRenderers:this._sortedMaterialRenderers}}}]),r}(f.a);Object(h.a)([Object(j.b)()],W.prototype,"rctx",void 0),Object(h.a)([Object(j.b)()],W.prototype,"materialRepository",void 0),Object(h.a)([Object(j.b)()],W.prototype,"updating",null),W=Object(h.a)([Object(_.a)("esri.views.3d.webgl-engine.lib.SortedRenderGeometryRenderer")],W);var Q=function(){function e(){Object(c.a)(this,e),this.adds=new Set,this.removes=new Set,this.removed=new Set}return Object(l.a)(e,[{key:"empty",get:function(){return 0===this.adds.size&&0===this.removes.size&&0===this.removed.size}},{key:"has",value:function(e){return this.adds.has(e)||this.removes.has(e)||this.removed.has(e)}},{key:"clear",value:function(){this.adds.clear(),this.removes.clear(),this.removed.clear()}}]),e}(),Z=r(408),X=r(231),Y=r(540),$=r(531),J=r(97),K=r(92),ee=b.a.getLogger("esri.views.3d.webgl-engine.lib.OverlayRenderer"),te=function(e){Object(u.a)(r,e);var t=Object(d.a)(r);function r(e){var n;return Object(c.a)(this,r),(n=t.call(this,e))._overlays=null,n._overlayRenderTarget=null,n._hasHighlights=!1,n._rendersOccluded=!1,n._hasWater=!1,n._lighting=new Y.a,n._handles=new p.a,n._layerRenderers=new Map,n._sortedLayerRenderersDirty=!1,n._sortedLayerRenderers=new y.a,n._geometries=new Map,n.globalUnitScale=1,n.longitudeCyclical=null,n}return Object(l.a)(r,[{key:"initialize",value:function(){var e=this,t=this.view._stage.renderView;this._rctx=t.renderingContext,this._renderContext=new U.a(this._rctx);var r=t.waterTextureRepository;this._stippleTextureRepository=new $.a(t.renderingContext),this._shaderTechniqueRepository=new I.a({rctx:this._rctx,viewingMode:2,stippleTextureRepository:this._stippleTextureRepository,waterTextureRepository:r}),this._handles.add([Object(O.a)(r,"loadingState",(function(){return e.emitContentChanged()})),Object(O.a)(this,"spatialReference",(function(t){return e._localOrigins=new V.a(t)}))]),this._materialRepository=new L.a(t.textureRepository,this._shaderTechniqueRepository),this._materialRepository.onMaterialChanged=function(t){(t.renderOccluded&ce)>0!==e._rendersOccluded&&e.updateRendersOccluded(),e.emitContentChanged(),e.notifyChange("updating")},this._lighting.groundLightingFactor=1,this._lighting.globalFactor=0,this._lighting.set([new X.a(Object(k.g)(1,1,1))]),this._bindParameters={slot:null,highlightDepthTexture:Object(z.b)(this._rctx),camera:ie,inverseViewport:Object(x.b)(),origin:null,screenToWorldRatio:null,screenToWorldRatioGlobalWM:null,shadowMappingEnabled:!1,slicePlane:null,ssaoEnabled:!1,hasOccludees:!1,linearDepthTexture:null,lastFrameColorTexture:null,reprojectionMat:null,ssrEnabled:!1,lighting:this._lighting,transparencyPassType:3,terrainLinearDepthTexture:null,geometryLinearDepthTexture:null,multipassTerrainEnabled:!1,cullAboveGround:!1,multipassGeometryEnabled:!1,highlightColorTexture:null},this._handles.add(this.view.resourceController.scheduler.registerTask(J.b.STAGE,this))}},{key:"dispose",value:function(){this._handles.destroy(),this._layerRenderers.forEach((function(e){return e.dispose()})),this._layerRenderers.clear(),this._debugTextureTechnique=Object(m.q)(this._debugTextureTechnique),this._debugPatternTexture=Object(m.f)(this._debugPatternTexture),this._bindParameters.highlightDepthTexture=Object(m.f)(this._bindParameters.highlightDepthTexture),this._shaderTechniqueRepository=Object(m.f)(this._shaderTechniqueRepository),this._temporaryFBO=Object(m.f)(this._temporaryFBO),this._quadVAO=Object(m.f)(this._quadVAO),this._overlayRenderTarget=Object(m.f)(this._overlayRenderTarget)}},{key:"updating",get:function(){return this._sortedLayerRenderersDirty||Object(v.b)(this._layerRenderers,(function(e){return e.updating}))}},{key:"hasOverlays",get:function(){return Object(m.j)(this._overlays)&&Object(m.j)(this._overlayRenderTarget)}},{key:"gpuMemoryUsage",get:function(){return Object(m.j)(this._overlayRenderTarget)?this._overlayRenderTarget.gpuMemoryUsage:0}},{key:"collectUnusedRenderTargetMemory",value:function(e){var t=!1;if(Object(m.j)(this._overlayRenderTarget)){var r,n=Object(s.a)(this._overlayRenderTarget.renderTargets);try{for(n.s();!(r=n.n()).done;){var i=r.value,a=this.overlays[0].validTargets[i.type]||!this.overlays[1].validTargets[i.type];t=this._overlayRenderTarget.validateUsageForTarget(a,i,e)||t}}catch(o){n.e(o)}finally{n.f()}}return t}},{key:"overlays",get:function(){return Object(m.t)(this._overlays,[])}},{key:"ensureDrapeTargets",value:function(e){Object(m.j)(this._overlays)&&this._overlays.forEach((function(t){t.hasTargetWithoutRasterImage=Object(g.a)(e,(function(e){return 1===e.drapeTargetType}))}))}},{key:"ensureDrapeSources",value:function(e){Object(m.j)(this._overlays)&&this._overlays.forEach((function(t){t.hasDrapedFeatureSource=Object(v.b)(e,(function(e,t){return 1===t.drapeSourceType})),t.hasDrapedRasterSource=Object(v.b)(e,(function(e,t){return 0===t.drapeSourceType}))}))}},{key:"ensureOverlays",value:function(e,t){Object(m.i)(this._overlays)&&(this._overlayRenderTarget=new E(this._rctx),this._overlays=[new T.a(0,this._overlayRenderTarget),new T.a(1,this._overlayRenderTarget)]),this.ensureDrapeTargets(e),this.ensureDrapeSources(t)}},{key:"disposeOverlays",value:function(){Object(m.j)(this._overlayRenderTarget)&&this._overlayRenderTarget.disposeRenderTargetMemory()}},{key:"running",get:function(){return this.updating}},{key:"runTask",value:function(e){var t,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){return!0},n=!1,i=Object(s.a)(this._layerRenderers);try{for(i.s();!(t=i.n()).done;){var a=Object(o.a)(t.value,2),c=a[0],l=a[1];if(e.done)break;r(c)&&(l.commitChanges()&&(n=!0,e.madeProgress()),l.isEmpty&&(this._sortedLayerRenderersDirty=!0,this._layerRenderers.delete(c),this._handles.remove(c)))}}catch(u){i.e(u)}finally{i.f()}this._sortedLayerRenderersDirty&&(this.updateSortedLayerRenderers(),n=!0),n&&(Object(m.j)(this._overlays)&&0===this._layerRenderers.size&&this.disposeOverlays(),this.notifyChange("updating"),this.emitContentChanged(),this.updateHasHighlights(),this.updateRendersOccluded(),this.updateHasWater())}},{key:"processSyncLayers",value:function(){this.runTask(J.d,(function(e){return 1===e.updatePolicy}))}},{key:"addGeometries",value:function(e,t,r){var n,i=Object(s.a)(e);try{for(i.s();!(n=i.n()).done;){var a=n.value;Object(m.i)(a.origin)&&(a.origin=this._localOrigins.getOrigin(a.boundingSphere)),this._geometries.set(a.id,a)}}catch(o){i.e(o)}finally{i.f()}this.ensureLayerRenderer(t).add(e),2===r&&this.notifyGraphicGeometryChanged(e,t)}},{key:"removeGeometries",value:function(e,t,r){var n,i=Object(s.a)(e);try{for(i.s();!(n=i.n()).done;){var a=n.value;this._geometries.delete(Object(m.s)(a.id))}}catch(c){i.e(c)}finally{i.f()}var o=this._layerRenderers.get(t);o&&(o.remove(e),2===r&&this.notifyGraphicGeometryChanged(e,t))}},{key:"updateGeometries",value:function(e,t,r){var n=this._layerRenderers.get(t);if(n)switch(n.modify(e,r),r){case 4:case 2:return this.notifyGraphicGeometryChanged(e,t);case 1:return this.notifyGraphicVisibilityChanged(e,t)}else ee.warn("Attempted to update geometry for nonexistent layer")}},{key:"notifyGraphicGeometryChanged",value:function(e,t){if(!Object(m.i)(t.notifyGraphicGeometryChanged)){var r,n,i=Object(s.a)(e);try{for(i.s();!(n=i.n()).done;){var a=n.value.graphicUid;Object(m.j)(a)&&a!==r&&(t.notifyGraphicGeometryChanged(a),r=a)}}catch(o){i.e(o)}finally{i.f()}}}},{key:"notifyGraphicVisibilityChanged",value:function(e,t){if(!Object(m.i)(t.notifyGraphicVisibilityChanged)){var r,n,i=Object(s.a)(e);try{for(i.s();!(n=i.n()).done;){var a=n.value.graphicUid;Object(m.j)(a)&&a!==r&&(t.notifyGraphicVisibilityChanged(a),r=a)}}catch(o){i.e(o)}finally{i.f()}}}},{key:"updateHighlights",value:function(e,t){var r=this._layerRenderers.get(t);r?r.modify(e,8):ee.warn("Attempted to update highlights for nonexistent layer")}},{key:"isEmpty",value:function(){return 0===this._geometries.size&&!S.a.OVERLAY_DRAW_DEBUG_TEXTURE}},{key:"hasHighlights",get:function(){return this._hasHighlights}},{key:"hasWater",get:function(){return this._hasWater}},{key:"rendersOccluded",get:function(){return this._rendersOccluded}},{key:"updateLogic",value:function(e){var t=!1;return this._layerRenderers.forEach((function(r){r.updateLogic(e)&&(t=!0)})),t}},{key:"updateLayerOrder",value:function(){this._sortedLayerRenderersDirty=!0}},{key:"drawTarget",value:function(e,t,r){var n=this,i=e.canvasGeometries;if(0===i.numViews)return!1;var a=e.pixelRatio*r;this._screenToWorldRatio=a*Math.abs(i.extents[0][2]-i.extents[0][0])/Math.abs(e.viewport[2]-e.viewport[0]);var o=t.renderPass;if(this.isEmpty()||5===o&&!this.hasHighlights||3===o&&!this.hasWater)return!1;if(!e.hasSomeSizedView())return!1;var s=t.fbo,c=2*e.resolution,l=e.resolution,u=1===t.type?2:4===t.type?1:0;if(!s.isValid())return!1;s.resize(c,l);var d=this._rctx;if(ie.pixelRatio=a||1,this._renderContext.pass=o,this._bindParameters.screenToWorldRatio=this._screenToWorldRatio,this._bindParameters.screenToWorldRatioGlobalWM=this._screenToWorldRatio*this.globalUnitScale,e.applyViewport(this._rctx),s.bind(d),0===e.index&&(d.setClearColor(0,0,0,0),d.clearSafe(16384)),1===u&&(this._renderContext.renderOccludedMask=ce),S.a.OVERLAY_DRAW_DEBUG_TEXTURE&&1!==u)for(var h=0;h<i.numViews;h++)this.setViewParameters(i.extents[h],e,ie),this.drawDebugTexture(e.resolution,ne[e.index%ne.length]);return this._layerRenderers.size>0&&this._sortedLayerRenderers.forAll((function(t){var r=t.layerView,a=t.renderer;if(2!==u||!Object(m.j)(r)||0!==r.drapeSourceType){var h=Object(m.j)(r)&&Object(m.j)(r.fullOpacity)&&r.fullOpacity<1&&0===o;h&&(n.bindTemporaryFramebuffer(n._rctx,c,l),d.clearSafe(16384));for(var f=0;f<i.numViews;f++)n.setViewParameters(i.extents[f],e,ie),a.render(n._renderContext,n._bindParameters);h&&Object(m.j)(n._temporaryFBO)&&(s.bind(d),n.view._stage.renderView.compositingHelper.composite(n._temporaryFBO.getTexture(),2,Object(m.s)(Object(m.s)(r).fullOpacity),3,e.index))}})),d.bindFramebuffer(null),s.generateMipMap(),this._renderContext.resetRenderOccludedMask(),!0}},{key:"bindTemporaryFramebuffer",value:function(e,t,r){Object(m.i)(this._temporaryFBO)&&(this._temporaryFBO=new A(e,!1)),this._temporaryFBO.resize(t,r),this._temporaryFBO.bind(e)}},{key:"reloadShaders",value:function(){var e=Object(a.a)(i.a.mark((function e(){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._shaderTechniqueRepository.hotReload();case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"intersect",value:function(e,t,r){var n=this,i=0;this._geometries.forEach((function(a){if(!r||r(a)){n.intersectRenderGeometry(a,t,0,e,i);var o=n.longitudeCyclical;o&&(a.boundingSphere[0]-a.boundingSphere[3]<o.min&&n.intersectRenderGeometry(a,t,o.range,e,i),a.boundingSphere[0]+a.boundingSphere[3]>o.max&&n.intersectRenderGeometry(a,t,-o.range,e,i)),i++}}))}},{key:"intersectRenderGeometry",value:function(e,t,r,n,i){var a=this;if(e.instanceParameters.visible){var o=0;Object(m.j)(e.transformation)&&(r+=e.transformation[12],o=e.transformation[13]),ae[0]=t[0]-r,ae[1]=t[1]-o,ae[2]=1,oe[0]=t[0]-r,oe[1]=t[1]-o,oe[2]=0,e.screenToWorldRatio=this._screenToWorldRatio,e.material.intersect(e,null,e.getShaderTransformation(),n,ae,oe,(function(t,r,o){a.addIntersectionResult(o,e.material.renderPriority,i,n,e.layerUid,e.graphicUid)}),e.calculateShaderTransformation,!0)}}},{key:"addIntersectionResult",value:function(e,t,r,n,i,a){var o={type:"external",metadata:{layerUid:i,graphicUid:a}},s=function(i){i.set(o,null,n.results.ground.dist,n.results.ground.normal,n.results.ground.transformation,t,null,null,e,r),i.intersector="OverlayRenderer"};if((null==n.results.min.drapedLayerOrder||t>=n.results.min.drapedLayerOrder)&&(null==n.results.min.dist||n.results.ground.dist<=n.results.min.dist)&&s(n.results.min),0!==n.options.store&&(null==n.results.max.drapedLayerOrder||t<n.results.max.drapedLayerOrder)&&(null==n.results.max.dist||n.results.ground.dist>n.results.max.dist)&&s(n.results.max),2===n.options.store){var c=new N.a(n.ray);s(c),n.results.all.push(c)}}},{key:"stopAnimationsAtTime",value:function(e){this._sortedLayerRenderers.forAll((function(t){return t.renderer.stopAnimationsAtTime(e)}))}},{key:"ensureLayerRenderer",value:function(e){var t=this,r=this._layerRenderers.get(e);return r||(r=new W({rctx:this._rctx,materialRepository:this._materialRepository}),this._layerRenderers.set(e,r),this._sortedLayerRenderersDirty=!0,"fullOpacity"in e&&this._handles.add(e.watch("fullOpacity",(function(){return t.emitContentChanged()})),e),this._handles.add(Object(O.a)(r,"updating",(function(){return t.notifyChange("updating")})),e)),r}},{key:"updateSortedLayerRenderers",value:function(){var e=this;if(this._sortedLayerRenderersDirty&&(this._sortedLayerRenderersDirty=!1,this._sortedLayerRenderers.clear(),0!==this._layerRenderers.size)){var t=new Set(this._layerRenderers.values());this.view.allLayerViews.forEach((function(r){var n=r,i=e._layerRenderers.get(n);i&&(e._sortedLayerRenderers.push(new re(n,i)),t.delete(i))})),t.forEach((function(t){return e._sortedLayerRenderers.push(new re(null,t))}))}}},{key:"setViewParameters",value:function(e,t,r){r.viewport=t.viewport,Object(w.o)(r.projectionMatrix,0,e[2]-e[0],0,e[3]-e[1],r.near,r.far),Object(w.i)(r.viewMatrix),Object(w.t)(r.viewMatrix,r.viewMatrix,[-e[0],-e[1],0]),this._renderContext.camera=r,this._bindParameters.camera=r,this._bindParameters.inverseViewport[0]=1/r.fullViewport[2],this._bindParameters.inverseViewport[1]=1/r.fullViewport[3]}},{key:"emitContentChanged",value:function(){this.onContentChanged&&this.onContentChanged()}},{key:"updateHasWater",value:function(){var e=Object(v.b)(this._layerRenderers,(function(e){return e.hasWater}));e!==this._hasWater&&(this._hasWater=e,this.onHasWaterChanged&&this.onHasWaterChanged(e))}},{key:"updateHasHighlights",value:function(){var e=Object(v.b)(this._layerRenderers,(function(e){return e.hasHighlights}));e!==this._hasHighlights&&(this._hasHighlights=e,this.onHasHighlightsChanged&&this.onHasHighlightsChanged(this._hasHighlights))}},{key:"updateRendersOccluded",value:function(){var e=Object(v.b)(this._layerRenderers,(function(e){return e.rendersOccluded}));e!==this._rendersOccluded&&(this._rendersOccluded=e,this.onRendersOccludedChanged&&this.onRendersOccludedChanged(this.rendersOccluded))}},{key:"drawDebugTexture",value:function(e,t){var r=this._rctx;this.ensureDebugPatternResources(e,e);var n=this._debugTextureTechnique.program;r.useProgram(n),r.setPipelineState(this._debugTextureTechnique.pipeline),n.setUniform4f("color",t[0],t[1],t[2],1),n.bindTexture(this._debugPatternTexture,"tex"),r.bindVAO(this._quadVAO),r.drawArrays(5,0,Object(K.f)(this._quadVAO,"geometry"))}},{key:"ensureDebugPatternResources",value:function(e,t){if(!this._debugPatternTexture){for(var r=new Uint8Array(e*t*4),n=0,i=0;i<t;i++)for(var a=0;a<e;a++){var o=Math.floor(a/10),s=Math.floor(i/10);o<2||s<2||10*o>e-20||10*s>t-20?(r[n++]=255,r[n++]=255,r[n++]=255,r[n++]=255):(r[n++]=255,r[n++]=255,r[n++]=255,r[n++]=1&o&&1&s?1&a^1&i?0:255:1&o^1&s?0:128)}this._debugPatternTexture=new P.a(this._rctx,{target:3553,pixelFormat:6408,dataType:5121,samplingMode:9728,width:e,height:t},r);var c=new Z.b;c.hasAlpha=!0,this._debugTextureTechnique=this._shaderTechniqueRepository.acquire(Z.a,c),this._quadVAO=Object(z.d)(this._rctx)}}},{key:"test",get:function(){return{layerRenderers:this._layerRenderers}}}]),r}(Object(D.b)(f.a));Object(h.a)([Object(D.c)()],te.prototype,"_shaderTechniqueRepository",void 0),Object(h.a)([Object(D.c)()],te.prototype,"_stippleTextureRepository",void 0),Object(h.a)([Object(j.b)({constructOnly:!0})],te.prototype,"view",void 0),Object(h.a)([Object(j.b)()],te.prototype,"globalUnitScale",void 0),Object(h.a)([Object(j.b)()],te.prototype,"spatialReference",void 0),Object(h.a)([Object(j.b)({type:Boolean,readOnly:!0})],te.prototype,"updating",null),te=Object(h.a)([Object(_.a)("esri.views.3d.terrain.OverlayRenderer")],te);var re=function e(t,r){Object(c.a)(this,e),this.layerView=t,this.renderer=r},ne=[[1,.5,.5],[.5,.5,1],[.5,1,.5]],ie=new F.a;ie.near=1,ie.far=1e4,ie.relativeElevation=null;var ae=Object(k.e)(),oe=Object(k.e)(),se=-2,ce=4},function(e,t,r){"use strict";r.d(t,"a",(function(){return O})),r.d(t,"b",(function(){return g})),r.d(t,"c",(function(){return z})),r.d(t,"d",(function(){return F})),r.d(t,"e",(function(){return y})),r.d(t,"f",(function(){return m})),r.d(t,"g",(function(){return v}));var n=r(8),i=r.n(n),a=r(13),o=r(16),s=r(49),c=r(98),l=r(128),u=r(17),d=r(3),h=(r(28),r(9)),f=(r(608),r(198)),p=/\/resource\/(.*?)\.svg$/,b=new s.a("white");function v(e){if(Object(d.i)(e)||!("symbolLayers"in e)||Object(d.i)(e.symbolLayers))return!1;switch(e.type){case"point-3d":return e.symbolLayers.some((function(e){return"object"===e.type}));case"line-3d":return e.symbolLayers.some((function(e){return"path"===e.type}));case"polygon-3d":return e.symbolLayers.some((function(e){return"object"===e.type||"extrude"===e.type}));default:return!1}}function m(e,t){var r=t.resource.href;return!Object(u.a)("esri-canvas-svg-support")&&e.styleOrigin&&p.test(r)?r.replace(p,"/resource/png/$1.png"):r}function y(e,t){if(!e)return null;var r=null;return Object(c.c)(e)?r=function(e){var t=e.symbolLayers;if(!t)return null;var r=null;return t.forEach((function(e){"object"===e.type&&null!=e.resource.href||(r="water"===e.type?Object(d.s)(e.color):Object(d.j)(e.material)?Object(d.s)(e.material.color):null)})),r?new s.a(r):null}(e):Object(c.b)(e)&&(r=e.color?new s.a(e.color):null),r?g(r,t):null}function g(e,t){if(null==t)return e;var r=e.toRgba();return r[3]=r[3]*t,new s.a(r)}function O(e,t,r){var n,i,a;e&&(t||null!=r)&&(t&&(t=new s.a(t)),Object(c.c)(e)?function(e,t,r){var n=e.symbolLayers;if(n){var i=function(e){var n=Object(d.j)(e)?e:null;return g(t=t||n||null!=r&&b,r)};n.forEach((function(e){if("object"!==e.type||null==e.resource.href||t)if("water"===e.type)e.color=i(e.color);else{var n=Object(d.j)(e.material)?e.material.color:null,a=i(n);Object(d.i)(e.material)?e.material=new f.a({color:a}):e.material.color=a,null!=r&&"outline"in e&&Object(d.j)(e.outline)&&Object(d.j)(e.outline.color)&&(e.outline.color=g(e.outline.color,r))}}))}}(e,t,r):Object(c.b)(e)&&(n=e,a=r,(i=(i=t)||n.color)&&(n.color=g(i,a)),null!=a&&"outline"in n&&n.outline&&n.outline.color&&(n.outline.color=g(n.outline.color,a))))}function j(e,t){return _.apply(this,arguments)}function _(){return(_=Object(o.a)(i.a.mark((function e(t,r){var n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.symbolLayers,e.t0=n,!e.t0){e.next=5;break}return e.next=5,Object(l.b)(n,function(){var e=Object(o.a)(i.a.mark((function e(t){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",w(t,r));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function w(e,t){return x.apply(this,arguments)}function x(){return(x=Object(o.a)(i.a.mark((function e(t,r){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.t0=t.type,e.next="extrude"===e.t0?3:"icon"===e.t0||"line"===e.t0||"text"===e.t0?5:"path"===e.t0?7:"object"===e.t0?9:11;break;case 3:return T(t,r),e.abrupt("break",11);case 5:return k(t,r),e.abrupt("break",11);case 7:return P(t,r),e.abrupt("break",11);case 9:return e.next=11,C(t,r);case 11:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function k(e,t){var r=S(t);Object(d.j)(r)&&(e.size=r)}function S(e){var t,r=Object(a.a)(e);try{for(r.s();!(t=r.n()).done;){var n=t.value;if("number"==typeof n)return n}}catch(i){r.e(i)}finally{r.f()}return null}function T(e,t){e.size="number"==typeof t[2]?t[2]:0}function C(e,t){return M.apply(this,arguments)}function M(){return(M=Object(o.a)(i.a.mark((function e(t,r){var n,a,o,s;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,E(t);case 2:n=e.sent,a=n.resourceSize,o=n.symbolSize,s=A(r,a,o),t.width=I(r[0],o[0],a[0],s),t.depth=I(r[1],o[1],a[1],s),t.height=I(r[2],o[2],a[2],s);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function P(e,t){var r=A(t,h.a,[e.width,void 0,e.height]);e.width=I(t[0],e.width,1,r),e.height=I(t[2],e.height,1,r)}function A(e,t,r){for(var n=0;n<3;n++){var i=e[n];switch(i){case"symbol-value":return null!=r[n]?r[n]/t[n]:1;case"proportional":break;default:if(i&&t[n])return i/t[n]}}return 1}function E(e){return R.apply(this,arguments)}function R(){return(R=Object(o.a)(i.a.mark((function e(t){var n,a,o,s,c,l,u,d,h;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.e(172).then(r.bind(null,705));case 2:return n=e.sent,e.next=5,n.computeObjectLayerResourceSize(t,10);case 5:a=e.sent,o=t.width,s=t.height,c=t.depth,l=[o,c,s],u=1,d=0;case 12:if(!(d<3)){e.next=19;break}if(null==l[d]){e.next=16;break}return u=l[d]/a[d],e.abrupt("break",19);case 16:d++,e.next=12;break;case 19:for(h=0;h<3;h++)null==l[h]&&(l[h]=a[h]*u);return e.abrupt("return",{resourceSize:a,symbolSize:l});case 21:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function I(e,t,r,n){switch(e){case"proportional":return r*n;case"symbol-value":return null!=t?t:r;default:return e}}function D(e,t){var r=S(t);if(!Object(d.i)(r))switch(e.type){case"simple-marker":e.size=r;break;case"picture-marker":var n=e.width/e.height;n>1?(e.width=r,e.height=r*n):(e.width=r*n,e.height=r);break;case"simple-line":e.width=r;break;case"text":e.font.size=r}}function F(e,t){return L.apply(this,arguments)}function L(){return(L=Object(o.a)(i.a.mark((function e(t,r){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t||!r){e.next=2;break}return e.abrupt("return",Object(c.c)(t)?j(t,r):void(Object(c.b)(t)&&D(t,r)));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function z(e,t,r){if(e&&null!=t)if(Object(c.c)(e)){var n=e.symbolLayers;n&&n.forEach((function(e){if(e&&"object"===e.type)switch(r){case"tilt":e.tilt=t;break;case"roll":e.roll=t;break;default:e.heading=t}}))}else Object(c.b)(e)&&("simple-marker"!==e.type&&"picture-marker"!==e.type&&"text"!==e.type||(e.angle=t))}},function(e,t,r){"use strict";r.d(t,"a",(function(){return n})),r.d(t,"b",(function(){return i}));var n=[{name:"position",count:2,type:5126,offset:0,stride:8,normalized:!1}],i=[{name:"position",count:2,type:5126,offset:0,stride:16,normalized:!1},{name:"uv0",count:2,type:5126,offset:8,stride:16,normalized:!1}]},function(e,t,r){"use strict";var n=r(2),i=r(5),a=function(){function e(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:29;Object(n.a)(this,e),this.name=t,this._counter=0,this._items=new Array(r)}return Object(i.a)(e,[{key:"record",value:function(e){this._items[++this._counter%this._items.length]=e}},{key:"median",get:function(){return this._items.slice().sort()[Math.floor(this._items.length/2)]}},{key:"average",get:function(){return this._items.reduce((function(e,t){return e+t}),0)/this._items.length}},{key:"last",get:function(){return this._items[this._counter%this._items.length]}}]),e}();t.a=a},function(e,t,r){"use strict";r.d(t,"a",(function(){return c})),r.d(t,"b",(function(){return s})),r.d(t,"c",(function(){return u})),r.d(t,"d",(function(){return d})),r.d(t,"e",(function(){return o})),r.d(t,"f",(function(){return l}));var n=r(14),i=(r(17),r(20));function a(e,t){var r=e||{},n=r.format,a=r.quality,o=r.rotation,s=r.disableDecorations,c=b(e,t.padding),l=function(e,t){var r={x:0,y:0,width:t.width,height:t.height};if(e&&e.area){null!=e.area.x&&(r.x=Math.floor(e.area.x)),null!=e.area.y&&(r.y=Math.floor(e.area.y));var n=null!=e.area.width?Math.floor(e.area.width):null,i=null!=e.area.height?Math.floor(e.area.height):null;if(r.width=t.width-r.x,r.height=t.height-r.y,null!=n&&null!=i)r.width=Math.min(r.width,n),r.height=Math.min(r.height,i);else if(null==n&&null!=i){var a=Math.min(r.width,n);r.height=a/r.width*r.height,r.width=a}else if(null!=n&&null==i){var o=Math.min(r.height,i);r.width=o/r.height*r.width,r.height=o}}return function(e,t){var r=Math.floor(Math.max(e.x,0)),n=Math.floor(Math.max(e.y,0)),i={x:r,y:n,width:Math.floor(Math.min(e.width,t.width-r)),height:Math.floor(Math.min(e.height,t.height-n))},a=i.width/i.height,o=e.width/e.height;if(o===a)return i;if(o>a){var s=Math.floor(i.width/o),c=i.height-s;return{x:i.x,y:Math.floor(i.y+c/2),width:i.width,height:s}}var l=Math.floor(i.height*o),u=i.width-l;return{x:Math.floor(i.x+u/2),y:i.y,width:l,height:i.height}}(function(e,t){if(!t||null==t.width||null==t.height)return e;var r=t.width/t.height,n=e.width/e.height;if(n===r)return e;if(n<r){var i=Math.floor(e.height*r);return e.x-=(i-e.width)/2,e.width=i,e}var a=Math.floor(e.width/r);return e.y-=(a-e.height)/2,e.height=a,e}(r,e),t)}(e,{width:t.width-c.left-c.right,height:t.height-c.top-c.bottom}),u=function(e,t){if(!e)return t;var r=e.width,n=e.height;if(null!=r&&null!=n)return{width:Math.floor(r),height:Math.floor(n)};if(null==r&&null==n)return t;var i=t.width/t.height;return null==n?{width:Math.floor(r),height:Math.floor(r/i)}:{width:Math.floor(n*i),height:Math.floor(n)}}(e,l),d=u.width,h=u.height,f=function(e){switch(e){case"png":case"jpg":case"jpeg":return e;case null:case void 0:default:return m}}(n),p=y[f];return{format:f,quality:Object(i.e)(null!=a?a:p,0,100),area:l,width:d,height:h,rotation:o,disableDecorations:!!s,ignoreBackground:!(!e||!e.ignoreBackground),ignorePadding:!(!e||!e.ignorePadding)}}function o(e,t){var r=a(e,t),n=r.area,i=r.width/n.width,o=b(r,t.padding),s=o.left+o.right,c=o.top+o.bottom,l=t.width-s,u=t.height-c,d=Math.floor(l*i+s),h=Math.floor(u*i+c),f=e&&e.layers?e.layers:[],p=r.ignoreBackground,v=r.ignorePadding;return{framebufferWidth:d,framebufferHeight:h,region:{x:Math.floor(n.x*i)+o.left,y:Math.floor(n.y*i)+o.top,width:r.width,height:r.height},format:r.format,quality:r.quality,rotation:r.rotation,pixelRatio:i,layers:f,disableDecorations:r.disableDecorations,ignoreBackground:p,ignorePadding:v}}function s(e,t,r,n){n.premultipliedAlpha&&function(e){for(var t=e.data,r=t.length,n=0;n<r;n+=4){var i=t[n+3];if(i>0){var a=i/255;t[n+0]=t[n+0]/a,t[n+1]=t[n+1]/a,t[n+2]=t[n+2]/a}}}(e),r.width=e.width,r.height=e.height;var i=r.getContext("2d");i.putImageData(e,0,0),n.flipY&&function(e){e.save(),e.globalCompositeOperation="copy",e.scale(1,-1),e.translate(0,-e.canvas.height),e.drawImage(e.canvas,0,0),e.restore()}(i);var a=i.getImageData(0,0,e.width,e.height),o=function(e,t){var r=v[t.format],n=t.quality/100;return e.toDataURL(r,n)}(r,t);return r.width=0,r.height=0,{dataUrl:o,data:a}}function c(e,t,r){if(!e||!t)throw new Error("Cannot construct image data without dimensions");if(p)try{return new ImageData(e,t)}catch(n){p=!1}return h(e,t,r)}function l(e,t,r,n){if(!t||!r)throw new Error("Cannot construct image data without dimensions");if(p)try{return new ImageData(e,t,r)}catch(o){p=!1}var i=h(t,r,n);return i.data.set(e,0),i}function u(e,t,r){for(var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:e.width-n,o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:e.height-i,s=arguments.length>7&&void 0!==arguments[7]&&arguments[7],c=e.data,l=t.width,u=t.height,d=t.data,h=a/l,f=o/u,p=Math.ceil(h/2),b=Math.ceil(f/2),v=e.width,m=0;m<u;m++)for(var y=0;y<l;y++){for(var g=4*(y+(s?u-m-1:m)*l),O=0,j=0,_=0,w=0,x=0,k=0,S=(m+.5)*f,T=Math.floor(m*f);T<(m+1)*f;T++)for(var C=Math.abs(S-(T+.5))/b,M=(y+.5)*h,P=C*C,A=Math.floor(y*h);A<(y+1)*h;A++){var E=Math.abs(M-(A+.5))/p,R=Math.sqrt(P+E*E);if(!(R>=1)){var I=2*R*R*R-3*R*R+1,D=4*(n+A+(i+T)*v);k+=I*c[D+3],j+=I,!r&&c[D+3]<255&&(I=I*c[D+3]/255),_+=I*c[D],w+=I*c[D+1],x+=I*c[D+2],O+=I}}d[g]=_/O,d[g+1]=w/O,d[g+2]=x/O,d[g+3]=k/j}return t}function d(e,t,r){if(!t)return e;var i=e.framebufferWidth,a=e.framebufferHeight,o=e.pixelRatio,s=e.region,c=b(e,r),l=c.left+c.right,u=c.top+c.bottom,d=i-l,h=a-u,f=Math.min(8,Math.min((2048-l)/d,(2048-u)/h));return f<1.5?e:Object(n.a)(Object(n.a)({},e),{},{framebufferWidth:Math.round(d*f)+l,framebufferHeight:Math.round(h*f)+u,pixelRatio:o*f,resample:{region:{x:Math.round((s.x-c.left)*f)+c.left,y:Math.round((s.y-c.top)*f)+c.top,width:Math.round(s.width*f),height:Math.round(s.height*f)},width:i,height:a}})}function h(e,t,r){return r||(f||((f=document.createElement("canvas")).width=1,f.height=1),r=f),r.getContext("2d").createImageData(e,t)}var f=null,p=!0;function b(e,t){return!t||e&&e.ignorePadding?g:t}var v={png:"image/png",jpg:"image/jpeg",jpeg:"image/jpeg"},m="png",y={png:100,jpg:98,jpeg:98},g={top:0,right:0,bottom:0,left:0}},function(e,t,r){"use strict";r.d(t,"a",(function(){return a})),r.d(t,"b",(function(){return o}));var n=r(237),i={namespace:void 0,performanceLogger:function(){},eventHandlerInterceptor:void 0,styleApplyer:function(e,t,r){"-"===t.charAt(0)?e.style.setProperty(t,r):e.style[t]=r}},a=function(e){return Object(n.c)(i,e)},o={create:function(e,t){return t=a(t),Object(n.a)(e,document.createElement("div"),void 0,t),Object(n.b)(e,t)},append:function(e,t,r){return r=a(r),Object(n.a)(t,e,void 0,r),Object(n.b)(t,r)},insertBefore:function(e,t,r){return r=a(r),Object(n.a)(t,e.parentNode,e,r),Object(n.b)(t,r)},merge:function(e,t,r){return r=a(r),t.domNode=e,Object(n.d)(e,t,r),Object(n.b)(t,r)},replace:function(e,t,r){return r=a(r),Object(n.a)(t,e.parentNode,e,r),e.parentNode.removeChild(e),Object(n.b)(t,r)}}},function(e,t,r){"use strict";var n=r(8),i=r.n(n),a=r(50),o=r(16),s=r(13),c=r(2),l=r(5),u=r(6),d=r(7),h=r(0),f=r(53),p=r(27),b=r(25),v=r(15),m=r(23),y=r(1),g=r(64),O=(r(17),r(48)),j=r(10),_=r(44),w=r(18),x=r(103),k=r(288),S=r(181),T=r(423),C=r(263),M=r(302),P=r(259);var A,E={base:null,key:"type",typeMap:{attachment:k.a,media:M.a,text:P.a,field:C.a}},R=r(483),I=r(289),D=A=function(e){Object(u.a)(r,e);var t=Object(d.a)(r);function r(e){var n;return Object(c.a)(this,r),(n=t.call(this,e)).returnTopmostRaster=null,n.showNoDataRecords=null,n}return Object(l.a)(r,[{key:"clone",value:function(){return new A({showNoDataRecords:this.showNoDataRecords,returnTopmostRaster:this.returnTopmostRaster})}}]),r}(p.a);Object(h.a)([Object(y.b)({type:Boolean,json:{write:!0}})],D.prototype,"returnTopmostRaster",void 0),Object(h.a)([Object(y.b)({type:Boolean,json:{write:!0}})],D.prototype,"showNoDataRecords",void 0);var F,L=D=A=Object(h.a)([Object(j.a)("esri.popup.LayerOptions")],D),z=r(514),V=F=function(e){Object(u.a)(r,e);var t=Object(d.a)(r);function r(e){var n;return Object(c.a)(this,r),(n=t.call(this,e)).showRelatedRecords=null,n.orderByFields=null,n}return Object(l.a)(r,[{key:"clone",value:function(){return new F({showRelatedRecords:this.showRelatedRecords,orderByFields:this.orderByFields?Object(b.a)(this.orderByFields):null})}}]),r}(p.a);Object(h.a)([Object(y.b)({type:Boolean,json:{write:!0}})],V.prototype,"showRelatedRecords",void 0),Object(h.a)([Object(y.b)({type:[z.a],json:{write:!0}})],V.prototype,"orderByFields",void 0);var N,U=V=F=Object(h.a)([Object(j.a)("esri.popup.RelatedRecordsInfo")],V),B=r(513),G=r(329),q=r(312),H=r(515),W=f.a.ofType({key:"type",defaultKeyValue:"button",base:G.a,typeMap:{button:q.a,toggle:H.a}}),Q={base:S.a,key:"type",typeMap:{media:M.a,custom:T.a,text:P.a,attachments:k.a,fields:C.a}},Z="esri.PopupTemplate",X=v.a.getLogger(Z),Y=["attachments","fields","media","text"],$=N=function(e){Object(u.a)(r,e);var t=Object(d.a)(r);function r(){var e;return Object(c.a)(this,r),(e=t.apply(this,arguments)).actions=null,e.content="",e.expressionInfos=null,e.fieldInfos=null,e.layerOptions=null,e.lastEditInfoEnabled=!0,e.outFields=null,e.overwriteActions=!1,e.returnGeometry=!1,e.title="",e.relatedRecordsInfo=null,e}return Object(l.a)(r,[{key:"castContent",value:function(e){return Array.isArray(e)?e.map((function(e){return Object(w.k)(Q,e)})):"string"==typeof e||"function"==typeof e||e instanceof HTMLElement||Object(m.q)(e)?e:(X.error("content error","unsupported content value",{value:e}),null)}},{key:"readContent",value:function(e,t){var r=t.popupElements;return Array.isArray(r)&&r.length>0?this._readPopupInfoElements(t):this._readPopupInfo(t)}},{key:"writeContent",value:function(e,t,r,n){var i=this;"string"!=typeof e?Array.isArray(e)&&(t.popupElements=e.filter((function(e){return-1!==Y.indexOf(e.type)})).map((function(e){return e&&e.toJSON(n)})),t.popupElements.forEach((function(e){"attachments"===e.type?i._writeAttachmentContent(t):"media"===e.type?i._writeMediaContent(e,t):"text"===e.type&&i._writeTextContent(e,t)}))):t.description=e}},{key:"writeFieldInfos",value:function(e,t,r,n){var i=this.content,a=Array.isArray(i)?i:null;if(e){var o=a?a.filter((function(e){return"fields"===e.type})):[],c=o.length&&o.every((function(e){var t;return null==(t=e.fieldInfos)?void 0:t.length}));t.fieldInfos=e.filter(Boolean).map((function(e){var t=e.toJSON(n);return c&&(t.visible=!1),t}))}if(a){var l,u=Object(s.a)(a);try{for(u.s();!(l=u.n()).done;){var d=l.value;"fields"===d.type&&this._writeFieldsContent(d,t)}}catch(h){u.e(h)}finally{u.f()}}}},{key:"writeLayerOptions",value:function(e,t,r,n){t[r]=!e||null===e.showNoDataRecords&&null===e.returnTopmostRaster?null:e.toJSON(n)}},{key:"writeTitle",value:function(e,t){t.title=e||""}},{key:"clone",value:function(){var e=this.actions,t=e?Object(b.a)(e.toArray()):[];return new N({actions:t,content:Array.isArray(this.content)?Object(b.a)(this.content):this.content,expressionInfos:Array.isArray(this.expressionInfos)?Object(b.a)(this.expressionInfos):null,fieldInfos:Array.isArray(this.fieldInfos)?Object(b.a)(this.fieldInfos):null,layerOptions:this.layerOptions?Object(b.a)(this.layerOptions):null,lastEditInfoEnabled:this.lastEditInfoEnabled,outFields:Array.isArray(this.outFields)?Object(b.a)(this.outFields):null,overwriteActions:this.overwriteActions,returnGeometry:this.returnGeometry,title:this.title,relatedRecordsInfo:this.relatedRecordsInfo?Object(b.a)(this.relatedRecordsInfo):null})}},{key:"collectRequiredFields",value:function(){var e=Object(o.a)(i.a.mark((function e(t,r){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._collectExpressionInfoFields(t,r,this.expressionInfos);case 2:Object(x.e)(t,r,[].concat(Object(a.a)(this.outFields||[]),Object(a.a)(this._getActionsFields(this.actions)),Object(a.a)(this._getTitleFields(this.title)),Object(a.a)(this._getContentFields(this.content))));case 3:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"getRequiredFields",value:function(){var e=Object(o.a)(i.a.mark((function e(t){var r;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=new Set,e.next=3,this.collectRequiredFields(r,t);case 3:return e.abrupt("return",Object(a.a)(r).sort());case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_writeFieldsContent",value:function(e,t){if(Array.isArray(e.fieldInfos)&&e.fieldInfos.length){var r=Object(b.a)(e.fieldInfos);Array.isArray(t.fieldInfos)?r.forEach((function(e){var r=t.fieldInfos.find((function(t){return t.fieldName.toLowerCase()===e.fieldName.toLowerCase()}));r?r.visible=!0:t.fieldInfos.push(e)})):t.fieldInfos=r}}},{key:"_writeAttachmentContent",value:function(e){e.showAttachments||(e.showAttachments=!0)}},{key:"_writeTextContent",value:function(e,t){!t.description&&e.text&&(t.description=e.text)}},{key:"_writeMediaContent",value:function(e,t){if(Array.isArray(e.mediaInfos)&&e.mediaInfos.length){var r=Object(b.a)(e.mediaInfos);Array.isArray(t.mediaInfos)?t.mediaInfos=[].concat(Object(a.a)(t.mediaInfos),Object(a.a)(r)):t.mediaInfos=r}}},{key:"_readPopupInfoElements",value:function(e){var t=e.description,r=e.mediaInfos,n=e.popupElements,i={description:!1,mediaInfos:!1};return n.map((function(e){return"media"===e.type?(e.mediaInfos||!r||i.mediaInfos||(e.mediaInfos=r,i.mediaInfos=!0),M.a.fromJSON(e)):"text"===e.type?(e.text||!t||i.description||(e.text=t,i.description=!0),P.a.fromJSON(e)):"attachments"===e.type?k.a.fromJSON(e):"fields"===e.type?C.a.fromJSON(e):void 0})).filter(Boolean)}},{key:"_readPopupInfo",value:function(e){var t=e.description,r=e.mediaInfos,n=e.showAttachments,i=[];return t?i.push(new P.a({text:t})):i.push(new C.a),Array.isArray(r)&&r.length&&i.push(M.a.fromJSON({mediaInfos:r})),n&&i.push(k.a.fromJSON({displayType:"list"})),i.length?i:t}},{key:"_getContentElementFields",value:function(e){var t=this;return e&&"attachments"!==e.type?"custom"===e.type?e.outFields||[]:"fields"===e.type?this._getFieldInfoFields(e.fieldInfos||this.fieldInfos):"media"===e.type?(e.mediaInfos||[]).reduce((function(e,r){return[].concat(Object(a.a)(e),Object(a.a)(t._getMediaInfoFields(r)))}),[]):"text"===e.type?this._extractFieldNames(e.text):void 0:[]}},{key:"_getMediaInfoFields",value:function(e){var t=e.caption,r=e.title,n=e.value||{},i=n.fields,o=void 0===i?[]:i,s=n.normalizeField,c=n.tooltipField,l=n.sourceURL,u=n.linkURL,d=[].concat(Object(a.a)(this._extractFieldNames(r)),Object(a.a)(this._extractFieldNames(t)),Object(a.a)(this._extractFieldNames(l)),Object(a.a)(this._extractFieldNames(u)),Object(a.a)(o));return s&&d.push(s),c&&d.push(c),d}},{key:"_getContentFields",value:function(e){var t=this;return"string"==typeof e?this._extractFieldNames(e):Array.isArray(e)?e.reduce((function(e,r){return[].concat(Object(a.a)(e),Object(a.a)(t._getContentElementFields(r)))}),[]):[]}},{key:"_collectExpressionInfoFields",value:function(){var e=Object(o.a)(i.a.mark((function e(t,r,n){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=n,!e.t0){e.next=4;break}return e.next=4,Promise.all(n.map((function(e){return Object(x.a)(t,r,e.expression)})));case 4:case"end":return e.stop()}}),e)})));return function(t,r,n){return e.apply(this,arguments)}}()},{key:"_getFieldInfoFields",value:function(e){return e?e.filter((function(e){return void 0===e.visible||!!e.visible})).map((function(e){return e.fieldName})).filter((function(e){return-1===e.indexOf("relationships/")&&-1===e.indexOf("expression/")})):[]}},{key:"_getActionsFields",value:function(e){var t=this;return e?e.toArray().reduce((function(e,r){return[].concat(Object(a.a)(e),Object(a.a)(t._getActionFields(r)))}),[]):[]}},{key:"_getActionFields",value:function(e){var t=e.className,r=e.title,n=e.type,i="button"===n||"toggle"===n?e.image:"";return[].concat(Object(a.a)(this._extractFieldNames(r)),Object(a.a)(this._extractFieldNames(t)),Object(a.a)(this._extractFieldNames(i)))}},{key:"_getTitleFields",value:function(e){return"string"==typeof e?this._extractFieldNames(e):[]}},{key:"_extractFieldNames",value:function(e){if(!e||"string"!=typeof e)return[];var t=e.match(/{[^}]*}/g);if(!t)return[];var r=/\{(\w+):.+\}/,n=t.filter((function(e){return!(0===e.indexOf("{relationships/")||0===e.indexOf("{expression/"))})).map((function(e){return e.replace(r,"{$1}")}));return n?n.map((function(e){return e.slice(1,-1)})):[]}}]),r}(p.a);Object(h.a)([Object(y.b)({type:W})],$.prototype,"actions",void 0),Object(h.a)([Object(y.b)()],$.prototype,"content",void 0),Object(h.a)([Object(g.a)("content")],$.prototype,"castContent",null),Object(h.a)([Object(O.a)("content",["description","fieldInfos","popupElements","mediaInfos","showAttachments"])],$.prototype,"readContent",null),Object(h.a)([Object(_.a)("content",{popupElements:{type:f.a.ofType(E)},showAttachments:{type:Boolean},mediaInfos:{type:f.a.ofType(B.a)},description:{type:String}})],$.prototype,"writeContent",null),Object(h.a)([Object(y.b)({type:[R.a],json:{write:!0}})],$.prototype,"expressionInfos",void 0),Object(h.a)([Object(y.b)({type:[I.a]})],$.prototype,"fieldInfos",void 0),Object(h.a)([Object(_.a)("fieldInfos")],$.prototype,"writeFieldInfos",null),Object(h.a)([Object(y.b)({type:L})],$.prototype,"layerOptions",void 0),Object(h.a)([Object(_.a)("layerOptions")],$.prototype,"writeLayerOptions",null),Object(h.a)([Object(y.b)({type:Boolean,json:{read:{source:"showLastEditInfo"},write:{target:"showLastEditInfo"},default:!0}})],$.prototype,"lastEditInfoEnabled",void 0),Object(h.a)([Object(y.b)()],$.prototype,"outFields",void 0),Object(h.a)([Object(y.b)()],$.prototype,"overwriteActions",void 0),Object(h.a)([Object(y.b)()],$.prototype,"returnGeometry",void 0),Object(h.a)([Object(y.b)({json:{type:String}})],$.prototype,"title",void 0),Object(h.a)([Object(_.a)("title")],$.prototype,"writeTitle",null),Object(h.a)([Object(y.b)({type:U,json:{write:!0}})],$.prototype,"relatedRecordsInfo",void 0);var J=$=N=Object(h.a)([Object(j.a)(Z)],$);t.a=J},function(e,t,r){"use strict";r.r(t),r.d(t,"executeQuery",(function(){return m})),r.d(t,"executeQueryForCount",(function(){return w})),r.d(t,"executeQueryForExtent",(function(){return x})),r.d(t,"executeQueryForIds",(function(){return _})),r.d(t,"executeQueryPBF",(function(){return g})),r.d(t,"executeQueryPBFBuffer",(function(){return j})),r.d(t,"queryToQueryStringParameters",(function(){return v})),r.d(t,"runQuery",(function(){return k}));var n=r(8),i=r.n(n),a=r(14),o=r(16),s=r(99),c=r(3),l=r(39),u=r(100),d=r(450),h=r(645),f=r(358),p=r(331),b="Layer does not support extent calculation.";function v(e,t){var r=e.geometry,n=e.toJSON(),i=n;if(Object(c.j)(r)&&(i.geometry=JSON.stringify(r),i.geometryType=Object(u.c)(r),i.inSR=r.spatialReference.wkid||JSON.stringify(r.spatialReference)),n.groupByFieldsForStatistics&&(i.groupByFieldsForStatistics=n.groupByFieldsForStatistics.join(",")),n.objectIds&&(i.objectIds=n.objectIds.join(",")),n.orderByFields&&(i.orderByFields=n.orderByFields.join(",")),!n.outFields||!n.returnDistinctValues&&(null!=t&&t.returnCountOnly||null!=t&&t.returnExtentOnly||null!=t&&t.returnIdsOnly)?delete i.outFields:-1!==n.outFields.indexOf("*")?i.outFields="*":i.outFields=n.outFields.join(","),n.outSR?i.outSR=n.outSR.wkid||JSON.stringify(n.outSR):r&&(n.returnGeometry||n.returnCentroid)&&(i.outSR=i.inSR),n.returnGeometry&&delete n.returnGeometry,n.outStatistics&&(i.outStatistics=JSON.stringify(n.outStatistics)),n.pixelSize&&(i.pixelSize=JSON.stringify(n.pixelSize)),n.quantizationParameters&&(i.quantizationParameters=JSON.stringify(n.quantizationParameters)),n.parameterValues&&(i.parameterValues=JSON.stringify(n.parameterValues)),n.rangeValues&&(i.rangeValues=JSON.stringify(n.rangeValues)),n.dynamicDataSource&&(i.layer=JSON.stringify({source:n.dynamicDataSource}),delete n.dynamicDataSource),n.timeExtent){var a=n.timeExtent,o=a.start,s=a.end;null==o&&null==s||(i.time=o===s?o:"".concat(null==o?"null":o,",").concat(null==s?"null":s)),delete n.timeExtent}return i}function m(e,t,r,n){return y.apply(this,arguments)}function y(){return(y=Object(o.a)(i.a.mark((function e(t,r,n,a){var o;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!Object(c.j)(r.timeExtent)||!r.timeExtent.isEmpty){e.next=4;break}e.t0={data:{features:[]}},e.next=7;break;case 4:return e.next=6,k(t,r,"json",a);case 6:e.t0=e.sent;case 7:return o=e.t0,e.abrupt("return",(Object(f.a)(r,n,o.data),o));case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function g(e,t,r,n){return O.apply(this,arguments)}function O(){return(O=Object(o.a)(i.a.mark((function e(t,r,n,a){var o,s;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!Object(c.j)(r.timeExtent)||!r.timeExtent.isEmpty){e.next=2;break}return e.abrupt("return",Promise.resolve({data:n.createFeatureResult()}));case 2:return e.next=4,j(t,r,a);case 4:return o=e.sent,s=o,e.abrupt("return",(s.data=Object(h.a)(o.data,n),s));case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function j(e,t,r){return k(e,t,"pbf",r)}function _(e,t,r){return Object(c.j)(t.timeExtent)&&t.timeExtent.isEmpty?Promise.resolve({data:{objectIds:[]}}):k(e,t,"json",r,{returnIdsOnly:!0})}function w(e,t,r){return Object(c.j)(t.timeExtent)&&t.timeExtent.isEmpty?Promise.resolve({data:{count:0}}):k(e,t,"json",r,{returnIdsOnly:!0,returnCountOnly:!0})}function x(e,t,r){return Object(c.j)(t.timeExtent)&&t.timeExtent.isEmpty?Promise.resolve({data:{count:0,extent:null}}):k(e,t,"json",r,{returnExtentOnly:!0,returnCountOnly:!0}).then((function(e){var t=e.data;if(t.hasOwnProperty("extent"))return e;if(t.features)throw new Error(b);if(t.hasOwnProperty("count"))throw new Error(b);return e}))}function k(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},o="string"==typeof e?Object(l.K)(e):e,u=t.geometry?[t.geometry]:[];return n.responseType="pbf"===r?"array-buffer":"json",Object(d.a)(u,null,n).then((function(e){var u=e&&e[0];Object(c.j)(u)&&((t=t.clone()).geometry=u);var d=Object(p.a)(Object(a.a)(Object(a.a)(Object(a.a)({},o.query),{},{f:r},i),v(t,i)));return Object(s.default)(Object(l.z)(o.path,"query"),Object(a.a)(Object(a.a)({},n),{},{query:Object(a.a)(Object(a.a)({},d),n.query)}))}))}},function(e,t,r){"use strict";r.d(t,"a",(function(){return b})),r.d(t,"b",(function(){return v})),r.d(t,"c",(function(){return m}));var n,i,a,o,s,c,l,u,d=r(12),h=r(73),f=r(399),p=r(11),b=Object(h.d)(0,.6,.2);function v(e,t){var r=e.fragment,h=t.hasMetalnessAndRoughnessTexture||t.hasEmissionTexture||t.hasOcclusionTexture;1===t.pbrMode&&h&&e.include(f.a,t),2!==t.pbrMode?(0===t.pbrMode&&r.code.add(Object(p.a)(n||(n=Object(d.a)(["float getBakedOcclusion() { return 1.0; }"])))),1===t.pbrMode&&(r.uniforms.add("emissionFactor","vec3"),r.uniforms.add("mrrFactors","vec3"),r.code.add(Object(p.a)(i||(i=Object(d.a)(["vec3 mrr;\nvec3 emission;\nfloat occlusion;"])))),t.hasMetalnessAndRoughnessTexture&&(r.uniforms.add("texMetallicRoughness","sampler2D"),t.supportsTextureAtlas&&r.uniforms.add("texMetallicRoughnessSize","vec2"),r.code.add(Object(p.a)(a||(a=Object(d.a)(["void applyMetallnessAndRoughness(TextureLookupParameter params) {\nvec3 metallicRoughness = textureLookup(texMetallicRoughness, params).rgb;\nmrr[0] *= metallicRoughness.b;\nmrr[1] *= metallicRoughness.g;\n}"]))))),t.hasEmissionTexture&&(r.uniforms.add("texEmission","sampler2D"),t.supportsTextureAtlas&&r.uniforms.add("texEmissionSize","vec2"),r.code.add(Object(p.a)(o||(o=Object(d.a)(["void applyEmission(TextureLookupParameter params) {\nemission *= textureLookup(texEmission, params).rgb;\n}"]))))),t.hasOcclusionTexture?(r.uniforms.add("texOcclusion","sampler2D"),t.supportsTextureAtlas&&r.uniforms.add("texOcclusionSize","vec2"),r.code.add(Object(p.a)(s||(s=Object(d.a)(["void applyOcclusion(TextureLookupParameter params) {\nocclusion *= textureLookup(texOcclusion, params).r;\n}\nfloat getBakedOcclusion() {\nreturn occlusion;\n}"]))))):r.code.add(Object(p.a)(c||(c=Object(d.a)(["float getBakedOcclusion() { return 1.0; }"])))),r.code.add(Object(p.a)(l||(l=Object(d.a)(["\n    void applyPBRFactors() {\n      mrr = mrrFactors;\n      emission = emissionFactor;\n      occlusion = 1.0;\n      ","\n      ","\n      ","\n      ","\n    }\n  "])),h?"vtc.uv = vuv0;":"",t.hasMetalnessAndRoughnessTexture?t.supportsTextureAtlas?"vtc.size = texMetallicRoughnessSize; applyMetallnessAndRoughness(vtc);":"applyMetallnessAndRoughness(vtc);":"",t.hasEmissionTexture?t.supportsTextureAtlas?"vtc.size = texEmissionSize; applyEmission(vtc);":"applyEmission(vtc);":"",t.hasOcclusionTexture?t.supportsTextureAtlas?"vtc.size = texOcclusionSize; applyOcclusion(vtc);":"applyOcclusion(vtc);":"")))):r.code.add(Object(p.a)(u||(u=Object(d.a)(["const vec3 mrr = vec3(0.0, 0.6, 0.2);\nconst vec3 emission = vec3(0.0);\nfloat occlusion = 1.0;\nvoid applyPBRFactors() {}\nfloat getBakedOcclusion() { return 1.0; }"]))))}function m(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];r||(e.setUniform3fv("mrrFactors",t.mrrFactors),e.setUniform3fv("emissionFactor",t.emissiveFactor))}},function(e,t,r){"use strict";var n=r(2),i=r(5),a=r(6),o=r(7),s=r(0),c=r(3),l=r(1),u=(r(17),r(18),r(15),r(52)),d=r(10),h=r(161),f=r(495),p=function(e){Object(a.a)(r,e);var t=Object(o.a)(r);function r(e){return Object(n.a)(this,r),t.call(this,e)}return Object(i.a)(r,[{key:"clone",value:function(){}}]),r}(r(27).a);Object(s.a)([Object(l.b)({type:["style"],readOnly:!0,json:{read:!0,write:{ignoreOrigin:!0}}})],p.prototype,"type",void 0);var b,v=p=Object(s.a)([Object(d.a)("esri.symbols.patterns.Pattern3D")],p),m=["backward-diagonal","cross","diagonal-cross","forward-diagonal","horizontal","none","solid","vertical"],y=b=function(e){Object(a.a)(r,e);var t=Object(o.a)(r);function r(e){var i;return Object(n.a)(this,r),(i=t.call(this,e)).type="style",i.style="solid",i}return Object(i.a)(r,[{key:"clone",value:function(){return new b({style:this.style})}}]),r}(v);Object(s.a)([Object(l.b)({type:["style"]})],y.prototype,"type",void 0),Object(s.a)([Object(l.b)({type:m,json:{read:!0,write:!0}})],y.prototype,"style",void 0);var g=y=b=Object(s.a)([Object(d.a)("esri.symbols.patterns.StylePattern3D")],y);var O,j={types:{key:"type",base:v,typeMap:{style:g}},json:{read:function(e,t,r){if(!e)return e;switch(e.type){case"style":var n=new g;return n.read(e,r),n}},write:!0}},_=r(296),w=r(198),x=O=function(e){Object(a.a)(r,e);var t=Object(o.a)(r);function r(){return Object(n.a)(this,r),t.apply(this,arguments)}return Object(i.a)(r,[{key:"clone",value:function(){return new O({color:Object(c.j)(this.color)?this.color.clone():null,colorMixMode:this.colorMixMode})}}]),r}(w.a);Object(s.a)([Object(u.a)({multiply:"multiply",replace:"replace",tint:"tint"})],x.prototype,"colorMixMode",void 0);var k,S=x=O=Object(s.a)([Object(d.a)("esri.symbols.support.Symbol3DFillMaterial")],x),T=r(434),C=k=function(e){Object(a.a)(r,e);var t=Object(o.a)(r);function r(e){var i;return Object(n.a)(this,r),(i=t.call(this,e)).type="fill",i.material=null,i.pattern=null,i.castShadows=!0,i.outline=null,i.edges=null,i}return Object(i.a)(r,[{key:"clone",value:function(){return new k({edges:Object(c.j)(this.edges)?this.edges.clone():null,enabled:this.enabled,material:Object(c.j)(this.material)?this.material.clone():null,pattern:Object(c.j)(this.pattern)?this.pattern.clone():null,castShadows:this.castShadows,outline:Object(c.j)(this.outline)?this.outline.clone():null})}}],[{key:"fromSimpleFillSymbol",value:function(e){return new k({material:{color:(e.color||_.b).clone()},pattern:e.style&&"solid"!==e.style?new g({style:e.style}):null,outline:e.outline?new T.a({size:e.outline.width||0,color:(e.outline.color||_.c).clone()}):null})}}]),r}(h.a);Object(s.a)([Object(u.a)({Fill:"fill"},{readOnly:!0})],C.prototype,"type",void 0),Object(s.a)([Object(l.b)({type:S,json:{write:!0}})],C.prototype,"material",void 0),Object(s.a)([Object(l.b)(j)],C.prototype,"pattern",void 0),Object(s.a)([Object(l.b)({type:Boolean,nonNullable:!0,json:{write:!0,default:!0}})],C.prototype,"castShadows",void 0),Object(s.a)([Object(l.b)({type:T.a,json:{write:!0}})],C.prototype,"outline",void 0),Object(s.a)([Object(l.b)(f.a)],C.prototype,"edges",void 0);var M=C=k=Object(s.a)([Object(d.a)("esri.symbols.FillSymbol3DLayer")],C);t.a=M},function(e,t,r){"use strict";r.d(t,"a",(function(){return c}));var n,i,a,o=r(12),s=r(11);function c(e,t){0===t.output&&t.receiveShadows?(e.varyings.add("linearDepth","float"),e.vertex.code.add(Object(s.a)(n||(n=Object(o.a)(["void forwardLinearDepth() { linearDepth = gl_Position.w; }"]))))):1===t.output||3===t.output?(e.varyings.add("linearDepth","float"),e.vertex.uniforms.add("cameraNearFar","vec2"),e.vertex.code.add(Object(s.a)(i||(i=Object(o.a)(["void forwardLinearDepth() {\nlinearDepth = (-position_view().z - cameraNearFar[0]) / (cameraNearFar[1] - cameraNearFar[0]);\n}"]))))):e.vertex.code.add(Object(s.a)(a||(a=Object(o.a)(["void forwardLinearDepth() {}"]))))}},function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n,i=r(12),a=r(11);function o(e){e.attributes.add("position","vec2"),e.varyings.add("uv","vec2"),e.vertex.code.add(Object(a.a)(n||(n=Object(i.a)(["\n    void main(void) {\n      gl_Position = vec4(position, 0.0, 1.0);\n      uv = position * 0.5 + vec2(0.5);\n    }\n  "]))))}},function(e,t,r){"use strict";r.d(t,"a",(function(){return C}));var n,i,a,o,s=r(12),c=r(11);function l(e,t){var r=e.fragment,l=void 0!==t.lightingSphericalHarmonicsOrder?t.lightingSphericalHarmonicsOrder:2;0===l?(r.uniforms.add("lightingAmbientSH0","vec3"),r.code.add(Object(c.a)(n||(n=Object(s.a)(["vec3 calculateAmbientIrradiance(vec3 normal, float ambientOcclusion) {\nvec3 ambientLight = 0.282095 * lightingAmbientSH0;\nreturn ambientLight * (1.0 - ambientOcclusion);\n}"]))))):1===l?(r.uniforms.add("lightingAmbientSH_R","vec4"),r.uniforms.add("lightingAmbientSH_G","vec4"),r.uniforms.add("lightingAmbientSH_B","vec4"),r.code.add(Object(c.a)(i||(i=Object(s.a)(["vec3 calculateAmbientIrradiance(vec3 normal, float ambientOcclusion) {\nvec4 sh0 = vec4(\n0.282095,\n0.488603 * normal.x,\n0.488603 * normal.z,\n0.488603 * normal.y\n);\nvec3 ambientLight = vec3(\ndot(lightingAmbientSH_R, sh0),\ndot(lightingAmbientSH_G, sh0),\ndot(lightingAmbientSH_B, sh0)\n);\nreturn ambientLight * (1.0 - ambientOcclusion);\n}"]))))):2===l&&(r.uniforms.add("lightingAmbientSH0","vec3"),r.uniforms.add("lightingAmbientSH_R1","vec4"),r.uniforms.add("lightingAmbientSH_G1","vec4"),r.uniforms.add("lightingAmbientSH_B1","vec4"),r.uniforms.add("lightingAmbientSH_R2","vec4"),r.uniforms.add("lightingAmbientSH_G2","vec4"),r.uniforms.add("lightingAmbientSH_B2","vec4"),r.code.add(Object(c.a)(a||(a=Object(s.a)(["vec3 calculateAmbientIrradiance(vec3 normal, float ambientOcclusion) {\nvec3 ambientLight = 0.282095 * lightingAmbientSH0;\nvec4 sh1 = vec4(\n0.488603 * normal.x,\n0.488603 * normal.z,\n0.488603 * normal.y,\n1.092548 * normal.x * normal.y\n);\nvec4 sh2 = vec4(\n1.092548 * normal.y * normal.z,\n0.315392 * (3.0 * normal.z * normal.z - 1.0),\n1.092548 * normal.x * normal.z,\n0.546274 * (normal.x * normal.x - normal.y * normal.y)\n);\nambientLight += vec3(\ndot(lightingAmbientSH_R1, sh1),\ndot(lightingAmbientSH_G1, sh1),\ndot(lightingAmbientSH_B1, sh1)\n);\nambientLight += vec3(\ndot(lightingAmbientSH_R2, sh2),\ndot(lightingAmbientSH_G2, sh2),\ndot(lightingAmbientSH_B2, sh2)\n);\nreturn ambientLight * (1.0 - ambientOcclusion);\n}"])))),1!==t.pbrMode&&2!==t.pbrMode||r.code.add(Object(c.a)(o||(o=Object(s.a)(["const vec3 skyTransmittance = vec3(0.9, 0.9, 1.0);\nvec3 calculateAmbientRadiance(float ambientOcclusion)\n{\nvec3 ambientLight = 1.2 * (0.282095 * lightingAmbientSH0) - 0.2;\nreturn ambientLight *= (1.0 - ambientOcclusion) * skyTransmittance;\n}"])))))}var u,d,h,f,p,b,v,m,y,g,O,j,_,w=r(316),x=r(534),k=r(320),S=r(390),T=r(148);function C(e,t){var r=e.fragment;e.include(x.a),e.include(w.a,t),0!==t.pbrMode&&e.include(k.a,t),e.include(l,t),t.receiveShadows&&e.include(T.a,t),r.uniforms.add("lightingGlobalFactor","float"),r.uniforms.add("ambientBoostFactor","float"),e.include(S.a),r.code.add(Object(c.a)(u||(u=Object(s.a)(["\n    const float GAMMA_SRGB = 2.1;\n    const float INV_GAMMA_SRGB = 0.4761904;\n    ","\n  "])),0===t.pbrMode?"":"const vec3 GROUND_REFLECTANCE = vec3(0.2);")),r.code.add(Object(c.a)(d||(d=Object(s.a)(["\n    float additionalDirectedAmbientLight(vec3 vPosWorld) {\n      float vndl = dot(",", lightingMainDirection);\n      return smoothstep(0.0, 1.0, clamp(vndl * 2.5, 0.0, 1.0));\n    }\n  "])),1===t.viewingMode?Object(c.a)(h||(h=Object(s.a)(["normalize(vPosWorld)"]))):Object(c.a)(f||(f=Object(s.a)(["vec3(0.0, 0.0, 1.0)"]))))),r.code.add(Object(c.a)(p||(p=Object(s.a)(["vec3 evaluateAdditionalLighting(float ambientOcclusion, vec3 vPosWorld) {\nfloat additionalAmbientScale = additionalDirectedAmbientLight(vPosWorld);\nreturn (1.0 - ambientOcclusion) * additionalAmbientScale * ambientBoostFactor * lightingGlobalFactor * lightingMainIntensity;\n}"])))),0===t.pbrMode||4===t.pbrMode?r.code.add(Object(c.a)(b||(b=Object(s.a)(["vec3 evaluateSceneLighting(vec3 normalWorld, vec3 albedo, float shadow, float ssao, vec3 additionalLight)\n{\nvec3 mainLighting = evaluateMainLighting(normalWorld, shadow);\nvec3 ambientLighting = calculateAmbientIrradiance(normalWorld, ssao);\nvec3 albedoLinear = pow(albedo, vec3(GAMMA_SRGB));\nvec3 totalLight = mainLighting + ambientLighting + additionalLight;\ntotalLight = min(totalLight, vec3(PI));\nvec3 outColor = vec3((albedoLinear / PI) * totalLight);\nreturn pow(outColor, vec3(INV_GAMMA_SRGB));\n}"])))):1!==t.pbrMode&&2!==t.pbrMode||(r.code.add(Object(c.a)(v||(v=Object(s.a)(["const float fillLightIntensity = 0.25;\nconst float horizonLightDiffusion = 0.4;\nconst float additionalAmbientIrradianceFactor = 0.02;\nvec3 evaluateSceneLightingPBR(vec3 normal, vec3 albedo, float shadow, float ssao, vec3 additionalLight, vec3 viewDir, vec3 normalGround, vec3 mrr, vec3 _emission, float additionalAmbientIrradiance)\n{\nvec3 viewDirection = -viewDir;\nvec3 mainLightDirection = lightingMainDirection;\nvec3 h = normalize(viewDirection + mainLightDirection);\nPBRShadingInfo inputs;\ninputs.NdotL = clamp(dot(normal, mainLightDirection), 0.001, 1.0);\ninputs.NdotV = clamp(abs(dot(normal, viewDirection)), 0.001, 1.0);\ninputs.NdotH = clamp(dot(normal, h), 0.0, 1.0);\ninputs.VdotH = clamp(dot(viewDirection, h), 0.0, 1.0);\ninputs.NdotNG = clamp(dot(normal, normalGround), -1.0, 1.0);\nvec3 reflectedView = normalize(reflect(viewDirection, normal));\ninputs.RdotNG = clamp(dot(reflectedView, normalGround), -1.0, 1.0);\ninputs.albedoLinear = pow(albedo, vec3(GAMMA_SRGB));\ninputs.ssao = ssao;\ninputs.metalness = mrr[0];\ninputs.roughness = clamp(mrr[1] * mrr[1], 0.001, 0.99);"])))),r.code.add(Object(c.a)(m||(m=Object(s.a)(["inputs.f0 = (0.16 * mrr[2] * mrr[2]) * (1.0 - inputs.metalness) + inputs.albedoLinear * inputs.metalness;\ninputs.f90 = vec3(clamp(dot(inputs.f0, vec3(50.0 * 0.33)), 0.0, 1.0));\ninputs.diffuseColor = inputs.albedoLinear * (vec3(1.0) - inputs.f0) * (1.0 - inputs.metalness);"])))),r.code.add(Object(c.a)(y||(y=Object(s.a)(["vec3 ambientDir = vec3(5.0 * normalGround[1] - normalGround[0] * normalGround[2], - 5.0 * normalGround[0] - normalGround[2] * normalGround[1], normalGround[1] * normalGround[1] + normalGround[0] * normalGround[0]);\nambientDir = ambientDir != vec3(0.0)? normalize(ambientDir) : normalize(vec3(5.0, -1.0, 0.0));\ninputs.NdotAmbDir = abs(dot(normal, ambientDir));\nvec3 mainLightIrradianceComponent = inputs.NdotL * (1.0 - shadow) * lightingMainIntensity;\nvec3 fillLightsIrradianceComponent = inputs.NdotAmbDir * lightingMainIntensity * fillLightIntensity;\nvec3 ambientLightIrradianceComponent = calculateAmbientIrradiance(normal, ssao) + additionalLight;\ninputs.skyIrradianceToSurface = ambientLightIrradianceComponent + mainLightIrradianceComponent + fillLightsIrradianceComponent ;\ninputs.groundIrradianceToSurface = GROUND_REFLECTANCE * ambientLightIrradianceComponent + mainLightIrradianceComponent + fillLightsIrradianceComponent ;"])))),r.code.add(Object(c.a)(g||(g=Object(s.a)(["vec3 horizonRingDir = inputs.RdotNG * normalGround - reflectedView;\nvec3 horizonRingH = normalize(viewDirection + horizonRingDir);\ninputs.NdotH_Horizon = dot(normal, horizonRingH);\nvec3 mainLightRadianceComponent = normalDistribution(inputs.NdotH, inputs.roughness) * lightingMainIntensity * (1.0 - shadow);\nvec3 horizonLightRadianceComponent = normalDistribution(inputs.NdotH_Horizon, min(inputs.roughness + horizonLightDiffusion, 1.0)) * lightingMainIntensity * fillLightIntensity;\nvec3 ambientLightRadianceComponent = calculateAmbientRadiance(ssao) + additionalLight;\ninputs.skyRadianceToSurface = ambientLightRadianceComponent + mainLightRadianceComponent + horizonLightRadianceComponent;\ninputs.groundRadianceToSurface = GROUND_REFLECTANCE * (ambientLightRadianceComponent + horizonLightRadianceComponent) + mainLightRadianceComponent;\ninputs.averageAmbientRadiance = ambientLightIrradianceComponent[1] * (1.0 + GROUND_REFLECTANCE[1]);"])))),r.code.add(Object(c.a)(O||(O=Object(s.a)(["\n        vec3 reflectedColorComponent = evaluateEnvironmentIllumination(inputs);\n        vec3 additionalMaterialReflectanceComponent = inputs.albedoLinear * additionalAmbientIrradiance;\n        vec3 emissionComponent = pow(_emission, vec3(GAMMA_SRGB));\n        vec3 outColorLinear = reflectedColorComponent + additionalMaterialReflectanceComponent + emissionComponent;\n        ","\n        return outColor;\n      }\n    "])),2===t.pbrMode?Object(c.a)(j||(j=Object(s.a)(["vec3 outColor = pow(max(vec3(0.0), outColorLinear - 0.005 * inputs.averageAmbientRadiance), vec3(INV_GAMMA_SRGB));"]))):Object(c.a)(_||(_=Object(s.a)(["vec3 outColor = pow(blackLevelSoftCompression(outColorLinear, inputs), vec3(INV_GAMMA_SRGB));"]))))))}},function(e,t,r){"use strict";r.d(t,"a",(function(){return b})),r.d(t,"b",(function(){return v}));var n=r(13),i=r(2),a=r(5),o=r(6),s=r(7),c=r(82),l=r(57),u=r(3),d=r(74),h=r(247),f=["layerObjectAdded","layerObjectRemoved","layerObjectsAdded","layerObjectsRemoved","shaderTransformationChanged","objectTransformation","visibilityChanged","occlusionChanged","highlightChanged","objectGeometryAdded","objectGeometryRemoved","vertexAttrsUpdated"],p=r(524),b=function(e){Object(o.a)(r,e);var t=Object(s.a)(r);function r(e){var n,a,o,s,u=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return Object(i.a)(this,r),(n=t.call(this)).apiLayerUid=u,n.type=0,n.events=new c.a,n.isSliceable=!1,n._objects=new d.a,n._stageHandles=new l.a,n.apiLayerUid=u,n.isVisible=null==(a=null==e?void 0:e.isVisible)||a,n.isPickable=null==(o=null==e?void 0:e.isPickable)||o,n.updatePolicy=null!=(s=null==e?void 0:e.updatePolicy)?s:0,n}return Object(a.a)(r,[{key:"objects",get:function(){return this._objects}},{key:"destroy",value:function(){this.detachStage(),this._stage=null}},{key:"attachStage",value:function(e){var t=this;this.detachStage(),this._stage=e;var r,i=Object(n.a)(f);try{var a=function(){var n=r.value;t._stageHandles.add(t.events.on(n,(function(t){return e.handleEvent(n,t)})))};for(i.s();!(r=i.n()).done;)a()}catch(o){i.e(o)}finally{i.f()}}},{key:"detachStage",value:function(){this._stageHandles.removeAll(),this.invalidateSpatialQueryAccelerator()}},{key:"add",value:function(e){this._objects.push(e),e.parentLayer=this,this.events.emit("layerObjectAdded",{layer:this,object:e}),Object(u.j)(this._octree)&&this._octree.add([e])}},{key:"remove",value:function(e){this._objects.removeUnordered(e)&&(e.parentLayer=null,this.events.emit("layerObjectRemoved",{layer:this,object:e}),Object(u.j)(this._octree)&&this._octree.remove([e]))}},{key:"addMany",value:function(e){this._objects.pushArray(e);var t,r=Object(n.a)(e);try{for(r.s();!(t=r.n()).done;){t.value.parentLayer=this}}catch(i){r.e(i)}finally{r.f()}this.events.emit("layerObjectsAdded",{layer:this,objects:e}),Object(u.j)(this._octree)&&this._octree.add(e)}},{key:"removeMany",value:function(e){var t=new Array;if(this._objects.removeUnorderedMany(e,e.length,t),0!==t.length){var r,i=Object(n.a)(t);try{for(i.s();!(r=i.n()).done;){r.value.parentLayer=null}}catch(a){i.e(a)}finally{i.f()}this.events.emit("layerObjectsRemoved",{layer:this,objects:t}),Object(u.j)(this._octree)&&this._octree.remove(t)}}},{key:"sync",value:function(){Object(u.j)(this._stage)&&1!==this.updatePolicy&&this._stage.syncLayer(this.id)}},{key:"notifyObjectBBChanged",value:function(e,t){Object(u.j)(this._octree)&&this._octree.update(e,t)}},{key:"getSpatialQueryAccelerator",value:function(){return Object(u.i)(this._octree)&&this._objects.length>50&&this._createOctree(),this._octree}},{key:"shaderTransformationChanged",value:function(){this.invalidateSpatialQueryAccelerator(),this.events.emit("shaderTransformationChanged",this)}},{key:"invalidateSpatialQueryAccelerator",value:function(){this._octree=Object(u.e)(this._octree)}},{key:"_createOctree",value:function(){this._octree=new p.a((function(e){return e.boundingVolumeWorldSpace.bounds})),this._octree.add(this._objects.data,this._objects.length)}}]),r}(h.a);function v(e){return Object(u.j)(e)&&0===e.type}},function(e,t,r){"use strict";var n=r(13),i=r(2),a=r(5),o=r(6),s=r(7),c=r(0),l=r(53),u=r(189),d=r(3),h=r(1),f=(r(17),r(18),r(15),r(10)),p=r(300),b=function(e){Object(o.a)(r,e);var t=Object(s.a)(r);function r(e){var n;return Object(i.a)(this,r),(n=t.call(this,e)).getCollections=null,n}return Object(a.a)(r,[{key:"initialize",value:function(){var e=this;this.handles.add(Object(p.a)((function(){return e.refresh()})))}},{key:"destroy",value:function(){this.getCollections=null}},{key:"refresh",value:function(){var e=Object(d.j)(this.getCollections)?this.getCollections():null;if(Object(d.i)(e))this.removeAll();else{var t,r=0,i=Object(n.a)(e);try{for(i.s();!(t=i.n()).done;){var a=t.value;Object(d.j)(a)&&(r=this._processCollection(r,a))}}catch(o){i.e(o)}finally{i.f()}this.splice(r,this.length)}}},{key:"_createNewInstance",value:function(e){return new l.a(e)}},{key:"_processCollection",value:function(e,t){if(!t)return e;var r,i=this.itemFilterFunction?this.itemFilterFunction:function(e){return!!e},a=Object(n.a)(t);try{for(a.s();!(r=a.n()).done;){var o=r.value;if(o){if(i(o)){var s=this.indexOf(o,e);s>=0?s!==e&&this.reorder(o,e):this.add(o,e),++e}if(this.getChildrenFunction){var c=this.getChildrenFunction(o);if(Array.isArray(c)){var l,u=Object(n.a)(c);try{for(u.s();!(l=u.n()).done;){var d=l.value;e=this._processCollection(e,d)}}catch(h){u.e(h)}finally{u.f()}}else e=this._processCollection(e,c)}}}}catch(h){a.e(h)}finally{a.f()}return e}}]),r}(Object(u.b)(l.a));Object(c.a)([Object(h.b)()],b.prototype,"getCollections",void 0),Object(c.a)([Object(h.b)()],b.prototype,"getChildrenFunction",void 0),Object(c.a)([Object(h.b)()],b.prototype,"itemFilterFunction",void 0);var v=b=Object(c.a)([Object(f.a)("esri.core.CollectionFlattener")],b);t.a=v},function(e,t,r){"use strict";r.d(t,"a",(function(){return h})),r.d(t,"b",(function(){return f}));var n,i,a,o,s,c,l=r(12),u=r(323),d=r(11);function h(e,t){var r=e.vertex.code;t.verticalOffsetEnabled?(e.vertex.uniforms.add("verticalOffset","vec4"),t.screenSizePerspectiveEnabled&&(e.include(u.a),e.vertex.uniforms.add("screenSizePerspectiveAlignment","vec4")),r.add(Object(d.a)(n||(n=Object(l.a)(["\n    vec3 calculateVerticalOffset(vec3 worldPos, vec3 localOrigin) {\n      float viewDistance = length((view * vec4(worldPos, 1.0)).xyz);\n      ","\n      ","\n      // Screen sized offset in world space, used for example for line callouts\n      float worldOffset = clamp(verticalOffsetScreenHeight * verticalOffset.y * viewDistance, verticalOffset.z, verticalOffset.w);\n      return worldNormal * worldOffset;\n    }\n\n    vec3 addVerticalOffset(vec3 worldPos, vec3 localOrigin) {\n      return worldPos + calculateVerticalOffset(worldPos, localOrigin);\n    }\n    "])),1===t.viewingMode?Object(d.a)(i||(i=Object(l.a)(["vec3 worldNormal = normalize(worldPos + localOrigin);"]))):Object(d.a)(a||(a=Object(l.a)(["vec3 worldNormal = vec3(0.0, 0.0, 1.0);"]))),t.screenSizePerspectiveEnabled?Object(d.a)(o||(o=Object(l.a)(["\n          float cosAngle = dot(worldNormal, normalize(worldPos - camPos));\n          float verticalOffsetScreenHeight = screenSizePerspectiveScaleFloat(verticalOffset.x, abs(cosAngle), viewDistance, screenSizePerspectiveAlignment);"]))):Object(d.a)(s||(s=Object(l.a)(["\n          float verticalOffsetScreenHeight = verticalOffset.x;"])))))):r.add(Object(d.a)(c||(c=Object(l.a)(["vec3 addVerticalOffset(vec3 worldPos, vec3 localOrigin) { return worldPos; }"]))))}function f(e,t,r){if(t.verticalOffset){var n=p(t.verticalOffset,r.camera.fovY,r.camera.fullViewport[3]),i=r.camera.pixelRatio||1;e.setUniform4f("verticalOffset",n.screenLength*i,n.perDistance,n.minWorldLength,n.maxWorldLength)}}function p(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:b;return n.screenLength=e.screenLength,n.perDistance=Math.tan(.5*t)/(.5*r),n.minWorldLength=e.minWorldLength,n.maxWorldLength=e.maxWorldLength,n}var b={screenLength:0,perDistance:0,minWorldLength:0,maxWorldLength:0}},function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n,i,a={exports:{}};n=a,void 0!==(i=function(){function e(e,r,i){i=i||2;var a,o,s,l,u,d,h,f=r&&r.length,p=f?r[0]*i:e.length,b=t(e,0,p,i,!0),v=[];if(!b||b.next===b.prev)return v;if(f&&(b=c(e,r,b,i)),e.length>80*i){a=s=e[0],o=l=e[1];for(var m=i;m<p;m+=i)(u=e[m])<a&&(a=u),(d=e[m+1])<o&&(o=d),u>s&&(s=u),d>l&&(l=d);h=0!==(h=Math.max(s-a,l-o))?1/h:0}return n(b,v,i,a,o,h),v}function t(e,t,r,n,i){var a,o;if(i===T(e,t,r,n)>0)for(a=t;a<r;a+=n)o=x(a,e[a],e[a+1],o);else for(a=r-n;a>=t;a-=n)o=x(a,e[a],e[a+1],o);return o&&y(o,o.next)&&(k(o),o=o.next),o}function r(e,t){if(!e)return e;t||(t=e);var r,n=e;do{if(r=!1,n.steiner||!y(n,n.next)&&0!==m(n.prev,n,n.next))n=n.next;else{if(k(n),(n=t=n.prev)===n.next)break;r=!0}}while(r||n!==t);return t}function n(e,t,c,l,u,d,f){if(e){!f&&d&&h(e,l,u,d);for(var p,b,v=e;e.prev!==e.next;)if(p=e.prev,b=e.next,d?a(e,l,u,d):i(e))t.push(p.i/c),t.push(e.i/c),t.push(b.i/c),k(e),e=b.next,v=b.next;else if((e=b)===v){f?1===f?n(e=o(r(e),t,c),t,c,l,u,d,2):2===f&&s(e,t,c,l,u,d):n(r(e),t,c,l,u,d,1);break}}}function i(e){var t=e.prev,r=e,n=e.next;if(m(t,r,n)>=0)return!1;for(var i=e.next.next;i!==e.prev;){if(b(t.x,t.y,r.x,r.y,n.x,n.y,i.x,i.y)&&m(i.prev,i,i.next)>=0)return!1;i=i.next}return!0}function a(e,t,r,n){var i=e.prev,a=e,o=e.next;if(m(i,a,o)>=0)return!1;for(var s=i.x<a.x?i.x<o.x?i.x:o.x:a.x<o.x?a.x:o.x,c=i.y<a.y?i.y<o.y?i.y:o.y:a.y<o.y?a.y:o.y,l=i.x>a.x?i.x>o.x?i.x:o.x:a.x>o.x?a.x:o.x,u=i.y>a.y?i.y>o.y?i.y:o.y:a.y>o.y?a.y:o.y,d=f(s,c,t,r,n),h=f(l,u,t,r,n),p=e.prevZ,v=e.nextZ;p&&p.z>=d&&v&&v.z<=h;){if(p!==e.prev&&p!==e.next&&b(i.x,i.y,a.x,a.y,o.x,o.y,p.x,p.y)&&m(p.prev,p,p.next)>=0)return!1;if(p=p.prevZ,v!==e.prev&&v!==e.next&&b(i.x,i.y,a.x,a.y,o.x,o.y,v.x,v.y)&&m(v.prev,v,v.next)>=0)return!1;v=v.nextZ}for(;p&&p.z>=d;){if(p!==e.prev&&p!==e.next&&b(i.x,i.y,a.x,a.y,o.x,o.y,p.x,p.y)&&m(p.prev,p,p.next)>=0)return!1;p=p.prevZ}for(;v&&v.z<=h;){if(v!==e.prev&&v!==e.next&&b(i.x,i.y,a.x,a.y,o.x,o.y,v.x,v.y)&&m(v.prev,v,v.next)>=0)return!1;v=v.nextZ}return!0}function o(e,t,n){var i=e;do{var a=i.prev,o=i.next.next;!y(a,o)&&g(a,i,i.next,o)&&_(a,o)&&_(o,a)&&(t.push(a.i/n),t.push(i.i/n),t.push(o.i/n),k(i),k(i.next),i=e=o),i=i.next}while(i!==e);return r(i)}function s(e,t,i,a,o,s){var c=e;do{for(var l=c.next.next;l!==c.prev;){if(c.i!==l.i&&v(c,l)){var u=w(c,l);return c=r(c,c.next),u=r(u,u.next),n(c,t,i,a,o,s),void n(u,t,i,a,o,s)}l=l.next}c=c.next}while(c!==e)}function c(e,n,i,a){var o,s,c,d=[];for(o=0,s=n.length;o<s;o++)(c=t(e,n[o]*a,o<s-1?n[o+1]*a:e.length,a,!1))===c.next&&(c.steiner=!0),d.push(p(c));for(d.sort(l),o=0;o<d.length;o++)i=r(i=u(d[o],i),i.next);return i}function l(e,t){return e.x-t.x}function u(e,t){var n=function(e,t){var r,n=t,i=e.x,a=e.y,o=-1/0;do{if(a<=n.y&&a>=n.next.y&&n.next.y!==n.y){var s=n.x+(a-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(s<=i&&s>o){if(o=s,s===i){if(a===n.y)return n;if(a===n.next.y)return n.next}r=n.x<n.next.x?n:n.next}}n=n.next}while(n!==t);if(!r)return null;if(i===o)return r;var c,l=r,u=r.x,h=r.y,f=1/0;n=r;do{i>=n.x&&n.x>=u&&i!==n.x&&b(a<h?i:o,a,u,h,a<h?o:i,a,n.x,n.y)&&(c=Math.abs(a-n.y)/(i-n.x),_(n,e)&&(c<f||c===f&&(n.x>r.x||n.x===r.x&&d(r,n)))&&(r=n,f=c)),n=n.next}while(n!==l);return r}(e,t);if(!n)return t;var i=w(n,e),a=r(n,n.next);return r(i,i.next),t===n?a:t}function d(e,t){return m(e.prev,e,t.prev)<0&&m(t.next,e,e.next)<0}function h(e,t,r,n){var i=e;do{if(null===i.z&&(i.z=f(i.x,i.y,t,r,n)),i.prev.next!==i||i.next.prev!==i)return i.prev.next=i,i.next.prev=i,h(e,t,r,n);i.prevZ=i.prev,i.nextZ=i.next,i=i.next}while(i!==e);i.prevZ.nextZ=null,i.prevZ=null,function(e){var t,r,n,i,a,o,s,c,l=1;do{for(r=e,e=null,a=null,o=0;r;){for(o++,n=r,s=0,t=0;t<l&&(s++,n=n.nextZ);t++);for(c=l;s>0||c>0&&n;)0!==s&&(0===c||!n||r.z<=n.z)?(i=r,r=r.nextZ,s--):(i=n,n=n.nextZ,c--),a?a.nextZ=i:e=i,i.prevZ=a,a=i;r=n}a.nextZ=null,l*=2}while(o>1)}(i)}function f(e,t,r,n,i){return(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-r)*i)|e<<8))|e<<4))|e<<2))|e<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-n)*i)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function p(e){var t=e,r=e;do{(t.x<r.x||t.x===r.x&&t.y<r.y)&&(r=t),t=t.next}while(t!==e);return r}function b(e,t,r,n,i,a,o,s){return(i-o)*(t-s)-(e-o)*(a-s)>=0&&(e-o)*(n-s)-(r-o)*(t-s)>=0&&(r-o)*(a-s)-(i-o)*(n-s)>=0}function v(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!function(e,t){var r=e;do{if(r.i!==e.i&&r.next.i!==e.i&&r.i!==t.i&&r.next.i!==t.i&&g(r,r.next,e,t))return!0;r=r.next}while(r!==e);return!1}(e,t)&&(_(e,t)&&_(t,e)&&function(e,t){var r=e,n=!1,i=(e.x+t.x)/2,a=(e.y+t.y)/2;do{r.y>a!=r.next.y>a&&r.next.y!==r.y&&i<(r.next.x-r.x)*(a-r.y)/(r.next.y-r.y)+r.x&&(n=!n),r=r.next}while(r!==e);return n}(e,t)&&(m(e.prev,e,t.prev)||m(e,t.prev,t))||y(e,t)&&m(e.prev,e,e.next)>0&&m(t.prev,t,t.next)>0)}function m(e,t,r){return(t.y-e.y)*(r.x-t.x)-(t.x-e.x)*(r.y-t.y)}function y(e,t){return e.x===t.x&&e.y===t.y}function g(e,t,r,n){var i=j(m(e,t,r)),a=j(m(e,t,n)),o=j(m(r,n,e)),s=j(m(r,n,t));return i!==a&&o!==s||!(0!==i||!O(e,r,t))||!(0!==a||!O(e,n,t))||!(0!==o||!O(r,e,n))||!(0!==s||!O(r,t,n))}function O(e,t,r){return t.x<=Math.max(e.x,r.x)&&t.x>=Math.min(e.x,r.x)&&t.y<=Math.max(e.y,r.y)&&t.y>=Math.min(e.y,r.y)}function j(e){return e>0?1:e<0?-1:0}function _(e,t){return m(e.prev,e,e.next)<0?m(e,t,e.next)>=0&&m(e,e.prev,t)>=0:m(e,t,e.prev)<0||m(e,e.next,t)<0}function w(e,t){var r=new S(e.i,e.x,e.y),n=new S(t.i,t.x,t.y),i=e.next,a=t.prev;return e.next=t,t.prev=e,r.next=i,i.prev=r,n.next=r,r.prev=n,a.next=n,n.prev=a,n}function x(e,t,r,n){var i=new S(e,t,r);return n?(i.next=n.next,i.prev=n,n.next.prev=i,n.next=i):(i.prev=i,i.next=i),i}function k(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function S(e,t,r){this.i=e,this.x=t,this.y=r,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function T(e,t,r,n){for(var i=0,a=t,o=r-n;a<r;a+=n)i+=(e[o]-e[a])*(e[a+1]+e[o+1]),o=a;return i}return e.deviation=function(e,t,r,n){var i=t&&t.length,a=i?t[0]*r:e.length,o=Math.abs(T(e,0,a,r));if(i)for(var s=0,c=t.length;s<c;s++){var l=t[s]*r,u=s<c-1?t[s+1]*r:e.length;o-=Math.abs(T(e,l,u,r))}var d=0;for(s=0;s<n.length;s+=3){var h=n[s]*r,f=n[s+1]*r,p=n[s+2]*r;d+=Math.abs((e[h]-e[p])*(e[f+1]-e[h+1])-(e[h]-e[f])*(e[p+1]-e[h+1]))}return 0===o&&0===d?0:Math.abs((d-o)/o)},e.flatten=function(e){for(var t=e[0][0].length,r={vertices:[],holes:[],dimensions:t},n=0,i=0;i<e.length;i++){for(var a=0;a<e[i].length;a++)for(var o=0;o<t;o++)r.vertices.push(e[i][a][o]);i>0&&(n+=e[i-1].length,r.holes.push(n))}return r},e}())&&(n.exports=i);var o=a.exports},function(e,t,r){"use strict";r.d(t,"a",(function(){return h}));var n,i,a,o,s,c=r(12),l=r(321),u=r(145),d=r(11);function h(e,t){0===t.normalType||1===t.normalType?(e.include(l.a,t),e.varyings.add("vNormalWorld","vec3"),e.varyings.add("vNormalView","vec3"),e.vertex.uniforms.add("uTransformNormal_GlobalFromModel","mat3"),e.vertex.uniforms.add("uTransformNormal_ViewFromGlobal","mat3"),e.vertex.code.add(Object(d.a)(n||(n=Object(c.a)(["void forwardNormal() {\nvNormalWorld = uTransformNormal_GlobalFromModel * normalModel();\nvNormalView = uTransformNormal_ViewFromGlobal * vNormalWorld;\n}"]))))):2===t.normalType?(e.include(u.a,t),e.varyings.add("vNormalWorld","vec3"),e.vertex.code.add(Object(d.a)(i||(i=Object(c.a)(["\n    void forwardNormal() {\n      vNormalWorld = ","\n    }\n    "])),1===t.viewingMode?Object(d.a)(a||(a=Object(c.a)(["normalize(vPositionWorldCameraRelative);"]))):Object(d.a)(o||(o=Object(c.a)(["vec3(0.0, 0.0, 1.0);"])))))):e.vertex.code.add(Object(d.a)(s||(s=Object(c.a)(["void forwardNormal() {}"]))))}(h||(h={})).bindUniforms=function(e,t){e.setUniformMatrix4fv("viewNormal",t)}},function(e,t,r){"use strict";var n=r(2),i=r(6),a=r(7),o=r(0),s=r(58),c=r(27),l=r(1),u=(r(17),r(18),r(15),r(52)),d=r(10),h=new s.a({inherited:"inherited",codedValue:"coded-value",range:"range"}),f=function(e){Object(i.a)(r,e);var t=Object(a.a)(r);function r(e){var i;return Object(n.a)(this,r),(i=t.call(this,e)).name=null,i.type=null,i}return r}(c.a);Object(o.a)([Object(l.b)({type:String,json:{write:!0}})],f.prototype,"name",void 0),Object(o.a)([Object(u.a)(h)],f.prototype,"type",void 0);var p=f=Object(o.a)([Object(d.a)("esri.layers.support.Domain")],f);t.a=p},function(e,t,r){"use strict";r.d(t,"a",(function(){return p})),r.d(t,"b",(function(){return h})),r.d(t,"c",(function(){return v})),r.d(t,"d",(function(){return m})),r.d(t,"e",(function(){return d})),r.d(t,"f",(function(){return f}));var n=r(14),i=r(13),a=r(134),o=r(3),s=r(387),c=r(438),l=r(380),u=r(252),d={primitivesPerFeature:0,primitivesPerCoordinate:0,drawCallsPerFeature:0,estimated:!0,memory:{bytesPerFeature:0,bytesPerCoordinate:0,bytesPerFeatureLabel:0,draped:{bytesPerFeature:0,bytesPerFeatureLabel:0,bytesPerCoordinate:0}}};function h(e){return"web-style"===e.type?d:f(e.symbolLayers.toArray().map((function(t){return v(e,t)})))}function f(e){var t,r=0,n=0,a=0,s=!1,c=0,l={bytesPerFeature:0,bytesPerFeatureLabel:0,bytesPerCoordinate:0,draped:{bytesPerFeature:0,bytesPerFeatureLabel:0,bytesPerCoordinate:0}},u=Object(i.a)(e);try{for(u.s();!(t=u.n()).done;){var d=t.value;Object(o.i)(d)||(r+=d.primitivesPerFeature,n+=d.primitivesPerCoordinate,a+=d.drawCallsPerFeature,l.bytesPerFeature+=d.memory.bytesPerFeature,l.bytesPerFeatureLabel+=d.memory.bytesPerFeatureLabel,l.bytesPerCoordinate+=d.memory.bytesPerCoordinate,l.draped.bytesPerFeature+=d.memory.bytesPerFeature,l.draped.bytesPerFeatureLabel+=d.memory.bytesPerFeatureLabel,l.draped.bytesPerCoordinate+=d.memory.bytesPerCoordinate,s=s||d.estimated,++c)}}catch(h){u.e(h)}finally{u.f()}return{primitivesPerFeature:r,primitivesPerCoordinate:n,drawCallsPerFeature:a,estimated:s,memory:l,numComplexities:c}}function p(e){var t=f(e);return t.numComplexities>0&&(t.primitivesPerFeature/=t.numComplexities,t.primitivesPerCoordinate/=t.numComplexities,t.drawCallsPerFeature/=t.numComplexities,t.memory.bytesPerFeature/=t.numComplexities,t.memory.bytesPerFeatureLabel/=t.numComplexities,t.memory.bytesPerCoordinate/=t.numComplexities,t.memory.draped.bytesPerFeature/=t.numComplexities,t.memory.draped.bytesPerFeatureLabel/=t.numComplexities,t.memory.draped.bytesPerCoordinate/=t.numComplexities),t}var b={};function v(e,t){var r=m(e,t),i=Object(l.d)(t)?2:0;switch(t.type){case"extrude":return{primitivesPerFeature:-4,primitivesPerCoordinate:4,drawCallsPerFeature:i,estimated:!1,memory:r};case"fill":return"mesh-3d"===e.type?{primitivesPerFeature:0,primitivesPerCoordinate:0,drawCallsPerFeature:i,estimated:!1,memory:r}:Object(o.j)(t.outline)&&t.outline.size>0?{primitivesPerFeature:-4,primitivesPerCoordinate:3,drawCallsPerFeature:0,estimated:!1,memory:r}:{primitivesPerFeature:-2,primitivesPerCoordinate:1,drawCallsPerFeature:0,estimated:!1,memory:r};case"water":return{primitivesPerFeature:-2,primitivesPerCoordinate:1,drawCallsPerFeature:0,estimated:!1,memory:r};case"line":return{primitivesPerFeature:-2,primitivesPerCoordinate:2,drawCallsPerFeature:0,estimated:!1,memory:r};case"object":return t.resource&&t.resource.href?{primitivesPerFeature:16,primitivesPerCoordinate:0,drawCallsPerFeature:0,estimated:!0,memory:r}:Object(n.a)(Object(n.a)({},function(e){var t=b[e];if(t)return t;var r=Object(c.b)(e,null);return t={primitivesPerFeature:Object(u.b)(r.levels[0]).reduce((function(e,t){return e+t.indices.get("position").length/3}),0),primitivesPerCoordinate:0,drawCallsPerFeature:0,estimated:!1},b[e]=t,t}(t.resource&&t.resource.primitive||s.b)),{},{memory:r});case"path":var d=0,h=0;switch(t.profile){case"circle":d=10;break;case"quad":d=4;break;default:return void Object(a.a)(t.profile)}switch(t.join){case"round":h=3;break;case"miter":case"bevel":h=1;break;default:return void Object(a.a)(t.join)}var f=2*d,p=d*h*2,v=-2*p-f;switch(t.cap){case"none":break;case"butt":case"square":v+=2*(d-1);break;case"round":v+=2*(2*d*2+d);break;default:return}return{primitivesPerFeature:v,primitivesPerCoordinate:p+f,drawCallsPerFeature:0,estimated:!1,memory:r};case"text":case"icon":return{primitivesPerFeature:2,primitivesPerCoordinate:0,drawCallsPerFeature:0,estimated:!1,memory:r};default:return}}function m(e,t){var r="point-3d"===e.type;switch(t.type){case"extrude":return t.edges&&t.edges.size>0?y.EXTRUDE_EDGES:y.EXTRUDE;case"fill":return Object(o.j)(t.outline)&&t.outline.size>0?y.FILL_OUTLINE:y.FILL;case"water":return y.FILL;case"line":return"round"===t.join?y.LINE_ROUND:y.LINE_MITER;case"path":switch(t.join){case"round":switch(t.profile){case"circle":return y.PATH_ROUND_CIRCLE;case"quad":return y.PATH_ROUND_QUAD;default:return void Object(a.a)(t.profile)}case"miter":case"bevel":switch(t.profile){case"circle":return y.PATH_MITER_CIRCLE;case"quad":return y.PATH_MITER_QUAD;default:return void Object(a.a)(t.profile)}default:return void Object(a.a)(t.join)}case"object":return r?y.OBJECT_POINT:y.OBJECT_POLYGON;case"icon":case"text":return r?y.ICON_POINT:y.ICON_POLYGON;default:return}}var y={ICON_POINT:{bytesPerFeature:7127.413186968842,bytesPerFeatureLabel:4826.302896296296,bytesPerCoordinate:0,draped:{bytesPerFeature:3929.4396628895197,bytesPerFeatureLabel:3550.1332222222227,bytesPerCoordinate:0}},ICON_POLYGON:{bytesPerFeature:9329.452613976147,bytesPerFeatureLabel:3675.3372604938268,bytesPerCoordinate:60.177252982212096,draped:{bytesPerFeature:6190.247450139383,bytesPerFeatureLabel:3744.074358024691,bytesPerCoordinate:59.488211068026104}},OBJECT_POINT:{bytesPerFeature:2350.5884192634558,bytesPerFeatureLabel:4446.651003703703,bytesPerCoordinate:0,draped:{bytesPerFeature:2350.5884192634558,bytesPerFeatureLabel:4446.651003703703,bytesPerCoordinate:0}},OBJECT_POLYGON:{bytesPerFeature:4583.807620302299,bytesPerFeatureLabel:3665.342685185186,bytesPerCoordinate:60.11621818101506,draped:{bytesPerFeature:4583.807620302299,bytesPerFeatureLabel:3665.342685185186,bytesPerCoordinate:60.11621818101506}},LINE_MITER:{bytesPerFeature:7321.028181375921,bytesPerFeatureLabel:4048.0226716049388,bytesPerCoordinate:186.55621386363578,draped:{bytesPerFeature:4246.856619435009,bytesPerFeatureLabel:3852.3737679012347,bytesPerCoordinate:163.47884002621583}},LINE_ROUND:{bytesPerFeature:7482.205842738954,bytesPerFeatureLabel:4045.886987654321,bytesPerCoordinate:191.5452524171851,draped:{bytesPerFeature:4473.481387957992,bytesPerFeatureLabel:3842.1112395061728,bytesPerCoordinate:167.27703460226945}},PATH_MITER_CIRCLE:{bytesPerFeature:9010.489006415351,bytesPerFeatureLabel:4230.9109,bytesPerCoordinate:4618.2594178027275,draped:{bytesPerFeature:9010.489006415351,bytesPerFeatureLabel:4230.9109,bytesPerCoordinate:4618.2594178027275}},PATH_ROUND_CIRCLE:{bytesPerFeature:4104.727250200398,bytesPerFeatureLabel:4251.8525,bytesPerCoordinate:8019.043777064957,draped:{bytesPerFeature:4104.727250200398,bytesPerFeatureLabel:4251.8525,bytesPerCoordinate:8019.043777064957}},PATH_MITER_QUAD:{bytesPerFeature:9416.372942261387,bytesPerFeatureLabel:4241.2757,bytesPerCoordinate:3176.7222742582203,draped:{bytesPerFeature:9416.372942261387,bytesPerFeatureLabel:4241.2757,bytesPerCoordinate:3176.7222742582203}},PATH_ROUND_QUAD:{bytesPerFeature:6614.431545308682,bytesPerFeatureLabel:4206.7461,bytesPerCoordinate:5141.817789093826,draped:{bytesPerFeature:6614.431545308682,bytesPerFeatureLabel:4206.7461,bytesPerCoordinate:5141.817789093826}},FILL:{bytesPerFeature:9478.244183633637,bytesPerFeatureLabel:3713.816824691358,bytesPerCoordinate:95.9343604185578,draped:{bytesPerFeature:6287.911108168086,bytesPerFeatureLabel:3790.785032098766,bytesPerCoordinate:83.08783220478168}},FILL_OUTLINE:{bytesPerFeature:13085.871870349445,bytesPerFeatureLabel:3392.613241975309,bytesPerCoordinate:118.63968023169875,draped:{bytesPerFeature:8437.199992480122,bytesPerFeatureLabel:3973.5431172839503,bytesPerCoordinate:106.33556817014312}},EXTRUDE:{bytesPerFeature:19459.53727140414,bytesPerFeatureLabel:3743.7045209876546,bytesPerCoordinate:372.6819978900477,draped:{bytesPerFeature:19459.53727140414,bytesPerFeatureLabel:3743.7045209876546,bytesPerCoordinate:372.6819978900477}},EXTRUDE_EDGES:{bytesPerFeature:22266.888534913724,bytesPerFeatureLabel:3064.3193358024696,bytesPerCoordinate:374.3725221561312,draped:{bytesPerFeature:22266.888534913724,bytesPerFeatureLabel:3064.3193358024696,bytesPerCoordinate:374.3725221561312}}}},function(e,t,r){"use strict";r.d(t,"a",(function(){return W}));var n,i=r(8),a=r.n(i),o=r(16),s=r(13),c=r(2),l=r(5),u=r(6),d=r(7),h=r(0),f=r(1),p=(r(17),r(18)),b=r(15),v=r(48),m=r(10),y=r(44),g=r(103),O=r(45),j=r(42),_=r(291),w=r(605),x=n=function(e){Object(u.a)(r,e);var t=Object(d.a)(r);function r(e){var n;return Object(c.a)(this,r),(n=t.call(this,e)).type="color",n.normalizationField=null,n}return Object(l.a)(r,[{key:"cache",get:function(){return{ipData:this._interpolateData(),hasExpression:!!this.valueExpression,compiledFunc:null}}},{key:"stops",set:function(e){e&&Array.isArray(e)&&(e=e.filter((function(e){return!!e}))).sort((function(e,t){return e.value-t.value})),this._set("stops",e)}},{key:"clone",value:function(){return new n({field:this.field,normalizationField:this.normalizationField,valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle,stops:this.stops&&this.stops.map((function(e){return e.clone()})),legendOptions:this.legendOptions&&this.legendOptions.clone()})}},{key:"getAttributeHash",value:function(){return"".concat(Object(O.a)(Object(j.a)(r.prototype),"getAttributeHash",this).call(this),"-").concat(this.normalizationField)}},{key:"_interpolateData",value:function(){return this.stops&&this.stops.map((function(e){return e.value||0}))}}]),r}(_.a);Object(h.a)([Object(f.b)({readOnly:!0})],x.prototype,"cache",null),Object(h.a)([Object(f.b)({type:["color"],json:{type:["colorInfo"]}})],x.prototype,"type",void 0),Object(h.a)([Object(f.b)({type:String,json:{write:!0}})],x.prototype,"normalizationField",void 0),Object(h.a)([Object(f.b)({type:[w.a],json:{write:!0}})],x.prototype,"stops",null);var k,S=x=n=Object(h.a)([Object(m.a)("esri.renderers.visualVariables.ColorVariable")],x),T=r(27),C=r(248),M=k=function(e){Object(u.a)(r,e);var t=Object(d.a)(r);function r(e){var n;return Object(c.a)(this,r),(n=t.call(this,e)).label=null,n.opacity=null,n.value=null,n}return Object(l.a)(r,[{key:"readOpacity",value:function(e,t){return Object(C.b)(t.transparency)}},{key:"writeOpacity",value:function(e,t,r){t[r]=Object(C.a)(e)}},{key:"clone",value:function(){return new k({label:this.label,opacity:this.opacity,value:this.value})}}]),r}(T.a);Object(h.a)([Object(f.b)({type:String,json:{write:!0}})],M.prototype,"label",void 0),Object(h.a)([Object(f.b)({type:Number,json:{type:p.a,write:{target:"transparency"}}})],M.prototype,"opacity",void 0),Object(h.a)([Object(v.a)("opacity",["transparency"])],M.prototype,"readOpacity",null),Object(h.a)([Object(y.a)("opacity")],M.prototype,"writeOpacity",null),Object(h.a)([Object(f.b)({type:Number,json:{write:!0}})],M.prototype,"value",void 0);var P,A=M=k=Object(h.a)([Object(m.a)("esri.renderers.visualVariables.support.OpacityStop")],M),E=P=function(e){Object(u.a)(r,e);var t=Object(d.a)(r);function r(e){var n;return Object(c.a)(this,r),(n=t.call(this,e)).type="opacity",n.normalizationField=null,n}return Object(l.a)(r,[{key:"cache",get:function(){return{ipData:this._interpolateData(),hasExpression:!!this.valueExpression,compiledFunc:null}}},{key:"stops",set:function(e){e&&Array.isArray(e)&&(e=e.filter((function(e){return!!e}))).sort((function(e,t){return e.value-t.value})),this._set("stops",e)}},{key:"clone",value:function(){return new P({field:this.field,normalizationField:this.normalizationField,valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle,stops:this.stops&&this.stops.map((function(e){return e.clone()})),legendOptions:this.legendOptions&&this.legendOptions.clone()})}},{key:"getAttributeHash",value:function(){return"".concat(Object(O.a)(Object(j.a)(r.prototype),"getAttributeHash",this).call(this),"-").concat(this.normalizationField)}},{key:"_interpolateData",value:function(){return this.stops&&this.stops.map((function(e){return e.value||0}))}}]),r}(_.a);Object(h.a)([Object(f.b)({readOnly:!0})],E.prototype,"cache",null),Object(h.a)([Object(f.b)({type:["opacity"],json:{type:["transparencyInfo"]}})],E.prototype,"type",void 0),Object(h.a)([Object(f.b)({type:String,json:{write:!0}})],E.prototype,"normalizationField",void 0),Object(h.a)([Object(f.b)({type:[A],json:{write:!0}})],E.prototype,"stops",null);var R=E=P=Object(h.a)([Object(m.a)("esri.renderers.visualVariables.OpacityVariable")],E),I=r(488),D=r(462),F=r(30),L=r(58),z=r(192),V=b.a.getLogger("esri.renderers.visualVariables.VisualVariableFactory"),N={color:S,size:D.a,opacity:R,rotation:I.a},U=new L.a({colorInfo:"color",transparencyInfo:"opacity",rotationInfo:"rotation",sizeInfo:"size"}),B=/^\[([^\]]+)\]$/i,G=function(e){Object(u.a)(r,e);var t=Object(d.a)(r);function r(){var e;return Object(c.a)(this,r),(e=t.apply(this,arguments)).colorVariables=null,e.opacityVariables=null,e.rotationVariables=null,e.sizeVariables=null,e}return Object(l.a)(r,[{key:"visualVariables",set:function(e){if(this._resetVariables(),(e=e&&e.filter((function(e){return!!e})))&&e.length){var t,r=Object(s.a)(e);try{for(r.s();!(t=r.n()).done;){var n=t.value;switch(n.type){case"color":this.colorVariables.push(n);break;case"opacity":this.opacityVariables.push(n);break;case"rotation":this.rotationVariables.push(n);break;case"size":this.sizeVariables.push(n)}}}catch(a){r.e(a)}finally{r.f()}this.sizeVariables.length&&this.sizeVariables.some((function(e){return!!e.target}))&&e.sort((function(e,t){return e.target===t.target?0:e.target?1:-1}));for(var i=0;i<e.length;i++)e[i].index=i;this._set("visualVariables",e)}else this._set("visualVariables",e)}},{key:"readVariables",value:function(e,t,r){var n=t.rotationExpression,i=t.rotationType,a=n&&n.match(B),o=a&&a[1];if(o&&(e||(e=[]),e.push({type:"rotationInfo",rotationType:i,field:o})),e)return e.map((function(e){var t=U.read(e.type),n=N[t];n||(V.warn("Unknown variable type: ".concat(t)),r&&r.messages&&r.messages.push(new z.a("visual-variable:unsupported","visualVariable of type '".concat(t,"' is not supported"),{definition:e,context:r})));var i=new n;return i.read(e,r),i}))}},{key:"writeVariables",value:function(e,t){var r,n=[],i=Object(s.a)(e);try{for(i.s();!(r=i.n()).done;){var a=r.value.toJSON(t);a&&n.push(a)}}catch(o){i.e(o)}finally{i.f()}return n}},{key:"_resetVariables",value:function(){this.colorVariables=[],this.opacityVariables=[],this.rotationVariables=[],this.sizeVariables=[]}}]),r}(F.a);Object(h.a)([Object(f.b)()],G.prototype,"visualVariables",null);var q=G=Object(h.a)([Object(m.a)("esri.renderers.visualVariables.VisualVariableFactory")],G),H={base:_.a,key:"type",typeMap:{opacity:R,color:S,rotation:I.a,size:D.a}},W=function(e){var t=function(e){Object(u.a)(r,e);var t=Object(d.a)(r);function r(){var e;return Object(c.a)(this,r),(e=t.apply(this,arguments))._vvFactory=new q,e}return Object(l.a)(r,[{key:"visualVariables",set:function(e){this._vvFactory.visualVariables=e,this._set("visualVariables",this._vvFactory.visualVariables)}},{key:"readVisualVariables",value:function(e,t,r){return this._vvFactory.readVariables(e,t,r)}},{key:"writeVisualVariables",value:function(e,t,r,n){t[r]=this._vvFactory.writeVariables(e,n)}},{key:"arcadeRequiredForVisualVariables",get:function(){if(!this.visualVariables)return!1;var e,t=Object(s.a)(this.visualVariables);try{for(t.s();!(e=t.n()).done;){if(e.value.arcadeRequired)return!0}}catch(r){t.e(r)}finally{t.f()}return!1}},{key:"hasVisualVariables",value:function(e,t){return e?!!this.getVisualVariablesForType(e,t):!!(this.getVisualVariablesForType("size",t)||this.getVisualVariablesForType("color",t)||this.getVisualVariablesForType("opacity",t)||this.getVisualVariablesForType("rotation",t))}},{key:"getVisualVariablesForType",value:function(e,t){var r=this.visualVariables;if(r){var n=r.filter((function(r){return r.type===e&&("string"==typeof t?r.target===t:!1!==t||!r.target)}));return n&&0===n.length?void 0:n}}},{key:"collectVVRequiredFields",value:function(){var e=Object(o.a)(a.a.mark((function e(t,r){var n,i,o,c;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=[],this.visualVariables&&(n=n.concat(this.visualVariables)),i=Object(s.a)(n),e.prev=3,i.s();case 5:if((o=i.n()).done){e.next=17;break}if(c=o.value,e.t0=c,!e.t0){e.next=15;break}if(c.field&&Object(g.d)(t,r,c.field),c.normalizationField&&Object(g.d)(t,r,c.normalizationField),e.t1=c.valueExpression,!e.t1){e.next=15;break}return e.next=15,Object(g.a)(t,r,c.valueExpression);case 15:e.next=5;break;case 17:e.next=22;break;case 19:e.prev=19,e.t2=e.catch(3),i.e(e.t2);case 22:return e.prev=22,i.f(),e.finish(22);case 25:case"end":return e.stop()}}),e,this,[[3,19,22,25]])})));return function(t,r){return e.apply(this,arguments)}}()}]),r}(e);return Object(h.a)([Object(f.b)({types:[H],value:null,json:{write:!0}})],t.prototype,"visualVariables",null),Object(h.a)([Object(v.a)("visualVariables",["visualVariables","rotationType","rotationExpression"])],t.prototype,"readVisualVariables",null),Object(h.a)([Object(y.a)("visualVariables")],t.prototype,"writeVisualVariables",null),t=Object(h.a)([Object(m.a)("esri.renderers.mixins.VisualVariablesMixin")],t)}},function(e,t,r){"use strict";function n(e){return(n="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}r.d(t,"a",(function(){return a}));var i=r(19);function a(e,t){return!t||"object"!==n(t)&&"function"!==typeof t?Object(i.a)(e):t}},function(e,t,r){"use strict";var n,i=r(2),a=r(5),o=r(6),s=r(7),c=r(0),l=r(1),u=(r(17),r(18),r(15),r(10)),d=r(181),h=n=function(e){Object(o.a)(r,e);var t=Object(s.a)(r);function r(e){var n;return Object(i.a)(this,r),(n=t.call(this,e)).description=null,n.displayType=null,n.title=null,n.type="attachments",n}return Object(a.a)(r,[{key:"clone",value:function(){return new n({description:this.description,displayType:this.displayType,title:this.title})}}]),r}(d.a);Object(c.a)([Object(l.b)({json:{write:!0,origins:{"web-scene":{write:!1,read:!1}}}})],h.prototype,"description",void 0),Object(c.a)([Object(l.b)({type:["preview","list"],json:{write:!0}})],h.prototype,"displayType",void 0),Object(c.a)([Object(l.b)({json:{write:!0,origins:{"web-scene":{write:!1,read:!1}}}})],h.prototype,"title",void 0),Object(c.a)([Object(l.b)({type:["attachments"],readOnly:!0,json:{read:!1,write:!0}})],h.prototype,"type",void 0);var f=h=n=Object(c.a)([Object(u.a)("esri.popup.content.AttachmentsContent")],h);t.a=f},function(e,t,r){"use strict";var n,i=r(2),a=r(5),o=r(6),s=r(7),c=r(0),l=r(58),u=r(27),d=r(25),h=r(1),f=(r(18),r(17),r(15),r(52)),p=r(10),b=r(338),v=n=function(e){Object(o.a)(r,e);var t=Object(s.a)(r);function r(e){var n;return Object(i.a)(this,r),(n=t.call(this,e)).fieldName=null,n.format=null,n.isEditable=!1,n.label=null,n.stringFieldOption="text-box",n.statisticType=null,n.tooltip=null,n.visible=!0,n}return Object(a.a)(r,[{key:"clone",value:function(){return new n({fieldName:this.fieldName,format:this.format?Object(d.a)(this.format):null,isEditable:this.isEditable,label:this.label,stringFieldOption:this.stringFieldOption,statisticType:this.statisticType,tooltip:this.tooltip,visible:this.visible})}}]),r}(u.a);Object(c.a)([Object(h.b)({type:String,json:{write:!0}})],v.prototype,"fieldName",void 0),Object(c.a)([Object(h.b)({type:b.a,json:{write:!0}})],v.prototype,"format",void 0),Object(c.a)([Object(h.b)({type:Boolean,json:{write:!0,default:!1}})],v.prototype,"isEditable",void 0),Object(c.a)([Object(h.b)({type:String,json:{write:!0}})],v.prototype,"label",void 0),Object(c.a)([Object(f.a)(new l.a({richtext:"rich-text",textarea:"text-area",textbox:"text-box"}),{default:"text-box"})],v.prototype,"stringFieldOption",void 0),Object(c.a)([Object(h.b)({type:["count","sum","min","max","avg","stddev","var"],json:{write:!0}})],v.prototype,"statisticType",void 0),Object(c.a)([Object(h.b)({type:String,json:{write:!0}})],v.prototype,"tooltip",void 0),Object(c.a)([Object(h.b)({type:Boolean,json:{write:!0}})],v.prototype,"visible",void 0);var m=v=n=Object(c.a)([Object(p.a)("esri.popup.FieldInfo")],v);t.a=m},function(e,t,r){"use strict";var n,i=r(8),a=r.n(i),o=r(16),s=r(2),c=r(5),l=r(6),u=r(7),d=r(0),h=r(25),f=r(147),p=r(1),b=(r(18),r(17),r(15),r(52)),v=r(48),m=r(10),y=r(44),g=r(103),O=r(135),j=n=function(e){Object(l.a)(r,e);var t=Object(u.a)(r);function r(e){var n;return Object(s.a)(this,r),(n=t.call(this,e)).data=null,n.type="cim",n}return Object(c.a)(r,[{key:"readData",value:function(e,t){return t}},{key:"writeData",value:function(e,t){if(e)for(var r in e)t[r]=e[r]}},{key:"collectRequiredFields",value:function(){var e=Object(o.a)(a.a.mark((function e(t,r){var n,i;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("CIMSymbolReference"!==this.data.type){e.next=6;break}if(!(n=this.data.primitiveOverrides)){e.next=6;break}return i=n.map((function(e){var n=e.valueExpressionInfo;return Object(g.a)(t,r,n.expression)})),e.next=6,Promise.all(i);case 6:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"clone",value:function(){return new n({data:Object(h.a)(this.data)})}},{key:"hash",value:function(){return Object(f.b)(JSON.stringify(this.data)).toString()}}]),r}(O.a);Object(d.a)([Object(p.b)({json:{write:!1}})],j.prototype,"color",void 0),Object(d.a)([Object(p.b)({json:{write:!0}})],j.prototype,"data",void 0),Object(d.a)([Object(v.a)("data",["symbol"])],j.prototype,"readData",null),Object(d.a)([Object(y.a)("data")],j.prototype,"writeData",null),Object(d.a)([Object(b.a)({CIMSymbolReference:"cim"},{readOnly:!0})],j.prototype,"type",void 0);var _=j=n=Object(d.a)([Object(m.a)("esri.symbols.CIMSymbol")],j);t.a=_},function(e,t,r){"use strict";var n=r(2),i=r(5),a=r(6),o=r(7),s=r(0),c=r(58),l=r(27),u=r(15),d=r(1),h=(r(17),r(64)),f=r(10),p=r(18),b=r(519),v=u.a.getLogger("esri.renderers.visualVariables.VisualVariable"),m=new c.a({colorInfo:"color",transparencyInfo:"opacity",rotationInfo:"rotation",sizeInfo:"size"}),y=function(e){Object(a.a)(r,e);var t=Object(o.a)(r);function r(e){var i;return Object(n.a)(this,r),(i=t.call(this,e)).index=null,i.type=null,i.field=null,i.valueExpression=null,i.valueExpressionTitle=null,i.legendOptions=null,i}return Object(i.a)(r,[{key:"castField",value:function(e){return null==e?e:"function"==typeof e?(v.error(".field: field must be a string value"),null):Object(p.l)(e)}},{key:"arcadeRequired",get:function(){return!!this.valueExpression}},{key:"clone",value:function(){}},{key:"getAttributeHash",value:function(){return"".concat(this.type,"-").concat(this.field,"-").concat(this.valueExpression)}}]),r}(l.a);Object(s.a)([Object(d.b)()],y.prototype,"index",void 0),Object(s.a)([Object(d.b)({type:m.apiValues,readOnly:!0,json:{read:m.read,write:m.write}})],y.prototype,"type",void 0),Object(s.a)([Object(d.b)({type:String,json:{write:!0}})],y.prototype,"field",void 0),Object(s.a)([Object(h.a)("field")],y.prototype,"castField",null),Object(s.a)([Object(d.b)({type:String,json:{write:!0}})],y.prototype,"valueExpression",void 0),Object(s.a)([Object(d.b)({type:String,json:{write:!0}})],y.prototype,"valueExpressionTitle",void 0),Object(s.a)([Object(d.b)({readOnly:!0})],y.prototype,"arcadeRequired",null),Object(s.a)([Object(d.b)({type:b.a,json:{write:!0}})],y.prototype,"legendOptions",void 0);var g=y=Object(s.a)([Object(f.a)("esri.renderers.visualVariables.VisualVariable")],y);t.a=g},function(e,t,r){"use strict";var n,i=r(2),a=r(5),o=r(6),s=r(7),c=r(0),l=r(3),u=r(1),d=(r(17),r(18),r(15),r(52)),h=r(10),f=r(161),p=r(387),b=r(30),v=n=function(e){Object(o.a)(r,e);var t=Object(s.a)(r);function r(){var e;return Object(i.a)(this,r),(e=t.apply(this,arguments)).x=0,e.y=0,e.z=0,e}return Object(a.a)(r,[{key:"clone",value:function(){return new n({x:this.x,y:this.y,z:this.z})}}]),r}(b.a);Object(c.a)([Object(u.b)({type:Number})],v.prototype,"x",void 0),Object(c.a)([Object(u.b)({type:Number})],v.prototype,"y",void 0),Object(c.a)([Object(u.b)({type:Number})],v.prototype,"z",void 0);v=n=Object(c.a)([Object(h.a)("esri.symbols.support.Symbol3DAnchorPosition3D")],v);var m,y=r(198),g=m=function(e){Object(o.a)(r,e);var t=Object(s.a)(r);function r(e){var n;return Object(i.a)(this,r),(n=t.call(this,e)).material=null,n.castShadows=!0,n.resource=null,n.type="object",n.width=void 0,n.height=void 0,n.depth=void 0,n.anchor=void 0,n.anchorPosition=void 0,n.heading=void 0,n.tilt=void 0,n.roll=void 0,n}return Object(a.a)(r,[{key:"clone",value:function(){return new m({heading:this.heading,tilt:this.tilt,roll:this.roll,anchor:this.anchor,anchorPosition:this.anchorPosition&&this.anchorPosition.clone(),depth:this.depth,enabled:this.enabled,height:this.height,material:Object(l.j)(this.material)?this.material.clone():null,castShadows:this.castShadows,resource:this.resource&&this.resource.clone(),width:this.width})}},{key:"isPrimitive",get:function(){return!this.resource||"string"!=typeof this.resource.href}}]),r}(f.a);Object(c.a)([Object(u.b)({type:y.a,json:{write:!0}})],g.prototype,"material",void 0),Object(c.a)([Object(u.b)({type:Boolean,nonNullable:!0,json:{write:!0,default:!0}})],g.prototype,"castShadows",void 0),Object(c.a)([Object(u.b)({type:p.a,json:{write:!0}})],g.prototype,"resource",void 0),Object(c.a)([Object(d.a)({Object:"object"},{readOnly:!0})],g.prototype,"type",void 0),Object(c.a)([Object(u.b)({type:Number,json:{write:!0}})],g.prototype,"width",void 0),Object(c.a)([Object(u.b)({type:Number,json:{write:!0}})],g.prototype,"height",void 0),Object(c.a)([Object(u.b)({type:Number,json:{write:!0}})],g.prototype,"depth",void 0),Object(c.a)([Object(d.a)({center:"center",top:"top",bottom:"bottom",origin:"origin",relative:"relative"}),Object(u.b)({json:{default:"origin"}})],g.prototype,"anchor",void 0),Object(c.a)([Object(u.b)({type:v,json:{type:[Number],read:{reader:function(e){return new v({x:e[0],y:e[1],z:e[2]})}},write:{writer:function(e,t){t.anchorPosition=[e.x,e.y,e.z]},overridePolicy:function(){return{enabled:"relative"===this.anchor}}}}})],g.prototype,"anchorPosition",void 0),Object(c.a)([Object(u.b)({type:Number,json:{write:!0}})],g.prototype,"heading",void 0),Object(c.a)([Object(u.b)({type:Number,json:{write:!0}})],g.prototype,"tilt",void 0),Object(c.a)([Object(u.b)({type:Number,json:{write:!0}})],g.prototype,"roll",void 0),Object(c.a)([Object(u.b)({readOnly:!0})],g.prototype,"isPrimitive",null);var O=g=m=Object(c.a)([Object(h.a)("esri.symbols.ObjectSymbol3DLayer")],g);t.a=O},function(e,t,r){"use strict";r.d(t,"a",(function(){return s})),r.d(t,"b",(function(){return h})),r.d(t,"c",(function(){return f})),r.d(t,"d",(function(){return p})),r.d(t,"e",(function(){return b}));var n=r(33);r(100);var i=function(e,t,r){return[t,r]},a=function(e,t,r){return[t,r,e[2]]},o=function(e,t,r){return[t,r,e[2],e[3]]};function s(e){return e?{originPosition:"upper-left"===e.originPosition?"upperLeft":"lower-left"===e.originPosition?"lowerLeft":e.originPosition,scale:e.tolerance?[e.tolerance,e.tolerance]:[1,1],translate:e.extent?[e.extent.xmin,e.extent.ymax]:[0,0]}:null}function c(e,t){var r=e.scale,n=e.translate;return t*r[0]+n[0]}function l(e,t){var r=e.scale;return e.translate[1]-t*r[1]}function u(e,t,r){var i=new Array(r.length);if(!r.length)return i;var a=Object(n.a)(e.scale,2),o=a[0],s=a[1],u=c(e,r[0][0]),d=l(e,r[0][1]);i[0]=t(r[0],u,d);for(var h=1;h<r.length;h++){var f=r[h];u+=f[0]*o,d-=f[1]*s,i[h]=t(f,u,d)}return i}function d(e,t,r){for(var n=new Array(r.length),i=0;i<r.length;i++)n[i]=u(e,t,r[i]);return n}function h(e,t,r,n,s){return t.points=function(e,t,r,n){return u(e,r?n?o:a:n?a:i,t)}(e,r.points,n,s),t}function f(e,t,r,n,i){return t.x=c(e,r.x),t.y=l(e,r.y),t!==r&&(n&&(t.z=r.z),i&&(t.m=r.m)),t}function p(e,t,r,n,s){return t.rings=function(e,t,r,n){return d(e,r?n?o:a:n?a:i,t)}(e,r.rings,n,s),t}function b(e,t,r,n,s){return t.paths=function(e,t,r,n){return d(e,r?n?o:a:n?a:i,t)}(e,r.paths,n,s),t}},function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r(2),i=r(9),a=function e(t,r){Object(n.a)(this,e),this.vec3=t,this.id=r};function o(e,t,r,n){return new a(Object(i.g)(e,t,r),n)}},function(e,t,r){"use strict";r.d(t,"a",(function(){return J}));var n=r(14),i=r(2),a=r(5),o=r(6),s=r(7),c=r(20),l=r(3),u=r(28),d=r(67),h=r(96),f=r(26),p=r(31),b=r(29),v=r(38),m=r(4),y=r(9);function g(e){return(t=e)instanceof Float32Array&&t.length>=16||function(e){return Array.isArray(e)&&e.length>=16}(e);var t}var O=r(40),j=r(108),_=r(150),w=r(469),x=r(116),k=r(230),S=r(46),T=r(151),C=r(102),M=r(136),P=r(377),A=r(0),E=r(76),R=r(281),I=r(318),D=r(109),F=r(324),L=r(112),z=r(197),V=r(323),N=r(106),U=r(91),B=r(95),G=r(24),q=r(77),H=r(89),W=r(88),Q=r(41),Z=function(e){Object(o.a)(r,e);var t=Object(s.a)(r);function r(){return Object(i.a)(this,r),t.apply(this,arguments)}return Object(a.a)(r,[{key:"initializeProgram",value:function(e){var t=r.shader.get(),n=this.configuration,i=t.build({output:n.output,FrontFacePass:2===n.transparencyPassType,viewingMode:e.viewingMode,occlusionTestEnabled:n.occlusionTestEnabled,signedDistanceFieldEnabled:n.sdf,slicePlaneEnabled:n.slicePlaneEnabled,sliceHighlightDisabled:!1,sliceEnabledForVertexPrograms:!0,debugDrawBorder:n.debugDrawBorder,binaryHighlightOcclusionEnabled:n.binaryHighlightOcclusion,screenCenterOffsetUnitsEnabled:n.screenCenterOffsetUnitsEnabled,screenSizePerspectiveEnabled:n.screenSizePerspective,verticalOffsetEnabled:n.verticalOffset,pixelSnappingEnabled:n.pixelSnappingEnabled,vvSize:n.vvSize,vvColor:n.vvColor,vvInstancingEnabled:!1,isDraped:n.isDraped,multipassGeometryEnabled:n.multipassGeometryEnabled,multipassTerrainEnabled:n.multipassTerrainEnabled,cullAboveGround:n.cullAboveGround});return new W.a(e.rctx,i,q.a)}},{key:"bindPass",value:function(e,t){Object(N.c)(this.program,t.camera.projectionMatrix),this.program.setUniform1f("cameraGroundRelative",t.camera.aboveGround?1:-1),this.program.setUniform1f("perDistancePixelRatio",Math.tan(t.camera.fovY/2)/(t.camera.fullViewport[2]/2)),this.program.setUniformMatrix4fv("viewNormal",t.camera.viewInverseTransposeMatrix),this.program.setUniform1f("polygonOffset",e.shaderPolygonOffset),Object(R.b)(this.program,e,t),Object(V.b)(this.program,e),this.program.setUniform1f("pixelRatio",t.camera.pixelRatio||1),Object(N.f)(this.program,t),6===this.configuration.output?(this.program.setUniform2fv("cameraNearFar",t.camera.nearFar),this.program.setUniform2fv("inverseViewport",t.inverseViewport),Object(F.a)(this.program,t),Object(L.a)(this.program,t)):(Object(I.b)(this.program,t),Object(P.c)(this.program,e,t.camera.pixelRatio||1),Object(z.b)(this.program,e),this.configuration.occlusionTestEnabled&&this.program.bindTexture(t.hudVisibilityTexture,"hudVisibilityTexture")),4===this.configuration.output&&Object(D.b)(this.program,t)}},{key:"bindDraw",value:function(e){Object(N.d)(this.program,e),Object(N.a)(this.program,e.origin,e.camera.viewInverseTransposeMatrix),Object(E.c)(this.program,this.configuration,e),this.program.rebindTextures()}},{key:"setPipelineState",value:function(e){var t=this.configuration,r=3===e,n=2===e,i=this.configuration.polygonOffsetEnabled&&X,a=(r||n)&&4!==t.output?(t.depthEnabled||6===t.output)&&Q.e:null;return Object(Q.g)({blending:0===t.output||7===t.output||4===t.output?r?Y:Object(H.a)(e):null,depthTest:{func:515},depthWrite:a,colorWrite:Q.d,polygonOffset:i})}},{key:"initializePipeline",value:function(){return this.setPipelineState(this.configuration.transparencyPassType)}},{key:"primitiveType",get:function(){return 6===this.configuration.output?0:4}}]),r}(B.a);Z.shader=new U.a(P.a,(function(){return r.e(198).then(r.bind(null,1060))}));var X={factor:0,units:-4},Y=Object(Q.i)(1,771),$=function(e){Object(o.a)(r,e);var t=Object(s.a)(r);function r(){var e;return Object(i.a)(this,r),(e=t.apply(this,arguments)).output=0,e.occlusionTestEnabled=!0,e.sdf=!1,e.vvSize=!1,e.vvColor=!1,e.verticalOffset=!1,e.screenSizePerspective=!1,e.screenCenterOffsetUnitsEnabled=0,e.debugDrawBorder=!0,e.binaryHighlightOcclusion=!0,e.slicePlaneEnabled=!1,e.polygonOffsetEnabled=!1,e.depthEnabled=!0,e.transparencyPassType=3,e.pixelSnappingEnabled=!0,e.isDraped=!1,e.multipassGeometryEnabled=!1,e.multipassTerrainEnabled=!1,e.cullAboveGround=!1,e}return r}(G.a);Object(A.a)([Object(G.b)({count:8})],$.prototype,"output",void 0),Object(A.a)([Object(G.b)()],$.prototype,"occlusionTestEnabled",void 0),Object(A.a)([Object(G.b)()],$.prototype,"sdf",void 0),Object(A.a)([Object(G.b)()],$.prototype,"vvSize",void 0),Object(A.a)([Object(G.b)()],$.prototype,"vvColor",void 0),Object(A.a)([Object(G.b)()],$.prototype,"verticalOffset",void 0),Object(A.a)([Object(G.b)()],$.prototype,"screenSizePerspective",void 0),Object(A.a)([Object(G.b)({count:2})],$.prototype,"screenCenterOffsetUnitsEnabled",void 0),Object(A.a)([Object(G.b)()],$.prototype,"debugDrawBorder",void 0),Object(A.a)([Object(G.b)()],$.prototype,"binaryHighlightOcclusion",void 0),Object(A.a)([Object(G.b)()],$.prototype,"slicePlaneEnabled",void 0),Object(A.a)([Object(G.b)()],$.prototype,"polygonOffsetEnabled",void 0),Object(A.a)([Object(G.b)()],$.prototype,"depthEnabled",void 0),Object(A.a)([Object(G.b)({count:4})],$.prototype,"transparencyPassType",void 0),Object(A.a)([Object(G.b)()],$.prototype,"pixelSnappingEnabled",void 0),Object(A.a)([Object(G.b)()],$.prototype,"isDraped",void 0),Object(A.a)([Object(G.b)()],$.prototype,"multipassGeometryEnabled",void 0),Object(A.a)([Object(G.b)()],$.prototype,"multipassTerrainEnabled",void 0),Object(A.a)([Object(G.b)()],$.prototype,"cullAboveGround",void 0);var J=function(e){Object(o.a)(r,e);var t=Object(s.a)(r);function r(e){var n;return Object(i.a)(this,r),(n=t.call(this,e,je)).techniqueConfig=new $,n}return Object(a.a)(r,[{key:"getTechniqueConfig",value:function(e,t){return this.techniqueConfig.output=e,this.techniqueConfig.slicePlaneEnabled=this.params.slicePlaneEnabled,this.techniqueConfig.verticalOffset=!!this.params.verticalOffset,this.techniqueConfig.screenSizePerspective=!!this.params.screenSizePerspective,this.techniqueConfig.screenCenterOffsetUnitsEnabled="screen"===this.params.centerOffsetUnits?1:0,this.techniqueConfig.polygonOffsetEnabled=this.params.polygonOffset,this.techniqueConfig.isDraped=this.params.isDraped,this.techniqueConfig.occlusionTestEnabled=this.params.occlusionTest,this.techniqueConfig.pixelSnappingEnabled=this.params.pixelSnappingEnabled,this.techniqueConfig.sdf=this.params.textureIsSignedDistanceField,this.techniqueConfig.vvSize=!!this.params.vvSizeEnabled,this.techniqueConfig.vvColor=!!this.params.vvColorEnabled,0===e&&(this.techniqueConfig.debugDrawBorder=!!this.params.debugDrawBorder),4===e&&(this.techniqueConfig.binaryHighlightOcclusion=this.params.binaryHighlightOcclusion),this.techniqueConfig.depthEnabled=this.params.depthEnabled,this.techniqueConfig.transparencyPassType=t?t.transparencyPassType:3,this.techniqueConfig.multipassGeometryEnabled=!!t&&t.multipassGeometryEnabled,this.techniqueConfig.multipassTerrainEnabled=!!t&&t.multipassTerrainEnabled,this.techniqueConfig.cullAboveGround=!!t&&t.cullAboveGround,this.techniqueConfig}},{key:"intersect",value:function(e,t,r,n,i,a,o,s,c){c?this.intersectDrapedHudGeometry(e,a,o,s):this.intersectHudGeometry(e,t,r,n,o,s)}},{key:"intersectDrapedHudGeometry",value:function(e,t,r,n){var i=e.vertexAttributes.get("position"),a=e.vertexAttributes.get("size"),o=this.params,s=Object(P.d)(o),c=1,u=1;if(Object(l.j)(n)){var d=n(ve);c=d[0],u=d[5]}c*=e.screenToWorldRatio,u*=e.screenToWorldRatio;for(var h=ye*e.screenToWorldRatio,f=0;f<i.data.length/i.size;f++){var p=f*i.size,b=i.data[p],v=i.data[p+1],m=f*a.size,y=void 0;ge[0]=a.data[m]*c,ge[1]=a.data[m+1]*u,o.textureIsSignedDistanceField&&(y=o.outlineSize*e.screenToWorldRatio/2),ne(t,b,v,ge,h,y,o,s)&&r()}}},{key:"intersectHudGeometry",value:function(e,t,r,n,i,a){if(n.options.selectionMode&&n.options.hud&&!Object(M.e)(t)){var o=this.params,s=1,c=1;if(Object(d.f)(de,r),Object(l.j)(a)){var u=a(ve);s=u[0],c=u[5],function(e){var t=e[0],r=e[1],n=e[2],i=e[3],a=e[4],o=e[5],s=e[6],c=e[7],l=e[8],u=1/Math.sqrt(t*t+r*r+n*n),d=1/Math.sqrt(i*i+a*a+o*o),h=1/Math.sqrt(s*s+c*c+l*l);e[0]=t*u,e[1]=r*u,e[2]=n*u,e[3]=i*d,e[4]=a*d,e[5]=o*d,e[6]=s*h,e[7]=c*h,e[8]=l*h}(de)}var h=e.vertexAttributes.get("position"),p=e.vertexAttributes.get("size"),b=e.vertexAttributes.get("normal"),v=e.vertexAttributes.get("auxpos1");Object(S.a)(h.size>=3);var g=n.point,O=n.camera,j=Object(P.d)(o);s*=O.pixelRatio,c*=O.pixelRatio;for(var _="screen"===this.params.centerOffsetUnits,w=0;w<h.data.length/h.size;w++){var x=w*h.size;Object(m.y)(oe,h.data[x],h.data[x+1],h.data[x+2]),Object(m.s)(oe,oe,r);var T=w*p.size;ge[0]=p.data[T]*s,ge[1]=p.data[T+1]*c,Object(m.s)(oe,oe,O.viewMatrix);var C=w*v.size;if(Object(m.y)(pe,v.data[C+0],v.data[C+1],v.data[C+2]),!_&&(oe[0]+=pe[0],oe[1]+=pe[1],0!==pe[2])){var A=pe[2];Object(m.t)(pe,oe),Object(m.l)(oe,oe,Object(m.g)(pe,pe,A))}var E=w*b.size;if(Object(m.y)(se,b.data[E],b.data[E+1],b.data[E+2]),this.normalAndViewAngle(se,de,O,be),this.applyVerticalOffsetTransformationView(oe,be,O,ie),O.applyProjection(oe,ce),ce[0]>-1){var R=Math.floor(ce[0])+this.params.screenOffset[0],I=Math.floor(ce[1])+this.params.screenOffset[1];_&&(R+=pe[0],0!==pe[1]&&(I+=Object(k.b)(pe[1],ie.factorAlignment))),Object(k.a)(ge,ie.factor,ge);var D=me*O.pixelRatio,F=void 0;if(o.textureIsSignedDistanceField&&(F=o.outlineSize*O.pixelRatio/2),ne(g,R,I,ge,D,F,o,j)){var L=n.ray;if(Object(m.s)(ue,oe,Object(f.a)(fe,O.viewMatrix)),ce[0]=g[0],ce[1]=g[1],O.unprojectFromRenderScreen(ce,oe)){var z=Object(y.e)();Object(m.m)(z,L.direction);var V=1/Object(m.r)(z);Object(m.g)(z,z,V),i(Object(m.o)(L.origin,oe)*V,z,-1,1,!0,ue)}}}}}}},{key:"computeAttachmentOrigin",value:function(e,t){var r=e.vertexAttributes;if(!r)return!1;var n=r.get("position"),i=e.indices.get("position");return Object(_.b)(n,i,t)}},{key:"createBufferWriter",value:function(){return new we(this)}},{key:"normalAndViewAngle",value:function(e,t,r,n){return g(t)&&(t=Object(d.f)(he,t)),Object(m.z)(n.normal,e,t),Object(m.s)(n.normal,n.normal,r.viewInverseTransposeMatrix),n.cosAngle=Object(m.j)(le,Oe),n}},{key:"updateScaleInfo",value:function(e,t,r){var n=this.params;n.screenSizePerspective?Object(k.e)(r,t,n.screenSizePerspective,e.factor):(e.factor.scale=1,e.factor.factor=0,e.factor.minPixelSize=0,e.factor.paddingPixels=0),n.screenSizePerspectiveAlignment?Object(k.e)(r,t,n.screenSizePerspectiveAlignment,e.factorAlignment):(e.factorAlignment.factor=e.factor.factor,e.factorAlignment.scale=e.factor.scale,e.factorAlignment.minPixelSize=e.factor.minPixelSize,e.factorAlignment.paddingPixels=e.factor.paddingPixels)}},{key:"applyShaderOffsetsView",value:function(e,t,r,n,i,a,o){var s=this.normalAndViewAngle(t,r,i,be);return this.applyVerticalGroundOffsetView(e,s,i,o),this.applyVerticalOffsetTransformationView(o,s,i,a),this.applyPolygonOffsetView(o,s,n[3],i,o),this.applyCenterOffsetView(o,n,o),o}},{key:"applyShaderOffsetsNDC",value:function(e,t,r,n,i){return this.applyCenterOffsetNDC(e,t,r,n),Object(l.j)(i)&&Object(m.m)(i,n),this.applyPolygonOffsetNDC(n,t,r,n),n}},{key:"applyPolygonOffsetView",value:function(e,t,r,n,i){var a=n.aboveGround?1:-1,o=Object(c.t)(r);0===o&&(o=a);var s=a*o;if(this.params.shaderPolygonOffset<=0)return Object(m.m)(i,e);var l=Object(c.e)(Math.abs(t.cosAngle),.01,1),u=1-Math.sqrt(1-l*l)/l/n.viewport[2];return Object(m.g)(i,e,s>0?u:1/u),i}},{key:"applyVerticalGroundOffsetView",value:function(e,t,r,n){var i=Object(m.r)(e),a=r.aboveGround?1:-1,o=.5*r.computeRenderPixelSizeAtDist(i),s=Object(m.g)(oe,t.normal,a*o);return Object(m.h)(n,e,s),n}},{key:"applyVerticalOffsetTransformationView",value:function(e,t,r,n){var i=this.params;if(!i.verticalOffset||!i.verticalOffset.screenLength){if(i.screenSizePerspective||i.screenSizePerspectiveAlignment){var a=Object(m.r)(e);this.updateScaleInfo(n,a,t.cosAngle)}else n.factor.scale=1,n.factorAlignment.scale=1;return e}var o=Object(m.r)(e),s=i.screenSizePerspectiveAlignment||i.screenSizePerspective,c=Object(C.l)(r,o,i.verticalOffset,t.cosAngle,s);return this.updateScaleInfo(n,o,t.cosAngle),Object(m.g)(t.normal,t.normal,c),Object(m.h)(e,e,t.normal)}},{key:"applyCenterOffsetView",value:function(e,t,r){var n="screen"!==this.params.centerOffsetUnits;return r!==e&&Object(m.m)(r,e),n&&(r[0]+=t[0],r[1]+=t[1],t[2]&&(Object(m.t)(se,r),Object(m.h)(r,r,Object(m.g)(se,se,t[2])))),r}},{key:"applyCenterOffsetNDC",value:function(e,t,r,n){var i="screen"!==this.params.centerOffsetUnits;return n!==e&&Object(m.m)(n,e),i||(n[0]+=t[0]/r.fullWidth*2,n[1]+=t[1]/r.fullHeight*2),n}},{key:"applyPolygonOffsetNDC",value:function(e,t,r,n){var i=this.params.shaderPolygonOffset;if(e!==n&&Object(m.m)(n,e),i){var a=r.aboveGround?1:-1,o=a*Object(c.t)(t[3]);n[2]-=(o||a)*i}return n}},{key:"getGLMaterial",value:function(e){return 0===e.output||7===e.output?new ee(e):4===e.output?new te(e):void 0}},{key:"calculateRelativeScreenBounds",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Object(O.k)();return re(this.params,e,t,r),r[2]=r[0]+e[0],r[3]=r[1]+e[1],r}}]),r}(x.a),K=function(e){Object(o.a)(r,e);var t=Object(s.a)(r);function r(e){var a;return Object(i.a)(this,r),(a=t.call(this,Object(n.a)(Object(n.a)({},e),e.material.params))).updateParameters(),a}return Object(a.a)(r,[{key:"beginSlot",value:function(e){return e===(this._material.params.drawInSecondSlot?19:18)}},{key:"updateParameters",value:function(e){this.updateTexture(this._material.params.textureId),this.selectProgram(e)}},{key:"selectProgram",value:function(e){this._technique=this._techniqueRep.releaseAndAcquire(Z,this._material.getTechniqueConfig(this._output,e),this._technique)}},{key:"ensureParameters",value:function(e){this.updateParameters(e)}},{key:"bind",value:function(e){this.bindTextures(this._technique.program),this.bindTextureScale(this._technique.program),this._technique.bindPass(this._material.params,e)}}]),r}(w.a),ee=function(e){Object(o.a)(r,e);var t=Object(s.a)(r);function r(e){var n;return Object(i.a)(this,r),(n=t.call(this,e))._isOcclusionSlot=!1,n}return Object(a.a)(r,[{key:"beginSlot",value:function(e){var t=this._material.params.drawInSecondSlot?19:18;return this._material.params.occlusionTest?(this._isOcclusionSlot=12===e,12===e||e===t):(this._isOcclusionSlot=!1,e===t)}},{key:"technique",get:function(){return this._isOcclusionSlot?this._occlusionTechnique:this._technique}},{key:"selectProgram",value:function(e){this._technique=this._techniqueRep.releaseAndAcquire(Z,this._material.getTechniqueConfig(this._output,e),this._technique),this._occlusionTechnique=this._techniqueRep.releaseAndAcquire(Z,this._material.getTechniqueConfig(6,e),this._occlusionTechnique)}},{key:"bind",value:function(e){var t=this.technique;this._isOcclusionSlot||(this.bindTextures(t.program),this.bindTextureScale(t.program)),t.bindPass(this._material.params,e)}}]),r}(K),te=function(e){Object(o.a)(r,e);var t=Object(s.a)(r);function r(e){return Object(i.a)(this,r),t.call(this,Object(n.a)(Object(n.a)({},e),{},{output:4}))}return r}(K);function re(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:ae;return Object(b.c)(n,e.anchorPos),n[0]*=-t[0],n[1]*=-t[1],n[0]+=e.screenOffset[0]*r,n[1]+=e.screenOffset[1]*r,n}function ne(e,t,r,n,i,a,o,s){var c=t-i-(s[0]>0?n[0]*s[0]:0),l=c+n[0]+2*i,u=r-i-(s[1]>0?n[1]*s[1]:0),d=u+n[1]+2*i;if(o.textureIsSignedDistanceField){var h=o.distanceFieldBoundingBox;c+=n[0]*h[0],u+=n[1]*h[1],l-=n[0]*(1-h[2]),d-=n[1]*(1-h[3]),c-=a,l+=a,u-=a,d+=a}return e[0]>c&&e[0]<l&&e[1]>u&&e[1]<d}var ie={factor:{scale:0,factor:0,minPixelSize:0,paddingPixels:0},factorAlignment:{scale:0,factor:0,minPixelSize:0,paddingPixels:0}},ae=Object(v.b)(),oe=Object(y.e)(),se=Object(y.e)(),ce=Object(u.d)(),le=Object(y.e)(),ue=Object(y.e)(),de=Object(h.b)(),he=Object(h.b)(),fe=Object(p.d)(),pe=Object(y.e)(),be={normal:le,cosAngle:0},ve=Object(p.d)(),me=1,ye=2,ge=[0,0],Oe=Object(y.g)(0,0,1),je=Object(n.a)({texCoordScale:[1,1],occlusionTest:!0,binaryHighlightOcclusion:!0,drawInSecondSlot:!1,color:[1,1,1,1],outlineColor:[1,1,1,1],outlineSize:0,textureIsSignedDistanceField:!1,distanceFieldBoundingBox:null,vvSizeEnabled:!1,vvSizeMinSize:[1,1,1],vvSizeMaxSize:[100,100,100],vvSizeOffset:[0,0,0],vvSizeFactor:[1,1,1],vvColorEnabled:!1,vvColorValues:[0,0,0,0,0,0,0,0],vvColorColors:[1,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0],screenOffset:[0,0],verticalOffset:null,screenSizePerspective:null,screenSizePerspectiveAlignment:null,slicePlaneEnabled:!1,anchorPos:Object(v.f)(.5,.5),shaderPolygonOffset:1e-5,polygonOffset:!1,textureId:null,centerOffsetUnits:"world",depthEnabled:!0,pixelSnappingEnabled:!0,debugDrawBorder:!1,isDraped:!1},x.b),_e=Object(j.a)().vec3f("position").vec3f("normal").vec2f("uv0").vec4u8("color").vec2f("size").vec4f("auxpos1").vec4f("auxpos2"),we=function(){function e(t){Object(i.a)(this,e),this.material=t,this.vertexBufferLayout=_e}return Object(a.a)(e,[{key:"allocate",value:function(e){return this.vertexBufferLayout.createBuffer(e)}},{key:"elementCount",value:function(e){return 6*e.indices.get("position").length}},{key:"write",value:function(e,t,r,n){Object(T.e)(t.indices.get("position"),t.vertexAttributes.get("position").data,e.transformation,r.position,n,6),Object(T.d)(t.indices.get("normal"),t.vertexAttributes.get("normal").data,e.invTranspTransformation,r.normal,n,6);var i,a,o,s,c=t.vertexAttributes.get("uv0").data;if(null==c||c.length<4){var l=this.material.params;i=0,a=0,o=l.texCoordScale[0],s=l.texCoordScale[1]}else i=c[0],a=c[1],o=c[2],s=c[3];o=Math.min(1.99999,o+1),s=Math.min(1.99999,s+1);for(var u=t.indices.get("position").length,d=r.uv0,h=n,f=0;f<u;++f)d.set(h,0,i),d.set(h,1,a),h+=1,d.set(h,0,o),d.set(h,1,a),h+=1,d.set(h,0,o),d.set(h,1,s),h+=1,d.set(h,0,o),d.set(h,1,s),h+=1,d.set(h,0,i),d.set(h,1,s),h+=1,d.set(h,0,i),d.set(h,1,a),h+=1;Object(T.b)(t.indices.get("color"),t.vertexAttributes.get("color").data,4,r.color,n,6);for(var p=t.indices.get("size"),b=t.vertexAttributes.get("size").data,v=p.length,m=r.size,y=n,g=0;g<v;++g)for(var O=b[2*p[g]],j=b[2*p[g]+1],_=0;_<6;++_)m.set(y,0,O),m.set(y,1,j),y+=1;t.indices.get("auxpos1")&&t.vertexAttributes.get("auxpos1")&&Object(T.a)(t.indices.get("auxpos1"),t.vertexAttributes.get("auxpos1").data,r.auxpos1,n,6),t.indices.get("auxpos2")&&t.vertexAttributes.get("auxpos2")&&Object(T.a)(t.indices.get("auxpos2"),t.vertexAttributes.get("auxpos2").data,r.auxpos2,n,6)}}]),e}()},function(e,t,r){"use strict";r.d(t,"a",(function(){return o})),r.d(t,"b",(function(){return a})),r.d(t,"c",(function(){return i}));var n=r(49),i=new n.a("white"),a=(new n.a("black"),new n.a([255,255,255,0]));function o(e){return 0===e.r&&0===e.g&&0===e.b}},function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var n=r(58),i=Object(n.b)()({esriTimeUnitsMilliseconds:"milliseconds",esriTimeUnitsSeconds:"seconds",esriTimeUnitsMinutes:"minutes",esriTimeUnitsHours:"hours",esriTimeUnitsDays:"days",esriTimeUnitsWeeks:"weeks",esriTimeUnitsMonths:"months",esriTimeUnitsYears:"years",esriTimeUnitsDecades:"decades",esriTimeUnitsCenturies:"centuries",esriTimeUnitsUnknown:void 0})},function(e,t,r){"use strict";r.d(t,"a",(function(){return f})),r.d(t,"b",(function(){return d})),r.d(t,"c",(function(){return l})),r.d(t,"d",(function(){return u}));var n=r(18);var i=r(257);function a(e){e.name&&(e.read&&"object"==typeof e.read?void 0===e.read.source&&(e.read.source=e.name):e.read={source:e.name},e.write&&"object"==typeof e.write?void 0===e.write.target&&(e.write.target=e.name):e.write={target:e.name})}function o(e){"boolean"==typeof e.read?e.read={enabled:e.read}:"function"==typeof e.read?e.read={enabled:!0,reader:e.read}:e.read&&"object"==typeof e.read&&void 0===e.read.enabled&&(e.read.enabled=!0)}function s(e){"boolean"==typeof e.write?e.write={enabled:e.write}:"function"==typeof e.write?e.write={enabled:!0,writer:e.write}:e.write&&"object"==typeof e.write&&void 0===e.write.enabled&&(e.write.enabled=!0)}var c=r(363);function l(e,t){return d(e,"read",t)}function u(e,t){return d(e,"write",t)}function d(e,t,r){var n=e&&e.json;if(e&&e.json&&e.json.origins&&r){var i=e.json.origins[r.origin];i&&("any"===t||t in i)&&(n=i)}return n}function h(e){var t=function(e){return e.type?function(e){if(!e.type)return;for(var t=0,r=e.type;Array.isArray(r)&&!Object(n.o)(r);)r=r[0],t++;return{type:r,ndimArray:t}}(e):function(e){if(!e.types)return;for(var t=0,r=e.types;Array.isArray(r);)r=r[0],t++;return{types:r,ndimArray:t}}(e)}(e);if(e.json.origins)for(var r in e.json.origins){var a=e.json.origins[r];Object(i.a)(t,a,!1),Object(c.a)(t,a)}Object(i.a)(t,e.json,!0),Object(c.a)(t,e.json)}var f={processPrototypePropertyMetadata:function(e,t){var r;(function(e){if(e.json||(e.json={}),o(e.json),s(e.json),a(e.json),e.json.origins)for(var t in e.json.origins)o(e.json.origins[t]),s(e.json.origins[t]),a(e.json.origins[t]);return!0})(t)&&((r=t).json&&r.json.origins&&function(){var e=r.json.origins,t={"web-document":["web-scene","web-map"]};for(var n in t)e[n]&&function(){var r=e[n];t[n].forEach((function(t){e[t]=r})),delete e[n]}()}(),h(t))}}},function(e,t,r){"use strict";var n=r(2),i=r(5),a=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=arguments.length>2?arguments[2]:void 0,a=arguments.length>3?arguments[3]:void 0;Object(n.a)(this,e),this.displayId=0,this.geohashX=0,this.geohashY=0,this.geometry=t,r&&(this.attributes=r),i&&(this.centroid=i),null!=a&&(this.objectId=a)}return Object(i.a)(e,[{key:"hasGeometry",get:function(){return!(!this.geometry||!this.geometry.coords||!this.geometry.coords.length)}},{key:"weakClone",value:function(){var t=new e(this.geometry,this.attributes,this.centroid,this.objectId);return t.displayId=this.displayId,t.geohashX=this.geohashX,t.geohashY=this.geohashY,t}}]),e}();t.a=a},function(e,t,r){"use strict";r.d(t,"a",(function(){return u})),r.d(t,"b",(function(){return s})),r.d(t,"c",(function(){return l})),r.d(t,"d",(function(){return c}));var n=r(80),i=r(384),a=!1,o=[];function s(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{runImmediately:!1},o=new i.a(l),s=null,c=!1;function l(){if(o&&!c)if(a)d(l);else{var r=s;o.clear(),a=!0,c=!0,s=Object(n.b)(o,e),c=!1,a=!1,t(s,r),h()}}function u(){o&&(o.destroy(),o=null,s=null)}return c=!0,s=Object(n.b)(o,e),c=!1,r.runImmediately&&t(s,s),{remove:u}}function c(e,t){return s(e,t,{runImmediately:!0})}function l(e,t){var r=new i.a((function(){t(a,o)})),a=null;function o(){return r?(r.clear(),a=Object(n.b)(r,e)):null}return o(),{remove:function(){r&&(r.destroy(),r=null),a=null}}}function u(e){var t=new i.a((function i(){t&&!r&&(a?d(i):(t.clear(),a=!0,r=!0,Object(n.b)(t,e),r=!1,a=!1,h()))})),r=!1;return r=!0,Object(n.b)(t,e),r=!1,{remove:function(){t&&(t.destroy(),t=null)}}}function d(e){o.includes(e)||o.unshift(e)}function h(){for(;o.length;)o.pop()()}},function(e,t,r){"use strict";r.d(t,"a",(function(){return n})),r.d(t,"b",(function(){return i}));var n="20210707",i="17f9314e751fd1e720022ff5819d4e40def1f79a"},function(e,t,r){"use strict";var n,i=r(2),a=r(5),o=r(6),s=r(7),c=r(0),l=r(25),u=r(1),d=(r(18),r(17),r(15),r(48)),h=r(10),f=r(44),p=r(508),b=r(510),v=r(181),m=r(542),y=r(511),g=r(512),O=r(513),j=n=function(e){Object(o.a)(r,e);var t=Object(s.a)(r);function r(e){var n;return Object(i.a)(this,r),(n=t.call(this,e)).activeMediaInfoIndex=null,n.description=null,n.mediaInfos=null,n.title=null,n.type="media",n}return Object(a.a)(r,[{key:"readMediaInfos",value:function(e){return e&&e.map((function(e){return"image"===e.type?m.a.fromJSON(e):"barchart"===e.type?p.a.fromJSON(e):"columnchart"===e.type?b.a.fromJSON(e):"linechart"===e.type?y.a.fromJSON(e):"piechart"===e.type?g.a.fromJSON(e):void 0})).filter(Boolean)}},{key:"writeMediaInfos",value:function(e,t){t.mediaInfos=e&&e.map((function(e){return e.toJSON()}))}},{key:"clone",value:function(){return new n({activeMediaInfoIndex:this.activeMediaInfoIndex,description:this.description,mediaInfos:this.mediaInfos?Object(l.a)(this.mediaInfos):null,title:this.title})}}]),r}(v.a);Object(c.a)([Object(u.b)()],j.prototype,"activeMediaInfoIndex",void 0),Object(c.a)([Object(u.b)({json:{write:!0,origins:{"web-scene":{write:!1,read:!1}}}})],j.prototype,"description",void 0),Object(c.a)([Object(u.b)({types:[O.a]})],j.prototype,"mediaInfos",void 0),Object(c.a)([Object(d.a)("mediaInfos")],j.prototype,"readMediaInfos",null),Object(c.a)([Object(f.a)("mediaInfos")],j.prototype,"writeMediaInfos",null),Object(c.a)([Object(u.b)({json:{write:!0,origins:{"web-scene":{write:!1,read:!1}}}})],j.prototype,"title",void 0),Object(c.a)([Object(u.b)({type:["media"],readOnly:!0,json:{read:!1,write:!0}})],j.prototype,"type",void 0);var _=j=n=Object(c.a)([Object(h.a)("esri.popup.content.MediaContent")],j);t.a=_},function(e,t,r){"use strict";var n,i=r(2),a=r(5),o=r(6),s=r(7),c=r(0),l=r(53),u=r(25),d=r(1),h=(r(18),r(17),r(15),r(52)),f=r(10),p=r(223),b=r(219),v=r(229),m=r(388),y=l.a.ofType({base:null,key:"type",typeMap:{text:b.a}}),g=n=function(e){Object(o.a)(r,e);var t=Object(s.a)(r);function r(e){var n;return Object(i.a)(this,r),(n=t.call(this,e)).verticalOffset=null,n.callout=null,n.styleOrigin=null,n.symbolLayers=new y,n.type="label-3d",n}return Object(a.a)(r,[{key:"supportsCallout",value:function(){return!0}},{key:"hasVisibleCallout",value:function(){return Object(v.b)(this)}},{key:"hasVisibleVerticalOffset",value:function(){return Object(v.c)(this)}},{key:"clone",value:function(){return new n({styleOrigin:Object(u.a)(this.styleOrigin),symbolLayers:Object(u.a)(this.symbolLayers),thumbnail:Object(u.a)(this.thumbnail),callout:Object(u.a)(this.callout),verticalOffset:Object(u.a)(this.verticalOffset)})}}],[{key:"fromTextSymbol",value:function(e){return new n({symbolLayers:[b.a.fromTextSymbol(e)]})}}]),r}(p.a);Object(c.a)([Object(d.b)({type:m.a,json:{write:!0}})],g.prototype,"verticalOffset",void 0),Object(c.a)([Object(d.b)(v.a)],g.prototype,"callout",void 0),Object(c.a)([Object(d.b)({json:{read:!1,write:!1}})],g.prototype,"styleOrigin",void 0),Object(c.a)([Object(d.b)({type:y})],g.prototype,"symbolLayers",void 0),Object(c.a)([Object(h.a)({LabelSymbol3D:"label-3d"},{readOnly:!0})],g.prototype,"type",void 0);var O=g=n=Object(c.a)([Object(f.a)("esri.symbols.LabelSymbol3D")],g);t.a=O},function(e,t,r){"use strict";var n,i=r(2),a=r(5),o=r(6),s=r(7),c=r(0),l=r(53),u=r(25),d=r(1),h=(r(18),r(17),r(15),r(52)),f=r(10),p=r(264),b=r(351),v=r(223),m=l.a.ofType({base:null,key:"type",typeMap:{line:p.a,path:b.a}}),y=l.a.ofType({base:null,key:"type",typeMap:{line:p.a,path:b.a}}),g=n=function(e){Object(o.a)(r,e);var t=Object(s.a)(r);function r(e){var n;return Object(i.a)(this,r),(n=t.call(this,e)).symbolLayers=new m,n.type="line-3d",n}return Object(a.a)(r,[{key:"clone",value:function(){return new n({styleOrigin:Object(u.a)(this.styleOrigin),symbolLayers:Object(u.a)(this.symbolLayers),thumbnail:Object(u.a)(this.thumbnail)})}}],[{key:"fromSimpleLineSymbol",value:function(e){return new n({symbolLayers:[p.a.fromSimpleLineSymbol(e)]})}}]),r}(v.a);Object(c.a)([Object(d.b)({type:m,json:{type:y}})],g.prototype,"symbolLayers",void 0),Object(c.a)([Object(h.a)({LineSymbol3D:"line-3d"},{readOnly:!0})],g.prototype,"type",void 0);var O=g=n=Object(c.a)([Object(f.a)("esri.symbols.LineSymbol3D")],g);t.a=O},function(e,t,r){"use strict";r.d(t,"a",(function(){return F}));var n,i,a=r(2),o=r(5),s=r(6),c=r(7),l=r(0),u=r(58),d=r(27),h=r(1),f=(r(17),r(64)),p=(r(15),r(52)),b=r(48),v=r(10),m=r(18),y=r(257),g=r(314),O=r(644),j=(r(126),r(55)),_=r(241),w=n=function(e){Object(s.a)(r,e);var t=Object(c.a)(r);function r(e){var n;return Object(a.a)(this,r),(n=t.call(this,e)).type="query-table",n}return Object(o.a)(r,[{key:"clone",value:function(){var e,t=this.workspaceId,r=this.query,i=this.oidFields,a=this.spatialReference,o=this.geometryType,s={workspaceId:t,query:r,oidFields:i,spatialReference:null!=(e=null==a?void 0:a.clone())?e:void 0,geometryType:o};return new n(s)}}]),r}(d.a);Object(l.a)([Object(p.a)({queryTable:"query-table"})],w.prototype,"type",void 0),Object(l.a)([Object(h.b)({type:String,json:{write:!0}})],w.prototype,"workspaceId",void 0),Object(l.a)([Object(h.b)({type:String,json:{write:!0}})],w.prototype,"query",void 0),Object(l.a)([Object(h.b)({type:String,json:{write:!0}})],w.prototype,"oidFields",void 0),Object(l.a)([Object(h.b)({type:j.a,json:{write:!0}})],w.prototype,"spatialReference",void 0),Object(l.a)([Object(p.a)(_.a)],w.prototype,"geometryType",void 0),w=n=Object(l.a)([Object(v.a)("esri.layers.support.source.QueryTableDataSource")],w);var x,k=i=function(e){Object(s.a)(r,e);var t=Object(c.a)(r);function r(e){var n;return Object(a.a)(this,r),(n=t.call(this,e)).type="raster",n}return Object(o.a)(r,[{key:"clone",value:function(){var e=this.workspaceId,t=this.dataSourceName;return new i({workspaceId:e,dataSourceName:t})}}]),r}(d.a);Object(l.a)([Object(p.a)({raster:"raster"})],k.prototype,"type",void 0),Object(l.a)([Object(h.b)({type:String,json:{write:!0}})],k.prototype,"dataSourceName",void 0),Object(l.a)([Object(h.b)({type:String,json:{write:!0}})],k.prototype,"workspaceId",void 0),k=i=Object(l.a)([Object(v.a)("esri.layers.support.source.RasterDataSource")],k);var S,T,C=x=function(e){Object(s.a)(r,e);var t=Object(c.a)(r);function r(e){var n;return Object(a.a)(this,r),(n=t.call(this,e)).type="table",n}return Object(o.a)(r,[{key:"clone",value:function(){var e=this.workspaceId,t=this.gdbVersion,r=this.dataSourceName;return new x({workspaceId:e,gdbVersion:t,dataSourceName:r})}}]),r}(d.a);Object(l.a)([Object(p.a)({table:"table"})],C.prototype,"type",void 0),Object(l.a)([Object(h.b)({type:String,json:{write:!0}})],C.prototype,"workspaceId",void 0),Object(l.a)([Object(h.b)({type:String,json:{write:!0}})],C.prototype,"gdbVersion",void 0),Object(l.a)([Object(h.b)({type:String,json:{write:!0}})],C.prototype,"dataSourceName",void 0),C=x=Object(l.a)([Object(v.a)("esri.layers.support.source.TableDataSource")],C);var M=Object(u.b)()({esriLeftInnerJoin:"left-inner-join",esriLeftOuterJoin:"left-outer-join"}),P=S=function(e){Object(s.a)(r,e);var t=Object(c.a)(r);function r(e){var n;return Object(a.a)(this,r),(n=t.call(this,e)).type="join-table",n}return Object(o.a)(r,[{key:"readLeftTableSource",value:function(e,t,r){return E()(e,t,r)}},{key:"castLeftTableSource",value:function(e){return Object(m.k)(I(),e)}},{key:"readRightTableSource",value:function(e,t,r){return E()(e,t,r)}},{key:"castRightTableSource",value:function(e){return Object(m.k)(I(),e)}},{key:"clone",value:function(){var e,t,r=this.leftTableKey,n=this.rightTableKey,i=this.leftTableSource,a=this.rightTableSource,o=this.joinType,s={leftTableKey:r,rightTableKey:n,leftTableSource:null!=(e=null==i?void 0:i.clone())?e:void 0,rightTableSource:null!=(t=null==a?void 0:a.clone())?t:void 0,joinType:o};return new S(s)}}]),r}(d.a);Object(l.a)([Object(p.a)({joinTable:"join-table"})],P.prototype,"type",void 0),Object(l.a)([Object(h.b)({type:String,json:{write:!0}})],P.prototype,"leftTableKey",void 0),Object(l.a)([Object(h.b)({type:String,json:{write:!0}})],P.prototype,"rightTableKey",void 0),Object(l.a)([Object(h.b)({json:{write:!0}})],P.prototype,"leftTableSource",void 0),Object(l.a)([Object(b.a)("leftTableSource")],P.prototype,"readLeftTableSource",null),Object(l.a)([Object(f.a)("leftTableSource")],P.prototype,"castLeftTableSource",null),Object(l.a)([Object(h.b)({json:{write:!0}})],P.prototype,"rightTableSource",void 0),Object(l.a)([Object(b.a)("rightTableSource")],P.prototype,"readRightTableSource",null),Object(l.a)([Object(f.a)("rightTableSource")],P.prototype,"castRightTableSource",null),Object(l.a)([Object(p.a)(M)],P.prototype,"joinType",void 0),P=S=Object(l.a)([Object(v.a)("esri.layers.support.source.JoinTableDataSource")],P);var A=null;function E(){return A||(A=Object(y.b)({types:I()})),A}var R=null;function I(){return R||(R={key:"type",base:null,typeMap:{"data-layer":F,"map-layer":O.a}}),R}var D={key:"type",base:null,typeMap:{"join-table":P,"query-table":w,raster:k,table:C}},F=T=function(e){Object(s.a)(r,e);var t=Object(c.a)(r);function r(e){var n;return Object(a.a)(this,r),(n=t.call(this,e)).type="data-layer",n}return Object(o.a)(r,[{key:"clone",value:function(){var e=this.fields,t=this.dataSource;return new T({fields:e,dataSource:t})}}]),r}(d.a);Object(l.a)([Object(p.a)({dataLayer:"data-layer"})],F.prototype,"type",void 0),Object(l.a)([Object(h.b)({type:[g.a],json:{write:!0}})],F.prototype,"fields",void 0),Object(l.a)([Object(h.b)({types:D,json:{write:!0}})],F.prototype,"dataSource",void 0),(F=T=Object(l.a)([Object(v.a)("esri.layers.support.source.DataLayerSource")],F)).from=Object(m.m)(F)},function(e,t,r){"use strict";r.d(t,"a",(function(){return s})),r.d(t,"b",(function(){return o}));var n=r(17),i=new Set;function a(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];r&&i.has(t)||(r&&i.add(t),e.warn("\ud83d\uded1 DEPRECATED - ".concat(t)))}function o(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(Object(n.a)("esri-deprecation-warnings")){var i=r.moduleName;s(e,"Function: ".concat((i?i+"::":"")+t+"()"),r)}}function s(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(Object(n.a)("esri-deprecation-warnings")){var i=r.replacement,o=r.version,s=r.see,c=r.warnOnce,l=t;i&&(l+="\n\t\ud83d\udee0\ufe0f Replacement: ".concat(i)),o&&(l+="\n\t\u2699\ufe0f Version: ".concat(o)),s&&(l+="\n\t\ud83d\udd17 See ".concat(s," for more details.")),a(e,l,c)}}},function(e,t,r){"use strict";r.d(t,"a",(function(){return T}));var n=r(14),i=r(13),a=r(2),o=r(5),s=r(6),c=r(7),l=r(0),u=r(99),d=r(30),h=r(101),f=r(22),p=r(25),b=r(3),v=r(23),m=r(1),y=(r(18),r(17),r(15),r(10)),g=r(46),O=function e(t){Object(a.a)(this,e),this.client=t,this._cancelled=!1,this.size=0,this.duration=0},j=function e(t){Object(a.a)(this,e),this.typeWorkerQuota=t,this.tasks=new Array,this.numWorkers=0,this.statistics=new _},_=function e(){Object(a.a)(this,e),this.requests=0,this.size=0,this.duration=0,this.speed=0},w=function(){function e(t,r,n,i){Object(a.a)(this,e),this._workerFunc=t,this._callbackFunc=r,this._maxTotalNumWorkers=n,this._totalNumWorkers=0,this._clients=i.map((function(e){return new j(e)}))}return Object(o.a)(e,[{key:"hasQuota",value:function(e){var t=this._clients[e];return!!t&&(this._totalNumWorkers<this._maxTotalNumWorkers||t.numWorkers+t.tasks.length<t.typeWorkerQuota)}},{key:"push",value:function(e){var t=this,r=this._clients[e.client];r&&(this._totalNumWorkers<this._maxTotalNumWorkers?(r.numWorkers++,this._totalNumWorkers++,this._workerFunc(e,(function(e,r){return t._taskCallback(e,r)}))):r.tasks.push(e))}},{key:"cancel",value:function(e){this._taskFinished(e),e._cancelled=!0}},{key:"destroy",value:function(){this._clients.length=0}},{key:"_taskFinished",value:function(e){var t=this._clients[e.client];this._totalNumWorkers--,t.numWorkers--,t.statistics.requests++,t.statistics.size+=e.size||0,t.statistics.duration+=e.duration||0,t.statistics.speed=t.statistics.duration>0?t.statistics.size/t.statistics.duration:0,Object(g.a)(t.numWorkers>=0),this._next()}},{key:"_next",value:function(){var e,t=Object(i.a)(this._clients);try{for(t.s();!(e=t.n()).done;){var r=e.value;if(r&&r.numWorkers<r.typeWorkerQuota&&this._processQueue(r))return}}catch(s){t.e(s)}finally{t.f()}var n,a=Object(i.a)(this._clients);try{for(a.s();!(n=a.n()).done;){var o=n.value;if(o&&this._processQueue(o))return}}catch(s){a.e(s)}finally{a.f()}}},{key:"_processQueue",value:function(e){for(var t=this;e.tasks.length>0;)if(this._workerFunc(e.tasks.shift(),(function(e,r){return t._taskCallback(e,r)})))return e.numWorkers++,this._totalNumWorkers++,!0;return!1}},{key:"_taskCallback",value:function(e,t){e._cancelled||(this._callbackFunc(e,t),this._taskFinished(e))}},{key:"getStatsForType",value:function(e){var t=this._clients[e];return t?{quota:t.typeWorkerQuota,workers:t.numWorkers,queueSize:t.tasks.length,requestStats:t.statistics}:null}},{key:"test",get:function(){var e=this;return{set workerFunc(t){e._workerFunc=t}}}}]),e}(),x=function(e){Object(s.a)(r,e);var t=Object(c.a)(r);function r(e,n,i,o,s){var c;return Object(a.a)(this,r),(c=t.call(this,o)).url=e,c.options=n,c.docType=i,c.key=s,c.result=null,c.status=1,c.request=null,c.abortController=null,c.resolvers=new Array,c.startTime=0,c}return r}(O),k=r(97),S=function(e){Object(s.a)(r,e);var t=Object(c.a)(r);function r(){var e;return Object(a.a)(this,r),(e=t.apply(this,arguments)).tasks=new Map,e.onLoadQueue=new Array,e.doneQueue=new Array,e.updating=!1,e}return Object(o.a)(r,[{key:"setup",value:function(e,t,r){var n=this;this.loadQueue=new w((function(e,t){return n.startLoading(e,t)}),(function(e,t){return n.doneLoadingCallback(e,t)}),e,t),r&&(this.taskHandle=r.registerTask(k.b.STREAM_DATA_LOADER,this))}},{key:"destroy",value:function(){this.taskHandle=Object(b.r)(this.taskHandle),this.tasks.forEach((function(e){e.abortController&&e.abortController.abort()})),this.loadQueue.destroy(),this.loadQueue=null,this.onLoadQueue=null,this.doneQueue=null,this.tasks=null}},{key:"hasDownloadSlots",value:function(e){return this.loadQueue.hasQuota(e)}},{key:"request",value:function(e,t,r){var n=this,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},a=Object(v.h)();a.__signal=Object(b.j)(i)?i.signal:null;var o=this.createOrUpdateTask(e,t,r,i,a);return Object(v.s)(i,(function(){return n.cancelRequest(o,a)})),a.promise}},{key:"createTask",value:function(e,t,r,n,i,a){var o=new x(e,t,r,n,i);return this.updateTask(o,a),this.tasks.set(i,o),1===this.tasks.size&&this._set("updating",!0),this.loadQueue.push(o),o}},{key:"cancelRequest",value:function(e,t){Object(h.k)(e.resolvers,t),t.reject(Object(v.f)()),0===e.resolvers.length&&(2===e.status&&(e.status=4,this.loadQueue.cancel(e),e.abortController.abort(),e.request=null,e.abortController=null),e.status=4,this.tasks.delete(e.key),0===this.tasks.size&&this._set("updating",!1))}},{key:"taskKey",value:function(e,t,r){return"".concat(e,":").concat(t,":").concat(r)}},{key:"updateTask",value:function(e,t){e.resolvers.push(t)}},{key:"createOrUpdateTask",value:function(e,t,r,n,i){var a=Object(b.j)(n)&&n.uid||e,o=this.taskKey(a,t,r),s=this.tasks.get(o);return s?(this.updateTask(s,i),s):this.createTask(e,n,t,r,o,i)}},{key:"doneLoadingCallback",value:function(e,t){this.loadQueue&&(Object(g.a)(2===e.status),e.status=3,this.taskHandle?this.doneQueue.push({task:e,err:t}):this.doneLoading(e,t))}},{key:"running",get:function(){return this.doneQueue.length>0||this.onLoadQueue.length>0}},{key:"runTask",value:function(e){for(;!e.done&&this.onLoadQueue.length>0;){var t=this.onLoadQueue.shift();Object(v.x)(t.task.abortController),t.task.abortController=null,t.callback(t.task),e.madeProgress()}for(;!e.done&&this.doneQueue.length>0;){var r=this.doneQueue.shift();3!==r.task.status&&(r.err=r.err||Object(v.f)()),this.doneLoading(r.task,r.err),e.madeProgress()}}},{key:"doneLoading",value:function(e,t){var r,n=e.result instanceof HTMLImageElement?0:e.resolvers.length,a=Object(i.a)(e.resolvers);try{for(a.s();!(r=a.n()).done;){var o=r.value;if(t)Object(v.n)(t)?o.reject(t):o.reject(new f.a("stream-data-loader:request-error","Failed to request resource at '".concat(e.url,"'. ").concat(t),{url:e.url,error:t}));else{var s=--n<=0?e.result:Object(p.a)(e.result);o.resolve(s)}}}catch(c){a.e(c)}finally{a.f()}this.tasks.delete(e.key),0===this.tasks.size&&this._set("updating",!1)}},{key:"startLoading",value:function(e,t){var r,i,a=this;if(4===e.status)return!1;switch(e.startTime=performance.now(),e.status=2,e.docType){case"binary":i="array-buffer",r=0;break;case"image":i="image";break;case"image+type":i="array-buffer";break;default:i="json"}e.abortController=Object(v.e)();var o=e.abortController.signal;e.request=Object(u.default)(e.url,Object(n.a)(Object(n.a)({},e.options),{},{responseType:i,timeout:r,signal:o}));var s=function(){},c=function(r){e.duration=performance.now()-e.startTime,e.size=r instanceof ArrayBuffer?r.byteLength:e.size||0,e.result=r,a.taskHandle?a.onLoadQueue.push({callback:t,task:e}):(e.abortController=null,t(e))},l=function(r){2===e.status&&t(e,r),s()};return"image+type"!==e.docType?(e.request.then((function(e){return c(e.data)}),l),!0):(e.request.then((function(t){var n=t.data,a=function(e){if(e.byteLength<2)return"unknown";var t=new Uint8Array(e,0,e.byteLength);return 137===t[0]&&80===t[1]?"image/png":71===t[0]&&73===t[1]?"image/gif":66===t[0]&&77===t[1]?"image/bmp":255===t[0]&&216===t[1]?"image/jpeg":"unknown"}(n);if(i="image",e.size=n.byteLength,"unknown"===a)return e.request=Object(u.default)(e.url,{responseType:i,timeout:r,signal:o}),void e.request.then((function(e){return c(e.data)}),l);var d=new Blob([n],{type:a}),h=window.URL.createObjectURL(d);s=function(){return window.URL.revokeObjectURL(h)},e.request=Object(u.default)(h,{responseType:i,timeout:r,signal:o}),e.request.then((function(e){return c(new T(e.data,a,s))}),l)}),l),!0)}},{key:"test",get:function(){return{loadQueue:this.loadQueue}}}]),r}(d.a);Object(l.a)([Object(m.b)({readOnly:!0})],S.prototype,"updating",void 0),S=Object(l.a)([Object(y.a)("esri.views.3d.support.StreamDataLoader")],S);var T=function(){function e(t,r,n){Object(a.a)(this,e),this.image=t,this.type=r,this.release=n}return Object(o.a)(e,[{key:"isOpaque",get:function(){return"image/jpeg"===this.type}}]),e}(),C=S;t.b=C},function(e,t,r){"use strict";r.d(t,"a",(function(){return j})),r.d(t,"b",(function(){return O}));var n=r(2),i=r(5),a=r(3),o=r(9),s=r(81),c=r(107),l=r(382),u=(r(122),r(159),r(60)),d=r(104),h=r(360),f=r(46),p=r(8),b=r.n(p),v=r(16);function m(){return(m=Object(v.a)(b.a.mark((function e(t){var r,n,i,a,o,h,f,p,v,m,y,g,O;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(r=new Image).src="data:image/svg+xml,%3C%3Fxml version='1.0' encoding='UTF-8'%3F%3E%3Csvg width='5' height='5' version='1.1' viewBox='0 0 5 5' xmlns='http://www.w3.org/2000/svg'%3E%3Crect width='5' height='5' fill='%23f00' fill-opacity='.5'/%3E%3C/svg%3E%0A",r.width=5,r.height=5,e.next=6,r.decode();case 6:if(t.gl){e.next=8;break}return e.abrupt("return",!0);case 8:return n=new c.a(t,{colorTarget:0,depthStencilTarget:0},{target:3553,wrapMode:33071,pixelFormat:6408,dataType:5121,samplingMode:9728,width:1,height:1}),i=s.a.createVertex(t,35044,new Uint16Array([0,0,1,0,0,1,1,1])),a=new d.a(t,new Map([["a_pos",0]]),{geometry:[{name:"a_pos",count:2,type:5123,offset:0,stride:4,normalized:!1}]},{geometry:i}),o=new l.a(t,"\n  precision highp float;\n\n  attribute vec2 a_pos;\n  varying vec2 v_uv;\n\n  void main() {\n    v_uv = a_pos;\n    gl_Position = vec4(a_pos * 2.0 - 1.0, 0.0, 1.0);\n  }\n  ","\n  precision highp float;\n\n  varying vec2 v_uv;\n  uniform sampler2D u_texture;\n\n  void main() {\n    gl_FragColor = texture2D(u_texture, v_uv);\n  }\n  ",new Map([["a_pos",0]])),t.useProgram(o),h=new u.a(t,{dataType:5121,pixelFormat:6408,preMultiplyAlpha:!1,wrapMode:33071,samplingMode:9729},r),t.bindTexture(h,0),o.setUniform1i("u_texture",0),f=t.getBoundFramebufferObject(),p=t.getViewport(),v=p.x,m=p.y,y=p.width,g=p.height,t.bindFramebuffer(n),t.setViewport(0,0,1,1),t.bindVAO(a),t.drawArrays(5,0,4),O=new Uint8Array(4),e.abrupt("return",(n.readPixels(0,0,1,1,6408,5121,O),o.dispose(),a.dispose(!1),i.dispose(),n.dispose(),h.dispose(),t.setViewport(v,m,y,g),t.bindFramebuffer(f),r.src="",255===O[0]));case 16:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var y=function(){function e(t){var r=this;Object(n.a)(this,e),this.context=t,this.svgAlwaysPremultipliesAlpha=!1,this._doublePrecisionRequiresObfuscation=null,function(e){return m.apply(this,arguments)}(t).then((function(e){return r.svgAlwaysPremultipliesAlpha=!e}))}return Object(i.a)(e,[{key:"doublePrecisionRequiresObfuscation",get:function(){if(Object(a.i)(this._doublePrecisionRequiresObfuscation)){var e=_(this.context,!1),t=_(this.context,!0);this._doublePrecisionRequiresObfuscation=0!==e&&(0===t||e/t>5)}return this._doublePrecisionRequiresObfuscation}}]),e}(),g=null;function O(e){return(Object(a.i)(g)||g.context!==e)&&(g=new y(e)),g}function j(e){Object(a.j)(g)&&g.context===e&&(g=null)}function _(e,t){var r=new c.a(e,{colorTarget:0,depthStencilTarget:0},{target:3553,wrapMode:33071,pixelFormat:6408,dataType:5121,samplingMode:9728,width:1,height:1});var n=s.a.createVertex(e,35044,new Uint16Array([0,0,1,0,0,1,1,1])),i=new d.a(e,new Map([["position",0]]),{geometry:[{name:"position",count:2,type:5123,offset:0,stride:4,normalized:!1}]},{geometry:n}),a=Object(o.g)(5633261.287538229,2626832.878767164,1434988.0495278358),u=Object(o.g)(5633271.46742708,2626873.6381334523,1434963.231608387),p=function(r,n){var i=new l.a(e,"\n\n  precision highp float;\n\n  attribute vec2 position;\n\n  uniform vec3 u_highA;\n  uniform vec3 u_lowA;\n  uniform vec3 u_highB;\n  uniform vec3 u_lowB;\n\n  varying vec4 v_color;\n\n  ".concat(t?"#define DOUBLE_PRECISION_REQUIRES_OBFUSCATION":"","\n\n  #ifdef DOUBLE_PRECISION_REQUIRES_OBFUSCATION\n\n  vec3 dpPlusFrc(vec3 a, vec3 b) {\n    return mix(a, a + b, vec3(notEqual(b, vec3(0))));\n  }\n\n  vec3 dpMinusFrc(vec3 a, vec3 b) {\n    return mix(vec3(0), a - b, vec3(notEqual(a, b)));\n  }\n\n  vec3 dpAdd(vec3 hiA, vec3 loA, vec3 hiB, vec3 loB) {\n    vec3 t1 = dpPlusFrc(hiA, hiB);\n    vec3 e = dpMinusFrc(t1, hiA);\n    vec3 t2 = dpMinusFrc(hiB, e) + dpMinusFrc(hiA, dpMinusFrc(t1, e)) + loA + loB;\n    return t1 + t2;\n  }\n\n  #else\n\n  vec3 dpAdd(vec3 hiA, vec3 loA, vec3 hiB, vec3 loB) {\n    vec3 t1 = hiA + hiB;\n    vec3 e = t1 - hiA;\n    vec3 t2 = ((hiB - e) + (hiA - (t1 - e))) + loA + loB;\n    return t1 + t2;\n  }\n\n  #endif\n\n  const float MAX_RGBA_FLOAT =\n    255.0 / 256.0 +\n    255.0 / 256.0 / 256.0 +\n    255.0 / 256.0 / 256.0 / 256.0 +\n    255.0 / 256.0 / 256.0 / 256.0 / 256.0;\n\n  const vec4 FIXED_POINT_FACTORS = vec4(1.0, 256.0, 256.0 * 256.0, 256.0 * 256.0 * 256.0);\n\n  vec4 float2rgba(const float value) {\n    // Make sure value is in the domain we can represent\n    float valueInValidDomain = clamp(value, 0.0, MAX_RGBA_FLOAT);\n\n    // Decompose value in 32bit fixed point parts represented as\n    // uint8 rgba components. Decomposition uses the fractional part after multiplying\n    // by a power of 256 (this removes the bits that are represented in the previous\n    // component) and then converts the fractional part to 8bits.\n    vec4 fixedPointU8 = floor(fract(valueInValidDomain * FIXED_POINT_FACTORS) * 256.0);\n\n    // Convert uint8 values (from 0 to 255) to floating point representation for\n    // the shader\n    const float toU8AsFloat = 1.0 / 255.0;\n\n    return fixedPointU8 * toU8AsFloat;\n  }\n\n  void main() {\n    vec3 val = dpAdd(u_highA, u_lowA, -u_highB, -u_lowB);\n\n    v_color = float2rgba(val.z / 25.0);\n\n    gl_Position = vec4(position * 2.0 - 1.0, 0.0, 1.0);\n  }\n  "),"\n  precision highp float;\n\n  varying vec4 v_color;\n\n  void main() {\n    gl_FragColor = v_color;\n  }\n  ",new Map([["position",0]])),a=new Float32Array(6);Object(h.a)(r,a,3);var o=new Float32Array(6);return Object(h.a)(n,o,3),e.useProgram(i),i.setUniform3f("u_highA",a[0],a[2],a[4]),i.setUniform3f("u_lowA",a[1],a[3],a[5]),i.setUniform3f("u_highB",o[0],o[2],o[4]),i.setUniform3f("u_lowB",o[1],o[3],o[5]),i}(a,u),b=e.getBoundFramebufferObject(),v=e.getViewport(),m=v.x,y=v.y,g=v.width,O=v.height;e.bindFramebuffer(r),e.setViewport(0,0,1,1),e.bindVAO(i),e.drawArrays(5,0,4);var j=new Uint8Array(4);r.readPixels(0,0,1,1,6408,5121,j),p.dispose(),i.dispose(!1),n.dispose(),r.dispose(),e.setViewport(m,y,g,O),e.bindFramebuffer(b);var _=(a[2]-u[2])/25,w=Object(f.n)(j);return Math.abs(_-w)}},function(e,t,r){"use strict";r.d(t,"a",(function(){return k})),r.d(t,"b",(function(){return M})),r.d(t,"c",(function(){return j})),r.d(t,"d",(function(){return C}));var n=r(13),i=r(2),a=r(5),o=r(184),s=r(25),c=r(502),l=r(141),u=r(458),d=r(200),h=r(300),f=r(114),p=function(){function e(){Object(i.a)(this,e),this.uid=0,this.target=null,this.path=null,this.oldValue=null,this.callback=null,this.getValue=null,this.removed=!1,this.propertyPath=null}return Object(a.a)(e,[{key:"acquire",value:function(t,r,n,i,a){this.target=t,this.path=r,this.oldValue=n,this.callback=i,this.getValue=a,this.propertyPath=Object(f.g)(r),this.uid=++e.uid,this.removed=!1}},{key:"release",value:function(){this.target=this.path=this.propertyPath=this.callback=this.oldValue=null,this.uid=++e.uid,this.removed=!0}}]),e}();p.pool=new c.a(p),p.uid=0;var b,v=new o.a,m=new Set;function y(e){m.delete(e),m.add(e),b||(b=Object(l.b)(_))}function g(e){if(!e.removed){var t=e.callback,r=e.path,n=e.oldValue,i=e.target,a=e.getValue();O(n,a)&&(e.oldValue=a,t.call(i,a,n,r,i))}}function O(e,t){return!Object(s.b)(e,t)}function j(e){var t,r=Object(n.a)(m.values());try{for(r.s();!(t=r.n()).done;){var i=t.value;i.target===e&&(i.removed=!0)}}catch(a){r.e(a)}finally{r.f()}}function _(){for(var e=10;b&&e--;){b=null;var t,r=w(),i=v.acquire(),a=Object(n.a)(r);try{for(a.s();!(t=a.n()).done;){var o=t.value,s=o.uid;g(o),s===o.uid&&o.removed&&i.push(o)}}catch(h){a.e(h)}finally{a.f()}var c,l=Object(n.a)(m);try{for(l.s();!(c=l.n()).done;){var u=c.value;u.removed&&(i.push(u),m.delete(u))}}catch(h){l.e(h)}finally{l.f()}for(var d=0;d<i.length;d++)p.pool.release(i[d]);v.release(i),v.release(r),x.forEach((function(e){return e()}))}}function w(){var e=v.acquire();e.length=m.size;var t,r=0,i=Object(n.a)(m);try{for(i.s();!(t=i.n()).done;){var a=t.value;e[r]=a,++r}}catch(o){i.e(o)}finally{i.f()}return m.clear(),e}var x=new Set;function k(e){return x.add(e),{remove:function(){x.delete(e)}}}function S(e,t,r){var n=Object(f.e)(e,t,r,(function(e,t,r){var i,a,o=Object(h.c)((function(){return Object(d.c)(e,t)}),(function(o,s){e.__accessor__.destroyed||i&&i.uid!==a?n.remove():(i||(i=p.pool.acquire(e,t,o,r,s),a=i.uid),y(i))}));return{remove:Object(f.d)((function(){o.remove(),i&&(i.uid!==a||i.removed||(i.removed=!0,y(i)),i=null),n=o=null}))}}));return n}function T(e,t,r){var n=Object(f.e)(e,t,r,(function(e,t,r){var i=!1;return Object(h.b)((function(){return Object(d.c)(e,t)}),(function(a,o){e.__accessor__.destroyed?n.remove():i||(i=!0,O(o,a)&&r.call(e,a,o,t,e),i=!1)}))}));return n}function C(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return!e.__accessor__||e.__accessor__.destroyed?{remove:function(){}}:n?T(e,t,r):S(e,t,r)}function M(e){return Object(u.a)(m,(function(t){return t.oldValue===e}))}},function(e,t,r){"use strict";var n=r(13),i=r(71);var a=i.a.queueMicrotask?i.a.queueMicrotask:function(e){i.a.Promise.resolve().then(e)},o=[],s=[];function c(e){o.push(e),1===o.length&&a((function(){var e,t=Object(n.a)(s);try{for(t.s();!(e=t.n()).done;){(0,e.value)()}}catch(c){t.e(c)}finally{t.f()}var r=o.slice();o.length=0;var i,a=Object(n.a)(r);try{for(a.s();!(i=a.n()).done;){(0,i.value)()}}catch(c){a.e(c)}finally{a.f()}}))}(c||(c={})).before=function(e){return s.push(e),{remove:function(){s=s.filter((function(t){return t!==e}))}}};var l=c;t.a=l},function(e,t,r){"use strict";function n(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=e.hasM,i=e.hasZ;Array.isArray(t)?4!==t.length||n||i?3===t.length&&r&&!n?(i=!0,n=!1):3===t.length&&n&&i&&(n=!1,i=!1):(n=!0,i=!0):(i=!i&&t.hasZ&&(!n||t.hasM),n=!n&&t.hasM&&(!i||t.hasZ)),e.hasZ=i,e.hasM=n}r.d(t,"a",(function(){return n}))},function(e,t,r){"use strict";var n,i=r(2),a=r(5),o=r(6),s=r(7),c=r(0),l=r(1),u=(r(17),r(18),r(15),r(10)),d=r(329),h=n=function(e){Object(o.a)(r,e);var t=Object(s.a)(r);function r(e){var n;return Object(i.a)(this,r),(n=t.call(this,e)).image=null,n.type="button",n}return Object(a.a)(r,[{key:"clone",value:function(){return new n({active:this.active,className:this.className,disabled:this.disabled,id:this.id,indicator:this.indicator,title:this.title,visible:this.visible,image:this.image})}}]),r}(d.a);Object(c.a)([Object(l.b)()],h.prototype,"image",void 0);var f=h=n=Object(c.a)([Object(u.a)("esri.support.Action.ActionButton")],h);t.a=f},function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var n=r(69),i=r(72),a={inches:Object(n.c)(1,"meters","inches"),feet:Object(n.c)(1,"meters","feet"),"us-feet":Object(n.c)(1,"meters","us-feet"),yards:Object(n.c)(1,"meters","yards"),miles:Object(n.c)(1,"meters","miles"),"nautical-miles":Object(n.c)(1,"meters","nautical-miles"),millimeters:Object(n.c)(1,"meters","millimeters"),centimeters:Object(n.c)(1,"meters","centimeters"),decimeters:Object(n.c)(1,"meters","decimeters"),meters:Object(n.c)(1,"meters","meters"),kilometers:Object(n.c)(1,"meters","kilometers"),"decimal-degrees":1/Object(n.l)(1,"meters",i.a.radius)}},function(e,t,r){"use strict";var n,i=r(2),a=r(5),o=r(6),s=r(7),c=r(0),l=r(58),u=r(27),d=r(1),h=(r(17),r(18)),f=(r(15),r(52)),p=r(48),b=r(10),v=r(249),m=r(596),y=new l.a({binary:"binary",coordinate:"coordinate",countOrAmount:"count-or-amount",dateAndTime:"date-and-time",description:"description",locationOrPlaceName:"location-or-place-name",measurement:"measurement",nameOrTitle:"name-or-title",none:"none",orderedOrRanked:"ordered-or-ranked",percentageOrRatio:"percentage-or-ratio",typeOrCategory:"type-or-category",uniqueIdentifier:"unique-identifier"}),g=n=function(e){Object(o.a)(r,e);var t=Object(s.a)(r);function r(e){var n;return Object(i.a)(this,r),(n=t.call(this,e)).alias=null,n.defaultValue=void 0,n.description=null,n.domain=null,n.editable=!0,n.length=-1,n.name=null,n.nullable=!0,n.type=null,n.valueType=null,n}return Object(a.a)(r,[{key:"readDescription",value:function(e,t){var r,n=t.description;try{r=JSON.parse(n)}catch(i){}return r?r.value:null}},{key:"readValueType",value:function(e,t){var r,n=t.description;try{r=JSON.parse(n)}catch(i){}return r?y.fromJSON(r.fieldValueType):null}},{key:"clone",value:function(){return new n({alias:this.alias,defaultValue:this.defaultValue,description:this.description,domain:this.domain&&this.domain.clone()||null,editable:this.editable,length:this.length,name:this.name,nullable:this.nullable,type:this.type,valueType:this.valueType})}}]),r}(u.a);Object(c.a)([Object(d.b)({type:String,json:{write:!0}})],g.prototype,"alias",void 0),Object(c.a)([Object(d.b)({type:[String,Number],json:{write:{allowNull:!0}}})],g.prototype,"defaultValue",void 0),Object(c.a)([Object(d.b)()],g.prototype,"description",void 0),Object(c.a)([Object(p.a)("description")],g.prototype,"readDescription",null),Object(c.a)([Object(d.b)({types:v.d,json:{read:{reader:v.b},write:!0}})],g.prototype,"domain",void 0),Object(c.a)([Object(d.b)({type:Boolean,json:{write:!0}})],g.prototype,"editable",void 0),Object(c.a)([Object(d.b)({type:h.a,json:{write:!0}})],g.prototype,"length",void 0),Object(c.a)([Object(d.b)({type:String,json:{write:!0}})],g.prototype,"name",void 0),Object(c.a)([Object(d.b)({type:Boolean,json:{write:!0}})],g.prototype,"nullable",void 0),Object(c.a)([Object(f.a)(m.a)],g.prototype,"type",void 0),Object(c.a)([Object(d.b)()],g.prototype,"valueType",void 0),Object(c.a)([Object(p.a)("valueType",["description"])],g.prototype,"readValueType",null);var O=g=n=Object(c.a)([Object(b.a)("esri.layers.support.Field")],g);t.a=O},function(e,t,r){"use strict";r.d(t,"a",(function(){return n})),r.d(t,"b",(function(){return i})),r.d(t,"c",(function(){return a})),r.d(t,"d",(function(){return s})),r.d(t,"e",(function(){return o})),r.d(t,"f",(function(){return c})),r.d(t,"g",(function(){return l})),r.d(t,"h",(function(){return d})),r.d(t,"i",(function(){return u}));var n=[252,146,31,255],i=[153,153,153,255],a={type:"esriSMS",style:"esriSMSCircle",size:6,color:n,outline:{type:"esriSLS",style:"esriSLSSolid",width:.75,color:[153,153,153,255]}},o={type:"esriSLS",style:"esriSLSSolid",width:.75,color:n},s={type:"esriSFS",style:"esriSFSSolid",color:[252,146,31,196],outline:{type:"esriSLS",style:"esriSLSSolid",width:.75,color:[255,255,255,191]}},c={type:"esriTS",color:[255,255,255,255],font:{family:"arial-unicode-ms",size:10,weight:"bold"},horizontalAlignment:"center",kerning:!0,haloColor:[0,0,0,255],haloSize:1,rotated:!1,text:"",xoffset:0,yoffset:0,angle:0},l={type:"esriSMS",style:"esriSMSCircle",color:[0,0,0,255],outline:null,size:10.5},u={type:"esriSLS",style:"esriSLSSolid",color:[0,0,0,255],width:1.5},d={type:"esriSFS",style:"esriSFSSolid",color:[0,0,0,255],outline:null}},function(e,t,r){"use strict";r.d(t,"a",(function(){return s}));var n,i,a=r(12),o=r(11);function s(e,t){var r=e.fragment;t.receiveAmbientOcclusion?(r.uniforms.add("ssaoTex","sampler2D"),r.uniforms.add("viewportPixelSz","vec4"),r.code.add(Object(o.a)(n||(n=Object(a.a)(["float evaluateAmbientOcclusion() {\nreturn 1.0 - texture2D(ssaoTex, (gl_FragCoord.xy - viewportPixelSz.xy) * viewportPixelSz.zw).a;\n}\nfloat evaluateAmbientOcclusionInverse() {\nfloat ssao = texture2D(ssaoTex, (gl_FragCoord.xy - viewportPixelSz.xy) * viewportPixelSz.zw).a;\nreturn viewportPixelSz.z < 0.0 ? 1.0 : ssao;\n}"]))))):r.code.add(Object(o.a)(i||(i=Object(a.a)(["float evaluateAmbientOcclusion() { return 0.0; }\nfloat evaluateAmbientOcclusionInverse() { return 1.0; }"]))))}},function(e,t,r){"use strict";var n,i=r(2),a=r(5),o=r(45),s=r(42),c=r(6),l=r(7),u=r(0),d=r(25),h=r(28),f=r(1),p=(r(18),r(17),r(15),r(52)),b=r(48),v=r(10),m=r(389),y=r(403),g=n=function(e){Object(c.a)(r,e);var t=Object(l.a)(r);function r(){var e;Object(i.a)(this,r);for(var n=arguments.length,a=new Array(n),o=0;o<n;o++)a[o]=arguments[o];return(e=t.call.apply(t,[this].concat(a))).color=null,e.type="picture-marker",e.url=null,e.source=null,e.height=12,e.width=12,e.size=null,e}return Object(a.a)(r,[{key:"normalizeCtorArgs",value:function(e,t,r){if(e&&"string"!=typeof e&&null==e.imageData)return e;var n={};return e&&(n.url=e),null!=t&&(n.width=Object(h.j)(t)),null!=r&&(n.height=Object(h.j)(r)),n}},{key:"readHeight",value:function(e,t){return t.size||e}},{key:"readWidth",value:function(e,t){return t.size||e}},{key:"clone",value:function(){var e=new n({angle:this.angle,height:this.height,url:this.url,width:this.width,xoffset:this.xoffset,yoffset:this.yoffset});return e._set("source",Object(d.a)(this.source)),e}},{key:"hash",value:function(){return"".concat(Object(o.a)(Object(s.a)(r.prototype),"hash",this).call(this),".").concat(this.height,".").concat(this.url,".").concat(this.width)}}]),r}(m.a);Object(u.a)([Object(f.b)({json:{write:!1}})],g.prototype,"color",void 0),Object(u.a)([Object(p.a)({esriPMS:"picture-marker"},{readOnly:!0})],g.prototype,"type",void 0),Object(u.a)([Object(f.b)(y.b)],g.prototype,"url",void 0),Object(u.a)([Object(f.b)(y.a)],g.prototype,"source",void 0),Object(u.a)([Object(f.b)({type:Number,cast:h.j,json:{write:!0}})],g.prototype,"height",void 0),Object(u.a)([Object(b.a)("height",["height","size"])],g.prototype,"readHeight",null),Object(u.a)([Object(f.b)({type:Number,cast:h.j,json:{write:!0}})],g.prototype,"width",void 0),Object(u.a)([Object(f.b)({json:{write:!1}})],g.prototype,"size",void 0);var O=g=n=Object(u.a)([Object(v.a)("esri.symbols.PictureMarkerSymbol")],g);t.a=O},function(e,t,r){"use strict";r.d(t,"a",(function(){return f})),r.d(t,"b",(function(){return p}));var n,i,a,o,s,c,l,u=r(12),d=r(323),h=r(11);function f(e,t){var r=e;r.include(d.a),r.attributes.add("position","vec3"),r.attributes.add("normal","vec3"),r.attributes.add("auxpos1","vec4"),r.vertex.uniforms.add("proj","mat4"),r.vertex.uniforms.add("view","mat4"),r.vertex.uniforms.add("viewNormal","mat4"),r.vertex.uniforms.add("viewport","vec4"),r.vertex.uniforms.add("camPos","vec3"),r.vertex.uniforms.add("polygonOffset","float"),r.vertex.uniforms.add("cameraGroundRelative","float"),r.vertex.uniforms.add("pixelRatio","float"),r.vertex.uniforms.add("perDistancePixelRatio","float"),r.vertex.uniforms.add("uRenderTransparentlyOccludedHUD","float"),t.verticalOffsetEnabled&&r.vertex.uniforms.add("verticalOffset","vec4"),t.screenSizePerspectiveEnabled&&r.vertex.uniforms.add("screenSizePerspectiveAlignment","vec4"),r.vertex.uniforms.add("hudVisibilityTexture","sampler2D"),r.vertex.constants.add("smallOffsetAngle","float",.984807753012208),r.vertex.code.add(Object(h.a)(n||(n=Object(u.a)(["struct ProjectHUDAux {\nvec3 posModel;\nvec3 posView;\nvec3 vnormal;\nfloat distanceToCamera;\nfloat absCosAngle;\n};"])))),r.vertex.code.add(Object(h.a)(i||(i=Object(u.a)(["float applyHUDViewDependentPolygonOffset(float pointGroundDistance, float absCosAngle, inout vec3 posView) {\nfloat pointGroundSign = sign(pointGroundDistance);\nif (pointGroundSign == 0.0) {\npointGroundSign = cameraGroundRelative;\n}\nfloat groundRelative = cameraGroundRelative * pointGroundSign;\nif (polygonOffset > .0) {\nfloat cosAlpha = clamp(absCosAngle, 0.01, 1.0);\nfloat tanAlpha = sqrt(1.0 - cosAlpha * cosAlpha) / cosAlpha;\nfloat factor = (1.0 - tanAlpha / viewport[2]);\nif (groundRelative > 0.0) {\nposView *= factor;\n}\nelse {\nposView /= factor;\n}\n}\nreturn groundRelative;\n}"])))),t.isDraped||r.vertex.code.add(Object(h.a)(a||(a=Object(u.a)(["void applyHUDVerticalGroundOffset(vec3 normalModel, inout vec3 posModel, inout vec3 posView) {\nfloat distanceToCamera = length(posView);\nfloat pixelOffset = distanceToCamera * perDistancePixelRatio * 0.5;\nvec3 modelOffset = normalModel * cameraGroundRelative * pixelOffset;\nvec3 viewOffset = (viewNormal * vec4(modelOffset, 1.0)).xyz;\nposModel += modelOffset;\nposView += viewOffset;\n}"])))),r.vertex.code.add(Object(h.a)(o||(o=Object(u.a)(["\n    vec4 projectPositionHUD(out ProjectHUDAux aux) {\n      // centerOffset is in view space and is used to implement world size offsetting\n      // of labels with respect to objects. It also pulls the label towards the viewer\n      // so that the label is visible in front of the object.\n      vec3 centerOffset = auxpos1.xyz;\n\n      // The pointGroundDistance is the distance of the geometry to the ground and is\n      // negative if the point is below the ground, or positive if the point is above\n      // ground.\n      float pointGroundDistance = auxpos1.w;\n\n      aux.posModel = position;\n      aux.posView = (view * vec4(aux.posModel, 1.0)).xyz;\n      aux.vnormal = normal;\n      ","\n\n      // Screen sized offset in world space, used for example for line callouts\n      // Note: keep this implementation in sync with the CPU implementation, see\n      //   - MaterialUtil.verticalOffsetAtDistance\n      //   - HUDMaterial.applyVerticalOffsetTransformation\n\n      aux.distanceToCamera = length(aux.posView);\n\n      vec3 viewDirObjSpace = normalize(camPos - aux.posModel);\n      float cosAngle = dot(aux.vnormal, viewDirObjSpace);\n\n      aux.absCosAngle = abs(cosAngle);\n\n      ","\n\n      ","\n\n      ","\n\n      float groundRelative = applyHUDViewDependentPolygonOffset(pointGroundDistance, aux.absCosAngle, aux.posView);\n\n      ","\n\n      vec4 posProj = proj * vec4(aux.posView, 1.0);\n\n      ","\n\n      ","\n\n      // constant part of polygon offset emulation\n      posProj.z -= groundRelative * polygonOffset * posProj.w;\n      return posProj;\n    }\n  "])),t.isDraped?"":"applyHUDVerticalGroundOffset(aux.vnormal, aux.posModel, aux.posView);",t.screenSizePerspectiveEnabled&&(t.verticalOffsetEnabled||1===t.screenCenterOffsetUnitsEnabled)?"vec4 perspectiveFactor = screenSizePerspectiveScaleFactor(aux.absCosAngle, aux.distanceToCamera, screenSizePerspectiveAlignment);":"",t.verticalOffsetEnabled?t.screenSizePerspectiveEnabled?"float verticalOffsetScreenHeight = applyScreenSizePerspectiveScaleFactorFloat(verticalOffset.x, perspectiveFactor);":"float verticalOffsetScreenHeight = verticalOffset.x;":"",t.verticalOffsetEnabled?Object(h.a)(s||(s=Object(u.a)(["\n            float worldOffset = clamp(verticalOffsetScreenHeight * verticalOffset.y * aux.distanceToCamera, verticalOffset.z, verticalOffset.w);\n            vec3 modelOffset = aux.vnormal * worldOffset;\n            aux.posModel += modelOffset;\n            vec3 viewOffset = (viewNormal * vec4(modelOffset, 1.0)).xyz;\n            aux.posView += viewOffset;\n            // Since we elevate the object, we need to take that into account\n            // in the distance to ground\n            pointGroundDistance += worldOffset;"]))):"",1!==t.screenCenterOffsetUnitsEnabled?Object(h.a)(c||(c=Object(u.a)(["\n            // Apply x/y in view space, but z in screen space (i.e. along posView direction)\n            aux.posView += vec3(centerOffset.x, centerOffset.y, 0.0);\n\n            // Same material all have same z != 0.0 condition so should not lead to\n            // branch fragmentation and will save a normalization if it's not needed\n            if (centerOffset.z != 0.0) {\n              aux.posView -= normalize(aux.posView) * centerOffset.z;\n            }\n          "]))):"",1===t.screenCenterOffsetUnitsEnabled?t.screenSizePerspectiveEnabled?"float centerOffsetY = applyScreenSizePerspectiveScaleFactorFloat(centerOffset.y, perspectiveFactor);":"float centerOffsetY = centerOffset.y;":"",1===t.screenCenterOffsetUnitsEnabled?"posProj.xy += vec2(centerOffset.x, centerOffsetY) * pixelRatio * 2.0 / viewport.zw * posProj.w;":"")),r.vertex.code.add(Object(h.a)(l||(l=Object(u.a)(["bool testVisibilityHUD(vec4 posProj) {\nvec4 posProjCenter = alignToPixelCenter(posProj, viewport.zw);\nvec4 occlusionPixel = texture2D(hudVisibilityTexture, .5 + .5 * posProjCenter.xy / posProjCenter.w);\nif (uRenderTransparentlyOccludedHUD > 0.5) {\nreturn occlusionPixel.r * occlusionPixel.g > 0.0 && occlusionPixel.g * uRenderTransparentlyOccludedHUD < 1.0;\n}\nreturn occlusionPixel.r * occlusionPixel.g > 0.0 && occlusionPixel.g == 1.0;\n}"]))))}function p(e,t){e.setUniform1f("uRenderTransparentlyOccludedHUD",0===t.renderTransparentlyOccludedHUD?1:1===t.renderTransparentlyOccludedHUD?0:.75)}},function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n,i=r(12),a=r(11);function o(e){e.attributes.add("position","vec3"),e.vertex.code.add(Object(a.a)(n||(n=Object(i.a)(["vec3 positionModel() { return position; }"]))))}},function(e,t,r){"use strict";r.d(t,"a",(function(){return j}));var n,i,a,o=r(12),s=r(11);function c(e){var t=e.fragment.code;t.add(Object(s.a)(n||(n=Object(o.a)(["vec3 evaluateDiffuseIlluminationHemisphere(vec3 ambientGround, vec3 ambientSky, float NdotNG)\n{\nreturn ((1.0 - NdotNG) * ambientGround + (1.0 + NdotNG) * ambientSky) * 0.5;\n}"])))),t.add(Object(s.a)(i||(i=Object(o.a)(["float integratedRadiance(float cosTheta2, float roughness)\n{\nreturn (cosTheta2 - 1.0) / (cosTheta2 * (1.0 - roughness * roughness) - 1.0);\n}"])))),t.add(Object(s.a)(a||(a=Object(o.a)(["vec3 evaluateSpecularIlluminationHemisphere(vec3 ambientGround, vec3 ambientSky, float RdotNG, float roughness)\n{\nfloat cosTheta2 = 1.0 - RdotNG * RdotNG;\nfloat intRadTheta = integratedRadiance(cosTheta2, roughness);\nfloat ground = RdotNG < 0.0 ? 1.0 - intRadTheta : 1.0 + intRadTheta;\nfloat sky = 2.0 - ground;\nreturn (ground * ambientGround + sky * ambientSky) * 0.5;\n}"]))))}var l,u,d,h,f,p,b,v,m,y,g,O=r(390);function j(e,t){var r=e.fragment.code;e.include(O.a),3===t.pbrMode||4===t.pbrMode?(r.add(Object(s.a)(l||(l=Object(o.a)(["\n    struct PBRShadingWater\n    {\n        float NdotL;   // cos angle between normal and light direction\n        float NdotV;   // cos angle between normal and view direction\n        float NdotH;   // cos angle between normal and half vector\n        float VdotH;   // cos angle between view direction and half vector\n        float LdotH;   // cos angle between light direction and half vector\n        float VdotN;   // cos angle between view direction and normal vector\n    };\n\n    float dtrExponent = ",";\n    "])),t.useCustomDTRExponentForWater?"2.2":"2.0")),r.add(Object(s.a)(u||(u=Object(o.a)(["vec3 fresnelReflection(float angle, vec3 f0, float f90) {\nreturn f0 + (f90 - f0) * pow(1.0 - angle, 5.0);\n}"])))),r.add(Object(s.a)(d||(d=Object(o.a)(["float normalDistributionWater(float NdotH, float roughness)\n{\nfloat r2 = roughness * roughness;\nfloat NdotH2 = NdotH * NdotH;\nfloat denom = pow((NdotH2 * (r2 - 1.0) + 1.0), dtrExponent) * PI;\nreturn r2 / denom;\n}"])))),r.add(Object(s.a)(h||(h=Object(o.a)(["float geometricOcclusionKelemen(float LoH)\n{\nreturn 0.25 / (LoH * LoH);\n}"])))),r.add(Object(s.a)(f||(f=Object(o.a)(["vec3 brdfSpecularWater(in PBRShadingWater props, float roughness, vec3 F0, float F0Max)\n{\nvec3  F = fresnelReflection(props.VdotH, F0, F0Max);\nfloat dSun = normalDistributionWater(props.NdotH, roughness);\nfloat V = geometricOcclusionKelemen(props.LdotH);\nfloat diffusionSunHaze = mix(roughness + 0.045, roughness + 0.385, 1.0 - props.VdotH);\nfloat strengthSunHaze  = 1.2;\nfloat dSunHaze = normalDistributionWater(props.NdotH, diffusionSunHaze)*strengthSunHaze;\nreturn ((dSun + dSunHaze) * V) * F;\n}\nvec3 tonemapACES(const vec3 x) {\nreturn (x * (2.51 * x + 0.03)) / (x * (2.43 * x + 0.59) + 0.14);\n}"]))))):1!==t.pbrMode&&2!==t.pbrMode||(e.include(c),r.add(Object(s.a)(p||(p=Object(o.a)(["struct PBRShadingInfo\n{\nfloat NdotL;\nfloat NdotV;\nfloat NdotH;\nfloat VdotH;\nfloat LdotH;\nfloat NdotNG;\nfloat RdotNG;\nfloat NdotAmbDir;\nfloat NdotH_Horizon;\nvec3 skyRadianceToSurface;\nvec3 groundRadianceToSurface;\nvec3 skyIrradianceToSurface;\nvec3 groundIrradianceToSurface;\nfloat averageAmbientRadiance;\nfloat ssao;\nvec3 albedoLinear;\nvec3 f0;\nvec3 f90;\nvec3 diffuseColor;\nfloat metalness;\nfloat roughness;\n};"])))),r.add(Object(s.a)(b||(b=Object(o.a)(["float normalDistribution(float NdotH, float roughness)\n{\nfloat a = NdotH * roughness;\nfloat b = roughness / (1.0 - NdotH * NdotH + a * a);\nreturn b * b * INV_PI;\n}"])))),r.add(Object(s.a)(v||(v=Object(o.a)(["const vec4 c0 = vec4(-1.0, -0.0275, -0.572,  0.022);\nconst vec4 c1 = vec4( 1.0,  0.0425,  1.040, -0.040);\nconst vec2 c2 = vec2(-1.04, 1.04);\nvec2 prefilteredDFGAnalytical(float roughness, float NdotV) {\nvec4 r = roughness * c0 + c1;\nfloat a004 = min(r.x * r.x, exp2(-9.28 * NdotV)) * r.x + r.y;\nreturn c2 * a004 + r.zw;\n}"])))),r.add(Object(s.a)(m||(m=Object(o.a)(["vec3 evaluateEnvironmentIllumination(PBRShadingInfo inputs) {\nvec3 indirectDiffuse = evaluateDiffuseIlluminationHemisphere(inputs.groundIrradianceToSurface, inputs.skyIrradianceToSurface, inputs.NdotNG);\nvec3 indirectSpecular = evaluateSpecularIlluminationHemisphere(inputs.groundRadianceToSurface, inputs.skyRadianceToSurface, inputs.RdotNG, inputs.roughness);\nvec3 diffuseComponent = inputs.diffuseColor * indirectDiffuse * INV_PI;\nvec2 dfg = prefilteredDFGAnalytical(inputs.roughness, inputs.NdotV);\nvec3 specularColor = inputs.f0 * dfg.x + inputs.f90 * dfg.y;\nvec3 specularComponent = specularColor * indirectSpecular;\nreturn (diffuseComponent + specularComponent);\n}"])))),r.add(Object(s.a)(y||(y=Object(o.a)(["float gamutMapChanel(float x, vec2 p){\nreturn (x < p.x) ? mix(0.0, p.y, x/p.x) : mix(p.y, 1.0, (x - p.x) / (1.0 - p.x) );\n}"])))),r.add(Object(s.a)(g||(g=Object(o.a)(["vec3 blackLevelSoftCompression(vec3 inColor, PBRShadingInfo inputs){\nvec3 outColor;\nvec2 p = vec2(0.02 * (inputs.averageAmbientRadiance), 0.0075 * (inputs.averageAmbientRadiance));\noutColor.x = gamutMapChanel(inColor.x, p) ;\noutColor.y = gamutMapChanel(inColor.y, p) ;\noutColor.z = gamutMapChanel(inColor.z, p) ;\nreturn outColor;\n}"])))))}},function(e,t,r){"use strict";r.d(t,"a",(function(){return u}));var n,i,a,o,s=r(12),c=r(11);function l(e){var t=Object(c.a)(n||(n=Object(s.a)(["vec3 decodeNormal(vec2 f) {\nfloat z = 1.0 - abs(f.x) - abs(f.y);\nreturn vec3(f + sign(f) * min(z, 0.0), z);\n}"])));e.fragment.code.add(t),e.vertex.code.add(t)}function u(e,t){0===t.normalType&&(e.attributes.add("normal","vec3"),e.vertex.code.add(Object(c.a)(i||(i=Object(s.a)(["vec3 normalModel() {\nreturn normal;\n}"]))))),1===t.normalType&&(e.include(l),e.attributes.add("normalCompressed","vec2"),e.vertex.code.add(Object(c.a)(a||(a=Object(s.a)(["vec3 normalModel() {\nreturn decodeNormal(normalCompressed);\n}"]))))),3===t.normalType&&(e.extensions.add("GL_OES_standard_derivatives"),e.fragment.code.add(Object(c.a)(o||(o=Object(s.a)(["vec3 screenDerivativeNormal(vec3 positionView) {\nreturn normalize(cross(dFdx(positionView), dFdy(positionView)));\n}"])))))}},function(e,t,r){"use strict";r.d(t,"a",(function(){return a})),r.d(t,"b",(function(){return o})),r.d(t,"c",(function(){return i}));var n=r(17),i=function(){return!!Object(n.a)("enable-feature:force-wosr")},a=function(){return!!Object(n.a)("enable-feature:disable-context-navigation")},o=function(){return!!Object(n.a)("enable-feature:direct-3d-object-feature-layer-display")}},function(e,t,r){"use strict";r.d(t,"a",(function(){return f})),r.d(t,"b",(function(){return p}));var n,i,a,o,s,c,l,u=r(12),d=r(11),h=r(102);function f(e){e.vertex.code.add(Object(d.a)(n||(n=Object(u.a)(["float screenSizePerspectiveMinSize(float size, vec4 factor) {\nfloat nonZeroSize = 1.0 - step(size, 0.0);\nreturn (\nfactor.z * (\n1.0 +\nnonZeroSize *\n2.0 * factor.w / (\nsize + (1.0 - nonZeroSize)\n)\n)\n);\n}"])))),e.vertex.code.add(Object(d.a)(i||(i=Object(u.a)(["float screenSizePerspectiveViewAngleDependentFactor(float absCosAngle) {\nreturn absCosAngle * absCosAngle * absCosAngle;\n}"])))),e.vertex.code.add(Object(d.a)(a||(a=Object(u.a)(["vec4 screenSizePerspectiveScaleFactor(float absCosAngle, float distanceToCamera, vec4 params) {\nreturn vec4(\nmin(params.x / (distanceToCamera - params.y), 1.0),\nscreenSizePerspectiveViewAngleDependentFactor(absCosAngle),\nparams.z,\nparams.w\n);\n}"])))),e.vertex.code.add(Object(d.a)(o||(o=Object(u.a)(["float applyScreenSizePerspectiveScaleFactorFloat(float size, vec4 factor) {\nreturn max(mix(size * factor.x, size, factor.y), screenSizePerspectiveMinSize(size, factor));\n}"])))),e.vertex.code.add(Object(d.a)(s||(s=Object(u.a)(["float screenSizePerspectiveScaleFloat(float size, float absCosAngle, float distanceToCamera, vec4 params) {\nreturn applyScreenSizePerspectiveScaleFactorFloat(\nsize,\nscreenSizePerspectiveScaleFactor(absCosAngle, distanceToCamera, params)\n);\n}"])))),e.vertex.code.add(Object(d.a)(c||(c=Object(u.a)(["vec2 applyScreenSizePerspectiveScaleFactorVec2(vec2 size, vec4 factor) {\nreturn mix(size * clamp(factor.x, screenSizePerspectiveMinSize(size.y, factor) / size.y, 1.0), size, factor.y);\n}"])))),e.vertex.code.add(Object(d.a)(l||(l=Object(u.a)(["vec2 screenSizePerspectiveScaleVec2(vec2 size, float absCosAngle, float distanceToCamera, vec4 params) {\nreturn applyScreenSizePerspectiveScaleFactorVec2(size, screenSizePerspectiveScaleFactor(absCosAngle, distanceToCamera, params));\n}"]))))}function p(e,t){if(t.screenSizePerspective){Object(h.a)(t.screenSizePerspective,e,"screenSizePerspective");var r=t.screenSizePerspectiveAlignment||t.screenSizePerspective;Object(h.a)(r,e,"screenSizePerspectiveAlignment")}}},function(e,t,r){"use strict";r.d(t,"a",(function(){return c})),r.d(t,"b",(function(){return s}));var n,i=r(12),a=r(120),o=r(11);function s(e){e.include(a.a),e.uniforms.add("geometryDepthTexture","sampler2D"),e.uniforms.add("cameraNearFar","vec2"),e.code.add(Object(o.a)(n||(n=Object(i.a)(["bool geometryDepthTest(vec2 pos, float elementDepth) {\nfloat geometryDepth = linearDepthFromTexture(geometryDepthTexture, pos, cameraNearFar);\nreturn (elementDepth < (geometryDepth - 1.0));\n}"]))))}function c(e,t){t.multipassGeometryEnabled&&t.geometryLinearDepthTexture&&e.bindTexture(t.geometryLinearDepthTexture,"geometryDepthTexture")}},function(e,t,r){"use strict";r.d(t,"a",(function(){return s}));var n,i=r(12),a=r(177),o=r(11);function s(e){e.include(a.a),e.code.add(Object(o.a)(n||(n=Object(i.a)(["\n    vec3 mixExternalColor(vec3 internalColor, vec3 textureColor, vec3 externalColor, int mode) {\n      // workaround for artifacts in OSX using Intel Iris Pro\n      // see: https://devtopia.esri.com/WebGIS/arcgis-js-api/issues/10475\n      vec3 internalMixed = internalColor * textureColor;\n      vec3 allMixed = internalMixed * externalColor;\n\n      if (mode == ",") {\n        return allMixed;\n      }\n      else if (mode == ",") {\n        return internalMixed;\n      }\n      else if (mode == ",") {\n        return externalColor;\n      }\n      else {\n        // tint (or something invalid)\n        float vIn = rgb2v(internalMixed);\n        vec3 hsvTint = rgb2hsv(externalColor);\n        vec3 hsvOut = vec3(hsvTint.x, hsvTint.y, vIn * hsvTint.z);\n        return hsv2rgb(hsvOut);\n      }\n    }\n\n    float mixExternalOpacity(float internalOpacity, float textureOpacity, float externalOpacity, int mode) {\n      // workaround for artifacts in OSX using Intel Iris Pro\n      // see: https://devtopia.esri.com/WebGIS/arcgis-js-api/issues/10475\n      float internalMixed = internalOpacity * textureOpacity;\n      float allMixed = internalMixed * externalOpacity;\n\n      if (mode == ",") {\n        return internalMixed;\n      }\n      else if (mode == ",") {\n        return externalOpacity;\n      }\n      else {\n        // multiply or tint (or something invalid)\n        return allMixed;\n      }\n    }\n  "])),o.a.int(1),o.a.int(2),o.a.int(3),o.a.int(2),o.a.int(3)))}},function(e,t,r){"use strict";r.d(t,"a",(function(){return v}));var n,i,a,o,s,c,l,u,d,h,f=r(12),p=r(228),b=r(11);function v(e,t){var r=e.vertex;r.uniforms.add("uDistanceFalloffFactor","float"),r.code.add(Object(b.a)(n||(n=Object(f.a)(["float distanceBasedPerspectiveFactor(float distance) {\nreturn clamp(sqrt(uDistanceFalloffFactor / distance), 0.0, 1.0);\n}"])))),r.uniforms.add("uComponentDataTex","sampler2D"),r.uniforms.add("uComponentDataTexInvDim","vec2"),e.attributes.add("componentIndex","float"),r.constants.add("componentColorFieldOffset","float",0),r.constants.add("componentOtherFieldOffset","float",1),r.constants.add("componentFieldCount","float",2),r.constants.add("lineWidthFractionFactor","float",8),r.constants.add("extensionLengthOffset","float",128),r.constants.add("componentTexWidth","float",4096),r.code.add(Object(b.a)(i||(i=Object(f.a)(["vec2 _componentTextureCoords(float componentIndex, float fieldOffset) {\nfloat fieldIndex = componentFieldCount * componentIndex + fieldOffset;\nfloat rowIndex = floor(fieldIndex / componentTexWidth);\nfloat colIndex = mod(fieldIndex, componentTexWidth);\nvec2 linearIndex = vec2(\n(colIndex + 0.5) / componentTexWidth,\n(rowIndex + 0.5) * uComponentDataTexInvDim.y\n);\nreturn linearIndex;\n}\nstruct ComponentData {\nvec4 color;\nfloat lineWidth;\nfloat extensionLength;\nfloat type;\n};\nComponentData readComponentData() {\nvec2 colorIndex = _componentTextureCoords(componentIndex, componentColorFieldOffset);\nvec2 otherIndex = _componentTextureCoords(componentIndex, componentOtherFieldOffset);\nvec4 colorValue = texture2D(uComponentDataTex, colorIndex);\nvec4 otherValue = texture2D(uComponentDataTex, otherIndex);\nreturn ComponentData(\nvec4(colorValue.rgb, colorValue.a * otherValue.w),\notherValue.x * (255.0 / lineWidthFractionFactor),\notherValue.y * 255.0 - extensionLengthOffset,\n-(otherValue.z * 255.0) + 0.5\n);\n}"])))),t.legacy?r.code.add(Object(b.a)(a||(a=Object(f.a)(["vec3 _modelToWorldNormal(vec3 normal) {\nreturn (uModel * vec4(normal, 0.0)).xyz;\n}\nvec3 _modelToViewNormal(vec3 normal) {\nreturn (uView * uModel * vec4(normal, 0.0)).xyz;\n}"])))):(r.uniforms.add("uTransformNormal_GlobalFromModel ","mat3"),r.code.add(Object(b.a)(o||(o=Object(f.a)(["vec3 _modelToWorldNormal(vec3 normal) {\nreturn uTransformNormal_GlobalFromModel * normal;\n}"]))))),t.silhouette?(e.attributes.add("normalA","vec3"),e.attributes.add("normalB","vec3"),r.code.add(Object(b.a)(s||(s=Object(f.a)(["vec3 worldNormal() {\nreturn _modelToWorldNormal(normalize(normalA + normalB));\n}"]))))):(e.attributes.add("normal","vec3"),r.code.add(Object(b.a)(c||(c=Object(f.a)(["vec3 worldNormal() {\nreturn _modelToWorldNormal(normal);\n}"]))))),t.legacy?r.code.add(Object(b.a)(l||(l=Object(f.a)(["vec3 worldFromModelPosition(vec3 position) {\nreturn (uModel * vec4(position, 1.0)).xyz;\n}\nvec3 viewFromModelPosition(vec3 position) {\nreturn (uView * vec4(worldFromModelPosition(position), 1.0)).xyz;\n}\nvec4 projFromViewPosition(vec3 position) {\nreturn uProj * vec4(position, 1.0);\n}"])))):(e.vertex.include(p.a,t),r.code.add(Object(b.a)(u||(u=Object(f.a)(["vec3 worldFromModelPosition(vec3 position) {\nvec3 rotatedModelPosition = uTransform_WorldFromModel_RS * position;\nvec3 transform_CameraRelativeFromModel = dpAdd(\nuTransform_WorldFromModel_TL,\nuTransform_WorldFromModel_TH,\n-uTransform_WorldFromView_TL,\n-uTransform_WorldFromView_TH\n);\nreturn transform_CameraRelativeFromModel + rotatedModelPosition;\n}\nvec3 viewFromModelPosition(vec3 position) {\nreturn uTransform_ViewFromCameraRelative_RS * worldFromModelPosition(position);\n}\nvec4 projFromViewPosition(vec3 position) {\nreturn uTransform_ProjFromView * vec4(position, 1.0);\n}"]))))),r.code.add(Object(b.a)(d||(d=Object(f.a)(["float calculateExtensionLength(float extensionLength, float lineLength) {\nreturn extensionLength / (log2(max(1.0, 256.0 / lineLength)) * 0.2 + 1.0);\n}"]))))}(h=v||(v={})).usesSketchLogic=function(e){return 1===e.mode||2===e.mode},h.usesSolidLogic=function(e){return 0===e.mode||2===e.mode}},function(e,t,r){"use strict";var n=r(71);var i,a=(i=n.a,{setTimeout:function(e,t){var r=i.setTimeout(e,t);return{remove:function(){return i.clearTimeout(r)}}}});t.a=a},function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var n=r(58),i=Object(n.b)()({barchart:"bar-chart",columnchart:"column-chart",linechart:"line-chart",piechart:"pie-chart"})},function(e,t,r){"use strict";var n,i=r(2),a=r(5),o=r(6),s=r(7),c=r(0),l=r(30),u=r(370),d=r(1),h=(r(17),r(18),r(15),r(10)),f=n=function(e){Object(o.a)(r,e);var t=Object(s.a)(r);function r(e){var n;return Object(i.a)(this,r),(n=t.call(this,e)).active=!1,n.className=null,n.disabled=!1,n.id=null,n.indicator=!1,n.title=null,n.type=null,n.visible=!0,n}return Object(a.a)(r,[{key:"clone",value:function(){return new n({active:this.active,className:this.className,disabled:this.disabled,id:this.id,indicator:this.indicator,title:this.title,visible:this.visible})}}]),r}(Object(u.a)(l.a));Object(c.a)([Object(d.b)()],f.prototype,"active",void 0),Object(c.a)([Object(d.b)()],f.prototype,"className",void 0),Object(c.a)([Object(d.b)()],f.prototype,"disabled",void 0),Object(c.a)([Object(d.b)()],f.prototype,"id",void 0),Object(c.a)([Object(d.b)()],f.prototype,"indicator",void 0),Object(c.a)([Object(d.b)()],f.prototype,"title",void 0),Object(c.a)([Object(d.b)()],f.prototype,"type",void 0),Object(c.a)([Object(d.b)()],f.prototype,"visible",void 0);var p=f=n=Object(c.a)([Object(h.a)("esri.support.actions.ActionBase")],f);t.a=p},function(e,t,r){"use strict";var n,i=r(2),a=r(5),o=r(6),s=r(7),c=r(0),l=r(27),u=r(28),d=r(1),h=(r(17),r(64)),f=(r(15),r(10)),p=n=function(e){Object(o.a)(r,e);var t=Object(s.a)(r);function r(e){var n;return Object(i.a)(this,r),(n=t.call(this,e)).decoration="none",n.family="sans-serif",n.size=9,n.style="normal",n.weight="normal",n}return Object(a.a)(r,[{key:"castSize",value:function(e){return Object(u.j)(e)}},{key:"clone",value:function(){return new n({decoration:this.decoration,family:this.family,size:this.size,style:this.style,weight:this.weight})}},{key:"hash",value:function(){return"".concat(this.decoration,".").concat(this.family,".").concat(this.size,".").concat(this.style,".").concat(this.weight)}}]),r}(l.a);Object(c.a)([Object(d.b)({type:["underline","line-through","none"],json:{default:"none",write:!0}})],p.prototype,"decoration",void 0),Object(c.a)([Object(d.b)({type:String,json:{write:!0}})],p.prototype,"family",void 0),Object(c.a)([Object(d.b)({type:Number,json:{write:{overridePolicy:function(e,t,r){return{enabled:!r||!r.textSymbol3D}}}}})],p.prototype,"size",void 0),Object(c.a)([Object(h.a)("size")],p.prototype,"castSize",null),Object(c.a)([Object(d.b)({type:["normal","italic","oblique"],json:{default:"normal",write:!0}})],p.prototype,"style",void 0),Object(c.a)([Object(d.b)({type:["normal","bold","bolder","lighter"],json:{default:"normal",write:!0}})],p.prototype,"weight",void 0);var b=p=n=Object(c.a)([Object(f.a)("esri.symbols.Font")],p);t.a=b},function(e,t,r){"use strict";function n(e){var t={};for(var r in e)if("declaredClass"!==r){var i=e[r];if(null!=i&&"function"!=typeof i)if(Array.isArray(i)){t[r]=[];for(var a=0;a<i.length;a++)t[r][a]=n(i[a])}else"object"==typeof i?i.toJSON&&(t[r]=JSON.stringify(i)):t[r]=i}return t}r.d(t,"a",(function(){return n}))},function(e,t,r){"use strict";var n,i=r(2),a=r(6),o=r(7),s=r(0),c=r(1),l=(r(17),r(18),r(15),r(10)),u=r(394),d=r(5),h=r(27),f=r(25),p=r(509),b=n=function(e){Object(a.a)(r,e);var t=Object(o.a)(r);function r(e){var n;return Object(i.a)(this,r),(n=t.call(this,e)).fields=[],n.normalizeField=null,n.series=[],n.tooltipField=null,n}return Object(d.a)(r,[{key:"clone",value:function(){return new n({fields:Object(f.a)(this.fields),normalizeField:this.normalizeField,tooltipField:this.tooltipField})}}]),r}(h.a);Object(s.a)([Object(c.b)({type:[String],json:{write:!0}})],b.prototype,"fields",void 0),Object(s.a)([Object(c.b)({type:String,json:{write:!0}})],b.prototype,"normalizeField",void 0),Object(s.a)([Object(c.b)({type:[p.a],json:{read:!1}})],b.prototype,"series",void 0),Object(s.a)([Object(c.b)({type:String,json:{write:!0}})],b.prototype,"tooltipField",void 0);var v=b=n=Object(s.a)([Object(l.a)("esri.popup.content.support.ChartMediaInfoValue")],b),m=function(e){Object(a.a)(r,e);var t=Object(o.a)(r);function r(e){var n;return Object(i.a)(this,r),(n=t.call(this,e)).type=null,n.value=null,n}return r}(u.a);Object(s.a)([Object(c.b)({type:["bar-chart","column-chart","line-chart","pie-chart"],readOnly:!0,json:{read:!1,write:!0}})],m.prototype,"type",void 0),Object(s.a)([Object(c.b)({type:v,json:{write:!0}})],m.prototype,"value",void 0);var y=m=Object(s.a)([Object(l.a)("esri.popup.content.mixins.ChartMediaInfo")],m);t.a=y},function(e,t,r){"use strict";r.d(t,"a",(function(){return l})),r.d(t,"b",(function(){return u}));var n,i,a=r(12),o=r(120),s=r(11);function c(e){e.fragment.uniforms.add("lastFrameColorMap","sampler2D"),e.fragment.uniforms.add("reprojectionMat","mat4"),e.fragment.uniforms.add("rpProjectionMat","mat4"),e.fragment.code.add(Object(s.a)(n||(n=Object(a.a)(["vec2 reprojectionCoordinate(vec3 projectionCoordinate)\n{\nvec4 zw = rpProjectionMat * vec4(0.0, 0.0, -projectionCoordinate.z, 1.0);\nvec4 reprojectedCoord = reprojectionMat * vec4(zw.w * (projectionCoordinate.xy * 2.0 - 1.0), zw.z, zw.w);\nreprojectedCoord.xy /= reprojectedCoord.w;\nreturn reprojectedCoord.xy * 0.5 + 0.5;\n}"]))))}function l(e,t){e.fragment.uniforms.add("nearFar","vec2"),e.fragment.uniforms.add("depthMapView","sampler2D"),e.fragment.uniforms.add("ssrViewMat","mat4"),e.fragment.uniforms.add("invResolutionHeight","float"),e.fragment.include(o.a),e.include(c),e.fragment.code.add(Object(s.a)(i||(i=Object(a.a)(["\n  const int maxSteps = ","\n\n  vec4 applyProjectionMat(mat4 projectionMat, vec3 x)\n  {\n    vec4 projectedCoord =  projectionMat * vec4(x, 1.0);\n    projectedCoord.xy /= projectedCoord.w;\n    projectedCoord.xy = projectedCoord.xy*0.5 + 0.5;\n    return projectedCoord;\n  }\n\n  vec3 screenSpaceIntersection(vec3 dir, vec3 startPosition, vec3 viewDir, vec3 normal)\n  {\n    vec3 viewPos = startPosition;\n    vec3 viewPosEnd = startPosition;\n\n    // Project the start position to the screen\n    vec4 projectedCoordStart = applyProjectionMat(rpProjectionMat, viewPos);\n    vec3  Q0 = viewPos / projectedCoordStart.w; // homogeneous camera space\n    float k0 = 1.0/ projectedCoordStart.w;\n\n    // advance the position in the direction of the reflection\n    viewPos += dir;\n\n    vec4 projectedCoordVanishingPoint = applyProjectionMat(rpProjectionMat, dir);\n\n    // Project the advanced position to the screen\n    vec4 projectedCoordEnd = applyProjectionMat(rpProjectionMat, viewPos);\n    vec3  Q1 = viewPos / projectedCoordEnd.w; // homogeneous camera space\n    float k1 = 1.0/ projectedCoordEnd.w;\n\n    // calculate the reflection direction in the screen space\n    vec2 projectedCoordDir = (projectedCoordEnd.xy - projectedCoordStart.xy);\n    vec2 projectedCoordDistVanishingPoint = (projectedCoordVanishingPoint.xy - projectedCoordStart.xy);\n\n    float yMod = min(abs(projectedCoordDistVanishingPoint.y), 1.0);\n\n    float projectedCoordDirLength = length(projectedCoordDir);\n    float maxSt = float(maxSteps);\n\n    // normalize the projection direction depending on maximum steps\n    // this determines how blocky the reflection looks\n    vec2 dP = yMod * (projectedCoordDir)/(maxSt * projectedCoordDirLength);\n\n    // Normalize the homogeneous camera space coordinates\n    vec3  dQ = yMod * (Q1 - Q0)/(maxSt * projectedCoordDirLength);\n    float dk = yMod * (k1 - k0)/(maxSt * projectedCoordDirLength);\n\n    // initialize the variables for ray marching\n    vec2 P = projectedCoordStart.xy;\n    vec3 Q = Q0;\n    float k = k0;\n    float rayStartZ = -startPosition.z; // estimated ray start depth value\n    float rayEndZ = -startPosition.z;   // estimated ray end depth value\n    float prevEstimateZ = -startPosition.z;\n    float rayDiffZ = 0.0;\n    float dDepth;\n    float depth;\n    float rayDiffZOld = 0.0;\n\n    // early outs\n    if (dot(normal, dir) < 0.0 || dot(-viewDir, normal) < 0.0)\n      return vec3(P, 0.0);\n\n    for(int i = 0; i < maxSteps-1; i++)\n    {\n      depth = -linearDepthFromTexture(depthMapView, P, nearFar); // get linear depth from the depth buffer\n\n      // estimate depth of the marching ray\n      rayStartZ = prevEstimateZ;\n      dDepth = -rayStartZ - depth;\n      rayEndZ = (dQ.z * 0.5 + Q.z)/ ((dk * 0.5 + k));\n      rayDiffZ = rayEndZ- rayStartZ;\n      prevEstimateZ = rayEndZ;\n\n      if(-rayEndZ > nearFar[1] || -rayEndZ < nearFar[0] || P.y < 0.0  || P.y > 1.0 )\n      {\n        return vec3(P, 0.);\n      }\n\n      // If we detect a hit - return the intersection point, two conditions:\n      //  - dDepth > 0.0 - sampled point depth is in front of estimated depth\n      //  - if difference between dDepth and rayDiffZOld is not too large\n      //  - if difference between dDepth and 0.025/abs(k) is not too large\n      //  - if the sampled depth is not behind far plane or in front of near plane\n\n      if((dDepth) < 0.025/abs(k) + abs(rayDiffZ) && dDepth > 0.0 && depth > nearFar[0] && depth < nearFar[1] && abs(P.y - projectedCoordStart.y) > invResolutionHeight)\n      {\n          return vec3(P, depth);\n      }\n\n      // continue with ray marching\n      P += dP;\n      Q.z += dQ.z;\n      k += dk;\n      rayDiffZOld = rayDiffZ;\n    }\n    return vec3(P, 0.0);\n  }\n  "])),t.highStepCount?"150;":"75;"))}function u(e,t){var r,n;t.ssrEnabled&&(e.bindTexture(t.linearDepthTexture,"depthMapView"),e.setUniform2fv("nearFar",t.camera.nearFar),e.setUniformMatrix4fv("ssrViewMat",t.camera.viewMatrix),e.setUniform1f("invResolutionHeight",1/t.camera.height),n=t,(r=e).bindTexture(n.lastFrameColorTexture,"lastFrameColorMap"),r.setUniformMatrix4fv("reprojectionMat",n.reprojectionMat),r.setUniformMatrix4fv("rpProjectionMat",n.camera.projectionMatrix))}},function(e,t,r){"use strict";r.d(t,"a",(function(){return c})),r.d(t,"b",(function(){return s}));var n=r(98),i=r(185),a=r(135),o=r(256),s={types:n.i,json:{write:{writer:i.b},origins:{"web-scene":{types:n.j,write:{writer:i.b}}}}},c={types:{base:a.a,key:"type",typeMap:{"simple-fill":n.e.typeMap["simple-fill"],"picture-fill":n.e.typeMap["picture-fill"],"polygon-3d":n.e.typeMap["polygon-3d"]}},json:{write:{writer:i.b},origins:{"web-scene":{type:o.a,write:{writer:i.b}}}}}},function(e,t,r){"use strict";r.d(t,"a",(function(){return n})),r.d(t,"b",(function(){return a})),r.d(t,"c",(function(){return i})),r.d(t,"d",(function(){return o}));r(17);function n(e){switch(e){case"u8":return 1;case"u16":return 2;case"u32":return 4;case"i8":return 1;case"i16":return 2;case"i32":case"f32":return 4;case"f64":return 8;default:return}}function i(e){switch(e){case"u8":case"u16":case"u32":return!1;case"i8":case"i16":case"i32":case"f32":case"f64":return!0;default:return}}function a(e){switch(e){case"u8":case"u16":case"u32":case"i8":case"i16":case"i32":return!0;case"f32":case"f64":return!1;default:return}}function o(e){switch(e){case"u8":return 255;case"u16":return 65535;case"u32":return 4294967295;case"i8":return 127;case"i16":return 32767;case"i32":return 2147483647;case"f32":return 3402823e32;case"f64":return 179769e303;default:return}}},function(e,t,r){"use strict";r.d(t,"a",(function(){return l}));var n=r(2),i=r(5),a=r(3),o=r(117),s=r(182),c=r(4),l=function(){function e(){Object(n.a)(this,e),this._disposed=!1}return Object(i.a)(e,[{key:"disposed",get:function(){return this._disposed}},{key:"shaderTransformation",get:function(){return this._shaderTransformation}},{key:"acquire",value:function(e,t,r,n,i,a){this.id=Object(s.b)(),this.geometry=e,this.material=t,this.transformation=r,this.instanceParameters=n,this.origin=i,this._shaderTransformation=a,this._disposed=!1}},{key:"release",value:function(){this._disposed=!1}},{key:"dispose",value:function(){this._disposed=!0}},{key:"getStaticTransformation",value:function(){return this.transformation}},{key:"getShaderTransformation",value:function(){return Object(a.j)(this._shaderTransformation)?this._shaderTransformation(this.transformation):this.transformation}},{key:"computeAttachmentOrigin",value:function(e){return!!(this.material.computeAttachmentOrigin?this.material.computeAttachmentOrigin(this.geometry,e):this.geometry.computeAttachmentOrigin(e))&&(Object(c.s)(e,e,this.getStaticTransformation()),!0)}}]),e}();l.pool=new o.a(l)},function(e,t,r){"use strict";var n,i=r(8),a=r.n(i),o=r(16),s=r(14),c=r(13),l=r(2),u=r(5),d=r(19),h=r(45),f=r(42),p=r(6),b=r(7),v=r(0),m=r(49),y=r(53),g=r(207),O=r(134),j=r(22),_=r(27),w=r(25),x=r(180),k=r(460),S=r(15),T=r(23),C=r(1),M=r(18),P=(r(17),r(10)),A=r(44),E=r(52),R=n=function(e){Object(p.a)(r,e);var t=Object(b.a)(r);function r(e){var n;return Object(l.a)(this,r),(n=t.call(this,e)).type="none",n}return Object(u.a)(r,[{key:"clone",value:function(){return new n({type:this.type})}}]),r}(_.a);Object(v.a)([Object(E.a)({none:"none",stayAbove:"stay-above"})],R.prototype,"type",void 0),R=n=Object(v.a)([Object(P.a)("esri.ground.NavigationConstraint")],R);var I,D=r(248),F=S.a.getLogger("esri.Ground"),L=I=function(e){Object(p.a)(n,e);var t=Object(b.a)(n);function n(e){var r;Object(l.a)(this,n),(r=t.call(this,e)).opacity=1,r.surfaceColor=null,r.navigationConstraint=null,r.layers=new y.a;return r.layers.on("after-add",(function(e){return function(e){e.parent&&e.parent!==Object(d.a)(r)&&"remove"in e.parent&&e.parent.remove(e),e.parent=Object(d.a)(r),"elevation"!==e.type&&"base-elevation"!==e.type&&F.error("Layer '".concat(e.title,", id:").concat(e.id,"' of type '").concat(e.type,"' is not supported as a ground layer and will therefore be ignored. Only layers of type 'elevation' are supported."))}(e.item)})),r.layers.on("after-remove",(function(e){return function(e){e.parent=null}(e.item)})),r}return Object(u.a)(n,[{key:"initialize",value:function(){this.when().catch((function(e){F.error("#load()","Failed to load ground",e)})),this.resourceInfo&&this.read(this.resourceInfo.data,this.resourceInfo.context)}},{key:"destroy",value:function(){var e,t=this.layers.removeAll(),r=Object(c.a)(t);try{for(r.s();!(e=r.n()).done;){e.value.destroy()}}catch(n){r.e(n)}finally{r.f()}this.layers.destroy()}},{key:"normalizeCtorArgs",value:function(e){return e&&"resourceInfo"in e&&(this._set("resourceInfo",e.resourceInfo),delete(e=Object(s.a)({},e)).resourceInfo),e}},{key:"layers",set:function(e){this._set("layers",Object(g.b)(e,this._get("layers")))}},{key:"writeLayers",value:function(e,t,r,n){var i=[];e?(n=Object(s.a)(Object(s.a)({},n),{},{layerContainerType:"ground"}),e.forEach((function(e){if("write"in e){var t={};Object(O.b)(e)().write(t,n)&&i.push(t)}else n&&n.messages&&n.messages.push(new j.a("layer:unsupported","Layers (".concat(e.title,", ").concat(e.id,") of type '").concat(e.declaredClass,"' cannot be persisted in the ground"),{layer:e}))})),t.layers=i):t.layers=i}},{key:"load",value:function(e){return this.addResolvingPromise(this._loadFromSource(e)),Promise.resolve(this)}},{key:"loadAll",value:function(){var e=this;return Object(k.a)(this,(function(t){t(e.layers)}))}},{key:"queryElevation",value:function(){var e=Object(o.a)(a.a.mark((function e(t,n){var i,o,s,c;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.load({signal:null==n?void 0:n.signal});case 2:return e.next=4,r.e(12).then(r.bind(null,971));case 4:return i=e.sent,o=i.ElevationQuery,Object(T.x)(n),s=new o,c=this.layers.filter(z).toArray(),e.abrupt("return",s.queryAll(c,t,n));case 9:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"createElevationSampler",value:function(){var e=Object(o.a)(a.a.mark((function e(t,n){var i,o,s,c;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.load({signal:null==n?void 0:n.signal});case 2:return e.next=4,r.e(12).then(r.bind(null,971));case 4:return i=e.sent,o=i.ElevationQuery,Object(T.x)(n),s=new o,c=this.layers.filter(z).toArray(),e.abrupt("return",s.createSamplerAll(c,t,n));case 9:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"clone",value:function(){var e={opacity:this.opacity,surfaceColor:Object(w.a)(this.surfaceColor),navigationConstraint:Object(w.a)(this.navigationConstraint),layers:this.layers.slice()};return this.loaded&&(e.loadStatus="loaded"),new I({resourceInfo:this.resourceInfo}).set(e)}},{key:"read",value:function(e,t){this.resourceInfo||this._set("resourceInfo",{data:e,context:t}),Object(h.a)(Object(f.a)(n.prototype),"read",this).call(this,e,t)}},{key:"_loadFromSource",value:function(e){var t=this.resourceInfo;return t?this._loadLayersFromJSON(t.data,t.context,e):Promise.resolve(null)}},{key:"_loadLayersFromJSON",value:function(e,t,n){var i=this,a=t&&t.origin||"web-scene",o=t&&t.portal||null,s=t&&t.url||null;return Promise.all([r.e(10),r.e(33)]).then(r.bind(null,710)).then((function(t){var r=t.populateOperationalLayers;Object(T.x)(n);var c=[];if(e.layers&&Array.isArray(e.layers)){var l={context:{origin:a,url:s,portal:o,layerContainerType:"ground"},defaultLayerType:"ArcGISTiledElevationServiceLayer"};c.push(r(i.layers,e.layers,l))}return Object(T.k)(c)})).then((function(){}))}}]),n}(Object(_.b)(x.a));function z(e){return"elevation"===e.type||function(e){return e&&"createElevationSampler"in e}(e)}Object(v.a)([Object(C.b)({json:{read:!1}})],L.prototype,"layers",null),Object(v.a)([Object(A.a)("layers")],L.prototype,"writeLayers",null),Object(v.a)([Object(C.b)({readOnly:!0})],L.prototype,"resourceInfo",void 0),Object(v.a)([Object(C.b)({type:Number,nonNullable:!0,range:{min:0,max:1},json:{type:M.a,read:{reader:D.b,source:"transparency"},write:{writer:function(e,t){t.transparency=Object(D.a)(e)},target:"transparency"}}})],L.prototype,"opacity",void 0),Object(v.a)([Object(C.b)({type:m.a,json:{type:[M.a],write:function(e,t){t.surfaceColor=e.toJSON().slice(0,3)}}})],L.prototype,"surfaceColor",void 0),Object(v.a)([Object(C.b)({type:R,json:{write:!0}})],L.prototype,"navigationConstraint",void 0);var V=L=I=Object(v.a)([Object(P.a)("esri.Ground")],L);t.a=V},function(e,t,r){"use strict";var n=r(2),i=r(5),a=r(6),o=r(7),s=r(0),c=r(58),l=Object(c.b)()({shortDate:"short-date",shortDateShortTime:"short-date-short-time",shortDateShortTime24:"short-date-short-time-24",shortDateLongTime:"short-date-long-time",shortDateLongTime24:"short-date-long-time-24",shortDateLE:"short-date-le",shortDateLEShortTime:"short-date-le-short-time",shortDateLEShortTime24:"short-date-le-short-time-24",shortDateLELongTime:"short-date-le-long-time",shortDateLELongTime24:"short-date-le-long-time-24",longMonthDayYear:"long-month-day-year",longMonthDayYearShortTime:"long-month-day-year-short-time",longMonthDayYearShortTime24:"long-month-day-year-short-time-24",longMonthDayYearLongTime:"long-month-day-year-long-time",longMonthDayYearLongTime24:"long-month-day-year-long-time-24",dayShortMonthYear:"day-short-month-year",dayShortMonthYearShortTime:"day-short-month-year-short-time",dayShortMonthYearShortTime24:"day-short-month-year-short-time-24",dayShortMonthYearLongTime:"day-short-month-year-long-time",dayShortMonthYearLongTime24:"day-short-month-year-long-time-24",longDate:"long-date",longDateShortTime:"long-date-short-time",longDateShortTime24:"long-date-short-time-24",longDateLongTime:"long-date-long-time",longDateLongTime24:"long-date-long-time-24",longMonthYear:"long-month-year",shortMonthYear:"short-month-year",year:"year"});l.toJSON.bind(l),l.fromJSON.bind(l);var u,d=r(27),h=r(1),f=(r(17),r(18)),p=(r(15),r(52)),b=r(10),v=r(172),m=r(165),y=u=function(e){Object(a.a)(r,e);var t=Object(o.a)(r);function r(e){var i;return Object(n.a)(this,r),(i=t.call(this,e)).dateFormat=null,i.digitSeparator=!1,i.places=null,i}return Object(i.a)(r,[{key:"clone",value:function(){return new u({dateFormat:this.dateFormat,digitSeparator:this.digitSeparator,places:this.places})}},{key:"format",value:function(e){return this.dateFormat?Object(v.b)(e,Object(v.a)(this.dateFormat)):Object(m.b)(e,Object(m.a)(this))}}]),r}(d.a);Object(s.a)([Object(p.a)(l)],y.prototype,"dateFormat",void 0),Object(s.a)([Object(h.b)({type:Boolean,json:{write:!0}})],y.prototype,"digitSeparator",void 0),Object(s.a)([Object(h.b)({type:f.a,json:{write:!0}})],y.prototype,"places",void 0);var g=y=u=Object(s.a)([Object(b.a)("esri.popup.support.FieldInfoFormat")],y);t.a=g},function(e,t,r){"use strict";r.d(t,"a",(function(){return u})),r.d(t,"b",(function(){return c}));var n=r(8),i=r.n(n),a=r(16),o=r(93),s=r(242);function c(e){return l.apply(this,arguments)}function l(){return(l=Object(a.a)(i.a.mark((function e(t){var r,n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return");case 2:return r=t.indexOf("-vector")>-1?t.slice(0,t.indexOf("-vector")):t,e.next=5,Object(s.a)("esri/t9n/basemaps");case 5:return n=e.sent,e.abrupt("return",n[t]||n[r]);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var u={streets:{id:"streets",get thumbnailUrl(){return Object(o.b)("esri/images/basemap/streets.jpg")},baseMapLayers:[{id:"streets-base-layer",url:"//services.arcgisonline.com/ArcGIS/rest/services/World_Street_Map/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Street Map",showLegend:!1,visibility:!0,opacity:1}]},satellite:{id:"satellite",get thumbnailUrl(){return Object(o.b)("esri/images/basemap/satellite.jpg")},baseMapLayers:[{id:"satellite-base-layer",url:"//services.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Imagery",showLegend:!1,visibility:!0,opacity:1}]},hybrid:{id:"hybrid",get thumbnailUrl(){return Object(o.b)("esri/images/basemap/hybrid.jpg")},baseMapLayers:[{id:"hybrid-base-layer",url:"//services.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Imagery",showLegend:!1,visibility:!0,opacity:1},{id:"hybrid-reference-layer",url:"//services.arcgisonline.com/ArcGIS/rest/services/Reference/World_Boundaries_and_Places/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Boundaries and Places",isReference:!0,showLegend:!1,visibility:!0,opacity:1}]},terrain:{id:"terrain",get thumbnailUrl(){return Object(o.b)("esri/images/basemap/terrain.jpg")},baseMapLayers:[{id:"terrain-base-layer",url:"//services.arcgisonline.com/ArcGIS/rest/services/World_Terrain_Base/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Terrain Base",showLegend:!1,visibility:!0,opacity:1},{id:"terrain-reference-layer",url:"//services.arcgisonline.com/ArcGIS/rest/services/Reference/World_Reference_Overlay/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Reference Overlay",isReference:!0,showLegend:!1,visibility:!0,opacity:1}]},topo:{id:"topo",get thumbnailUrl(){return Object(o.b)("esri/images/basemap/topo.jpg")},baseMapLayers:[{id:"topo-base-layer",url:"//services.arcgisonline.com/ArcGIS/rest/services/World_Topo_Map/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Topo Map",showLegend:!1,visibility:!0,opacity:1}]},gray:{id:"gray",get thumbnailUrl(){return Object(o.b)("esri/images/basemap/gray.jpg")},baseMapLayers:[{id:"gray-base-layer",url:"//services.arcgisonline.com/ArcGIS/rest/services/Canvas/World_Light_Gray_Base/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Light Gray Base",showLegend:!1,visibility:!0,opacity:1},{id:"gray-reference-layer",url:"//services.arcgisonline.com/ArcGIS/rest/services/Canvas/World_Light_Gray_Reference/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Light Gray Reference",isReference:!0,showLegend:!1,visibility:!0,opacity:1}]},"dark-gray":{id:"dark-gray",get thumbnailUrl(){return Object(o.b)("esri/images/basemap/dark-gray.jpg")},baseMapLayers:[{id:"dark-gray-base-layer",url:"//services.arcgisonline.com/ArcGIS/rest/services/Canvas/World_Dark_Gray_Base/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Dark Gray Base",showLegend:!1,visibility:!0,opacity:1},{id:"dark-gray-reference-layer",url:"//services.arcgisonline.com/ArcGIS/rest/services/Canvas/World_Dark_Gray_Reference/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Dark Gray Reference",isReference:!0,showLegend:!1,visibility:!0,opacity:1}]},oceans:{id:"oceans",get thumbnailUrl(){return Object(o.b)("esri/images/basemap/oceans.jpg")},baseMapLayers:[{id:"oceans-base-layer",url:"//services.arcgisonline.com/arcgis/rest/services/Ocean/World_Ocean_Base/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Ocean Base",showLegend:!1,visibility:!0,opacity:1},{id:"oceans-reference-layer",url:"//services.arcgisonline.com/arcgis/rest/services/Ocean/World_Ocean_Reference/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Ocean Reference",isReference:!0,showLegend:!1,visibility:!0,opacity:1}]},"national-geographic":{id:"national-geographic",get thumbnailUrl(){return Object(o.b)("esri/images/basemap/national-geographic.jpg")},baseMapLayers:[{id:"national-geographic-base-layer",url:"//services.arcgisonline.com/ArcGIS/rest/services/NatGeo_World_Map/MapServer",title:"NatGeo World Map",showLegend:!1,layerType:"ArcGISTiledMapServiceLayer",visibility:!0,opacity:1}]},osm:{id:"osm",get thumbnailUrl(){return Object(o.b)("esri/images/basemap/osm.jpg")},baseMapLayers:[{id:"osm-base-layer",layerType:"OpenStreetMap",title:"Open Street Map",showLegend:!1,visibility:!0,opacity:1}]},"dark-gray-vector":{id:"dark-gray-vector",get thumbnailUrl(){return Object(o.b)("esri/images/basemap/dark-gray-vector.jpg")},baseMapLayers:[{id:"dark-gray-base-layer",styleUrl:"https://cdn.arcgis.com/sharing/rest/content/items/5e9b3685f4c24d8781073dd928ebda50/resources/styles/root.json",layerType:"VectorTileLayer",title:"Dark Gray Base",visibility:!0,opacity:1},{id:"dark-gray-reference-layer",styleUrl:"https://cdn.arcgis.com/sharing/rest/content/items/747cb7a5329c478cbe6981076cc879c5/resources/styles/root.json",layerType:"VectorTileLayer",title:"Dark Gray Reference",isReference:!0,visibility:!0,opacity:1}]},"gray-vector":{id:"gray-vector",get thumbnailUrl(){return Object(o.b)("esri/images/basemap/gray-vector.jpg")},baseMapLayers:[{id:"gray-base-layer",styleUrl:"https://cdn.arcgis.com/sharing/rest/content/items/291da5eab3a0412593b66d384379f89f/resources/styles/root.json",layerType:"VectorTileLayer",title:"Light Gray Base",visibility:!0,opacity:1},{id:"gray-reference-layer",styleUrl:"https://cdn.arcgis.com/sharing/rest/content/items/1768e8369a214dfab4e2167d5c5f2454/resources/styles/root.json",layerType:"VectorTileLayer",title:"Light Gray Reference",isReference:!0,visibility:!0,opacity:1}]},"streets-vector":{id:"streets-vector",get thumbnailUrl(){return Object(o.b)("esri/images/basemap/streets-vector.jpg")},baseMapLayers:[{id:"streets-vector-base-layer",styleUrl:"//cdn.arcgis.com/sharing/rest/content/items/de26a3cf4cc9451298ea173c4b324736/resources/styles/root.json",layerType:"VectorTileLayer",title:"World Streets",visibility:!0,opacity:1}]},"topo-vector":{id:"topo-vector",get thumbnailUrl(){return Object(o.b)("esri/images/basemap/topo-vector.jpg")},baseMapLayers:[{id:"world-hillshade-layer",url:"//services.arcgisonline.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Hillshade",showLegend:!1,visibility:!0,opacity:1},{id:"topo-vector-base-layer",styleUrl:"//cdn.arcgis.com/sharing/rest/content/items/7dc6cea0b1764a1f9af2e679f642f0f5/resources/styles/root.json",layerType:"VectorTileLayer",title:"World Topo",visibility:!0,opacity:1}]},"streets-night-vector":{id:"streets-night-vector",get thumbnailUrl(){return Object(o.b)("esri/images/basemap/streets-night.jpg")},baseMapLayers:[{id:"streets-night-vector-base-layer",styleUrl:"//cdn.arcgis.com/sharing/rest/content/items/86f556a2d1fd468181855a35e344567f/resources/styles/root.json",layerType:"VectorTileLayer",title:"World Streets Night",visibility:!0,opacity:1}]},"streets-relief-vector":{id:"streets-relief-vector",get thumbnailUrl(){return Object(o.b)("esri/images/basemap/streets-relief.jpg")},baseMapLayers:[{id:"world-hillshade-layer",url:"//services.arcgisonline.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Hillshade",showLegend:!1,visibility:!0,opacity:1},{id:"streets-relief-vector-base-layer",styleUrl:"//www.arcgis.com/sharing/rest/content/items/b266e6d17fc345b498345613930fbd76/resources/styles/root.json",title:"World Streets Relief",layerType:"VectorTileLayer",visibility:!0,opacity:1}]},"streets-navigation-vector":{id:"streets-navigation-vector",get thumbnailUrl(){return Object(o.b)("esri/images/basemap/streets-navigation.jpg")},baseMapLayers:[{id:"streets-navigation-vector-base-layer",styleUrl:"//cdn.arcgis.com/sharing/rest/content/items/63c47b7177f946b49902c24129b87252/resources/styles/root.json",layerType:"VectorTileLayer",title:"World Streets Navigation",visibility:!0,opacity:1}]},"arcgis-imagery":{get thumbnailUrl(){return Object(o.b)("esri/images/basemap/hybrid.jpg")},title:"Imagery Hybrid",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Imagery",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/World_Imagery/MapServer"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Imagery:Labels",title:"Hybrid Reference Layer",isReference:!0}]},"arcgis-imagery-standard":{get thumbnailUrl(){return Object(o.b)("esri/images/basemap/satellite.jpg")},title:"Imagery",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Imagery",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/World_Imagery/MapServer"}]},"arcgis-imagery-labels":{title:"Hybrid [Reference]",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Imagery:Labels",title:"Hybrid Reference Layer",isReference:!0}]},"arcgis-light-gray":{get thumbnailUrl(){return Object(o.b)("esri/images/basemap/gray-vector.jpg")},title:"Light Gray Canvas",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:LightGray:Base",title:"Light Gray Canvas Base"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:LightGray:Labels",title:"Light Gray Canvas Labels",isReference:!0}]},"arcgis-dark-gray":{get thumbnailUrl(){return Object(o.b)("esri/images/basemap/dark-gray.jpg")},title:"Dark Gray Canvas",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:DarkGray:Base",title:"Dark Gray Canvas Base"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:DarkGray:Labels",title:"Dark Gray Canvas Labels",isReference:!0}]},"arcgis-navigation":{get thumbnailUrl(){return Object(o.b)("esri/images/basemap/streets-navigation.jpg")},title:"Navigation",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Navigation",title:"World Navigation Map"}]},"arcgis-navigation-night":{title:"Navigation (Dark Mode)",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:NavigationNight",title:"World Navigation Map (Dark Mode)"}]},"arcgis-streets":{get thumbnailUrl(){return Object(o.b)("esri/images/basemap/streets-vector.jpg")},title:"Streets",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Streets",title:"World Street Map"}]},"arcgis-streets-night":{get thumbnailUrl(){return Object(o.b)("esri/images/basemap/streets-night.jpg")},title:"Streets (Night)",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:StreetsNight",title:"World Street Map (Night)"}]},"arcgis-streets-relief":{get thumbnailUrl(){return Object(o.b)("esri/images/basemap/streets-relief.jpg")},title:"Streets (with Relief)",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Hillshade",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:StreetsRelief:Base",title:"World Street Map (with Relief)"}]},"arcgis-topographic":{get thumbnailUrl(){return Object(o.b)("esri/images/basemap/topo.jpg")},title:"Topographic",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Hillshade",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Topographic:Base",title:"World Topographic Map"}]},"arcgis-oceans":{get thumbnailUrl(){return Object(o.b)("esri/images/basemap/oceans.jpg")},title:"Oceans",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Ocean Base",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Ocean/World_Ocean_Base/MapServer"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Oceans:Labels",title:"World Ocean Reference",isReference:!0}]},"osm-standard":{title:"OpenStreetMap",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/OSM:Standard",title:"OpenStreetMap"}]},"osm-standard-relief":{title:"OpenStreetMap (with relief)",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Hillshade",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer"},{styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/OSM:StandardRelief:Base",layerType:"VectorTileLayer",title:"OpenStreetMap Relief Base"}]},"osm-streets":{title:"OpenStreetMap (Streets)",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/OSM:Streets",title:"OpenStreetMap (Streets)"}]},"osm-streets-relief":{title:"OpenStreetMap (Streets with relief)",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Hillshade",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer"},{styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/OSM:StreetsRelief:Base",layerType:"VectorTileLayer",title:"OpenStreetMap Relief Base"}]},"osm-light-gray":{title:"OpenStreetMap (Light Gray Canvas)",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/OSM:LightGray:Base",title:"OSM (Light Gray Base)"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/OSM:LightGray:Labels",title:"OSM (Light Gray Reference)",isReference:!0}]},"osm-dark-gray":{title:"OpenStreetMap (Dark Gray Canvas)",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/OSM:DarkGray:Base",title:"OSM (Dark Gray Base)"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/OSM:DarkGray:Labels",title:"OSM (Dark Gray Reference)",isReference:!0}]},"arcgis-terrain":{title:"Terrain with Labels",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Hillshade",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Terrain:Base",title:"World Terrain Base"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Terrain:Detail",title:"World Terrain Reference",isReference:!0}]},"arcgis-community":{title:"Community",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Community",title:"Community"}]},"arcgis-charted-territory":{title:"Charted Territory",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Hillshade",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:ChartedTerritory:Base",title:"Charted Territory"}]},"arcgis-colored-pencil":{title:"Colored Pencil",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:ColoredPencil",title:"Colored Pencil"}]},"arcgis-nova":{title:"Nova",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Nova",title:"Nova"}]},"arcgis-modern-antique":{title:"Modern Antique",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Hillshade",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:ModernAntique:Base",title:"Modern Antique"}]},"arcgis-midcentury":{title:"Mid-Century",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Midcentury",title:"Mid-Century"}]},"arcgis-newspaper":{title:"Newspaper",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Newspaper",title:"Newspaper"}]},"arcgis-hillshade-light":{title:"Hillshade",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Hillshade",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer"}]},"arcgis-hillshade-dark":{title:"Hillshade (Dark)",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Hillshade (Dark)",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Elevation/World_Hillshade_Dark/MapServer"}]}}},function(e,t,r){"use strict";r.d(t,"a",(function(){return s})),r.d(t,"b",(function(){return a})),r.d(t,"c",(function(){return o}));r(17);var n={milliseconds:1,seconds:1e3,minutes:6e4,hours:36e5,days:864e5,weeks:6048e5,months:26784e5,years:31536e6,decades:31536e7,centuries:31536e8},i={milliseconds:{getter:"getMilliseconds",setter:"setMilliseconds",multiplier:1},seconds:{getter:"getSeconds",setter:"setSeconds",multiplier:1},minutes:{getter:"getMinutes",setter:"setMinutes",multiplier:1},hours:{getter:"getHours",setter:"setHours",multiplier:1},days:{getter:"getDate",setter:"setDate",multiplier:1},weeks:{getter:"getDate",setter:"setDate",multiplier:7},months:{getter:"getMonth",setter:"setMonth",multiplier:1},years:{getter:"getFullYear",setter:"setFullYear",multiplier:1},decades:{getter:"getFullYear",setter:"setFullYear",multiplier:10},centuries:{getter:"getFullYear",setter:"setFullYear",multiplier:100}};function a(e,t,r){var n=new Date(e.getTime());if(t&&r){var a=i[r],o=a.getter,s=a.setter,c=a.multiplier;n[s](n[o]()+t*c)}return n}function o(e,t){switch(t){case"milliseconds":return new Date(e.getTime());case"seconds":return new Date(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds());case"minutes":return new Date(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes());case"hours":return new Date(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours());case"days":return new Date(e.getFullYear(),e.getMonth(),e.getDate());case"weeks":return new Date(e.getFullYear(),e.getMonth(),e.getDate()-e.getDay());case"months":return new Date(e.getFullYear(),e.getMonth(),1);case"years":return new Date(e.getFullYear(),0,1);case"decades":return new Date(e.getFullYear()-e.getFullYear()%10,0,1);case"centuries":return new Date(e.getFullYear()-e.getFullYear()%100,0,1);default:return new Date}}function s(e,t,r){return 0===e?0:e*n[t]/n[r]}},function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var n=r(335);Object.freeze({__proto__:null,copy:function(e,t,r){for(var n=e.typedBuffer,i=e.typedBufferStride,a=t.typedBuffer,o=t.typedBufferStride,s=r?r.count:t.count,c=(r&&r.dstIndex?r.dstIndex:0)*i,l=(r&&r.srcIndex?r.srcIndex:0)*o,u=0;u<s;++u){for(var d=0;d<9;++d)n[c+d]=a[l+d];c+=i,l+=o}}});Object.freeze({__proto__:null,copy:function(e,t,r){for(var n=e.typedBuffer,i=e.typedBufferStride,a=t.typedBuffer,o=t.typedBufferStride,s=r?r.count:t.count,c=(r&&r.dstIndex?r.dstIndex:0)*i,l=(r&&r.srcIndex?r.srcIndex:0)*o,u=0;u<s;++u){for(var d=0;d<16;++d)n[c+d]=a[l+d];c+=i,l+=o}}}),r(400),r(479),r(374),r(425);function i(e,t){return new e(new ArrayBuffer(t*e.ElementCount*Object(n.a)(e.ElementType)))}},function(e,t,r){"use strict";r.d(t,"a",(function(){return m})),r.d(t,"b",(function(){return f})),r.d(t,"c",(function(){return h})),r.d(t,"d",(function(){return u}));var n=r(13),i=r(137),a=(r(17),r(25)),o=r(3),s=r(94),c=r(100),l=r(202);function u(e){return"declaredClass"in e}function d(e){return"declaredClass"in e}function h(e,t){if(!e)return null;if("declaredClass"in e)return e;var r=new i.a({layer:t,sourceLayer:t});return r.visible=e.visible,r.symbol=Object(a.a)(e.symbol),r.attributes=Object(a.a)(e.attributes),r.geometry=f(e.geometry),r}function f(e){return Object(o.i)(e)?null:u(e)?e:Object(c.a)(function(e){var t=e.spatialReference.toJSON();switch(e.type){case"point":return{x:e.x,y:e.y,z:e.z,m:e.m,spatialReference:t};case"polygon":var r=e.rings,n=e.hasZ,i=e.hasM;return{rings:p(r),hasZ:n,hasM:i,spatialReference:t};case"polyline":var a=e.paths,o=e.hasZ,s=e.hasM;return{paths:p(a),hasZ:o,hasM:s,spatialReference:t};case"extent":return{xmin:e.xmin,xmax:e.xmax,ymin:e.ymin,ymax:e.ymax,zmin:e.zmin,zmax:e.zmax,mmin:e.mmin,mmax:e.mmax,hasZ:e.hasZ,hasM:e.hasM,spatialReference:t};case"multipoint":var c=e.points,l=e.hasZ,u=e.hasM;return{points:v(c)?b(c):c,hasZ:l,hasM:u,spatialReference:t};default:return}}(e))}function p(e){return function(e){var t,r=Object(n.a)(e);try{for(r.s();!(t=r.n()).done;){var i=t.value;if(0!==i.length)return v(i)}}catch(a){r.e(a)}finally{r.f()}return!1}(e)?e.map((function(e){return b(e)})):e}function b(e){return e.map((function(e){return Object(s.n)(e)}))}function v(e){return e.length&&(Object(s.d)(e[0])||Object(s.e)(e[0]))}function m(e,t){if(!e)return null;var r;if(d(e)){if(null==t)return e.clone();if(d(t))return t.copy(e)}return null!=t?((r=t).x=e.x,r.y=e.y,r.spatialReference=e.spatialReference,e.hasZ?(r.z=e.z,r.hasZ=e.hasZ):(r.z=null,r.hasZ=!1),e.hasM?(r.m=e.m,r.hasM=!0):(r.m=null,r.hasM=!1)):(r=Object(l.j)(e.x,e.y,e.z,e.spatialReference),e.hasM&&(r.m=e.m,r.hasM=!0)),r}},function(e,t,r){"use strict";r(172),r(165),r(236),r(138);var n=r(242),i=r(8),a=r.n(i),o=r(2),s=r(5),c=r(16),l=r(99),u=r(22),d=r(71),h=r(3);function f(){return(f=Object(c.a)(a.a.mark((function e(t,r,i,o){var s,c,l,d,h,f,b;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s=r.exec(i)){e.next=3;break}throw new u.a("esri-intl:invalid-bundle",'Bundle id "'.concat(i,'" is not compatible with the pattern "').concat(r,'"'));case 3:return c=s[1]?"".concat(s[1],"/"):"",l=s[2],d=Object(n.b)(o),h="".concat(c).concat(l,".json"),f=d?"".concat(c).concat(l,"_").concat(d,".json"):h,e.prev=4,e.next=7,p(t(f));case 7:b=e.sent,e.next=23;break;case 10:if(e.prev=10,e.t0=e.catch(4),f!==h){e.next=14;break}throw new u.a("intl:unknown-bundle",'Bundle "'.concat(i,'" cannot be loaded'),{error:e.t0});case 14:return e.prev=14,e.next=17,p(t(h));case 17:b=e.sent,e.next=23;break;case 20:throw e.prev=20,e.t1=e.catch(14),new u.a("intl:unknown-bundle",'Bundle "'.concat(i,'" cannot be loaded'),{error:e.t1});case 23:return e.abrupt("return",b);case 24:case"end":return e.stop()}}),e,null,[[4,10],[14,20]])})))).apply(this,arguments)}function p(e){return b.apply(this,arguments)}function b(){return(b=Object(c.a)(a.a.mark((function e(t){var r;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!Object(h.j)(y.fetchBundleAsset)){e.next=2;break}return e.abrupt("return",y.fetchBundleAsset(t));case 2:return e.next=4,Object(l.default)(t,{responseType:"text"});case 4:return r=e.sent,e.abrupt("return",JSON.parse(r.data));case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var v=function(){function e(t){var r,n=t.base,i=void 0===n?"":n,a=t.pattern,s=t.location,c=void 0===s?new URL(window.location.href):s;Object(o.a)(this,e),r="string"==typeof c?function(e){return new URL(e,new URL(c,d.a.location)).href}:c instanceof URL?function(e){return new URL(e,c).href}:c,this.pattern="string"==typeof a?new RegExp("^".concat(a)):a,this.getAssetUrl=r,i=i?i.endsWith("/")?i:i+"/":"",this.matcher=new RegExp("^".concat(i,"(?:(.*)/)?(.*)$"))}return Object(s.a)(e,[{key:"fetchMessageBundle",value:function(e,t){return function(e,t,r,n){return f.apply(this,arguments)}(this.getAssetUrl,this.matcher,e,t)}}]),e}();var m,y={},g=r(93);Object(n.c)((m={pattern:"esri/",location:g.b},new v(m)))},function(e,t,r){"use strict";r.d(t,"a",(function(){return H}));var n=r(14),i=r(2),a=r(5),o=r(6),s=r(7),c=r(15),l=r(20),u=r(3),d=r(28),h=r(29),f=r(4),p=r(9),b=r(125),v=r(37),m=r(108),y=r(150),g=r(195),O=r(116),j=r(46),_=r(525),w=r(136),x=r(45),k=r(42),S=r(0),T=r(76),C=r(109),M=r(112),P=r(197),A=r(106),E=r(91),R=r(95),I=r(24),D=r(89),F=r(88),L=r(111),z=r(613),V=r(41),N=new Map([["position",0],["subdivisionFactor",1],["uv0",2],["auxpos1",3],["auxpos2",4],["size",6],["sizeFeatureAttribute",6],["color",5],["colorFeatureAttribute",5],["opacityFeatureAttribute",7]]),U=function(e){Object(o.a)(r,e);var t=Object(s.a)(r);function r(e,n,a){var o;return Object(i.a)(this,r),(o=t.call(this,e,n,a)).stippleTextureRepository=e.stippleTextureRepository,o}return Object(a.a)(r,[{key:"initializeProgram",value:function(e){var t=r.shader.get(),n=this.configuration,i=t.build({OITEnabled:0===n.transparencyPassType,output:n.output,slicePlaneEnabled:n.slicePlaneEnabled,sliceHighlightDisabled:!1,sliceEnabledForVertexPrograms:!1,stippleEnabled:n.stippleEnabled,stippleOffColorEnabled:n.stippleOffColorEnabled,stippleUVMaxEnabled:n.stippleIntegerRepeatsEnabled,stippleIntegerRepeatsEnabled:n.stippleIntegerRepeatsEnabled,roundCaps:n.roundCaps,roundJoins:n.roundJoins,vvColor:n.vvColor,vvSize:n.vvSize,vvInstancingEnabled:!0,vvOpacity:n.vvOpacity,falloffEnabled:n.falloffEnabled,innerColorEnabled:n.innerColorEnabled,multipassTerrainEnabled:n.multipassTerrainEnabled,cullAboveGround:n.cullAboveGround});return new F.a(e.rctx,i,N)}},{key:"dispose",value:function(){Object(x.a)(Object(k.a)(r.prototype),"dispose",this).call(this),this.stippleTextureRepository.release(this.stipplePattern),this.stipplePattern=null,this.stippleTextureBind=null}},{key:"bindPass",value:function(e,t){if(Object(A.c)(this.program,t.camera.projectionMatrix),4===this.configuration.output&&Object(C.b)(this.program,t),t.multipassTerrainEnabled&&(this.program.setUniform2fv("inverseViewport",t.inverseViewport),Object(M.a)(this.program,t)),this.program.setUniform1f("intrinsicWidth",e.width),this.program.setUniform4fv("intrinsicColor",e.color),this.program.setUniform1f("miterLimit","miter"!==e.join?0:e.miterLimit),this.program.setUniform2fv("cameraNearFar",t.camera.nearFar),this.program.setUniform1f("pixelRatio",t.camera.pixelRatio),this.program.setUniform2f("screenSize",t.camera.fullViewport[2],t.camera.fullViewport[3]),Object(P.d)(this.program,e),this.stipplePattern!==e.stipplePattern){var r=e.stipplePattern;this.stippleTextureBind=this.stippleTextureRepository.swap(this.stipplePattern,r),this.stipplePattern=r}if(this.configuration.stippleEnabled){var n=Object(u.j)(this.stippleTextureBind)?this.stippleTextureBind(this.program)*t.camera.pixelRatio:1;if(this.program.setUniform1f("stipplePatternPixelSizeInv",1/n),this.configuration.stippleOffColorEnabled){var i=Object(u.s)(e.stippleOffColor);this.program.setUniform4f("stippleOffColor",i[0],i[1],i[2],i.length>3?i[3]:1)}}this.configuration.falloffEnabled&&this.program.setUniform1f("falloff",e.falloff),this.configuration.innerColorEnabled&&(this.program.setUniform4fv("innerColor",Object(u.t)(e.innerColor,e.color)),this.program.setUniform1f("innerWidth",e.innerWidth*t.camera.pixelRatio))}},{key:"bindDraw",value:function(e){Object(A.d)(this.program,e),Object(T.c)(this.program,this.configuration,e),this.program.rebindTextures()}},{key:"setPipelineState",value:function(e,t){var r=this.configuration,n=3===e,i=2===e;return Object(V.g)({blending:0===r.output||7===r.output?n?D.f:Object(D.a)(e):null,depthTest:{func:Object(D.b)(e)},depthWrite:n?!r.transparent&&r.writeDepth&&V.e:Object(D.c)(e),colorWrite:V.d,stencilWrite:r.sceneHasOcludees?L.j:null,stencilTest:r.sceneHasOcludees?t?L.f:L.e:null,polygonOffset:n||i?r.polygonOffset&&B:D.d})}},{key:"initializePipeline",value:function(){var e=this.configuration,t=e.polygonOffset&&B;return e.occluder&&(this._occluderPipelineTransparent=Object(V.g)({blending:D.f,polygonOffset:t,depthTest:L.a,depthWrite:null,colorWrite:V.d,stencilWrite:null,stencilTest:L.h}),this._occluderPipelineOpaque=Object(V.g)({blending:D.f,polygonOffset:t,depthTest:L.a,depthWrite:null,colorWrite:V.d,stencilWrite:L.i,stencilTest:L.g}),this._occluderPipelineMaskWrite=Object(V.g)({blending:null,polygonOffset:t,depthTest:L.b,depthWrite:null,colorWrite:null,stencilWrite:L.j,stencilTest:L.f})),this._occludeePipelineState=this.setPipelineState(this.configuration.transparencyPassType,!0),this.setPipelineState(this.configuration.transparencyPassType,!1)}},{key:"primitiveType",get:function(){return 5}},{key:"getPipelineState",value:function(e,t){return t?this._occludeePipelineState:this.configuration.occluder?11===e?this._occluderPipelineTransparent:10===e?this._occluderPipelineOpaque:this._occluderPipelineMaskWrite:this.pipeline}}]),r}(R.a);U.shader=new E.a(z.a,(function(){return r.e(207).then(r.bind(null,1062))}));var B={factor:0,units:-4},G=function(e){Object(o.a)(r,e);var t=Object(s.a)(r);function r(){var e;return Object(i.a)(this,r),(e=t.apply(this,arguments)).output=0,e.occluder=!1,e.slicePlaneEnabled=!1,e.transparent=!1,e.polygonOffset=!1,e.writeDepth=!1,e.stippleEnabled=!1,e.stippleOffColorEnabled=!1,e.stippleIntegerRepeatsEnabled=!1,e.roundCaps=!1,e.roundJoins=!1,e.vvSize=!1,e.vvColor=!1,e.vvOpacity=!1,e.falloffEnabled=!1,e.innerColorEnabled=!1,e.sceneHasOcludees=!1,e.transparencyPassType=3,e.multipassTerrainEnabled=!1,e.cullAboveGround=!1,e}return r}(I.a);Object(S.a)([Object(I.b)({count:8})],G.prototype,"output",void 0),Object(S.a)([Object(I.b)()],G.prototype,"occluder",void 0),Object(S.a)([Object(I.b)()],G.prototype,"slicePlaneEnabled",void 0),Object(S.a)([Object(I.b)()],G.prototype,"transparent",void 0),Object(S.a)([Object(I.b)()],G.prototype,"polygonOffset",void 0),Object(S.a)([Object(I.b)()],G.prototype,"writeDepth",void 0),Object(S.a)([Object(I.b)()],G.prototype,"stippleEnabled",void 0),Object(S.a)([Object(I.b)()],G.prototype,"stippleOffColorEnabled",void 0),Object(S.a)([Object(I.b)()],G.prototype,"stippleIntegerRepeatsEnabled",void 0),Object(S.a)([Object(I.b)()],G.prototype,"roundCaps",void 0),Object(S.a)([Object(I.b)()],G.prototype,"roundJoins",void 0),Object(S.a)([Object(I.b)()],G.prototype,"vvSize",void 0),Object(S.a)([Object(I.b)()],G.prototype,"vvColor",void 0),Object(S.a)([Object(I.b)()],G.prototype,"vvOpacity",void 0),Object(S.a)([Object(I.b)()],G.prototype,"falloffEnabled",void 0),Object(S.a)([Object(I.b)()],G.prototype,"innerColorEnabled",void 0),Object(S.a)([Object(I.b)()],G.prototype,"sceneHasOcludees",void 0),Object(S.a)([Object(I.b)({count:4})],G.prototype,"transparencyPassType",void 0),Object(S.a)([Object(I.b)()],G.prototype,"multipassTerrainEnabled",void 0),Object(S.a)([Object(I.b)()],G.prototype,"cullAboveGround",void 0);var q=c.a.getLogger("esri.views.3d.webgl-engine.materials.RibbonLineMaterial"),H=function(e){Object(o.a)(r,e);var t=Object(s.a)(r);function r(e){var n;return Object(i.a)(this,r),(n=t.call(this,e,Q))._vertexAttributeLocations=N,n.techniqueConfig=new G,n.layout=n.createLayout(),n}return Object(a.a)(r,[{key:"isClosed",value:function(e,t){return $(this.params,e,t)}},{key:"dispose",value:function(){}},{key:"getPassParameters",value:function(){return this.params}},{key:"getTechniqueConfig",value:function(e,t){this.techniqueConfig.output=e;var r=Object(u.j)(this.params.stipplePattern);return this.techniqueConfig.stippleEnabled=r,this.techniqueConfig.stippleIntegerRepeatsEnabled=r&&this.params.stippleIntegerRepeats,this.techniqueConfig.stippleOffColorEnabled=r&&Object(u.j)(this.params.stippleOffColor),this.techniqueConfig.slicePlaneEnabled=this.params.slicePlaneEnabled,this.techniqueConfig.sceneHasOcludees=this.params.sceneHasOcludees,this.techniqueConfig.roundJoins="round"===this.params.join,this.techniqueConfig.roundCaps="round"===this.params.cap,this.techniqueConfig.transparent=this.params.transparent,this.techniqueConfig.polygonOffset=this.params.polygonOffset,this.techniqueConfig.writeDepth=this.params.writeDepth,this.techniqueConfig.vvColor=this.params.vvColorEnabled,this.techniqueConfig.vvOpacity=this.params.vvOpacityEnabled,this.techniqueConfig.vvSize=this.params.vvSizeEnabled,this.techniqueConfig.innerColorEnabled=this.params.innerWidth>0&&Object(u.j)(this.params.innerColor),this.techniqueConfig.falloffEnabled=this.params.falloff>0,this.techniqueConfig.occluder=8===this.params.renderOccluded,this.techniqueConfig.transparencyPassType=t?t.transparencyPassType:3,this.techniqueConfig.multipassTerrainEnabled=!!t&&t.multipassTerrainEnabled,this.techniqueConfig.cullAboveGround=!!t&&t.cullAboveGround,this.techniqueConfig}},{key:"intersect",value:function(e,t,r,n,i,a,o,s,c){c?this.intersectDrapedLineGeometry(e,n,a,o):this.intersectLineGeometry(e,t,r,n,this.params.width,o)}},{key:"intersectDrapedLineGeometry",value:function(e,t,r,n){if(t.options.selectionMode){var i=e.vertexAttributes.get("position").data,a=e.vertexAttributes.get("size"),o=this.params.width;if(this.params.vvSizeEnabled){var s=e.vertexAttributes.get("sizeFeatureAttribute").data[0];o*=Object(l.e)(this.params.vvSizeOffset[0]+s*this.params.vvSizeFactor[0],this.params.vvSizeMinSize[0],this.params.vvSizeMaxSize[0])}else a&&(o*=a.data[0]);for(var c=r[0],u=r[1],d=(o/2+4)*e.screenToWorldRatio,h=Number.MAX_VALUE,f=0;f<i.length-5;f+=3){var p=i[f],b=i[f+1],v=c-p,m=u-b,y=i[f+3]-p,g=i[f+4]-b,O=Object(l.e)((y*v+g*m)/(y*y+g*g),0,1),j=y*O-v,_=g*O-m,w=j*j+_*_;w<h&&(h=w)}h<d*d&&n()}}},{key:"intersectLineGeometry",value:function(e,t,r,n,i,a){if(n.options.selectionMode&&!Object(w.e)(t))if(Object(j.g)(r)){var o=e.vertexAttributes,s=o.get("position").data,c=i;if(this.params.vvSizeEnabled){var u=o.get("sizeFeatureAttribute").data[0];c*=Object(l.e)(this.params.vvSizeOffset[0]+u*this.params.vvSizeFactor[0],this.params.vvSizeMinSize[0],this.params.vvSizeMaxSize[0])}else o.has("size")&&(c*=o.get("size").data[0]);var d=n.camera,p=ie;Object(h.c)(p,n.point);var m=c*d.pixelRatio/2+4*d.pixelRatio;Object(f.y)(pe[0],p[0]-m,p[1]+m,0),Object(f.y)(pe[1],p[0]+m,p[1]+m,0),Object(f.y)(pe[2],p[0]+m,p[1]-m,0),Object(f.y)(pe[3],p[0]-m,p[1]-m,0);for(var y=0;y<4;y++)if(!d.unprojectFromRenderScreen(pe[y],be[y]))return;Object(v.g)(d.eye,be[0],be[1],ve),Object(v.g)(d.eye,be[1],be[2],me),Object(v.g)(d.eye,be[2],be[3],ye),Object(v.g)(d.eye,be[3],be[0],ge);for(var g=Number.MAX_VALUE,O=Y(this.params,o,e.indices)?s.length-2:s.length-5,_=0;_<O;_+=3){ee[0]=s[_]+r[12],ee[1]=s[_+1]+r[13],ee[2]=s[_+2]+r[14];var x=(_+3)%s.length;if(te[0]=s[x]+r[12],te[1]=s[x+1]+r[13],te[2]=s[x+2]+r[14],!(Object(v.w)(ve,ee)<0&&Object(v.w)(ve,te)<0||Object(v.w)(me,ee)<0&&Object(v.w)(me,te)<0||Object(v.w)(ye,ee)<0&&Object(v.w)(ye,te)<0||Object(v.w)(ge,ee)<0&&Object(v.w)(ge,te)<0)){if(d.projectToRenderScreen(ee,ae),d.projectToRenderScreen(te,oe),ae[2]<0&&oe[2]>0){Object(f.l)(re,ee,te);var k=d.frustum,S=-Object(v.w)(k[4],ee)/Object(f.j)(re,Object(v.s)(k[4]));Object(f.g)(re,re,S),Object(f.h)(ee,ee,re),d.projectToRenderScreen(ee,ae)}else if(ae[2]>0&&oe[2]<0){Object(f.l)(re,te,ee);var T=d.frustum,C=-Object(v.w)(T[4],te)/Object(f.j)(re,Object(v.s)(T[4]));Object(f.g)(re,re,C),Object(f.h)(te,te,re),d.projectToRenderScreen(te,oe)}else if(ae[2]<0&&oe[2]<0)continue;ae[2]=0,oe[2]=0;var M=Object(b.d)(Object(b.e)(ae,oe,le),p);M<g&&(g=M,Object(f.m)(se,ee),Object(f.m)(ce,te))}}var P=n.rayBeginPoint,A=n.rayEndPoint;if(g<m*m){var E=Number.MAX_VALUE;if(Object(b.a)(Object(b.e)(se,ce,le),Object(b.e)(P,A,ue),ne)){Object(f.l)(ne,ne,P);var R=Object(f.r)(ne);Object(f.g)(ne,ne,1/R),E=R/Object(f.o)(P,A)}a(E,ne)}}else q.error("intersection assumes a translation-only matrix")}},{key:"computeAttachmentOrigin",value:function(e,t){var r=e.vertexAttributes;if(!r)return null;var n=e.indices,i=r.get("position");return Object(y.a)(i,n?n.get("position"):null,n&&Y(this.params,r,n),t)}},{key:"createLayout",value:function(){var e=Object(m.a)().vec3f("position").f32("subdivisionFactor").vec2f("uv0").vec3f("auxpos1").vec3f("auxpos2");return this.params.vvSizeEnabled?e.f32("sizeFeatureAttribute"):e.f32("size"),this.params.vvColorEnabled?e.f32("colorFeatureAttribute"):e.vec4f("color"),this.params.vvOpacityEnabled&&e.f32("opacityFeatureAttribute"),e}},{key:"createBufferWriter",value:function(){return new Z(this.layout,this.params)}},{key:"getGLMaterial",value:function(e){return 0===e.output||7===e.output||4===e.output||1===e.output?new W(e):void 0}},{key:"validateParameterValues",value:function(e){"miter"!==e.join&&(e.miterLimit=0),this.requiresTransparent(e)&&(e.transparent=!0)}},{key:"requiresTransparent",value:function(e){return!!((e.color&&e.color[3])<1||e.innerWidth>0&&this.colorRequiresTransparent(e.innerColor)||e.stipplePattern&&this.colorRequiresTransparent(e.stippleOffColor)||e.falloff>0)}},{key:"colorRequiresTransparent",value:function(e){return Object(u.j)(e)&&e[3]<1&&e[3]>0}}]),r}(O.a),W=function(e){Object(o.a)(r,e);var t=Object(s.a)(r);function r(e){var n;return Object(i.a)(this,r),(n=t.call(this,e)).updateParameters(),n}return Object(a.a)(r,[{key:"updateParameters",value:function(e){this._technique=this._techniqueRep.releaseAndAcquire(U,this._material.getTechniqueConfig(this._output,e),this._technique)}},{key:"beginSlot",value:function(e){return this._technique.configuration.occluder?3===e||10===e||11===e:0===this._output||7===this._output?(this.targetSlot=this._technique.configuration.writeDepth?5:8,e===this.targetSlot):3===e}},{key:"_updateOccludeeState",value:function(e){e.hasOccludees!==this._material.params.sceneHasOcludees&&this._material.setParameterValues({sceneHasOcludees:e.hasOccludees})}},{key:"ensureParameters",value:function(e){0!==this._output&&7!==this._output||this._updateOccludeeState(e),this.updateParameters(e)}},{key:"bind",value:function(e){this._technique.bindPass(this._material.getPassParameters(),e)}},{key:"getPipelineState",value:function(e,t){return this._technique.getPipelineState(e,t)}}]),r}(g.a),Q=Object(n.a)(Object(n.a)({width:0,color:[1,1,1,1],join:"miter",cap:"butt",miterLimit:5,writeDepth:!0,polygonOffset:!1,stipplePattern:null,stippleIntegerRepeats:!1,stippleOffColor:null,slicePlaneEnabled:!1,vvFastUpdate:!1,transparent:!1,isClosed:!1,falloff:0,innerWidth:0,innerColor:null,sceneHasOcludees:!1},O.b),_.a.Default),Z=function(){function e(t,r){switch(Object(i.a)(this,e),this.params=r,this.numJoinSubdivisions=0,this.vertexBufferLayout=t,this.params.join){case"miter":case"bevel":this.numJoinSubdivisions=r.stipplePattern?1:0;break;case"round":this.numJoinSubdivisions=K}}return Object(a.a)(e,[{key:"isClosed",value:function(e){return Y(this.params,e.vertexAttributes,e.indices)}},{key:"numCapSubdivisions",value:function(e){if(this.isClosed(e))return 0;switch(this.params.cap){case"butt":return 0;case"square":return 1;case"round":return J}}},{key:"allocate",value:function(e){return this.vertexBufferLayout.createBuffer(e)}},{key:"elementCount",value:function(e){var t=2*this.numCapSubdivisions(e)+2,r=e.indices.get("position").length/2+1,n=this.isClosed(e),i=n?2:2*t,a=n?0:1,o=n?r:r-1;if(e.vertexAttributes.has("subdivisions"))for(var s=e.vertexAttributes.get("subdivisions").data,c=a;c<o;++c)i+=4+2*s[c];else i+=(o-a)*(2*this.numJoinSubdivisions+4);return i+=2}},{key:"write",value:function(e,t,r,n){var i=this,a=de,o=he,s=fe,c=t.vertexAttributes.get("position").data,l=t.indices&&t.indices.get("position"),u=this.numCapSubdivisions(t);l&&l.length!==2*(c.length/3-1)&&console.warn("RibbonLineMaterial does not support indices");var d=null;t.vertexAttributes.has("subdivisions")&&(d=t.vertexAttributes.get("subdivisions").data);var h=1,p=0;this.params.vvSizeEnabled?p=t.vertexAttributes.get("sizeFeatureAttribute").data[0]:t.vertexAttributes.has("size")&&(h=t.vertexAttributes.get("size").data[0]);var b=[1,1,1,1],v=0;this.params.vvColorEnabled?v=t.vertexAttributes.get("colorFeatureAttribute").data[0]:t.vertexAttributes.has("color")&&(b=t.vertexAttributes.get("color").data);var m=0;this.params.vvOpacityEnabled&&(m=t.vertexAttributes.get("opacityFeatureAttribute").data[0]);var y=c.length/3,g=e.transformation,O=new Float32Array(r.buffer),j=this.vertexBufferLayout.stride/4,_=n*j,w=_,x=function(e,t,r,n,a,o,s){if(O[_++]=t[0],O[_++]=t[1],O[_++]=t[2],O[_++]=n,O[_++]=a,O[_++]=o,O[_++]=e[0],O[_++]=e[1],O[_++]=e[2],O[_++]=r[0],O[_++]=r[1],O[_++]=r[2],i.params.vvSizeEnabled?O[_++]=p:O[_++]=h,i.params.vvColorEnabled)O[_++]=v;else{var c=Math.min(4*s,b.length-4);O[_++]=b[c+0],O[_++]=b[c+1],O[_++]=b[c+2],O[_++]=b[c+3]}i.params.vvOpacityEnabled&&(O[_++]=m)};_+=j,Object(f.y)(o,c[0],c[1],c[2]),g&&Object(f.s)(o,o,g);var k=this.isClosed(t);if(k){var S=c.length-3;Object(f.y)(a,c[S],c[S+1],c[S+2]),g&&Object(f.s)(a,a,g)}else{Object(f.m)(a,o),Object(f.y)(s,c[3],c[4],c[5]),g&&Object(f.s)(s,s,g);for(var T=0;T<u;++T){var C=1-T/u;x(a,o,s,C,1,-4,0),x(a,o,s,C,1,4,0)}x(a,o,s,0,0,-4,0),x(a,o,s,0,0,4,0),Object(f.m)(a,o),Object(f.m)(o,s)}for(var M=k?y:y-1,P=k?0:1;P<M;P++){var A=(P+1)%y*3;Object(f.y)(s,c[A+0],c[A+1],c[A+2]),g&&Object(f.s)(s,s,g),x(a,o,s,0,1,-1,P),x(a,o,s,0,1,1,P);for(var E=d?d[P]:this.numJoinSubdivisions,R=0;R<E;++R){var I=(R+1)/(E+1);x(a,o,s,I,1,-2,P),x(a,o,s,I,1,2,P)}x(a,o,s,1,0,-2,P),x(a,o,s,1,0,2,P),Object(f.m)(a,o),Object(f.m)(o,s)}if(k)_=X(O,w+j,O,_,2*j);else{x(a,o,s,0,1,-5,M),x(a,o,s,0,1,5,M);for(var D=0;D<u;++D){var F=(D+1)/u;x(a,o,s,F,1,-5,M),x(a,o,s,F,1,5,M)}}X(O,w+j,O,w,j),_=X(O,_-j,O,_,j)}}]),e}();function X(e,t,r,n,i){for(var a=0;a<i;a++)r[n++]=e[t++];return n}function Y(e,t,r){return $(e,t.get("position").data,r?r.get("position"):null)}function $(e,t,r){return!!e.isClosed&&(r?r.length>2:t.length>6)}var J=3,K=1,ee=Object(p.e)(),te=Object(p.e)(),re=Object(p.e)(),ne=Object(p.e)(),ie=Object(p.e)(),ae=Object(d.d)(),oe=Object(d.d)(),se=Object(p.e)(),ce=Object(p.e)(),le=Object(b.c)(),ue=Object(b.c)(),de=Object(p.e)(),he=Object(p.e)(),fe=Object(p.e)(),pe=[Object(d.d)(),Object(d.d)(),Object(d.d)(),Object(d.d)()],be=[Object(p.e)(),Object(p.e)(),Object(p.e)(),Object(p.e)()],ve=Object(v.d)(),me=Object(v.d)(),ye=Object(v.d)(),ge=Object(v.d)()},function(e,t,r){"use strict";var n,i=r(2),a=r(5),o=r(6),s=r(7),c=r(0),l=r(25),u=r(1),d=(r(18),r(17),r(15),r(52)),h=r(10),f=r(641),p=r(284),b=n=function(e){Object(o.a)(r,e);var t=Object(s.a)(r);function r(e){var n;return Object(i.a)(this,r),(n=t.call(this,e)).codedValues=null,n.type="coded-value",n}return Object(a.a)(r,[{key:"getName",value:function(e){var t=null;if(this.codedValues){var r=String(e);this.codedValues.some((function(e){return String(e.code)===r&&(t=e.name),!!t}))}return t}},{key:"clone",value:function(){return new n({codedValues:Object(l.a)(this.codedValues),name:this.name})}}]),r}(p.a);Object(c.a)([Object(u.b)({type:[f.a],json:{write:!0}})],b.prototype,"codedValues",void 0),Object(c.a)([Object(d.a)({codedValue:"coded-value"})],b.prototype,"type",void 0);var v=b=n=Object(c.a)([Object(h.a)("esri.layers.support.CodedValueDomain")],b);t.a=v},function(e,t,r){"use strict";r.d(t,"a",(function(){return c})),r.d(t,"b",(function(){return l})),r.d(t,"c",(function(){return u}));var n=r(33),i=r(13),a=r(2),o=r(5),s=r(74),c=-3,l=function(){function e(t,r,n){Object(a.a)(this,e),this._namespace=t,this._storage=r,this._removeFunc=!1,this._hit=0,this._miss=0,this._storage.register(this),this._namespace+=":",n&&(this._storage.registerRemoveFunc(this._namespace,n),this._removeFunc=!0)}return Object(o.a)(e,[{key:"destroy",value:function(){this._storage.clear(this._namespace),this._removeFunc&&this._storage.deregisterRemoveFunc(this._namespace),this._storage.deregister(this),this._storage=null}},{key:"namespace",get:function(){return this._namespace.slice(0,-1)}},{key:"hitRate",get:function(){return this._hit/(this._hit+this._miss)}},{key:"size",get:function(){return this._storage.size}},{key:"maxSize",get:function(){return this._storage.maxSize}},{key:"resetHitRate",value:function(){this._hit=this._miss=0}},{key:"put",value:function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;this._storage.put(this._namespace+e,t,r,n)}},{key:"get",value:function(e){var t=this._storage.get(this._namespace+e);return void 0===t?++this._miss:++this._hit,t}},{key:"pop",value:function(e){var t=this._storage.pop(this._namespace+e);return void 0===t?++this._miss:++this._hit,t}},{key:"updateSize",value:function(e,t,r){this._storage.updateSize(this._namespace+e,t,r)}},{key:"clear",value:function(){this._storage.clear(this._namespace)}},{key:"clearAll",value:function(){this._storage.clearAll()}},{key:"getStats",value:function(){return this._storage.getStats()}},{key:"resetStats",value:function(){this._storage.resetStats()}}]),e}(),u=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10485760;Object(a.a)(this,e),this._maxSize=t,this._db=new Map,this._size=0,this._hit=0,this._miss=0,this._removeFuncs=new s.a,this._users=new s.a}return Object(o.a)(e,[{key:"destroy",value:function(){this.clearAll(),this._removeFuncs.clear(),this._users.clear(),this._db=null}},{key:"register",value:function(e){this._users.push(e)}},{key:"deregister",value:function(e){this._users.removeUnordered(e)}},{key:"registerRemoveFunc",value:function(e,t){this._removeFuncs.push([e,t])}},{key:"deregisterRemoveFunc",value:function(e){this._removeFuncs.filterInPlace((function(t){return t[0]!==e}))}},{key:"size",get:function(){return this._size}},{key:"maxSize",get:function(){return this._maxSize},set:function(e){this._maxSize=Math.max(e,0),this._checkSizeLimit()}},{key:"put",value:function(e,t,r,n){var i=this._db.get(e);if(i&&(this._size-=i.size,this._db.delete(e),i.entry!==t&&this._notifyRemoved(e,i.entry)),r>this._maxSize)this._notifyRemoved(e,t);else if(void 0!==t)if(!r||r<0)console.warn("Refusing to cache entry with invalid size "+r);else{var a=1+Math.max(n,c)-c;this._db.set(e,{entry:t,size:r,lifetime:a,lives:a}),this._size+=r,this._checkSizeLimit()}else console.warn("Refusing to cache undefined entry ")}},{key:"updateSize",value:function(e,t,r){var n=this._db.get(e);if(n&&n.entry===t){if(this._size-=n.size,r>this._maxSize)return this._db.delete(e),void this._notifyRemoved(e,t);n.size=r,this._size+=r,this._checkSizeLimit()}}},{key:"pop",value:function(e){var t=this._db.get(e);if(t)return this._size-=t.size,this._db.delete(e),++this._hit,t.entry;++this._miss}},{key:"get",value:function(e){var t=this._db.get(e);if(void 0!==t)return this._db.delete(e),t.lives=t.lifetime,this._db.set(e,t),++this._hit,t.entry;++this._miss}},{key:"getStats",value:function(){var e=this,t={Size:Math.round(this._size/1048576)+"/"+Math.round(this._maxSize/1048576)+"MB","Hit rate":Math.round(100*this._getHitRate())+"%",Entries:this._db.size.toString()},r={},n=new Array;this._db.forEach((function(t,i){var a=t.lifetime;n[a]=(n[a]||0)+t.size,e._users.forAll((function(e){var n=e.namespace;if(i.startsWith(n)){var a=r[n]||0;r[n]=a+t.size}}))}));var i={};this._users.forAll((function(e){var t=e.namespace;if(!isNaN(e.hitRate)&&e.hitRate>0){var n=r[t]||0;r[t]=n,i[t]=Math.round(100*e.hitRate)+"%"}else i[t]="0%"}));var a=Object.keys(r);a.forEach((function(t){return r[t]=r[t]/e._size*100})),a.sort((function(e,t){return r[t]-r[e]})),a.forEach((function(e){return t[e]=Math.round(r[e])+"% / "+i[e]}));for(var o=n.length-1;o>=0;--o){var s=n[o];s&&(t["Priority "+(o+c-1)]=Math.round(s/this.size*100)+"%")}return t}},{key:"resetStats",value:function(){this._hit=this._miss=0,this._users.forAll((function(e){return e.resetHitRate()}))}},{key:"clear",value:function(e){var t=this;this._db.forEach((function(r,n){n.startsWith(e)&&(t._size-=r.size,t._db.delete(n),t._notifyRemoved(n,r.entry))}))}},{key:"clearAll",value:function(){var e=this;this._db.forEach((function(t,r){return e._notifyRemoved(r,t.entry)})),this._size=0,this._db.clear()}},{key:"_getHitRate",value:function(){return this._hit/(this._hit+this._miss)}},{key:"_notifyRemoved",value:function(e,t){this._removeFuncs.forAll((function(r){e.startsWith(r[0])&&r[1](t)}))}},{key:"_checkSizeLimit",value:function(){if(!(this._size<=this._maxSize)){var e,t=Object(i.a)(this._db);try{for(t.s();!(e=t.n()).done;){var r=Object(n.a)(e.value,2),a=r[0],o=r[1];if(this._db.delete(a),o.lives<=1?(this._size-=o.size,this._notifyRemoved(a,o.entry)):(--o.lives,this._db.set(a,o)),this._size<=.9*this.maxSize)return}}catch(s){t.e(s)}finally{t.f()}}}}]),e}()},function(e,t,r){"use strict";r.d(t,"a",(function(){return b})),r.d(t,"b",(function(){return v})),r.d(t,"c",(function(){return y}));var n=r(13),i=r(20),a=r(3),o=r(94),s=r(4),c=r(9),l=r(51),u=r(397),d=r(477),h=r(65),f=r(266),p=r(115);function b(e){var t=[],r=[];!function(e,t,r){for(var n=e.attributeData.position,i=e.removeDuplicateStartEnd,a=function(e){var t=e.length;return e[0]===e[t-3]&&e[1]===e[t-2]&&e[2]===e[t-1]}(n)&&1===i,s=n.length/3-(a?1:0),c=new Uint32Array(2*(s-1)),l=a?Object(o.m)(n,0,n.length-3):n,u=0,d=0;d<s-1;d++)c[u++]=d,c[u++]=d+1;t.push(["position",{size:3,data:l,exclusive:a}]),r.push(["position",c])}(e,r,t);var n=r[0][1].data,c=t[0][1].length,l=new Uint16Array(c);return function(e,t,r){var n=e.attributeData.mapPosition;Object(a.i)(n)||(r.push(["mapPos",r[0][1]]),t.push(["mapPos",{size:3,data:n}]))}(e,r,t),function(e,t,r,n){if(Object(a.j)(e.attributeData.colorFeature))return;var i=e.attributeData.color;t.push(["color",{size:4,data:Object(a.t)(i,d.c)}]),r.push(["color",n])}(e,r,t,l),function(e,t,r,n){if(Object(a.j)(e.attributeData.sizeFeature))return;var i=e.attributeData.size;t.push(["size",{size:1,data:[Object(a.t)(i,1)]}]),r.push(["size",n])}(e,r,t,l),function(e,t,r,n){var i=e.attributeData.colorFeature;Object(a.i)(i)||(t.push(["colorFeatureAttribute",{size:1,data:new Float32Array([i])}]),r.push(["color",n]))}(e,r,t,l),function(e,t,r,n){var i=e.attributeData.sizeFeature;Object(a.i)(i)||(t.push(["sizeFeatureAttribute",{size:1,data:new Float32Array([i])}]),r.push(["sizeFeatureAttribute",n]))}(e,r,t,l),function(e,t,r,n){var i=e.attributeData.opacityFeature;Object(a.i)(i)||(t.push(["opacityFeatureAttribute",{size:1,data:new Float32Array([i])}]),r.push(["opacityFeatureAttribute",n]))}(e,r,t,l),function(e,t,r,n){if("round"!==e.join)return;var o=n.length/3,c=new Float32Array(o),l=O,u=j;Object(s.y)(l,0,0,0);for(var d=Object(a.t)(e.uniformSize,1),h=-1;h<o;++h){var f=h<0?o+h:h,p=(h+1)%o;if(Object(s.y)(u,n[3*p+0]-n[3*f+0],n[3*p+1]-n[3*f+1],n[3*p+2]-n[3*f+2]),Object(s.t)(u,u),h>=0){var b=(Math.PI-Object(i.b)(Object(s.j)(l,u)))*_*1*g(d);c[h]=Math.max(Math.floor(b),0)}Object(s.g)(l,u,-1)}t.push(["subdivisions",{size:1,data:c}]),r.push(["subdivisions",r[0][1]])}(e,r,t,n),new p.a(r,t,2)}function v(e,t,r,n){var i="polygon"===e.type?1:0,a="polygon"===e.type?e.rings:e.paths,o=Object(u.a)(a,e.hasZ,i),s=o.position,c=o.outlines,l=new Float64Array(s.length),d=Object(h.c)(s,e.spatialReference,0,l,0,s,0,s.length/3,t,r,n),f=null!=d;return{lines:f?m(c,s,l):[],projectionSuccess:f,sampledElevation:d}}function m(e,t,r){var i,a=new Array,o=Object(n.a)(e);try{for(o.s();!(i=o.n()).done;){var s=i.value,c=s.index,l=s.count;if(!(l<=1)){var u=3*c,d=u+3*l;a.push({position:t.subarray(u,d),mapPosition:r?r.subarray(u,d):void 0})}}}catch(h){o.e(h)}finally{o.f()}return a}function y(e,t){for(var r="polygon"===e.type?1:0,n="polygon"===e.type?e.rings:e.paths,i=Object(u.a)(n,!1,r),a=i.position,o=i.outlines,s=Object(l.q)(a,e.spatialReference,0,a,t,0,a.length/3),c=2;c<a.length;c+=3)a[c]=f.a;return{lines:s?m(o,a):[],projectionSuccess:s}}function g(e){return 1.863798+-2.0062872/Math.pow(1+e/18.2313,.8856294)}var O=Object(c.e)(),j=Object(c.e)(),_=4/Math.PI},function(e,t,r){"use strict";var n,i=r(2),a=r(5),o=r(6),s=r(7),c=r(0),l=(r(1),r(17),r(18),r(15),r(52)),u=r(10),d=r(284),h=n=function(e){Object(o.a)(r,e);var t=Object(s.a)(r);function r(e){var n;return Object(i.a)(this,r),(n=t.call(this,e)).type="inherited",n}return Object(a.a)(r,[{key:"clone",value:function(){return new n}}]),r}(d.a);Object(c.a)([Object(l.a)({inherited:"inherited"})],h.prototype,"type",void 0);var f=h=n=Object(c.a)([Object(u.a)("esri.layers.support.InheritedDomain")],h);t.a=f},function(e,t,r){"use strict";var n,i=r(2),a=r(5),o=r(6),s=r(7),c=r(0),l=r(1),u=(r(17),r(18),r(15),r(52)),d=r(10),h=r(284),f=n=function(e){Object(o.a)(r,e);var t=Object(s.a)(r);function r(e){var n;return Object(i.a)(this,r),(n=t.call(this,e)).maxValue=null,n.minValue=null,n.type="range",n}return Object(a.a)(r,[{key:"clone",value:function(){return new n({maxValue:this.maxValue,minValue:this.minValue,name:this.name})}}]),r}(h.a);Object(c.a)([Object(l.b)({type:Number,json:{type:[Number],read:{source:"range",reader:function(e,t){return t.range&&t.range[1]}},write:{enabled:!1,overridePolicy:function(){return{enabled:null!=this.maxValue&&null==this.minValue}},target:"range",writer:function(e,t,r){t[r]=[this.minValue||0,e]}}}})],f.prototype,"maxValue",void 0),Object(c.a)([Object(l.b)({type:Number,json:{type:[Number],read:{source:"range",reader:function(e,t){return t.range&&t.range[0]}},write:{target:"range",writer:function(e,t,r){t[r]=[e,this.maxValue||0]}}}})],f.prototype,"minValue",void 0),Object(c.a)([Object(u.a)({range:"range"})],f.prototype,"type",void 0);var p=f=n=Object(c.a)([Object(d.a)("esri.layers.support.RangeDomain")],f);t.a=p},function(e,t,r){"use strict";var n,i=r(2),a=r(5),o=r(6),s=r(7),c=r(0),l=r(3),u=r(1),d=(r(17),r(18),r(15),r(52)),h=r(10),f=r(161),p=r(495),b=r(198),v=n=function(e){Object(o.a)(r,e);var t=Object(s.a)(r);function r(e){var n;return Object(i.a)(this,r),(n=t.call(this,e)).type="extrude",n.size=1,n.material=null,n.castShadows=!0,n.edges=null,n}return Object(a.a)(r,[{key:"clone",value:function(){return new n({edges:this.edges&&this.edges.clone(),enabled:this.enabled,material:Object(l.j)(this.material)?this.material.clone():null,castShadows:this.castShadows,size:this.size})}}]),r}(f.a);Object(c.a)([Object(d.a)({Extrude:"extrude"},{readOnly:!0})],v.prototype,"type",void 0),Object(c.a)([Object(u.b)({type:Number,json:{write:{enabled:!0,isRequired:!0}},nonNullable:!0})],v.prototype,"size",void 0),Object(c.a)([Object(u.b)({type:b.a,json:{write:!0}})],v.prototype,"material",void 0),Object(c.a)([Object(u.b)({type:Boolean,nonNullable:!0,json:{write:!0,default:!0}})],v.prototype,"castShadows",void 0),Object(c.a)([Object(u.b)(p.a)],v.prototype,"edges",void 0);var m=v=n=Object(c.a)([Object(h.a)("esri.symbols.ExtrudeSymbol3DLayer")],v);t.a=m},function(e,t,r){"use strict";var n,i=r(2),a=r(5),o=r(6),s=r(7),c=r(0),l=r(3),u=r(1),d=(r(17),r(18),r(15),r(52)),h=r(48),f=r(10),p=r(161),b=r(198),v=n=function(e){Object(o.a)(r,e);var t=Object(s.a)(r);function r(e){var n;return Object(i.a)(this,r),(n=t.call(this,e)).material=null,n.castShadows=!0,n.type="path",n.profile="circle",n.join="miter",n.cap="butt",n.width=void 0,n.height=void 0,n.anchor="center",n.profileRotation="all",n}return Object(a.a)(r,[{key:"size",get:function(){return this.width&&this.height?this.width===this.height?this.width:void 0:this.width?this.width:this.height?this.height:void 0},set:function(e){this.width=e,this.height=e}},{key:"readSize",value:function(e,t){return t.height||t.width?e:t.size}},{key:"clone",value:function(){return new n({enabled:this.enabled,material:Object(l.j)(this.material)?this.material.clone():null,castShadows:this.castShadows,size:this.size,profile:this.profile,join:this.join,cap:this.cap,width:this.width,height:this.height,profileRotation:this.profileRotation,anchor:this.anchor})}}]),r}(p.a);Object(c.a)([Object(u.b)({type:b.a,json:{write:!0}})],v.prototype,"material",void 0),Object(c.a)([Object(u.b)({type:Boolean,nonNullable:!0,json:{write:!0,default:!0}})],v.prototype,"castShadows",void 0),Object(c.a)([Object(d.a)({Path:"path"},{readOnly:!0})],v.prototype,"type",void 0),Object(c.a)([Object(u.b)({type:Number})],v.prototype,"size",null),Object(c.a)([Object(h.a)("size")],v.prototype,"readSize",null),Object(c.a)([Object(u.b)({type:["circle","quad"],json:{write:!0,default:"circle"}})],v.prototype,"profile",void 0),Object(c.a)([Object(u.b)({type:["miter","bevel","round"],json:{write:!0,default:"miter"}})],v.prototype,"join",void 0),Object(c.a)([Object(u.b)({type:["none","butt","square","round"],json:{write:!0,default:"butt"}})],v.prototype,"cap",void 0),Object(c.a)([Object(u.b)({type:Number,json:{write:{enabled:!0,target:{width:{type:Number},size:{type:Number}}}}})],v.prototype,"width",void 0),Object(c.a)([Object(u.b)({type:Number,json:{write:!0}})],v.prototype,"height",void 0),Object(c.a)([Object(u.b)({type:["center","bottom","top"],json:{write:!0,default:"center"}})],v.prototype,"anchor",void 0),Object(c.a)([Object(u.b)({type:["heading","all"],json:{write:!0,default:"all"}})],v.prototype,"profileRotation",void 0);var m=v=n=Object(c.a)([Object(f.a)("esri.symbols.PathSymbol3DLayer")],v);t.a=m},function(e,t,r){"use strict";var n,i=r(2),a=r(5),o=r(6),s=r(7),c=r(0),l=r(49),u=r(25),d=r(1),h=r(18),f=(r(17),r(15),r(52)),p=r(10),b=r(161),v=n=function(e){Object(o.a)(r,e);var t=Object(s.a)(r);function r(e){var n;return Object(i.a)(this,r),(n=t.call(this,e)).color=m.clone(),n.type="water",n.waterbodySize="medium",n.waveDirection=null,n.waveStrength="moderate",n}return Object(a.a)(r,[{key:"clone",value:function(){return new n({color:Object(u.a)(this.color),waterbodySize:this.waterbodySize,waveDirection:this.waveDirection,waveStrength:this.waveStrength})}}]),r}(b.a);Object(c.a)([Object(d.b)({type:l.a,nonNullable:!0,json:{type:[h.a],write:function(e,t,r){return t[r]=e.toArray(1)},default:function(){return m.clone()},defaultEquals:function(e){return e.toCss(!0)===m.toCss(!0)}}})],v.prototype,"color",void 0),Object(c.a)([Object(f.a)({Water:"water"},{readOnly:!0})],v.prototype,"type",void 0),Object(c.a)([Object(d.b)({type:["small","medium","large"],json:{write:!0,default:"medium"}})],v.prototype,"waterbodySize",void 0),Object(c.a)([Object(d.b)({type:Number,json:{write:!0,default:null}})],v.prototype,"waveDirection",void 0),Object(c.a)([Object(d.b)({type:["calm","rippled","slight","moderate"],json:{write:!0,default:"moderate"}})],v.prototype,"waveStrength",void 0),v=n=Object(c.a)([Object(p.a)("esri.symbols.WaterSymbol3DLayer")],v);var m=new l.a([0,119,190]),y=v;t.a=y},function(e,t,r){"use strict";var n,i=r(2),a=r(5),o=r(6),s=r(7),c=r(0),l=r(53),u=r(25),d=r(1),h=(r(18),r(17),r(15),r(52)),f=r(10),p=r(275),b=r(223),v=l.a.ofType({base:null,key:"type",typeMap:{fill:p.a}}),m=n=function(e){Object(o.a)(r,e);var t=Object(s.a)(r);function r(e){var n;return Object(i.a)(this,r),(n=t.call(this,e)).symbolLayers=new v,n.type="mesh-3d",n}return Object(a.a)(r,[{key:"clone",value:function(){return new n({styleOrigin:Object(u.a)(this.styleOrigin),symbolLayers:Object(u.a)(this.symbolLayers),thumbnail:Object(u.a)(this.thumbnail)})}}]),r}(b.a);Object(c.a)([Object(d.b)({type:v})],m.prototype,"symbolLayers",void 0),Object(c.a)([Object(h.a)({MeshSymbol3D:"mesh-3d"},{readOnly:!0})],m.prototype,"type",void 0);var y=m=n=Object(c.a)([Object(f.a)("esri.symbols.MeshSymbol3D")],m);t.a=y},function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var n=r(2),i=r(182),a=function e(t){Object(n.a)(this,e),this.channel=t,this.id=Object(i.b)()}},function(e,t,r){"use strict";r.d(t,"a",(function(){return M})),r.d(t,"b",(function(){return A}));var n=r(33),i=r(13),a=r(2),o=r(5),s=r(45),c=r(42),l=r(6),u=r(7),d=r(3),h=r(67),f=r(224),p=r(81),b=(r(107),r(17)),v=(r(122),r(159),r(239),r(60),r(104)),m=r(601),y=function(){function e(t,r){Object(a.a)(this,e),this.layerUIDs=[],this.isDestroyed=!1,this.data=t,this.memoryUsed=t.byteLength;var n=1,i=new Uint32Array(t);this.layerUIDs=[];for(var o=i[n++],s=0;s<o;s++)this.layerUIDs[s]=i[n++];this.bufferDataOffset=n,r&&(this.layer=r.getStyleLayerByUID(this.layerUIDs[0]))}return Object(o.a)(e,[{key:"isPreparedForRendering",get:function(){return Object(d.i)(this.data)}},{key:"offset",get:function(){return this.bufferDataOffset}},{key:"destroy",value:function(){this.isDestroyed||(this.doDestroy(),this.isDestroyed=!0)}},{key:"prepareForRendering",value:function(e){Object(d.i)(this.data)||(this.doPrepareForRendering(e,this.data,this.bufferDataOffset),this.data=null)}}]),e}(),g=function(e){Object(l.a)(r,e);var t=Object(u.a)(r);function r(e,n){var i;Object(a.a)(this,r),(i=t.call(this,e,n)).type=2,i.lineIndexStart=0,i.lineIndexCount=0;var o=new Uint32Array(e),s=i.bufferDataOffset;i.lineIndexStart=o[s++],i.lineIndexCount=o[s++];var c=o[s++];if(c>0){for(var l=new Map,u=0;u<c;u++){var d=o[s++],h=o[s++],f=o[s++];l.set(d,[h,f])}i.patternMap=l}return i.bufferDataOffset=s,i}return Object(o.a)(r,[{key:"hasData",value:function(){return this.lineIndexCount>0}},{key:"triangleCount",value:function(){return this.lineIndexCount/3}},{key:"doDestroy",value:function(){Object(d.j)(this.lineVertexArrayObject)&&this.lineVertexArrayObject.dispose(),Object(d.j)(this.lineVertexBuffer)&&this.lineVertexBuffer.dispose(),Object(d.j)(this.lineIndexBuffer)&&this.lineIndexBuffer.dispose(),this.lineVertexArrayObject=null,this.lineVertexBuffer=null,this.lineIndexBuffer=null,this.memoryUsed=0}},{key:"doPrepareForRendering",value:function(e,t,r){var n=new Uint32Array(t),i=new Int32Array(n.buffer),a=n[r++];this.lineVertexBuffer=p.a.createVertex(e,35044,new Int32Array(i.buffer,4*r,a)),r+=a;var o=n[r++];this.lineIndexBuffer=p.a.createIndex(e,35044,new Uint32Array(n.buffer,4*r,o)),r+=o;var s=this.layer.lineMaterial;this.lineVertexArrayObject=new v.a(e,s.getAttributeLocations(),s.getLayoutInfo(),{geometry:this.lineVertexBuffer},this.lineIndexBuffer)}}]),r}(y),O=function(e){Object(l.a)(r,e);var t=Object(u.a)(r);function r(e,n){var i;Object(a.a)(this,r),(i=t.call(this,e,n)).type=1,i.fillIndexStart=0,i.fillIndexCount=0,i.outlineIndexStart=0,i.outlineIndexCount=0;var o=new Uint32Array(e),s=i.bufferDataOffset;i.fillIndexStart=o[s++],i.fillIndexCount=o[s++],i.outlineIndexStart=o[s++],i.outlineIndexCount=o[s++];var c=o[s++];if(c>0){for(var l=new Map,u=0;u<c;u++){var d=o[s++],h=o[s++],f=o[s++];l.set(d,[h,f])}i.patternMap=l}return i.bufferDataOffset=s,i}return Object(o.a)(r,[{key:"hasData",value:function(){return this.fillIndexCount>0||this.outlineIndexCount>0}},{key:"triangleCount",value:function(){return(this.fillIndexCount+this.outlineIndexCount)/3}},{key:"doDestroy",value:function(){Object(d.j)(this.fillVertexArrayObject)&&this.fillVertexArrayObject.dispose(),Object(d.j)(this.fillVertexBuffer)&&this.fillVertexBuffer.dispose(),Object(d.j)(this.fillIndexBuffer)&&this.fillIndexBuffer.dispose(),this.fillVertexArrayObject=null,this.fillVertexBuffer=null,this.fillIndexBuffer=null,Object(d.j)(this.outlineVertexArrayObject)&&this.outlineVertexArrayObject.dispose(),Object(d.j)(this.outlineVertexBuffer)&&this.outlineVertexBuffer.dispose(),Object(d.j)(this.outlineIndexBuffer)&&this.outlineIndexBuffer.dispose(),this.outlineVertexArrayObject=null,this.outlineVertexBuffer=null,this.outlineIndexBuffer=null,this.memoryUsed=0}},{key:"doPrepareForRendering",value:function(e,t,r){var n=new Uint32Array(t),i=new Int32Array(n.buffer),a=n[r++];this.fillVertexBuffer=p.a.createVertex(e,35044,new Int32Array(i.buffer,4*r,a)),r+=a;var o=n[r++];this.fillIndexBuffer=p.a.createIndex(e,35044,new Uint32Array(n.buffer,4*r,o)),r+=o;var s=n[r++];this.outlineVertexBuffer=p.a.createVertex(e,35044,new Int32Array(i.buffer,4*r,s)),r+=s;var c=n[r++];this.outlineIndexBuffer=p.a.createIndex(e,35044,new Uint32Array(n.buffer,4*r,c)),r+=c;var l=this.layer,u=l.fillMaterial,d=l.outlineMaterial;this.fillVertexArrayObject=new v.a(e,u.getAttributeLocations(),u.getLayoutInfo(),{geometry:this.fillVertexBuffer},this.fillIndexBuffer),this.outlineVertexArrayObject=new v.a(e,d.getAttributeLocations(),d.getLayoutInfo(),{geometry:this.outlineVertexBuffer},this.outlineIndexBuffer)}}]),r}(y),j=function(e){Object(l.a)(r,e);var t=Object(u.a)(r);function r(e,n,i){var o;Object(a.a)(this,r),(o=t.call(this,e,n)).type=3,o.iconPerPageElementsMap=new Map,o.glyphPerPageElementsMap=new Map,o.symbolInstances=[],o.isIconSDF=!1,o.opacityChanged=!1,o.lastOpacityUpdate=0,o.symbols=[];var s=new Uint32Array(e),c=new Int32Array(e),l=new Float32Array(e),u=o.bufferDataOffset;o.isIconSDF=!!s[u++];for(var d=s[u++],h=0;h<d;h++){var f=s[u++],p=s[u++],b=s[u++];o.iconPerPageElementsMap.set(f,[p,b])}for(var v=s[u++],y=0;y<v;y++){var g=s[u++],O=s[u++],j=s[u++];o.glyphPerPageElementsMap.set(g,[O,j])}var _=s[u++],w=s[u++];return o.iconOpacity=new Int32Array(_),o.textOpacity=new Int32Array(w),u=Object(m.b)(s,c,l,u,o.symbols,i),o.bufferDataOffset=u,o}return Object(o.a)(r,[{key:"hasData",value:function(){return this.iconPerPageElementsMap.size>0||this.glyphPerPageElementsMap.size>0}},{key:"triangleCount",value:function(){var e,t=0,r=Object(i.a)(this.iconPerPageElementsMap);try{for(r.s();!(e=r.n()).done;){var a=Object(n.a)(e.value,2);a[0];t+=a[1][1]}}catch(l){r.e(l)}finally{r.f()}var o,s=Object(i.a)(this.glyphPerPageElementsMap);try{for(s.s();!(o=s.n()).done;){var c=Object(n.a)(o.value,2);c[0];t+=c[1][1]}}catch(l){s.e(l)}finally{s.f()}return t/3}},{key:"doDestroy",value:function(){Object(d.j)(this.iconVertexArrayObject)&&this.iconVertexArrayObject.dispose(),Object(d.j)(this.iconVertexBuffer)&&this.iconVertexBuffer.dispose(),Object(d.j)(this.iconOpacityBuffer)&&this.iconOpacityBuffer.dispose(),Object(d.j)(this.iconIndexBuffer)&&this.iconIndexBuffer.dispose(),this.iconVertexArrayObject=null,this.iconVertexBuffer=null,this.iconOpacityBuffer=null,this.iconIndexBuffer=null,Object(d.j)(this.textVertexArrayObject)&&this.textVertexArrayObject.dispose(),Object(d.j)(this.textVertexBuffer)&&this.textVertexBuffer.dispose(),Object(d.j)(this.textOpacityBuffer)&&this.textOpacityBuffer.dispose(),Object(d.j)(this.textIndexBuffer)&&this.textIndexBuffer.dispose(),this.textVertexArrayObject=null,this.textVertexBuffer=null,this.textOpacityBuffer=null,this.textIndexBuffer=null,this.memoryUsed=0}},{key:"updateOpacityInfo",value:function(){if(this.opacityChanged){this.opacityChanged=!1;var e=Object(d.s)(this.iconOpacity),t=Object(d.s)(this.iconOpacityBuffer);e.length>0&&e.byteLength===t.size&&t.setSubData(e);var r=Object(d.s)(this.textOpacity),n=Object(d.s)(this.textOpacityBuffer);r.length>0&&r.byteLength===n.size&&n.setSubData(r)}}},{key:"doPrepareForRendering",value:function(e,t,r){var n=new Uint32Array(t),i=new Int32Array(n.buffer),a=n[r++];this.iconVertexBuffer=p.a.createVertex(e,35044,new Int32Array(i.buffer,4*r,a)),r+=a;var o=n[r++];this.iconIndexBuffer=p.a.createIndex(e,35044,new Uint32Array(n.buffer,4*r,o)),r+=o;var s=n[r++];this.textVertexBuffer=p.a.createVertex(e,35044,new Int32Array(i.buffer,4*r,s)),r+=s;var c=n[r++];this.textIndexBuffer=p.a.createIndex(e,35044,new Uint32Array(n.buffer,4*r,c)),r+=c,this.iconOpacityBuffer=p.a.createVertex(e,35044,Object(d.s)(this.iconOpacity).buffer),this.textOpacityBuffer=p.a.createVertex(e,35044,Object(d.s)(this.textOpacity).buffer);var l=this.layer,u=l.iconMaterial,h=l.textMaterial;this.iconVertexArrayObject=new v.a(e,u.getAttributeLocations(),u.getLayoutInfo(),{geometry:this.iconVertexBuffer,opacity:this.iconOpacityBuffer},this.iconIndexBuffer),this.textVertexArrayObject=new v.a(e,h.getAttributeLocations(),h.getLayoutInfo(),{geometry:this.textVertexBuffer,opacity:this.textOpacityBuffer},this.textIndexBuffer)}}]),r}(y),_=function(e){Object(l.a)(r,e);var t=Object(u.a)(r);function r(e,n){var i;Object(a.a)(this,r),(i=t.call(this,e,n)).type=4,i.circleIndexStart=0,i.circleIndexCount=0;var o=new Uint32Array(e),s=i.bufferDataOffset;return i.circleIndexStart=o[s++],i.circleIndexCount=o[s++],i.bufferDataOffset=s,i}return Object(o.a)(r,[{key:"hasData",value:function(){return this.circleIndexCount>0}},{key:"triangleCount",value:function(){return this.circleIndexCount/3}},{key:"doDestroy",value:function(){Object(d.j)(this.circleVertexArrayObject)&&this.circleVertexArrayObject.dispose(),Object(d.j)(this.circleVertexBuffer)&&this.circleVertexBuffer.dispose(),Object(d.j)(this.circleIndexBuffer)&&this.circleIndexBuffer.dispose(),this.circleVertexArrayObject=null,this.circleVertexBuffer=null,this.circleIndexBuffer=null,this.memoryUsed=0}},{key:"doPrepareForRendering",value:function(e,t,r){var n=new Uint32Array(t),i=new Int32Array(n.buffer),a=n[r++];this.circleVertexBuffer=p.a.createVertex(e,35044,new Int32Array(i.buffer,4*r,a)),r+=a;var o=n[r++];this.circleIndexBuffer=p.a.createIndex(e,35044,new Uint32Array(n.buffer,4*r,o)),r+=o;var s=this.layer.circleMaterial;this.circleVertexArrayObject=new v.a(e,s.getAttributeLocations(),s.getLayoutInfo(),{geometry:this.circleVertexBuffer},this.circleIndexBuffer)}}]),r}(y),w=r(550),x=r(82),k=r(23),S=1/Object(b.a)("mapview-transitions-duration"),T=function(e){Object(l.a)(r,e);var t=Object(u.a)(r);function r(){var e;return Object(a.a)(this,r),(e=t.apply(this,arguments))._fadeOutResolver=null,e._fadeInResolver=null,e._clips=null,e.computedVisible=!0,e.computedOpacity=1,e.fadeTransitionEnabled=!1,e.inFadeTransition=!1,e._isReady=!1,e._opacity=1,e._stage=null,e._visible=!0,e}return Object(o.a)(r,[{key:"clips",get:function(){return this._clips},set:function(e){this._clips=e,this.requestRender()}},{key:"isReady",get:function(){return this._isReady}},{key:"opacity",get:function(){return this._opacity},set:function(e){this._opacity!==e&&(this._opacity=Math.min(1,Math.max(e,0)),this.requestRender())}},{key:"stage",get:function(){return this._stage},set:function(e){if(this._stage!==e){var t=this._stage;this._stage=e,e?this._stage.untrashDisplayObject(this)||(this.onAttach(),this.emit("attach")):t.trashDisplayObject(this)}}},{key:"visible",get:function(){return this._visible},set:function(e){this._visible!==e&&(this._visible=e,this.requestRender())}},{key:"fadeIn",value:function(){return this._fadeInResolver||(this._fadeOutResolver&&(this._fadeOutResolver(),this._fadeOutResolver=null),this.computedOpacity=0,this.fadeTransitionEnabled=!0,this._fadeInResolver=Object(k.h)(),this.requestRender()),this._fadeInResolver.promise}},{key:"fadeOut",value:function(){return this._fadeOutResolver||(this._fadeInResolver&&(this._fadeInResolver(),this._fadeInResolver=null),this.fadeTransitionEnabled=!0,this._fadeOutResolver=Object(k.h)(),this.requestRender()),this._fadeOutResolver.promise}},{key:"beforeRender",value:function(e){this.updateTransitionProperties(e.deltaTime,e.state.scale)}},{key:"afterRender",value:function(e){this._fadeInResolver&&this.computedOpacity===this.opacity?(this._fadeInResolver(),this._fadeInResolver=null):this._fadeOutResolver&&0===this.computedOpacity&&(this._fadeOutResolver(),this._fadeOutResolver=null)}},{key:"remove",value:function(){var e;null==(e=this.parent)||e.removeChild(this)}},{key:"setTransform",value:function(e){}},{key:"processRender",value:function(e){this.stage&&this.computedVisible&&this.doRender(e)}},{key:"requestRender",value:function(){this.stage&&this.stage.requestRender()}},{key:"processDetach",value:function(){this.onDetach(),this.emit("detach")}},{key:"updateTransitionProperties",value:function(e,t){if(this.fadeTransitionEnabled){var r=this._fadeOutResolver||!this.visible?0:this.opacity,n=this.computedOpacity;if(n===r)this.computedVisible=this.visible;else{var i=e*S;this.computedOpacity=n>r?Math.max(r,n-i):Math.min(r,n+i),this.computedVisible=this.computedOpacity>0;var a=r===this.computedOpacity;this.inFadeTransition=!a,a||this.requestRender()}}else this.computedOpacity=this.opacity,this.computedVisible=this.visible}},{key:"onAttach",value:function(){}},{key:"onDetach",value:function(){}},{key:"doRender",value:function(e){}},{key:"ready",value:function(){this._isReady||(this._isReady=!0,this.emit("isReady"),this.requestRender())}}]),r}(x.a),C=r(580),M=function(e){Object(l.a)(r,e);var t=Object(u.a)(r);function r(e,n,i,o){var s,c=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;return Object(a.a)(this,r),(s=t.call(this,e,i,o,[4096,4096]))._memCache=c,s._referenced=0,s._hasSymbolBuckets=!1,s._memoryUsedByLayerData=0,s.layerData=new Map,s.layerCount=0,s.status="loading",s.allSymbolsFadingOut=!1,s.lastOpacityUpdate=0,s.symbols=new Map,s.isCoverage=!1,s.neededForCoverage=!1,s.decluttered=!1,s.invalidating=!1,s.parentTile=null,s.childrenTiles=new Set,s._processed=!1,s._referenced=1,s.styleRepository=n,s.id=e.id,s.transforms.tileUnitsToPixels=Object(f.b)(),s}return Object(o.a)(r,[{key:"hasSymbolBuckets",get:function(){return this._hasSymbolBuckets}},{key:"isFading",get:function(){return this._hasSymbolBuckets&&performance.now()-this.lastOpacityUpdate<w.c}},{key:"isHoldingForFade",get:function(){return this._hasSymbolBuckets&&(!this.allSymbolsFadingOut||performance.now()-this.lastOpacityUpdate<w.c)}},{key:"wasRequested",get:function(){return"errored"===this.status||"loaded"===this.status||"reloading"===this.status}},{key:"setData",value:function(e){this.changeDataImpl(e),this.requestRender(),this.ready(),this.invalidating=!1,this._processed=!0}},{key:"deleteLayerData",value:function(e){var t,r=!1,n=Object(i.a)(e);try{for(n.s();!(t=n.n()).done;){var a=t.value;if(this.layerData.has(a)){var o=this.layerData.get(a);this._memoryUsedByLayerData-=o.memoryUsed,3===o.type&&this.symbols.has(a)&&(this.symbols.delete(a),r=!0),o.destroy(),this.layerData.delete(a),this.layerCount--}}}catch(s){n.e(s)}finally{n.f()}Object(d.j)(this._memCache)&&this._memCache.updateSize(this.key.id,this,this._memoryUsedByLayerData),r&&this.emit("symbols-changed"),this.requestRender()}},{key:"processed",value:function(){return this._processed}},{key:"hasData",value:function(){return this.layerCount>0}},{key:"dispose",value:function(){"unloaded"!==this.status&&(P.delete(this),r._destroyRenderBuckets(this.layerData),this.layerData=null,this.layerCount=0,this._memoryUsedByLayerData=0,this.destroy(),this.status="unloaded")}},{key:"release",value:function(){return 0==--this._referenced&&(this.dispose(),this.stage=null,!0)}},{key:"retain",value:function(){++this._referenced}},{key:"referenced",get:function(){return this._referenced}},{key:"memoryUsage",get:function(){return(this._memoryUsedByLayerData+256)/(this._referenced||1)}},{key:"changeDataImpl",value:function(e){var t=!1;if(e){var r,a=this._createRenderBuckets(e),o=Object(i.a)(a);try{for(o.s();!(r=o.n()).done;){var s=Object(n.a)(r.value,2),c=s[0],l=s[1];if(this.layerData.has(c)){var u=this.layerData.get(c);this._memoryUsedByLayerData-=l.memoryUsed,u.destroy(),this.layerData.delete(c),this.layerCount--}3===l.type&&(this.symbols.set(c,l.symbols),t=!0),this._memoryUsedByLayerData+=l.memoryUsed,this.layerData.set(c,l),this.layerCount++}}catch(b){o.e(b)}finally{o.f()}Object(d.j)(this._memCache)&&this._memCache.updateSize(this.key.id,this,this._memoryUsedByLayerData)}this._hasSymbolBuckets=!1;var h,f=Object(i.a)(this.layerData);try{for(f.s();!(h=f.n()).done;){var p=Object(n.a)(h.value,2);p[0];3===p[1].type&&(this._hasSymbolBuckets=!0)}}catch(b){f.e(b)}finally{f.f()}t&&this.emit("symbols-changed")}},{key:"attachWithContext",value:function(e){this.stage={context:e,trashDisplayObject:function(e){e.processDetach()},untrashDisplayObject:function(){return!1}}}},{key:"setTransform",value:function(e,t){Object(s.a)(Object(c.a)(r.prototype),"setTransform",this).call(this,e,t);var n=t/(e.resolution*e.pixelRatio),i=this.size[0]/this.coordRange[0]*n,a=this.size[1]/this.coordRange[1]*n,o=[0,0];e.toScreen(o,this.coords);var l=this.transforms.tileUnitsToPixels;Object(h.b)(l),Object(h.c)(l,l,o),Object(h.l)(l,l,Math.PI*e.rotation/180),Object(h.d)(l,l,[i,a,1])}},{key:"_createRenderBuckets",value:function(e){var t,r=new Map,n=new Map,a=Object(i.a)(e);try{for(a.s();!(t=a.n()).done;){var o,s=t.value,c=this._deserializeBucket(s,n),l=Object(i.a)(c.layerUIDs);try{for(l.s();!(o=l.n()).done;){var u=o.value;r.set(u,c)}}catch(d){l.e(d)}finally{l.f()}}}catch(d){a.e(d)}finally{a.f()}return r}},{key:"_deserializeBucket",value:function(e,t){var r=t.get(e);if(r)return r;switch(new Uint32Array(e)[0]){case 1:r=new O(e,this.styleRepository);break;case 2:r=new g(e,this.styleRepository);break;case 3:r=new j(e,this.styleRepository,this);break;case 4:r=new _(e,this.styleRepository)}return t.set(e,r),r}}],[{key:"_destroyRenderBuckets",value:function(e){if(e){var t=new Set;e.forEach((function(e){t.has(e)||(e.destroy(),t.add(e))})),e.clear()}}}]),r}(function(e){Object(l.a)(r,e);var t=Object(u.a)(r);function r(e,n,i){var o,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:i;return Object(a.a)(this,r),(o=t.call(this)).triangleCountReportedInDebug=0,o.transforms={dvs:Object(f.b)(),tileMat3:Object(f.b)()},o.triangleCount=0,o.key=new C.a(e),o.bounds=n,o.size=i,o.coordRange=s,o}return Object(o.a)(r,[{key:"destroy",value:function(){this.texture&&(this.texture.dispose(),this.texture=null)}},{key:"coords",get:function(){return this._coords}},{key:"bounds",get:function(){return this._bounds},set:function(e){this._coords=[e[0],e[3]],this._bounds=e}},{key:"setTransform",value:function(e,t){var r=t/(e.resolution*e.pixelRatio),i=this.transforms.tileMat3,a=e.toScreenNoRotation([0,0],this.coords),o=Object(n.a)(a,2),s=o[0],c=o[1],l=this.size[0]/this.coordRange[0]*r,u=this.size[1]/this.coordRange[1]*r;Object(h.m)(i,l,0,0,0,u,0,s,c,1),Object(h.j)(this.transforms.dvs,e.displayViewMat3,i)}}]),r}(T)),P=new Map;function A(){P.forEach((function(e,t){console.log("\n".concat(t.key,":")),e[0].forEach((function(e){return console.log(e)})),console.log("========"),e[1].forEach((function(e){return console.log(e)}))}))}},function(e,t,r){"use strict";var n,i=r(2),a=r(5),o=r(6),s=r(7),c=r(0),l=r(30),u=r(1),d=(r(17),r(18),r(15),r(10)),h=n=function(e){Object(o.a)(r,e);var t=Object(s.a)(r);function r(){return Object(i.a)(this,r),t.apply(this,arguments)}return Object(a.a)(r,[{key:"clone",value:function(){return new n({url:this.url})}}]),r}(l.a);Object(c.a)([Object(u.b)({type:String})],h.prototype,"url",void 0);var f=h=n=Object(c.a)([Object(d.a)("esri.symbols.support.Thumbnail")],h);t.a=f},function(e,t,r){"use strict";var n,i=r(2),a=r(5),o=r(6),s=r(7),c=r(0),l=r(27),u=r(25),d=r(1),h=r(18),f=(r(17),r(15),r(10)),p=r(44),b=n=function(e){Object(o.a)(r,e);var t=Object(s.a)(r);function r(e){var n;return Object(i.a)(this,r),(n=t.call(this,e)).attachmentTypes=null,n.attachmentsWhere=null,n.keywords=null,n.globalIds=null,n.name=null,n.num=null,n.objectIds=null,n.returnMetadata=!1,n.size=null,n.start=null,n.where=null,n}return Object(a.a)(r,[{key:"writeStart",value:function(e,t){t.resultOffset=this.start,t.resultRecordCount=this.num||10}},{key:"clone",value:function(){return new n(Object(u.a)({attachmentTypes:this.attachmentTypes,attachmentsWhere:this.attachmentsWhere,keywords:this.keywords,where:this.where,globalIds:this.globalIds,name:this.name,num:this.num,objectIds:this.objectIds,returnMetadata:this.returnMetadata,size:this.size,start:this.start}))}}]),r}(l.a);Object(c.a)([Object(d.b)({type:[String],json:{write:!0}})],b.prototype,"attachmentTypes",void 0),Object(c.a)([Object(d.b)({type:String,json:{read:{source:"attachmentsDefinitionExpression"},write:{target:"attachmentsDefinitionExpression"}}})],b.prototype,"attachmentsWhere",void 0),Object(c.a)([Object(d.b)({type:[String],json:{write:!0}})],b.prototype,"keywords",void 0),Object(c.a)([Object(d.b)({type:[Number],json:{write:!0}})],b.prototype,"globalIds",void 0),Object(c.a)([Object(d.b)({json:{write:!0}})],b.prototype,"name",void 0),Object(c.a)([Object(d.b)({type:Number,json:{read:{source:"resultRecordCount"}}})],b.prototype,"num",void 0),Object(c.a)([Object(d.b)({type:[Number],json:{write:!0}})],b.prototype,"objectIds",void 0),Object(c.a)([Object(d.b)({type:Boolean,json:{default:!1,write:!0}})],b.prototype,"returnMetadata",void 0),Object(c.a)([Object(d.b)({type:[Number],json:{write:!0}})],b.prototype,"size",void 0),Object(c.a)([Object(d.b)({type:Number,json:{read:{source:"resultOffset"}}})],b.prototype,"start",void 0),Object(c.a)([Object(p.a)("start"),Object(p.a)("num")],b.prototype,"writeStart",null),Object(c.a)([Object(d.b)({type:String,json:{read:{source:"definitionExpression"},write:{target:"definitionExpression"}}})],b.prototype,"where",void 0),(b=n=Object(c.a)([Object(f.a)("esri.rest.support.AttachmentQuery")],b)).from=Object(h.m)(b);var v=b;t.a=v},function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var n=r(13),i=r(372);function a(e,t,r){if(r&&r.features&&r.hasZ){var a=Object(i.a)(r.geometryType,t,e.outSpatialReference);if(a){var o,s=Object(n.a)(r.features);try{for(s.s();!(o=s.n()).done;){a(o.value.geometry)}}catch(c){s.e(c)}finally{s.f()}}}}},function(e,t,r){"use strict";function n(e){return"point"===e.type}r.d(t,"a",(function(){return n}))},function(e,t,r){"use strict";function n(e,t,r){for(var n=0;n<r;++n)t[2*n]=e[n],t[2*n+1]=e[n]-t[2*n]}function i(e,t,r,i){for(var s=0;s<i;++s)a[0]=e[s],n(a,o,1),t[s]=o[0],r[s]=o[1]}r.d(t,"a",(function(){return n})),r.d(t,"b",(function(){return i}));var a=new Float64Array(1),o=new Float32Array(2)},function(e,t,r){"use strict";var n,i=r(2),a=r(5),o=r(6),s=r(7),c=r(0),l=(r(17),r(27)),u=r(1),d=r(18),h=(r(15),r(48)),f=r(10),p=r(44),b=r(130),v=r(270),m=new WeakMap,y=0,g=n=function(e){Object(o.a)(r,e);var t=Object(s.a)(r);function r(e){var n;return Object(i.a)(this,r),(n=t.call(this,e)).wrap="repeat",n}return Object(a.a)(r,[{key:"url",get:function(){return this._get("url")||null},set:function(e){this._set("url",e),e&&this._set("data",null)}},{key:"data",get:function(){return this._get("data")||null},set:function(e){this._set("data",e),e&&this._set("url",null)}},{key:"writeData",value:function(e,t,r,n){if(e instanceof HTMLImageElement){var i={type:"image-element",src:Object(b.e)(e.src,n),crossOrigin:e.crossOrigin};t[r]=i}else if(e instanceof HTMLCanvasElement){var a=e.getContext("2d").getImageData(0,0,e.width,e.height),o={type:"canvas-element",imageData:this.encodeImageData(a)};t[r]=o}else if(e instanceof HTMLVideoElement){var s={type:"video-element",src:Object(b.e)(e.src,n),autoplay:e.autoplay,loop:e.loop,muted:e.muted,crossOrigin:e.crossOrigin,preload:e.preload};t[r]=s}else{var c={type:"image-data",imageData:this.encodeImageData(e)};t[r]=c}}},{key:"readData",value:function(e){switch(e.type){case"image-element":var t=new Image;return t.src=e.src,t.crossOrigin=e.crossOrigin,t;case"canvas-element":var r=this.decodeImageData(e.imageData),n=document.createElement("canvas");return n.width=r.width,n.height=r.height,n.getContext("2d").putImageData(r,0,0),n;case"image-data":return this.decodeImageData(e.imageData);case"video-element":var i=document.createElement("video");return i.src=e.src,i.crossOrigin=e.crossOrigin,i.autoplay=e.autoplay,i.loop=e.loop,i.muted=e.muted,i.preload=e.preload,i;default:return}}},{key:"transparent",get:function(){var e=this.data,t=this.url;if(e instanceof HTMLCanvasElement)return this.imageDataContainsTransparent(e.getContext("2d").getImageData(0,0,e.width,e.height));if(e instanceof ImageData)return this.imageDataContainsTransparent(e);if(t){var r=t.substr(t.length-4,4).toLowerCase(),n=t.substr(0,15).toLocaleLowerCase();if(".png"===r||"data:image/png;"===n)return!0}return!1},set:function(e){null!=e?this._override("transparent",e):this._clearOverride("transparent")}},{key:"contentHash",get:function(){var e=this,t="string"==typeof this.wrap?this.wrap:"object"==typeof this.wrap?"".concat(this.wrap.horizontal,"/").concat(this.wrap.vertical):"",r=function(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return"d:".concat(r,",t:").concat(e.transparent,",w:").concat(t)};return null!=this.url?r(this.url):null!=this.data?this.data instanceof HTMLImageElement||this.data instanceof HTMLVideoElement?r(this.data.src):(m.has(this.data)||m.set(this.data,++y),r(m.get(this.data))):r()}},{key:"clone",value:function(){var e={url:this.url,data:this.data,wrap:this.cloneWrap()};return new n(e)}},{key:"cloneWithDeduplication",value:function(e){var t=e.get(this);if(t)return t;var r=this.clone();return e.set(this,r),r}},{key:"cloneWrap",value:function(){return"string"==typeof this.wrap?this.wrap:{horizontal:this.wrap.horizontal,vertical:this.wrap.vertical}}},{key:"encodeImageData",value:function(e){for(var t="",r=0;r<e.data.length;r++)t+=String.fromCharCode(e.data[r]);return{data:btoa(t),width:e.width,height:e.height}}},{key:"decodeImageData",value:function(e){for(var t=atob(e.data),r=new Uint8ClampedArray(t.length),n=0;n<t.length;n++)r[n]=t.charCodeAt(n);return Object(v.f)(r,e.width,e.height)}},{key:"imageDataContainsTransparent",value:function(e){for(var t=3;t<e.data.length;t+=4)if(255!==e.data[t])return!0;return!1}}],[{key:"from",value:function(e){return"string"==typeof e?new n({url:e}):e instanceof HTMLImageElement||e instanceof HTMLCanvasElement||e instanceof ImageData||e instanceof HTMLVideoElement?new n({data:e}):Object(d.d)(n,e)}}]),r}(l.a);Object(c.a)([Object(u.b)({type:String,json:{write:b.f}})],g.prototype,"url",null),Object(c.a)([Object(u.b)({json:{write:{overridePolicy:function(){return{enabled:!this.url}}}}}),Object(u.b)()],g.prototype,"data",null),Object(c.a)([Object(p.a)("data")],g.prototype,"writeData",null),Object(c.a)([Object(h.a)("data")],g.prototype,"readData",null),Object(c.a)([Object(u.b)({type:Boolean,json:{write:{overridePolicy:function(){return{enabled:this._isOverridden("transparent")}}}}})],g.prototype,"transparent",null),Object(c.a)([Object(u.b)({json:{write:!0}})],g.prototype,"wrap",void 0),Object(c.a)([Object(u.b)({readOnly:!0})],g.prototype,"contentHash",null);var O=g=n=Object(c.a)([Object(f.a)("esri.geometry.support.MeshTexture")],g);t.a=O},function(e,t,r){"use strict";r.d(t,"a",(function(){return B}));var n=r(14),i=r(2),a=r(5),o=r(6),s=r(7),c=r(15),l=r(3),u=r(28),d=r(29),h=r(4),f=r(9),p=r(125),b=r(37),v=r(32),m=r(150),y=r(195),g=r(116),O=r(46),j=r(151),_=r(246),w=r(102),x=r(136),k=r(45),S=r(42),T=r(0),C=r(76),M=r(109),P=r(106),A=r(91),E=r(95),R=r(24),I=r(77),D=r(88),F=r(111),L=r(619),z=r(41),V=function(e){Object(o.a)(r,e);var t=Object(s.a)(r);function r(e,n,a){var o;return Object(i.a)(this,r),(o=t.call(this,e,n,a)).stipplePattern=null,o.stippleTextureBind=null,o.stippleTextureRepository=e.stippleTextureRepository,o}return Object(a.a)(r,[{key:"initializeProgram",value:function(e){var t=r.shader.get(),n=this.configuration,i=t.build({output:n.output,attributeColor:n.vertexColors,slicePlaneEnabled:n.slicePlaneEnabled,sliceHighlightDisabled:!1,sliceEnabledForVertexPrograms:!1,stippleEnabled:n.stippleEnabled,stippleOffColorEnabled:n.stippleOffColorEnabled,stippleUVMaxEnabled:!1,stippleIntegerRepeatsEnabled:n.stippleIntegerRepeatsEnabled});return new D.a(e.rctx,i,I.a)}},{key:"dispose",value:function(){Object(k.a)(Object(S.a)(r.prototype),"dispose",this).call(this),this.stippleTextureRepository.release(this.stipplePattern),this.stipplePattern=null,this.stippleTextureBind=null}},{key:"bindPass",value:function(e,t){if(Object(P.c)(this.program,t.camera.projectionMatrix),this.stipplePattern!==e.stipplePattern){var r=e.stipplePattern;this.stippleTextureBind=this.stippleTextureRepository.swap(this.stipplePattern,r),this.stipplePattern=r}if(this.configuration.stippleEnabled){var n=Object(l.j)(this.stippleTextureBind)?this.stippleTextureBind(this.program)*t.camera.pixelRatio:1;this.program.setUniform1i("stipplePatternTexture",0),this.program.setUniform1f("stipplePatternPixelSizeInv",1/n),this.program.setUniform2f("ndcToPixel",t.camera.fullViewport[2]/2,t.camera.fullViewport[3]/2)}if(this.program.setUniform4fv("constantColor",e.color),this.program.setUniform1f("alphaCoverage",Math.min(1,e.width*t.camera.pixelRatio)),this.configuration.stippleOffColorEnabled){var i=Object(l.s)(e.stippleOffColor);this.program.setUniform4f("stippleOffColor",i[0],i[1],i[2],i.length>3?i[3]:1)}4===this.configuration.output&&Object(M.b)(this.program,t)}},{key:"bindDraw",value:function(e){Object(P.d)(this.program,e),Object(C.c)(this.program,this.configuration,e),this.program.rebindTextures()}},{key:"initializePipeline",value:function(){var e=this.configuration,t=Object(z.h)(770,1,771,771),r=function(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return Object(z.g)({blending:r,depthTest:F.b,depthWrite:n,colorWrite:z.d,stencilWrite:e.sceneHasOcludees?F.j:null,stencilTest:e.sceneHasOcludees?t?F.f:F.e:null})};return 0===e.output?(this._occludeePipelineState=r(!0,e.transparent||e.stippleEnabled?t:null,z.e),r(!1,e.transparent||e.stippleEnabled?t:null,z.e)):r(!1)}},{key:"primitiveType",get:function(){return 1}},{key:"getPipelineState",value:function(e){return e?this._occludeePipelineState:this.pipeline}}]),r}(E.a);V.shader=new A.a(L.a,(function(){return r.e(203).then(r.bind(null,1066))}));var N=function(e){Object(o.a)(r,e);var t=Object(s.a)(r);function r(){var e;return Object(i.a)(this,r),(e=t.apply(this,arguments)).output=0,e.slicePlaneEnabled=!1,e.vertexColors=!1,e.transparent=!1,e.stippleEnabled=!1,e.stippleOffColorEnabled=!1,e.stippleIntegerRepeatsEnabled=!1,e.sceneHasOcludees=!1,e}return r}(R.a);Object(T.a)([Object(R.b)({count:8})],N.prototype,"output",void 0),Object(T.a)([Object(R.b)()],N.prototype,"slicePlaneEnabled",void 0),Object(T.a)([Object(R.b)()],N.prototype,"vertexColors",void 0),Object(T.a)([Object(R.b)()],N.prototype,"transparent",void 0),Object(T.a)([Object(R.b)()],N.prototype,"stippleEnabled",void 0),Object(T.a)([Object(R.b)()],N.prototype,"stippleOffColorEnabled",void 0),Object(T.a)([Object(R.b)()],N.prototype,"stippleIntegerRepeatsEnabled",void 0),Object(T.a)([Object(R.b)()],N.prototype,"sceneHasOcludees",void 0);var U=c.a.getLogger("esri.views.3d.webgl-engine.materials.NativeLineMaterial"),B=function(e){Object(o.a)(r,e);var t=Object(s.a)(r);function r(e){var n;return Object(i.a)(this,r),(n=t.call(this,e,H)).techniqueConfig=new N,n}return Object(a.a)(r,[{key:"getTechniqueConfig",value:function(e){this.techniqueConfig.output=e,this.techniqueConfig.slicePlaneEnabled=this.params.slicePlaneEnabled,this.techniqueConfig.vertexColors=this.params.vertexColors,this.techniqueConfig.transparent=this.params.color[3]<1||this.params.width<1;var t=Object(l.j)(this.params.stipplePattern);return this.techniqueConfig.stippleEnabled=t,this.techniqueConfig.stippleOffColorEnabled=t&&Object(l.j)(this.params.stippleOffColor),this.techniqueConfig.stippleIntegerRepeatsEnabled=t&&this.params.stippleIntegerRepeats,this.techniqueConfig.sceneHasOcludees=this.params.sceneHasOcludees,this.techniqueConfig}},{key:"getPassParameters",value:function(){return this.params}},{key:"intersect",value:function(e,t,r,n,i,a,o,s,c){c?Object(w.h)(e,n,a,1,o):this.intersectLineGeometry(e,t,r,n,o)}},{key:"intersectLineGeometry",value:function(e,t,r,n,i){if(n.options.selectionMode&&!Object(x.e)(t))if(Object(O.g)(r)){var a=e.vertexAttributes.get("position").data,o=n.camera,s=re;Object(d.c)(s,n.point);Object(h.y)(ne[0],s[0]-2,s[1]+2,0),Object(h.y)(ne[1],s[0]+2,s[1]+2,0),Object(h.y)(ne[2],s[0]+2,s[1]-2,0),Object(h.y)(ne[3],s[0]-2,s[1]-2,0);for(var c=0;c<4;c++)if(!o.unprojectFromRenderScreen(ne[c],ie[c]))return;Object(b.g)(o.eye,ie[0],ie[1],ae),Object(b.g)(o.eye,ie[1],ie[2],oe),Object(b.g)(o.eye,ie[2],ie[3],se),Object(b.g)(o.eye,ie[3],ie[0],ce);for(var l=Number.MAX_VALUE,u=0;u<a.length-5;u+=3)if(W[0]=a[u]+r[12],W[1]=a[u+1]+r[13],W[2]=a[u+2]+r[14],Q[0]=a[u+3]+r[12],Q[1]=a[u+4]+r[13],Q[2]=a[u+5]+r[14],!(Object(b.w)(ae,W)<0&&Object(b.w)(ae,Q)<0||Object(b.w)(oe,W)<0&&Object(b.w)(oe,Q)<0||Object(b.w)(se,W)<0&&Object(b.w)(se,Q)<0||Object(b.w)(ce,W)<0&&Object(b.w)(ce,Q)<0)){if(o.projectToRenderScreen(W,Y),o.projectToRenderScreen(Q,$),Y[2]<0&&$[2]>0){Object(h.l)(Z,W,Q);var f=o.frustum,v=-Object(b.w)(f[4],W)/Object(h.j)(Z,Object(b.s)(f[4]));Object(h.g)(Z,Z,v),Object(h.h)(W,W,Z),o.projectToRenderScreen(W,Y)}else if(Y[2]>0&&$[2]<0){Object(h.l)(Z,Q,W);var m=o.frustum,y=-Object(b.w)(m[4],Q)/Object(h.j)(Z,Object(b.s)(m[4]));Object(h.g)(Z,Z,y),Object(h.h)(Q,Q,Z),o.projectToRenderScreen(Q,$)}else if(Y[2]<0&&$[2]<0)continue;Y[2]=0,$[2]=0;var g=Object(p.d)(Object(p.e)(Y,$,ee),s);g<l&&(l=g,Object(h.m)(J,W),Object(h.m)(K,Q))}var j=n.rayBeginPoint,_=n.rayEndPoint;if(l<4){var w=Number.MAX_VALUE;if(Object(p.a)(Object(p.e)(J,K,ee),Object(p.e)(j,_,te),X)){Object(h.l)(X,X,j);var k=Object(h.r)(X);Object(h.g)(X,X,1/k),w=k/Object(h.o)(j,_)}i(w,X)}}else U.error("intersection assumes a translation-only matrix")}},{key:"computeAttachmentOrigin",value:function(e,t){var r=e.vertexAttributes;if(!r)return!1;var n=r.get("position");return Object(m.a)(n,null,!1,t)}},{key:"createBufferWriter",value:function(){var e=this.params.vertexColors?_.b:_.c;return Object(l.i)(this.params.stipplePattern)?new _.a(e):new q(e.clone().vec3f("auxpos1"))}},{key:"getGLMaterial",value:function(e){return 0===e.output||4===e.output?new G(e):void 0}}]),r}(g.a),G=function(e){Object(o.a)(r,e);var t=Object(s.a)(r);function r(e){var n;return Object(i.a)(this,r),(n=t.call(this,e)).updateParameters(),n}return Object(a.a)(r,[{key:"updateParameters",value:function(){this._technique=this._techniqueRep.releaseAndAcquire(V,this._material.getTechniqueConfig(this._output),this._technique)}},{key:"beginSlot",value:function(e){return 3===e}},{key:"_updateOccludeeState",value:function(e){e.hasOccludees!==this._material.params.sceneHasOcludees&&(this._material.setParameterValues({sceneHasOcludees:e.hasOccludees}),this.updateParameters())}},{key:"ensureParameters",value:function(e){0===this._output&&this._updateOccludeeState(e)}},{key:"bind",value:function(e){this._technique.bindPass(this._material.getPassParameters(),e)}},{key:"getPipelineState",value:function(e,t){return this._technique.getPipelineState(t)}}]),r}(y.a),q=function(){function e(t){Object(i.a)(this,e),this.vertexBufferLayout=t}return Object(a.a)(e,[{key:"allocate",value:function(e){return this.vertexBufferLayout.createBuffer(e)}},{key:"elementCount",value:function(e){return e.indices.get("position").length}},{key:"write",value:function(e,t,r,n){Object(j.c)(t,this.vertexBufferLayout,e.transformation,e.invTranspTransformation,r,n),this.writeAuxpos1(e,t,r,n)}},{key:"writeAuxpos1",value:function(e,t,r,n){var i=r.getField("auxpos1",v.u),a=t.indices.get("position"),o=t.vertexAttributes.get("position").data,s=e.transformation,c=i.typedBufferStride,l=i.typedBuffer;n*=c;for(var u=0;u<a.length;u+=2)for(var d=3*a[u],h=o[d],f=o[d+1],p=o[d+2],b=s[0]*h+s[4]*f+s[8]*p+s[12],m=s[1]*h+s[5]*f+s[9]*p+s[13],y=s[2]*h+s[6]*f+s[10]*p+s[14],g=0;g<2;++g)l[n]=b,l[n+1]=m,l[n+2]=y,n+=c}}]),e}(),H=Object(n.a)({color:[1,1,1,1],vertexColors:!1,slicePlaneEnabled:!1,width:1,stipplePattern:null,stippleIntegerRepeats:!1,stippleOffColor:null,sceneHasOcludees:!1},g.b),W=Object(f.e)(),Q=Object(f.e)(),Z=Object(f.e)(),X=Object(f.e)(),Y=Object(u.d)(),$=Object(u.d)(),J=Object(f.e)(),K=Object(f.e)(),ee=Object(p.c)(),te=Object(p.c)(),re=Object(f.e)(),ne=[Object(u.d)(),Object(u.d)(),Object(u.d)(),Object(u.d)()],ie=[Object(f.e)(),Object(f.e)(),Object(f.e)(),Object(f.e)()],ae=Object(b.d)(),oe=Object(b.d)(),se=Object(b.d)(),ce=Object(b.d)()},function(e,t,r){"use strict";r.d(t,"a",(function(){return a})),r.d(t,"b",(function(){return c}));var n=r(113),i=r(504);function a(e,t){var r;if(t.write&&!t.write.writer&&(!1!==t.write.enabled||t.write.overridePolicy)){var a,s=null!=(r=null==e?void 0:e.ndimArray)?r:0;e&&(1===s||"type"in e&&Object(i.a)(e.type))?t.write.writer=l:t.write.writer=s>1?(a=s,function(e,t,r,i){var o;if(null===e)o=null;else{o=u(e,i,a);for(var s=a,c=o;s>0&&Array.isArray(c);)s--,c=c[0];if(void 0!==c)for(var l=0;l<s;l++)o=[o]}Object(n.c)(r,o,t)}):o}}function o(e,t,r,i){Object(n.c)(r,s(e,i),t)}function s(e,t){return e&&"function"==typeof e.write?e.write({},t):e&&"function"==typeof e.toJSON?e.toJSON():"number"==typeof e?c(e):e}function c(e){return e===-1/0?-Number.MAX_VALUE:e===1/0?Number.MAX_VALUE:isNaN(e)?null:e}function l(e,t,r,i){var a;null===e?a=null:e&&"function"==typeof e.map?"function"==typeof(a=e.map((function(e){return s(e,i)}))).toArray&&(a=a.toArray()):a=[s(e,i)],Object(n.c)(r,a,t)}function u(e,t,r){return 0!==r&&Array.isArray(e)?e.map((function(e){return u(e,t,r-1)})):s(e,t)}},function(e,t,r){"use strict";var n,i=r(2),a=r(5),o=r(6),s=r(7),c=r(0),l=r(30),u=r(1),d=(r(17),r(18),r(15),r(10)),h=r(149),f=n=function(e){Object(o.a)(r,e);var t=Object(s.a)(r);function r(){var e;return Object(i.a)(this,r),(e=t.apply(this,arguments)).portal=null,e}return Object(a.a)(r,[{key:"clone",value:function(){return new n({name:this.name,styleUrl:this.styleUrl,styleName:this.styleName,portal:this.portal})}}]),r}(l.a);Object(c.a)([Object(u.b)({type:String})],f.prototype,"name",void 0),Object(c.a)([Object(u.b)({type:String})],f.prototype,"styleUrl",void 0),Object(c.a)([Object(u.b)({type:String})],f.prototype,"styleName",void 0),Object(c.a)([Object(u.b)({type:h.a})],f.prototype,"portal",void 0);var p=f=n=Object(c.a)([Object(d.a)("esri.symbols.support.StyleOrigin")],f);t.a=p},function(e,t,r){"use strict";var n,i=r(2),a=r(5),o=r(6),s=r(7),c=r(0),l=r(27),u=r(340),d=r(1),h=(r(17),r(18),r(15),r(10)),f=r(297),p=n=function(e){Object(o.a)(r,e);var t=Object(s.a)(r);function r(e){var n;return Object(i.a)(this,r),(n=t.call(this,e)).value=0,n.unit="milliseconds",n}return Object(a.a)(r,[{key:"toMilliseconds",value:function(){return Object(u.a)(this.value,this.unit,"milliseconds")}},{key:"clone",value:function(){return new n({value:this.value,unit:this.unit})}}]),r}(l.a);Object(c.a)([Object(d.b)({type:Number,json:{write:!0},nonNullable:!0})],p.prototype,"value",void 0),Object(c.a)([Object(d.b)({type:f.a.apiValues,json:{type:f.a.jsonValues,read:f.a.read,write:f.a.write},nonNullable:!0})],p.prototype,"unit",void 0);var b=p=n=Object(c.a)([Object(h.a)("esri.TimeInterval")],p);t.a=b},function(e,t,r){"use strict";var n=r(2),i=r(5),a=r(122),o=function(){function e(t,r){Object(n.a)(this,e),this._context=t,this._desc=r,this._context.instanceCounter.increment(a.b.Renderbuffer,this);var i=this._context.gl;this.glName=i.createRenderbuffer(),this._context.bindRenderbuffer(this),i.renderbufferStorage(i.RENDERBUFFER,r.internalFormat,r.width,r.height)}return Object(i.a)(e,[{key:"descriptor",get:function(){return this._desc}},{key:"resize",value:function(e,t){var r=this._desc;if(r.width!==e||r.height!==t){r.width=e,r.height=t;var n=this._context.gl;this._context.bindRenderbuffer(this),n.renderbufferStorage(n.RENDERBUFFER,r.internalFormat,r.width,r.height)}}},{key:"dispose",value:function(){this._context&&(this._context.gl.deleteRenderbuffer(this.glName),this._context.instanceCounter.decrement(a.b.Renderbuffer,this),this._context=null)}}]),e}();t.a=o},function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));var n=2.1},function(e,t,r){"use strict";var n=r(8),i=r.n(n),a=r(16),o=r(2),s=r(5),c=r(6),l=r(7),u=r(0),d=r(123),h=(r(126),r(99)),f=r(22),p=r(82),b=r(370),v=r(180),m=r(15),y=r(23),g=r(39),O=r(1),j=(r(17),r(18),r(10)),_=r(66),w=r(55),x=0,k=m.a.getLogger("esri.layers.Layer"),S=function(e){Object(c.a)(n,e);var t=Object(l.a)(n);function n(){var e;return Object(o.a)(this,n),(e=t.apply(this,arguments)).attributionDataUrl=null,e.fullExtent=new _.a(-180,-90,180,90,w.a.WGS84),e.id=Date.now().toString(16)+"-layer-"+x++,e.legendEnabled=!0,e.listMode="show",e.opacity=1,e.parent=null,e.popupEnabled=!0,e.attributionVisible=!0,e.spatialReference=w.a.WGS84,e.title=null,e.type=null,e.url=null,e.visible=!0,e}return Object(s.a)(n,[{key:"initialize",value:function(){var e=this;this.when().catch((function(t){var r,n;Object(y.n)(t)||m.a.getLogger(e.declaredClass).error("#load()","Failed to load layer (title: '".concat(null!=(r=e.title)?r:"no title","', id: '").concat(null!=(n=e.id)?n:"no id","')"),{error:t})}))}},{key:"destroy",value:function(){if(this.parent){var e=this,t=this.parent;"layers"in t&&t.layers.includes(e)?t.layers.remove(e):"tables"in t&&t.tables.includes(e)?t.tables.remove(e):"baseLayers"in t&&t.baseLayers.includes(e)?t.baseLayers.remove(e):"baseLayers"in t&&t.referenceLayers.includes(e)&&t.referenceLayers.remove(e)}}},{key:"hasAttributionData",get:function(){return null!=this.attributionDataUrl}},{key:"parsedUrl",get:function(){var e=this.url;return e?Object(g.K)(e):null}},{key:"fetchAttributionData",value:function(){var e=Object(a.a)(i.a.mark((function e(){var t;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.attributionDataUrl,!this.hasAttributionData||!t){e.next=5;break}return e.next=4,Object(h.default)(t,{query:{f:"json"},responseType:"json"});case 4:return e.abrupt("return",e.sent.data);case 5:throw new f.a("layer:no-attribution-data","Layer does not have attribution data");case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}],[{key:"fromArcGISServerUrl",value:function(){var e=Object(a.a)(i.a.mark((function e(t){var n,a;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n="string"==typeof t?{url:t}:t,e.next=3,r.e(139).then(r.bind(null,704));case 3:return a=e.sent,e.prev=4,e.next=7,a.fromUrl(n);case 7:return e.abrupt("return",e.sent);case 10:throw e.prev=10,e.t0=e.catch(4),k.error("#fromArcGISServerUrl({ url: '"+n.url+"'})","Failed to create layer from arcgis server url",e.t0),e.t0;case 13:case"end":return e.stop()}}),e,null,[[4,10]])})));return function(t){return e.apply(this,arguments)}}()},{key:"fromPortalItem",value:function(){var e=Object(a.a)(i.a.mark((function e(t){var n,a,o,s,c;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n="portalItem"in t?t:{portalItem:t},e.next=3,Promise.all([r.e(10),r.e(140)]).then(r.bind(null,701));case 3:return a=e.sent,e.prev=4,e.next=7,a.fromItem(n);case 7:return e.abrupt("return",e.sent);case 10:throw e.prev=10,e.t0=e.catch(4),o=n&&n.portalItem,s=o&&o.id||"unset",c=o&&o.portal&&o.portal.url||d.a.portalUrl,k.error("#fromPortalItem()","Failed to create layer from portal item (portal: '"+c+"', id: '"+s+"')",e.t0),e.t0;case 14:case"end":return e.stop()}}),e,null,[[4,10]])})));return function(t){return e.apply(this,arguments)}}()}]),n}(p.a.EventedMixin(Object(b.a)(v.a)));Object(u.a)([Object(O.b)({type:String})],S.prototype,"attributionDataUrl",void 0),Object(u.a)([Object(O.b)({type:_.a})],S.prototype,"fullExtent",void 0),Object(u.a)([Object(O.b)({readOnly:!0})],S.prototype,"hasAttributionData",null),Object(u.a)([Object(O.b)({type:String})],S.prototype,"id",void 0),Object(u.a)([Object(O.b)({type:Boolean,nonNullable:!0})],S.prototype,"legendEnabled",void 0),Object(u.a)([Object(O.b)({type:["show","hide","hide-children"]})],S.prototype,"listMode",void 0),Object(u.a)([Object(O.b)({type:Number,range:{min:0,max:1},nonNullable:!0})],S.prototype,"opacity",void 0),Object(u.a)([Object(O.b)()],S.prototype,"parent",void 0),Object(u.a)([Object(O.b)({readOnly:!0})],S.prototype,"parsedUrl",null),Object(u.a)([Object(O.b)({type:Boolean})],S.prototype,"popupEnabled",void 0),Object(u.a)([Object(O.b)({type:Boolean})],S.prototype,"attributionVisible",void 0),Object(u.a)([Object(O.b)({type:w.a})],S.prototype,"spatialReference",void 0),Object(u.a)([Object(O.b)({type:String})],S.prototype,"title",void 0),Object(u.a)([Object(O.b)({type:String,readOnly:!0,json:{read:!1}})],S.prototype,"type",void 0),Object(u.a)([Object(O.b)()],S.prototype,"url",void 0),Object(u.a)([Object(O.b)({type:Boolean,nonNullable:!0})],S.prototype,"visible",void 0);var T=S=Object(u.a)([Object(j.a)("esri.layers.Layer")],S);t.a=T},function(e,t,r){"use strict";r.d(t,"a",(function(){return ge})),r.d(t,"b",(function(){return we})),r.d(t,"c",(function(){return Oe}));var n,i,a=r(14),o=r(8),s=r.n(o),c=r(16),l=r(22),u=r(17),d=r(23),h=r(13),f=r(2),p=r(5),b=r(191),v=r(15),m=r(129),y=r(168),g=r(3),O={statsWorker:function(){return r.e(142).then(r.bind(null,989))},geometryEngineWorker:function(){return Promise.all([r.e(4),r.e(78)]).then(r.bind(null,990))},CSVSourceWorker:function(){return Promise.all([r.e(1),r.e(2),r.e(62)]).then(r.bind(null,1192))},EdgeProcessingWorker:function(){return Promise.resolve().then(r.bind(null,681))},ElevationSamplerWorker:function(){return r.e(61).then(r.bind(null,991))},FeatureServiceSnappingSourceWorker:function(){return Promise.all([r.e(1),r.e(2),r.e(68)]).then(r.bind(null,1178))},GeoJSONSourceWorker:function(){return Promise.all([r.e(1),r.e(2),r.e(55)]).then(r.bind(null,992))},LercWorker:function(){return r.e(89).then(r.bind(null,993))},MemorySourceWorker:function(){return Promise.all([r.e(1),r.e(2),r.e(54)]).then(r.bind(null,994))},PBFDecoderWorker:function(){return r.e(185).then(r.bind(null,1193))},Pipeline:function(){return Promise.all([r.e(1),r.e(2),r.e(29),r.e(48)]).then(r.bind(null,1166))},PointCloudWorker:function(){return Promise.all([r.e(28),r.e(87)]).then(r.bind(null,995))},RasterWorker:function(){return Promise.all([r.e(13),r.e(167)]).then(r.bind(null,996))},SceneLayerWorker:function(){return r.e(182).then(r.bind(null,790))},WFSSourceWorker:function(){return Promise.all([r.e(1),r.e(2),r.e(31),r.e(66)]).then(r.bind(null,997))},WorkerTileHandler:function(){return Promise.all([r.e(15),r.e(25),r.e(176)]).then(r.bind(null,1169))}};(i=n||(n={}))[i.HANDSHAKE=0]="HANDSHAKE",i[i.OPEN=1]="OPEN",i[i.OPENED=2]="OPENED",i[i.RESPONSE=3]="RESPONSE",i[i.INVOKE=4]="INVOKE",i[i.ABORT=5]="ABORT",i[i.CLOSE=6]="CLOSE",i[i.OPEN_PORT=7]="OPEN_PORT",i[i.ON=8]="ON";var j=0;function _(){return j++}function w(e){return e?"string"==typeof e?JSON.stringify({name:"message",message:e}):e.toJSON?JSON.stringify(e):JSON.stringify({name:e.name,message:e.message,details:e.details||{stack:e.stack}}):null}function x(e,t,r,i){var a;t.type!==n.OPEN_PORT?t.type===n.INVOKE||t.type===n.RESPONSE?(!function(e){return e&&"object"==typeof e&&("result"in e||"transferList"in e)}(r)?(a=S(i),t.data=r):(a=S(r.transferList),t.data=r.result),a?e.postMessage(t,a):e.postMessage(t)):e.postMessage(t):e.postMessage(t,[t.port])}function k(e){if(!e)return null;var t=e.data;return t?"string"==typeof t?JSON.parse(t):t:null}function S(e){if(!e||!e.length)return null;if(Object(u.a)("esri-workers-arraybuffer-transfer"))return e;var t=e.filter((function(e){return!function(e){return e instanceof ArrayBuffer||e&&e.constructor&&"ArrayBuffer"===e.constructor.name}(e)}));return t.length?t:null}var T=r(301),C=n.CLOSE,M=n.ABORT,P=n.INVOKE,A=n.RESPONSE,E=n.OPEN_PORT,R=n.ON,I=function(){function e(t){Object(f.a)(this,e),this._timer=null,this._cancelledJobIds=new Set,this._invokeMessages=[],this._invoke=t,this._timer=null,this._process=this._process.bind(this)}return Object(p.a)(e,[{key:"push",value:function(e){e.type===n.ABORT?this._cancelledJobIds.add(e.jobId):(this._invokeMessages.push(e),null===this._timer&&(this._timer=setTimeout(this._process,0)))}},{key:"clear",value:function(){this._invokeMessages.length=0,this._cancelledJobIds.clear(),this._timer=null}},{key:"_process",value:function(){this._timer=null;var e,t=Object(h.a)(this._invokeMessages);try{for(t.s();!(e=t.n()).done;){var r=e.value;this._cancelledJobIds.has(r.jobId)||this._invoke(r)}}catch(n){t.e(n)}finally{t.f()}this._cancelledJobIds.clear(),this._invokeMessages.length=0}}]),e}(),D=function(){function e(t,r){var n=this;Object(f.a)(this,e),this._port=t,this._outJobs=new Map,this._inJobs=new Map,this._invokeQueue=new I((function(e){return n._onInvokeMessage(e)})),this._client=r.client,this._onMessage=this._onMessage.bind(this),this._channel=r.channel,this._schedule=r.schedule,this._port.addEventListener("message",this._onMessage),this._port.start()}return Object(p.a)(e,[{key:"close",value:function(){this._post({type:C}),this._close()}},{key:"isBusy",value:function(){return this._outJobs.size>0}},{key:"invoke",value:function(e,t,r){var n=this,i=r&&r.signal,a=r&&r.transferList;if(!this._port)return Promise.reject(new l.a("worker:port-closed","Cannot call invoke('".concat(e,"'), port is closed"),{methodName:e,data:t}));var o=_();return new Promise((function(r,s){var c=Object(d.t)(i,(function(){var e,t=n._outJobs.get(o);t&&(n._outJobs.delete(o),null==(e=t.abortHandle)||e.remove(),n._post({type:M,jobId:o}),s(Object(d.f)()))})),l={resolve:r,reject:s,abortHandle:c,debugInfo:e};n._outJobs.set(o,l),n._post({type:P,jobId:o,methodName:e,abortable:null!=i},t,a)}))}},{key:"on",value:function(e,t){var r=new MessageChannel;function i(e){t(e.data)}return this._port.postMessage({type:n.ON,eventType:e,port:r.port2},[r.port2]),r.port1.addEventListener("message",i),r.port1.start(),{remove:function(){r.port1.postMessage({type:n.CLOSE}),r.port1.close(),r.port1.removeEventListener("message",i)}}}},{key:"openPort",value:function(){var e=new MessageChannel;return this._post({type:E,port:e.port2}),e.port1}},{key:"_close",value:function(){this._channel&&(this._channel=null),this._port.removeEventListener("message",this._onMessage),this._port.close(),this._outJobs.forEach((function(e){var t;null==(t=e.abortHandle)||t.remove(),e.reject(Object(d.f)("Worker closing, aborting job calling '".concat(e.debugInfo,"'")))})),this._inJobs.clear(),this._outJobs.clear(),this._invokeQueue.clear(),this._port=this._client=this._schedule=null}},{key:"_onMessage",value:function(e){var t=this;Object(g.j)(this._schedule)?this._schedule((function(){return t._processMessage(e)})):this._processMessage(e)}},{key:"_processMessage",value:function(e){var t=k(e);if(t)switch(t.type){case A:this._onResponseMessage(t);break;case P:this._invokeQueue.push(t);break;case M:this._onAbortMessage(t);break;case C:this._onCloseMessage();break;case E:this._onOpenPortMessage(t);break;case R:this._onOnMessage(t)}}},{key:"_onAbortMessage",value:function(e){var t=this._inJobs,r=e.jobId,n=t.get(r);this._invokeQueue.push(e),n&&(n.controller&&n.controller.abort(),t.delete(r))}},{key:"_onCloseMessage",value:function(){var t=this._client;this._close(),t&&"destroy"in t&&e.clients.get(this)===t&&t.destroy(),e.clients.delete(this),t&&t.remoteClient&&(t.remoteClient=null)}},{key:"_onInvokeMessage",value:function(e){var t,r=this,n=e.methodName,i=e.jobId,a=e.data,o=e.abortable?Object(d.e)():null,s=this._inJobs,c=this._client,l=c[n];try{if(!l&&n&&-1!==n.indexOf("."))for(var u=n.split("."),h=0;h<u.length-1;h++)l=(c=c[u[h]])[u[h+1]];if("function"!=typeof l)throw new TypeError("".concat(n," is not a function"));t=l.call(c,a,{client:this,signal:o?o.signal:null})}catch(f){return void this._post({type:A,jobId:i,error:w(f)})}Object(d.q)(t)?(s.set(i,{controller:o,promise:t}),t.then((function(e){s.has(i)&&(s.delete(i),r._post({type:A,jobId:i},e))}),(function(e){s.has(i)&&(s.delete(i),Object(d.n)(e)||r._post({type:A,jobId:i,error:w(e||{message:"Error encountered at method ".concat(n)})}))}))):this._post({type:A,jobId:i},t)}},{key:"_onOpenPortMessage",value:function(t){new e(t.port,{client:this._client})}},{key:"_onOnMessage",value:function(e){var t=e.port,r=this._client.on(e.eventType,(function(e){t.postMessage(e)})),i=Object(y.c)(e.port,"message",(function(e){k(e).type===n.CLOSE&&(i.remove(),r.remove(),t.close())}))}},{key:"_onResponseMessage",value:function(e){var t,r=e.jobId,n=e.error,i=e.data,a=this._outJobs;if(a.has(r)){var o=a.get(r);a.delete(r),null==(t=o.abortHandle)||t.remove(),n?o.reject(l.a.fromJSON(JSON.parse(n))):o.resolve(i)}}},{key:"_post",value:function(e,t,r){return x(this._port,e,t,r)}}],[{key:"connect",value:function(t){var r,n=new MessageChannel;r="function"==typeof t?new t:"default"in t&&"function"==typeof t.default?new t.default:t;var i=new e(n.port1,{channel:n,client:r});return"object"==typeof r&&"remoteClient"in r&&(r.remoteClient=i),e.clients.set(i,r),n.port2}},{key:"loadWorker",value:function(e){var t=O[e];return t?t():Promise.resolve(null)}}]),e}();D.kernelInfo={revision:T.b,version:m.d,buildDate:T.a},D.clients=new Map;var F=D,L=v.a.getLogger("esri.core.workers.Connection"),z=function(){function e(){Object(f.a)(this,e),this._clients=new Array,this._clientPromises=new Array,this._clientIdx=0}return Object(p.a)(e,[{key:"destroy",value:function(){this.close()}},{key:"closed",get:function(){return!this._clients||!this._clients.length}},{key:"open",value:function(e,t){var r=this;return new Promise((function(n,i){var a=!0,o=function(e){Object(d.x)(t.signal),a&&(a=!1,e())};r._clients.length=e.length,r._clientPromises.length=e.length;for(var s=function(a){var s=e[a];Object(d.q)(s)?r._clientPromises[a]=s.then((function(e){return r._clients[a]=new F(e,t),o(n),r._clients[a]}),(function(){return o(i),null})):(r._clients[a]=new F(s,t),r._clientPromises[a]=Promise.resolve(r._clients[a]),o(n))},c=0;c<e.length;++c)s(c)}))}},{key:"broadcast",value:function(e,t,r){for(var n=new Array(this._clientPromises.length),i=0;i<this._clientPromises.length;++i){var a=this._clientPromises[i];n[i]=a.then((function(n){return n.invoke(e,t,r)}))}return n}},{key:"close",value:function(){var e,t=Object(h.a)(this._clientPromises);try{for(t.s();!(e=t.n()).done;){e.value.then((function(e){return e.close()}))}}catch(r){t.e(r)}finally{t.f()}this._clients.length=0,this._clientPromises.length=0}},{key:"getAvailableClient",value:function(){for(var e,t=0;t<this._clients.length;++t){var r=this._clients[t];if(r){if(!r.isBusy())return Promise.resolve(r)}else(e=e||[]).push(this._clientPromises[t])}return e?Promise.race(e):(this._clientIdx=(this._clientIdx+1)%this._clients.length,Promise.resolve(this._clients[this._clientIdx]))}},{key:"invoke",value:function(e,t,r){var n=null;return Array.isArray(r)?(L.warn("invoke()","The transferList parameter is deprecated, use the options object instead"),n={transferList:r}):n=r,this.closed?Promise.reject(new Error("Connection closed")):this.getAvailableClient().then((function(r){return r.invoke(e,t,n)}))}},{key:"on",value:function(e,t){var r=this;return Promise.all(this._clientPromises).then((function(){return Object(b.a)(r._clients.map((function(r){return r.on(e,t)})))}))}},{key:"openPorts",value:function(){var e=this;return new Promise((function(t){for(var r=new Array(e._clientPromises.length),n=r.length,i=function(i){e._clientPromises[i].then((function(e){r[i]=e.openPort(),0==--n&&t(r)}))},a=0;a<e._clientPromises.length;++a)i(a)}))}},{key:"test",get:function(){return{numClients:this._clients.length}}}]),e}(),V=r(93),N=r(123),U=(r(343),r(39)),B={};var G,q,H=function(e){var t,r={async:e.async,isDebug:e.isDebug,locale:e.locale,baseUrl:e.baseUrl,has:Object(a.a)({},e.has),map:Object(a.a)({},e.map),packages:e.packages&&e.packages.concat()||[],paths:Object(a.a)({},e.paths)};return e.hasOwnProperty("async")||(r.async=!0),e.hasOwnProperty("isDebug")||(r.isDebug=!1),e.baseUrl||(r.baseUrl=B.baseUrl),null==(t=B.packages)||t.forEach((function(e){!function(e,t){var r,n=Object(h.a)(e);try{for(n.s();!(r=n.n()).done;)if(r.value.name===t.name)return}catch(i){n.e(i)}finally{n.f()}e.push(t)}(r.packages,e)})),r},W=r(71),Q=function e(){var t=this;Object(f.a)(this,e);var r=document.createDocumentFragment();["addEventListener","dispatchEvent","removeEventListener"].forEach((function(e){t[e]=function(){return r[e].apply(r,arguments)}}))},Z=W.a.MutationObserver||W.a.WebKitMutationObserver,X=function(){var e;if(W.a.process&&W.a.process.nextTick)e=function(e){W.a.process.nextTick(e)};else if(W.a.Promise)e=function(e){W.a.Promise.resolve().then(e)};else if(Z){var t=[],r=document.createElement("div");new Z((function(){for(;t.length>0;)t.shift()()})).observe(r,{attributes:!0}),e=function(e){t.push(e),r.setAttribute("queueStatus","1")}}return e}(),Y=function(){var e=W.a.MessageEvent;try{new e("message",{data:null})}catch(t){return function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.data,n=t.bubbles,i=void 0!==n&&n,a=t.cancelable,o=void 0!==a&&a,s=document.createEvent("Event");return s.initEvent(e,i,o),s.data=r,s}}return function(t,r){return new e(t,r)}}(),$=function(){function e(){Object(f.a)(this,e),this._dispatcher=new Q,this._workerPostMessage({type:n.HANDSHAKE})}return Object(p.a)(e,[{key:"terminate",value:function(){}},{key:"onmessage",get:function(){return this._onmessageHandler},set:function(e){this._onmessageHandler&&this.removeEventListener("message",this._onmessageHandler),this._onmessageHandler=e,e&&this.addEventListener("message",e)}},{key:"onmessageerror",get:function(){return this._onmessageerrorHandler},set:function(e){this._onmessageerrorHandler&&this.removeEventListener("messageerror",this._onmessageerrorHandler),this._onmessageerrorHandler=e,e&&this.addEventListener("messageerror",e)}},{key:"onerror",get:function(){return this._onerrorHandler},set:function(e){this._onerrorHandler&&this.removeEventListener("error",this._onerrorHandler),this._onerrorHandler=e,e&&this.addEventListener("error",e)}},{key:"postMessage",value:function(e){var t=this;X((function(){t._workerMessageHandler(Y("message",{data:e}))}))}},{key:"dispatchEvent",value:function(e){return this._dispatcher.dispatchEvent(e)}},{key:"addEventListener",value:function(e,t,r){this._dispatcher.addEventListener(e,t,r)}},{key:"removeEventListener",value:function(e,t,r){this._dispatcher.removeEventListener(e,t,r)}},{key:"_workerPostMessage",value:function(e){var t=this;X((function(){t.dispatchEvent(Y("message",{data:e}))}))}},{key:"_workerMessageHandler",value:function(){var e=Object(c.a)(s.a.mark((function e(t){var r,i,a,o,c;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(r=k(t))||r.type!==n.OPEN){e.next=13;break}return i=r.modulePath,a=r.jobId,e.next=5,F.loadWorker(i);case 5:if(o=e.sent,e.t0=o,e.t0){e.next=11;break}return e.next=10,import(i);case 10:o=e.sent;case 11:c=F.connect(o),this._workerPostMessage({type:n.OPENED,jobId:a,data:c});case 13:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),e}(),J=r(138),K=v.a.getLogger("esri.core.workers"),ee=n.HANDSHAKE,te='let globalId=0;const outgoing=new Map,configuration=JSON.parse("{CONFIGURATION}");self.esriConfig=configuration.esriConfig;const workerPath=self.esriConfig.workers.workerPath,HANDSHAKE=0,OPEN=1,OPENED=2,RESPONSE=3,INVOKE=4,ABORT=5;function createAbortError(){const e=new Error("Aborted");return e.name="AbortError",e}function receiveMessage(e){return e&&e.data?"string"==typeof e.data?JSON.parse(e.data):e.data:null}function invokeStaticMessage(e,o,r){const t=r&&r.signal,n=globalId++;return new Promise(((r,i)=>{if(t){if(t.aborted)return i(createAbortError());t.addEventListener("abort",(()=>{outgoing.get(n)&&(outgoing.delete(n),self.postMessage({type:5,jobId:n}),i(createAbortError()))}))}outgoing.set(n,{resolve:r,reject:i}),self.postMessage({type:4,jobId:n,methodName:e,abortable:null!=t,data:o})}))}let workerRevisionChecked=!1;function checkWorkerRevision(e){if(!workerRevisionChecked&&e.kernelInfo){workerRevisionChecked=!0;const{revision:o,buildDate:r,version:t}=configuration.kernelInfo,{revision:n,buildDate:i,version:s}=e.kernelInfo;o!==n&&console.warn(`[esri.core.workers] Version mismatch detected between ArcGIS API for JavaScript and assets:\nAPI version: ${t} [Date: ${r}, Revision: ${o.slice(0,8)}]\nAssets version: ${s} [Date: ${i}, Revision: ${n.slice(0,8)}]`)}}function messageHandler(e){const o=receiveMessage(e);if(!o)return;const r=o.jobId;switch(o.type){case 1:let e;function t(o){const t=e.connect(o);self.postMessage({type:2,jobId:r,data:t},[t])}"function"==typeof define&&define.amd?require([workerPath],(r=>{e=r.default||r,checkWorkerRevision(e),e.loadWorker(o.modulePath).then((e=>e||new Promise((e=>{require([o.modulePath],e)})))).then(t)})):"System"in self&&"function"==typeof System.import?System.import(workerPath).then((r=>(e=r.default,checkWorkerRevision(e),e.loadWorker(o.modulePath)))).then((e=>e||System.import(o.modulePath))).then(t):(self.RemoteClient||importScripts(workerPath),e=self.RemoteClient.default||self.RemoteClient,checkWorkerRevision(e),e.loadWorker(o.modulePath).then(t));break;case 3:if(outgoing.has(r)){const e=outgoing.get(r);outgoing.delete(r),o.error?e.reject(JSON.parse(o.error)):e.resolve(o.data)}}}self.dojoConfig=configuration.loaderConfig,esriConfig.workers.loaderUrl&&(self.importScripts(esriConfig.workers.loaderUrl),"function"==typeof require&&"function"==typeof require.config&&require.config(configuration.loaderConfig)),self.addEventListener("message",messageHandler),self.postMessage({type:0});',re="Failed to create Worker. Fallback to execute module in main thread";function ne(){return ie.apply(this,arguments)}function ie(){return(ie=Object(c.a)(s.a.mark((function e(){var t,r;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Object(u.a)("esri-workers")){e.next=2;break}return e.abrupt("return",ae(new $));case 2:if(!G&&!q)try{t=te.replace('"{CONFIGURATION}"',"'".concat(se(),"'")),G=URL.createObjectURL(new Blob([t],{type:"text/javascript"}))}catch(n){q=n||{}}if(G)try{r=new Worker(G,{name:"esri-worker-"+ce++})}catch(n){K.warn(re,q),r=new $}else K.warn(re,q),r=new $;return e.abrupt("return",ae(r));case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ae(e){return oe.apply(this,arguments)}function oe(){return(oe=Object(c.a)(s.a.mark((function e(t){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e){function r(i){var a=k(i);a&&a.type===ee&&(t.removeEventListener("message",r),t.removeEventListener("error",n),e(t))}function n(e){e.preventDefault(),t.removeEventListener("message",r),t.removeEventListener("error",n),K.warn("Failed to create Worker. Fallback to execute module in main thread",e),(t=new $).addEventListener("message",r),t.addEventListener("error",n)}t.addEventListener("message",r),t.addEventListener("error",n)})));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function se(){var e;if(null!=N.a.default){var t=Object(a.a)({},N.a);delete t.default,e=JSON.parse(JSON.stringify(t))}else e=JSON.parse(JSON.stringify(N.a));e.assetsPath=Object(U.A)(e.assetsPath),e.request.interceptors=[],e.log.interceptors=[],e.locale=Object(J.b)(),e.has={"csp-restrictions":Object(u.a)("csp-restrictions"),"esri-2d-debug":!1,"esri-2d-update-debug":Object(u.a)("esri-2d-update-debug"),"esri-2d-query-centroid-enabled":Object(u.a)("esri-2d-query-centroid-enabled"),"featurelayer-pbf":Object(u.a)("featurelayer-pbf"),"esri-atomics":Object(u.a)("esri-atomics"),"esri-shared-array-buffer":Object(u.a)("esri-shared-array-buffer"),"esri-tiles-debug":Object(u.a)("esri-tiles-debug"),"esri-workers-arraybuffer-transfer":Object(u.a)("esri-workers-arraybuffer-transfer"),"host-webworker":1},e.workers.loaderUrl&&(e.workers.loaderUrl=Object(U.A)(e.workers.loaderUrl)),e.workers.workerPath?e.workers.workerPath=Object(U.A)(e.workers.workerPath):e.workers.workerPath=Object(U.A)(Object(V.b)("esri/core/workers/RemoteClient.js"));var r=N.a.workers.loaderConfig,n=H({baseUrl:null==r?void 0:r.baseUrl,locale:Object(J.b)(),has:Object(a.a)({"csp-restrictions":Object(u.a)("csp-restrictions"),"dojo-test-sniff":0,"host-webworker":1},null==r?void 0:r.has),map:Object(a.a)({},null==r?void 0:r.map),paths:Object(a.a)({},null==r?void 0:r.paths),packages:(null==r?void 0:r.packages)||[]}),i={version:m.d,buildDate:T.a,revision:T.b};return JSON.stringify({esriConfig:e,loaderConfig:n,kernelInfo:i})}var ce=0,le=v.a.getLogger("esri.core.workers"),ue=n.ABORT,de=n.INVOKE,he=n.OPEN,fe=n.OPENED,pe=n.RESPONSE,be=function(){function e(t,r){Object(f.a)(this,e),this._outJobs=new Map,this._inJobs=new Map,this.worker=t,this.id=r,t.addEventListener("message",this._onMessage.bind(this)),t.addEventListener("error",(function(e){e.preventDefault(),le.error(e)}))}return Object(p.a)(e,[{key:"terminate",value:function(){this.worker.terminate()}},{key:"open",value:function(){var e=Object(c.a)(s.a.mark((function e(t){var r,n,i,a=this,o=arguments;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=o.length>1&&void 0!==o[1]?o[1]:{},n=r.signal,i=_(),e.abrupt("return",new Promise((function(e,r){var o={resolve:e,reject:r,abortHandle:Object(d.t)(n,(function(){a._outJobs.delete(i),a._post({type:ue,jobId:i})}))};a._outJobs.set(i,o),a._post({type:he,jobId:i,modulePath:t})})));case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"_onMessage",value:function(e){var t=k(e);if(t)switch(t.type){case fe:this._onOpenedMessage(t);break;case pe:this._onResponseMessage(t);break;case ue:this._onAbortMessage(t);break;case de:this._onInvokeMessage(t)}}},{key:"_onAbortMessage",value:function(e){var t=this._inJobs,r=e.jobId,n=t.get(r);n&&(n.controller&&n.controller.abort(),t.delete(r))}},{key:"_onInvokeMessage",value:function(e){var t,r=this,n=e.methodName,i=e.jobId,a=e.data,o=e.abortable?Object(d.e)():null,s=this._inJobs,c=m.e[n];try{if("function"!=typeof c)throw new TypeError("".concat(n," is not a function"));t=c.call(null,a,{signal:o?o.signal:null})}catch(l){return void this._post({type:pe,jobId:i,error:w(l)})}Object(d.q)(t)?(s.set(i,{controller:o,promise:t}),t.then((function(e){s.has(i)&&(s.delete(i),r._post({type:pe,jobId:i},e))}),(function(e){s.has(i)&&(s.delete(i),e||(e={message:"Error encountered at method"+n}),Object(d.n)(e)||r._post({type:pe,jobId:i,error:w(e||{message:"Error encountered at method ".concat(n)})}))}))):this._post({type:pe,jobId:i},t)}},{key:"_onOpenedMessage",value:function(e){var t,r=e.jobId,n=e.data,i=this._outJobs.get(r);i&&(this._outJobs.delete(r),null==(t=i.abortHandle)||t.remove(),i.resolve(n))}},{key:"_onResponseMessage",value:function(e){var t,r=e.jobId,n=e.error,i=e.data,a=this._outJobs.get(r);a&&(this._outJobs.delete(r),null==(t=a.abortHandle)||t.remove(),n?a.reject(l.a.fromJSON(JSON.parse(n))):a.resolve(i))}},{key:"_post",value:function(e,t,r){return x(this.worker,e,t,r)}}],[{key:"create",value:function(){var t=Object(c.a)(s.a.mark((function t(r){var n;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,ne();case 2:return n=t.sent,t.abrupt("return",new e(n,r));case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}]),e}(),ve=Object(u.a)("esri-workers-debug")?1:Object(u.a)("host-browser")?navigator.hardwareConcurrency-1:0;ve||(ve=Object(u.a)("safari")&&Object(u.a)("mac")||Object(u.a)("trident")?7:2);var me=0,ye=[];function ge(){Se()}function Oe(e,t){return je(e,{client:t})}function je(e,t){return _e.apply(this,arguments)}function _e(){return(_e=Object(c.a)(s.a.mark((function e(t,r){var n;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=new z,e.next=3,n.open(t,r);case 3:return e.abrupt("return",n);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function we(e){return xe.apply(this,arguments)}function xe(){return(xe=Object(c.a)(s.a.mark((function e(t){var r,n,i,o,c,h,f,p,b,v=arguments;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=v.length>1&&void 0!==v[1]?v[1]:{},"string"==typeof t){e.next=3;break}throw new l.a("workers:undefined-module","modulePath is missing");case 3:if(n=r.strategy||"distributed",Object(u.a)("host-webworker")&&!Object(u.a)("esri-workers")&&(n="local"),"local"!==n){e.next=16;break}return e.next=7,F.loadWorker(t);case 7:if(i=e.sent,e.t0=i,e.t0){e.next=13;break}return e.next=12,import(t);case 12:i=e.sent;case 13:return Object(d.x)(r.signal),o=r.client||i,e.abrupt("return",je([F.connect(i)],Object(a.a)(Object(a.a)({},r),{},{client:o})));case 16:return e.next=18,Se();case 18:if(Object(d.x)(r.signal),"dedicated"!==n){e.next=28;break}return c=me++%ve,e.t1=je,e.next=24,ye[c].open(t,r);case 24:return e.t2=e.sent,e.t3=[e.t2],e.t4=r,e.abrupt("return",(0,e.t1)(e.t3,e.t4));case 28:if(!(r.maxNumWorkers&&r.maxNumWorkers>0)){e.next=34;break}if(!((h=Math.min(r.maxNumWorkers,ve))<ve)){e.next=34;break}for(f=new Array(h),p=0;p<h;++p)b=me++%ve,f[p]=ye[b].open(t,r);return e.abrupt("return",je(f,r));case 34:return e.abrupt("return",je(ye.map((function(e){return e.open(t,r)})),r));case 35:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var ke=null;function Se(){return Te.apply(this,arguments)}function Te(){return(Te=Object(c.a)(s.a.mark((function e(){var t,r,n;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!ke){e.next=2;break}return e.abrupt("return",ke);case 2:for(Object(d.e)(),t=[],r=function(e){var r=be.create(e).then((function(t){return ye[e]=t,t}));t.push(r)},n=0;n<ve;n++)r(n);return e.abrupt("return",ke=Promise.all(t));case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}},function(e,t,r){"use strict";r.d(t,"a",(function(){return u}));var n=r(2),i=r(19),a=r(6),o=r(7),s=r(0),c=r(10),l=0,u=function(e){var t=function(e){Object(a.a)(r,e);var t=Object(o.a)(r);function r(){var e;Object(n.a)(this,r);for(var a=arguments.length,o=new Array(a),s=0;s<a;s++)o[s]=arguments[s];return e=t.call.apply(t,[this].concat(o)),Object.defineProperty(Object(i.a)(e),"uid",{writable:!1,configurable:!1,value:Date.now().toString(16)+"-object-"+l++}),e}return r}(e);return t=Object(s.a)([Object(c.a)("esri.core.Identifiable")],t)},d=function(e){Object(a.a)(r,e);var t=Object(o.a)(r);function r(){return Object(n.a)(this,r),t.apply(this,arguments)}return r}(u(function(){return function e(){Object(n.a)(this,e)}}()));d=Object(s.a)([Object(c.a)("esri.core.Identifiable")],d)},function(e,t,r){"use strict";var n,i=r(2),a=r(5),o=r(6),s=r(7),c=r(0),l=r(27),u=r(1),d=(r(17),r(18),r(15),r(10)),h=n=function(e){Object(o.a)(r,e);var t=Object(s.a)(r);function r(){var e;return Object(i.a)(this,r),(e=t.apply(this,arguments)).title=null,e}return Object(a.a)(r,[{key:"clone",value:function(){return new n({title:this.title})}}]),r}(l.a);Object(c.a)([Object(u.b)({type:String,json:{write:!0}})],h.prototype,"title",void 0);var f=h=n=Object(c.a)([Object(d.a)("esri.renderers.support.LegendOptions")],h);t.a=f},function(e,t,r){"use strict";r.d(t,"a",(function(){return s})),r.d(t,"b",(function(){return l}));var n=r(13),i=r(3),a=r(69),o=r(59);function s(e,t,r){if(Object(i.i)(t)||Object(i.i)(r)||r.vcsWkid||Object(o.c)(t,r))return null;var s=Object(a.g)(t)/Object(a.g)(r);if(1===s)return null;switch(e){case"point":case"esriGeometryPoint":return function(e){return function(e,t){e&&null!=e.z&&(e.z*=t)}(e,s)};case"polyline":case"esriGeometryPolyline":return function(e){return function(e,t){if(e){var r,i=Object(n.a)(e.paths);try{for(i.s();!(r=i.n()).done;){var a,o=r.value,s=Object(n.a)(o);try{for(s.s();!(a=s.n()).done;){var c=a.value;c.length>2&&(c[2]*=t)}}catch(l){s.e(l)}finally{s.f()}}}catch(l){i.e(l)}finally{i.f()}}}(e,s)};case"polygon":case"esriGeometryPolygon":return function(e){return function(e,t){if(e){var r,i=Object(n.a)(e.rings);try{for(i.s();!(r=i.n()).done;){var a,o=r.value,s=Object(n.a)(o);try{for(s.s();!(a=s.n()).done;){var c=a.value;c.length>2&&(c[2]*=t)}}catch(l){s.e(l)}finally{s.f()}}}catch(l){i.e(l)}finally{i.f()}}}(e,s)};case"multipoint":case"esriGeometryMultipoint":return function(e){return function(e,t){if(e){var r,i=Object(n.a)(e.points);try{for(i.s();!(r=i.n()).done;){var a=r.value;a.length>2&&(a[2]*=t)}}catch(o){i.e(o)}finally{i.f()}}}(e,s)};default:return null}}function c(e,t,r){if(null==e.hasM||e.hasZ){var i,a=Object(n.a)(t);try{for(a.s();!(i=a.n()).done;){var o,s=i.value,c=Object(n.a)(s);try{for(c.s();!(o=c.n()).done;){var l=o.value;l.length>2&&(l[2]*=r)}}catch(u){c.e(u)}finally{c.f()}}}catch(u){a.e(u)}finally{a.f()}}}function l(e,t,r){if((e||t)&&r){var n=Object(a.g)(r);u(e,r,n),u(t,r,n)}}function u(e,t,r){if(e){var i,a=Object(n.a)(e);try{for(a.s();!(i=a.n()).done;){d(i.value.geometry,t,r)}}catch(o){a.e(o)}finally{a.f()}}}function d(e,t,r){if(e&&e.spatialReference&&!Object(o.c)(e.spatialReference,t)){var i=Object(a.g)(e.spatialReference)/r;if(1!==i)if("x"in e)null!=e.z&&(e.z*=i);else if("rings"in e)c(e,e.rings,i);else if("paths"in e)c(e,e.paths,i);else if("points"in e&&(null==e.hasM||e.hasZ)){var s,l=Object(n.a)(e.points);try{for(l.s();!(s=l.n()).done;){var u=s.value;u.length>2&&(u[2]*=i)}}catch(d){l.e(d)}finally{l.f()}}}}},function(e,t,r){"use strict";var n,i=r(2),a=r(5),o=r(6),s=r(7),c=r(0),l=r(98),u=r(58),d=r(27),h=r(25),f=r(1),p=(r(18),r(17),r(15),r(48)),b=r(10),v=r(44),m=r(251),y=n=function(e){Object(o.a)(r,e);var t=Object(s.a)(r);function r(){var e;return Object(i.a)(this,r),(e=t.apply(this,arguments)).expression=null,e.title=null,e.value=null,e}return Object(a.a)(r,[{key:"readExpression",value:function(e,t){return t.value?Object(m.a)(t.value):e}},{key:"writeExpression",value:function(e,t,r){null!=this.value&&(e=Object(m.a)(this.value)),t[r]=e}},{key:"clone",value:function(){return new n({expression:this.expression,title:this.title,value:this.value})}}]),r}(d.a);Object(c.a)([Object(f.b)({type:String,json:{write:{allowNull:!0}}})],y.prototype,"expression",void 0),Object(c.a)([Object(p.a)("expression",["expression","value"])],y.prototype,"readExpression",null),Object(c.a)([Object(v.a)("expression")],y.prototype,"writeExpression",null),Object(c.a)([Object(f.b)({type:String,json:{write:!0,origins:{"web-scene":{write:!1}}}})],y.prototype,"title",void 0),Object(c.a)([Object(f.b)({json:{read:!1,write:!1}})],y.prototype,"value",void 0);var g,O=y=n=Object(c.a)([Object(b.a)("esri.layers.support.LabelExpressionInfo")],y),j=r(607),_=r(185),w=new u.a({esriServerPointLabelPlacementAboveCenter:"above-center",esriServerPointLabelPlacementAboveLeft:"above-left",esriServerPointLabelPlacementAboveRight:"above-right",esriServerPointLabelPlacementBelowCenter:"below-center",esriServerPointLabelPlacementBelowLeft:"below-left",esriServerPointLabelPlacementBelowRight:"below-right",esriServerPointLabelPlacementCenterCenter:"center-center",esriServerPointLabelPlacementCenterLeft:"center-left",esriServerPointLabelPlacementCenterRight:"center-right",esriServerLinePlacementAboveAfter:"above-after",esriServerLinePlacementAboveAlong:"above-along",esriServerLinePlacementAboveBefore:"above-before",esriServerLinePlacementAboveStart:"above-start",esriServerLinePlacementAboveEnd:"above-end",esriServerLinePlacementBelowAfter:"below-after",esriServerLinePlacementBelowAlong:"below-along",esriServerLinePlacementBelowBefore:"below-before",esriServerLinePlacementBelowStart:"below-start",esriServerLinePlacementBelowEnd:"below-end",esriServerLinePlacementCenterAfter:"center-after",esriServerLinePlacementCenterAlong:"center-along",esriServerLinePlacementCenterBefore:"center-before",esriServerLinePlacementCenterStart:"center-start",esriServerLinePlacementCenterEnd:"center-end",esriServerPolygonPlacementAlwaysHorizontal:"always-horizontal"},{ignoreUnknown:!0});function x(e){return!e||"service"!==e.origin&&!k(e.layer)}function k(e){return"map-image"===(null==e?void 0:e.type)}function S(e){var t,r;return!!k(e)&&!(null==(t=e.capabilities)||null==(r=t.exportMap)||!r.supportsArcadeExpressionForLabeling)}var T=g=function(e){Object(o.a)(r,e);var t=Object(s.a)(r);function r(e){var n;return Object(i.a)(this,r),(n=t.call(this,e)).type="label",n.name=null,n.deconflictionStrategy="static",n.labelExpression=null,n.labelExpressionInfo=null,n.labelPlacement=null,n.maxScale=0,n.minScale=0,n.symbol=j.d,n.useCodedValues=void 0,n.where=null,n}return Object(a.a)(r,[{key:"readLabelExpression",value:function(e,t){var r=t.labelExpressionInfo;if(!r||!r.value&&!r.expression)return e}},{key:"writeLabelExpression",value:function(e,t,r){if(this.labelExpressionInfo)if(null!=this.labelExpressionInfo.value)e=Object(m.f)(this.labelExpressionInfo.value);else if(null!=this.labelExpressionInfo.expression){var n=Object(m.e)(this.labelExpressionInfo.expression);n&&(e="["+n+"]")}null!=e&&(t[r]=e)}},{key:"writeLabelExpressionInfo",value:function(e,t,r,n){if(null==e&&null!=this.labelExpression&&x(n))e=new O({expression:this.getLabelExpressionArcade()});else if(!e)return;var i=e.toJSON(n);i.expression&&(t[r]=i)}},{key:"writeMaxScale",value:function(e,t){(e||this.minScale)&&(t.maxScale=e)}},{key:"writeMinScale",value:function(e,t){(e||this.maxScale)&&(t.minScale=e)}},{key:"getLabelExpression",value:function(){return Object(m.b)(this)}},{key:"getLabelExpressionArcade",value:function(){return Object(m.c)(this)}},{key:"getLabelExpressionSingleField",value:function(){return Object(m.d)(this)}},{key:"hash",value:function(){return JSON.stringify(this)}},{key:"clone",value:function(){return new g({deconflictionStrategy:this.deconflictionStrategy,labelExpression:this.labelExpression,labelExpressionInfo:Object(h.a)(this.labelExpressionInfo),labelPlacement:this.labelPlacement,maxScale:this.maxScale,minScale:this.minScale,name:this.name,symbol:Object(h.a)(this.symbol),where:this.where,useCodedValues:this.useCodedValues})}}],[{key:"evaluateWhere",value:function(e,t){var r=function(e,t,r){switch(t){case"=":return e==r;case"<>":return e!=r;case">":return e>r;case">=":return e>=r;case"<":return e<r;case"<=":return e<=r}return!1};try{if(null==e)return!0;var n=e.split(" ");if(3===n.length)return r(t[n[0]],n[1],n[2]);if(7===n.length){var i=r(t[n[0]],n[1],n[2]),a=n[3],o=r(t[n[4]],n[5],n[6]);switch(a){case"AND":return i&&o;case"OR":return i||o}}return!1}catch(s){console.log("Error.: can't parse = "+e)}}}]),r}(d.a);Object(c.a)([Object(f.b)({type:String,json:{write:!0}})],T.prototype,"name",void 0),Object(c.a)([Object(f.b)({type:String,json:{write:!0,default:"static",origins:{"web-scene":{write:!1}}}})],T.prototype,"deconflictionStrategy",void 0),Object(c.a)([Object(f.b)({type:String,json:{write:{overridePolicy:function(e,t,r){return this.labelExpressionInfo&&"service"===(null==r?void 0:r.origin)&&S(r.layer)?{enabled:!1}:{allowNull:!0}}}}})],T.prototype,"labelExpression",void 0),Object(c.a)([Object(p.a)("labelExpression")],T.prototype,"readLabelExpression",null),Object(c.a)([Object(v.a)("labelExpression")],T.prototype,"writeLabelExpression",null),Object(c.a)([Object(f.b)({type:O,json:{write:{overridePolicy:function(e,t,r){return function(e){return x(e)||S(e.layer)}(r)?{allowNull:!0}:{enabled:!1}}}}})],T.prototype,"labelExpressionInfo",void 0),Object(c.a)([Object(v.a)("labelExpressionInfo")],T.prototype,"writeLabelExpressionInfo",null),Object(c.a)([Object(f.b)({type:w.apiValues,json:{type:w.jsonValues,read:w.read,write:w.write}})],T.prototype,"labelPlacement",void 0),Object(c.a)([Object(f.b)({type:Number})],T.prototype,"maxScale",void 0),Object(c.a)([Object(v.a)("maxScale")],T.prototype,"writeMaxScale",null),Object(c.a)([Object(f.b)({type:Number})],T.prototype,"minScale",void 0),Object(c.a)([Object(v.a)("minScale")],T.prototype,"writeMinScale",null),Object(c.a)([Object(f.b)({types:l.g,json:{origins:{"web-scene":{types:l.h,write:_.b,default:null}},write:_.b,default:null}})],T.prototype,"symbol",void 0),Object(c.a)([Object(f.b)({type:Boolean,json:{write:!0}})],T.prototype,"useCodedValues",void 0),Object(c.a)([Object(f.b)({type:String,json:{write:!0}})],T.prototype,"where",void 0);var C=T=g=Object(c.a)([Object(b.a)("esri.layers.support.LabelClass")],T);t.a=C},function(e,t,r){"use strict";function n(e,t,r){for(var n=e.typedBuffer,i=e.typedBufferStride,a=t.typedBuffer,o=t.typedBufferStride,s=r?r.count:t.count,c=(r&&r.dstIndex?r.dstIndex:0)*i,l=(r&&r.srcIndex?r.srcIndex:0)*o,u=0;u<s;++u)n[c]=a[l],n[c+1]=a[l+1],n[c+2]=a[l+2],c+=i,l+=o}function i(e,t,r,n,i){for(var a,o,s=e.typedBuffer,c=e.typedBufferStride,l=null!=(a=null==i?void 0:i.count)?a:e.count,u=(null!=(o=null==i?void 0:i.dstIndex)?o:0)*c,d=0;d<l;++d)s[u]=t,s[u+1]=r,s[u+2]=n,u+=c}r.d(t,"a",(function(){return n})),r.d(t,"b",(function(){return i}));Object.freeze({__proto__:null,copy:n,fill:i})},function(e,t,r){"use strict";var n=r(2),i=r(6),a=r(7),o=r(0),s=r(27),c=r(1),l=(r(17),r(18),r(15),r(10)),u=function(e){Object(i.a)(r,e);var t=Object(a.a)(r);function r(){var e;return Object(n.a)(this,r),(e=t.apply(this,arguments)).type=null,e}return r}(s.a);Object(o.a)([Object(c.b)({type:["selection","cluster"],readOnly:!0,json:{read:!1,write:!0}})],u.prototype,"type",void 0);var d=u=Object(o.a)([Object(l.a)("esri.layers.support.FeatureReduction")],u);t.a=d},function(e,t,r){"use strict";r.d(t,"a",(function(){return s}));var n,i,a=r(12),o=r(11);function s(e){var t=Object(o.a)(n||(n=Object(a.a)(["vec4 alignToPixelCenter(vec4 clipCoord, vec2 widthHeight) {\nvec2 xy = vec2(0.500123) + 0.5 * clipCoord.xy / clipCoord.w;\nvec2 pixelSz = vec2(1.0) / widthHeight;\nvec2 ij = (floor(xy * widthHeight) + vec2(0.5)) * pixelSz;\nvec2 result = (ij * 2.0 - vec2(1.0)) * clipCoord.w;\nreturn vec4(result, clipCoord.zw);\n}"]))),r=Object(o.a)(i||(i=Object(a.a)(["vec4 alignToPixelOrigin(vec4 clipCoord, vec2 widthHeight) {\nvec2 xy = vec2(0.5) + 0.5 * clipCoord.xy / clipCoord.w;\nvec2 pixelSz = vec2(1.0) / widthHeight;\nvec2 ij = floor((xy + 0.5 * pixelSz) * widthHeight) * pixelSz;\nvec2 result = (ij * 2.0 - vec2(1.0)) * clipCoord.w;\nreturn vec4(result, clipCoord.zw);\n}"])));e.vertex.code.add(t),e.vertex.code.add(r),e.fragment.code.add(t),e.fragment.code.add(r)}},function(e,t,r){"use strict";r.d(t,"a",(function(){return G})),r.d(t,"b",(function(){return z})),r.d(t,"c",(function(){return V})),r.d(t,"d",(function(){return N}));var n,i,a,o,s,c,l,u,d,h,f,p,b,v,m,y,g,O,j,_=r(12),w=r(29),x=r(38),k=r(43),S=r(76),T=r(376),C=r(318),M=r(651),P=r(109),A=r(197),E=r(110),R=r(177),I=r(194),D=r(323),F=r(11),L=r(87);function z(e){var t=new L.a,r=e.signedDistanceFieldEnabled;if(t.include(T.a),t.include(C.a,e),t.include(S.a,e),6===e.output)return t.include(M.a,e),t;t.include(D.a),t.fragment.include(I.a),t.fragment.include(R.a),t.include(A.a,e),t.varyings.add("vcolor","vec4"),t.varyings.add("vtc","vec2"),t.varyings.add("vsize","vec2"),e.binaryHighlightOcclusionEnabled&&t.varyings.add("voccluded","float"),t.vertex.uniforms.add("screenOffset","vec2").add("anchorPos","vec2").add("textureCoordinateScaleFactor","vec2").add("materialColor","vec4"),r&&t.vertex.uniforms.add("outlineColor","vec4"),e.screenSizePerspectiveEnabled&&t.vertex.uniforms.add("screenSizePerspective","vec4"),(e.debugDrawBorder||e.binaryHighlightOcclusionEnabled)&&t.varyings.add("debugBorderCoords","vec4"),t.attributes.add("uv0","vec2"),t.attributes.add("color","vec4"),t.attributes.add("size","vec2"),t.attributes.add("auxpos2","vec4"),t.vertex.code.add(Object(F.a)(n||(n=Object(_.a)(["\n    void main(void) {\n      ProjectHUDAux projectAux;\n      vec4 posProj = projectPositionHUD(projectAux);\n\n      if (rejectBySlice(projectAux.posModel)) {\n        // Project outside of clip plane\n        gl_Position = vec4(1e038, 1e038, 1e038, 1.0);\n        return;\n      }\n      vec2 inputSize;\n      ","\n\n      ","\n\n      vec2 combinedSize = inputSize * pixelRatio;\n      vec4 quadOffset = vec4(0.0);\n\n      ","\n\n      ","\n    "])),e.screenSizePerspectiveEnabled?Object(F.a)(i||(i=Object(_.a)(["\n      inputSize = screenSizePerspectiveScaleVec2(size, projectAux.absCosAngle, projectAux.distanceToCamera, screenSizePerspective);\n      vec2 screenOffsetScaled = screenSizePerspectiveScaleVec2(screenOffset, projectAux.absCosAngle, projectAux.distanceToCamera, screenSizePerspectiveAlignment);\n         "]))):Object(F.a)(a||(a=Object(_.a)(["\n      inputSize = size;\n      vec2 screenOffsetScaled = screenOffset;"]))),e.vvSize?"inputSize *= vvScale(auxpos2).xx;":"",e.occlusionTestEnabled||e.binaryHighlightOcclusionEnabled?"bool visible = testVisibilityHUD(posProj);":"",e.binaryHighlightOcclusionEnabled?"voccluded = visible ? 0.0 : 1.0;":""));var w=Object(F.a)(o||(o=Object(_.a)(["vec2 uv01 = floor(uv0);\nvec2 uv = uv0 - uv01;\nquadOffset.xy = ((uv01 - anchorPos) * 2.0 * combinedSize + screenOffsetScaled) / viewport.zw * posProj.w;"]))),x=e.pixelSnappingEnabled?r?Object(F.a)(s||(s=Object(_.a)(["posProj = alignToPixelOrigin(posProj, viewport.zw) + quadOffset;"]))):Object(F.a)(c||(c=Object(_.a)(["posProj += quadOffset;\nif (inputSize.x == size.x) {\nposProj = alignToPixelOrigin(posProj, viewport.zw);\n}"]))):Object(F.a)(l||(l=Object(_.a)(["posProj += quadOffset;"])));t.vertex.code.add(Object(F.a)(u||(u=Object(_.a)(["\n      ","\n      ","\n      ","\n\n      bool alphaDiscard = vcolor.a < ",";\n      ",'\n      if (alphaDiscard) {\n        // "early discard" if both symbol color (= fill) and outline color (if applicable) are transparent\n        gl_Position = vec4(1e38, 1e38, 1e38, 1.0);\n        return;\n      } else {\n        ',"\n        gl_Position = posProj;\n      }\n\n      vtc = uv * textureCoordinateScaleFactor;\n\n      ","\n      vsize = inputSize;\n      ","\n    }\n    "])),e.occlusionTestEnabled?"if (visible) {":"",w,e.vvColor?"vcolor = vvGetColor(auxpos2, vvColorValues, vvColorColors) * materialColor;":"vcolor = color / 255.0 * materialColor;",F.a.float(E.c),r?"alphaDiscard = alphaDiscard && outlineColor.a < ".concat(F.a.float(E.c),";"):"",x,e.debugDrawBorder?"debugBorderCoords = vec4(uv01, 1.5 / combinedSize);":"",e.occlusionTestEnabled?Object(F.a)(d||(d=Object(_.a)(["} else { vtc = vec2(0.0);\n        ",""])),e.debugDrawBorder?"debugBorderCoords = vec4(0.5, 0.5, 1.5 / combinedSize);}":"}"):"")),t.fragment.uniforms.add("tex","sampler2D"),r&&(t.fragment.uniforms.add("outlineColor","vec4"),t.fragment.uniforms.add("outlineSize","float"));var k=e.debugDrawBorder?Object(F.a)(h||(h=Object(_.a)(["(isBorder > 0.0 ? 0.0 : ",")"])),F.a.float(E.b)):F.a.float(E.b),z=Object(F.a)(f||(f=Object(_.a)(["\n    ","\n\n    ","\n\n    ","\n  "])),e.debugDrawBorder?Object(F.a)(p||(p=Object(_.a)(["\n      float isBorder = float(any(lessThan(debugBorderCoords.xy, debugBorderCoords.zw)) || any(greaterThan(debugBorderCoords.xy, 1.0 - debugBorderCoords.zw)));"]))):"",r?Object(F.a)(b||(b=Object(_.a)(["\n      vec4 fillPixelColor = vcolor;\n\n      // Attempt to sample texel centers to avoid that thin cross outlines\n      // disappear with large symbol sizes.\n      // see: https://devtopia.esri.com/WebGIS/arcgis-js-api/issues/7058#issuecomment-603041\n      const float txSize = 128.0;\n      const float texelSize = 1.0 / txSize;\n      // Calculate how much we have to add/subtract to/from each texel to reach the size of an onscreen pixel\n      vec2 scaleFactor = (vsize - txSize) * texelSize;\n      vec2 samplePos = vtc + (vec2(1.0, -1.0) * texelSize) * scaleFactor;\n\n      // Get distance and map it into [-0.5, 0.5]\n      float d = rgba2float(texture2D(tex, samplePos)) - 0.5;\n\n      // Distance in output units (i.e. pixels)\n      float dist = d * vsize.x;\n\n      // Create smooth transition from the icon into its outline\n      float fillAlphaFactor = clamp(0.5 - dist, 0.0, 1.0);\n      fillPixelColor.a *= fillAlphaFactor;\n\n      if (outlineSize > 0.25) {\n        vec4 outlinePixelColor = outlineColor;\n        float clampedOutlineSize = min(outlineSize, 0.5*vsize.x);\n\n        // Create smooth transition around outline\n        float outlineAlphaFactor = clamp(0.5 - (abs(dist) - 0.5*clampedOutlineSize), 0.0, 1.0);\n        outlinePixelColor.a *= outlineAlphaFactor;\n\n        if (\n          outlineAlphaFactor + fillAlphaFactor < "," ||\n          fillPixelColor.a + outlinePixelColor.a < ","\n        ) {\n          discard;\n        }\n\n        // perform un-premultiplied over operator (see https://en.wikipedia.org/wiki/Alpha_compositing#Description)\n        float compositeAlpha = outlinePixelColor.a + fillPixelColor.a * (1.0 - outlinePixelColor.a);\n        vec3 compositeColor = vec3(outlinePixelColor) * outlinePixelColor.a +\n          vec3(fillPixelColor) * fillPixelColor.a * (1.0 - outlinePixelColor.a);\n\n        gl_FragColor = vec4(compositeColor, compositeAlpha);\n      } else {\n        if (fillAlphaFactor < ",") {\n          discard;\n        }\n\n        gl_FragColor = premultiplyAlpha(fillPixelColor);\n      }\n\n      // visualize SDF:\n      // gl_FragColor = vec4(clamp(-dist/vsize.x*2.0, 0.0, 1.0), clamp(dist/vsize.x*2.0, 0.0, 1.0), 0.0, 1.0);\n      "])),k,F.a.float(E.c),k):Object(F.a)(v||(v=Object(_.a)(["\n          vec4 texColor = texture2D(tex, vtc, -0.5);\n          if (texColor.a < ",") {\n            discard;\n          }\n          gl_FragColor = texColor * premultiplyAlpha(vcolor);\n          "])),k),e.debugDrawBorder?Object(F.a)(m||(m=Object(_.a)(["gl_FragColor = mix(gl_FragColor, vec4(1.0, 0.0, 1.0, 1.0), isBorder);"]))):"");return 7===e.output&&t.fragment.code.add(Object(F.a)(y||(y=Object(_.a)(["\n      void main() {\n        ","\n        gl_FragColor = vec4(gl_FragColor.a);\n      }\n      "])),z)),0===e.output&&t.fragment.code.add(Object(F.a)(g||(g=Object(_.a)(["\n    void main() {\n      ","\n      ","\n    }\n    "])),z,e.FrontFacePass?"gl_FragColor.rgb /= gl_FragColor.a;":"")),4===e.output&&(t.include(P.a),t.fragment.code.add(Object(F.a)(O||(O=Object(_.a)(["\n    void main() {\n      ","\n      ","\n    }\n    "])),z,e.binaryHighlightOcclusionEnabled?Object(F.a)(j||(j=Object(_.a)(["\n          if (voccluded == 1.0) {\n            gl_FragColor = vec4(1.0, 1.0, 0.0, 1.0);\n          } else {\n            gl_FragColor = vec4(1.0, 0.0, 1.0, 1.0);\n          }"]))):"outputHighlight();"))),t}function V(e,t,r){e.setUniform4fv("materialColor",t.color),t.textureIsSignedDistanceField&&(t.outlineColor[3]<=0||t.outlineSize<=0?(e.setUniform4fv("outlineColor",k.b),e.setUniform1f("outlineSize",0)):(e.setUniform4fv("outlineColor",t.outlineColor),e.setUniform1f("outlineSize",t.outlineSize))),e.setUniform2f("screenOffset",2*t.screenOffset[0]*r,2*t.screenOffset[1]*r),e.setUniform2fv("anchorPos",N(t))}function N(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:B;return e.textureIsSignedDistanceField?U(e.anchorPos,e.distanceFieldBoundingBox,t):Object(w.c)(t,e.anchorPos),t}function U(e,t,r){r[0]=e[0]*(t[2]-t[0])+t[0],r[1]=e[1]*(t[3]-t[1])+t[1]}var B=Object(x.b)(),G=Object.freeze({__proto__:null,build:z,bindHUDMaterialUniforms:V,calculateAnchorPosForRendering:N})},function(e,t,r){"use strict";r.d(t,"a",(function(){return O})),r.d(t,"b",(function(){return y})),r.d(t,"c",(function(){return m})),r.d(t,"d",(function(){return k})),r.d(t,"e",(function(){return x})),r.d(t,"f",(function(){return g})),r.d(t,"g",(function(){return _})),r.d(t,"h",(function(){return j})),r.d(t,"i",(function(){return w}));var n=r(15),i=r(3),a=r(67),o=r(96),s=r(31),c=r(4),l=r(9),u=r(51),d=r(68),h=r(59),f=r(61),p=r(32),b=r(178),v=n.a.getLogger("esri.geometry.support.meshUtils.normalProjection");function m(e,t,r,n,i){return T(n)?(S(0,p.u.fromTypedArray(e),p.v.fromTypedArray(t),p.v.fromTypedArray(r),n,p.u.fromTypedArray(i)),i):(v.error("Cannot convert spatial reference to PCPF"),i)}function y(e,t,r,n,i){return T(n)?(S(1,p.u.fromTypedArray(e),p.v.fromTypedArray(t),p.v.fromTypedArray(r),n,p.u.fromTypedArray(i)),i):(v.error("Cannot convert to spatial reference from PCPF"),i)}function g(e,t,r){return Object(u.q)(e,t,0,r,Object(d.g)(t),0,e.length/3),r}function O(e,t,r){return Object(u.q)(e,Object(d.g)(r),0,t,r,0,e.length/3),t}function j(e,t,r){if(Object(i.i)(e))return t;var n=p.v.fromTypedArray(e),a=p.v.fromTypedArray(t);return Object(b.e)(a,n,r),t}function _(e,t,r){if(Object(i.i)(e))return t;Object(a.a)(E,r);var n=p.u.fromTypedArray(e),o=p.u.fromTypedArray(t);return Object(b.a)(o,n,E),Object(a.i)(E)||Object(b.c)(o,o),t}function w(e,t,r){if(Object(i.i)(e))return t;Object(a.a)(E,r);var n=p.u.fromTypedArray(e,4*Float32Array.BYTES_PER_ELEMENT),o=p.u.fromTypedArray(t,4*Float32Array.BYTES_PER_ELEMENT);if(Object(b.a)(o,n,E),Object(a.i)(E)||Object(b.c)(o,o),e!==t)for(var s=3;s<e.length;s+=4)t[s]=e[s];return t}function x(e,t,r,n,i){if(!T(n))return v.error("Cannot convert spatial reference to PCPF"),i;S(0,p.u.fromTypedArray(e,4*Float32Array.BYTES_PER_ELEMENT),p.v.fromTypedArray(t),p.v.fromTypedArray(r),n,p.u.fromTypedArray(i,4*Float32Array.BYTES_PER_ELEMENT));for(var a=3;a<e.length;a+=4)i[a]=e[a];return i}function k(e,t,r,n,i){if(!T(n))return v.error("Cannot convert to spatial reference from PCPF"),i;S(1,p.u.fromTypedArray(e,16),p.v.fromTypedArray(t),p.v.fromTypedArray(r),n,p.u.fromTypedArray(i,16));for(var a=3;a<e.length;a+=4)i[a]=e[a];return i}function S(e,t,r,n,i,o){if(t){var s=r.count,l=Object(d.g)(i);if(C(i))for(var h=0;h<s;h++)n.getVec(h,M),t.getVec(h,P),Object(u.d)(l,M,A,l),Object(a.f)(E,A),1===e&&Object(a.n)(E,E),Object(c.z)(P,P,E),o.setVec(h,P);else for(var p=0;p<s;p++){n.getVec(p,M),t.getVec(p,P),Object(u.d)(l,M,A,l),Object(a.f)(E,A);var b=Object(f.h)(r.get(p,1)),v=Math.cos(b);0===e&&(v=1/v),E[0]*=v,E[1]*=v,E[2]*=v,E[3]*=v,E[4]*=v,E[5]*=v,1===e&&Object(a.n)(E,E),Object(c.z)(P,P,E),Object(c.t)(P,P),o.setVec(p,P)}return o}}function T(e){return C(e)||function(e){return e.isWebMercator}(e)}function C(e){return e.isWGS84||Object(h.e)(e)||Object(h.h)(e)||Object(h.i)(e)}var M=Object(l.e)(),P=Object(l.e)(),A=Object(s.d)(),E=Object(o.b)()},function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n,i=r(12),a=r(11);function o(e){e.fragment.uniforms.add("projInfo","vec4"),e.fragment.uniforms.add("zScale","vec2"),e.fragment.code.add(Object(a.a)(n||(n=Object(i.a)(["vec3 reconstructPosition(vec2 fragCoord, float depth) {\nreturn vec3((fragCoord * projInfo.xy + projInfo.zw) * (zScale.x * depth + zScale.y), depth);\n}"]))))}},function(e,t,r){"use strict";r.d(t,"a",(function(){return l})),r.d(t,"b",(function(){return u})),r.d(t,"c",(function(){return d})),r.d(t,"d",(function(){return c}));var n=r(14),i=r(49),a=(r(17),r(3)),o=r(28),s=r(43);function c(e){return e&&e.enabled&&(function(e){return"extrude"===e.type}(e)||function(e){return"fill"===e.type}(e))&&Object(a.j)(e.edges)}function l(e,t){return u(function(e){return e&&e.enabled&&e.edges||null}(e),t)}function u(e,t){if(Object(a.i)(e))return null;var r,c=Object(a.j)(e.color)?Object(s.d)(i.a.toUnitRGBA(e.color)):Object(s.g)(0,0,0,0),l=Object(o.g)(e.size),u=Object(o.g)(e.extensionLength);switch(e.type){case"solid":return d(Object(n.a)({color:c,size:l,extensionLength:u},t));case"sketch":return r=Object(n.a)({color:c,size:l,extensionLength:u},t),Object(n.a)(Object(n.a)(Object(n.a)({},f),r),{},{type:"sketch"});default:return}}function d(e){return Object(n.a)(Object(n.a)(Object(n.a)({},h),e),{},{type:"solid"})}var h={color:Object(s.g)(0,0,0,.2),size:1,extensionLength:0,opacity:1,objectTransparency:2},f={color:Object(s.g)(0,0,0,.2),size:1,extensionLength:0,opacity:1,objectTransparency:2}},function(e,t,r){"use strict";r.d(t,"a",(function(){return m}));var n,i,a,o,s,c,l,u,d=r(2),h=r(12),f=r(9),p=r(228),b=r(11),v=r(360);function m(e,t){t.instanced&&t.instancedDoublePrecision&&(e.attributes.add("modelOriginHi","vec3"),e.attributes.add("modelOriginLo","vec3"),e.attributes.add("model","mat3"),e.attributes.add("modelNormal","mat3")),t.instancedDoublePrecision&&(e.vertex.include(p.a,t),e.vertex.uniforms.add("viewOriginHi","vec3"),e.vertex.uniforms.add("viewOriginLo","vec3"));var r=[Object(b.a)(n||(n=Object(h.a)(["\n    vec3 calculateVPos() {\n      ","\n    }\n    "])),t.instancedDoublePrecision?"return model * localPosition().xyz;":"return localPosition().xyz;"),Object(b.a)(i||(i=Object(h.a)(["\n    vec3 subtractOrigin(vec3 _pos) {\n      ","\n    }\n    "])),t.instancedDoublePrecision?Object(b.a)(a||(a=Object(h.a)(["\n          vec3 originDelta = dpAdd(viewOriginHi, viewOriginLo, -modelOriginHi, -modelOriginLo);\n          return _pos - originDelta;"]))):"return vpos;"),Object(b.a)(o||(o=Object(h.a)(["\n    vec3 dpNormal(vec4 _normal) {\n      ","\n    }\n    "])),t.instancedDoublePrecision?"return normalize(modelNormal * _normal.xyz);":"return normalize(_normal.xyz);"),Object(b.a)(s||(s=Object(h.a)(["\n    vec3 dpNormalView(vec4 _normal) {\n      ","\n    }\n    "])),t.instancedDoublePrecision?"return normalize((viewNormal * vec4(modelNormal * _normal.xyz, 1.0)).xyz);":"return normalize((viewNormal * _normal).xyz);"),t.vertexTangents?Object(b.a)(c||(c=Object(h.a)(["\n    vec4 dpTransformVertexTangent(vec4 _tangent) {\n      ","\n\n    }\n    "])),t.instancedDoublePrecision?"return vec4(modelNormal * _tangent.xyz, _tangent.w);":"return _tangent;"):Object(b.a)(l||(l=Object(h.a)([""])))];e.vertex.code.add(r[0]),e.vertex.code.add(r[1]),e.vertex.code.add(r[2]),2===t.output&&e.vertex.code.add(r[3]),e.vertex.code.add(r[4])}(u=m||(m={})).Uniforms=function e(){Object(d.a)(this,e)},u.bindCustomOrigin=function(e,t){Object(v.b)(t,y,g,3),e.setUniform3fv("viewOriginHi",y),e.setUniform3fv("viewOriginLo",g)};var y=Object(f.e)(),g=Object(f.e)()},function(e,t,r){"use strict";r.d(t,"a",(function(){return w}));var n=r(2),i=r(5),a=(r(17),r(3)),o=r(122),s=r(159),c=r(13),l=["layout","centroid","smooth","case","mat2x2","mat2x3","mat2x4","mat3x2","mat3x3","mat3x4","mat4x2","mat4x3","mat4x4","uint","uvec2","uvec3","uvec4","samplerCubeShadow","sampler2DArray","sampler2DArrayShadow","isampler2D","isampler3D","isamplerCube","isampler2DArray","usampler2D","usampler3D","usamplerCube","usampler2DArray","coherent","restrict","readonly","writeonly","resource","atomic_uint","noperspective","patch","sample","subroutine","common","partition","active","filter","image1D","image2D","image3D","imageCube","iimage1D","iimage2D","iimage3D","iimageCube","uimage1D","uimage2D","uimage3D","uimageCube","image1DArray","image2DArray","iimage1DArray","iimage2DArray","uimage1DArray","uimage2DArray","image1DShadow","image2DShadow","image1DArrayShadow","image2DArrayShadow","imageBuffer","iimageBuffer","uimageBuffer","sampler1DArray","sampler1DArrayShadow","isampler1D","isampler1DArray","usampler1D","usampler1DArray","isampler2DRect","usampler2DRect","samplerBuffer","isamplerBuffer","usamplerBuffer","sampler2DMS","isampler2DMS","usampler2DMS","sampler2DMSArray","isampler2DMSArray","usampler2DMSArray","trunc","round","roundEven","isnan","isinf","floatBitsToInt","floatBitsToUint","intBitsToFloat","uintBitsToFloat","packSnorm2x16","unpackSnorm2x16","packUnorm2x16","unpackUnorm2x16","packHalf2x16","unpackHalf2x16","outerProduct","transpose","determinant","inverse","texture","textureSize","textureProj","textureLod","textureOffset","texelFetch","texelFetchOffset","textureProjOffset","textureLodOffset","textureProjLod","textureProjLodOffset","textureGrad","textureGradOffset","textureProjGrad","textureProjGradOffset"],u=r(239),d=999,h=["block-comment","line-comment","preprocessor","operator","integer","float","ident","builtin","keyword","whitespace","eof","integer"];function f(){var e,t,r,n=0,i=0,a=d,o=[],s=[],c=1,l=0,f=0,p=!1,b=!1,v="";return function(e){return s=[],null!==e?y(e.replace?e.replace(/\r\n/g,"\n"):e):(o.length&&m(o.join("")),a=10,m("(eof)"),s)};function m(e){e.length&&s.push({type:h[a],data:e,position:f,line:c,column:l})}function y(u){var h;for(n=0,r=(v+=u).length;e=v[n],n<r;){switch(h=n,a){case 0:n="/"===e&&"*"===t?(o.push(e),m(o.join("")),a=d,n+1):(o.push(e),t=e,n+1);break;case 1:case 2:n=g();break;case 3:n=O();break;case 4:n="."===e||/[eE]/.test(e)?(o.push(e),a=5,t=e,n+1):"x"===e&&1===o.length&&"0"===o[0]?(a=11,o.push(e),t=e,n+1):/[^\d]/.test(e)?(m(o.join("")),a=d,n):(o.push(e),t=e,n+1);break;case 11:n=/[^a-fA-F0-9]/.test(e)?(m(o.join("")),a=d,n):(o.push(e),t=e,n+1);break;case 5:"f"===e&&(o.push(e),t=e,n+=1),n=/[eE]/.test(e)||"-"===e&&/[eE]/.test(t)?(o.push(e),t=e,n+1):/[^\d]/.test(e)?(m(o.join("")),a=d,n):(o.push(e),t=e,n+1);break;case 9999:n=_();break;case 9:n=/[^\s]/g.test(e)?(m(o.join("")),a=d,n):(o.push(e),t=e,n+1);break;case d:o=o.length?[]:o,n="/"===t&&"*"===e?(f=i+n-1,a=0,t=e,n+1):"/"===t&&"/"===e?(f=i+n-1,a=1,t=e,n+1):"#"===e?(a=2,f=i+n,n):/\s/.test(e)?(a=9,f=i+n,n):(p=/\d/.test(e),b=/[^\w_]/.test(e),f=i+n,a=p?4:b?3:9999,n)}if(h!==n)switch(v[h]){case"\n":l=0,++c;break;default:++l}}return i+=n,v=v.slice(n),s}function g(){return"\r"!==e&&"\n"!==e||"\\"===t?(o.push(e),t=e,n+1):(m(o.join("")),a=d,n)}function O(){if("."===t&&/\d/.test(e))return a=5,n;if("/"===t&&"*"===e)return a=0,n;if("/"===t&&"/"===e)return a=1,n;if("."===e&&o.length){for(;j(o););return a=5,n}if(";"===e||")"===e||"("===e){if(o.length)for(;j(o););return m(e),a=d,n+1}var r=2===o.length&&"="!==e;if(/[\w_\d\s]/.test(e)||r){for(;j(o););return a=d,n}return o.push(e),t=e,n+1}function j(e){for(var t,r,n=0;;){if(t=u.c.indexOf(e.slice(0,e.length+n).join("")),r=u.c[t],-1===t){if(n--+e.length>0)continue;r=e.slice(0,1).join("")}return m(r),f+=r.length,(o=o.slice(r.length)).length}}function _(){if(/[^\d\w_]/.test(e)){var r=o.join("");return a=u.b.indexOf(r)>-1?8:u.a.indexOf(r)>-1?7:6,m(o.join("")),a=d,n}return o.push(e),t=e,n+1}}function p(e){return function(e){var t=f(),r=[];return(r=r.concat(t(e))).concat(t(null))}(e)}var b=["GL_OES_standard_derivatives","GL_EXT_frag_depth","GL_EXT_draw_buffers","GL_EXT_shader_texture_lod"];function v(e,t){for(var r=t-1;r>=0;r--){var n=e[r];if("whitespace"!==n.type&&"block-comment"!==n.type){if("keyword"!==n.type)break;if("attribute"===n.data||"in"===n.data)return!0}}return!1}function m(e,t,r,n){n=n||r;var i,a=Object(c.a)(e);try{for(a.s();!(i=a.n()).done;){var o=i.value;if("ident"===o.type&&o.data===r)return n in t?t[n]++:t[n]=0,m(e,t,n+"_"+t[n],n)}}catch(s){a.e(s)}finally{a.f()}return r}function y(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"afterVersion";function n(e,t){for(var r=t;r<e.length;r++){var n=e[r];if("operator"===n.type&&";"===n.data)return r}return null}function i(e){for(var t=-1,i=0,a=-1,o=0;o<e.length;o++){var s=e[o];if("preprocessor"===s.type&&(s.data.match(/\#(if|ifdef|ifndef)\s+.+/)?++i:s.data.match(/\#endif\s*.*/)&&--i),"afterVersion"!==r&&"afterPrecision"!==r||"preprocessor"===s.type&&/^#version/.test(s.data)&&(a=Math.max(a,o)),"afterPrecision"===r&&"keyword"===s.type&&"precision"===s.data){var c=n(e,o);if(null===c)throw new Error("precision statement not followed by any semicolons!");a=Math.max(a,c)}t<a&&0===i&&(t=o)}return t+1}var a={data:"\n",type:"whitespace"},o=function(t){return t<e.length&&/[^\r\n]$/.test(e[t].data)},s=i(e);o(s-1)&&e.splice(s++,0,a);var l,u=Object(c.a)(t);try{for(u.s();!(l=u.n()).done;){var d=l.value;e.splice(s++,0,d)}}catch(h){u.e(h)}finally{u.f()}o(s-1)&&o(s)&&e.splice(s,0,a)}function g(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"lowp";y(e,[{type:"keyword",data:"out"},{type:"whitespace",data:" "},{type:"keyword",data:n},{type:"whitespace",data:" "},{type:"keyword",data:r},{type:"whitespace",data:" "},{type:"ident",data:t},{type:"operator",data:";"}],"afterPrecision")}function O(e,t,r,n){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"lowp";y(e,[{type:"keyword",data:"layout"},{type:"operator",data:"("},{type:"keyword",data:"location"},{type:"whitespace",data:" "},{type:"operator",data:"="},{type:"whitespace",data:" "},{type:"integer",data:n.toString()},{type:"operator",data:")"},{type:"whitespace",data:" "},{type:"keyword",data:"out"},{type:"whitespace",data:" "},{type:"keyword",data:i},{type:"whitespace",data:" "},{type:"keyword",data:r},{type:"whitespace",data:" "},{type:"ident",data:t},{type:"operator",data:";"}],"afterPrecision")}function j(e,t){for(var r,n,i=-1,a=t;a<e.length;a++){var o=e[a];if("operator"===o.type&&("["===o.data&&(r=a),"]"===o.data)){n=a;break}"integer"===o.type&&(i=parseInt(o.data,10))}return r&&n&&e.splice(r,n-r+1),i}function _(e,t){var r=p(e);if("300 es"===function(e){var t,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"100",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"300 es",i=/^\s*\#version\s+([0-9]+(\s+[a-zA-Z]+)?)\s*/,a=Object(c.a)(e);try{for(a.s();!(t=a.n()).done;){var o=t.value;if("preprocessor"===o.type){var s=i.exec(o.data);if(s){var l=s[1].replace(/\s\s+/g," ");if(l===n)return l;if(l===r)return o.data="#version "+n,r;throw new Error("unknown glsl version: "+l)}}}}catch(u){a.e(u)}finally{a.f()}return e.splice(0,0,{type:"preprocessor",data:"#version "+n},{type:"whitespace",data:"\n"}),null}(r,"100","300 es"))throw new Error("shader is already glsl 300 es");for(var n=null,i=null,a={},o={},s=0;s<r.length;++s){var u=r[s];switch(u.type){case"keyword":35633===t&&"attribute"===u.data?u.data="in":"varying"===u.data&&(u.data=35633===t?"out":"in");break;case"builtin":if(/^texture(2D|Cube)(Proj)?(Lod|Grad)?(EXT)?$/.test(u.data.trim())&&(u.data=u.data.replace(/(2D|Cube|EXT)/g,"")),35632===t&&"gl_FragColor"===u.data&&(n||g(r,n=m(r,a,"fragColor"),"vec4"),u.data=n),35632===t&&"gl_FragData"===u.data){var d=j(r,s+1),h=m(r,a,"fragData");O(r,h,"vec4",d,"mediump"),u.data=h}else 35632===t&&"gl_FragDepthEXT"===u.data&&(i||(i=m(r,a,"gl_FragDepth")),u.data=i);break;case"ident":if(l.indexOf(u.data)>=0){if(35633===t&&v(r,s))throw new Error("attribute in vertex shader uses a name that is a reserved word in glsl 300 es");u.data in o||(o[u.data]=m(r,a,u.data)),u.data=o[u.data]}}}for(var f=r.length-1;f>=0;--f){var y=r[f];if("preprocessor"===y.type){var _=y.data.match(/\#extension\s+(.*)\:/);if(_&&_[1]&&b.indexOf(_[1].trim())>=0){var w=r[f+1];r.splice(f,w&&"whitespace"===w.type?2:1)}var x=y.data.match(/\#ifdef\s+(.*)/);x&&x[1]&&b.indexOf(x[1].trim())>=0&&(y.data="#if 1");var k=y.data.match(/\#ifndef\s+(.*)/);k&&k[1]&&b.indexOf(k[1].trim())>=0&&(y.data="#if 0")}}return r.map((function(e){return"eof"!==e.type?e.data:""})).join("")}var w=function(){function e(t,r,i,a){Object(n.a)(this,e),this._context=t,this._locations=a,this._vShader=null,this._fShader=null,this._nameToUniformLocation={},this._nameToUniform1={},this._nameToUniform1v={},this._nameToUniform2={},this._nameToUniform3={},this._nameToUniform4={},this._nameToUniformMatrix3={},this._nameToUniformMatrix4={},t||console.error("RenderingContext isn't initialized!"),0===r.length&&console.error("Shaders source should not be empty!"),this._vShader=k(this._context,35633,r),this._fShader=k(this._context,35632,i),this._vShader&&this._fShader||console.error("Error loading shaders!");var c=this._context.gl,l=c.createProgram();c.attachShader(l,this._vShader),c.attachShader(l,this._fShader),a.forEach((function(e,t){return c.bindAttribLocation(l,e,t)})),c.linkProgram(l),Object(s.c)()&&!c.getProgramParameter(l,c.LINK_STATUS)&&console.error("Could not initialize shader\nVALIDATE_STATUS: "+c.getProgramParameter(l,c.VALIDATE_STATUS)+", gl error ["+c.getError()+"]infoLog: "+c.getProgramInfoLog(l)),this._glName=l,this._context.instanceCounter.increment(o.b.Program,this)}return Object(i.a)(e,[{key:"glName",get:function(){return this._glName}},{key:"dispose",value:function(){var e=this._context.gl;if(this._vShader){var t=this._vShader;e.deleteShader(t),this._vShader=null}if(this._fShader){var r=this._fShader;e.deleteShader(r),this._fShader=null}this._glName&&(e.deleteProgram(this._glName),this._glName=null,this._context.instanceCounter.decrement(o.b.Program,this))}},{key:"_getUniformLocation",value:function(e){return void 0===this._nameToUniformLocation[e]&&(this._nameToUniformLocation[e]=this._context.gl.getUniformLocation(this._glName,e)),this._nameToUniformLocation[e]}},{key:"hasUniform",value:function(e){return null!==this._getUniformLocation(e)}},{key:"setUniform1i",value:function(e,t){var r=this._nameToUniform1[e];void 0!==r&&t===r||(this._context.useProgram(this),this._context.gl.uniform1i(this._getUniformLocation(e),t),this._nameToUniform1[e]=t)}},{key:"setUniform1iv",value:function(e,t){var r=this._nameToUniform1v[e];x(r,t)&&(this._context.useProgram(this),this._context.gl.uniform1iv(this._getUniformLocation(e),t),void 0===r?this._nameToUniform1v[e]=Array.from(t):S(t,r))}},{key:"setUniform2iv",value:function(e,t){var r=this._nameToUniform2[e];x(r,t)&&(this._context.useProgram(this),this._context.gl.uniform2iv(this._getUniformLocation(e),t),void 0===r?this._nameToUniform2[e]=Array.from(t):S(t,r))}},{key:"setUniform3iv",value:function(e,t){var r=this._nameToUniform3[e];x(r,t)&&(this._context.useProgram(this),this._context.gl.uniform3iv(this._getUniformLocation(e),t),void 0===r?this._nameToUniform3[e]=Array.from(t):S(t,r))}},{key:"setUniform4iv",value:function(e,t){var r=this._nameToUniform4[e];x(r,t)&&(this._context.useProgram(this),this._context.gl.uniform4iv(this._getUniformLocation(e),t),void 0===r?this._nameToUniform4[e]=Array.from(t):S(t,r))}},{key:"setUniform1f",value:function(e,t){var r=this._nameToUniform1[e];void 0!==r&&t===r||(this._context.useProgram(this),this._context.gl.uniform1f(this._getUniformLocation(e),t),this._nameToUniform1[e]=t)}},{key:"setUniform1fv",value:function(e,t){var r=this._nameToUniform1v[e];x(r,t)&&(this._context.useProgram(this),this._context.gl.uniform1fv(this._getUniformLocation(e),t),void 0===r?this._nameToUniform1v[e]=Array.from(t):S(t,r))}},{key:"setUniform2f",value:function(e,t,r){var n=this._nameToUniform2[e];void 0!==n&&t===n[0]&&r===n[1]||(this._context.useProgram(this),this._context.gl.uniform2f(this._getUniformLocation(e),t,r),void 0===n?this._nameToUniform2[e]=[t,r]:(n[0]=t,n[1]=r))}},{key:"setUniform2fv",value:function(e,t){var r=this._nameToUniform2[e];x(r,t)&&(this._context.useProgram(this),this._context.gl.uniform2fv(this._getUniformLocation(e),t),void 0===r?this._nameToUniform2[e]=Array.from(t):S(t,r))}},{key:"setUniform3f",value:function(e,t,r,n){var i=this._nameToUniform3[e];void 0!==i&&t===i[0]&&r===i[1]&&n===i[2]||(this._context.useProgram(this),this._context.gl.uniform3f(this._getUniformLocation(e),t,r,n),void 0===i?this._nameToUniform3[e]=[t,r,n]:(i[0]=t,i[1]=r,i[2]=n))}},{key:"setUniform3fv",value:function(e,t){var r=this._nameToUniform3[e];x(r,t)&&(this._context.useProgram(this),this._context.gl.uniform3fv(this._getUniformLocation(e),t),void 0===r?this._nameToUniform3[e]=Array.from(t):S(t,r))}},{key:"setUniform4f",value:function(e,t,r,n,i){var a=this._nameToUniform4[e];void 0!==a&&t===a[0]&&r===a[1]&&n===a[2]&&i===a[3]||(this._context.useProgram(this),this._context.gl.uniform4f(this._getUniformLocation(e),t,r,n,i),void 0===a?this._nameToUniform4[e]=[t,r,n,i]:(a[0]=t,a[1]=r,a[2]=n,a[3]=i))}},{key:"setUniform4fv",value:function(e,t){var r=this._nameToUniform4[e];x(r,t)&&(this._context.useProgram(this),this._context.gl.uniform4fv(this._getUniformLocation(e),t),void 0===r?this._nameToUniform4[e]=Array.from(t):S(t,r))}},{key:"setUniformMatrix3fv",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=this._nameToUniformMatrix3[e];T(n,t)&&(this._context.useProgram(this),this._context.gl.uniformMatrix3fv(this._getUniformLocation(e),r,t),void 0===n?this._nameToUniformMatrix3[e]=Array.from(t):S(t,n))}},{key:"setUniformMatrix4fv",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=this._nameToUniformMatrix4[e];C(n,t)&&(this._context.useProgram(this),this._context.gl.uniformMatrix4fv(this._getUniformLocation(e),r,t),void 0===n?this._nameToUniformMatrix4[e]=Array.from(t):S(t,n))}},{key:"assertCompatibleVertexAttributeLocations",value:function(e){e.locations!==this._locations&&console.error("VertexAttributeLocations are incompatible")}},{key:"stop",value:function(){}}]),e}();function x(e,t){if(Object(a.i)(e)||e.length!==t.length)return!0;for(var r=0;r<e.length;++r)if(e[r]!==t[r])return!0;return!1}function k(e,t,r){var n="webgl2"===e.webglVersion?_(r,t):r,i=e.gl,a=i.createShader(t);return i.shaderSource(a,n),i.compileShader(a),Object(s.c)()&&!i.getShaderParameter(a,i.COMPILE_STATUS)&&(console.error("Compile error in ".concat(35633===t?"vertex":"fragment"," shader")),console.error(i.getShaderInfoLog(a)),console.error(function(e){var t=2;return e.replace(/\n/g,(function(){return"\n"+function(e){return e>=1e3?e.toString():("  "+e).slice(-3)}(t++)+":"}))}(n)),"webgl2"===e.webglVersion&&(console.log("Shader source before transpilation:"),console.log(r))),a}function S(e,t){for(var r=0;r<e.length;++r)t[r]=e[r]}function T(e,t){return!!Object(a.i)(e)||(9!==e.length?x(e,t):9!==e.length||e[0]!==t[0]||e[1]!==t[1]||e[2]!==t[2]||e[3]!==t[3]||e[4]!==t[4]||e[5]!==t[5]||e[6]!==t[6]||e[7]!==t[7]||e[8]!==t[8])}function C(e,t){return!!Object(a.i)(e)||(16!==e.length?x(e,t):16!==e.length||e[0]!==t[0]||e[1]!==t[1]||e[2]!==t[2]||e[3]!==t[3]||e[4]!==t[4]||e[5]!==t[5]||e[6]!==t[6]||e[7]!==t[7]||e[8]!==t[8]||e[9]!==t[9]||e[10]!==t[10]||e[11]!==t[11]||e[12]!==t[12]||e[13]!==t[13]||e[14]!==t[14]||e[15]!==t[15])}},function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var n=r(433);function i(e,t){if(e){if("string"===typeof e)return Object(n.a)(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Object(n.a)(e,t):void 0}}},function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var n=r(2),i=r(5),a=function(){function e(t){Object(n.a)(this,e),this._notify=t,this._accessed=[],this._handles=[],this._invalidCount=0}return Object(i.a)(e,[{key:"destroy",value:function(){this._accessed.length=0,this.clear()}},{key:"onInvalidated",value:function(){this._invalidCount++}},{key:"onCommitted",value:function(){var e=this._invalidCount;if(1===e)return this._invalidCount=0,void this._notify();this._invalidCount=e>0?e-1:0}},{key:"onObservableAccessed",value:function(e){this._accessed.includes(e)||this._accessed.push(e)}},{key:"onTrackingEnd",value:function(){for(var e=this._handles,t=this._accessed,r=0;r<t.length;++r)e.push(t[r].observe(this));t.length=0}},{key:"clear",value:function(){for(var e=this._handles,t=0;t<e.length;++t)e[t].remove();e.length=0}}]),e}()},function(e,t,r){"use strict";r.d(t,"a",(function(){return d})),r.d(t,"b",(function(){return h}));var n=r(101),i=r(22),a=r(15),o=r(164),s=r(114),c=r(298),l=a.a.getLogger("esri.core.accessorSupport.write");function u(e,t,r,a,s,c){if(!a||!a.write)return!1;var u=e.get(r);if(!s&&a.write.overridePolicy){var d=a.write.overridePolicy.call(e,u,r,c);void 0!==d&&(s=d)}if(s||(s=a.write),!s||!1===s.enabled)return!1;if((null===u&&!s.allowNull||void 0===u)&&s.isRequired){var h=new i.a("web-document-write:property-required","Missing value for required property '".concat(r,"' on '").concat(e.declaredClass,"'"),{propertyName:r,target:e});return h&&c&&c.messages?c.messages.push(h):h&&!c&&l.error(h.name,h.message),!1}return void 0!==u&&(!(null===u&&!s.allowNull)&&(!function(e,t,r,i,a){var o=i.default;if(void 0===o)return!1;if(null!=i.defaultEquals)return i.defaultEquals(a);if("function"==typeof o){if(Array.isArray(a)){var s=o.call(e,t,r);return Object(n.e)(s,a)}return!1}return o===a}(e,r,c,a,u)&&(void 0!==a.default||!(!s.ignoreOrigin&&c&&c.origin&&t.store.originOf(r)<Object(o.d)(c.origin)))))}function d(e,t,r,n){var i=Object(s.a)(e),a=i.metadatas,o=Object(c.d)(a[t],n);return!!o&&u(e,i,t,o,r,n)}function h(e,t,r){if(e&&"function"==typeof e.toJSON&&(!e.toJSON.isDefaultToJSON||!e.write))return Object(s.c)(t,e.toJSON());var n=Object(s.a)(e),i=n.metadatas,a=function(a){var l=Object(c.d)(i[a],r);if(!u(e,n,a,l,void 0,r))return"continue";var f=e.get(a),p=function(e,t,r,n,i){var a,o,s={};return null==(a=t.write)||null==(o=a.writer)||o.call(e,n,s,r,i),s}(e,l,l.write&&"string"==typeof l.write.target?l.write.target:a,f,r);Object.keys(p).length>0&&(t=Object(s.c)(t,p),null!=r&&null!=(d=r.resources)&&null!=(h=d.pendingOperations)&&h.length&&Promise.all(r.resources.pendingOperations).then((function(){return Object(s.c)(t,p)})),r&&r.writtenProperties&&r.writtenProperties.push({target:e,propName:a,oldOrigin:Object(o.c)(n.store.originOf(a)),newOrigin:r.origin}))};for(var l in i){var d,h;a(l)}return t}},function(e,t,r){"use strict";var n=r(2),i=r(5),a=r(6),o=r(7),s=r(0),c=r(1),l=(r(17),r(18),r(15),r(10)),u=r(166),d=function(e){Object(a.a)(r,e);var t=Object(o.a)(r);function r(e){var i;return Object(n.a)(this,r),(i=t.call(this,e)).outline=null,i.type=null,i}return Object(i.a)(r,[{key:"hash",value:function(){return"".concat(this.type,".").concat(this.outline&&this.outline.hash())}}]),r}(r(135).a);Object(s.a)([Object(c.b)({types:{key:"type",base:null,defaultKeyValue:"simple-line",typeMap:{"simple-line":u.a}},json:{default:null,write:!0}})],d.prototype,"outline",void 0),Object(s.a)([Object(c.b)({type:["simple-fill","picture-fill"],readOnly:!0})],d.prototype,"type",void 0);var h=d=Object(s.a)([Object(l.a)("esri.symbols.FillSymbol")],d);t.a=h},function(e,t,r){"use strict";r.d(t,"b",(function(){return m}));var n,i=r(2),a=r(5),o=r(6),s=r(7),c=r(0),l=r(58),u=r(27),d=r(1),h=(r(17),r(18),r(15),r(52)),f=r(10),p=r(130),b=Object(l.b)()({sphere:"sphere",cylinder:"cylinder",cube:"cube",cone:"cone",diamond:"diamond",tetrahedron:"tetrahedron",invertedCone:"inverted-cone"}),v=n=function(e){Object(o.a)(r,e);var t=Object(s.a)(r);function r(){return Object(i.a)(this,r),t.apply(this,arguments)}return Object(a.a)(r,[{key:"clone",value:function(){return new n({href:this.href,primitive:this.primitive})}}]),r}(u.a);Object(c.a)([Object(d.b)({type:String,json:{read:p.d,write:p.f}})],v.prototype,"href",void 0),Object(c.a)([Object(h.a)(b)],v.prototype,"primitive",void 0),v=n=Object(c.a)([Object(f.a)("esri.symbols.support.ObjectSymbol3DLayerResource")],v);var m="sphere",y=v;t.a=y},function(e,t,r){"use strict";var n,i=r(2),a=r(5),o=r(6),s=r(7),c=r(0),l=r(27),u=r(1),d=(r(17),r(18),r(15),r(10)),h=r(131),f=n=function(e){Object(o.a)(r,e);var t=Object(s.a)(r);function r(){var e;return Object(i.a)(this,r),(e=t.apply(this,arguments)).screenLength=0,e.minWorldLength=0,e}return Object(a.a)(r,[{key:"clone",value:function(){return new n({screenLength:this.screenLength,minWorldLength:this.minWorldLength,maxWorldLength:this.maxWorldLength})}}]),r}(l.a);Object(c.a)([Object(u.b)(h.b)],f.prototype,"screenLength",void 0),Object(c.a)([Object(u.b)({type:Number,json:{write:!0,default:0}})],f.prototype,"minWorldLength",void 0),Object(c.a)([Object(u.b)({type:Number,json:{write:!0}})],f.prototype,"maxWorldLength",void 0);var p=f=n=Object(c.a)([Object(d.a)("esri.symbols.support.Symbol3DVerticalOffset")],f);t.a=p},function(e,t,r){"use strict";var n=r(2),i=r(5),a=r(6),o=r(7),s=r(0),c=r(28),l=r(1),u=(r(17),r(18),r(15),r(10)),d=function(e){Object(a.a)(r,e);var t=Object(o.a)(r);function r(e){var i;return Object(n.a)(this,r),(i=t.call(this,e)).angle=0,i.type=null,i.xoffset=0,i.yoffset=0,i.size=9,i}return Object(i.a)(r,[{key:"hash",value:function(){return"".concat(this.type,".").concat(this.angle,".").concat(this.size,".").concat(this.xoffset,".").concat(this.yoffset)}}]),r}(r(135).a);Object(s.a)([Object(l.b)({type:Number,json:{read:function(e){return e&&-1*e},write:function(e,t){return t.angle=e&&-1*e}}})],d.prototype,"angle",void 0),Object(s.a)([Object(l.b)({type:["simple-marker","picture-marker"],readOnly:!0})],d.prototype,"type",void 0),Object(s.a)([Object(l.b)({type:Number,cast:c.j,json:{write:!0}})],d.prototype,"xoffset",void 0),Object(s.a)([Object(l.b)({type:Number,cast:c.j,json:{write:!0}})],d.prototype,"yoffset",void 0),Object(s.a)([Object(l.b)({type:Number,cast:function(e){return"auto"===e?e:Object(c.j)(e)},json:{write:!0}})],d.prototype,"size",void 0);var h=d=Object(s.a)([Object(u.a)("esri.symbols.MarkerSymbol")],d);t.a=h},function(e,t,r){"use strict";r.d(t,"a",(function(){return s}));var n,i,a=r(12),o=r(11);function s(e){e.vertex.code.add(Object(o.a)(n||(n=Object(a.a)(["const float PI = 3.141592653589793;"])))),e.fragment.code.add(Object(o.a)(i||(i=Object(a.a)(["const float PI = 3.141592653589793;\nconst float LIGHT_NORMALIZATION = 1.0 / PI;\nconst float INV_PI = 0.3183098861837907;\nconst float HALF_PI = 1.570796326794897;"]))))}},function(e,t,r){"use strict";r.d(t,"a",(function(){return d}));var n,i,a,o,s,c=r(12),l=r(11),u=r(326);function d(e,t){var r=e.vertex;switch(e.include(u.a,t),e.attributes.add("sideness","vec2"),2===t.mode?r.code.add(Object(l.a)(n||(n=Object(c.a)(["struct UnpackedAttributes {\nvec2 sideness;\nvec2 sidenessNorm;\nfloat lineWidthPixels;\nfloat extensionLengthPixels;\nfloat type;\n};"])))):r.code.add(Object(l.a)(i||(i=Object(c.a)(["struct UnpackedAttributes {\nvec2 sideness;\nvec2 sidenessNorm;\nfloat lineWidthPixels;\nfloat extensionLengthPixels;\n};"])))),t.mode){case 2:r.code.add(Object(l.a)(a||(a=Object(c.a)(["UnpackedAttributes unpackAttributes(ComponentData component) {\nvec2 sidenessNorm = sideness;\nvec2 sideness = sidenessNorm * 2.0 - 1.0;\nfloat fType = component.type;\nfloat extensionLengthPixels = component.extensionLength;\nfloat lineWidth = component.lineWidth;\nif (fType <= 0.0) {\nextensionLengthPixels *= variantExtension * 2.0 - 1.0;\n}\nreturn UnpackedAttributes(sideness, sidenessNorm, lineWidth, extensionLengthPixels, fType);\n}"]))));break;case 1:r.code.add(Object(l.a)(o||(o=Object(c.a)(["UnpackedAttributes unpackAttributes(ComponentData component) {\nvec2 sidenessNorm = sideness;\nvec2 sideness = sidenessNorm * 2.0 - 1.0;\nfloat extensionLengthPixels = component.extensionLength;\nextensionLengthPixels *= variantExtension * 2.0 - 1.0;\nfloat lineWidth = component.lineWidth;\nreturn UnpackedAttributes(sideness, sidenessNorm, lineWidth, extensionLengthPixels);\n}"]))));break;case 0:r.code.add(Object(l.a)(s||(s=Object(c.a)(["UnpackedAttributes unpackAttributes(ComponentData component) {\nvec2 sidenessNorm = sideness;\nvec2 sideness = sidenessNorm * 2.0 - 1.0;\nfloat extensionLengthPixels = component.extensionLength;\nfloat lineWidth = component.lineWidth;\nreturn UnpackedAttributes(sideness, sidenessNorm, lineWidth, extensionLengthPixels);\n}"]))))}}},function(e,t,r){"use strict";function n(e,t){return(n=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}r.d(t,"a",(function(){return n}))},function(e,t,r){"use strict";r.d(t,"a",(function(){return h})),r.d(t,"b",(function(){return f}));var n=r(14),i=r(13),a=r(200),o=r(114),s=r(298);function c(e,t,r){if(!e||!e.read||!1===e.read.enabled||!e.read.source)return!1;var n=e.read.source;if("string"==typeof n){if(n===t)return!0;if(n.indexOf(".")>-1&&0===n.indexOf(t)&&Object(a.a)(n,r))return!0}else{var o,s=Object(i.a)(n);try{for(s.s();!(o=s.n()).done;){var c=o.value;if(c===t)return!0;if(c.indexOf(".")>-1&&0===c.indexOf(t)&&Object(a.a)(c,r))return!0}}catch(l){s.e(l)}finally{s.f()}}return!1}function l(e,t,r,n,a){var o=Object(s.c)(t[r],a);(function(e){return e&&(!e.read||!1!==e.read.enabled&&!e.read.source)})(o)&&(e[r]=!0);var l,u=Object(i.a)(Object.getOwnPropertyNames(t));try{for(u.s();!(l=u.n()).done;){var d=l.value;c(o=Object(s.c)(t[d],a),r,n)&&(e[d]=!0)}}catch(h){u.e(h)}finally{u.f()}}function u(e,t,r,n){var i=r.metadatas,a=Object(s.b)(i[t],"any",n),o=a&&a.default;if(void 0!==o){var c="function"==typeof o?o.call(e,t,n):o;void 0!==c&&r.set(t,c)}}var d={origin:"service"};function h(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:d;if(t&&"object"==typeof t){var n,c=Object(o.a)(e),h=c.metadatas,f={},p=Object(i.a)(Object.getOwnPropertyNames(t));try{for(p.s();!(n=p.n()).done;){var b=n.value;l(f,h,b,t,r)}}catch(k){p.e(k)}finally{p.f()}c.setDefaultOrigin(r.origin);var v,m=Object(i.a)(Object.getOwnPropertyNames(f));try{for(m.s();!(v=m.n()).done;){var y=v.value,g=Object(s.c)(h[y],r).read,O=g&&g.source,j=void 0;j=O&&"string"==typeof O?Object(a.c)(t,O):t[y],g&&g.reader&&(j=g.reader.call(e,j,t,r)),void 0!==j&&c.set(y,j)}}catch(k){m.e(k)}finally{m.f()}if(!r||!r.ignoreDefaults){var _,w=Object(i.a)(Object.getOwnPropertyNames(h));try{for(w.s();!(_=w.n()).done;){var x=_.value;f[x]||u(e,x,c,r)}}catch(k){w.e(k)}finally{w.f()}}c.setDefaultOrigin("user")}}function f(e,t,r){var i,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:d,o=Object(n.a)(Object(n.a)({},a),{},{messages:[]});r(o),null==(i=o.messages)||i.forEach((function(t){"warning"!==t.type||e.loaded?a&&a.messages&&a.messages.push(t):e.loadWarnings.push(t)}))}},function(e,t,r){"use strict";var n=r(2),i=r(6),a=r(7),o=r(0),s=r(27),c=r(1),l=(r(17),r(18),r(15),r(10)),u=function(e){Object(i.a)(r,e);var t=Object(a.a)(r);function r(e){var i;return Object(n.a)(this,r),(i=t.call(this,e)).altText=null,i.caption="",i.title="",i.type=null,i}return r}(s.a);Object(o.a)([Object(c.b)({type:String,json:{write:!0}})],u.prototype,"altText",void 0),Object(o.a)([Object(c.b)({type:String,json:{write:!0}})],u.prototype,"caption",void 0),Object(o.a)([Object(c.b)({type:String,json:{write:!0}})],u.prototype,"title",void 0),Object(o.a)([Object(c.b)({type:["image","bar-chart","column-chart","line-chart","pie-chart"],readOnly:!0,json:{read:!1,write:!0}})],u.prototype,"type",void 0);var d=u=Object(o.a)([Object(l.a)("esri.popup.content.mixins.MediaInfo")],u);t.a=d},function(e,t,r){"use strict";var n=r(2),i=r(6),a=r(7),o=r(0),s=r(27),c=r(1),l=(r(17),r(18),r(15),r(10)),u=function(e){Object(i.a)(r,e);var t=Object(a.a)(r);function r(e){var i;return Object(n.a)(this,r),(i=t.call(this,e)).type=null,i}return r}(s.a);Object(o.a)([Object(c.b)({readOnly:!0,json:{read:!1,write:!0}})],u.prototype,"type",void 0);var d=u=Object(o.a)([Object(l.a)("esri.rest.support.ColorRamp")],u);t.a=d},function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r(2),i=r(5),a=r(23),o=function(){function e(t){Object(n.a)(this,e),this.schedule=t,this._abortController=null,this._loadStatus=0,this._loadError=null,this._loader=null,this.logger=null}return Object(i.a)(e,[{key:"loadStatus",get:function(){return this._loadStatus}},{key:"load",value:function(e,t){var r=this;return 1===this._loadStatus?(e&&e(),this._loader):2===this._loadStatus?(t&&t(this._loadError),this._loader):(this._loader||(this._abortController=Object(a.e)(),this._loader=this.doLoad(this._abortController.signal).then((function(){r._abortController=null,r._loadStatus=1}),(function(e){throw r._loadError=e,r._abortController=null,r._loadStatus=2,!Object(a.n)(e)&&r.logger&&e.message&&r.logger.warn(e.message),e}))),this._loader.then(e,t).catch((function(){})),this._loader)}},{key:"abortLoad",value:function(){this._abortController?(this._abortController.abort(),this._abortController=null):0===this._loadStatus&&(this._loadStatus=2),this._loader=null}}]),e}()},function(e,t,r){"use strict";r.d(t,"a",(function(){return c})),r.d(t,"b",(function(){return s}));var n=r(13),i=r(282),a=r(235),o=r(522);function s(e){var t,r=c(e.rings,e.hasZ,1),a=[],s=0,l=0,u=Object(n.a)(r.polygons);try{var d=function(){var e=t.value,n=e.count,o=e.index,c=new Float64Array(r.position.buffer,3*o*r.position.BYTES_PER_ELEMENT,3*n),u=e.holeIndices.map((function(e){return e-o})),d=new Uint32Array(Object(i.a)(c,u,3));a.push({position:c,faces:d}),s+=c.length,l+=d.length};for(u.s();!(t=u.n()).done;)d()}catch(p){u.e(p)}finally{u.f()}var h=function(e,t,r){if(1===e.length)return e[0];var i,a=new Float64Array(t),o=new Uint32Array(r),s=0,c=0,l=0,u=Object(n.a)(e);try{for(u.s();!(i=u.n()).done;){for(var d=i.value,h=0;h<d.position.length;h++)a[s++]=d.position[h];for(var f=0;f<d.faces.length;f++)o[c++]=d.faces[f]+l;l=s/3}}catch(p){u.e(p)}finally{u.f()}return{position:a,faces:o}}(a,s,l),f=Object(o.a)(h.position.buffer,6,{originalIndices:h.faces});return h.position=new Float64Array(f.buffer),h.faces=f.indices,h}function c(e,t,r){for(var n=e.length,i=new Array(n),a=new Array(n),o=new Array(n),s=0,c=0,d=0,h=0,f=0;f<n;++f)h+=e[f].length;for(var p=new Float64Array(3*h),b=0,v=n-1;v>=0;v--){var m=e[v],y=1===r&&u(m);if(y&&1!==n)i[s++]=m;else{for(var g=m.length,O=0;O<s;++O)g+=i[O].length;var j={index:b,pathLengths:new Array(s+1),count:g,holeIndices:new Array(s)};j.pathLengths[0]=m.length,m.length>0&&(o[d++]={index:b,count:m.length}),b=y?l(m,m.length-1,-1,p,b,m.length,t):l(m,0,1,p,b,m.length,t);for(var _=0;_<s;++_){var w=i[_];j.holeIndices[_]=b,j.pathLengths[_+1]=w.length,w.length>0&&(o[d++]={index:b,count:w.length}),b=l(w,0,1,p,b,w.length,t)}s=0,j.count>0&&(a[c++]=j)}}for(var x=0;x<s;++x){var k=i[x];k.length>0&&(o[d++]={index:b,count:k.length}),b=l(k,0,1,p,b,k.length,t)}return c<n&&(a.length=c),d<n&&(o.length=d),{position:p,polygons:a,outlines:o}}function l(e,t,r,n,i,a,o){i*=3;for(var s=0;s<a;++s){var c=e[t];n[i++]=c[0],n[i++]=c[1],n[i++]=o?c[2]:0,t+=r}return i/3}function u(e){return!Object(a.e)(e,!1,!1)}},function(e,t,r){"use strict";r.d(t,"a",(function(){return o})),r.d(t,"b",(function(){return c}));var n=r(2),i=r(5),a=r(74),o=function(){function e(){Object(n.a)(this,e),this.adds=new a.a,this.removes=new a.a,this.updates=new a.a({allocator:function(e){return e||new s},deallocator:function(e){return e.renderGeometry=null,e}})}return Object(i.a)(e,[{key:"clear",value:function(){this.adds.clear(),this.removes.clear(),this.updates.clear()}},{key:"prune",value:function(){this.adds.prune(),this.removes.prune(),this.updates.prune()}}]),e}(),s=function e(){Object(n.a)(this,e)},c=function e(){Object(n.a)(this,e),this.adds=new Array,this.removes=new Array,this.updates=new Array}},function(e,t,r){"use strict";r.d(t,"a",(function(){return u}));var n,i,a,o=r(12),s=r(245),c=r(532),l=r(11);function u(e,t){e.include(s.a,t),e.fragment.code.add(Object(l.a)(n||(n=Object(o.a)(["\n  struct TextureLookupParameter {\n    vec2 uv;\n    ","\n  } vtc;\n  "])),t.supportsTextureAtlas?"vec2 size;":"")),1===t.attributeTextureCoordinates&&e.fragment.code.add(Object(l.a)(i||(i=Object(o.a)(["vec4 textureLookup(sampler2D tex, TextureLookupParameter params) {\nreturn texture2D(tex, params.uv);\n}"])))),2===t.attributeTextureCoordinates&&(e.include(c.a),e.fragment.code.add(Object(l.a)(a||(a=Object(o.a)(["vec4 textureLookup(sampler2D tex, TextureLookupParameter params) {\nreturn textureAtlasLookup(tex, params.size, params.uv, vuvRegion);\n}"])))))}},function(e,t,r){"use strict";function n(e,t){var r=e.count;t||(t=new e.TypedArrayConstructor(r));for(var n=0;n<r;n++)t[n]=e.get(n);return t}r.d(t,"a",(function(){return n}));Object.freeze({__proto__:null,copy:function(e,t,r){for(var n=e.typedBuffer,i=e.typedBufferStride,a=t.typedBuffer,o=t.typedBufferStride,s=r?r.count:t.count,c=(r&&r.dstIndex?r.dstIndex:0)*i,l=(r&&r.srcIndex?r.srcIndex:0)*o,u=0;u<s;++u)n[c]=a[l],c+=i,l+=o},makeDense:n})},function(e,t,r){"use strict";r.d(t,"a",(function(){return s}));var n=r(33),i=r(2),a=r(5),o=r(22),s=function(){function e(t,r){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";Object(i.a)(this,e),this.major=t,this.minor=r,this._context=n}return Object(a.a)(e,[{key:"lessThan",value:function(e,t){return this.major<e||e===this.major&&this.minor<t}},{key:"since",value:function(e,t){return!this.lessThan(e,t)}},{key:"validate",value:function(e){if(this.major!==e.major){var t=this._context&&this._context+":",r=this._context&&this._context+" ";throw new o.a(t+"unsupported-version","Required major ".concat(r,"version is '").concat(this.major,"', but got '${version.major}.${version.minor}'"),{version:e})}}},{key:"clone",value:function(){return new e(this.major,this.minor,this._context)}}],[{key:"parse",value:function(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",i=t.split("."),a=Object(n.a)(i,2),s=a[0],c=a[1],l=/^\s*\d+\s*$/;if(!s||!s.match||!s.match(l))throw new o.a((r&&r+":")+"invalid-version","Expected major version to be a number, but got '${version}'",{version:t});if(!c||!c.match||!c.match(l))throw new o.a((r&&r+":")+"invalid-version","Expected minor version to be a number, but got '${version}'",{version:t});var u=parseInt(s,10),d=parseInt(c,10);return new e(u,d,r)}}]),e}()},function(e,t,r){"use strict";r.r(t);var n,i=r(8),a=r.n(i),o=r(16),s=r(14),c=r(13),l=r(2),u=r(5),d=r(19),h=r(45),f=r(42),p=r(6),b=r(7),v=r(0),m=r(53),y=r(207),g=r(27),O=r(25),j=r(180),_=r(460),w=r(15),x=r(3),k=r(23),S=r(39),T=r(1),C=(r(18),r(17),r(10)),M=r(44),P=r(55),A=r(149),E=r(418),R=r(339),I=r(558),D=0,F=w.a.getLogger("esri.Basemap"),L=n=function(e){Object(p.a)(i,e);var t=Object(b.a)(i);function i(e){var r;Object(l.a)(this,i),(r=t.call(this,e)).id=null,r.portalItem=null,r.spatialReference=null,r.thumbnailUrl=null,r.title="Basemap",r.id=Date.now().toString(16)+"-basemap-"+D++,r.baseLayers=new m.a,r.referenceLayers=new m.a;var n=function(e){e.parent&&e.parent!==Object(d.a)(r)&&"remove"in e.parent&&e.parent.remove(e),e.parent=Object(d.a)(r),"elevation"===e.type&&F.error("Layer '".concat(e.title,", id:").concat(e.id,"' of type '").concat(e.type,"' is not supported as a basemap layer and will therefore be ignored."))},a=function(e){e.parent=null};return r.baseLayers.on("after-add",(function(e){return n(e.item)})),r.referenceLayers.on("after-add",(function(e){return n(e.item)})),r.baseLayers.on("after-remove",(function(e){return a(e.item)})),r.referenceLayers.on("after-remove",(function(e){return a(e.item)})),r}return Object(u.a)(i,[{key:"initialize",value:function(){var e=this;this.when().catch((function(t){F.error("#load()","Failed to load basemap (title: '".concat(e.title,"', id: '").concat(e.id,"')"),t)})),this.resourceInfo&&this.read(this.resourceInfo.data,this.resourceInfo.context)}},{key:"destroy",value:function(){var e,t,r=this.baseLayers.removeAll(),n=Object(c.a)(r);try{for(n.s();!(t=n.n()).done;){t.value.destroy()}}catch(s){n.e(s)}finally{n.f()}var i,a=this.referenceLayers.removeAll(),o=Object(c.a)(a);try{for(o.s();!(i=o.n()).done;){i.value.destroy()}}catch(s){o.e(s)}finally{o.f()}this.baseLayers.destroy(),this.referenceLayers.destroy(),null==(e=this.portalItem)||e.destroy(),this.portalItem=null}},{key:"normalizeCtorArgs",value:function(e){return e&&"resourceInfo"in e&&(this._set("resourceInfo",e.resourceInfo),delete(e=Object(s.a)({},e)).resourceInfo),e}},{key:"baseLayers",set:function(e){this._set("baseLayers",Object(y.b)(e,this._get("baseLayers")))}},{key:"_writeBaseLayers",value:function(e,t,r){var n=[];e?(r=Object(s.a)(Object(s.a)({},r),{},{layerContainerType:"basemap"}),this.baseLayers.forEach((function(e){var t=Object(I.a)(e,r.webmap?r.webmap.getLayerJSONFromResourceInfo(e):null,r);Object(x.j)(t)&&n.push(t)})),this.referenceLayers.forEach((function(e){var t=Object(I.a)(e,r.webmap?r.webmap.getLayerJSONFromResourceInfo(e):null,r);Object(x.j)(t)&&(t.isReference=!0,n.push(t))})),t.baseMapLayers=n):t.baseMapLayers=n}},{key:"referenceLayers",set:function(e){this._set("referenceLayers",Object(y.b)(e,this._get("referenceLayers")))}},{key:"writeTitle",value:function(e,t){t.title=e||"Basemap"}},{key:"load",value:function(e){return this.addResolvingPromise(this._loadFromSource(e)),Promise.resolve(this)}},{key:"loadAll",value:function(){var e=this;return Object(_.a)(this,(function(t){t(e.baseLayers,e.referenceLayers)}))}},{key:"clone",value:function(){var e={id:this.id,title:this.title,portalItem:this.portalItem,baseLayers:this.baseLayers.slice(),referenceLayers:this.referenceLayers.slice()};return this.loaded&&(e.loadStatus="loaded"),new n({resourceInfo:this.resourceInfo}).set(e)}},{key:"read",value:function(e,t){this.resourceInfo||this._set("resourceInfo",{data:e,context:t}),Object(h.a)(Object(f.a)(i.prototype),"read",this).call(this,e,t)}},{key:"write",value:function(e,t){return e=e||{},t&&t.origin||(t=Object(s.a)({origin:"web-map"},t)),Object(h.a)(Object(f.a)(i.prototype),"write",this).call(this,e,t),!this.loaded&&this.resourceInfo&&this.resourceInfo.data.baseMapLayers&&(e.baseMapLayers=this.resourceInfo.data.baseMapLayers.map((function(e){var t=Object(O.a)(e);return t.url&&Object(S.w)(t.url)&&(t.url="https:".concat(t.url)),t.templateUrl&&Object(S.w)(t.templateUrl)&&(t.templateUrl="https:".concat(t.templateUrl)),t}))),e}},{key:"_loadFromSource",value:function(){var e=Object(o.a)(a.a.mark((function e(t){var r,n,i,o,s,c=this;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=this.resourceInfo,n=this.portalItem,Object(k.x)(t),i=[],r?(o=r.context?r.context.url:null,i.push(this._loadLayersFromJSON(r.data,o,t)),r.data.id&&!r.data.title&&(s=r.data.id,i.push(Object(R.b)(s).then((function(e){e&&c.read({title:e},r.context)}))))):n&&i.push(this._loadFromItem(n,t)),e.next=6,Promise.all(i);case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_loadLayersFromJSON",value:function(){var e=Object(o.a)(a.a.mark((function e(t,n,i){var o,s,c,l,u,d,h,f,p;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=this.resourceInfo&&this.resourceInfo.context,s=this.portalItem&&this.portalItem.portal||o&&o.portal||null,c=o&&"web-scene"===o.origin?"web-scene":"web-map",e.next=5,Promise.all([r.e(10),r.e(33)]).then(r.bind(null,710));case 5:return l=e.sent,u=l.populateOperationalLayers,d=[],Object(k.x)(i),t.baseMapLayers&&Array.isArray(t.baseMapLayers)&&(h={context:{origin:c,url:n,portal:s,layerContainerType:"basemap"},defaultLayerType:"DefaultTileLayer"},f=u(this.baseLayers,t.baseMapLayers.filter((function(e){return!e.isReference})),h),d.push(f),p=u(this.referenceLayers,t.baseMapLayers.filter((function(e){return e.isReference})),h),d.push(p)),e.next=11,Object(k.k)(d);case 11:case"end":return e.stop()}}),e,this)})));return function(t,r,n){return e.apply(this,arguments)}}()},{key:"_loadFromItem",value:function(){var e=Object(o.a)(a.a.mark((function e(t,r){var n,i,o;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.load(r);case 2:return n=e.sent,e.next=5,n.fetchData("json",r);case 5:return i=e.sent,o=Object(S.K)(t.itemUrl),e.abrupt("return",(this._set("resourceInfo",{data:i.baseMap,context:{origin:"web-map",portal:t.portal||A.a.getDefault(),url:o}}),this.read(this.resourceInfo.data,this.resourceInfo.context),this.read({spatialReference:i.spatialReference},this.resourceInfo.context),this.read({title:t.title,thumbnailUrl:t.thumbnailUrl},{origin:"portal-item",portal:t.portal||A.a.getDefault(),url:o}),this._loadLayersFromJSON(this.resourceInfo.data,o,r)));case 8:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()}],[{key:"fromId",value:function(e){var t=R.a[e];return t?n.fromJSON(t):null}}]),i}(Object(g.b)(j.a));Object(v.a)([Object(T.b)({json:{write:{ignoreOrigin:!0,target:"baseMapLayers",writer:function(e,t,r,n){this._writeBaseLayers(e,t,n)}},origins:{"web-scene":{write:{ignoreOrigin:!0,target:{baseMapLayers:{type:m.a}},writer:function(e,t,r,n){this._writeBaseLayers(e,t,n)}}}}}})],L.prototype,"baseLayers",null),Object(v.a)([Object(T.b)({type:String,json:{origins:{"web-scene":{write:!0}}}})],L.prototype,"id",void 0),Object(v.a)([Object(T.b)({type:E.default})],L.prototype,"portalItem",void 0),Object(v.a)([Object(T.b)()],L.prototype,"referenceLayers",null),Object(v.a)([Object(T.b)({readOnly:!0})],L.prototype,"resourceInfo",void 0),Object(v.a)([Object(T.b)({type:P.a})],L.prototype,"spatialReference",void 0),Object(v.a)([Object(T.b)()],L.prototype,"thumbnailUrl",void 0),Object(v.a)([Object(T.b)({type:String,json:{origins:{"web-scene":{write:{isRequired:!0}}}}})],L.prototype,"title",void 0),Object(v.a)([Object(M.a)("title")],L.prototype,"writeTitle",null);var z=L=n=Object(v.a)([Object(C.a)("esri.Basemap")],L);t.default=z},function(e,t,r){"use strict";r.d(t,"a",(function(){return s})),r.d(t,"b",(function(){return o}));var n=r(39),i=r(130);function a(e,t){return function(e){return e&&("service"===e.origin||"portal-item"===e.origin)&&e.layer&&("feature"===e.layer.type||"stream"===e.layer.type)}(t)&&!Object(n.s)(e)&&t.layer.parsedUrl?Object(n.z)(t.layer.parsedUrl.path,"images",e):Object(i.a)(e,t)}var o={json:{read:{source:["imageData","url"],reader:function(e,t,r){return t.imageData?Object(n.B)({mediaType:t.contentType||"image/png",isBase64:!0,data:t.imageData}):a(t.url,r)}},write:{writer:function(e,t,r,a){!function(e,t,r,a){if(Object(n.u)(e)){var o=Object(n.i)(e);t.contentType=o.mediaType,t.imageData=o.data,r&&r.imageData===t.imageData&&r.url&&Object(i.f)(r.url,t,"url",a)}else Object(i.f)(e,t,"url",a)}(e,t,this.source,a)}}}},s={readOnly:!0,json:{read:{source:["imageData","url"],reader:function(e,t,r){var n={};return t.imageData&&(n.imageData=t.imageData),t.contentType&&(n.contentType=t.contentType),t.url&&(n.url=a(t.url,r)),n}}}}},function(e,t,r){"use strict";r.d(t,"a",(function(){return a})),r.d(t,"b",(function(){return d})),r.d(t,"c",(function(){return s}));var n=r(14),i=r(191),a=Symbol("widget"),o=new WeakMap;function s(e,t){var r=t.vnodeSelector;if(d(r)){var i=t.properties||{},a=i.key||r;return{vnodeSelector:"div",properties:{parentWidget:e,widgetConstructor:r,key:a,widgetProps:Object(n.a)(Object(n.a)({},i),{},{key:a}),afterCreate:c,afterUpdate:l,afterRemoved:u},children:void 0,text:void 0,domNode:null}}var o=t.children;if(o)for(var h=0;h<o.length;++h)o[h]=s(e,o[h]);return t}function c(e,t,r,a){var s=a.parentWidget,c=a.widgetConstructor,l=a.widgetProps,d=new c(Object(n.a)(Object(n.a)({},l),{},{container:e}));o.set(e,d),null==d.afterCreate||d.afterCreate(d,e),s._internalHandles.add(Object(i.b)((function(){return u(e)})))}function l(e,t,r,n){var i=n.widgetProps,a=o.get(e);a&&(a.set(i),null==a.afterUpdate||a.afterUpdate(a,e))}function u(e){var t=o.get(e);t&&(t.destroy(),o.delete(e))}function d(e){return"function"==typeof e&&e[a]}},function(e,t,r){"use strict";r.d(t,"a",(function(){return a})),r.d(t,"b",(function(){return i}));var n=r(71);function i(e){return e=e||n.a.location.hostname,u.some((function(t){var r;return null!=(null==(r=e)?void 0:r.match(t))}))}function a(e,t){return e&&(t=t||n.a.location.hostname)?null!=t.match(o)||null!=t.match(c)?e.replace("static.arcgis.com","staticdev.arcgis.com"):null!=t.match(s)||null!=t.match(l)?e.replace("static.arcgis.com","staticqa.arcgis.com"):e:e}var o=/^devext.arcgis.com$/,s=/^qaext.arcgis.com$/,c=/^[\w-]*\.mapsdevext.arcgis.com$/,l=/^[\w-]*\.mapsqa.arcgis.com$/,u=[/^([\w-]*\.)?[\w-]*\.zrh-dev-local.esri.com$/,o,s,/^jsapps.esri.com$/,c,l]},function(e,t,r){"use strict";r.d(t,"a",(function(){return u})),r.d(t,"b",(function(){return p})),r.d(t,"c",(function(){return s}));r(17);var n=r(22),i=r(3),a=r(260),o=r(255);function s(e,t,r){var i,o=u(e),s=t,l=c(o,s,r),d=null;if(o){var h=a.a.deriveUnitFromSR(o,e.spatialReference).heightUnit;r||h===o.heightUnit||(d=new n.a("layerview:unmatched-height-unit","The vertical units of the layer must match the horizontal units (".concat(h,")"),{horizontalUnit:h}))}if(!("heightModelInfo"in(i=e)&&null!=i.heightModelInfo||null!=i.spatialReference)&&f(i)||4===l||d)return new n.a("layerview:unsupported-height-model-info","The vertical coordinate system of the layer is not supported",{heightModelInfo:o,error:d});var p=null;switch(l){case 1:var b=o.heightUnit||"unknown",v=s.heightUnit||"unknown";p=new n.a("layerview:incompatible-height-unit","The vertical units of the layer (".concat(b,") must match the vertical units of the scene (").concat(v,")"),{layerUnit:b,sceneUnit:v});break;case 2:var m=o.heightModel||"unknown",y=s.heightModel||"unknown";p=new n.a("layerview:incompatible-height-model","The height model of the layer (".concat(m,") must match the height model of the scene (").concat(y,")"),{layerHeightModel:m,sceneHeightModel:y});break;case 3:var g=o.vertCRS||"unknown",O=s.vertCRS||"unknown";p=new n.a("layerview:incompatible-vertical-datum","The vertical datum of the layer (".concat(g,") must match the vertical datum of the scene (").concat(O,")"),{layerDatum:g,sceneDatum:O})}return p?new n.a("layerview:incompatible-height-model-info","The vertical coordinate system of the layer is incompatible with the scene",{layerHeightModelInfo:o,sceneHeightModelInfo:s,error:p}):null}function c(e,t,r){if(!l(e)||!l(t))return 4;if(null==e||null==t)return 0;if(!r&&e.heightUnit!==t.heightUnit)return 1;if(e.heightModel!==t.heightModel)return 2;switch(e.heightModel){case"gravity-related-height":return 0;case"ellipsoidal":return e.vertCRS===t.vertCRS?0:3;default:return 4}}function l(e){return null==e||null!=e.heightModel&&null!=e.heightUnit}function u(e){var t=e.url&&Object(o.e)(e.url);return null==(e.spatialReference&&e.spatialReference.vcsWkid)&&Object(i.j)(t)&&"ImageServer"===t.serverType||!d(e)||!e.heightModelInfo?f(e)?a.a.deriveUnitFromSR(v,e.spatialReference):null:e.heightModelInfo}function d(e){return"heightModelInfo"in e}function h(e){if("unknown"===e.type||!("capabilities"in e))return!1;switch(e.type){case"csv":case"feature":case"geojson":case"subtype-group":case"ogc-feature":case"wfs":return!0;case"imagery":case"map-image":case"map-notes":case"tile":case"vector-tile":case"scene":case null:default:return!1}}function f(e){return h(e)?!!(e.capabilities&&e.capabilities.data&&e.capabilities.data.supportsZ):b(e)}function p(e){return null!=e.layers||b(e)||h(e)||d(e)}function b(e){switch(e.type){case"building-scene":case"elevation":case"integrated-mesh":case"point-cloud":case"scene":case"voxel":case"slice":return!0;case"base-dynamic":case"base-elevation":case"base-tile":case"bing-maps":case"csv":case"direct-line-measurement":case"area-measurement":case"geojson":case"feature":case"subtype-group":case"geo-rss":case"graphics":case"group":case"imagery":case"imagery-tile":case"kml":case"line-of-sight":case"map-image":case"map-notes":case"ogc-feature":case"open-street-map":case"route":case"stream":case"tile":case"unknown":case"unsupported":case"vector-tile":case"wcs":case"web-tile":case"wfs":case"wms":case"wmts":case null:return!1}return!1}var v=new a.a({heightModel:"gravity-related-height"})},function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));var n=r(15).a.getLogger("esri.views.3d.support.buffer.math")},function(e,t,r){"use strict";r.d(t,"a",(function(){return b})),r.d(t,"b",(function(){return v}));var n=r(2),i=r(5),a=r(6),o=r(7),s=r(0),c=r(615),l=r(91),u=r(95),d=r(24),h=r(77),f=r(88),p=r(41),b=function(e){Object(a.a)(r,e);var t=Object(o.a)(r);function r(){return Object(n.a)(this,r),t.apply(this,arguments)}return Object(i.a)(r,[{key:"initializeProgram",value:function(e){var t=r.shader.get().build();return new f.a(e.rctx,t,h.a)}},{key:"initializePipeline",value:function(){return this.configuration.hasAlpha?Object(p.g)({blending:Object(p.h)(770,1,771,771),colorWrite:p.d}):Object(p.g)({colorWrite:p.d})}}]),r}(u.a);b.shader=new l.a(c.a,(function(){return r.e(191).then(r.bind(null,707))}));var v=function(e){Object(a.a)(r,e);var t=Object(o.a)(r);function r(){var e;return Object(n.a)(this,r),(e=t.apply(this,arguments)).hasAlpha=!1,e}return r}(d.a);Object(s.a)([Object(d.b)()],v.prototype,"hasAlpha",void 0)},function(e,t,r){"use strict";r.d(t,"a",(function(){return m})),r.d(t,"b",(function(){return y}));var n=r(2),i=r(5),a=r(467),o=r(4),s=r(9),c=r(142),l=r(170),u=function(){function e(){Object(n.a)(this,e)}return Object(i.a)(e,[{key:"updateSettings",value:function(e){this.settings=e,this.edgeHashFunction=e.reducedPrecision?b:p}},{key:"write",value:function(e,t,r){var n=this.edgeHashFunction(r);O.seed=n;var i=O.getIntRange(0,255),a=O.getIntRange(0,this.settings.variants-1),o=O.getFloat(),s=255*(.5*function(e,t){var r=e<0?-1:1;return Math.pow(Math.abs(e),t)*r}(-(1-Math.min(o/.7,1))+Math.max(0,o-.7)/(1-.7),1.2)+.5);e.position0.setVec(t,r.position0),e.position1.setVec(t,r.position1),e.componentIndex.set(t,r.componentIndex),e.variantOffset.set(t,i),e.variantStroke.set(t,a),e.variantExtension.set(t,s)}},{key:"trim",value:function(e,t){return e.slice(0,t)}}]),e}(),d=new Float32Array(6),h=new Uint32Array(d.buffer),f=new Uint32Array(1);function p(e){var t=d;t[0]=e.position0[0],t[1]=e.position0[1],t[2]=e.position0[2],t[3]=e.position1[0],t[4]=e.position1[1],t[5]=e.position1[2],f[0]=5381;for(var r=0;r<h.length;r++)f[0]=31*f[0]+h[r];return f[0]}function b(e){var t=d;t[0]=v(e.position0[0]),t[1]=v(e.position0[1]),t[2]=v(e.position0[2]),t[3]=v(e.position1[0]),t[4]=v(e.position1[1]),t[5]=v(e.position1[2]),f[0]=5381;for(var r=0;r<h.length;r++)f[0]=31*f[0]+h[r];return f[0]}function v(e){return Math.round(1e4*e)/1e4}var m=function(){function e(){Object(n.a)(this,e),this.commonWriter=new u}return Object(i.a)(e,[{key:"updateSettings",value:function(e){this.commonWriter.updateSettings(e)}},{key:"allocate",value:function(e){return l.c.createBuffer(e)}},{key:"write",value:function(e,t,r){this.commonWriter.write(e,t,r),Object(o.h)(g,r.faceNormal0,r.faceNormal1),Object(o.t)(g,g),e.normal.setVec(t,g)}},{key:"trim",value:function(e,t){return this.commonWriter.trim(e,t)}}]),e}();m.Layout=l.c,m.glLayout=Object(c.a)(l.c,1);var y=function(){function e(){Object(n.a)(this,e),this.commonWriter=new u}return Object(i.a)(e,[{key:"updateSettings",value:function(e){this.commonWriter.updateSettings(e)}},{key:"allocate",value:function(e){return l.d.createBuffer(e)}},{key:"write",value:function(e,t,r){this.commonWriter.write(e,t,r),e.normalA.setVec(t,r.faceNormal0),e.normalB.setVec(t,r.faceNormal1)}},{key:"trim",value:function(e,t){return this.commonWriter.trim(e,t)}}]),e}();y.Layout=l.d,y.glLayout=Object(c.a)(l.d,1);var g=Object(s.e)(),O=new a.a},function(e,t,r){"use strict";r.d(t,"a",(function(){return o})),r.d(t,"b",(function(){return s}));var n=r(14),i=r(32),a=r(108);function o(e,t){return t.push(e.buffer),{buffer:e.buffer,layout:c(e.layout)}}function s(e){return function(e){var t=Object(a.a)();return t.stride=e.stride,t.fieldNames=e.fieldNames,e.fields.forEach((function(e){return t.fields.set(e[0],Object(n.a)(Object(n.a)({},e[1]),{},{constructor:d(e[1].constructor)}))})),t}(e.layout).createView(e.buffer)}function c(e){var t=new Array;return e.fields.forEach((function(e,r){var i=Object(n.a)(Object(n.a)({},e),{},{constructor:u(e.constructor)});t.push([r,i])})),{stride:e.stride,fields:t,fieldNames:e.fieldNames}}var l=[i.a,i.m,i.u,i.C,i.f,i.h,i.b,i.n,i.v,i.D,i.g,i.i,i.l,i.t,i.B,i.J,i.j,i.r,i.z,i.H,i.k,i.s,i.A,i.I,i.e,i.q,i.y,i.G,i.c,i.o,i.w,i.E,i.d,i.p,i.x,i.F];function u(e){return"".concat(e.ElementType,"_").concat(e.ElementCount)}function d(e){return h.get(e)}var h=new Map;l.forEach((function(e){return h.set(u(e),e)}))},function(e,t,r){"use strict";r.d(t,"a",(function(){return a})),r.d(t,"b",(function(){return i}));var n=r(13);function i(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2?arguments[2]:void 0;if(!window.WebGLRenderingContext)return o(e,s),null;var n=a(e,t,r);return n||(o(e,c),null)}function a(e){var t,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=arguments.length>2?arguments[2]:void 0;switch(i){case"webgl":t=["webgl","experimental-webgl","webkit-3d","moz-webgl"];break;case"webgl2":t=["webgl2"];break;default:t=["webgl","experimental-webgl","webkit-3d","moz-webgl"]}var a,o=null,s=Object(n.a)(t);try{for(s.s();!(a=s.n()).done;){var c=a.value;try{o=e.getContext(c,r)}catch(l){}if(o)break}}catch(u){s.e(u)}finally{s.f()}return o}function o(e,t){var r=e.parentNode;r&&(r.innerHTML='<table style="background-color: #8CE; width: 100%; height: 100%;"><tr><td align="center"><div style="display: table-cell; vertical-align: middle;"><div style="">'+t+"</div></div></td></tr></table>")}var s='This page requires a browser that supports WebGL.<br/><a href="http://get.webgl.org">Click here to upgrade your browser.</a>',c='It doesn\'t appear your computer can support WebGL.<br/><a href="http://get.webgl.org/troubleshooting/">Click here for more information.</a>'},function(e,t,r){"use strict";r.d(t,"a",(function(){return Q})),r.d(t,"b",(function(){return ee})),r.d(t,"c",(function(){return Z})),r.d(t,"d",(function(){return Y})),r.d(t,"e",(function(){return G})),r.d(t,"f",(function(){return X})),r.d(t,"g",(function(){return K})),r.d(t,"h",(function(){return $})),r.d(t,"i",(function(){return D})),r.d(t,"j",(function(){return x})),r.d(t,"k",(function(){return U})),r.d(t,"l",(function(){return z})),r.d(t,"m",(function(){return he})),r.d(t,"n",(function(){return ie})),r.d(t,"o",(function(){return se})),r.d(t,"p",(function(){return de})),r.d(t,"q",(function(){return re})),r.d(t,"r",(function(){return ne})),r.d(t,"s",(function(){return O})),r.d(t,"t",(function(){return j})),r.d(t,"u",(function(){return le})),r.d(t,"v",(function(){return te})),r.d(t,"w",(function(){return ce}));var n=r(50),i=r(33),a=r(13),o=r(22),s=r(15),c=r(100),l=r(299),u=r(487),d=r(217);function h(e,t){return e?t?4:3:t?3:2}var f=s.a.getLogger("esri.tasks.support.optimizedFeatureSet"),p={esriGeometryPoint:0,esriGeometryPolyline:2,esriGeometryPolygon:3,esriGeometryMultipoint:0},b=function(e,t,r,n,i,a){e[r]=i,e[r+1]=a},v=function(e,t,r,n,i,a){e[r]=i,e[r+1]=a,e[r+2]=t[n+2]},m=function(e,t,r,n,i,a){e[r]=i,e[r+1]=a,e[r+2]=t[n+3]},y=function(e,t,r,n,i,a){e[r]=i,e[r+1]=a,e[r+2]=t[n+2],e[r+3]=t[n+3]};function g(e,t,r,n){if(e){if(r)return t&&n?y:v;if(t&&n)return m}else if(t&&n)return v;return b}function O(e,t){var r=e.scale,n=e.translate;return Math.round((t-n[0])/r[0])}function j(e,t){var r=e.scale,n=e.translate;return Math.round((n[1]-t)/r[1])}function _(e,t){var r=e.scale,n=e.translate;return t*r[0]+n[0]}function w(e,t){var r=e.scale;return e.translate[1]-t*r[1]}function x(e,t,r){return e?t?r?A(e):T(e):r?M(e):k(e):null}function k(e){var t=e.coords;return{x:t[0],y:t[1]}}function S(e,t){return e.coords[0]=t.x,e.coords[1]=t.y,e}function T(e){var t=e.coords;return{x:t[0],y:t[1],z:t[2]}}function C(e,t){return e.coords[0]=t.x,e.coords[1]=t.y,e.coords[2]=t.z,e}function M(e){var t=e.coords;return{x:t[0],y:t[1],m:t[2]}}function P(e,t){return e.coords[0]=t.x,e.coords[1]=t.y,e.coords[2]=t.m,e}function A(e){var t=e.coords;return{x:t[0],y:t[1],z:t[2],m:t[3]}}function E(e,t){return e.coords[0]=t.x,e.coords[1]=t.y,e.coords[2]=t.z,e.coords[3]=t.m,e}function R(e,t){return e&&t?E:e?C:t?P:S}function I(e,t,r,n,i){var o,s=R(r,n),c=Object(a.a)(t);try{for(c.s();!(o=c.n()).done;){var u=o.value,h=u.geometry,f=u.attributes,p=void 0;h&&(p=s(new d.a,h)),e.push(new l.a(p,f,null,f[i]))}}catch(b){c.e(b)}finally{c.f()}return e}function D(e,t,r){if(!e)return null;for(var n=h(t,r),i=[],a=0;a<e.coords.length;a+=n){for(var o=[],s=0;s<n;s++)o.push(e.coords[a+s]);i.push(o)}return t?r?{points:i,hasZ:t,hasM:r}:{points:i,hasZ:t}:r?{points:i,hasM:r}:{points:i}}function F(e,t,r,n,i){var o,s=h(r,n),c=Object(a.a)(t);try{for(c.s();!(o=c.n()).done;){var u=o.value,f=u.geometry,p=u.attributes,b=void 0;f&&(b=L(new d.a,f,s)),e.push(new l.a(b,p,null,p[i]))}}catch(v){c.e(v)}finally{c.f()}return e}function L(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:h(t.hasZ,t.hasM);e.lengths[0]=t.points.length;var n,i=e.coords,o=0,s=Object(a.a)(t.points);try{for(s.s();!(n=s.n()).done;)for(var c=n.value,l=0;l<r;l++)i[o++]=c[l]}catch(u){s.e(u)}finally{s.f()}return e}function z(e,t,r){if(!e)return null;var n,i=h(t,r),o=e.coords,s=e.lengths,c=[],l=0,u=Object(a.a)(s);try{for(u.s();!(n=u.n()).done;){for(var d=n.value,f=[],p=0;p<d;p++){for(var b=[],v=0;v<i;v++)b.push(o[l++]);f.push(b)}c.push(f)}}catch(m){u.e(m)}finally{u.f()}return t?r?{paths:c,hasZ:t,hasM:r}:{paths:c,hasZ:t}:r?{paths:c,hasM:r}:{paths:c}}function V(e,t,r,n,i){var o,s=h(r,n),c=Object(a.a)(t);try{for(c.s();!(o=c.n()).done;){var u=o.value,f=u.geometry,p=u.attributes,b=void 0;f&&(b=N(new d.a,f,s)),e.push(new l.a(b,p,null,p[i]))}}catch(v){c.e(v)}finally{c.f()}return e}function N(e,t){var r,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:h(t.hasZ,t.hasM),i=e.lengths,o=e.coords,s=0,c=Object(a.a)(t.paths);try{for(c.s();!(r=c.n()).done;){var l,u=r.value,d=Object(a.a)(u);try{for(d.s();!(l=d.n()).done;)for(var f=l.value,p=0;p<n;p++)o[s++]=f[p]}catch(b){d.e(b)}finally{d.f()}i.push(u.length)}}catch(b){c.e(b)}finally{c.f()}return e}function U(e,t,r){if(!e)return null;var n,i=h(t,r),o=e.coords,s=e.lengths,c=[],l=0,u=Object(a.a)(s);try{for(u.s();!(n=u.n()).done;){for(var d=n.value,f=[],p=0;p<d;p++){for(var b=[],v=0;v<i;v++)b.push(o[l++]);f.push(b)}c.push(f)}}catch(m){u.e(m)}finally{u.f()}return t?r?{rings:c,hasZ:t,hasM:r}:{rings:c,hasZ:t}:r?{rings:c,hasM:r}:{rings:c}}function B(e,t,r,n,i){var o,s=Object(a.a)(t);try{for(s.s();!(o=s.n()).done;){var c=o.value,u=c.geometry,h=c.centroid,f=c.attributes,p=void 0;u&&(p=G(new d.a,u,r,n)),h?e.push(new l.a(p,f,S(new d.a,h),f[i])):e.push(new l.a(p,f,null,f[i]))}}catch(b){s.e(b)}finally{s.f()}return e}function G(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t.hasZ,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:t.hasM;return q(e,t.rings,r,n),e}function q(e,t,r,n){var i=h(r,n),o=e.lengths,s=e.coords,c=0;o.length=s.length=0;var l,u=Object(a.a)(t);try{for(u.s();!(l=u.n()).done;){var d,f=l.value,p=Object(a.a)(f);try{for(p.s();!(d=p.n()).done;)for(var b=d.value,v=0;v<i;v++)s[c++]=b[v]}catch(m){p.e(m)}finally{p.f()}o.push(f.length)}}catch(m){u.e(m)}finally{u.f()}return e}var H=[],W=[];function Q(e,t,r,n,a){H[0]=e;var o=Z(W,H,t,r,n,a),s=Object(i.a)(o,1)[0];return H.length=W.length=0,s}function Z(e,t,r,n,i,s){if(e.length=0,!r){var c,u=Object(a.a)(t);try{for(u.s();!(c=u.n()).done;){var d=c.value,h=d.attributes[s];e.push(new l.a(null,d.attributes,null,h))}}catch(p){u.e(p)}finally{u.f()}return e}switch(r){case"esriGeometryPoint":return I(e,t,n,i,s);case"esriGeometryMultipoint":return F(e,t,n,i,s);case"esriGeometryPolyline":return V(e,t,n,i,s);case"esriGeometryPolygon":return B(e,t,n,i,s);default:f.error("convertToFeatureSet:unknown-geometry",new o.a("Unable to parse unknown geometry type '".concat(r,"'"))),e.length=0}return e}function X(e,t,r,n){W[0]=e,J(H,W,t,r,n);var i=H[0];return H.length=W.length=0,i}function Y(e,t,r){if(!e)return null;var n=new d.a;return"hasZ"in e&&null==t&&(t=e.hasZ),"hasM"in e&&null==r&&(r=e.hasM),Object(c.f)(e)?R(null!=t?t:null!=e.z,null!=r?r:null!=e.m)(n,e):Object(c.g)(e)?G(n,e,t,r):Object(c.h)(e)?N(n,e,h(t,r)):Object(c.e)(e)?L(n,e,h(t,r)):void f.error("convertFromGeometry:unknown-geometry",new o.a("Unable to parse unknown geometry type '".concat(e,"'")))}function $(e,t,r,n){var i=e&&("coords"in e?e:e.geometry);if(!i)return null;switch(t){case"esriGeometryPoint":var a=k;return r&&n?a=A:r?a=T:n&&(a=M),a(i);case"esriGeometryMultipoint":return D(i,r,n);case"esriGeometryPolyline":return z(i,r,n);case"esriGeometryPolygon":return U(i,r,n);default:return void f.error("convertToGeometry:unknown-geometry",new o.a("Unable to parse unknown geometry type '".concat(t,"'")))}}function J(e,t,r,n,i){switch(e.length=0,r){case"esriGeometryPoint":return function(e,t,r,n){var i=k;r&&n?i=A:r?i=T:n&&(i=M);var o,s=Object(a.a)(t);try{for(s.s();!(o=s.n()).done;){var c=o.value,l=c.geometry,u=c.attributes,d=l?i(l):null;e.push({attributes:u,geometry:d})}}catch(h){s.e(h)}finally{s.f()}return e}(e,t,n,i);case"esriGeometryMultipoint":return function(e,t,r,n){var i,o=Object(a.a)(t);try{for(o.s();!(i=o.n()).done;){var s=i.value,c=s.geometry,l=s.attributes,u=void 0;c&&(u=D(c,r,n)),e.push({attributes:l,geometry:u})}}catch(d){o.e(d)}finally{o.f()}return e}(e,t,n,i);case"esriGeometryPolyline":return function(e,t,r,n){var i,o=Object(a.a)(t);try{for(o.s();!(i=o.n()).done;){var s=i.value,c=s.geometry,l=s.attributes,u=void 0;c&&(u=z(c,r,n)),e.push({attributes:l,geometry:u})}}catch(d){o.e(d)}finally{o.f()}return e}(e,t,n,i);case"esriGeometryPolygon":return function(e,t,r,n){var i,o=Object(a.a)(t);try{for(o.s();!(i=o.n()).done;){var s=i.value,c=s.geometry,l=s.attributes,u=s.centroid,d=void 0;if(c&&(d=U(c,r,n)),u){var h=k(u);e.push({attributes:l,centroid:h,geometry:d})}else e.push({attributes:l,geometry:d})}}catch(f){o.e(f)}finally{o.f()}return e}(e,t,n,i);default:f.error("convertToFeatureSet:unknown-geometry",new o.a("Unable to parse unknown geometry type '".concat(r,"'")))}return e}function K(e){var t=e.objectIdFieldName,r=e.spatialReference,n=e.transform,i=e.fields,a=e.hasM,o=e.hasZ,s=e.features,c=e.geometryType,l=e.exceededTransferLimit,u=e.uniqueIdField,d=e.queryGeometry,h=e.queryGeometryType,f={features:J([],s,c,o,a),fields:i,geometryType:c,objectIdFieldName:t,spatialReference:r,uniqueIdField:u,queryGeometry:$(d,h,!1,!1)};return n&&(f.transform=n),l&&(f.exceededTransferLimit=l),a&&(f.hasM=a),o&&(f.hasZ=o),f}function ee(e,t){var r=new u.a,n=e.hasM,i=e.hasZ,a=e.features,s=e.objectIdFieldName,c=e.spatialReference,l=e.geometryType,d=e.exceededTransferLimit,h=e.transform,p=e.fields;return p&&(r.fields=p),r.geometryType=l,r.objectIdFieldName=s||t,r.spatialReference=c,r.objectIdFieldName?(a&&Z(r.features,a,l,i,n,r.objectIdFieldName),d&&(r.exceededTransferLimit=d),n&&(r.hasM=n),i&&(r.hasZ=i),h&&(r.transform=h),r):(f.error(new o.a("optimized-features:invalid-objectIdFieldName","objectIdFieldName is missing")),r)}function te(e){var t=e.transform,r=e.features,n=e.hasM,i=e.hasZ;if(!t)return e;var o,s=Object(a.a)(r);try{for(s.s();!(o=s.n()).done;){var c=o.value;c.geometry&&ce(c.geometry,c.geometry,n,i,t),c.centroid&&ce(c.centroid,c.centroid,n,i,t)}}catch(l){s.e(l)}finally{s.f()}return e.transform=null,e}function re(e,t){var r=t.geometryType,n=t.features,i=t.hasM,a=t.hasZ;if(!e)return t;for(var o=0;o<n.length;o++){var s=n[o],c=s.weakClone();c.geometry=new d.a,ne(c.geometry,s.geometry,i,a,r,e),s.centroid&&(c.centroid=new d.a,ne(c.centroid,s.centroid,i,a,"esriGeometryPoint",e)),n[o]=c}return t.transform=e,t}function ne(e,t,r,n,i,o){var s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:r,c=arguments.length>7&&void 0!==arguments[7]?arguments[7]:n;if(e.lengths.length&&(e.lengths.length=0),e.coords.length&&(e.coords.length=0),!t||!t.coords.length)return null;var l=p[i],u=t.coords,d=t.lengths,f=h(r,n),b=h(r&&s,n&&c),v=g(r,n,s,c);if(!d.length)return v(e.coords,u,0,0,O(o,u[0]),j(o,u[1])),e.lengths.length&&(e.lengths.length=0),e.coords.length=f,e;var m,y,_,w,x,k=0,S=0,T=S,C=Object(a.a)(d);try{for(C.s();!(x=C.n()).done;){var M=x.value;if(!(M<l)){var P=0;S=T,_=m=O(o,u[k]),w=y=j(o,u[k+1]),v(e.coords,u,S,k,_,w),P++,k+=f,S+=b;for(var A=1;A<M;A++,k+=f)_=O(o,u[k]),w=j(o,u[k+1]),_===m&&w===y||(v(e.coords,u,S,k,_-m,w-y),S+=b,P++,m=_,y=w);P>=l&&(e.lengths.push(P),T=S)}}}catch(E){C.e(E)}finally{C.f()}return e.coords.length=T,e.coords.length?e:null}function ie(e,t,r,n,i,o){var s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:r,c=arguments.length>7&&void 0!==arguments[7]?arguments[7]:n;if(e.lengths.length&&(e.lengths.length=0),e.coords.length&&(e.coords.length=0),!t||!t.coords.length)return null;var l=p[i],u=t.coords,d=t.lengths,f=h(r,n),b=h(r&&s,n&&c),v=g(r,n,s,c);if(!d.length)return v(e.coords,u,0,0,u[0],u[1]),e.lengths.length&&(e.lengths.length=0),e.coords.length=f,e;var m,y=0,O=o*o,j=Object(a.a)(d);try{for(j.s();!(m=j.n()).done;){var _=m.value;if(_<l)y+=_*f;else{var w=e.coords.length/b,x=y,k=y+(_-1)*f;v(e.coords,u,e.coords.length,x,u[x],u[x+1]),oe(e.coords,u,f,O,v,x,k),v(e.coords,u,e.coords.length,k,u[k],u[k+1]);var S=e.coords.length/b-w;S>=l?e.lengths.push(S):e.coords.length=w*b,y+=_*f}}}catch(T){j.e(T)}finally{j.f()}return e.coords.length?e:null}function ae(e,t,r,n){var i=e[t],a=e[t+1],o=e[r],s=e[r+1],c=e[n],l=e[n+1],u=o,d=s,h=c-u,f=l-d;if(0!==h||0!==f){var p=((i-u)*h+(a-d)*f)/(h*h+f*f);p>1?(u=c,d=l):p>0&&(u+=h*p,d+=f*p)}return(h=i-u)*h+(f=a-d)*f}function oe(e,t,r,n,i,a,o){for(var s,c=n,l=0,u=a+r;u<o;u+=r)(s=ae(t,u,a,o))>c&&(l=u,c=s);c>n&&(l-a>r&&oe(e,t,r,n,i,a,l),i(e,t,e.length,l,t[l],t[l+1]),o-l>r&&oe(e,t,r,n,i,l,o))}function se(e,t,r,n){if(!t||!t.coords||!t.coords.length)return null;var i=h(r,n),a=Number.POSITIVE_INFINITY,o=Number.POSITIVE_INFINITY,s=Number.NEGATIVE_INFINITY,c=Number.NEGATIVE_INFINITY;if(t&&t.coords)for(var l=t.coords,u=0;u<l.length;u+=i){var d=l[u],f=l[u+1];a=Math.min(a,d),s=Math.max(s,d),o=Math.min(o,f),c=Math.max(c,f)}return e[0]=a,e[1]=o,e[2]=s,e[3]=c,e}function ce(e,t,r,n,a){var o=t.coords,s=t.lengths,c=r?n?y:v:n?v:b,l=h(r,n);if(!o.length)return e!==t&&(e.lengths.length=0,e.coords.length=0),e;if(!s.length)return c(e.coords,o,0,0,_(a,o[0]),w(a,o[1])),e!==t&&(e.lengths.length=0,e.coords.length=l),e;for(var u=Object(i.a)(a.scale,2),d=u[0],f=u[1],p=0,m=0;m<s.length;m++){var g=s[m];e.lengths[m]=g;var O=_(a,o[p]),j=w(a,o[p+1]);c(e.coords,o,p,p,O,j),p+=l;for(var x=1;x<g;x++,p+=l)O+=o[p]*d,j-=o[p+1]*f,c(e.coords,o,p,p,O,j)}return e!==t&&(e.lengths.length=s.length,e.coords.length=o.length),e}function le(e,t,r,i,a,o){var s,c=h(r,i),l=g(r,i,a,o),u=t.coords;e.coords.length=0,e.lengths.length=0,(s=e.lengths).push.apply(s,Object(n.a)(t.lengths));for(var d=0;d<u.length;d+=c)l(e.coords,u,e.coords.length,d,u[d],u[d+1]);return e}function ue(e,t,r,n){for(var i=0,a=e[n*t],o=e[n*(t+1)],s=1;s<r;s++){var c=a+e[n*(t+s)],l=o+e[n*(t+s)+1],u=(c-a)*(l+o);a=c,o=l,i+=u}return.5*i}function de(e,t){for(var r=e.coords,n=e.lengths,i=0,a=0,o=0;o<n.length;o++)a+=ue(r,i,n[o],t),i+=o;return Math.abs(a)}function he(e,t){for(var r=e.clone(),n=e.coords,i=e.lengths,a=0,o=0;o<i.length;o++){for(var s=i[o],c=n[t*a],l=n[t*a+1],u=1;u<s;u++){var d=c+n[t*(a+u)],h=l+n[t*(a+u)+1];r.coords[t*(a+u)]=d,r.coords[t*(a+u)+1]=h,c=d,l=h}a+=s}return r}},function(e,t,r){"use strict";var n,i=r(14),a=r(2),o=r(5),s=r(6),c=r(7),l=r(0),u=r(58),d=r(27),h=r(69),f=r(1),p=(r(17),r(18)),b=(r(15),r(48)),v=r(10),m=r(44),y=r(56),g=r(55),O=r(40),j=r(59),_=r(61),w=r(593),x=new u.a({PNG:"png",PNG8:"png8",PNG24:"png24",PNG32:"png32",JPEG:"jpg",JPG:"jpg",DIB:"dib",TIFF:"tiff",EMF:"emf",PS:"ps",PDF:"pdf",GIF:"gif",SVG:"svg",SVGZ:"svgz",Mixed:"mixed",MIXED:"mixed",LERC:"lerc",LERC2D:"lerc2d",RAW:"raw",pbf:"pbf"}),k=n=function(e){Object(s.a)(r,e);var t=Object(c.a)(r);function r(e){var n;return Object(a.a)(this,r),(n=t.call(this,e)).dpi=96,n.format=null,n.origin=null,n.minScale=0,n.maxScale=0,n.size=null,n.spatialReference=null,n}return Object(o.a)(r,[{key:"isWrappable",get:function(){var e=this.spatialReference,t=this.origin;if(e&&t){var r=Object(j.d)(e);return e.isWrappable&&Math.abs(r.origin[0]-t.x)<=r.dx}return!1}},{key:"readOrigin",value:function(e,t){return y.a.fromJSON(Object(i.a)({spatialReference:t.spatialReference},e))}},{key:"lods",set:function(e){var t=this,r=0,n=0,i=[];this._levelToLOD={},e&&(r=-1/0,n=1/0,e.forEach((function(e){i.push(e.scale),r=e.scale>r?e.scale:r,n=e.scale<n?e.scale:n,t._levelToLOD[e.level]=e}))),this._set("scales",i),this._set("minScale",r),this._set("maxScale",n),this._set("lods",e),this._initializeUpsampleLevels()}},{key:"readSize",value:function(e,t){return[t.cols,t.rows]}},{key:"writeSize",value:function(e,t){t.cols=e[0],t.rows=e[0]}},{key:"zoomToScale",value:function(e){var t=this.scales;if(e<=0)return t[0];if(e>=t.length-1)return t[t.length-1];var r=Math.floor(e),n=r+1;return t[r]/Math.pow(t[r]/t[n],e-r)}},{key:"scaleToZoom",value:function(e){for(var t=this.scales,r=t.length-1,n=0;n<r;n++){var i=t[n],a=t[n+1];if(i<=e)return n;if(a===e)return n+1;if(i>e&&a<e)return n+Math.log(i/e)/Math.log(i/a)}return n}},{key:"snapScale",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.95,r=this.scaleToZoom(e);return r%Math.floor(r)>=t?this.zoomToScale(Math.ceil(r)):this.zoomToScale(Math.floor(r))}},{key:"tileAt",value:function(e,t,r,n){var i,a,o=this.lodAt(e);if(!o)return null;if("number"==typeof t)i=t,a=r;else if(Object(j.c)(t.spatialReference,this.spatialReference))i=t.x,a=t.y,n=r;else{var s=Object(_.d)(t,this.spatialReference);if(!s)return null;i=s.x,a=s.y,n=r}var c=o.resolution*this.size[0],l=o.resolution*this.size[1];return n||(n={id:null,level:0,row:0,col:0,extent:Object(O.k)()}),n.level=e,n.row=Math.floor((this.origin.y-a)/l+.001),n.col=Math.floor((i-this.origin.x)/c+.001),this.updateTileInfo(n),n}},{key:"updateTileInfo",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=this.lodAt(e.level);if(!r&&1===t){var n=this.lods[this.lods.length-1];n.level<e.level&&(r=n)}if(r){var i=e.level-r.level,a=r.resolution*this.size[0]/Math.pow(2,i),o=r.resolution*this.size[1]/Math.pow(2,i);e.id="".concat(e.level,"/").concat(e.row,"/").concat(e.col),e.extent||(e.extent=Object(O.k)()),e.extent[0]=this.origin.x+e.col*a,e.extent[1]=this.origin.y-(e.row+1)*o,e.extent[2]=e.extent[0]+a,e.extent[3]=e.extent[1]+o}}},{key:"upsampleTile",value:function(e){var t=this._upsampleLevels[e.level];return!(!t||-1===t.parentLevel)&&(e.level=t.parentLevel,e.row=Math.floor(e.row/t.factor+.001),e.col=Math.floor(e.col/t.factor+.001),this.updateTileInfo(e),!0)}},{key:"getTileBounds",value:function(e,t){var r=this.lodAt(t.level).resolution,n=r*this.size[0],i=r*this.size[1];return e[0]=this.origin.x+t.col*n,e[1]=this.origin.y-(t.row+1)*i,e[2]=e[0]+n,e[3]=e[1]+i,e}},{key:"lodAt",value:function(e){return this._levelToLOD&&this._levelToLOD[e]||null}},{key:"clone",value:function(){return n.fromJSON(this.write({}))}},{key:"_initializeUpsampleLevels",value:function(){var e=this.lods;this._upsampleLevels=[];for(var t=null,r=0;r<e.length;r++){var n=e[r];this._upsampleLevels[n.level]={parentLevel:t?t.level:-1,factor:t?t.resolution/n.resolution:0},t=n}}}],[{key:"create",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.resolutionFactor,r=void 0===t?1:t,i=e.scales,a=e.size,o=void 0===a?256:a,s=e.spatialReference,c=void 0===s?g.a.WebMercator:s,l=e.numLODs,u=void 0===l?24:l;if(!Object(j.j)(c)){var d=[];if(i)for(var f=0;f<i.length;f++){var p=i[f];d.push({level:f,scale:p,resolution:p})}else for(var b=5e-4,v=u-1;v>=0;v--)d.unshift({level:v,scale:b,resolution:b}),b*=2;return new n({dpi:96,lods:d,origin:new y.a(0,0,c),size:[o,o],spatialReference:c})}var m=Object(j.d)(c),O=e.origin?new y.a({x:e.origin.x,y:e.origin.y,spatialReference:c}):new y.a(m?{x:m.origin[0],y:m.origin[1],spatialReference:c}:{x:0,y:0,spatialReference:c}),_=96,w=1/(39.37*Object(h.f)(c)*_),x=[];if(i)for(var k=0;k<i.length;k++){var S=i[k],T=S*w;x.push({level:k,scale:S,resolution:T})}else{var C=Object(j.g)(c)?512/o*591657527.5917094:256/o*591657527.591555,M=Math.ceil(u/r);x.push({level:0,scale:C,resolution:C*w});for(var P=1;P<M;P++){var A=C/Math.pow(2,r),E=A*w;x.push({level:P,scale:A,resolution:E}),C=A}}return new n({dpi:_,lods:x,origin:O,size:[o,o],spatialReference:c})}}]),r}(d.a);Object(l.a)([Object(f.b)({type:Number,json:{write:!0}})],k.prototype,"compressionQuality",void 0),Object(l.a)([Object(f.b)({type:Number,json:{write:!0}})],k.prototype,"dpi",void 0),Object(l.a)([Object(f.b)({type:String,json:{read:x.read,write:x.write,origins:{"web-scene":{read:!1,write:!1}}}})],k.prototype,"format",void 0),Object(l.a)([Object(f.b)({readOnly:!0})],k.prototype,"isWrappable",null),Object(l.a)([Object(f.b)({type:y.a,json:{write:!0}})],k.prototype,"origin",void 0),Object(l.a)([Object(b.a)("origin")],k.prototype,"readOrigin",null),Object(l.a)([Object(f.b)({type:[w.a],value:null,json:{write:!0}})],k.prototype,"lods",null),Object(l.a)([Object(f.b)({readOnly:!0})],k.prototype,"minScale",void 0),Object(l.a)([Object(f.b)({readOnly:!0})],k.prototype,"maxScale",void 0),Object(l.a)([Object(f.b)({readOnly:!0})],k.prototype,"scales",void 0),Object(l.a)([Object(f.b)({cast:function(e){return Array.isArray(e)?e:"number"==typeof e?[e,e]:[256,256]}})],k.prototype,"size",void 0),Object(l.a)([Object(b.a)("size",["rows","cols"])],k.prototype,"readSize",null),Object(l.a)([Object(m.a)("size",{cols:{type:p.a},rows:{type:p.a}})],k.prototype,"writeSize",null),Object(l.a)([Object(f.b)({type:g.a,json:{write:!0}})],k.prototype,"spatialReference",void 0);var S=k=n=Object(l.a)([Object(v.a)("esri.layers.support.TileInfo")],k);t.a=S},function(e,t,r){"use strict";r.d(t,"a",(function(){return pe})),r.d(t,"b",(function(){return ve})),r.d(t,"c",(function(){return ye})),r.d(t,"d",(function(){return Se})),r.d(t,"e",(function(){return be})),r.d(t,"f",(function(){return xe})),r.d(t,"g",(function(){return ge})),r.d(t,"h",(function(){return we})),r.d(t,"i",(function(){return _e})),r.d(t,"j",(function(){return je})),r.d(t,"k",(function(){return ke})),r.d(t,"l",(function(){return me})),r.d(t,"m",(function(){return Oe}));var n=r(2),i=r(67),a=r(96),o=r(193),s=r(554),c=r(196),l=r(4),u=r(73),d=r(9),h=(r(54),r(43)),f=r(34),p=r(37),b=1e-6,v=[0,0,0],m=[0,0,0];function y(e,t){var r=e,n=r.data,i=r.size,a=n.length/i;if(!(a<=0)){var o=new J(e);te(v,o.minProj,o.maxProj),ne(v,v,.5),re(m,o.maxProj,o.minProj);var s=ee(m),c=new K;c.quality=s,a<14&&(e={data:new Float64Array(o.buffer,112,42),size:3});var l=[0,0,0],u=[0,0,0],d=[0,0,0],h=[0,0,0],f=[0,0,0],p=[0,0,0],y=[0,0,0];switch(g(o,e,y,l,u,d,h,f,p,c)){case 1:return void N(v,m,t);case 2:return void function(e,t,r){ie(U,t),Math.abs(t[0])>Math.abs(t[1])&&Math.abs(t[0])>Math.abs(t[2])?U[0]=0:Math.abs(t[1])>Math.abs(t[2])?U[1]=0:U[2]=0,se(U)<b&&(U[0]=U[1]=U[2]=1),ae(B,t,U),oe(B,B),ae(G,t,B),oe(G,G),Q(e,t,B,G,q,H),re(W,H,q),$(t,B,G,q,H,W,r)}(e,h,t)}C(e,y,l,u,d,h,f,p,c),Q(e,c.b0,c.b1,c.b2,q,H);var O=[0,0,0];re(O,H,q),c.quality=ee(O),c.quality<s?$(c.b0,c.b1,c.b2,q,H,O,t):N(v,m,t)}}function g(e,t,r,n,i,a,o,s,c,l){return function(e,t,r){for(var n=ce(e.maxVert[0],e.minVert[0]),i=0,a=1;a<7;++a){var o=ce(e.maxVert[a],e.minVert[a]);o>n&&(n=o,i=a)}ie(t,e.minVert[i]),ie(r,e.maxVert[i])}(e,n,i),ce(n,i)<b?1:(re(o,n,i),oe(o,o),function(e,t,r,n){for(var i=e.data,a=e.size,o=Number.NEGATIVE_INFINITY,s=0,c=0;c<i.length;c+=a){M[0]=i[c]-t[0],M[1]=i[c+1]-t[1],M[2]=i[c+2]-t[2];var l=r[0]*M[0]+r[1]*M[1]+r[2]*M[2],u=r[0]*r[0]+r[1]*r[1]+r[2]*r[2],d=M[0]*M[0]+M[1]*M[1]+M[2]*M[2]-l*l/u;d>o&&(o=d,s=c)}return ie(n,i,s),o}(t,n,o,a)<b?2:(re(s,i,a),oe(s,s),re(c,a,n),oe(c,c),ae(r,s,o),oe(r,r),L(t,r,o,s,c,l),0))}var O=[0,0,0],j=[0,0,0],_=[0,0,0],w=[0,0,0],x=[0,0,0],k=[0,0,0],S=[0,0,0],T=[0,0,0];function C(e,t,r,n,i,a,o,s,c){(function(e,t,r,n,i){!function(e,t,r,n,i){var a=e.data,o=e.size;ie(n,a),ie(i,n),r[0]=le(z,t),r[1]=r[0];for(var s=o;s<a.length;s+=o){var c=a[s]*t[0]+a[s+1]*t[1]+a[s+2]*t[2];c<r[0]&&(r[0]=c,ie(n,a,s)),c>r[1]&&(r[1]=c,ie(i,a,s))}}(e,t,P,i,n);var a=le(r,t);P[1]-b<=a&&(n[0]=void 0),P[0]+b>=a&&(i[0]=void 0)})(e,t,r,O,j),void 0!==O[0]&&(re(_,O,r),oe(_,_),re(w,O,n),oe(w,w),re(x,O,i),oe(x,x),ae(k,w,a),oe(k,k),ae(S,x,o),oe(S,S),ae(T,_,s),oe(T,T),L(e,k,a,w,_,c),L(e,S,o,x,w,c),L(e,T,s,_,x,c)),void 0!==j[0]&&(re(_,j,r),oe(_,_),re(w,j,n),oe(w,w),re(x,j,i),oe(x,x),ae(k,w,a),oe(k,k),ae(S,x,o),oe(S,S),ae(T,_,s),oe(T,T),L(e,k,a,w,_,c),L(e,S,o,x,w,c),L(e,T,s,_,x,c))}var M=[0,0,0];var P=[0,0];var A=[0,0,0],E=[0,0,0],R=[0,0,0],I=[0,0,0],D=[0,0,0],F=[0,0,0];function L(e,t,r,n,i,a){if(!(se(t)<b)){ae(A,r,t),ae(E,n,t),ae(R,i,t),V(e,t,P),D[1]=P[0],I[1]=P[1],F[1]=I[1]-D[1];for(var o=[r,n,i],s=[A,E,R],c=0;c<3;++c){V(e,o[c],P),D[0]=P[0],I[0]=P[1],V(e,s[c],P),D[2]=P[0],I[2]=P[1],F[0]=I[0]-D[0],F[2]=I[2]-D[2];var l=ee(F);l<a.quality&&(ie(a.b0,o[c]),ie(a.b1,t),ie(a.b2,s[c]),a.quality=l)}}}var z=[0,0,0];function V(e,t,r){var n=e.data,i=e.size;r[0]=Number.POSITIVE_INFINITY,r[1]=Number.NEGATIVE_INFINITY;for(var a=0;a<n.length;a+=i){var o=n[a]*t[0]+n[a+1]*t[1]+n[a+2]*t[2];r[0]=Math.min(r[0],o),r[1]=Math.max(r[1],o)}}function N(e,t,r){ie(r.center,e),ne(r.halfSize,t,.5),r.quaternion[0]=0,r.quaternion[1]=0,r.quaternion[2]=0,r.quaternion[3]=1}var U=[0,0,0],B=[0,0,0],G=[0,0,0],q=[0,0,0],H=[0,0,0],W=[0,0,0];function Q(e,t,r,n,i,a){V(e,t,P),i[0]=P[0],a[0]=P[1],V(e,r,P),i[1]=P[0],a[1]=P[1],V(e,n,P),i[2]=P[0],a[2]=P[1]}var Z=[0,0,0],X=[1,0,0,0,1,0,0,0,1],Y=[0,0,0];function $(e,t,r,n,i,a,o){X[0]=e[0],X[1]=e[1],X[2]=e[2],X[3]=t[0],X[4]=t[1],X[5]=t[2],X[6]=r[0],X[7]=r[1],X[8]=r[2],function(e,t){var r=t[0]+t[4]+t[8];if(r>0){var n=Math.sqrt(r+1);e[3]=.5*n,n=.5/n,e[0]=(t[5]-t[7])*n,e[1]=(t[6]-t[2])*n,e[2]=(t[1]-t[3])*n}else{var i=0;t[4]>t[0]&&(i=1),t[8]>t[3*i+i]&&(i=2);var a=(i+1)%3,o=(i+2)%3,s=Math.sqrt(t[3*i+i]-t[3*a+a]-t[3*o+o]+1);e[i]=.5*s,s=.5/s,e[3]=(t[3*a+o]-t[3*o+a])*s,e[a]=(t[3*a+i]+t[3*i+a])*s,e[o]=(t[3*o+i]+t[3*i+o])*s}}(o.quaternion,X),te(Y,n,i),ne(Y,Y,.5),ne(o.center,e,Y[0]),ne(Z,t,Y[1]),te(o.center,o.center,Z),ne(Z,r,Y[2]),te(o.center,o.center,Z),ne(o.halfSize,a,.5)}var J=function e(t){Object(n.a)(this,e),this.minVert=new Array(7),this.maxVert=new Array(7);this.buffer=new ArrayBuffer(448);var r=0;this.minProj=new Float64Array(this.buffer,r,7),r+=56,this.maxProj=new Float64Array(this.buffer,r,7),r+=56;for(var i=0;i<7;++i)this.minVert[i]=new Float64Array(this.buffer,r,3),r+=24;for(var a=0;a<7;++a)this.maxVert[a]=new Float64Array(this.buffer,r,3),r+=24;for(var o=0;o<7;++o)this.minProj[o]=Number.POSITIVE_INFINITY,this.maxProj[o]=Number.NEGATIVE_INFINITY;for(var s=new Array(7),c=new Array(7),l=t.data,u=t.size,d=0;d<l.length;d+=u){var h=l[d];h<this.minProj[0]&&(this.minProj[0]=h,s[0]=d),h>this.maxProj[0]&&(this.maxProj[0]=h,c[0]=d),(h=l[d+1])<this.minProj[1]&&(this.minProj[1]=h,s[1]=d),h>this.maxProj[1]&&(this.maxProj[1]=h,c[1]=d),(h=l[d+2])<this.minProj[2]&&(this.minProj[2]=h,s[2]=d),h>this.maxProj[2]&&(this.maxProj[2]=h,c[2]=d),(h=l[d]+l[d+1]+l[d+2])<this.minProj[3]&&(this.minProj[3]=h,s[3]=d),h>this.maxProj[3]&&(this.maxProj[3]=h,c[3]=d),(h=l[d]+l[d+1]-l[d+2])<this.minProj[4]&&(this.minProj[4]=h,s[4]=d),h>this.maxProj[4]&&(this.maxProj[4]=h,c[4]=d),(h=l[d]-l[d+1]+l[d+2])<this.minProj[5]&&(this.minProj[5]=h,s[5]=d),h>this.maxProj[5]&&(this.maxProj[5]=h,c[5]=d),(h=l[d]-l[d+1]-l[d+2])<this.minProj[6]&&(this.minProj[6]=h,s[6]=d),h>this.maxProj[6]&&(this.maxProj[6]=h,c[6]=d)}for(var f=0;f<7;++f){var p=s[f];ie(this.minVert[f],l,p),p=c[f],ie(this.maxVert[f],l,p)}},K=function e(){Object(n.a)(this,e),this.b0=[1,0,0],this.b1=[0,1,0],this.b2=[0,0,1],this.quality=0};function ee(e){return e[0]*e[1]+e[0]*e[2]+e[1]*e[2]}function te(e,t,r){e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2]}function re(e,t,r){e[0]=t[0]-r[0],e[1]=t[1]-r[1],e[2]=t[2]-r[2]}function ne(e,t,r){e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r}function ie(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;e[0]=t[r+0],e[1]=t[r+1],e[2]=t[r+2]}function ae(e,t,r){var n=t[0],i=t[1],a=t[2],o=r[0],s=r[1],c=r[2];e[0]=i*c-a*s,e[1]=a*o-n*c,e[2]=n*s-i*o}function oe(e,t){var r=t[0]*t[0]+t[1]*t[1]+t[2]*t[2];if(r>0){var n=1/Math.sqrt(r);e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n}}function se(e){return e[0]*e[0]+e[1]*e[1]+e[2]*e[2]}function ce(e,t){var r=t[0]-e[0],n=t[1]-e[1],i=t[2]-e[2];return r*r+n*n+i*i}function le(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}var ue=Object(c.b)(),de=Object(d.e)(),he=Object(d.e)(),fe=(Object(h.e)(),Object(a.b)()),pe=function e(t){Object(n.a)(this,e);var r=56*t;this.buffer=new ArrayBuffer(r),this.obbs=new Array(t);for(var i=0;i<t;i++)this.obbs[i]={center:Object(d.d)(this.buffer,56*i+0),halfSize:Object(u.b)(this.buffer,56*i+24),quaternion:Object(s.c)(this.buffer,56*i+36)}};function be(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[0,0,0],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[-1,-1,-1],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[0,0,0,1];return{center:Object(d.c)(e),halfSize:Object(u.a)(t),quaternion:Object(s.a)(r)}}function ve(e){return be(e.center,e.halfSize,e.quaternion)}function me(e,t){Object(l.m)(t.center,e.center),Object(l.m)(t.halfSize,e.halfSize),Object(o.a)(t.quaternion,e.quaternion)}function ye(e,t){return y(e,t=t||be()),t}function ge(e,t){var r=Object(p.w)(t,e.center),n=ke(e,Object(p.s)(t));return r>n?1:r<-n?-1:0}function Oe(e,t){t||(t=Object(f.h)());var r=Object(i.h)(fe,e.quaternion),n=e.halfSize[0]*Math.abs(r[0])+e.halfSize[1]*Math.abs(r[3])+e.halfSize[2]*Math.abs(r[6]),a=e.halfSize[0]*Math.abs(r[1])+e.halfSize[1]*Math.abs(r[4])+e.halfSize[2]*Math.abs(r[7]),o=e.halfSize[0]*Math.abs(r[2])+e.halfSize[1]*Math.abs(r[5])+e.halfSize[2]*Math.abs(r[8]);return t[0]=e.center[0]-n,t[1]=e.center[1]-a,t[2]=e.center[2]-o,t[3]=e.center[0]+n,t[4]=e.center[1]+a,t[5]=e.center[2]+o,t}function je(e,t){return Object(p.w)(t,e.center)-ke(e,Object(p.s)(t))}function _e(e,t){return Object(p.w)(t,e.center)+ke(e,Object(p.s)(t))}function we(e,t){return ge(e,t[0])<=0&&ge(e,t[1])<=0&&ge(e,t[2])<=0&&ge(e,t[3])<=0&&ge(e,t[4])<=0&&ge(e,t[5])<=0}function xe(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;Object(o.b)(ue,e.quaternion),Object(l.l)(de,t,e.center);for(var i=Object(l.w)(de,de,ue),a=Object(l.w)(he,r,ue),s=-1/0,c=1/0,u=0;u<3;u++)if(Math.abs(a[u])>1e-6){var d=(n+e.halfSize[u]-i[u])/a[u],h=(-n-e.halfSize[u]-i[u])/a[u];s=Math.max(s,Math.min(d,h)),c=Math.min(c,Math.max(d,h))}else if(i[u]>e.halfSize[u]+n||i[u]<-e.halfSize[u]-n)return!1;return s<=c}!function(){var e=new Int8Array(162),t=0,r=function(r){for(var n=0;n<r.length;n++)e[t+n]=r[n];t+=6};r([6,2,3,1,5,4]),r([0,2,3,1,5,4]),r([0,2,3,7,5,4]),r([0,1,3,2,6,4]),r([0,1,3,2,0,0]),r([0,1,5,7,3,2]),r([0,1,3,7,6,4]),r([0,1,3,7,6,2]),r([0,1,5,7,6,2]),r([0,1,5,4,6,2]),r([0,1,5,4,0,0]),r([0,1,3,7,5,4]),r([0,2,6,4,0,0]),r([0,0,0,0,0,0]),r([1,3,7,5,0,0]),r([2,3,7,6,4,0]),r([2,3,7,6,0,0]),r([2,3,1,5,7,6]),r([0,1,5,7,6,2]),r([0,1,5,7,6,4]),r([0,1,3,7,6,4]),r([4,5,7,6,2,0]),r([4,5,7,6,0,0]),r([4,5,1,3,7,6]),r([0,2,3,7,5,4]),r([6,2,3,7,5,4]),r([6,2,3,1,5,4])}();function ke(e,t){Object(o.b)(ue,e.quaternion),Object(l.w)(de,t,ue);var r=e.halfSize;return Math.abs(de[0]*r[0])+Math.abs(de[1]*r[1])+Math.abs(de[2]*r[2])}function Se(e,t){for(var r=0;r<8;++r){var n=t[r];n[0]=1&r?-e.halfSize[0]:e.halfSize[0],n[1]=2&r?-e.halfSize[1]:e.halfSize[1],n[2]=4&r?-e.halfSize[2]:e.halfSize[2],Object(l.w)(n,n,e.quaternion),Object(l.h)(n,n,e.center)}}},function(e,t,r){"use strict";var n,i=r(50),a=r(13),o=r(8),s=r.n(o),c=r(14),l=r(16),u=r(2),d=r(5),h=r(6),f=r(7),p=r(0),b=r(98),v=r(22),m=r(25),y=r(15),g=r(3),O=r(113),j=r(1),_=r(64),w=(r(17),r(52)),x=r(48),k=r(10),S=r(44),T=r(577),C=r(18),M=r(103),P=r(149),A=r(190),E=r(286),R=r(334),I=r(371),D=r(435),F=r(153),L=r(130),z=r(557),V=r(227),N=y.a.getLogger("esri.renderers.UniqueValueRenderer"),U=Object(C.m)(D.a),B=n=function(e){Object(h.a)(r,e);var t=Object(f.a)(r);function r(e){var n;return Object(u.a)(this,r),(n=t.call(this,e))._valueInfoMap={},n._isDefaultSymbolDerived=!1,n.type="unique-value",n.backgroundFillSymbol=null,n.field=null,n.field2=null,n.field3=null,n.valueExpression=null,n.valueExpressionTitle=null,n.legendOptions=null,n.defaultLabel=null,n.fieldDelimiter=null,n.portal=null,n.styleOrigin=null,n.diff={uniqueValueInfos:function(e,t){if(e||t){if(!e||!t)return{type:"complete",oldValue:e,newValue:t};for(var r=!1,n={type:"collection",added:[],removed:[],changed:[],unchanged:[]},i=function(i){var a=e.find((function(e){return e.value===t[i].value}));a?Object(T.a)(a,t[i])?(n.changed.push({type:"complete",oldValue:a,newValue:t[i]}),r=!0):n.unchanged.push({oldValue:a,newValue:t[i]}):(n.added.push(t[i]),r=!0)},a=0;a<t.length;a++)i(a);for(var o=function(i){t.find((function(t){return t.value===e[i].value}))||(n.removed.push(e[i]),r=!0)},s=0;s<e.length;s++)o(s);return r?n:void 0}}},n._set("uniqueValueInfos",[]),n}return Object(d.a)(r,[{key:"_cache",get:function(){return{compiledFunc:null}}},{key:"castField",value:function(e){return null==e||"function"==typeof e?e:Object(C.l)(e)}},{key:"writeField",value:function(e,t,r,n){"string"==typeof e?t[r]=e:n&&n.messages?n.messages.push(new v.a("property:unsupported","UniqueValueRenderer.field set to a function cannot be written to JSON")):N.error(".field: cannot write field to JSON since it's not a string value")}},{key:"defaultSymbol",set:function(e){this._isDefaultSymbolDerived=!1,this._set("defaultSymbol",e)}},{key:"readPortal",value:function(e,t,r){return r.portal||P.a.getDefault()}},{key:"readStyleOrigin",value:function(e,t,r){if(t.styleName)return Object.freeze({styleName:t.styleName});if(t.styleUrl){var n=Object(L.a)(t.styleUrl,r);return Object.freeze({styleUrl:n})}}},{key:"writeStyleOrigin",value:function(e,t,r,n){e.styleName?t.styleName=e.styleName:e.styleUrl&&(t.styleUrl=Object(L.e)(e.styleUrl,n))}},{key:"uniqueValueInfos",set:function(e){this.styleOrigin?N.error("#uniqueValueInfos=","Cannot modify unique value infos of a UniqueValueRenderer created from a web style"):(this._set("uniqueValueInfos",e),this._updateValueInfoMap())}},{key:"addUniqueValueInfo",value:function(e,t){var r;this.styleOrigin?N.error("#addUniqueValueInfo()","Cannot modify unique value infos of a UniqueValueRenderer created from a web style"):(r="object"==typeof e?U(e):new D.a({value:e,symbol:Object(b.a)(t)}),this.uniqueValueInfos.push(r),this._valueInfoMap[r.value]=r)}},{key:"removeUniqueValueInfo",value:function(e){if(this.styleOrigin)N.error("#removeUniqueValueInfo()","Cannot modify unique value infos of a UniqueValueRenderer created from a web style");else for(var t=0;t<this.uniqueValueInfos.length;t++)if(this.uniqueValueInfos[t].value===e+""){delete this._valueInfoMap[e],this.uniqueValueInfos.splice(t,1);break}}},{key:"getUniqueValueInfo",value:function(){var e=Object(l.a)(s.a.mark((function e(t,r){var n;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=r,e.t0=this.valueExpression&&(Object(g.i)(r)||Object(g.i)(r.arcade)),!e.t0){e.next=11;break}return e.t1=c.a,e.t2=Object(c.a)({},n),e.t3={},e.next=8,Object(F.e)();case 8:e.t4=e.sent,e.t5={arcade:e.t4},n=(0,e.t1)(e.t2,e.t3,e.t5);case 11:return e.abrupt("return",this._getUniqueValueInfo(t,n));case 12:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"getSymbol",value:function(e,t){if(!this.valueExpression||!Object(g.i)(t)&&!Object(g.i)(t.arcade)){var r=this._getUniqueValueInfo(e,t);return r&&r.symbol||this.defaultSymbol}N.error("#getSymbol()","Please use getSymbolAsync if valueExpression is used")}},{key:"getSymbolAsync",value:function(){var e=Object(l.a)(s.a.mark((function e(t,r){var n,i,a,o;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=r,!this.valueExpression||!Object(g.i)(n)&&!Object(g.i)(n.arcade)){e.next=11;break}return e.next=4,Object(F.e)();case 4:if(i=e.sent,a=i.arcadeUtils,e.t0=a.hasGeometryOperations(this.valueExpression),!e.t0){e.next=10;break}return e.next=10,a.enableGeometryOperations();case 10:n=Object(c.a)(Object(c.a)({},n),{},{arcade:i});case 11:return o=this._getUniqueValueInfo(t,n),e.abrupt("return",o&&o.symbol||this.defaultSymbol);case 13:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"getSymbols",value:function(){var e,t=[],r=Object(a.a)(this.uniqueValueInfos);try{for(r.s();!(e=r.n()).done;){var n=e.value;n.symbol&&t.push(n.symbol)}}catch(i){r.e(i)}finally{r.f()}return this.defaultSymbol&&t.push(this.defaultSymbol),t}},{key:"getAttributeHash",value:function(){return this.visualVariables&&this.visualVariables.reduce((function(e,t){return e+t.getAttributeHash()}),"")}},{key:"getMeshHash",value:function(){return"".concat(JSON.stringify(this.backgroundFillSymbol),".").concat(JSON.stringify(this.defaultSymbol),".").concat(this.uniqueValueInfos.reduce((function(e,t){return e+t.getMeshHash()}),""),".","".concat(this.field,".").concat(this.field2,".").concat(this.field3,".").concat(this.fieldDelimiter),".").concat(this.valueExpression)}},{key:"clone",value:function(){var e=new n({field:this.field,field2:this.field2,field3:this.field3,defaultLabel:this.defaultLabel,defaultSymbol:Object(m.a)(this.defaultSymbol),valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle,fieldDelimiter:this.fieldDelimiter,visualVariables:Object(m.a)(this.visualVariables),legendOptions:Object(m.a)(this.legendOptions),authoringInfo:this.authoringInfo&&this.authoringInfo.clone(),backgroundFillSymbol:Object(m.a)(this.backgroundFillSymbol)});this._isDefaultSymbolDerived&&(e._isDefaultSymbolDerived=!0),e._set("portal",this.portal);var t=Object(m.a)(this.uniqueValueInfos);return this.styleOrigin&&(e._set("styleOrigin",Object.freeze(Object(m.a)(this.styleOrigin))),Object.freeze(t)),e._set("uniqueValueInfos",t),e._updateValueInfoMap(),e}},{key:"arcadeRequired",get:function(){return this.arcadeRequiredForVisualVariables||!!this.valueExpression}},{key:"collectRequiredFields",value:function(){var e=Object(l.a)(s.a.mark((function e(t,r){var n;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=[this.collectVVRequiredFields(t,r),this.collectSymbolFields(t,r)],e.next=3,Promise.all(n);case 3:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"collectSymbolFields",value:function(){var e=Object(l.a)(s.a.mark((function e(t,r){var n;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=[].concat(Object(i.a)(this.getSymbols().map((function(e){return e.collectRequiredFields(t,r)}))),[Object(M.a)(t,r,this.valueExpression)]),Object(M.d)(t,r,this.field),Object(M.d)(t,r,this.field2),Object(M.d)(t,r,this.field3),e.next=6,Promise.all(n);case 6:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"populateFromStyle",value:function(){var e=this;return Object(z.fetchStyle)(this.styleOrigin,{portal:this.portal}).then((function(t){var r=[];return e._valueInfoMap={},t&&t.data&&Array.isArray(t.data.items)&&t.data.items.forEach((function(n){var i=new V.a({styleUrl:t.styleUrl,styleName:t.styleName,portal:e.portal,name:n.name});e.defaultSymbol||n.name!==t.data.defaultItem||(e.defaultSymbol=i,e._isDefaultSymbolDerived=!0);var a=new D.a({value:n.name,symbol:i});r.push(a),e._valueInfoMap[n.name]=a})),e._set("uniqueValueInfos",Object.freeze(r)),!e.defaultSymbol&&e.uniqueValueInfos.length&&(e.defaultSymbol=e.uniqueValueInfos[0].symbol,e._isDefaultSymbolDerived=!0),e}))}},{key:"_updateValueInfoMap",value:function(){var e=this;this._valueInfoMap={},this.uniqueValueInfos.forEach((function(t){return e._valueInfoMap[t.value+""]=t}))}},{key:"_getUniqueValueInfo",value:function(e,t){return this.valueExpression?this._getUnqiueValueInfoForExpression(e,t):this._getUnqiueValueInfoForFields(e)}},{key:"_getUnqiueValueInfoForExpression",value:function(e,t){var r=Object(g.t)(t,{}),n=r.viewingMode,i=r.scale,a=r.spatialReference,o=r.arcade,s=this._cache.compiledFunc,c=Object(g.s)(o).arcadeUtils;if(!s){var l=c.createSyntaxTree(this.valueExpression);s=c.createFunction(l),this._cache.compiledFunc=s}var u=c.executeFunction(s,c.createExecContext(e,c.getViewInfo({viewingMode:n,scale:i,spatialReference:a})));return this._valueInfoMap[u+""]}},{key:"_getUnqiueValueInfoForFields",value:function(e){var t,r=this.field,n=e.attributes;if("function"!=typeof r&&this.field2){var i=this.field2,a=this.field3,o=[];r&&o.push(n[r]),i&&o.push(n[i]),a&&o.push(n[a]),t=o.join(this.fieldDelimiter||"")}else"function"==typeof r?t=r(e):r&&(t=n[r]);return this._valueInfoMap[t+""]}}],[{key:"fromPortalStyle",value:function(e,t){var r=new n(t&&t.properties);r._set("styleOrigin",Object.freeze({styleName:e})),r._set("portal",t&&t.portal||P.a.getDefault());var i=r.populateFromStyle();return i.catch((function(t){N.error("#fromPortalStyle('".concat(e,"'[, ...])"),"Failed to create unique value renderer from style name",t)})),i}},{key:"fromStyleUrl",value:function(e,t){var r=new n(t&&t.properties);r._set("styleOrigin",Object.freeze({styleUrl:e}));var i=r.populateFromStyle();return i.catch((function(t){N.error("#fromStyleUrl('".concat(e,"'[, ...])"),"Failed to create unique value renderer from style URL",t)})),i}}]),r}(Object(E.a)(A.a));Object(p.a)([Object(j.b)({readOnly:!0})],B.prototype,"_cache",null),Object(p.a)([Object(w.a)({uniqueValue:"unique-value"})],B.prototype,"type",void 0),Object(p.a)([Object(j.b)(R.a)],B.prototype,"backgroundFillSymbol",void 0),Object(p.a)([Object(j.b)({json:{type:String,read:{source:"field1"},write:{target:"field1"}}})],B.prototype,"field",void 0),Object(p.a)([Object(_.a)("field")],B.prototype,"castField",null),Object(p.a)([Object(S.a)("field")],B.prototype,"writeField",null),Object(p.a)([Object(j.b)({type:String,json:{write:!0}})],B.prototype,"field2",void 0),Object(p.a)([Object(j.b)({type:String,json:{write:!0}})],B.prototype,"field3",void 0),Object(p.a)([Object(j.b)({type:String,json:{write:!0}})],B.prototype,"valueExpression",void 0),Object(p.a)([Object(j.b)({type:String,json:{write:!0}})],B.prototype,"valueExpressionTitle",void 0),Object(p.a)([Object(j.b)({type:I.a,json:{write:!0}})],B.prototype,"legendOptions",void 0),Object(p.a)([Object(j.b)({type:String,json:{write:!0}})],B.prototype,"defaultLabel",void 0),Object(p.a)([Object(j.b)(Object(O.a)(Object(c.a)({},R.b),{json:{write:{overridePolicy:function(){return{enabled:!this._isDefaultSymbolDerived}}},origins:{"web-scene":{write:{overridePolicy:function(){return{enabled:!this._isDefaultSymbolDerived}}}}}}}))],B.prototype,"defaultSymbol",null),Object(p.a)([Object(j.b)({type:String,json:{write:!0}})],B.prototype,"fieldDelimiter",void 0),Object(p.a)([Object(j.b)({type:P.a,readOnly:!0})],B.prototype,"portal",void 0),Object(p.a)([Object(x.a)("portal",["styleName"])],B.prototype,"readPortal",null),Object(p.a)([Object(j.b)({readOnly:!0,json:{write:{enabled:!1,overridePolicy:function(){return{enabled:!0}}}}})],B.prototype,"styleOrigin",void 0),Object(p.a)([Object(x.a)("styleOrigin",["styleName","styleUrl"])],B.prototype,"readStyleOrigin",null),Object(p.a)([Object(S.a)("styleOrigin",{styleName:{type:String},styleUrl:{type:String}})],B.prototype,"writeStyleOrigin",null),Object(p.a)([Object(j.b)({type:[D.a],json:{write:{overridePolicy:function(){return this.styleOrigin?{enabled:!1}:{enabled:!0}}}}})],B.prototype,"uniqueValueInfos",null);var G=B=n=Object(p.a)([Object(k.a)("esri.renderers.UniqueValueRenderer")],B);t.a=G},function(e,t,r){"use strict";r.d(t,"a",(function(){return i})),r.d(t,"b",(function(){return n}));var n={value:.5,readOnly:!0},i={readOnly:!0,value:.5,get:function(){return this.updating?this.updatingProgressValue:1}}},function(e,t,r){"use strict";var n,i=r(8),a=r.n(i),o=r(16),s=r(2),c=r(5),l=r(6),u=r(7),d=r(0),h=r(25),f=r(1),p=(r(18),r(17),r(15),r(52)),b=r(10),v=r(190),m=r(286),y=r(334),g=n=function(e){Object(l.a)(r,e);var t=Object(u.a)(r);function r(e){var n;return Object(s.a)(this,r),(n=t.call(this,e)).description=null,n.label=null,n.symbol=null,n.type="simple",n}return Object(c.a)(r,[{key:"collectRequiredFields",value:function(){var e=Object(o.a)(a.a.mark((function e(t,r){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([this.collectSymbolFields(t,r),this.collectVVRequiredFields(t,r)]);case 2:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"collectSymbolFields",value:function(){var e=Object(o.a)(a.a.mark((function e(t,r){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all(this.getSymbols().map((function(e){return e.collectRequiredFields(t,r)})));case 2:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"getSymbol",value:function(e,t){return this.symbol}},{key:"getSymbolAsync",value:function(){var e=Object(o.a)(a.a.mark((function e(t,r){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.symbol);case 1:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"getSymbols",value:function(){return this.symbol?[this.symbol]:[]}},{key:"getAttributeHash",value:function(){return this.visualVariables&&this.visualVariables.reduce((function(e,t){return e+t.getAttributeHash()}),"")}},{key:"getMeshHash",value:function(){return this.getSymbols().reduce((function(e,t){return e+JSON.stringify(t)}),"")}},{key:"arcadeRequired",get:function(){return this.arcadeRequiredForVisualVariables}},{key:"clone",value:function(){return new n({description:this.description,label:this.label,symbol:this.symbol&&this.symbol.clone(),visualVariables:Object(h.a)(this.visualVariables),authoringInfo:this.authoringInfo&&this.authoringInfo.clone()})}}]),r}(Object(m.a)(v.a));Object(d.a)([Object(f.b)({type:String,json:{write:!0}})],g.prototype,"description",void 0),Object(d.a)([Object(f.b)({type:String,json:{write:!0}})],g.prototype,"label",void 0),Object(d.a)([Object(f.b)(y.b)],g.prototype,"symbol",void 0),Object(d.a)([Object(p.a)({simple:"simple"})],g.prototype,"type",void 0);var O=g=n=Object(d.a)([Object(b.a)("esri.renderers.SimpleRenderer")],g);t.a=O},function(e,t,r){"use strict";r.r(t);var n=r(8),i=r.n(n),a=r(16),o=r(14),s=r(2),c=r(5),l=r(6),u=r(7),d=r(0),h=r(93),f=r(22),p=r(27),b=r(25),v=r(180),m=r(3),y=r(39),g=r(1),O=r(18),j=(r(17),r(15)),_=r(48),w=r(10),x=r(66),k=r(149),S=r(30),T=r(64),C=j.a.getLogger("esri.portal.PortalItemResource"),M=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(e){var r;return Object(s.a)(this,n),(r=t.call(this,e)).portalItem=null,r}return Object(c.a)(n,[{key:"normalizeCtorArgs",value:function(e){return e&&e.portalItem&&e.path?Object(o.a)(Object(o.a)({},e),{},{path:this.normalizePath(e.path,e.portalItem)}):e}},{key:"path",set:function(e){Object(m.j)(e)&&Object(y.s)(e)?C.error("portalitemresource:invalid-path","A portal item resource path must be relative"):this._set("path",e)}},{key:"_castPath",value:function(e){return this.normalizePath(e,this.portalItem)}},{key:"url",get:function(){return this.portalItem&&this.path?"".concat(this.portalItem.itemUrl,"/resources/").concat(this.path):null}},{key:"itemRelativeUrl",get:function(){return this.portalItem&&this.path?"./resources/".concat(this.path):null}},{key:"fetch",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"json",t=arguments.length>1?arguments[1]:void 0,r=this.url;if(Object(m.i)(r))throw new f.a("portal-item-resource:fetch","Portal item resource does not refer to a valid item or path");return this.portalItem.portal._request(r,{responseType:e,query:{token:this.portalItem.apiKey},signal:Object(m.h)(t,"signal")})}},{key:"update",value:function(){var e=Object(a.a)(i.a.mark((function e(t,n){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.e(6).then(r.bind(null,918));case 2:return e.abrupt("return",e.sent.addOrUpdateResource(this,"update",t,n));case 3:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"hasPath",value:function(){return Object(m.j)(this.path)}},{key:"normalizePath",value:function(e,t){return Object(m.i)(e)?e:(e=e.replace(/^\/+/,""),Object(m.j)(t)&&Object(y.s)(e)&&(e=Object(y.C)(e,t.itemUrl)),e.replace(/^\/+/,"").replace(/^(\.\/)?resources\//,""))}}]),n}(S.a);Object(d.a)([Object(g.b)()],M.prototype,"portalItem",void 0),Object(d.a)([Object(g.b)({type:String,value:null})],M.prototype,"path",null),Object(d.a)([Object(T.a)("path")],M.prototype,"_castPath",null),Object(d.a)([Object(g.b)({type:String,readOnly:!0})],M.prototype,"url",null),Object(d.a)([Object(g.b)({type:String,readOnly:!0})],M.prototype,"itemRelativeUrl",null);var P=M=Object(d.a)([Object(w.a)("esri.portal.PortalItemResource")],M),A=function(e){Object(l.a)(r,e);var t=Object(u.a)(r);function r(e){var n;return Object(s.a)(this,r),(n=t.call(this,e)).created=null,n.rating=null,n}return r}(S.a);Object(d.a)([Object(g.b)()],A.prototype,"created",void 0),Object(d.a)([Object(g.b)()],A.prototype,"rating",void 0);var E,R=A=Object(d.a)([Object(w.a)("esri.portal.PortalRating")],A),I=E=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(e){var r;return Object(s.a)(this,n),(r=t.call(this,e)).access=null,r.accessInformation=null,r.apiKey=null,r.applicationProxies=null,r.avgRating=null,r.categories=null,r.created=null,r.culture=null,r.description=null,r.extent=null,r.groupCategories=null,r.id=null,r.itemControl=null,r.licenseInfo=null,r.modified=null,r.name=null,r.numComments=null,r.numRatings=null,r.numViews=null,r.owner=null,r.ownerFolder=null,r.portal=null,r.screenshots=null,r.size=null,r.snippet=null,r.sourceJSON=null,r.tags=null,r.title=null,r.type=null,r.typeKeywords=null,r.url=null,r}return Object(c.a)(n,[{key:"destroy",value:function(){this.portal=null}},{key:"displayName",get:function(){var e=this.type,t=this.typeKeywords||[],r=e;return"Feature Service"===e||"Feature Collection"===e?r=t.indexOf("Table")>-1?"Table":t.indexOf("Route Layer")>-1?"Route Layer":t.indexOf("Markup")>-1?"Markup":"Feature Layer":"Image Service"===e?r=t.indexOf("Elevation 3D Layer")>-1?"Elevation Layer":t.indexOf("Tiled Imagery")>-1?"Tiled Imagery Layer":"Imagery Layer":"Scene Service"===e?r="Scene Layer":"Scene Package"===e?r="Scene Layer Package":"Stream Service"===e?r="Feature Layer":"Geoprocessing Service"===e&&this.portal&&this.portal.isPortal?r=t.indexOf("Web Tool")>-1?"Tool":"Geoprocessing Service":"Geocoding Service"===e?r="Locator":"Geoenrichment Service"===e?r="GeoEnrichment Service":"Microsoft Powerpoint"===e?r="Microsoft PowerPoint":"GeoJson"===e?r="GeoJSON":"Globe Service"===e?r="Globe Layer":"Vector Tile Service"===e?r="Tile Layer":"netCDF"===e?r="NetCDF":"Map Service"===e?r=-1===t.indexOf("Spatiotemporal")&&(t.indexOf("Hosted Service")>-1||t.indexOf("Tiled")>-1)&&-1===t.indexOf("Relational")?"Tile Layer":"Map Image Layer":e&&e.toLowerCase().indexOf("add in")>-1?r=e.replace(/(add in)/gi,"Add-In"):"datastore catalog service"===e?r="Big Data File Share":"Compact Tile Package"===e?r="Tile Package (tpkx)":"OGCFeatureServer"===e&&(r="OGC Feature Layer"),r}},{key:"readExtent",value:function(e){return e&&e.length?new x.a(e[0][0],e[0][1],e[1][0],e[1][1]):null}},{key:"iconUrl",get:function(){var e,t=this.type&&this.type.toLowerCase()||"",r=this.typeKeywords||[],n=!1,i=!1,a=!1,o=!1,s=!1,c=!1;return t.indexOf("service")>0||"feature collection"===t||"kml"===t||"wms"===t||"wmts"===t||"wfs"===t?(n=r.indexOf("Hosted Service")>-1,"feature service"===t||"feature collection"===t||"kml"===t||"wfs"===t?(i=r.indexOf("Table")>-1,a=r.indexOf("Route Layer")>-1,o=r.indexOf("Markup")>-1,s=-1!==r.indexOf("Spatiotemporal"),c=-1!==r.indexOf("UtilityNetwork"),e=s&&i?"spatiotemporaltable":i?"table":a?"routelayer":o?"markup":s?"spatiotemporal":n?"featureshosted":c?"utilitynetwork":"features"):e="map service"===t||"wms"===t||"wmts"===t?n||r.indexOf("Tiled")>-1||"wmts"===t?"maptiles":"mapimages":"scene service"===t?r.indexOf("Line")>-1?"sceneweblayerline":r.indexOf("3DObject")>-1?"sceneweblayermultipatch":r.indexOf("Point")>-1?"sceneweblayerpoint":r.indexOf("IntegratedMesh")>-1?"sceneweblayermesh":r.indexOf("PointCloud")>-1?"sceneweblayerpointcloud":r.indexOf("Polygon")>-1?"sceneweblayerpolygon":r.indexOf("Building")>-1?"sceneweblayerbuilding":r.indexOf("Voxel")>-1?"sceneweblayervoxel":"sceneweblayer":"image service"===t?r.indexOf("Elevation 3D Layer")>-1?"elevationlayer":r.indexOf("Tiled Imagery")>-1?"tiledimagerylayer":"imagery":"stream service"===t?"streamlayer":"vector tile service"===t?"vectortile":"datastore catalog service"===t?"datastorecollection":"geocoding service"===t?"geocodeservice":"geoprocessing service"===t&&r.indexOf("Web Tool")>-1&&this.portal&&this.portal.isPortal?"tool":"layers"):e="web map"===t||"cityengine web scene"===t?"maps":"web scene"===t?r.indexOf("ViewingMode-Local")>-1?"webscenelocal":"websceneglobal":"web mapping application"===t||"mobile application"===t||"application"===t||"operation view"===t||"desktop application"===t?"apps":"map document"===t||"map package"===t||"published map"===t||"scene document"===t||"globe document"===t||"basemap package"===t||"mobile basemap package"===t||"mobile map package"===t||"project package"===t||"project template"===t||"pro map"===t||"layout"===t||"layer"===t&&r.indexOf("ArcGIS Pro")>-1||"explorer map"===t&&r.indexOf("Explorer Document")?"mapsgray":"service definition"===t||"csv"===t||"shapefile"===t||"cad drawing"===t||"geojson"===t||"360 vr experience"===t||"netcdf"===t||"administrative report"===t?"datafiles":"explorer add in"===t||"desktop add in"===t||"windows viewer add in"===t||"windows viewer configuration"===t?"appsgray":"arcgis pro add in"===t||"arcgis pro configuration"===t?"addindesktop":"rule package"===t||"file geodatabase"===t||"sqlite geodatabase"===t||"csv collection"===t||"kml collection"===t||"windows mobile package"===t||"map template"===t||"desktop application template"===t||"gml"===t||"arcpad package"===t||"code sample"===t||"form"===t||"document link"===t||"earth configuration"===t||"operations dashboard add in"===t||"rules package"===t||"image"===t||"workflow manager package"===t||"explorer map"===t&&r.indexOf("Explorer Mapping Application")>-1||r.indexOf("Document")>-1?"datafilesgray":"network analysis service"===t||"geoprocessing service"===t||"geodata service"===t||"geometry service"===t||"geoprocessing package"===t||"locator package"===t||"geoprocessing sample"===t||"workflow manager service"===t?"toolsgray":"layer"===t||"layer package"===t||"explorer layer"===t?"layersgray":"scene package"===t?"scenepackage":"mobile scene package"===t?"mobilescenepackage":"tile package"===t||"compact tile package"===t?"tilepackage":"task file"===t?"taskfile":"report template"===t?"report-template":"statistical data collection"===t?"statisticaldatacollection":"insights workbook"===t?"workbook":"insights model"===t?"insightsmodel":"insights page"===t?"insightspage":"insights theme"===t?"insightstheme":"hub initiative"===t?"hubinitiative":"hubpage"===t?"hubpage":"hub event"===t?"hubevent":"hub site application"===t?"hubsite":"relational database connection"===t?"relationaldatabaseconnection":"big data file share"===t?"datastorecollection":"image collection"===t?"imagecollection":"style"===t?"style":"desktop style"===t?"desktopstyle":"dashboard"===t?"dashboard":"raster function template"===t?"rasterprocessingtemplate":"vector tile package"===t?"vectortilepackage":"ortho mapping project"===t?"orthomappingproject":"ortho mapping template"===t?"orthomappingtemplate":"solution"===t?"solutions":"geopackage"===t?"geopackage":"deep learning package"===t?"deeplearningpackage":"real time analytic"===t?"realtimeanalytics":"big data analytic"===t?"bigdataanalytics":"feed"===t?"feed":"excalibur imagery project"===t?"excaliburimageryproject":"notebook"===t?"notebook":"storymap"===t?"storymap":"survey123 add in"===t?"survey123addin":"mission"===t?"mission":"mission report"===t?"missionreport":"quickcapture project"===t?"quickcaptureproject":"pro report"===t?"proreport":"urban model"===t?"urbanmodel":"web experience"===t?"experiencebuilder":"web experience template"===t?"webexperiencetemplate":"workflow"===t?"workflow":"insights script"===t?"insightsscript":"kernel gateway connection"===t?"kernelgatewayconnection":"hub initiative template"===t?"hubinitiativetemplate":"storymap theme"===t?"storymaptheme":"knowledge graph"===t?"knowledgegraph":"native application"===t?"nativeapp":"native application installer"===t?"nativeappinstaller":"link chart"===t?"linkchart":"investigation"===t?"investigation":"ogcfeatureserver"===t?"features":"pro project"===t?"proproject":"insights workbook package"===t?"insightsworkbookpackage":"maps",e?Object(h.b)("esri/images/portal/"+e+"16.png"):null}},{key:"isLayer",get:function(){return["Map Service","Feature Service","Feature Collection","Scene Service","Image Service","Stream Service","Vector Tile Service","WMTS","WMS"].indexOf(this.type)>-1}},{key:"itemUrl",get:function(){var e=this.get("portal.restUrl");return e?e+"/content/items/"+this.id:null}},{key:"thumbnailUrl",get:function(){var e=this.itemUrl,t=this.thumbnail;return e&&t?this.portal._normalizeUrl("".concat(e,"/info/").concat(t,"?f=json")):null}},{key:"userItemUrl",get:function(){var e=this.get("portal.restUrl");if(!e)return null;var t=this.owner||this.get("portal.user.username");return t?"".concat(e,"/content/users/").concat(this.ownerFolder?"".concat(t,"/").concat(this.ownerFolder):t,"/items/").concat(this.id):null}},{key:"load",value:function(e){var t=this;this.portal||(this.portal=k.a.getDefault());var r=this.portal.load(e).then((function(){return t.sourceJSON?t.sourceJSON:t.id&&t.itemUrl?t.portal._request(t.itemUrl,{signal:Object(m.j)(e)?e.signal:null,query:{token:t.apiKey}}):{}})).then((function(e){t.sourceJSON=e,t.read(e)}));return this.addResolvingPromise(r),Promise.resolve(this)}},{key:"addRating",value:function(e){var t={method:"post",query:{}};return e instanceof R&&(e=e.rating),isNaN(e)||"number"!=typeof e||(t.query.rating=e),this.portal._request(this.itemUrl+"/addRating",t).then((function(){return new R({rating:e,created:new Date})}))}},{key:"clone",value:function(){var e={access:this.access,accessInformation:this.accessInformation,applicationProxies:Object(b.a)(this.applicationProxies),avgRating:this.avgRating,categories:Object(b.a)(this.categories),created:Object(b.a)(this.created),culture:this.culture,description:this.description,extent:Object(b.a)(this.extent),groupCategories:Object(b.a)(this.groupCategories),id:this.id,itemControl:this.itemControl,licenseInfo:this.licenseInfo,modified:Object(b.a)(this.modified),name:this.name,numComments:this.numComments,numRatings:this.numRatings,numViews:this.numViews,owner:this.owner,ownerFolder:this.ownerFolder,portal:this.portal,screenshots:Object(b.a)(this.screenshots),size:this.size,snippet:this.snippet,tags:Object(b.a)(this.tags),thumbnail:this.thumbnail,title:this.title,type:this.type,typeKeywords:Object(b.a)(this.typeKeywords),url:this.url};return this.loaded&&(e.loadStatus="loaded"),new E({sourceJSON:this.sourceJSON}).set(e)}},{key:"createPostQuery",value:function(){var e=this.toJSON();for(var t in e)"tags"===t&&null!==e[t]&&(e[t]=e[t].join(", ")),"typeKeywords"===t&&null!==e[t]&&(e[t]=e[t].join(", ")),"extent"===t&&e[t]&&(e[t]=JSON.stringify(e[t]));return e}},{key:"deleteRating",value:function(){return this.portal._request(this.itemUrl+"/deleteRating",{method:"post"}).then((function(){}))}},{key:"fetchData",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"json",t=arguments.length>1?arguments[1]:void 0;return this.portal._request(this.itemUrl+"/data",Object(o.a)(Object(o.a)({responseType:e},t),{},{query:{token:this.apiKey}}))}},{key:"fetchRating",value:function(e){return this.portal._request(this.itemUrl+"/rating",Object(o.a)({query:{token:this.apiKey}},e)).then((function(e){return null!=e.rating?(e.created=new Date(e.created),new R(e)):null}))}},{key:"fetchRelatedItems",value:function(e,t){return this.portal._requestToTypedArray(this.itemUrl+"/relatedItems",Object(o.a)({query:Object(o.a)(Object(o.a)({},e),{},{token:this.apiKey})},t),E)}},{key:"getThumbnailUrl",value:function(e){var t=this.thumbnailUrl;return t&&e&&(t+="&w=".concat(e)),t}},{key:"reload",value:function(){var e=this;return this.portal._request(this.itemUrl,{cacheBust:!0,query:{token:this.apiKey}}).then((function(t){return e.sourceJSON=t,e.read(t),e}))}},{key:"update",value:function(e){var t=this;return this.id?this.load().then((function(){return t.portal._signIn()})).then((function(){var r=e&&e.data,n={method:"post"};for(var i in n.query=t.createPostQuery(),n.query)null===n.query[i]&&(n.query[i]="");return n.query.clearEmptyFields=!0,null!=r&&("string"==typeof r?n.query.text=r:"object"==typeof r&&(n.query.text=JSON.stringify(r))),t.portal._request("".concat(t.userItemUrl,"/update"),n).then((function(){return t.reload()}))})):Promise.reject(new f.a("portal:item-does-not-exist","The item does not exist yet and cannot be updated"))}},{key:"updateThumbnail",value:function(e){var t=this;return this.id?this.load().then((function(){return t.portal._signIn()})).then((function(){var r=e.thumbnail,n=e.filename,i={method:"post"};if("string"==typeof r)Object(y.u)(r)?i.query={data:r}:i.query={url:Object(y.A)(r)},Object(m.j)(n)&&(i.query.filename=n);else{var a=new FormData;Object(m.j)(n)?a.append("file",r,n):a.append("file",r),i.body=a}return t.portal._request("".concat(t.userItemUrl,"/updateThumbnail"),i).then((function(){return t.reload()}))})):Promise.reject(new f.a("portal:item-does-not-exist","The item does not exist yet and cannot be updated"))}},{key:"fetchResources",value:function(){var e=Object(a.a)(i.a.mark((function e(){var t,n,a=arguments;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=a.length>0&&void 0!==a[0]?a[0]:{},n=a.length>1?a[1]:void 0,e.next=4,r.e(6).then(r.bind(null,918));case 4:return e.abrupt("return",e.sent.fetchResources(this,t,n));case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"addResource",value:function(){var e=Object(a.a)(i.a.mark((function e(t,n,a){var o;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.e(6).then(r.bind(null,918));case 2:return o=e.sent,e.abrupt("return",(t.portalItem=this,o.addOrUpdateResource(t,"add",n,a)));case 4:case"end":return e.stop()}}),e,this)})));return function(t,r,n){return e.apply(this,arguments)}}()},{key:"removeResource",value:function(){var e=Object(a.a)(i.a.mark((function e(t,n){var a;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.e(6).then(r.bind(null,918));case 2:if(a=e.sent,!t.portalItem||t.portalItem.itemUrl===this.itemUrl){e.next=5;break}throw new f.a("removeresource:portal-item-mismatch","The portal item associated with the provided resource does not match the item");case 5:return e.abrupt("return",a.removeResource(this,t,n));case 6:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"removeAllResources",value:function(){var e=Object(a.a)(i.a.mark((function e(t){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.e(6).then(r.bind(null,918));case 2:return e.abrupt("return",e.sent.removeAllResources(this,t));case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"resourceFromPath",value:function(e){return new P({portalItem:this,path:e})}},{key:"toJSON",value:function(){var e=this.extent,t={created:this.created&&this.created.getTime(),description:this.description,extent:e&&[[e.xmin,e.ymin],[e.xmax,e.ymax]],id:this.id,modified:this.modified&&this.modified.getTime(),name:this.name,owner:this.owner,ownerFolder:this.ownerFolder,snippet:this.snippet,tags:this.tags,thumbnail:this.thumbnail,title:this.title,type:this.type,typeKeywords:this.typeKeywords,url:this.url};return Object(b.c)(t)}},{key:"_getPostQuery",value:function(){var e=this.toJSON();for(var t in e)"tags"===t&&null!==e[t]&&(e[t]=e[t].join(", ")),"typeKeywords"===t&&null!==e[t]&&(e[t]=e[t].join(", ")),"extent"===t&&e[t]&&(e[t]=JSON.stringify(e[t]));return e}}],[{key:"from",value:function(e){return Object(O.d)(E,e)}},{key:"fromJSON",value:function(e){if(!e)return null;if(e.declaredClass)throw new Error("JSON object is already hydrated");return new E({sourceJSON:e})}}]),n}(Object(p.b)(v.a));Object(d.a)([Object(g.b)({type:["private","shared","org","public"]})],I.prototype,"access",void 0),Object(d.a)([Object(g.b)()],I.prototype,"accessInformation",void 0),Object(d.a)([Object(g.b)({type:String})],I.prototype,"apiKey",void 0),Object(d.a)([Object(g.b)({json:{read:{source:"appProxies"}}})],I.prototype,"applicationProxies",void 0),Object(d.a)([Object(g.b)()],I.prototype,"avgRating",void 0),Object(d.a)([Object(g.b)()],I.prototype,"categories",void 0),Object(d.a)([Object(g.b)({type:Date})],I.prototype,"created",void 0),Object(d.a)([Object(g.b)()],I.prototype,"culture",void 0),Object(d.a)([Object(g.b)()],I.prototype,"description",void 0),Object(d.a)([Object(g.b)({readOnly:!0})],I.prototype,"displayName",null),Object(d.a)([Object(g.b)({type:x.a})],I.prototype,"extent",void 0),Object(d.a)([Object(_.a)("extent")],I.prototype,"readExtent",null),Object(d.a)([Object(g.b)()],I.prototype,"groupCategories",void 0),Object(d.a)([Object(g.b)({readOnly:!0})],I.prototype,"iconUrl",null),Object(d.a)([Object(g.b)()],I.prototype,"id",void 0),Object(d.a)([Object(g.b)({readOnly:!0})],I.prototype,"isLayer",null),Object(d.a)([Object(g.b)()],I.prototype,"itemControl",void 0),Object(d.a)([Object(g.b)({readOnly:!0})],I.prototype,"itemUrl",null),Object(d.a)([Object(g.b)()],I.prototype,"licenseInfo",void 0),Object(d.a)([Object(g.b)({type:Date})],I.prototype,"modified",void 0),Object(d.a)([Object(g.b)()],I.prototype,"name",void 0),Object(d.a)([Object(g.b)()],I.prototype,"numComments",void 0),Object(d.a)([Object(g.b)()],I.prototype,"numRatings",void 0),Object(d.a)([Object(g.b)()],I.prototype,"numViews",void 0),Object(d.a)([Object(g.b)()],I.prototype,"owner",void 0),Object(d.a)([Object(g.b)()],I.prototype,"ownerFolder",void 0),Object(d.a)([Object(g.b)({type:k.a})],I.prototype,"portal",void 0),Object(d.a)([Object(g.b)()],I.prototype,"screenshots",void 0),Object(d.a)([Object(g.b)()],I.prototype,"size",void 0),Object(d.a)([Object(g.b)()],I.prototype,"snippet",void 0),Object(d.a)([Object(g.b)()],I.prototype,"sourceJSON",void 0),Object(d.a)([Object(g.b)()],I.prototype,"tags",void 0),Object(d.a)([Object(g.b)()],I.prototype,"thumbnail",void 0),Object(d.a)([Object(g.b)({readOnly:!0})],I.prototype,"thumbnailUrl",null),Object(d.a)([Object(g.b)()],I.prototype,"title",void 0),Object(d.a)([Object(g.b)()],I.prototype,"type",void 0),Object(d.a)([Object(g.b)()],I.prototype,"typeKeywords",void 0),Object(d.a)([Object(g.b)()],I.prototype,"url",void 0),Object(d.a)([Object(g.b)({readOnly:!0})],I.prototype,"userItemUrl",null);var D=I=E=Object(d.a)([Object(w.a)("esri.portal.PortalItem")],I);t.default=D},function(e,t,r){"use strict";r.d(t,"a",(function(){return u})),r.d(t,"b",(function(){return d}));var n=r(447),i=r(545),a=r(546),o=r(547),s=r(190),c=r(417),l=r(415),u={key:"type",base:s.a,typeMap:{heatmap:o.a,simple:c.a,"unique-value":l.a,"class-breaks":n.a,"dot-density":a.a,dictionary:i.default},errorContext:"renderer"},d={key:"type",base:s.a,typeMap:{simple:c.a,"unique-value":l.a,"class-breaks":n.a},errorContext:"renderer"}},function(e,t,r){"use strict";r.r(t),r.d(t,"getAllSizes",(function(){return S})),r.d(t,"getColor",(function(){return v})),r.d(t,"getOpacity",(function(){return m})),r.d(t,"getRotationAngle",(function(){return y})),r.d(t,"getSize",(function(){return g})),r.d(t,"getSizeForValue",(function(){return _})),r.d(t,"getSizeFromNumberOrVariable",(function(){return O})),r.d(t,"getSizeRangeAtScale",(function(){return w})),r.d(t,"getVisualVariableValues",(function(){return x})),r.d(t,"viewScaleRE",(function(){return b}));var n=r(13),i=r(33),a=r(49),o=r(137),s=r(134),c=r(15),l=r(3),u=r(313),d=r(215),h=c.a.getLogger("esri.renderers.visualVariables.support.visualVariableUtils"),f=new o.a,p=Math.PI,b=/^\s*(return\s+)?\$view\.scale\s*(;)?\s*$/i;function v(e,t,r){var n="visualVariables"in e&&e.visualVariables?e.visualVariables.filter((function(e){return"color"===e.type}))[0]:e;if(n)if("esri.renderers.visualVariables.ColorVariable"===n.declaredClass){var i="number"==typeof t,o=i?null:t,s=o&&o.attributes,c=i?t:null,u=n.field,d=n.cache,f=d.ipData,p=d.hasExpression,b=n.cache.compiledFunc;if(!u&&!p){var v=n.stops;return v&&v[0]&&v[0].color}if("number"!=typeof c)if(p){if(!Object(l.j)(r)||!Object(l.j)(r.arcade))return void h.error("Use of arcade expressions requires an arcade context");var m={viewingMode:r.viewingMode,scale:r.scale,spatialReference:r.spatialReference},y=r.arcade.arcadeUtils,g=y.getViewInfo(m),O=y.createExecContext(o,g);if(!b){var j=y.createSyntaxTree(n.valueExpression);b=y.createFunction(j),n.cache.compiledFunc=b}c=y.executeFunction(b,O)}else s&&(c=s[u]);var _=n.normalizationField,w=s?parseFloat(s[_]):void 0;if(null!=c&&(!_||i||!isNaN(w)&&0!==w)){isNaN(w)||i||(c/=w);var x=k(c,f);if(x){var S=x[0],T=x[1],C=S===T?n.stops[S].color:a.a.blendColors(n.stops[S].color,n.stops[T].color,x[2],Object(l.j)(r)?r.color:void 0);return new a.a(C)}}}else h.warn("The visualVariable should be an instance of esri.renderers.visualVariables.ColorVariable")}function m(e,t,r){var n="visualVariables"in e&&e.visualVariables?e.visualVariables.filter((function(e){return"opacity"===e.type}))[0]:e;if(n)if("esri.renderers.visualVariables.OpacityVariable"===n.declaredClass){var i="number"==typeof t,a=i?null:t,o=a&&a.attributes,s=i?t:null,c=n.field,u=n.cache,d=u.ipData,f=u.hasExpression,p=n.cache.compiledFunc;if(!c&&!f){var b=n.stops;return b&&b[0]&&b[0].opacity}if("number"!=typeof s)if(f){if(Object(l.i)(r)||Object(l.i)(r.arcade))return void h.error("Use of arcade expressions requires an arcade context");var v={viewingMode:r.viewingMode,scale:r.scale,spatialReference:r.spatialReference},m=r.arcade.arcadeUtils,y=m.getViewInfo(v),g=m.createExecContext(a,y);if(!p){var O=m.createSyntaxTree(n.valueExpression);p=m.createFunction(O),n.cache.compiledFunc=p}s=m.executeFunction(p,g)}else o&&(s=o[c]);var j=n.normalizationField,_=o?parseFloat(o[j]):void 0;if(null!=s&&(!j||i||!isNaN(_)&&0!==_)){isNaN(_)||i||(s/=_);var w=k(s,d);if(w){var x=w[0],S=w[1];if(x===S)return n.stops[x].opacity;var T=n.stops[x].opacity;return T+(n.stops[S].opacity-T)*w[2]}}}else h.warn("The visualVariable should be an instance of esri.renderers.visualVariables.OpacityVariable")}function y(e,t,r){var n="visualVariables"in e&&e.visualVariables?e.visualVariables.filter((function(e){return"rotation"===e.type}))[0]:e;if(n){if("esri.renderers.visualVariables.RotationVariable"===n.declaredClass){var i=n.axis||"heading",a="heading"===i&&"arithmetic"===n.rotationType?90:0,o="heading"===i&&"arithmetic"===n.rotationType?-1:1,s="number"==typeof t?null:t,c=s&&s.attributes,u=n.field,d=n.cache.hasExpression,f=n.cache.compiledFunc,p=0;if(!u&&!d)return p;if(d){if(Object(l.i)(r)||Object(l.i)(r.arcade))return void h.error("Use of arcade expressions requires an arcade context");var b={viewingMode:r.viewingMode,scale:r.scale,spatialReference:r.spatialReference},v=r.arcade.arcadeUtils,m=v.getViewInfo(b),y=v.createExecContext(s,m);if(!f){var g=v.createSyntaxTree(n.valueExpression);f=v.createFunction(g),n.cache.compiledFunc=f}p=v.executeFunction(f,y)}else c&&(p=c[u]||0);return p="number"!=typeof p||isNaN(p)?null:a+o*p}h.warn("The visualVariable should be an instance of esri.renderers.visualVariables.RotationVariable")}}function g(e,t,r){var n="visualVariables"in e&&e.visualVariables?e.visualVariables.filter((function(e){return"size"===e.type}))[0]:e;if(n){if("esri.renderers.visualVariables.SizeVariable"===n.declaredClass){var i=_(function(e,t,r){var n="number"==typeof t,i=n?null:t,a=i&&i.attributes,o=n?t:null,s=e.cache.isScaleDriven,c=e.cache.compiledFunc;if(s){var u=Object(l.j)(r)?r.scale:void 0,f=Object(l.j)(r)?r.view:void 0;o=null==u||"3d"===f?function(e){var t=null,r=null,n=e.stops;return n?(t=n[0].value,r=n[n.length-1].value):(t=e.minDataValue||0,r=e.maxDataValue||0),(t+r)/2}(e):u}else if(!n)switch(e.inputValueType){case"expression":if(Object(l.i)(r)||Object(l.i)(r.arcade))return void h.error("Use of arcade expressions requires an arcade context");var p={viewingMode:r.viewingMode,scale:r.scale,spatialReference:r.spatialReference},b=r.arcade.arcadeUtils,v=b.getViewInfo(p),m=b.createExecContext(i,v);if(!c){var y=b.createSyntaxTree(e.valueExpression);c=b.createFunction(y),e.cache.compiledFunc=c}o=b.executeFunction(c,m);break;case"field":a&&(o=a[e.field]);break;case"unknown":o=null}if(!Object(d.d)(o))return null;if(n||!e.normalizationField)return o;var g=a?parseFloat(a[e.normalizationField]):null;return Object(d.d)(g)&&0!==g?o/g:null}(n,t,r),n,t,r,n.cache.ipData);return null==i||isNaN(i)?0:i}h.warn("The visualVariable should be an instance of esri.renderers.visualVariables.SizeVariable")}}function O(e,t,r){return null==e?null:Object(d.c)(e)?g(e,t,r):Object(d.d)(e)?e:null}function j(e,t,r){return Object(d.d)(r)&&e>r?r:Object(d.d)(t)&&e<t?t:e}function _(e,t,r,n,a){switch(t.transformationType){case"additive":return function(e,t,r,n){return e+(O(t.minSize,r,n)||t.minDataValue)}(e,t,r,n);case"constant":return function(e,t,r){var n=e.stops,i=n&&n.length&&n[0].size;return null==i&&(i=e.minSize),O(i,t,r)}(t,r,n);case"clamped-linear":return function(e,t,r,n){var i=(e-t.minDataValue)/(t.maxDataValue-t.minDataValue),a=O(t.minSize,r,n),o=O(t.maxSize,r,n),s=Object(l.j)(n)?n.shape:void 0;if(e<=t.minDataValue)return a;if(e>=t.maxDataValue)return o;if("area"===t.scaleBy&&s){var c="circle"===s,u=c?p*Math.pow(a/2,2):a*a,d=u+i*((c?p*Math.pow(o/2,2):o*o)-u);return c?2*Math.sqrt(d/p):Math.sqrt(d)}return a+i*(o-a)}(e,t,r,n);case"proportional":return function(e,t,r,n){var i=Object(l.j)(n)?n.shape:void 0,a=e/t.minDataValue,o=O(t.minSize,r,n),s=O(t.maxSize,r,n);return j("circle"===i?2*Math.sqrt(a*Math.pow(o/2,2)):"square"===i||"diamond"===i||"image"===i?Math.sqrt(a*Math.pow(o,2)):a*o,o,s)}(e,t,r,n);case"stops":return function(e,t,r,n,a){var o=k(e,a),s=Object(i.a)(o,3),c=s[0],l=s[1],u=s[2];if(c===l)return O(t.stops[c].size,r,n);var d=O(t.stops[c].size,r,n);return d+(O(t.stops[l].size,r,n)-d)*u}(e,t,r,n,a);case"real-world-size":return function(e,t,r,n){var i=(Object(l.j)(n)&&n.resolution?n.resolution:1)*u.a[t.valueUnit],a=O(t.minSize,r,n),o=O(t.maxSize,r,n),s=t.valueRepresentation;return j("area"===s?2*Math.sqrt(e/p)/i:"radius"===s||"distance"===s?2*e/i:e/i,a,o)}(e,t,r,n);case"identity":return e;case"unknown":return null}}function w(e,t,r){if(!(e.cache.isScaleDriven&&"3d"===r||t))return null;var n={scale:t,view:r},i=O(e.minSize,f,n),a=O(e.maxSize,f,n);if(null!=i||null!=a){if(i>a){var o=a;a=i,i=o}return{minSize:i,maxSize:a}}}function x(e,t,r){if(e.visualVariables){var i,a=[],o=[],s=[],c=[],l=[],u=Object(n.a)(e.visualVariables);try{for(u.s();!(i=u.n()).done;){var d=i.value;switch(d.type){case"color":o.push(d);break;case"opacity":s.push(d);break;case"rotation":l.push(d);break;case"size":c.push(d)}}}catch(h){u.e(h)}finally{u.f()}return o.forEach((function(e){var n=v(e,t,r);a.push({variable:e,value:n})})),s.forEach((function(e){var n=m(e,t,r);a.push({variable:e,value:n})})),l.forEach((function(e){var n=y(e,t,r);a.push({variable:e,value:n})})),c.forEach((function(e){var n=g(e,t,r);a.push({variable:e,value:n})})),a.filter((function(e){return null!=e.value}))}}function k(e,t){if(t){var r=0,n=t.length-1;return t.some((function(t,i){return e<t?(n=i,!0):(r=i,!1)})),[r,n,(e-t[r])/(t[n]-t[r])]}}function S(e,t,r){var i,a=["proportional","proportional","proportional"],o=Object(n.a)(e);try{for(o.s();!(i=o.n()).done;){var c=i.value,l=c.useSymbolValue?"symbol-value":g(c,t,r);switch(c.axis){case"width":a[0]=l;break;case"depth":a[1]=l;break;case"height":a[2]=l;break;case"width-and-depth":a[0]=l,a[1]=l;break;case"all":case void 0:case null:a[0]=l,a[1]=l,a[2]=l;break;default:Object(s.a)(c.axis)}}}catch(u){o.e(u)}finally{o.f()}return a}},function(e,t,r){"use strict";r.d(t,"a",(function(){return a})),r.d(t,"b",(function(){return o})),r.d(t,"c",(function(){return i}));var n=r(313);function i(e){return null!=n.a[e]}function a(e){return 1/(n.a[e]||1)}var o=function(){var e=Object.keys(n.a);return e.sort(),e}()},function(e,t,r){"use strict";var n,i=r(2),a=r(5),o=r(6),s=r(7),c=r(0),l=r(1),u=(r(17),r(18),r(15),r(10)),d=r(375),h=n=function(e){Object(o.a)(r,e);var t=Object(s.a)(r);function r(e){var n;return Object(i.a)(this,r),(n=t.call(this,e)).type="selection",n}return Object(a.a)(r,[{key:"clone",value:function(){return new n}}]),r}(d.a);Object(c.a)([Object(l.b)({type:["selection"]})],h.prototype,"type",void 0);var f=h=n=Object(c.a)([Object(u.a)("esri.layers.support.FeatureReductionSelection")],h);t.a=f},function(e,t,r){"use strict";var n,i=r(2),a=r(5),o=r(6),s=r(7),c=r(0),l=r(25),u=r(1),d=(r(18),r(17),r(15),r(10)),h=r(181),f=n=function(e){Object(o.a)(r,e);var t=Object(s.a)(r);function r(e){var n;return Object(i.a)(this,r),(n=t.call(this,e)).creator=null,n.destroyer=null,n.outFields=null,n.type="custom",n}return Object(a.a)(r,[{key:"clone",value:function(){return new n({creator:this.creator,destroyer:this.destroyer,outFields:Array.isArray(this.outFields)?Object(l.a)(this.outFields):null})}}]),r}(h.a);Object(c.a)([Object(u.b)()],f.prototype,"creator",void 0),Object(c.a)([Object(u.b)()],f.prototype,"destroyer",void 0),Object(c.a)([Object(u.b)()],f.prototype,"outFields",void 0),Object(c.a)([Object(u.b)({type:["custom"],readOnly:!0})],f.prototype,"type",void 0);var p=f=n=Object(c.a)([Object(d.a)("esri.popup.content.CustomContent")],f);t.a=p},function(e,t,r){"use strict";r.d(t,"a",(function(){return o})),r.d(t,"b",(function(){return a}));var n=r(20),i=r(3);function a(e){switch(e){case"multiply":return 1;case"ignore":return 2;case"replace":return 3;case"tint":return 4;default:return 1}}function o(e,t,r){if(Object(i.i)(e)||2===t)return r[0]=255,r[1]=255,r[2]=255,void(r[3]=255);var a=Object(n.e)(Math.round(e[3]*c),0,c),o=0===a||4===t?0:3===t?l:u;r[0]=Object(n.e)(Math.round(e[0]*s),0,s),r[1]=Object(n.e)(Math.round(e[1]*s),0,s),r[2]=Object(n.e)(Math.round(e[2]*s),0,s),r[3]=a+o}var s=255,c=85,l=c,u=2*c},function(e,t,r){"use strict";function n(e,t,r){for(var n=e.typedBuffer,i=e.typedBufferStride,a=t.typedBuffer,o=t.typedBufferStride,s=r?r.count:t.count,c=(r&&r.dstIndex?r.dstIndex:0)*i,l=(r&&r.srcIndex?r.srcIndex:0)*o,u=0;u<s;++u)n[c]=a[l],n[c+1]=a[l+1],n[c+2]=a[l+2],n[c+3]=a[l+3],c+=i,l+=o}function i(e,t,r,n,i,a){for(var o,s,c=e.typedBuffer,l=e.typedBufferStride,u=null!=(o=null==a?void 0:a.count)?o:e.count,d=(null!=(s=null==a?void 0:a.dstIndex)?s:0)*l,h=0;h<u;++h)c[d]=t,c[d+1]=r,c[d+2]=n,c[d+3]=i,d+=l}r.d(t,"a",(function(){return n})),r.d(t,"b",(function(){return i}));Object.freeze({__proto__:null,copy:n,fill:i})},function(e,t,r){"use strict";r.d(t,"a",(function(){return d}));var n,i,a,o,s=r(12),c=r(534),l=r(498),u=r(11);function d(e,t){e.extensions.add("GL_OES_standard_derivatives"),3!==t.pbrMode&&4!==t.pbrMode||e.include(l.a,t),e.vertex.uniforms.add("overlayTexOffset","vec4"),e.vertex.uniforms.add("overlayTexScale","vec4"),e.varyings.add("vtcOverlay","vec4"),e.vertex.code.add(Object(u.a)(n||(n=Object(s.a)(["void setOverlayVTC(in vec2 uv) {\nvtcOverlay = vec4(uv, uv) * overlayTexScale + overlayTexOffset;\n}"])))),e.fragment.uniforms.add("ovColorTex","sampler2D"),e.fragment.uniforms.add("overlayOpacity","float"),e.fragment.code.add(Object(u.a)(i||(i=Object(s.a)(["bool isValid(vec2 uv, vec2 dxdy) {\nreturn (uv.x >= 0.0 + dxdy.x) && (uv.x <= 1.0 - dxdy.x) && (uv.y >= 0.0 + dxdy.y) && (uv.y <= 1.0 - dxdy.y);\n}\nvec4 getOverlayColor(sampler2D ov0Tex, vec4 texCoords) {\nvec4 color0 = texture2D(ov0Tex, vec2(texCoords.x * 0.5, texCoords.y));\nvec4 color1 = texture2D(ov0Tex, vec2(texCoords.z * 0.5 + 0.5, texCoords.w));\nbool isValid0 = isValid(texCoords.xy, fwidth(texCoords.xy));\nbool isValid1 = isValid(texCoords.zw, vec2(0.0, 0.0));\nreturn mix(color1 * float(isValid1), color0, float(isValid0));\n}"])))),e.fragment.code.add(Object(u.a)(a||(a=Object(s.a)(["vec4 getCombinedOverlayColor() {\nreturn overlayOpacity * getOverlayColor(ovColorTex, vtcOverlay);\n}"])))),3!==t.pbrMode&&4!==t.pbrMode||(e.include(c.a),e.fragment.code.add(Object(u.a)(o||(o=Object(s.a)(["vec4 getOverlayWaterColor(vec4 maskInput, vec4 colorInput, vec3 vposEyeDir,\nfloat shadow, vec3 localUp, mat3 tbn, vec3 position) {\nvec3 n = normalize(tbn *  (2.0 * maskInput.rgb - vec3(1.0)));\nvec3 v = vposEyeDir;\nvec3 final = getSeaColor(n, v, lightingMainDirection, colorInput.rgb, lightingMainIntensity, localUp, 1.0 - shadow, maskInput.w, position);\nreturn vec4(final, colorInput.w);\n}"])))))}},function(e,t,r){"use strict";r.d(t,"a",(function(){return w})),r.d(t,"b",(function(){return k})),r.d(t,"c",(function(){return y})),r.d(t,"d",(function(){return g})),r.d(t,"e",(function(){return v}));var n,i=r(8),a=r.n(i),o=r(14),s=r(33),c=r(16),l=r(3),u=r(93);function d(){if(Object(l.i)(n)){var e=function(e){return Object(u.b)("esri/libs/basisu/".concat(e))};n=Promise.all([r.e(77),r.e(147)]).then(r.bind(null,1065)).then((function(e){return e.b})).then((function(t){return(0,t.default)({locateFile:e}).then((function(e){return e.initializeBasis(),delete e.then,e}))}))}return n}var h=r(60),f=r(92),p=null,b=null;function v(){return m.apply(this,arguments)}function m(){return(m=Object(c.a)(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=Object(l.i)(b),!e.t0){e.next=6;break}return b=d(),e.next=5,b;case 5:p=e.sent;case 6:return e.abrupt("return",b);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function y(e,t){if(Object(l.i)(p))return e.byteLength;var r=new p.BasisFile(new Uint8Array(e)),n=j(r)?O(r.getNumLevels(0),r.getHasAlpha(),r.getImageWidth(0,0),r.getImageHeight(0,0),t):0;return r.close(),r.delete(),n}function g(e,t){if(Object(l.i)(p))return e.byteLength;var r=new p.KTX2File(new Uint8Array(e)),n=_(r)?O(r.getLevels(),r.getHasAlpha(),r.getWidth(),r.getHeight(),t):0;return r.close(),r.delete(),n}function O(e,t,r,n,i){var a=Object(f.b)(t?37496:37492),o=i&&e>1?(Math.pow(4,e)-1)/(3*Math.pow(4,e-1)):1;return Math.ceil(r*n*a*o)}function j(e){return e.getNumImages()>=1&&!e.isUASTC()}function _(e){return e.getFaces()>=1&&e.isETC1S()}function w(e,t,r){return x.apply(this,arguments)}function x(){return(x=Object(c.a)(a.a.mark((function e(t,r,n){var i,o;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=Object(l.i)(p),!e.t0){e.next=5;break}return e.next=4,v();case 4:p=e.sent;case 5:if(j(i=new p.BasisFile(new Uint8Array(n)))){e.next=8;break}return e.abrupt("return",null);case 8:return i.startTranscoding(),o=T(t,r,i.getNumLevels(0),i.getHasAlpha(),i.getImageWidth(0,0),i.getImageHeight(0,0),(function(e,t){return i.getImageTranscodedSizeInBytes(0,e,t)}),(function(e,t,r){return i.transcodeImage(r,0,e,t,0,0)})),e.abrupt("return",(i.close(),i.delete(),o));case 11:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function k(e,t,r){return S.apply(this,arguments)}function S(){return(S=Object(c.a)(a.a.mark((function e(t,r,n){var i,o;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=Object(l.i)(p),!e.t0){e.next=5;break}return e.next=4,v();case 4:p=e.sent;case 5:if(_(i=new p.KTX2File(new Uint8Array(n)))){e.next=8;break}return e.abrupt("return",null);case 8:return i.startTranscoding(),o=T(t,r,i.getLevels(),i.getHasAlpha(),i.getWidth(),i.getHeight(),(function(e,t){return i.getImageTranscodedSizeInBytes(e,0,0,t)}),(function(e,t,r){return i.transcodeImage(r,e,0,0,t,0,-1,-1)})),e.abrupt("return",(i.close(),i.delete(),o));case 11:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function T(e,t,r,n,i,a,c,l){for(var u=e.capabilities,d=u.compressedTextureETC,f=u.compressedTextureS3TC,p=d?n?[1,37496]:[0,37492]:f?n?[3,33779]:[2,33776]:[13,6408],b=Object(s.a)(p,2),v=b[0],m=b[1],y=t.hasMipmap?r:Math.min(1,r),g=[],O=0;O<y;O++)g.push(new Uint8Array(c(O,v))),l(O,v,g[O]);var j=g.length>1,_=j?9987:9729,w=Object(o.a)(Object(o.a)({},t),{},{samplingMode:_,hasMipmap:j,internalFormat:m,width:i,height:a});return new h.a(e,w,{type:"compressed",levels:g})}},function(e,t,r){"use strict";var n,i=r(2),a=r(5),o=r(6),s=r(7),c=r(0),l=r(49),u=r(25),d=r(1),h=r(18),f=(r(17),r(15),r(52)),p=r(10),b=r(395),v=n=function(e){Object(o.a)(r,e);var t=Object(s.a)(r);function r(e){var n;return Object(i.a)(this,r),(n=t.call(this,e)).algorithm=null,n.fromColor=null,n.toColor=null,n.type="algorithmic",n}return Object(a.a)(r,[{key:"clone",value:function(){return new n({fromColor:Object(u.a)(this.fromColor),toColor:Object(u.a)(this.toColor),algorithm:this.algorithm})}}]),r}(b.a);Object(c.a)([Object(f.a)({esriCIELabAlgorithm:"cie-lab",esriHSVAlgorithm:"hsv",esriLabLChAlgorithm:"lab-lch"})],v.prototype,"algorithm",void 0),Object(c.a)([Object(d.b)({type:l.a,json:{type:[h.a],write:!0}})],v.prototype,"fromColor",void 0),Object(c.a)([Object(d.b)({type:l.a,json:{type:[h.a],write:!0}})],v.prototype,"toColor",void 0),Object(c.a)([Object(d.b)({type:["algorithmic"]})],v.prototype,"type",void 0);var m=v=n=Object(c.a)([Object(p.a)("esri.rest.support.AlgorithmicColorRamp")],v);t.a=m},function(e,t,r){"use strict";var n,i=r(2),a=r(5),o=r(6),s=r(7),c=r(0),l=r(98),u=r(27),d=r(1),h=(r(17),r(18),r(15),r(10)),f=r(185),p=n=function(e){Object(o.a)(r,e);var t=Object(s.a)(r);function r(e){var n;return Object(i.a)(this,r),(n=t.call(this,e)).description=null,n.label=null,n.minValue=null,n.maxValue=0,n.symbol=null,n}return Object(a.a)(r,[{key:"clone",value:function(){return new n({description:this.description,label:this.label,minValue:this.minValue,maxValue:this.maxValue,symbol:this.symbol?this.symbol.clone():null})}},{key:"getMeshHash",value:function(){var e=JSON.stringify(this.symbol);return"".concat(this.minValue,".").concat(this.maxValue,".").concat(e)}}]),r}(u.a);Object(c.a)([Object(d.b)({type:String,json:{write:!0}})],p.prototype,"description",void 0),Object(c.a)([Object(d.b)({type:String,json:{write:!0}})],p.prototype,"label",void 0),Object(c.a)([Object(d.b)({type:Number,json:{read:{source:"classMinValue"},write:{target:"classMinValue"}}})],p.prototype,"minValue",void 0),Object(c.a)([Object(d.b)({type:Number,json:{read:{source:"classMaxValue"},write:{target:"classMaxValue"}}})],p.prototype,"maxValue",void 0),Object(c.a)([Object(d.b)({types:l.i,json:{origins:{"web-scene":{types:l.j,write:f.b}},write:f.b}})],p.prototype,"symbol",void 0);var b=p=n=Object(c.a)([Object(h.a)("esri.renderers.support.ClassBreakInfo")],p);t.a=b},function(e,t,r){"use strict";r.d(t,"a",(function(){return s})),r.d(t,"b",(function(){return c}));var n,i=r(12),a=r(529),o=r(11);function s(e){e.fragment.uniforms.add("texWaveNormal","sampler2D"),e.fragment.uniforms.add("texWavePerturbation","sampler2D"),e.fragment.uniforms.add("waveParams","vec4"),e.fragment.uniforms.add("waveDirection","vec2"),e.include(a.b),e.fragment.code.add(Object(o.a)(n||(n=Object(i.a)(["const vec2  FLOW_JUMP = vec2(6.0/25.0, 5.0/24.0);\nvec2 textureDenormalized2D(sampler2D _tex, vec2 _uv) {\nreturn 2.0 * texture2D(_tex, _uv).rg - 1.0;\n}\nfloat sampleNoiseTexture(vec2 _uv) {\nreturn texture2D(texWavePerturbation, _uv).b;\n}\nvec3 textureDenormalized3D(sampler2D _tex, vec2 _uv) {\nreturn 2.0 * texture2D(_tex, _uv).rgb - 1.0;\n}\nfloat computeProgress(vec2 uv, float time) {\nreturn fract(time);\n}\nfloat computeWeight(vec2 uv, float time) {\nfloat progress = computeProgress(uv, time);\nreturn 1.0 - abs(1.0 - 2.0 * progress);\n}\nvec3 computeUVPerturbedWeigth(sampler2D texFlow, vec2 uv, float time, float phaseOffset) {\nfloat flowStrength = waveParams[2];\nfloat flowOffset = waveParams[3];\nvec2 flowVector = textureDenormalized2D(texFlow, uv) * flowStrength;\nfloat progress = computeProgress(uv, time + phaseOffset);\nfloat weight = computeWeight(uv, time + phaseOffset);\nvec2 result = uv;\nresult -= flowVector * (progress + flowOffset);\nresult += phaseOffset;\nresult += (time - progress) * FLOW_JUMP;\nreturn vec3(result, weight);\n}\nconst float TIME_NOISE_TEXTURE_REPEAT = 0.3737;\nconst float TIME_NOISE_STRENGTH = 7.77;\nvec3 getWaveLayer(sampler2D _texNormal, sampler2D _dudv, vec2 _uv, vec2 _waveDir, float time) {\nfloat waveStrength = waveParams[0];\nvec2 waveMovement = time * -_waveDir;\nfloat timeNoise = sampleNoiseTexture(_uv * TIME_NOISE_TEXTURE_REPEAT) * TIME_NOISE_STRENGTH;\nvec3 uv_A = computeUVPerturbedWeigth(_dudv, _uv + waveMovement, time + timeNoise, 0.0);\nvec3 uv_B = computeUVPerturbedWeigth(_dudv, _uv + waveMovement, time + timeNoise, 0.5);\nvec3 normal_A = textureDenormalized3D(_texNormal, uv_A.xy) * uv_A.z;\nvec3 normal_B = textureDenormalized3D(_texNormal, uv_B.xy) * uv_B.z;\nvec3 mixNormal = normalize(normal_A + normal_B);\nmixNormal.xy *= waveStrength;\nmixNormal.z = sqrt(1.0 - dot(mixNormal.xy, mixNormal.xy));\nreturn mixNormal;\n}\nvec4 getSurfaceNormalAndFoam(vec2 _uv, float _time) {\nfloat waveTextureRepeat = waveParams[1];\nvec3 normal = getWaveLayer(texWaveNormal, texWavePerturbation, _uv * waveTextureRepeat, waveDirection, _time);\nfloat foam  = normals2FoamIntensity(normal, waveParams[0]);\nreturn vec4(normal, foam);\n}"]))))}function c(e,t){e.setUniform4f("waveParams",t.waveStrength,t.waveTextureRepeat,t.flowStrength,t.flowOffset),e.setUniform2f("waveDirection",t.waveDirection[0]*t.waveVelocity,t.waveDirection[1]*t.waveVelocity)}},function(e,t,r){"use strict";var n=r(14),i=r(2),a=r(5),o=r(3),s=r(187),c={bandCount:3,outMin:0,outMax:1,minCutOff:[0,0,0],maxCutOff:[255,255,255],factor:[1/255,1/255,1/255],useGamma:!1,gamma:[1,1,1],gammaCorrection:[1,1,1],colormap:null,colormapOffset:null,type:"stretch"},l=function(){function e(t,r){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;Object(i.a)(this,e),this._memoryUsed=null,this._source=null,this._symbolizerParameters=null,this._bandIds=null,this._interpolation=null,this._dirty=!1,this._transformGrid=null,this.isRendereredSource=!1,this.symbolizerRenderer=null,this.rawPixelData=null,this.lij=null,this.scale=1,this.offset=[0,0],this.opacity=1,this.lij=t,this.source=r,this.width=n||r.width,this.height=a||r.height}return Object(a.a)(e,[{key:"source",get:function(){return this._source},set:function(e){this._source=e,this._rasterTexture&&(this._rasterTexture.dispose(),this._rasterTexture=null,this._memoryUsed=null)}},{key:"symbolizerParameters",get:function(){return this.isRendereredSource?Object(n.a)(Object(n.a)({},c),{},{maxCutOff:[1,1,1],factor:[1,1,1]}):this._symbolizerParameters||c},set:function(e){this._symbolizerParameters=e}},{key:"bandIds",get:function(){return this._bandIds},set:function(e){var t=this;Object(o.j)(e)&&e.length>0?this._bandIds&&e.every((function(e,r){return!!t._bandIds[r]&&e===t._bandIds[r]}))||(this._bandIds=e,this._dirty=!0):this._bandIds=null}},{key:"interpolation",get:function(){return this._interpolation},set:function(e){this._interpolation=e,this._rasterTexture&&this._rasterTexture.setSamplingMode("bilinear"===e?9729:9728)}},{key:"transformGrid",get:function(){return this._transformGrid},set:function(e){this._transformGrid=e,this._transformGridTexture&&(this._transformGridTexture.dispose(),this._transformGridTexture=null,this._memoryUsed=null)}},{key:"bind",value:function(e){return!!(this.source&&this.source.pixels&&this.source.pixels.length>0)&&(this._rasterTexture&&!this._dirty||this._updateRasterTexture(e,this.bandIds),this._rasterTexture&&(this._updateColormapTexture(e),this.transformGrid&&!this._transformGridTexture&&(this._transformGridTexture=Object(s.c)(e,this.transformGrid))),!0)}},{key:"getUniforms",value:function(){var e=Object(s.d)(this.scale,this.offset),t=this.symbolizerParameters,r=this.transformGrid,n=this.width,i=this.height,a=this.opacity;return{basic:e,common:Object(s.f)(r,[n,i],[this.source.width,this.source.height],a),colormap:t.colormap?Object(s.e)(t.colormap,t.colormapOffset):null,stretch:"stretch"===this.symbolizerParameters.type?Object(s.h)(this.symbolizerParameters):null,hillshade:"hillshade"===this.symbolizerParameters.type?Object(s.g)(this.symbolizerParameters):null}}},{key:"getTextures",value:function(){var e=new Array,t=[];return this._rasterTexture&&(t.push(this._rasterTexture),e.push("u_image"),this._transformGridTexture&&(t.push(this._transformGridTexture),e.push("u_transformGrid")),this._colormapTexture&&(t.push(this._colormapTexture),e.push("u_colormap"))),{names:e,textures:t}}},{key:"memoryUsage",get:function(){if(Object(o.i)(this._memoryUsed)){var e=this.getTextures();if(null==e)return 0;this._memoryUsed=e.textures.map((function(e){return e.descriptor.width*e.descriptor.height*4})).reduce((function(e,t){return e+t}),0)}return this._memoryUsed}},{key:"release",value:function(){return this._rasterTexture=Object(o.f)(this._rasterTexture),this._transformGridTexture=Object(o.f)(this._transformGridTexture),this._colormapTexture=Object(o.f)(this._colormapTexture),this.source=null,this.transformGrid=null,this.rawPixelData=null,!0}},{key:"_updateRasterTexture",value:function(e,t){var r=this.source?this.source.extractBands(t):null;if(r&&r.pixels&&r.pixels.length>0){var n=Object(o.i)(t)&&Object(o.i)(this.bandIds)||Object(o.j)(t)&&Object(o.j)(this.bandIds)&&t.join("")===this.bandIds.join("");if(this._rasterTexture){if(n)return;this._rasterTexture.dispose(),this._rasterTexture=null}this._rasterTexture=Object(s.b)(e,r,this.interpolation||"nearest",this.isRendereredSource)}else this._rasterTexture&&(this._rasterTexture.dispose(),this._rasterTexture=null)}},{key:"_updateColormapTexture",value:function(e){var t=this._colormap,r=this.symbolizerParameters.colormap;return r?t?r.length!==t.length||r.some((function(e,r){return e!==t[r]}))?(this._colormapTexture&&(this._colormapTexture.dispose(),this._colormapTexture=null),this._colormapTexture=Object(s.a)(e,r),void(this._colormap=r)):void 0:(this._colormapTexture=Object(s.a)(e,r),void(this._colormap=r)):(this._colormapTexture&&(this._colormapTexture.dispose(),this._colormapTexture=null),void(this._colormap=null))}}]),e}();t.a=l},function(e,t,r){"use strict";r.d(t,"a",(function(){return i})),r.d(t,"b",(function(){return n}));r(173),r(143),r(306),r(17),r(15);r(497),r(36),r(83);function n(e){return e&&"function"==typeof e.render}function i(e){return e&&"function"==typeof e.postMixInProperties&&"function"==typeof e.buildRendering&&"function"==typeof e.postCreate&&"function"==typeof e.startup}},function(e,t,r){"use strict";function n(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}r.d(t,"a",(function(){return n}))},function(e,t,r){"use strict";var n,i=r(2),a=r(5),o=r(6),s=r(7),c=r(0),l=r(49),u=r(27),d=r(3),h=r(28),f=r(1),p=(r(17),r(18),r(15),r(10)),b=r(131),v=n=function(e){Object(o.a)(r,e);var t=Object(s.a)(r);function r(){var e;return Object(i.a)(this,r),(e=t.apply(this,arguments)).color=new l.a([0,0,0,1]),e.size=Object(h.h)(1),e.stipplePattern=null,e.stippleOffColor=null,e}return Object(a.a)(r,[{key:"clone",value:function(){return new n({color:Object(d.j)(this.color)?this.color.clone():null,size:this.size,stipplePattern:this.stipplePattern?this.stipplePattern.slice():null,stippleOffColor:this.stippleOffColor?this.stippleOffColor.clone():null})}}]),r}(u.a);Object(c.a)([Object(f.b)(b.a)],v.prototype,"color",void 0),Object(c.a)([Object(f.b)(b.b)],v.prototype,"size",void 0),Object(c.a)([Object(f.b)(b.c)],v.prototype,"stipplePattern",void 0),Object(c.a)([Object(f.b)({type:l.a})],v.prototype,"stippleOffColor",void 0);var m=v=n=Object(c.a)([Object(p.a)("esri.symbols.support.Symbol3DOutline")],v);t.a=m},function(e,t,r){"use strict";var n,i=r(2),a=r(5),o=r(6),s=r(7),c=r(0),l=r(98),u=r(27),d=r(1),h=(r(17),r(18),r(15),r(10)),f=r(185),p=n=function(e){Object(o.a)(r,e);var t=Object(s.a)(r);function r(e){var n;return Object(i.a)(this,r),(n=t.call(this,e)).description=null,n.label=null,n.symbol=null,n.value=null,n}return Object(a.a)(r,[{key:"clone",value:function(){return new n({value:this.value,description:this.description,label:this.label,symbol:this.symbol?this.symbol.clone():null})}},{key:"getMeshHash",value:function(){var e=JSON.stringify(this.symbol&&this.symbol.toJSON());return"".concat(this.value,".").concat(e)}}]),r}(u.a);Object(c.a)([Object(d.b)({type:String,json:{write:!0}})],p.prototype,"description",void 0),Object(c.a)([Object(d.b)({type:String,json:{write:!0}})],p.prototype,"label",void 0),Object(c.a)([Object(d.b)({types:l.i,json:{origins:{"web-scene":{types:l.j,write:f.b}},write:f.b}})],p.prototype,"symbol",void 0),Object(c.a)([Object(d.b)({type:[String,Number],json:{type:String,write:{writer:function(e,t){t.value=null==e?void 0:e.toString()}}}})],p.prototype,"value",void 0);var b=p=n=Object(c.a)([Object(h.a)("esri.renderers.support.UniqueValueInfo")],p);t.a=b},function(e,t,r){"use strict";var n=r(2),i=r(5),a=r(6),o=r(7),s=r(0),c=r(58),l=r(27),u=r(25),d=r(1),h=(r(18),r(17),r(15),r(10)),f=r(44),p=new c.a({esriFeatureEditToolAutoCompletePolygon:"auto-complete-polygon",esriFeatureEditToolCircle:"circle",esriFeatureEditToolEllipse:"ellipse",esriFeatureEditToolFreehand:"freehand",esriFeatureEditToolLine:"line",esriFeatureEditToolNone:"none",esriFeatureEditToolPoint:"point",esriFeatureEditToolPolygon:"polygon",esriFeatureEditToolRectangle:"rectangle",esriFeatureEditToolArrow:"arrow",esriFeatureEditToolTriangle:"triangle",esriFeatureEditToolLeftArrow:"left-arrow",esriFeatureEditToolRightArrow:"right-arrow",esriFeatureEditToolUpArrow:"up-arrow",esriFeatureEditToolDownArrow:"down-arrow"}),b=function(e){Object(a.a)(r,e);var t=Object(o.a)(r);function r(e){var i;return Object(n.a)(this,r),(i=t.call(this,e)).name=null,i.description=null,i.drawingTool=null,i.prototype=null,i.thumbnail=null,i}return Object(i.a)(r,[{key:"writeDrawingTool",value:function(e,t){t.drawingTool=p.toJSON(e)}},{key:"writePrototype",value:function(e,t){t.prototype=Object(u.c)(Object(u.a)(e),!0)}},{key:"writeThumbnail",value:function(e,t){t.thumbnail=Object(u.c)(Object(u.a)(e))}}]),r}(l.a);Object(s.a)([Object(d.b)({json:{write:!0}})],b.prototype,"name",void 0),Object(s.a)([Object(d.b)({json:{write:!0}})],b.prototype,"description",void 0),Object(s.a)([Object(d.b)({json:{read:p.read,write:p.write}})],b.prototype,"drawingTool",void 0),Object(s.a)([Object(f.a)("drawingTool")],b.prototype,"writeDrawingTool",null),Object(s.a)([Object(d.b)({json:{write:!0}})],b.prototype,"prototype",void 0),Object(s.a)([Object(f.a)("prototype")],b.prototype,"writePrototype",null),Object(s.a)([Object(d.b)({json:{write:!0}})],b.prototype,"thumbnail",void 0),Object(s.a)([Object(f.a)("thumbnail")],b.prototype,"writeThumbnail",null);var v=b=Object(s.a)([Object(h.a)("esri.layers.support.FeatureTemplate")],b);t.a=v},function(e,t,r){"use strict";r.d(t,"a",(function(){return c})),r.d(t,"b",(function(){return l}));var n=r(212),i=r(29),a=r(4),o=r(9),s=r(125);r(47);function c(e,t,r){var n=Object(i.d)(e,t),a=Object(i.d)(t,r),o=Object(i.d)(r,e),s=(n+a+o)/2,c=s*(s-n)*(s-a)*(s-o);return c<=0?0:Math.sqrt(c)}function l(e,t,r){return Object(a.l)(u,t,e),Object(a.l)(d,r,e),Object(a.r)(Object(a.i)(u,u,d))/2}new n.a(s.c),new n.a((function(){return{p0:null,p1:null,p2:null}}));var u=Object(o.e)(),d=Object(o.e)()},function(e,t,r){"use strict";r.d(t,"a",(function(){return i})),r.d(t,"b",(function(){return a}));r(17);var n=r(171);function i(e){switch(e){case"sphere":case"cube":case"diamond":case"cylinder":case"cone":case"inverted-cone":case"tetrahedron":return!0}return!1}function a(e,t){var r=function(e,r){var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return{levels:e.map((function(e){var a=r(e.tesselation);return i&&n.a.cgToGIS(a),{components:[{geometry:a,material:t}],faceCount:a.indexCount/3,minScreenSpaceRadius:e.minScreenSpaceRadius}}))}};switch(e){case"sphere":return r([{tesselation:0,minScreenSpaceRadius:0},{tesselation:1,minScreenSpaceRadius:8},{tesselation:2,minScreenSpaceRadius:16},{tesselation:3,minScreenSpaceRadius:50},{tesselation:4,minScreenSpaceRadius:250}],(function(e){return n.a.createPolySphereGeometry(.5,e,!0)}));case"cube":return r([{tesselation:0,minScreenSpaceRadius:0}],(function(){return n.a.createBoxGeometry(1)}));case"cone":return r(o,(function(e){return n.a.createConeGeometry(1,.5,e,!1)}),!0);case"inverted-cone":return r(o,(function(e){return n.a.createConeGeometry(1,.5,e,!0)}),!0);case"cylinder":return r(o,(function(e){return n.a.createCylinderGeometry(1,.5,e,[0,0,1],[0,0,.5])}));case"tetrahedron":return r([{tesselation:0,minScreenSpaceRadius:0}],(function(){return n.a.createTetrahedronGeometry(1)}),!0);case"diamond":return r([{tesselation:0,minScreenSpaceRadius:0}],(function(){return n.a.createDiamondGeometry(1)}),!0);default:return}}var o=[{tesselation:6,minScreenSpaceRadius:0},{tesselation:18,minScreenSpaceRadius:7},{tesselation:64,minScreenSpaceRadius:65}]},function(e,t,r){"use strict";r.d(t,"a",(function(){return u})),r.d(t,"b",(function(){return d}));var n=r(13),i=r(2),a=r(5),o=r(20),s=r(54),c=r(40),l=r(294),u=function(){function e(t,r){Object(i.a)(this,e),this.index=t,this.renderTargets=r,this.extent=Object(c.k)(),this.resolution=0,this.viewport=Object(c.k)(),this.renderLocalOrigin=Object(l.a)(0,0,0,"O"),this.pixelRatio=1,this.canvasGeometries={extents:[Object(c.k)(),Object(c.k)(),Object(c.k)()],numViews:0},this.validTargets=null,this.hasDrapedFeatureSource=!1,this.hasDrapedRasterSource=!1,this.hasTargetWithoutRasterImage=!1,this.index=t,this.validTargets=new Array(r.renderTargets.length).fill(!1)}return Object(a.a)(e,[{key:"getValidTarget",value:function(e){return this.validTargets[e]?this.renderTargets.getTarget(e):null}},{key:"needsColorWithoutRasterImage",get:function(){return this.hasDrapedRasterSource&&this.hasDrapedFeatureSource&&this.hasTargetWithoutRasterImage}},{key:"getColorTexture",value:function(e){var t=1===e?this.renderTargets.getTarget(0):2===e?this.renderTargets.getTarget(2):this.renderTargets.getTarget(4);return t?t.getTexture():null}},{key:"getNormalTexture",value:function(e){var t=1===e?this.renderTargets.getTarget(3):null;return t?t.getTexture():null}},{key:"draw",value:function(e,t){var r,i=this.computeRenderTargetValidityBitfield(),a=this.needsColorWithoutRasterImage,o=Object(n.a)(this.renderTargets.renderTargets);try{for(o.s();!(r=o.n()).done;){var s=r.value;1===s.type&&!1===a?this.validTargets[s.type]=!1:this.validTargets[s.type]=e.drawTarget(this,s,t)}}catch(c){o.e(c)}finally{o.f()}return i^this.computeRenderTargetValidityBitfield()?0:1}},{key:"computeRenderTargetValidityBitfield",value:function(){var e=this.validTargets;return+e[0]|+e[1]<<1|+e[2]<<2|+e[3]<<3|+e[4]<<4}},{key:"setupGeometryViewsCyclical",value:function(e){this.setupGeometryViewsDirect();var t=.001*e.range;if(this.extent[0]-t<=e.min){var r=this.canvasGeometries.extents[this.canvasGeometries.numViews++];Object(c.x)(this.extent,e.range,0,r)}if(this.extent[2]+t>=e.max){var n=this.canvasGeometries.extents[this.canvasGeometries.numViews++];Object(c.x)(this.extent,-e.range,0,n)}}},{key:"setupGeometryViewsDirect",value:function(){this.canvasGeometries.numViews=1,Object(c.y)(this.canvasGeometries.extents[0],this.extent),Object(s.l)(this.viewport,0,0,this.resolution,this.resolution)}},{key:"hasSomeSizedView",value:function(){for(var e=0;e<this.canvasGeometries.numViews;e++){var t=this.canvasGeometries.extents[e];if(t[0]!==t[2]&&t[1]!==t[3])return!0}return!1}},{key:"applyViewport",value:function(e){var t=this.viewport;0===this.index?e.setViewport(t[0],t[1],t[2],t[3]):e.setViewport(t[0]+this.resolution,t[1],t[2],t[3])}}]),e}();function d(e,t,r){return Math.min(Object(o.p)(Math.max(e,t)+256),r)}},function(e,t,r){"use strict";r.d(t,"a",(function(){return l}));var n=r(2),i=r(5),a=r(6),o=r(7),s=r(195),c=r(528),l=function(e){Object(a.a)(r,e);var t=Object(o.a)(r);function r(e){var i;return Object(n.a)(this,r),(i=t.call(this,e)).updateParameters(),i}return Object(i.a)(r,[{key:"updateParameters",value:function(e){this._technique=this._techniqueRep.releaseAndAcquire(c.a,this._material.getTechniqueConfig(this._output,e),this._technique)}},{key:"beginSlot",value:function(e){if(2===this._output)return 22===e;if(5===this._output)return null==e;if(4===this._output)return 3===e;var t=3;return this._material.params.transparent&&(t=this._material.params.writeDepth?5:8),e===t}},{key:"setElapsedTimeUniform",value:function(e){var t=.001*this._material.animation.time;e.setUniform1f("timeElapsed",t*this._material.params.animationSpeed)}},{key:"_updateShadowState",value:function(e){e.shadowMappingEnabled!==this._material.params.receiveShadows&&this._material.setParameterValues({receiveShadows:e.shadowMappingEnabled})}},{key:"_updateSSRState",value:function(e){e.ssrEnabled!==this._material.params.ssrEnabled&&this._material.setParameterValues({ssrEnabled:e.ssrEnabled})}},{key:"ensureResources",value:function(e){return this._technique.ensureResource(e)}},{key:"ensureParameters",value:function(e){0===this._output&&(this._updateShadowState(e),this._updateSSRState(e)),this.updateParameters(e)}},{key:"bind",value:function(e){this._technique.bindPass(this._material.params,e),2!==this._output&&0!==this._output||this.setElapsedTimeUniform(this._technique.program)}}]),r}(s.a)},function(e,t,r){"use strict";r.d(t,"a",(function(){return b})),r.d(t,"b",(function(){return f}));var n=r(6),i=r(7),a=r(2),o=r(5),s=r(3),c=r(269),l=r(114),u=r(530),d=["prepare","shadowmap","lineardepth","normals","ssao","opaque","opaque edges","transparent","transparent edges","hudvisibility","transparent terrain","atmosphere","laserline","occluded","antialiasing","highlights","hudOccluded","hudNotoccluded"],h=function(){function e(){Object(a.a)(this,e),this.triangles=0,this.drawCalls=0}return Object(o.a)(e,[{key:"reset",value:function(){this.triangles=0,this.drawCalls=0}}]),e}();function f(e,t,r){Object(s.j)(r)&&(r.drawCalls+=e,r.triangles+=t)}var p=function(e){Object(n.a)(r,e);var t=Object(i.a)(r);function r(){var e;return Object(a.a)(this,r),(e=t.call(this,"total")).total=0,e.frameCount=0,e}return r}(c.a),b=function(){function e(){Object(a.a)(this,e),this._startTime=0,this._lastSample=0,this._enableGPUTimer=0,this.totalTime=new p,this.gpuTime=new c.a("gpu",9),this.renderPassTimings=d.map((function(e){return new c.a(e)})),this.stats=new h}return Object(o.a)(e,[{key:"enableGPUTimer",value:function(){var e=this;return++this._enableGPUTimer,{remove:Object(l.d)((function(){return--e._enableGPUTimer}))}}},{key:"prerender",value:function(e){this._startTime=this._lastSample=performance.now(),this._enableGPUTimer&&(this._gpuTimer=Object(u.a)(e))}},{key:"advance",value:function(e){var t=performance.now();this.renderPassTimings[e].record(t-this._lastSample),this._lastSample=t}},{key:"postrender",value:function(){var e=this;Object(s.j)(this._gpuTimer)&&(this._gpuTimer.stop((function(t){return Object(s.j)(t)&&e.gpuTime.record(t)}),16),this._gpuTimer=null);var t=performance.now()-this._startTime;this.totalTime.record(t),this.totalTime.total+=t,this.totalTime.frameCount++}}]),e}()},function(e,t,r){"use strict";var n,i=r(2),a=r(5),o=r(6),s=r(7),c=r(0),l=r(49),u=r(27),d=r(3),h=r(1),f=(r(17),r(18),r(15),r(10)),p=r(361),b=n=function(e){Object(o.a)(r,e);var t=Object(s.a)(r);function r(e){var n;return Object(i.a)(this,r),(n=t.call(this,e)).color=null,n.colorTexture=null,n.normalTexture=null,n.alphaMode="auto",n.alphaCutoff=.5,n.doubleSided=!0,n}return Object(a.a)(r,[{key:"clone",value:function(){return this.cloneWithDeduplication(null,new Map)}},{key:"cloneWithDeduplication",value:function(e,t){var r=Object(d.j)(e)?e.get(this):null;if(r)return r;var i=new n(this.clonePropertiesWithDeduplication(t));return Object(d.j)(e)&&e.set(this,i),i}},{key:"clonePropertiesWithDeduplication",value:function(e){return{color:Object(d.j)(this.color)?this.color.clone():null,colorTexture:Object(d.j)(this.colorTexture)?this.colorTexture.cloneWithDeduplication(e):null,normalTexture:Object(d.j)(this.normalTexture)?this.normalTexture.cloneWithDeduplication(e):null,alphaMode:this.alphaMode,alphaCutoff:this.alphaCutoff,doubleSided:this.doubleSided}}}]),r}(u.a);Object(c.a)([Object(h.b)({type:l.a,json:{write:!0}})],b.prototype,"color",void 0),Object(c.a)([Object(h.b)({type:p.a,json:{write:!0}})],b.prototype,"colorTexture",void 0),Object(c.a)([Object(h.b)({type:p.a,json:{write:!0}})],b.prototype,"normalTexture",void 0),Object(c.a)([Object(h.b)({nonNullable:!0,json:{write:!0}})],b.prototype,"alphaMode",void 0),Object(c.a)([Object(h.b)({nonNullable:!0,json:{write:!0}})],b.prototype,"alphaCutoff",void 0),Object(c.a)([Object(h.b)({nonNullable:!0,json:{write:!0}})],b.prototype,"doubleSided",void 0);var v=b=n=Object(c.a)([Object(f.a)("esri.geometry.support.MeshMaterial")],b);t.a=v},function(e,t,r){"use strict";r.d(t,"a",(function(){return l})),r.d(t,"b",(function(){return a}));r(17);var n=r(9),i=r(34);function a(e,t){var r=t.isPrimitive,i=t.width,a=t.depth,o=t.height,s=r?10:1;if(null==i&&null==o&&null==a)return[s*e[0],s*e[1],s*e[2]];for(var c,l=Object(n.g)(i,a,o),u=0;u<3;u++){var d=l[u];if(null!=d){c=d/e[u];break}}for(var h=0;h<3;h++)null==l[h]&&(l[h]=e[h]*c);return l}var o=Object(i.t)(-.5,-.5,-.5,.5,.5,.5),s=Object(i.t)(-.5,-.5,0,.5,.5,1),c=Object(i.t)(-.5,-.5,0,.5,.5,.5);function l(e){switch(e){case"sphere":case"cube":case"diamond":return o;case"cylinder":case"cone":case"inverted-cone":return s;case"tetrahedron":return c;default:return}}},function(e,t,r){"use strict";r.d(t,"a",(function(){return j})),r.d(t,"b",(function(){return M}));var n=r(13),i=r(8),a=r.n(i),o=r(16),s=r(99),c=r(128),l=r(22),u=r(15),d=r(3),h=r(23),f=r(401),p=r(9),b=r(34),v=r(156),m=r(115),y=r(206),g=r(211),O=u.a.getLogger("esri.views.3d.layers.graphics.objectResourceUtils");function j(e,t){return _.apply(this,arguments)}function _(){return(_=Object(o.a)(a.a.mark((function e(t,r){var n;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,w(t,r);case 2:return n=e.sent,e.t0=n,e.next=6,A(n.textureDefinitions,r);case 6:return e.t1=e.sent,e.abrupt("return",{resource:e.t0,textures:e.t1});case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function w(e,t){return x.apply(this,arguments)}function x(){return(x=Object(o.a)(a.a.mark((function e(t,r){var n,i;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(n=Object(d.j)(r)&&r.streamDataRequester)){e.next=3;break}return e.abrupt("return",k(t,n,r));case 3:return e.next=5,Object(c.d)(Object(s.default)(t,Object(d.s)(r)));case 5:if(!0!==(i=e.sent).ok){e.next=8;break}return e.abrupt("return",i.value.data);case 8:Object(h.w)(i.error),T(i.error);case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function k(e,t,r){return S.apply(this,arguments)}function S(){return(S=Object(o.a)(a.a.mark((function e(t,r,n){var i;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(c.d)(r.request(t,"json",n));case 2:if(!0!==(i=e.sent).ok){e.next=5;break}return e.abrupt("return",i.value);case 5:Object(h.w)(i.error),T(i.error.details.url);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function T(e){throw new l.a("","Request for object resource failed: ".concat(e))}function C(e){var t=e.params,r=t.topology,n=!0;switch(t.vertexAttributes||(O.warn("Geometry must specify vertex attributes"),n=!1),t.topology){case"PerAttributeArray":break;case"Indexed":case null:case void 0:var i=t.faces;if(i){if(t.vertexAttributes)for(var a in t.vertexAttributes){var o=i[a];o&&o.values?(null!=o.valueType&&"UInt32"!==o.valueType&&(O.warn("Unsupported indexed geometry indices type '".concat(o.valueType,"', only UInt32 is currently supported")),n=!1),null!=o.valuesPerElement&&1!==o.valuesPerElement&&(O.warn("Unsupported indexed geometry values per element '".concat(o.valuesPerElement,"', only 1 is currently supported")),n=!1)):(O.warn("Indexed geometry does not specify face indices for '".concat(a,"' attribute")),n=!1)}}else O.warn("Indexed geometries must specify faces"),n=!1;break;default:O.warn("Unsupported topology '".concat(r,"'")),n=!1}e.params.material||(O.warn("Geometry requires material"),n=!1);var s=e.params.vertexAttributes;for(var c in s)s[c].values||(O.warn("Geometries with externally defined attributes are not yet supported"),n=!1);return n}function M(e,t){var r=[],n=[],i=[],a=[],o=e.resource,s=f.a.parse(o.version||"1.0","wosr");D.validate(s);for(var c=o.model.name,l=o.model.geometries,u=o.materialDefinitions,h=e.textures,b=0,v=new Map,O=0;O<l.length;O++){var j=l[O];if(C(j)){var _=I(j),w=j.params.vertexAttributes,x=[];for(var k in w){var S=w[k],T=S.values;x.push([k,{data:T,size:S.valuesPerElement,exclusive:!0}])}var M=[];if("PerAttributeArray"!==j.params.topology){var A=j.params.faces;for(var E in A)M.push([E,new Uint32Array(A[E].values)])}var F=h&&h[_.texture];if(F&&!v.has(_.texture)){var L=F.image,z=F.params,V=new y.a(L,z);a.push(V),v.set(_.texture,V)}var N=v.get(_.texture),U=N?N.id:void 0,B=i[_.material]?i[_.material][_.texture]:null;if(!B){var G=u[_.material.substring(_.material.lastIndexOf("/")+1)].params;1===G.transparency&&(G.transparency=0);var q=F&&F.alphaChannelUsage,H=G.transparency>0||"transparency"===q||"maskAndTransparency"===q,W={ambient:Object(p.f)(G.diffuse),diffuse:Object(p.f)(G.diffuse),opacity:1-(G.transparency||0),transparent:H,textureAlphaMode:F?R(F.alphaChannelUsage):void 0,textureAlphaCutoff:.33,textureId:U,initTextureTransparent:!0,doubleSided:!0,cullFace:0,colorMixMode:G.externalColorMixMode||"tint",textureAlphaPremultiplied:!0};Object(d.j)(t)&&t.materialParamsMixin&&Object.assign(W,t.materialParamsMixin),B=new g.a(W),i[_.material]||(i[_.material]={}),i[_.material][_.texture]=B}n.push(B);var Q=new m.a(x,M);b+=M.position?M.position.length:0,r.push(Q)}}return{name:c,stageResources:{textures:a,materials:n,geometries:r},pivotOffset:o.model.pivotOffset,boundingBox:P(r),numberOfVertices:b,lodThreshold:null}}function P(e){var t=Object(b.k)();return e.forEach((function(e){var r=e.boundingInfo;Object(d.j)(r)&&(Object(b.r)(t,r.getBBMin()),Object(b.r)(t,r.getBBMax()))})),t}function A(e,t){return E.apply(this,arguments)}function E(){return(E=Object(o.a)(a.a.mark((function e(t,r){var i,o,s,c,l,u,h,f;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:i=[],o=function(e){var n=t[e],a=n.images[0].data;if(!a)return O.warn("Externally referenced texture data is not yet supported"),"continue";var o=n.encoding+";base64,"+a,s="/textureDefinitions/"+e,c={noUnpackFlip:!0,wrap:{s:10497,t:10497},preMultiplyAlpha:!0},l=Object(d.j)(r)&&r.disableTextures?Promise.resolve(null):Object(v.a)(o,r);i.push(l.then((function(e){return{refId:s,image:e,params:c,alphaChannelUsage:"rgba"===n.channels?n.alphaChannelUsage||"transparency":"none"}})))},e.t0=a.a.keys(t);case 3:if((e.t1=e.t0()).done){e.next=10;break}if(s=e.t1.value,"continue"!==o(s)){e.next=8;break}return e.abrupt("continue",3);case 8:e.next=3;break;case 10:return e.next=12,Promise.all(i);case 12:c=e.sent,l={},u=Object(n.a)(c);try{for(u.s();!(h=u.n()).done;)f=h.value,l[f.refId]=f}catch(p){u.e(p)}finally{u.f()}return e.abrupt("return",l);case 17:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function R(e){switch(e){case"mask":return 2;case"maskAndTransparency":return 3;case"none":return 1;case"transparency":default:return 0}}function I(e){var t=e.params;return{id:1,material:t.material,texture:t.texture,region:t.texture}}var D=new f.a(1,2,"wosr")},function(e,t,r){"use strict";r.d(t,"a",(function(){return c})),r.d(t,"b",(function(){return f}));var n=r(33),i=r(13),a=r(2),o=r(5),s=r(3),c=function(){function e(t,r){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2048;Object(a.a)(this,e),this.text=t,this._parameters=r,this.maxSize=n,this._lineWidths=new Array,this._renderPixelRatio=null,this._displayWidth=null,this.key="".concat(this._parameters.key,"--").concat(t),this._lines=t.split(/\r?\n/),this._lineHeight=this.computeLineHeight()}return Object(o.a)(e,[{key:"displayWidth",get:function(){return this._ensureTextWidth()}},{key:"displayHeight",get:function(){return this._lineHeight*this._lines.length}},{key:"renderedWidth",get:function(){return Math.round(this.displayWidth*this.renderPixelRatio)}},{key:"renderedHeight",get:function(){return Math.round(this.displayHeight*this.renderPixelRatio)}},{key:"renderedLineHeight",get:function(){return Math.round(this._lineHeight*this.renderPixelRatio)}},{key:"renderedFontSize",get:function(){return this._parameters.definition.size*this.renderPixelRatio}},{key:"renderedHaloSize",get:function(){return this._parameters.haloSize*this.renderPixelRatio}},{key:"renderPixelRatio",get:function(){if(Object(s.i)(this._renderPixelRatio)){var e=this._parameters.definition.pixelRatio;this.maxSize>0?this._renderPixelRatio=Math.min(e,Math.min(this.maxSize/(this.displayWidth*e),this.maxSize/(this.displayHeight*e))):this._renderPixelRatio=e}return this._renderPixelRatio}},{key:"getLineXOffset",value:function(e){return Math.round((this.renderedWidth-this._lineWidths[e]*this.renderPixelRatio)/2)}},{key:"render",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=this.renderedLineHeight,i=this.renderedHaloSize,a=l(e.textAlign,this.renderedWidth)+i,o=i+u;e.save(),i>0&&this.renderHalo(e,a,o,t,r),this.setFontProperties(e,this.renderedFontSize),r+=o,t+=a;for(var s=0;s<this._lines.length;++s){e.globalCompositeOperation="destination-out",e.fillStyle="rgb(0, 0, 0)";var c=this._lines[s],d=this.getLineXOffset(s);e.fillText(c,t+d,r),e.globalCompositeOperation="source-over",e.fillStyle=this._parameters.fillStyle,e.fillText(c,t+this.getLineXOffset(s),r),r+=n}e.restore()}},{key:"renderHalo",value:function(e,t,r,n,i){var a=this.renderedWidth,o=this.renderedHeight,s=f(p,Math.max(a,b),Math.max(o,b)),c=s.getContext("2d");c.clearRect(0,0,a,o),this.setFontProperties(c,this.renderedFontSize),c.fillStyle=this._parameters.haloStyle,c.strokeStyle=this._parameters.haloStyle;var l=this.renderedHaloSize<3;c.lineJoin=l?"miter":"round",l?this.renderHaloEmulated(c,t,r):this.renderHaloNative(c,t,r),e.globalAlpha=this._parameters.definition.halo.color[3],e.drawImage(s,0,0,a,o,n,i,a,o),e.globalAlpha=1}},{key:"renderHaloEmulated",value:function(e,t,r){for(var a=this.renderedLineHeight,o=this.renderedHaloSize,s=0;s<this._lines.length;++s){var c,l=this._lines[s],u=this.getLineXOffset(s),h=Object(i.a)(d);try{for(h.s();!(c=h.n()).done;){var f=Object(n.a)(c.value,2),p=f[0],b=f[1];e.fillText(l,t+u+o*p,r+o*b)}}catch(v){h.e(v)}finally{h.f()}r+=a}}},{key:"renderHaloNative",value:function(e,t,r){for(var n=this.renderedLineHeight,i=this.renderedHaloSize,a=0;a<this._lines.length;++a){for(var o=2*i,s=this._lines[a],c=this.getLineXOffset(a),l=0;l<5;l++){var u=.6+.1*l;e.lineWidth=u*o,e.strokeText(s,t+c,r)}r+=n}}},{key:"setFontProperties",value:function(e,t){var r=this._parameters.definition.font,n="".concat(r.style," ").concat(r.weight," ").concat(t,"px ").concat(r.family,", sans-serif");e.font=n,e.textAlign="left",e.textBaseline="top"}},{key:"_ensureTextWidth",value:function(){if(Object(s.j)(this._displayWidth))return this._displayWidth;var e=f(p,b,b).getContext("2d");this.setFontProperties(e,this._parameters.definition.size);var t=0,r=2*this._parameters.haloSize;this._lineWidths.length=0;var n=this._parameters.definition.font;("italic"===n.style||"oblique"===n.style||"string"==typeof n.weight&&("bold"===n.weight||"bolder"===n.weight)||"number"==typeof n.weight&&n.weight>600)&&(r+=.3*e.measureText("A").width);var a,o=Object(i.a)(this._lines);try{for(o.s();!(a=o.n()).done;){var c=a.value,l=Math.round(e.measureText(c).width+r);this._lineWidths.push(l),t=Math.max(t,l)}}catch(u){o.e(u)}finally{o.f()}return this._displayWidth=t,this._displayWidth}},{key:"computeLineHeight",value:function(){var e=1.275*this._parameters.definition.size;return Math.ceil(e+2*this._parameters.haloSize)+u}}]),e}();function l(e,t){return"center"===e?.5*t:"right"===e?t:0}for(var u=1,d=[],h=0;h<360;h+=22.5)d.push([Math.cos(Math.PI*h/180),Math.sin(Math.PI*h/180)]);function f(e,t,r){return e.canvas||(e.canvas=document.createElement("canvas")),e.canvas.width=t,e.canvas.height=r,e.canvas}var p={canvas:null},b=512},function(e,t,r){"use strict";r.d(t,"a",(function(){return a})),r.d(t,"b",(function(){return i}));var n=r(3);function i(e,t){if(!e.target)return null;switch(e.target.type){case"stage":return s(e.target.obj.metadata,t);case"external":switch(e.intersector){case"PointRenderer":return function(e,t){var r=e.metadata.layerUid;return null!=r?t.map.findLayerByUid(r):null}(e.target,t);case"I3S":case"IM":case"LodRenderer":case"OverlayRenderer":return s(e.target.metadata,t);case"TerrainRenderer":return t.map&&t.map.ground}}return null}function a(e,t){if(!e.target)return null;switch(e.target.type){case"stage":return o(e.target.obj.metadata,t);case"external":switch(e.intersector){case"PointRenderer":return function(e){return e.metadata.createGraphic()}(e.target);case"I3S":case"IM":case"LodRenderer":case"OverlayRenderer":return o(e.target.metadata,t)}}return null}function o(e,t){if(Object(n.i)(e))return null;var r=s(e,t);if(Object(n.i)(r))return null;if(r===t.graphics)return Object(n.j)(t.graphicsView)?Object(n.s)(t.graphicsView.getGraphicFromGraphicUid(e.graphicUid)):null;var i,a,o=t.allLayerViews.find((function(e){return e.layer===r}));return o?(a=e,!(i=o)||i.suspended?null:"getGraphicFromIntersectorMetadata"in i&&a?i.getGraphicFromIntersectorMetadata(a):"getGraphicFromGraphicUid"in i&&null!=a.graphicUid?i.getGraphicFromGraphicUid(a.graphicUid):null):null}function s(e,t){return Object(n.i)(e)||null==e.layerUid?null:Object(n.j)(t.graphicsView)&&e.layerUid===t.graphicsView.graphics3d.layer.id?t.graphics:t.map.findLayerByUid(e.layerUid)}},function(e,t,r){"use strict";var n,i=r(50),a=r(8),o=r.n(a),s=r(14),c=r(16),l=r(2),u=r(5),d=r(6),h=r(7),f=r(0),p=r(98),b=r(58),v=r(25),m=r(15),y=r(3),g=r(1),O=r(64),j=(r(17),r(52)),_=r(48),w=r(10),x=r(44),k=r(18),S=r(103),T=r(190),C=r(286),M=r(429),P=r(334),A=r(371),E=r(153),R=m.a.getLogger("esri.renderers.ClassBreaksRenderer"),I="percent-of-total",D="field",F=new b.a({esriNormalizeByLog:"log",esriNormalizeByPercentOfTotal:I,esriNormalizeByField:D}),L=Object(k.m)(M.a),z=n=function(e){Object(d.a)(r,e);var t=Object(h.a)(r);function r(e){var n;return Object(l.a)(this,r),(n=t.call(this,e))._compiledValueExpression={valueExpression:null,compiledFunction:null},n.backgroundFillSymbol=null,n.classBreakInfos=null,n.defaultLabel=null,n.defaultSymbol=null,n.field=null,n.isMaxInclusive=!0,n.legendOptions=null,n.normalizationField=null,n.normalizationTotal=null,n.type="class-breaks",n.valueExpression=null,n.valueExpressionTitle=null,n._set("classBreakInfos",[]),n}return Object(u.a)(r,[{key:"readClassBreakInfos",value:function(e,t,r){if(Array.isArray(e)){var n=t.minValue;return e.map((function(e){var t=new M.a;return t.read(e,r),null==t.minValue&&(t.minValue=n),null==t.maxValue&&(t.maxValue=t.minValue),n=t.maxValue,t}))}}},{key:"writeClassBreakInfos",value:function(e,t,r,n){var i=e.map((function(e){return e.write({},n)}));this._areClassBreaksConsecutive()&&i.forEach((function(e){return delete e.classMinValue})),t[r]=i}},{key:"castField",value:function(e){return null==e?e:"function"==typeof e?(R.error(".field: field must be a string value"),null):Object(k.l)(e)}},{key:"minValue",get:function(){return this.classBreakInfos&&this.classBreakInfos[0]&&this.classBreakInfos[0].minValue||0}},{key:"normalizationType",get:function(){var e=this._get("normalizationType"),t=!!this.normalizationField,r=null!=this.normalizationTotal;return t||r?(e=(t?D:r&&I)||null,t&&r&&R.warn("warning: both normalizationField and normalizationTotal are set!")):e!==D&&e!==I||(e=null),e},set:function(e){this._set("normalizationType",e)}},{key:"addClassBreakInfo",value:function(e,t,r){var n;n="number"==typeof e?new M.a({minValue:e,maxValue:t,symbol:Object(p.a)(r)}):L(Object(v.a)(e)),this.classBreakInfos.push(n),1===this.classBreakInfos.length&&this.notifyChange("minValue")}},{key:"removeClassBreakInfo",value:function(e,t){for(var r=this.classBreakInfos.length,n=0;n<r;n++){var i=[this.classBreakInfos[n].minValue,this.classBreakInfos[n].maxValue];if(i[0]===e&&i[1]===t){this.classBreakInfos.splice(n,1);break}}}},{key:"getBreakIndex",value:function(e,t){return this.valueExpression&&(Object(y.i)(t)||Object(y.i)(t.arcade))&&R.warn(""),this.valueExpression?this._getBreakIndexForExpression(e,t):this._getBreakIndexForField(e)}},{key:"getClassBreakInfo",value:function(){var e=Object(c.a)(o.a.mark((function e(t,r){var n,i;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=r,e.t0=this.valueExpression&&(Object(y.i)(r)||Object(y.i)(r.arcade)),!e.t0){e.next=11;break}return e.t1=s.a,e.t2=Object(s.a)({},n),e.t3={},e.next=8,Object(E.e)();case 8:e.t4=e.sent,e.t5={arcade:e.t4},n=(0,e.t1)(e.t2,e.t3,e.t5);case 11:return i=this.getBreakIndex(t,n),e.abrupt("return",-1!==i?this.classBreakInfos[i]:null);case 13:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"getSymbol",value:function(e,t){if(!this.valueExpression||!Object(y.i)(t)&&!Object(y.i)(t.arcade)){var r=this.getBreakIndex(e,t);return r>-1?this.classBreakInfos[r].symbol:this.defaultSymbol}R.error("#getSymbol()","Please use getSymbolAsync if valueExpression is used")}},{key:"getSymbolAsync",value:function(){var e=Object(c.a)(o.a.mark((function e(t,r){var n,i,a,c;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=r,!this.valueExpression||!Object(y.i)(r)&&!Object(y.i)(r.arcade)){e.next=11;break}return e.next=4,Object(E.e)();case 4:if(i=e.sent,a=i.arcadeUtils,e.t0=a.hasGeometryOperations(this.valueExpression),!e.t0){e.next=10;break}return e.next=10,a.enableGeometryOperations();case 10:n=Object(s.a)(Object(s.a)({},n),{},{arcade:i});case 11:return c=this.getBreakIndex(t,n),e.abrupt("return",c>-1?this.classBreakInfos[c].symbol:this.defaultSymbol);case 13:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"getSymbols",value:function(){var e=[];return this.classBreakInfos.forEach((function(t){t.symbol&&e.push(t.symbol)})),this.defaultSymbol&&e.push(this.defaultSymbol),e}},{key:"getAttributeHash",value:function(){return this.visualVariables&&this.visualVariables.reduce((function(e,t){return e+t.getAttributeHash()}),"")}},{key:"getMeshHash",value:function(){var e=JSON.stringify(this.backgroundFillSymbol),t=JSON.stringify(this.defaultSymbol),r="".concat(this.normalizationField,".").concat(this.normalizationType,".").concat(this.normalizationTotal);return"".concat(e,".").concat(t,".").concat(this.classBreakInfos.reduce((function(e,t){return e+t.getMeshHash()}),""),".").concat(r,".").concat(this.field,".").concat(this.valueExpression)}},{key:"arcadeRequired",get:function(){return this.arcadeRequiredForVisualVariables||!!this.valueExpression}},{key:"clone",value:function(){return new n({field:this.field,backgroundFillSymbol:this.backgroundFillSymbol&&this.backgroundFillSymbol.clone(),defaultLabel:this.defaultLabel,defaultSymbol:this.defaultSymbol&&this.defaultSymbol.clone(),valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle,classBreakInfos:Object(v.a)(this.classBreakInfos),isMaxInclusive:this.isMaxInclusive,normalizationField:this.normalizationField,normalizationTotal:this.normalizationTotal,normalizationType:this.normalizationType,visualVariables:Object(v.a)(this.visualVariables),legendOptions:Object(v.a)(this.legendOptions),authoringInfo:this.authoringInfo&&this.authoringInfo.clone()})}},{key:"collectRequiredFields",value:function(){var e=Object(c.a)(o.a.mark((function e(t,r){var n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=[this.collectVVRequiredFields(t,r),this.collectSymbolFields(t,r)],e.next=3,Promise.all(n);case 3:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"collectSymbolFields",value:function(){var e=Object(c.a)(o.a.mark((function e(t,r){var n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=[].concat(Object(i.a)(this.getSymbols().map((function(e){return e.collectRequiredFields(t,r)}))),[Object(S.a)(t,r,this.valueExpression)]),Object(S.d)(t,r,this.field),Object(S.d)(t,r,this.normalizationField),e.next=5,Promise.all(n);case 5:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"_getBreakIndexForExpression",value:function(e,t){var r=Object(y.t)(t,{}),n=r.viewingMode,i=r.scale,a=r.spatialReference,o=r.arcade,s=this._compiledValueExpression.valueExpression===this.valueExpression?this._compiledValueExpression.compiledFunction:null,c=Object(y.s)(o).arcadeUtils;if(!s){var l=c.createSyntaxTree(this.valueExpression);s=c.createFunction(l),this._compiledValueExpression.compiledFunction=s}this._compiledValueExpression.valueExpression=this.valueExpression;var u=c.executeFunction(s,c.createExecContext(e,c.getViewInfo({viewingMode:n,scale:i,spatialReference:a})));return this._getBreakIndexfromInfos(u)}},{key:"_getBreakIndexForField",value:function(e){var t=this.field,r=e.attributes,n=this.normalizationType,i=parseFloat(r[t]);if(n){var a=this.normalizationTotal,o=parseFloat(r[this.normalizationField]);if("log"===n)i=Math.log(i)*Math.LOG10E;else if(n!==I||isNaN(a)){if(n===D&&!isNaN(o)){if(isNaN(i)||isNaN(o))return-1;i/=o}}else i=i/a*100}return this._getBreakIndexfromInfos(i)}},{key:"_getBreakIndexfromInfos",value:function(e){var t=this.isMaxInclusive;if(null!=e&&"number"==typeof e&&!isNaN(e))for(var r=0;r<this.classBreakInfos.length;r++){var n=[this.classBreakInfos[r].minValue,this.classBreakInfos[r].maxValue];if(n[0]<=e&&(t?e<=n[1]:e<n[1]))return r}return-1}},{key:"_areClassBreaksConsecutive",value:function(){for(var e=this.classBreakInfos,t=e.length,r=1;r<t;r++)if(e[r-1].maxValue!==e[r].minValue)return!1;return!0}}]),r}(Object(C.a)(T.a));Object(f.a)([Object(g.b)(P.a)],z.prototype,"backgroundFillSymbol",void 0),Object(f.a)([Object(g.b)({type:[M.a]})],z.prototype,"classBreakInfos",void 0),Object(f.a)([Object(_.a)("classBreakInfos")],z.prototype,"readClassBreakInfos",null),Object(f.a)([Object(x.a)("classBreakInfos")],z.prototype,"writeClassBreakInfos",null),Object(f.a)([Object(g.b)({type:String,json:{write:!0}})],z.prototype,"defaultLabel",void 0),Object(f.a)([Object(g.b)(P.b)],z.prototype,"defaultSymbol",void 0),Object(f.a)([Object(g.b)({type:String,json:{write:!0}})],z.prototype,"field",void 0),Object(f.a)([Object(O.a)("field")],z.prototype,"castField",null),Object(f.a)([Object(g.b)({type:Boolean})],z.prototype,"isMaxInclusive",void 0),Object(f.a)([Object(g.b)({type:A.a,json:{write:!0}})],z.prototype,"legendOptions",void 0),Object(f.a)([Object(g.b)({type:Number,readOnly:!0,value:null,json:{read:!1,write:{overridePolicy:function(){return 0!==this.classBreakInfos.length&&this._areClassBreaksConsecutive()?{enabled:!0}:{enabled:!1}}}}})],z.prototype,"minValue",null),Object(f.a)([Object(g.b)({type:String,json:{write:!0}})],z.prototype,"normalizationField",void 0),Object(f.a)([Object(g.b)({type:Number,cast:function(e){return Object(k.i)(e)},json:{write:!0}})],z.prototype,"normalizationTotal",void 0),Object(f.a)([Object(g.b)({type:F.apiValues,value:null,json:{type:F.jsonValues,read:F.read,write:F.write}})],z.prototype,"normalizationType",null),Object(f.a)([Object(j.a)({classBreaks:"class-breaks"})],z.prototype,"type",void 0),Object(f.a)([Object(g.b)({type:String,json:{write:!0}})],z.prototype,"valueExpression",void 0),Object(f.a)([Object(g.b)({type:String,json:{write:!0}})],z.prototype,"valueExpressionTitle",void 0);var V=z=n=Object(f.a)([Object(w.a)("esri.renderers.ClassBreaksRenderer")],z);t.a=V},function(e,t,r){"use strict";r.r(t);var n,i=r(13),a=r(8),o=r.n(a),s=r(16),c=r(14),l=r(2),u=r(5),d=r(45),h=r(42),f=r(6),p=r(7),b=r(0),v=r(272),m=(r(447),r(545),r(546),r(547),r(190),r(417)),y=r(415),g=r(451),O=r(419),j=r(99),_=r(98),w=r(53),x=r(22),k=r(57),S=r(17),T=r(58),C=r(15),M=r(3),P=r(567),A=r(113),E=r(23),R=r(39),I=r(1),D=r(64),F=r(48),L=r(10),z=r(44),V=r(257),N=r(27),U=r(25),B=r(18),G=n=function(e){Object(f.a)(r,e);var t=Object(p.a)(r);function r(e){var n;return Object(l.a)(this,r),(n=t.call(this,e)).expression=null,n.name=null,n.returnType="boolean",n.title=null,n}return Object(u.a)(r,[{key:"clone",value:function(){return new n({name:this.name,title:this.title,expression:this.expression,returnType:this.returnType})}}]),r}(N.a);Object(b.a)([Object(I.b)({type:String,json:{write:!0}})],G.prototype,"expression",void 0),Object(b.a)([Object(I.b)({type:String,json:{write:!0}})],G.prototype,"name",void 0),Object(b.a)([Object(I.b)({type:["boolean"],json:{write:!0}})],G.prototype,"returnType",void 0),Object(b.a)([Object(I.b)({type:String,json:{write:!0}})],G.prototype,"title",void 0);var q=G=n=Object(b.a)([Object(L.a)("esri.form.ExpressionInfo")],G),H=function(e){Object(f.a)(r,e);var t=Object(p.a)(r);function r(e){var n;return Object(l.a)(this,r),(n=t.call(this,e)).description=null,n.label=null,n.type=null,n.visibilityExpression=null,n}return r}(N.a);Object(b.a)([Object(I.b)({type:String,json:{write:!0}})],H.prototype,"description",void 0),Object(b.a)([Object(I.b)({type:String,json:{write:!0}})],H.prototype,"label",void 0),Object(b.a)([Object(I.b)()],H.prototype,"type",void 0),Object(b.a)([Object(I.b)({type:String,json:{write:!0}})],H.prototype,"visibilityExpression",void 0);var W,Q=H=Object(b.a)([Object(L.a)("esri.form.elements.Element")],H),Z=W=function(e){Object(f.a)(r,e);var t=Object(p.a)(r);function r(e){var n;return Object(l.a)(this,r),(n=t.call(this,e)).type=null,n}return Object(u.a)(r,[{key:"clone",value:function(){return new W({type:this.type})}}]),r}(N.a);Object(b.a)([Object(I.b)({type:["attachment","audio","document","image","signature","video"],json:{write:!0}})],Z.prototype,"type",void 0);var X,Y=Z=W=Object(b.a)([Object(L.a)("esri.form.elements.inputs.AttachmentInput")],Z),$=X=function(e){Object(f.a)(r,e);var t=Object(p.a)(r);function r(e){var n;return Object(l.a)(this,r),(n=t.call(this,e)).attachmentKeyword=null,n.editable=!0,n.input=null,n.type="attachment",n}return Object(u.a)(r,[{key:"clone",value:function(){return new X({attachmentKeyword:this.attachmentKeyword,description:this.description,editable:this.editable,input:this.input,label:this.label,visibilityExpression:this.visibilityExpression})}}]),r}(Q);Object(b.a)([Object(I.b)({type:String,json:{write:!0}})],$.prototype,"attachmentKeyword",void 0),Object(b.a)([Object(I.b)({type:Boolean,json:{write:!0}})],$.prototype,"editable",void 0),Object(b.a)([Object(I.b)({type:Y,json:{read:{source:"inputType"},write:{target:"inputType"}}})],$.prototype,"input",void 0),Object(b.a)([Object(I.b)({type:["attachment"],json:{read:!1,write:!0}})],$.prototype,"type",void 0);var J=$=X=Object(b.a)([Object(L.a)("esri.form.elements.AttachmentElement")],$),K=function(e){Object(f.a)(r,e);var t=Object(p.a)(r);function r(e){var n;return Object(l.a)(this,r),(n=t.call(this,e)).type=null,n}return r}(N.a);Object(b.a)([Object(I.b)()],K.prototype,"type",void 0);var ee=K=Object(b.a)([Object(L.a)("esri.form.elements.inputs.Input")],K),te=function(e){Object(f.a)(r,e);var t=Object(p.a)(r);function r(e){var n;return Object(l.a)(this,r),(n=t.call(this,e)).maxLength=null,n.minLength=0,n}return r}(ee);Object(b.a)([Object(I.b)({type:Number,json:{write:!0}})],te.prototype,"maxLength",void 0),Object(b.a)([Object(I.b)({type:Number,json:{write:!0}})],te.prototype,"minLength",void 0);var re,ne=te=Object(b.a)([Object(L.a)("esri.form.elements.inputs.TextInput")],te),ie=re=function(e){Object(f.a)(r,e);var t=Object(p.a)(r);function r(e){var n;return Object(l.a)(this,r),(n=t.call(this,e)).type="barcode-scanner",n}return Object(u.a)(r,[{key:"clone",value:function(){return new re({maxLength:this.maxLength,minLength:this.minLength})}}]),r}(ne);Object(b.a)([Object(I.b)({type:["barcode-scanner"],json:{read:!1,write:!0}})],ie.prototype,"type",void 0);var ae,oe=ie=re=Object(b.a)([Object(L.a)("esri.form.elements.inputs.BarcodeScannerInput")],ie),se=ae=function(e){Object(f.a)(r,e);var t=Object(p.a)(r);function r(e){var n;return Object(l.a)(this,r),(n=t.call(this,e)).noValueOptionLabel=null,n.showNoValueOption=!1,n.type="combo-box",n}return Object(u.a)(r,[{key:"clone",value:function(){return new ae({showNoValueOption:this.showNoValueOption,noValueOptionLabel:this.noValueOptionLabel})}}]),r}(ee);Object(b.a)([Object(I.b)({type:String,json:{write:!0}})],se.prototype,"noValueOptionLabel",void 0),Object(b.a)([Object(I.b)({type:Boolean,json:{write:!0}})],se.prototype,"showNoValueOption",void 0),Object(b.a)([Object(I.b)({type:["combo-box"],json:{read:!1,write:!0}})],se.prototype,"type",void 0);var ce,le=se=ae=Object(b.a)([Object(L.a)("esri.form.elements.inputs.ComboBoxInput")],se);function ue(e){return null!=e?new Date(e):null}function de(e){return e?e.getTime():null}var he=ce=function(e){Object(f.a)(r,e);var t=Object(p.a)(r);function r(e){var n;return Object(l.a)(this,r),(n=t.call(this,e)).includeTime=!1,n.max=null,n.min=null,n.type="datetime-picker",n}return Object(u.a)(r,[{key:"readMax",value:function(e,t){return ue(t.max)}},{key:"writeMax",value:function(e,t){t.max=de(e)}},{key:"readMin",value:function(e,t){return ue(t.min)}},{key:"writeMin",value:function(e,t){t.min=de(e)}},{key:"clone",value:function(){return new ce({includeTime:this.includeTime,max:this.max,min:this.min,type:this.type})}}]),r}(ee);Object(b.a)([Object(I.b)({type:Boolean,json:{write:!0}})],he.prototype,"includeTime",void 0),Object(b.a)([Object(I.b)({type:Date,json:{type:Number,write:!0}})],he.prototype,"max",void 0),Object(b.a)([Object(F.a)("max")],he.prototype,"readMax",null),Object(b.a)([Object(z.a)("max")],he.prototype,"writeMax",null),Object(b.a)([Object(I.b)({type:Date,json:{type:Number,write:!0}})],he.prototype,"min",void 0),Object(b.a)([Object(F.a)("min")],he.prototype,"readMin",null),Object(b.a)([Object(z.a)("min")],he.prototype,"writeMin",null),Object(b.a)([Object(I.b)({type:["datetime-picker"],json:{read:!1,write:!0}})],he.prototype,"type",void 0);var fe,pe=he=ce=Object(b.a)([Object(L.a)("esri.form.elements.inputs.DateTimePickerInput")],he),be=fe=function(e){Object(f.a)(r,e);var t=Object(p.a)(r);function r(e){var n;return Object(l.a)(this,r),(n=t.call(this,e)).noValueOptionLabel=null,n.showNoValueOption=!1,n.type="radio-buttons",n}return Object(u.a)(r,[{key:"clone",value:function(){return new fe({noValueOptionLabel:this.noValueOptionLabel,showNoValueOption:this.showNoValueOption})}}]),r}(ee);Object(b.a)([Object(I.b)({type:String,json:{write:!0}})],be.prototype,"noValueOptionLabel",void 0),Object(b.a)([Object(I.b)({type:Boolean,json:{write:!0}})],be.prototype,"showNoValueOption",void 0),Object(b.a)([Object(I.b)({type:["radio-buttons"],json:{read:!1,write:!0}})],be.prototype,"type",void 0);var ve,me=be=fe=Object(b.a)([Object(L.a)("esri.form.elements.inputs.RadioButtonsInput")],be),ye=ve=function(e){Object(f.a)(r,e);var t=Object(p.a)(r);function r(e){var n;return Object(l.a)(this,r),(n=t.call(this,e)).offValue=null,n.onValue=null,n.type="switch",n}return Object(u.a)(r,[{key:"clone",value:function(){return new ve({offValue:this.offValue,onValue:this.onValue})}}]),r}(ee);Object(b.a)([Object(I.b)({type:[String,Number],json:{write:!0}})],ye.prototype,"offValue",void 0),Object(b.a)([Object(I.b)({type:[String,Number],json:{write:!0}})],ye.prototype,"onValue",void 0),Object(b.a)([Object(I.b)({type:["switch"],json:{read:!1,write:!0}})],ye.prototype,"type",void 0);var ge,Oe=ye=ve=Object(b.a)([Object(L.a)("esri.form.elements.inputs.SwitchInput")],ye),je=ge=function(e){Object(f.a)(r,e);var t=Object(p.a)(r);function r(e){var n;return Object(l.a)(this,r),(n=t.call(this,e)).type="text-area",n}return Object(u.a)(r,[{key:"clone",value:function(){return new ge({maxLength:this.maxLength,minLength:this.minLength})}}]),r}(ne);Object(b.a)([Object(I.b)({type:["text-area"],json:{read:!1,write:!0}})],je.prototype,"type",void 0);var _e,we=je=ge=Object(b.a)([Object(L.a)("esri.form.elements.inputs.TextAreaInput")],je),xe=_e=function(e){Object(f.a)(r,e);var t=Object(p.a)(r);function r(e){var n;return Object(l.a)(this,r),(n=t.call(this,e)).type="text-box",n}return Object(u.a)(r,[{key:"clone",value:function(){return new _e({maxLength:this.maxLength,minLength:this.minLength})}}]),r}(ne);Object(b.a)([Object(I.b)({type:["text-box"],json:{read:!1,write:!0}})],xe.prototype,"type",void 0);var ke,Se={base:ee,key:"type",typeMap:{"barcode-scanner":oe,"combo-box":le,"datetime-picker":pe,"radio-buttons":me,switch:Oe,"text-area":we,"text-box":xe=_e=Object(b.a)([Object(L.a)("esri.form.elements.inputs.TextBoxInput")],xe)}},Te=r(249),Ce=ke=function(e){Object(f.a)(r,e);var t=Object(p.a)(r);function r(e){var n;return Object(l.a)(this,r),(n=t.call(this,e)).domain=null,n.editable=!0,n.fieldName=null,n.hint=null,n.input=null,n.requiredExpression=null,n.type="field",n}return Object(u.a)(r,[{key:"clone",value:function(){return new ke({description:this.description,domain:this.domain,editable:this.editable,fieldName:this.fieldName,hint:this.hint,input:this.input,label:this.label,requiredExpression:this.requiredExpression,visibilityExpression:this.visibilityExpression})}}]),r}(Q);Object(b.a)([Object(I.b)({types:Te.d,json:{read:{reader:Te.b},write:!0}})],Ce.prototype,"domain",void 0),Object(b.a)([Object(I.b)({type:Boolean,json:{write:!0}})],Ce.prototype,"editable",void 0),Object(b.a)([Object(I.b)({type:String,json:{write:!0}})],Ce.prototype,"fieldName",void 0),Object(b.a)([Object(I.b)({type:String,json:{write:!0}})],Ce.prototype,"hint",void 0),Object(b.a)([Object(I.b)({types:Se,json:{read:{source:"inputType"},write:{target:"inputType"}}})],Ce.prototype,"input",void 0),Object(b.a)([Object(I.b)({type:String,json:{write:!0}})],Ce.prototype,"requiredExpression",void 0),Object(b.a)([Object(I.b)({type:String,json:{read:!1,write:!0}})],Ce.prototype,"type",void 0);var Me,Pe=Ce=ke=Object(b.a)([Object(L.a)("esri.form.elements.FieldElement")],Ce),Ae=r(514),Ee=Me=function(e){Object(f.a)(r,e);var t=Object(p.a)(r);function r(e){var n;return Object(l.a)(this,r),(n=t.call(this,e)).displayCount=null,n.displayType="list",n.editable=!0,n.orderByFields=null,n.relationshipId=null,n.type="relationship",n}return Object(u.a)(r,[{key:"clone",value:function(){return new Me({description:this.description,displayCount:this.displayCount,displayType:this.displayType,editable:this.editable,label:this.label,orderByFields:Object(U.a)(this.orderByFields),relationshipId:this.relationshipId,visibilityExpression:this.visibilityExpression})}}]),r}(Q);Object(b.a)([Object(I.b)({type:Number,json:{write:!0}})],Ee.prototype,"displayCount",void 0),Object(b.a)([Object(I.b)({type:["list"],json:{write:!0}})],Ee.prototype,"displayType",void 0),Object(b.a)([Object(I.b)({type:Boolean,json:{write:!0}})],Ee.prototype,"editable",void 0),Object(b.a)([Object(I.b)({type:[Ae.a],json:{write:!0}})],Ee.prototype,"orderByFields",void 0),Object(b.a)([Object(I.b)({type:Number,json:{write:!0}})],Ee.prototype,"relationshipId",void 0),Object(b.a)([Object(I.b)({type:["relationship"],json:{read:!1,write:!0}})],Ee.prototype,"type",void 0);var Re,Ie=Ee=Me=Object(b.a)([Object(L.a)("esri.form.elements.RelationshipElement")],Ee);function De(e){return{typesWithGroup:{base:Q,key:"type",typeMap:{attachment:J,field:Pe,group:e,relationship:Ie}},typesWithoutGroup:{base:Q,key:"type",typeMap:{attachment:J,field:Pe,relationship:Ie}}}}function Fe(e,t){var r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(!e)return null;var n=r?t.typesWithGroup.typeMap:t.typesWithoutGroup.typeMap;return e.filter((function(e){return n[e.type]})).map((function(e){return n[e.type].fromJSON(e)}))}function Le(e,t){var r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(!e)return null;var n=r?t.typesWithGroup.typeMap:t.typesWithoutGroup.typeMap;return e.filter((function(e){return n[e.type]})).map((function(e){return e.toJSON()}))}function ze(e,t){var r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return e?e.map((function(e){return Object(B.k)(r?t.typesWithGroup:t.typesWithoutGroup,e)})):null}var Ve=Re=function(e){Object(f.a)(r,e);var t=Object(p.a)(r);function r(e){var n;return Object(l.a)(this,r),(n=t.call(this,e)).elements=null,n.initialState="expanded",n.type="group",n}return Object(u.a)(r,[{key:"castElements",value:function(e){return ze(e,Ue,!1)}},{key:"readElements",value:function(e,t){return Fe(t.formElements,Ue,!1)}},{key:"writeElements",value:function(e,t){t.formElements=Le(e,Ue,!1)}},{key:"clone",value:function(){return new Re({description:this.description,elements:Object(U.a)(this.elements),initialState:this.initialState,label:this.label,visibilityExpression:this.visibilityExpression})}}]),r}(Q);Object(b.a)([Object(I.b)({json:{write:!0}})],Ve.prototype,"elements",void 0),Object(b.a)([Object(D.a)("elements")],Ve.prototype,"castElements",null),Object(b.a)([Object(F.a)("elements",["formElements"])],Ve.prototype,"readElements",null),Object(b.a)([Object(z.a)("elements")],Ve.prototype,"writeElements",null),Object(b.a)([Object(I.b)({type:["collapsed","expanded"],json:{write:!0}})],Ve.prototype,"initialState",void 0),Object(b.a)([Object(I.b)({type:String,json:{read:!1,write:!0}})],Ve.prototype,"type",void 0);var Ne,Ue=De(Ve=Re=Object(b.a)([Object(L.a)("esri.form.elements.GroupElement")],Ve)),Be=De(Ve),Ge=Ne=function(e){Object(f.a)(r,e);var t=Object(p.a)(r);function r(e){var n;return Object(l.a)(this,r),(n=t.call(this,e)).description=null,n.elements=null,n.expressionInfos=null,n.title=null,n}return Object(u.a)(r,[{key:"castElements",value:function(e){return ze(e,Be)}},{key:"readElements",value:function(e,t){return Fe(t.formElements,Be)}},{key:"writeElements",value:function(e,t){t.formElements=Le(e,Be)}},{key:"clone",value:function(){return new Ne({description:this.description,expressionInfos:Object(U.a)(this.expressionInfos),elements:Object(U.a)(this.elements),title:this.title})}}]),r}(N.a);Object(b.a)([Object(I.b)({type:String,json:{write:!0}})],Ge.prototype,"description",void 0),Object(b.a)([Object(I.b)({json:{write:!0}})],Ge.prototype,"elements",void 0),Object(b.a)([Object(D.a)("elements")],Ge.prototype,"castElements",null),Object(b.a)([Object(F.a)("elements",["formElements"])],Ge.prototype,"readElements",null),Object(b.a)([Object(z.a)("elements")],Ge.prototype,"writeElements",null),Object(b.a)([Object(I.b)({type:[q],json:{write:!0}})],Ge.prototype,"expressionInfos",void 0),Object(b.a)([Object(I.b)({type:String,json:{write:!0}})],Ge.prototype,"title",void 0);var qe=Ge=Ne=Object(b.a)([Object(L.a)("esri.form.FormTemplate")],Ge),He=r(66),We=r(260),Qe=r(55),Ze=r(368),Xe=(r(126),r(137)),Ye=r(180),$e=r(238),Je=r(369);var Ke,et=r(358),tt=r(372),rt=r(216),nt=r(158),it=r(241),at=0,ot=C.a.getLogger("esri.layers.graphics.sources.MemorySource"),st=function(e){Object(f.a)(r,e);var t=Object(p.a)(r);function r(e){var n;return Object(l.a)(this,r),(n=t.call(this,e))._idToClientGraphic=null,n.type="memory",n}return Object(u.a)(r,[{key:"load",value:function(e){var t=Object(M.j)(e)?e.signal:null;return this.addResolvingPromise(this._startWorker(t)),Promise.resolve(this)}},{key:"destroy",value:function(){var e;null==(e=this._connection)||e.close(),this._connection=null}},{key:"workerGeometryType",get:function(){var e,t=null==(e=this.layer)?void 0:e.geometryType;return t?this._geometryTypeRequiresClientGraphicMapping(t)?"polygon":t:null}},{key:"applyEdits",value:function(e){var t=this;return this.load().then((function(){return t._applyEdits(e)}))}},{key:"openPorts",value:function(){var e=this;return this.load().then((function(){return e._connection.openPorts()}))}},{key:"queryFeatures",value:function(){var e=Object(s.a)(o.a.mark((function e(t){var r,n,a,s,c,l,u,d,h,f=arguments;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=f.length>1&&void 0!==f[1]?f[1]:{},e.next=3,this.load(r);case 3:return e.next=5,this._connection.invoke("queryFeatures",t?t.toJSON():null,r);case 5:if(n=e.sent,Object(et.a)(t,this.layer.spatialReference,n),a=rt.default.fromJSON(n),this._requiresClientGraphicMapping()){e.next=10;break}return e.abrupt("return",a);case 10:s=this.layer.objectIdField,c=Object(i.a)(a.features);try{for(c.s();!(l=c.n()).done;)u=l.value,d=u.attributes[s],(h=this._idToClientGraphic.get(d))&&(u.geometry=h.geometry)}catch(o){c.e(o)}finally{c.f()}return e.abrupt("return",(a.geometryType=this.layer.geometryType,a));case 14:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"queryFeaturesJSON",value:function(){var e=Object(s.a)(o.a.mark((function e(t){var r,n,i=arguments;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=i.length>1&&void 0!==i[1]?i[1]:{},!this._requiresClientGraphicMapping()){e.next=3;break}throw new x.a("query-features-json:unsupported","Cannot query in JSON format for client only geometry types (mesh and extent)");case 3:return e.next=5,this.load(r);case 5:return e.next=7,this._connection.invoke("queryFeatures",t?t.toJSON():null,r);case 7:return n=e.sent,e.abrupt("return",(Object(et.a)(t,this.layer.spatialReference,n),n));case 9:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"queryFeatureCount",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.load(r).then((function(){return t._connection.invoke("queryFeatureCount",e?e.toJSON():null,r)}))}},{key:"queryObjectIds",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.load(r).then((function(){return t._connection.invoke("queryObjectIds",e?e.toJSON():null,r)}))}},{key:"queryExtent",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.load(r).then((function(){return t._connection.invoke("queryExtent",e?e.toJSON():null,r)})).then((function(e){return{count:e.count,extent:He.a.fromJSON(e.extent)}}))}},{key:"querySnapping",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.load(r).then((function(){return t._connection.invoke("querySnapping",e,r)}))}},{key:"_applyEdits",value:function(){var e=Object(s.a)(o.a.mark((function e(t){var r,n,a,s,c,l,u,d,h,f,p,b,v,m,y,g,O;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._connection){e.next=2;break}throw new x.a("feature-layer-source:edit-failure","Memory source not loaded");case 2:return r=this.layer.objectIdField,n=null,a=[],s=[],e.next=7,Promise.all([this._prepareClientMapping(t.addFeatures,null),this._prepareClientMapping(t.updateFeatures,null)]);case 7:if(c=function(e){return"objectId"in e&&null!=e.objectId?e.objectId:"attributes"in e&&null!=e.attributes[r]?e.attributes[r]:null},t.addFeatures&&(n=this._prepareAddFeatures(t.addFeatures)),t.deleteFeatures){l=Object(i.a)(t.deleteFeatures);try{for(l.s();!(u=l.n()).done;)d=u.value,null!=(h=c(d))&&a.push(h)}catch(o){l.e(o)}finally{l.f()}}if(f=t.updateFeatures&&this._idToClientGraphic?new Map:null,t.updateFeatures){p=Object(i.a)(t.updateFeatures);try{for(p.s();!(b=p.n()).done;)v=b.value,s.push(this._serializeFeature(v)),f&&null!=(m=c(v))&&f.set(m,v)}catch(o){p.e(o)}finally{p.f()}}return Object(tt.b)(n?n.features:null,s,this.layer.spatialReference),e.next=14,this._connection.invoke("applyEdits",{adds:n?n.features:[],updates:s,deletes:a});case 14:return y=e.sent,g=y.fullExtent,O=y.featureEditResults,e.abrupt("return",(this.fullExtent=g,n&&n.finish(O.uidToObjectId),this._updateClientGraphicIds(f,O),this._createEditsResult(O)));case 18:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_prepareClientMapping",value:function(){var e=Object(s.a)(o.a.mark((function e(t,r){var n,a,s,c;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("mesh"===this.layerOrSourceGeometryType&&!Object(M.i)(t)){e.next=2;break}return e.abrupt("return");case 2:n=[],a=Object(i.a)(t);try{for(a.s();!(s=a.n()).done;)c=s.value.geometry,!Object(M.j)(c)||"mesh"!==c.type||c.hasExtent||c.loaded||n.push(c.load({signal:r}))}catch(o){a.e(o)}finally{a.f()}if(e.t0=n.length,!e.t0){e.next=9;break}return e.next=9,Promise.all(n);case 9:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"_updateClientGraphicIds",value:function(e,t){if(this._idToClientGraphic){if(e){var r,n=Object(i.a)(t.updateResults);try{for(n.s();!(r=n.n()).done;){var a=r.value;if(a.success){var o=e.get(a.objectId);null!=o&&this._addIdToClientGraphic(o)}}}catch(u){n.e(u)}finally{n.f()}}var s,c=Object(i.a)(t.deleteResults);try{for(c.s();!(s=c.n()).done;){var l=s.value;l.success&&this._idToClientGraphic.delete(l.objectId)}}catch(u){c.e(u)}finally{c.f()}}}},{key:"_createEditsResult",value:function(e){return{addFeatureResults:e.addResults?e.addResults.map(this._createFeatureEditResult,this):[],updateFeatureResults:e.updateResults?e.updateResults.map(this._createFeatureEditResult,this):[],deleteFeatureResults:e.deleteResults?e.deleteResults.map(this._createFeatureEditResult,this):[],addAttachmentResults:[],updateAttachmentResults:[],deleteAttachmentResults:[]}}},{key:"_createFeatureEditResult",value:function(e){var t=!0===e.success?null:e.error||{code:void 0,description:void 0};return{objectId:e.objectId,globalId:e.globalId,error:t?new x.a("feature-layer-source:edit-failure",t.description,{code:t.code}):null}}},{key:"_prepareAddFeatures",value:function(e){for(var t=new Map,r=new Array(e.length),n=null,i=0;i<e.length;i++){var a=e[i],o=this._serializeFeature(a);!n&&Object(M.j)(a.geometry)&&(n=a.geometry.type),r[i]=o,t.set("".concat(o.uid),a)}var s=this;return{features:r,inferredGeometryType:n,finish:function(e){var r=s.sourceJSON.objectIdField;for(var n in e){var i=e[n],a=t.get(n);a&&(a.attributes||(a.attributes={}),-1===i?delete a.attributes[r]:a.attributes[r]=i,s._addIdToClientGraphic(a))}}}}},{key:"_addIdToClientGraphic",value:function(e){if(this._idToClientGraphic){var t=this.sourceJSON.objectIdField,r=e.attributes&&e.attributes[t];null!=r&&this._idToClientGraphic.set(r,e)}}},{key:"layerOrSourceGeometryType",get:function(){var e,t,r;return null!=(e=null==(t=this.layer)?void 0:t.geometryType)?e:null==(r=this.sourceJSON)?void 0:r.geometryType}},{key:"_requiresClientGraphicMapping",value:function(){return this._geometryTypeRequiresClientGraphicMapping(this.layerOrSourceGeometryType)}},{key:"_geometryRequiresClientGraphicMapping",value:function(e){return this._geometryTypeRequiresClientGraphicMapping(e.type)}},{key:"_geometryTypeRequiresClientGraphicMapping",value:function(e){return"mesh"===e||"multipatch"===e||"extent"===e}},{key:"_serializeFeature",value:function(e){var t=e.attributes,r=this._geometryForSerialization(e),n=(at++).toString();return r?{uid:n,geometry:r.toJSON(),attributes:t}:{uid:n,attributes:t}}},{key:"_geometryForSerialization",value:function(e){var t=e.geometry;return Object(M.i)(t)?null:this._geometryRequiresClientGraphicMapping(t)?t.extent?nt.a.fromExtent(t.extent):null:t}},{key:"_startWorker",value:function(){var e=Object(s.a)(o.a.mark((function e(t){var r,n,a,s,c,l,u,d,h,f,p,b,v,m,y;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(Je.b)("MemorySourceWorker",{strategy:Object(S.a)("feature-layers-workers")?"dedicated":"local",signal:t});case 2:return this._connection=e.sent,r=this.layer,n=r.fields,a=r.spatialReference,s=r.objectIdField,c=r.hasM,l=r.hasZ,u=r.timeInfo,d="defaults"===this.layer.originOf("spatialReference"),e.next=6,this._prepareClientMapping(this.items,t);case 6:return h=this._prepareAddFeatures(this.items),this.on("before-changes",(function(e){ot.error("Source modifications will not propagate after layer has been loaded. Please use .applyEdits() instead"),e.preventDefault()})),f={features:h.features,fields:n&&n.map((function(e){return e.toJSON()})),geometryType:it.c.toJSON(this.workerGeometryType),hasM:"mesh"!==this.layerOrSourceGeometryType&&c,hasZ:"mesh"===this.layerOrSourceGeometryType||l,objectIdField:s,spatialReference:d?null:a&&a.toJSON(),timeInfo:u?u.toJSON():null},e.next=11,this._connection.invoke("load",f,{signal:t});case 11:p=e.sent,b=Object(i.a)(p.warnings);try{for(b.s();!(v=b.n()).done;)m=v.value,ot.warn(m.message,{layer:this.layer,warning:m})}catch(o){b.e(o)}finally{b.f()}p.featureErrors.length&&ot.warn("Encountered ".concat(p.featureErrors.length," validation errors while loading features"),p.featureErrors),y=p.layerDefinition,this._geometryTypeRequiresClientGraphicMapping(h.inferredGeometryType)&&(y.geometryType=it.c.toJSON(h.inferredGeometryType)),this.sourceJSON=y,this._requiresClientGraphicMapping()&&(this._idToClientGraphic=new Map),h.finish(p.assignedObjectIds);case 17:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),r}(Ye.a.LoadableMixin(Object($e.b)(w.a)));Object(b.a)([(Ke={Type:Xe.a,ensureType:Object(B.m)(Xe.a)},function(e,t){e[t]=Ke})],st.prototype,"itemType",void 0),Object(b.a)([Object(I.b)()],st.prototype,"type",void 0),Object(b.a)([Object(I.b)({constructOnly:!0})],st.prototype,"layer",void 0),Object(b.a)([Object(I.b)({readOnly:!0})],st.prototype,"workerGeometryType",null),Object(b.a)([Object(I.b)()],st.prototype,"sourceJSON",void 0);var ct,lt=st=Object(b.a)([Object(L.a)("esri.layers.graphics.sources.MemorySource")],st),ut=r(584),dt=r(579),ht=r(573),ft=r(589),pt=r(569),bt=r(568),vt=r(575),mt=r(570),yt=r(590),gt=r(255),Ot=r(188),jt=ct=function(e){Object(f.a)(r,e);var t=Object(p.a)(r);function r(e){return Object(l.a)(this,r),t.call(this,e)}return Object(u.a)(r,[{key:"clone",value:function(){var e=this.name,t=this.fields,r=this.isAscending,n=this.isUnique,i=this.description;return new ct({name:e,fields:t,isAscending:r,isUnique:n,description:i})}}]),r}(N.a);Object(b.a)([Object(I.b)({constructOnly:!0})],jt.prototype,"name",void 0),Object(b.a)([Object(I.b)({constructOnly:!0})],jt.prototype,"fields",void 0),Object(b.a)([Object(I.b)({constructOnly:!0})],jt.prototype,"isAscending",void 0),Object(b.a)([Object(I.b)({constructOnly:!0})],jt.prototype,"isUnique",void 0),Object(b.a)([Object(I.b)({constructOnly:!0})],jt.prototype,"description",void 0);jt=ct=Object(b.a)([Object(L.a)("esri.layers.support.FeatureIndex")],jt);var _t=r(375),wt=r(480),xt=r(422),kt=r(489),St=r(436),Tt=r(552),Ct=r(581),Mt=r(103),Pt=r(69),At=function(e){Object(f.a)(r,e);var t=Object(p.a)(r);function r(e){var n;return Object(l.a)(this,r),(n=t.call(this,e)).shapeAreaField=null,n.shapeLengthField=null,n.units=null,n}return r}(N.a);Object(b.a)([Object(I.b)({type:String,json:{read:{source:"shapeAreaFieldName"}}})],At.prototype,"shapeAreaField",void 0),Object(b.a)([Object(I.b)({type:String,json:{read:{source:"shapeLengthFieldName"}}})],At.prototype,"shapeLengthField",void 0),Object(b.a)([Object(I.b)({type:String,json:{read:function(e){return Pt.a.read(e)||Pt.m.read(e)}}})],At.prototype,"units",void 0);var Et=At=Object(b.a)([Object(L.a)("esri.layers.support.GeometryFieldsInfo")],At),Rt=r(373),It=r(548),Dt=r(648),Ft=new T.a({esriRelCardinalityOneToOne:"one-to-one",esriRelCardinalityOneToMany:"one-to-many",esriRelCardinalityManyToMany:"many-to-many"}),Lt=new T.a({esriRelRoleOrigin:"origin",esriRelRoleDestination:"destination"}),zt=function(e){Object(f.a)(r,e);var t=Object(p.a)(r);function r(e){var n;return Object(l.a)(this,r),(n=t.call(this,e)).cardinality=null,n.composite=null,n.id=null,n.keyField=null,n.keyFieldInRelationshipTable=null,n.name=null,n.relatedTableId=null,n.relationshipTableId=null,n.role=null,n}return r}(N.a);Object(b.a)([Object(I.b)({json:{read:Ft.read,write:Ft.write}})],zt.prototype,"cardinality",void 0),Object(b.a)([Object(I.b)({json:{read:!0,write:!0}})],zt.prototype,"composite",void 0),Object(b.a)([Object(I.b)({json:{read:!0,write:!0}})],zt.prototype,"id",void 0),Object(b.a)([Object(I.b)({json:{read:!0,write:!0}})],zt.prototype,"keyField",void 0),Object(b.a)([Object(I.b)({json:{read:!0,write:!0}})],zt.prototype,"keyFieldInRelationshipTable",void 0),Object(b.a)([Object(I.b)({json:{read:!0,write:!0}})],zt.prototype,"name",void 0),Object(b.a)([Object(I.b)({json:{read:!0,write:!0}})],zt.prototype,"relatedTableId",void 0),Object(b.a)([Object(I.b)({json:{read:!0,write:!0}})],zt.prototype,"relationshipTableId",void 0),Object(b.a)([Object(I.b)({json:{read:Lt.read,write:Lt.write}})],zt.prototype,"role",void 0);var Vt=zt=Object(b.a)([Object(L.a)("esri.layers.support.Relationship")],zt),Nt=r(496),Ut=r(305),Bt=r(594),Gt=r(357),qt=r(152),Ht=r(265),Wt=r(213),Qt=r(578),Zt=new T.a({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon",esriGeometryMultiPatch:"multipatch"}),Xt={name:"supportsName",size:"supportsSize",contentType:"supportsContentType",keywords:"supportsKeywords",exifInfo:"supportsExifInfo"},Yt="FeatureLayer",$t=C.a.getLogger("esri.layers.FeatureLayer");function Jt(e){return e&&e instanceof w.a}function Kt(e,t,r){return!!(e&&e.hasOwnProperty(t)?e[t]:r)}function er(e,t,r){return e&&e.hasOwnProperty(t)?e[t]:r}var tr=Object(Ct.a)();function rr(e,t,r){var n=!(null==r||!r.writeLayerSchema);return{enabled:n,ignoreOrigin:n}}var nr=function(e){Object(f.a)(n,e);var t=Object(p.a)(n);function n(){var e;Object(l.a)(this,n);for(var r=arguments.length,i=new Array(r),a=0;a<r;a++)i[a]=arguments[a];return(e=t.call.apply(t,[this].concat(i)))._handles=new k.a,e.capabilities=null,e.charts=null,e.copyright=null,e.displayField=null,e.definitionExpression=null,e.dynamicDataSource=null,e.editFieldsInfo=null,e.editingInfo=null,e.elevationInfo=null,e.featureReduction=null,e.fields=null,e.fieldsIndex=null,e.floorInfo=null,e.formTemplate=null,e.fullExtent=null,e.gdbVersion=null,e.geometryFieldsInfo=null,e.geometryType=null,e.hasM=void 0,e.hasZ=void 0,e.heightModelInfo=null,e.historicMoment=null,e.infoFor3D=null,e.isTable=!1,e.labelsVisible=!0,e.labelingInfo=null,e.layerId=void 0,e.legendEnabled=!0,e.minScale=0,e.maxScale=0,e.globalIdField=null,e.objectIdField=null,e.outFields=null,e.path=null,e.popupEnabled=!0,e.popupTemplate=null,e.relationships=null,e.sourceJSON=null,e.returnM=void 0,e.returnZ=void 0,e.screenSizePerspectiveEnabled=!0,e.serviceDefinitionExpression=null,e.spatialReference=Qe.a.WGS84,e.subtypeCode=null,e.templates=null,e.timeInfo=null,e.title=null,e.sublayerTitleMode="item-title",e.trackIdField=null,e.type="feature",e.typeIdField=null,e.types=null,e.indexes=new(w.a.ofType(jt)),e.userIsAdmin=!1,e.version=void 0,e.visible=!0,e}return Object(u.a)(n,[{key:"destroy",value:function(){var e;null==(e=this.source)||e.destroy(),this._handles=Object(M.e)(this._handles)}},{key:"normalizeCtorArgs",value:function(e,t){return"string"==typeof e?Object(c.a)({url:e},t):e}},{key:"load",value:function(e){var t=this,r=Object(M.j)(e)?e.signal:null;if(!(this.portalItem&&this.portalItem.loaded&&this.source)){var n=this.loadFromPortal({supportedTypes:["Feature Service","Feature Collection"]},e).catch(E.w).then(Object(s.a)(o.a.mark((function e(){var n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.url||null!=t.layerId||!/FeatureServer|MapServer\/*$/i.test(t.url)){e.next=5;break}return e.next=3,t._fetchFirstLayerId(r);case 3:null!=(n=e.sent)&&(t.layerId=n);case 5:if(t.url||t._hasMemorySource()){e.next=7;break}throw new x.a("feature-layer:missing-url-or-source","Feature layer must be created with either a url or a source");case 7:return e.t0=t,e.next=10,t.createGraphicsSource(r);case 10:return e.t1=e.sent,e.abrupt("return",e.t0._initLayerProperties.call(e.t0,e.t1));case 12:case"end":return e.stop()}}),e)})))).then((function(){return t.finishLoadEditablePortalLayer(e)}));return this.addResolvingPromise(n),Promise.resolve(this)}this.addResolvingPromise(this.createGraphicsSource(r).then((function(e){return t._initLayerProperties(e)})))}},{key:"readCapabilities",value:function(e,t){return t=t.layerDefinition||t,{attachment:this._readAttachmentCapabilities(t.attachmentProperties),data:this._readDataCapabilities(t),metadata:this._readMetadataCapabilities(t),operations:this._readOperationsCapabilities(t.capabilities||e,t),query:this._readQueryCapabilities(t),queryRelated:this._readQueryRelatedCapabilities(t),editing:this._readEditingCapabilities(t)}}},{key:"createQueryVersion",get:function(){return this.commitProperty("definitionExpression"),this.commitProperty("dynamicDataSource"),this.commitProperty("timeExtent"),this.commitProperty("timeOffset"),this.commitProperty("geometryType"),this.commitProperty("gdbVersion"),this.commitProperty("historicMoment"),this.commitProperty("returnZ"),this.commitProperty("capabilities"),this.commitProperty("returnM"),(this._get("createQueryVersion")||0)+1}},{key:"editingEnabled",get:function(){return this._isOverridden("editingEnabled")?this._get("editingEnabled"):this._hasMemorySource()||this.userHasEditingPrivileges},set:function(e){null!=e?this._override("editingEnabled",e):this._clearOverride("editingEnabled")}},{key:"readEditingEnabled",value:function(e,t){return this._readEditingEnabled(t,!1)}},{key:"readEditingEnabledFromWebMap",value:function(e,t,r){return this._readEditingEnabled(t,!0,r)}},{key:"writeEditingEnabled",value:function(e,t){this._writeEditingEnabled(e,t,!1)}},{key:"writeEditingEnabledToWebMap",value:function(e,t,r,n){this._writeEditingEnabled(e,t,!0,n)}},{key:"readEditingInfo",value:function(e,t){var r=t.editingInfo;return r?{lastEditDate:null!=r.lastEditDate?new Date(r.lastEditDate):null}:null}},{key:"readFeatureReduction",value:function(e,t){return Object(kt.a)(e,t)}},{key:"writeWebSceneFeatureReduction",value:function(e,t,r,n){Object(kt.c)(e,t,"layerDefinition.featureReduction",n)}},{key:"readIsTable",value:function(e,t){return"Table"===(t=t&&t.layerDefinition||t).type||!t.geometryType}},{key:"writeIsTable",value:function(e,t,r,n){null!=n&&n.writeLayerSchema&&Object(A.c)(r,e?"Table":"Feature Layer",t)}},{key:"readMinScale",value:function(e,t){return t.effectiveMinScale||e||0}},{key:"readMaxScale",value:function(e,t){return t.effectiveMaxScale||e||0}},{key:"readGlobalIdFieldFromService",value:function(e,t){if((t=t.layerDefinition||t).globalIdField)return t.globalIdField;if(t.fields){var r,n=Object(i.a)(t.fields);try{for(n.s();!(r=n.n()).done;){var a=r.value;if("esriFieldTypeGlobalID"===a.type)return a.name}}catch(o){n.e(o)}finally{n.f()}}}},{key:"readObjectIdFieldFromService",value:function(e,t){if((t=t.layerDefinition||t).objectIdField)return t.objectIdField;if(t.fields){var r,n=Object(i.a)(t.fields);try{for(n.s();!(r=n.n()).done;){var a=r.value;if("esriFieldTypeOID"===a.type)return a.name}}catch(o){n.e(o)}finally{n.f()}}}},{key:"parsedUrl",get:function(){var e=this.url?Object(R.K)(this.url):null;return null!=e&&(null!=this.dynamicDataSource?e.path=Object(R.z)(e.path,"dynamicLayer"):null!=this.layerId&&(e.path=Object(R.z)(e.path,this.layerId.toString()))),e}},{key:"defaultPopupTemplate",get:function(){return this.createPopupTemplate()}},{key:"renderer",set:function(e){Object(Mt.j)(e,this.fieldsIndex),this._set("renderer",e)}},{key:"readRenderer",value:function(e,t,r){var n=(t=t.layerDefinition||t).drawingInfo&&t.drawingInfo.renderer||void 0;if(n){var i=Object(g.b)(n,t,r)||void 0;return i||$t.error("Failed to create renderer",{rendererDefinition:t.drawingInfo.renderer,layer:this,context:r}),i}if(t.defaultSymbol)return t.types&&t.types.length?new y.a({defaultSymbol:ir(t.defaultSymbol,t,r),field:t.typeIdField,uniqueValueInfos:t.types.map((function(e){return{id:e.id,symbol:ir(e.symbol,e,r)}}))}):new m.a({symbol:ir(t.defaultSymbol,t,r)})}},{key:"source",set:function(e){var t=this._get("source");t!==e&&(Jt(t)&&this._resetMemorySource(t),Jt(e)&&this._initMemorySource(e),this._set("source",e))}},{key:"castSource",value:function(e){return e?Array.isArray(e)||e instanceof w.a?new lt({layer:this,items:e}):e:null}},{key:"readSource",value:function(e,t){var r=rt.default.fromJSON(t.featureSet);return new lt({layer:this,items:r&&r.features||[]})}},{key:"readServiceDefinitionExpression",value:function(e,t){return t.definitionQuery||t.definitionExpression}},{key:"readTemplates",value:function(e,t){var r=t.editFieldsInfo,n=r&&r.creatorField,i=r&&r.editorField;return e=e&&e.map((function(e){return St.a.fromJSON(e)})),this._fixTemplates(e,n),this._fixTemplates(e,i),e}},{key:"readTitle",value:function(e,t){var r=t.layerDefinition&&t.layerDefinition.name||t.name,n=t.title||t.layerDefinition&&t.layerDefinition.title;if(r){var i=this.portalItem&&this.portalItem.title;if("item-title"===this.sublayerTitleMode)return this.url?Object(gt.i)(this.url,r):r;var a=r;if(!a&&this.url){var o=Object(gt.e)(this.url);Object(M.j)(o)&&(a=o.title)}if(!a)return;return"item-title-and-service-name"===this.sublayerTitleMode&&i&&i!==a&&(a=i+" - "+a),Object(gt.a)(a)}if("item-title"===this.sublayerTitleMode&&n)return n}},{key:"readTitleFromWebMap",value:function(e,t){return t.title||t.layerDefinition&&t.layerDefinition.name}},{key:"readTypeIdField",value:function(e,t){var r=(t=t.layerDefinition||t).typeIdField;if(r&&t.fields){r=r.toLowerCase();var n=t.fields.find((function(e){return e.name.toLowerCase()===r}));n&&(r=n.name)}return r}},{key:"readTypes",value:function(e,t){var r=this;e=(t=t.layerDefinition||t).types;var n=t.editFieldsInfo,i=n&&n.creatorField,a=n&&n.editorField;return e&&e.map((function(e){return e=Tt.a.fromJSON(e),r._fixTemplates(e.templates,i),r._fixTemplates(e.templates,a),e}))}},{key:"url",set:function(e){var t=Object(gt.h)({layer:this,url:e,nonStandardUrlAllowed:!0,logger:$t});this._set("url",t.url),null!=t.layerId&&this._set("layerId",t.layerId)}},{key:"writeUrl",value:function(e,t,r,n){Object(gt.j)(this,e,null,t,n)}},{key:"readVersion",value:function(e,t){return t.currentVersion?t.currentVersion:t.hasOwnProperty("capabilities")||t.hasOwnProperty("drawingInfo")||t.hasOwnProperty("hasAttachments")||t.hasOwnProperty("htmlPopupType")||t.hasOwnProperty("relationships")||t.hasOwnProperty("timeInfo")||t.hasOwnProperty("typeIdField")||t.hasOwnProperty("types")?10:9.3}},{key:"readVisible",value:function(e,t){return t.layerDefinition&&null!=t.layerDefinition.defaultVisibility?!!t.layerDefinition.defaultVisibility:null!=t.visibility?!!t.visibility:void 0}},{key:"addAttachment",value:function(e,t){var r=this;return this.load().then((function(){return r._checkAttachmentSupport(e)})).then((function(){if(!("addAttachment"in r.source))throw new x.a(Yt,"Layer source does not support addAttachment capability");return r.source.addAttachment(e,t)}))}},{key:"updateAttachment",value:function(e,t,r){var n=this;return this.load().then((function(){return n._checkAttachmentSupport(e)})).then((function(){if(!("updateAttachment"in n.source))throw new x.a(Yt,"Layer source does not support updateAttachment capability");return n.source.updateAttachment(e,t,r)}))}},{key:"applyEdits",value:function(){var e=Object(s.a)(o.a.mark((function e(t,n){var i;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.e(41).then(r.bind(null,1041));case 2:return i=e.sent,e.next=5,this.load();case 5:return e.abrupt("return",i.applyEdits(this,this.source,t,n));case 6:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"on",value:function(e,t){return Object(d.a)(Object(h.a)(n.prototype),"on",this).call(this,e,t)}},{key:"createPopupTemplate",value:function(e){return Object(Qt.a)(this,e)}},{key:"createGraphicsSource",value:function(){var e=Object(s.a)(o.a.mark((function e(t){var n,i;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._hasMemorySource()){e.next=2;break}return e.abrupt("return",this.source.load({signal:t}));case 2:return e.next=4,Object(E.A)(r.e(83).then(r.bind(null,1042)),t);case 4:return n=e.sent,i=n.default,e.abrupt("return",new i({layer:this}).load({signal:t}));case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"createQuery",value:function(){var e=new qt.a,t=this.get("capabilities.data");e.dynamicDataSource=this.dynamicDataSource,e.gdbVersion=this.gdbVersion,e.historicMoment=this.historicMoment,e.returnGeometry=!0,t&&(t.supportsZ&&null!=this.returnZ&&(e.returnZ=this.returnZ),t.supportsM&&null!=this.returnM&&(e.returnM=this.returnM)),e.outFields=["*"],e.where=this.definitionExpression||"1=1";var r=this.timeOffset,n=this.timeExtent;return e.timeExtent=null!=r&&null!=n?n.offset(-r.value,r.unit):n||null,e.multipatchOption="multipatch"===this.geometryType?"xyFootprint":null,e}},{key:"deleteAttachments",value:function(e,t){var r=this;return this.load().then((function(){return r._checkAttachmentSupport(e)})).then((function(){if(!("deleteAttachments"in r.source))throw new x.a(Yt,"Layer source does not support deleteAttachments capability");return r.source.deleteAttachments(e,t)}))}},{key:"fetchRecomputedExtents",value:function(e){var t=this;return this.load({signal:null==e?void 0:e.signal}).then((function(){if(t.source.fetchRecomputedExtents)return t.source.fetchRecomputedExtents(e);throw new x.a(Yt,"Layer source does not support fetchUpdates capability")}))}},{key:"getFeatureType",value:function(e){var t=this.typeIdField,r=this.types;if(!t||!e)return null;var n=e.attributes?e.attributes[t]:void 0;if(null==n)return null;var i=null;return r.some((function(e){var t=e.id;return null!=t&&(t.toString()===n.toString()&&(i=e),!!i)})),i}},{key:"getFieldDomain",value:function(e,t){var r=t&&t.feature,n=this.getFeatureType(r);if(n){var i=n.domains&&n.domains[e];if(i&&"inherited"!==i.type)return i}return this._getLayerDomain(e)}},{key:"getField",value:function(e){return this.fieldsIndex.get(e)}},{key:"queryAttachments",value:function(e,t){var r=this;return e=Gt.a.from(e),this.load().then((function(){if(!r.get("capabilities.data.supportsAttachment"))throw new x.a(Yt,"this layer doesn't support attachments");var t=e,n=t.attachmentTypes,i=t.objectIds,a=t.globalIds,o=t.num,s=t.size,c=t.start,l=t.where;if(!r.get("capabilities.operations.supportsQueryAttachments")){var u=i&&i.length>1,d=n&&n.length,h=a&&a.length,f=s&&s.length;if(u||d||h||f||o||c||l)throw new x.a(Yt,"when 'supportsQueryAttachments' is false, only objectIds of length 1 are supported",e)}if(!(i&&i.length||l))throw new x.a(Yt,"'objectIds' or 'where' are required to perform attachment query",e);if(!("queryAttachments"in r.source))throw new x.a(Yt,"Layer source does not support queryAttachments capability",e);return r.source.queryAttachments(e)}))}},{key:"queryFeatures",value:function(e,t){var r=this;return this.load().then((function(){return r.source.queryFeatures(qt.a.from(e)||r.createQuery(),t)})).then((function(e){if(null!=e&&e.features){var t,n=Object(i.a)(e.features);try{for(n.s();!(t=n.n()).done;){var a=t.value;a.layer=a.sourceLayer=r}}catch(o){n.e(o)}finally{n.f()}}return e}))}},{key:"queryObjectIds",value:function(e,t){var r=this;return this.load().then((function(){if(r.source.queryObjectIds)return r.source.queryObjectIds(qt.a.from(e)||r.createQuery(),t);throw new x.a(Yt,"Layer source does not support queryObjectIds capability")}))}},{key:"queryFeatureCount",value:function(e,t){var r=this;return this.load().then((function(){if(r.source.queryFeatureCount)return r.source.queryFeatureCount(qt.a.from(e)||r.createQuery(),t);throw new x.a(Yt,"Layer source does not support queryFeatureCount capability")}))}},{key:"queryExtent",value:function(e,t){var r=this;return this.load().then((function(){if(r.source.queryExtent)return r.source.queryExtent(qt.a.from(e)||r.createQuery(),t);throw new x.a(Yt,"Layer source does not support queryExtent capability")}))}},{key:"queryRelatedFeatures",value:function(e,t){var r=this;return this.load().then((function(){if("queryRelatedFeatures"in r.source)return r.source.queryRelatedFeatures(Ht.a.from(e),t);throw new x.a(Yt,"Layer source does not support queryRelatedFeatures capability")}))}},{key:"queryRelatedFeaturesCount",value:function(e,t){var r=this;return this.load().then((function(){if("queryRelatedFeaturesCount"in r.source)return r.source.queryRelatedFeaturesCount(Ht.a.from(e),t);throw new x.a(Yt,"Layer source does not support queryRelatedFeaturesCount capability")}))}},{key:"queryTopFeatures",value:function(e,t){var r=this;return this.load().then((function(){if("queryTopFeatures"in r.source&&r.get("capabilities.query.supportsTopFeaturesQuery"))return r.source.queryTopFeatures(Wt.a.from(e),t).then((function(e){if(null!=e&&e.features){var t,n=Object(i.a)(e.features);try{for(n.s();!(t=n.n()).done;){var a=t.value;a.layer=a.sourceLayer=r}}catch(o){n.e(o)}finally{n.f()}}return e}));throw new x.a(Yt,"Layer source does not support queryTopFeatures capability")}))}},{key:"queryTopObjectIds",value:function(e,t){var r=this;return this.load().then((function(){if("queryTopObjectIds"in r.source&&r.get("capabilities.query.supportsTopFeaturesQuery"))return r.source.queryTopObjectIds(Wt.a.from(e),t);throw new x.a(Yt,"Layer source does not support queryTopObjectIds capability")}))}},{key:"queryTopFeaturesExtent",value:function(e,t){var r=this;return this.load().then((function(){if("queryTopExtents"in r.source&&r.get("capabilities.query.supportsTopFeaturesQuery"))return r.source.queryTopExtents(Wt.a.from(e),t);throw new x.a(Yt,"Layer source does not support queryTopExtents capability")}))}},{key:"queryTopFeatureCount",value:function(e,t){var r=this;return this.load().then((function(){if("queryTopCount"in r.source&&r.get("capabilities.query.supportsTopFeaturesQuery"))return r.source.queryTopCount(Wt.a.from(e),t);throw new x.a(Yt,"Layer source does not support queryFeatureCount capability")}))}},{key:"read",value:function(e,t){var r=e.featureCollection;if(r){var i=r.layers;i&&1===i.length&&(Object(d.a)(Object(h.a)(n.prototype),"read",this).call(this,i[0],t),null!=r.showLegend&&Object(d.a)(Object(h.a)(n.prototype),"read",this).call(this,{showLegend:r.showLegend},t))}Object(d.a)(Object(h.a)(n.prototype),"read",this).call(this,e,t),t&&"service"===t.origin&&this.revert(["objectIdField","fields","timeInfo","spatialReference"],"service")}},{key:"write",value:function(e,t){var r,i,a=(t=Object(c.a)(Object(c.a)({},t),{},{writeLayerSchema:null!=(r=null==(i=t)?void 0:i.writeLayerSchema)?r:this._hasMemorySource()})).origin,o=t.layerContainerType,s=t.messages;if(this.isTable){if("web-scene"===a||"web-map"===a&&"tables"!==o)return s&&s.push(new x.a("layer:unsupported","Layer (".concat(this.title,", ").concat(this.id,") of type '").concat(this.declaredClass,"' using a Table source cannot be written to web scenes and web maps"),{layer:this})),null;if(this._hasMemorySource())return s&&s.push(new x.a("layer:unsupported","Layer (".concat(this.title,", ").concat(this.id,") of type '").concat(this.declaredClass,"' using an in-memory Table source cannot be written to web scenes and web maps"),{layer:this})),null}else if(this.loaded&&"web-map"===a&&"tables"===o)return s&&s.push(new x.a("layer:unsupported","Layer (".concat(this.title,", ").concat(this.id,") of type '").concat(this.declaredClass,"' using a non-table source cannot be written to tables in web maps"),{layer:this})),null;return Object(d.a)(Object(h.a)(n.prototype),"write",this).call(this,e,t)}},{key:"_readEditingEnabled",value:function(e,t,r){var n,i=null==(n=e.layerDefinition)?void 0:n.capabilities;return i?this._hasEditingCapability(i):(i=e.capabilities,t&&"web-map"===(null==r?void 0:r.origin)&&!this._hasMemorySource()&&i?this._hasEditingCapability(i):void 0)}},{key:"_hasEditingCapability",value:function(e){return e.toLowerCase().split(",").map((function(e){return e.trim()})).includes("editing")}},{key:"_writeEditingEnabled",value:function(e,t,r,n){if(!e){var i,a,o=null!=(i=this.capabilities)&&null!=(a=i.operations)&&a.supportsSync?"Query,Sync":"Query";Object(A.c)("layerDefinition.capabilities",o,t),!r||null!=n&&n.writeLayerSchema||(t.capabilities=o)}}},{key:"_checkAttachmentSupport",value:function(e){var t=e.attributes,r=this.objectIdField;return this.get("capabilities.data.supportsAttachment")?e?t?t[r]?void 0:Promise.reject(new x.a(Yt,"feature is missing the identifying attribute ".concat(r))):Promise.reject(new x.a(Yt,"'attributes' are required on a feature to query attachments")):Promise.reject(new x.a(Yt,"A feature is required to add/delete/update attachments")):Promise.reject(new x.a(Yt,"this layer doesn't support attachments"))}},{key:"_getLayerDomain",value:function(e){var t=this.fieldsIndex.get(e);return t?t.domain:null}},{key:"_fetchFirstLayerId",value:function(e){return Object(j.default)(this.url,{query:Object(c.a)(Object(c.a)({f:"json"},this.customParameters),{},{token:this.apiKey}),responseType:"json",signal:e}).then((function(e){var t=e.data;if(t)return Array.isArray(t.layers)&&t.layers.length>0?t.layers[0].id:Array.isArray(t.tables)&&t.tables.length>0?t.tables[0].id:void 0}))}},{key:"_initLayerProperties",value:function(){var e=Object(s.a)(o.a.mark((function e(t){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(this._set("source",t),t.sourceJSON&&(this.sourceJSON=t.sourceJSON,this.read(t.sourceJSON,{origin:"service",url:this.parsedUrl})),this._verifySource(),this._verifyFields(),Object(Mt.j)(this.renderer,this.fieldsIndex),Object(Mt.k)(this.timeInfo,this.fieldsIndex),Object(Bt.a)(this,{origin:"service"})));case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_verifyFields",value:function(){var e=this.parsedUrl&&this.parsedUrl.path||"undefined";this.objectIdField||console.log("FeatureLayer: 'objectIdField' property is not defined (url: "+e+")"),this.isTable||this._hasMemorySource()||-1!==e.search(/\/FeatureServer\//i)||this.fields&&this.fields.some((function(e){return"geometry"===e.type}))||console.log("FeatureLayer: unable to find field of type 'geometry' in the layer 'fields' list. If you are using a map service layer, features will not have geometry (url: "+e+")")}},{key:"_fixTemplates",value:function(e,t){e&&e.forEach((function(e){var r=e.prototype&&e.prototype.attributes;r&&t&&delete r[t]}))}},{key:"_verifySource",value:function(){if(this._hasMemorySource()){if(this.url)throw new x.a("feature-layer:mixed-source-and-url","FeatureLayer cannot be created with both an in-memory source and a url")}else if(!this.url)throw new x.a("feature-layer:source-or-url-required","FeatureLayer requires either a url, a valid portal item or a source")}},{key:"_initMemorySource",value:function(e){var t=this;e.forEach((function(e){e.layer=t,e.sourceLayer=t})),this._handles.add([e.on("after-add",(function(e){e.item.layer=t,e.item.sourceLayer=t})),e.on("after-remove",(function(e){e.item.layer=null,e.item.sourceLayer=null}))],"fl-source")}},{key:"_resetMemorySource",value:function(e){e.forEach((function(e){e.layer=null,e.sourceLayer=null})),this._handles.remove("fl-source")}},{key:"_hasMemorySource",value:function(){return!(this.url||!this.source)}},{key:"_readAttachmentCapabilities",value:function(e){var t={supportsName:!1,supportsSize:!1,supportsContentType:!1,supportsKeywords:!1,supportsExifInfo:!1};return e&&Array.isArray(e)&&e.forEach((function(e){var r=Xt[e.name];r&&(t[r]=!!e.isEnabled)})),t}},{key:"_readDataCapabilities",value:function(e){return{isVersioned:Kt(e,"isDataVersioned",!1),supportsAttachment:Kt(e,"hasAttachments",!1),supportsM:Kt(e,"hasM",!1),supportsZ:Kt(e,"hasZ",!1)}}},{key:"_readMetadataCapabilities",value:function(e){return{supportsAdvancedFieldProperties:Kt(e,"supportsFieldDescriptionProperty",!1)}}},{key:"_readOperationsCapabilities",value:function(e,t){var r=e?e.toLowerCase().split(",").map((function(e){return e.trim()})):[],n=-1!==r.indexOf("editing"),i=n&&-1!==r.indexOf("create"),a=n&&-1!==r.indexOf("delete"),o=n&&-1!==r.indexOf("update"),s=-1!==r.indexOf("changetracking");return n&&!(i||a||o)&&(i=a=o=!0),{supportsCalculate:Kt(t,"supportsCalculate",!1),supportsTruncate:Kt(t,"supportsTruncate",!1),supportsValidateSql:Kt(t,"supportsValidateSql",!1),supportsAdd:i,supportsDelete:a,supportsEditing:n,supportsChangeTracking:s,supportsQuery:-1!==r.indexOf("query"),supportsQueryAttachments:Kt(t.advancedQueryCapabilities,"supportsQueryAttachments",!1),supportsResizeAttachments:Kt(t,"supportsAttachmentsResizing",!1),supportsSync:-1!==r.indexOf("sync"),supportsUpdate:o,supportsExceedsLimitStatistics:Kt(t,"supportsExceedsLimitStatistics",!1)}}},{key:"_readQueryCapabilities",value:function(e){var t,r=e.advancedQueryCapabilities,n=e.ownershipBasedAccessControlForFeatures,i=e.archivingInfo,a=null==(t=this.url)?void 0:t.includes("MapServer"),o=!Object(S.a)("mapserver-pbf-enabled")&&a&&this.version<10.81,s=(e.supportedQueryFormats||"").split(",").reduce((function(e,t){var r=t.toLowerCase().trim();return r&&e.add(r),e}),new Set);return{supportsStatistics:Kt(r,"supportsStatistics",e.supportsStatistics),supportsPercentileStatistics:Kt(r,"supportsPercentileStatistics",!1),supportsCentroid:Kt(r,"supportsReturningGeometryCentroid",!1),supportsDistance:Kt(r,"supportsQueryWithDistance",!1),supportsDistinct:Kt(r,"supportsDistinct",e.supportsAdvancedQueries),supportsExtent:Kt(r,"supportsReturningQueryExtent",!1),supportsGeometryProperties:Kt(r,"supportsReturningGeometryProperties",!1),supportsHavingClause:Kt(r,"supportsHavingClause",!1),supportsOrderBy:Kt(r,"supportsOrderBy",e.supportsAdvancedQueries),supportsPagination:Kt(r,"supportsPagination",!1),supportsQuantization:Kt(e,"supportsCoordinatesQuantization",!1),supportsQuantizationEditMode:Kt(e,"supportsQuantizationEditMode",!1),supportsQueryGeometry:Kt(e,"supportsReturningQueryGeometry",!1),supportsResultType:Kt(r,"supportsQueryWithResultType",!1),supportsMaxRecordCountFactor:Kt(r,"supportsMaxRecordCountFactor",!1),supportsSqlExpression:Kt(r,"supportsSqlExpression",!1),supportsStandardizedQueriesOnly:Kt(e,"useStandardizedQueries",!1),supportsTopFeaturesQuery:Kt(r,"supportsTopFeaturesQuery",!1),supportsQueryByOthers:Kt(n,"allowOthersToQuery",!0),supportsHistoricMoment:Kt(i,"supportsQueryWithHistoricMoment",!1),supportsFormatPBF:!o&&s.has("pbf"),supportsDisjointSpatialRelationship:Kt(r,"supportsDisjointSpatialRel",!1),supportsCacheHint:Kt(r,"supportsQueryWithCacheHint",!1),maxRecordCountFactor:er(e,"maxRecordCountFactor",void 0),maxRecordCount:er(e,"maxRecordCount",void 0),standardMaxRecordCount:er(e,"standardMaxRecordCount",void 0),tileMaxRecordCount:er(e,"tileMaxRecordCount",void 0)}}},{key:"_readQueryRelatedCapabilities",value:function(e){var t=e.advancedQueryCapabilities,r=Kt(t,"supportsAdvancedQueryRelated",!1);return{supportsPagination:Kt(t,"supportsQueryRelatedPagination",!1),supportsCount:r,supportsOrderBy:r}}},{key:"_readEditingCapabilities",value:function(e){var t=e.ownershipBasedAccessControlForFeatures;return{supportsGeometryUpdate:Kt(e,"allowGeometryUpdates",!0),supportsGlobalId:Kt(e,"supportsApplyEditsWithGlobalIds",!1),supportsReturnServiceEditsInSourceSpatialReference:Kt(e,"supportsReturnServiceEditsInSourceSR",!1),supportsRollbackOnFailure:Kt(e,"supportsRollbackOnFailureParameter",!1),supportsUpdateWithoutM:Kt(e,"allowUpdateWithoutMValues",!1),supportsUploadWithItemId:Kt(e,"supportsAttachmentsByUploadId",!1),supportsDeleteByAnonymous:Kt(t,"allowAnonymousToDelete",!0),supportsDeleteByOthers:Kt(t,"allowOthersToDelete",!0),supportsUpdateByAnonymous:Kt(t,"allowAnonymousToUpdate",!0),supportsUpdateByOthers:Kt(t,"allowOthersToUpdate",!0)}}}]),n}(Object(ht.a)(Object(yt.a)(Object(mt.a)(Object(vt.a)(Object(dt.a)(Object(pt.a)(Object(bt.a)(Object(P.a)(Object(ft.a)(Object(ut.a)(Ze.a)))))))))));Object(b.a)([Object(I.b)({readOnly:!0,json:{read:!1}})],nr.prototype,"capabilities",void 0),Object(b.a)([Object(F.a)("service","capabilities",["advancedQueryCapabilities","allowGeometryUpdates","allowUpdateWithoutMValues","archivingInfo","capabilities","hasAttachments","hasM","hasZ","maxRecordCount","maxRecordCountFactor","ownershipBasedAccessControlForFeatures","standardMaxRecordCount","supportedQueryFormats","supportsAdvancedQueries","supportsApplyEditsWithGlobalIds","supportsAttachmentsByUploadId","supportsAttachmentsResizing","supportsCalculate","supportsCoordinatesQuantization","supportsExceedsLimitStatistics","supportsFieldDescriptionProperty","supportsQuantizationEditMode","supportsRollbackOnFailureParameter","supportsStatistics","supportsTruncate","supportsValidateSql","tileMaxRecordCount","useStandardizedQueries"])],nr.prototype,"readCapabilities",null),Object(b.a)([Object(I.b)({json:{origins:{"portal-item":{write:!0},"web-map":{write:!0}}}})],nr.prototype,"charts",void 0),Object(b.a)([Object(I.b)({readOnly:!0})],nr.prototype,"createQueryVersion",null),Object(b.a)([Object(I.b)({type:String,json:{read:{source:"layerDefinition.copyrightText"},origins:{service:{read:{source:"copyrightText"}}}}})],nr.prototype,"copyright",void 0),Object(b.a)([Object(I.b)({type:String,json:{read:{source:"layerDefinition.displayField"},origins:{service:{read:{source:"displayField"}}}}})],nr.prototype,"displayField",void 0),Object(b.a)([Object(I.b)({type:String,json:{origins:{service:{read:!1,write:!1}},name:"layerDefinition.definitionExpression",write:{enabled:!0,allowNull:!0}}})],nr.prototype,"definitionExpression",void 0),Object(b.a)([Object(I.b)({types:_.e,readOnly:!0})],nr.prototype,"defaultSymbol",void 0),Object(b.a)([Object(I.b)({type:Ut.a})],nr.prototype,"dynamicDataSource",void 0),Object(b.a)([Object(I.b)({readOnly:!0})],nr.prototype,"editFieldsInfo",void 0),Object(b.a)([Object(I.b)({type:Boolean})],nr.prototype,"editingEnabled",null),Object(b.a)([Object(F.a)(["portal-item","web-scene"],"editingEnabled",["layerDefinition.capabilities"])],nr.prototype,"readEditingEnabled",null),Object(b.a)([Object(F.a)("web-map","editingEnabled",["capabilities","layerDefinition.capabilities"])],nr.prototype,"readEditingEnabledFromWebMap",null),Object(b.a)([Object(z.a)(["portal-item","web-scene"],"editingEnabled",{"layerDefinition.capabilities":{type:String}})],nr.prototype,"writeEditingEnabled",null),Object(b.a)([Object(z.a)("web-map","editingEnabled",{capabilities:{type:String},"layerDefinition.capabilities":{type:String}})],nr.prototype,"writeEditingEnabledToWebMap",null),Object(b.a)([Object(I.b)({readOnly:!0})],nr.prototype,"editingInfo",void 0),Object(b.a)([Object(F.a)("editingInfo")],nr.prototype,"readEditingInfo",null),Object(b.a)([Object(I.b)(Ot.b)],nr.prototype,"elevationInfo",void 0),Object(b.a)([Object(I.b)({types:{key:"type",base:_t.a,typeMap:{selection:xt.a,cluster:wt.a}},json:{write:{target:"layerDefinition.featureReduction"}}})],nr.prototype,"featureReduction",void 0),Object(b.a)([Object(F.a)("featureReduction",["layerDefinition.featureReduction"])],nr.prototype,"readFeatureReduction",null),Object(b.a)([Object(z.a)("web-scene","featureReduction",{"layerDefinition.featureReduction":{types:kt.b}})],nr.prototype,"writeWebSceneFeatureReduction",null),Object(b.a)([Object(I.b)(Object(c.a)(Object(c.a)({},tr.fields),{},{json:{read:{source:"layerDefinition.fields"},origins:{service:{read:!0},"web-map":{write:{target:"layerDefinition.fields",overridePolicy:rr}}}}}))],nr.prototype,"fields",void 0),Object(b.a)([Object(I.b)(tr.fieldsIndex)],nr.prototype,"fieldsIndex",void 0),Object(b.a)([Object(I.b)({type:Dt.a,json:{read:{source:"layerDefinition.floorInfo"},write:{target:"layerDefinition.floorInfo"}}})],nr.prototype,"floorInfo",void 0),Object(b.a)([Object(I.b)({type:qe,json:{name:"formInfo",write:!0,origins:{"web-scene":{read:!1,write:!1}}}})],nr.prototype,"formTemplate",void 0),Object(b.a)([Object(I.b)({type:He.a,json:{origins:{service:{read:{source:"extent"}}},read:{source:"layerDefinition.extent"}}})],nr.prototype,"fullExtent",void 0),Object(b.a)([Object(I.b)()],nr.prototype,"gdbVersion",void 0),Object(b.a)([Object(I.b)({readOnly:!0,type:Et,json:{read:{source:"geometryProperties"}}})],nr.prototype,"geometryFieldsInfo",void 0),Object(b.a)([Object(I.b)({type:["point","polygon","polyline","multipoint","multipatch","mesh"],json:{origins:{service:{read:Zt.read},"web-map":{write:{target:"layerDefinition.geometryType",overridePolicy:rr,writer:function(e,t,r){var n=e?Zt.toJSON(e):null;n&&Object(A.c)(r,n,t)}}}},read:{source:"layerDefinition.geometryType",reader:Zt.read}}})],nr.prototype,"geometryType",void 0),Object(b.a)([Object(I.b)({type:Boolean,json:{origins:{service:{read:!0}},read:{source:"layerDefinition.hasM"}}})],nr.prototype,"hasM",void 0),Object(b.a)([Object(I.b)({type:Boolean,json:{origins:{service:{read:!0}},read:{source:"layerDefinition.hasZ"}}})],nr.prototype,"hasZ",void 0),Object(b.a)([Object(I.b)({readOnly:!0,type:We.a})],nr.prototype,"heightModelInfo",void 0),Object(b.a)([Object(I.b)({type:Date})],nr.prototype,"historicMoment",void 0),Object(b.a)([Object(I.b)(Ot.c)],nr.prototype,"id",void 0),Object(b.a)([Object(I.b)({readOnly:!0,json:{origins:{service:{read:!0}},read:!1}})],nr.prototype,"infoFor3D",void 0),Object(b.a)([Object(I.b)({readOnly:!0,json:{origins:{"web-map":{write:{target:"layerDefinition.type"}}}}})],nr.prototype,"isTable",void 0),Object(b.a)([Object(F.a)("service","isTable",["type","geometryType"]),Object(F.a)("isTable",["layerDefinition.type","layerDefinition.geometryType"])],nr.prototype,"readIsTable",null),Object(b.a)([Object(z.a)("web-map","isTable")],nr.prototype,"writeIsTable",null),Object(b.a)([Object(I.b)(Ot.d)],nr.prototype,"labelsVisible",void 0),Object(b.a)([Object(I.b)({type:[Rt.a],json:{origins:{service:{read:{source:"drawingInfo.labelingInfo",reader:It.a},write:{target:"drawingInfo.labelingInfo",enabled:!1}}},read:{source:"layerDefinition.drawingInfo.labelingInfo",reader:It.a},write:{target:"layerDefinition.drawingInfo.labelingInfo"}}})],nr.prototype,"labelingInfo",void 0),Object(b.a)([Object(I.b)(Ot.i)],nr.prototype,"opacity",void 0),Object(b.a)([Object(I.b)({type:Number,json:{origins:{service:{read:{source:"id"}}},read:!1}})],nr.prototype,"layerId",void 0),Object(b.a)([Object(I.b)(Ot.e)],nr.prototype,"legendEnabled",void 0),Object(b.a)([Object(I.b)({type:["show","hide"]})],nr.prototype,"listMode",void 0),Object(b.a)([Object(I.b)(Ot.g)],nr.prototype,"minScale",void 0),Object(b.a)([Object(F.a)("service","minScale",["minScale","effectiveMinScale"])],nr.prototype,"readMinScale",null),Object(b.a)([Object(I.b)(Ot.f)],nr.prototype,"maxScale",void 0),Object(b.a)([Object(F.a)("service","maxScale",["maxScale","effectiveMaxScale"])],nr.prototype,"readMaxScale",null),Object(b.a)([Object(I.b)({type:String})],nr.prototype,"globalIdField",void 0),Object(b.a)([Object(F.a)("globalIdField",["layerDefinition.globalIdField","layerDefinition.fields"]),Object(F.a)("service","globalIdField",["globalIdField","fields"])],nr.prototype,"readGlobalIdFieldFromService",null),Object(b.a)([Object(I.b)({type:String,json:{origins:{"web-map":{write:{target:"layerDefinition.objectIdField",overridePolicy:rr}}}}})],nr.prototype,"objectIdField",void 0),Object(b.a)([Object(F.a)("objectIdField",["layerDefinition.objectIdField","layerDefinition.fields"]),Object(F.a)("service","objectIdField",["objectIdField","fields"])],nr.prototype,"readObjectIdFieldFromService",null),Object(b.a)([Object(I.b)({value:"ArcGISFeatureLayer",type:["ArcGISFeatureLayer"]})],nr.prototype,"operationalLayerType",void 0),Object(b.a)([Object(I.b)(tr.outFields)],nr.prototype,"outFields",void 0),Object(b.a)([Object(I.b)({readOnly:!0})],nr.prototype,"parsedUrl",null),Object(b.a)([Object(I.b)({type:String,json:{origins:{"web-scene":{read:!0,write:!0}},read:!1}})],nr.prototype,"path",void 0),Object(b.a)([Object(I.b)(Ot.j)],nr.prototype,"popupEnabled",void 0),Object(b.a)([Object(I.b)({type:v.a,json:{read:{source:"popupInfo"},write:{target:"popupInfo"}}})],nr.prototype,"popupTemplate",void 0),Object(b.a)([Object(I.b)({readOnly:!0})],nr.prototype,"defaultPopupTemplate",null),Object(b.a)([Object(I.b)({type:[Vt],readOnly:!0})],nr.prototype,"relationships",void 0),Object(b.a)([Object(I.b)({types:O.a,json:{origins:{service:{write:{target:"drawingInfo.renderer",enabled:!1}},"web-scene":{types:O.b,write:{target:"layerDefinition.drawingInfo.renderer",writer:g.c}}},write:{target:"layerDefinition.drawingInfo.renderer",overridePolicy:function(e,t,r){return{ignoreOrigin:null==r?void 0:r.writeLayerSchema}},writer:g.c}}})],nr.prototype,"renderer",null),Object(b.a)([Object(F.a)("service","renderer",["drawingInfo.renderer","defaultSymbol"]),Object(F.a)("renderer",["layerDefinition.drawingInfo.renderer","layerDefinition.defaultSymbol"])],nr.prototype,"readRenderer",null),Object(b.a)([Object(I.b)()],nr.prototype,"sourceJSON",void 0),Object(b.a)([Object(I.b)({type:Boolean})],nr.prototype,"returnM",void 0),Object(b.a)([Object(I.b)({type:Boolean})],nr.prototype,"returnZ",void 0),Object(b.a)([Object(I.b)(Ot.m)],nr.prototype,"screenSizePerspectiveEnabled",void 0),Object(b.a)([Object(I.b)()],nr.prototype,"source",null),Object(b.a)([Object(D.a)("source")],nr.prototype,"castSource",null),Object(b.a)([Object(F.a)("portal-item","source",["featureSet"]),Object(F.a)("web-map","source",["featureSet"])],nr.prototype,"readSource",null),Object(b.a)([Object(I.b)({readOnly:!0})],nr.prototype,"serviceDefinitionExpression",void 0),Object(b.a)([Object(F.a)("service","serviceDefinitionExpression",["definitionQuery","definitionExpression"])],nr.prototype,"readServiceDefinitionExpression",null),Object(b.a)([Object(I.b)({type:Qe.a,json:{origins:{service:{read:{source:"extent.spatialReference"}}},read:{source:"layerDefinition.extent.spatialReference"}}})],nr.prototype,"spatialReference",void 0),Object(b.a)([Object(I.b)({type:Number})],nr.prototype,"subtypeCode",void 0),Object(b.a)([Object(I.b)({type:[St.a]})],nr.prototype,"templates",void 0),Object(b.a)([Object(F.a)("templates",["editFieldsInfo","creatorField","editorField","templates"])],nr.prototype,"readTemplates",null),Object(b.a)([Object(I.b)({type:Nt.a})],nr.prototype,"timeInfo",void 0),Object(b.a)([Object(I.b)()],nr.prototype,"title",void 0),Object(b.a)([Object(F.a)("service","title",["name"]),Object(F.a)("portal-item","title",["layerDefinition.title","layerDefinition.name","title"])],nr.prototype,"readTitle",null),Object(b.a)([Object(F.a)("web-map","title",["layerDefinition.name","title"])],nr.prototype,"readTitleFromWebMap",null),Object(b.a)([Object(I.b)({type:String})],nr.prototype,"sublayerTitleMode",void 0),Object(b.a)([Object(I.b)({type:String,json:{read:{source:"timeInfo.trackIdField"}}})],nr.prototype,"trackIdField",void 0),Object(b.a)([Object(I.b)({json:{read:!1}})],nr.prototype,"type",void 0),Object(b.a)([Object(I.b)({type:String})],nr.prototype,"typeIdField",void 0),Object(b.a)([Object(F.a)("service","typeIdField"),Object(F.a)("typeIdField",["layerDefinition.typeIdField"])],nr.prototype,"readTypeIdField",null),Object(b.a)([Object(I.b)({type:[Tt.a]})],nr.prototype,"types",void 0),Object(b.a)([Object(F.a)("service","types",["types"]),Object(F.a)("types",["layerDefinition.types"])],nr.prototype,"readTypes",null),Object(b.a)([Object(I.b)({readOnly:!0,json:{write:!1}})],nr.prototype,"serverGens",void 0),Object(b.a)([Object(I.b)({type:w.a.ofType(jt),readOnly:!0})],nr.prototype,"indexes",void 0),Object(b.a)([Object(I.b)(Ot.n)],nr.prototype,"url",null),Object(b.a)([Object(z.a)("url")],nr.prototype,"writeUrl",null),Object(b.a)([Object(I.b)({readOnly:!0})],nr.prototype,"userIsAdmin",void 0),Object(b.a)([Object(I.b)({json:{origins:{service:{read:!0}},read:!1}})],nr.prototype,"version",void 0),Object(b.a)([Object(F.a)("service","version",["currentVersion","capabilities","drawingInfo","hasAttachments","htmlPopupType","relationships","timeInfo","typeIdField","types"])],nr.prototype,"readVersion",null),Object(b.a)([Object(I.b)({type:Boolean,json:{origins:{"portal-item":{write:{target:"layerDefinition.defaultVisibility"}}}}})],nr.prototype,"visible",void 0),Object(b.a)([Object(F.a)("portal-item","visible",["visibility","layerDefinition.defaultVisibility"])],nr.prototype,"readVisible",null),nr=Object(b.a)([Object(L.a)("esri.layers.FeatureLayer")],nr);var ir=Object(V.b)({types:_.i}),ar=nr;t.default=ar},function(e,t,r){"use strict";r.d(t,"a",(function(){return s})),r.d(t,"b",(function(){return j})),r.d(t,"c",(function(){return y})),r.d(t,"d",(function(){return O}));var n=r(33),i=r(13),a=r(169);function o(e,t){return Object(a.e)(e,t)}function s(e,t){var r,n,i,a=e.hasZ&&t.hasZ;if(e.xmin<=t.xmin){if(r=t.xmin,e.xmax<r)return!1}else if(r=e.xmin,t.xmax<r)return!1;if(e.ymin<=t.ymin){if(n=t.ymin,e.ymax<n)return!1}else if(n=e.ymin,t.ymax<n)return!1;if(a&&t.hasZ)if(e.zmin<=t.zmin){if(i=t.zmin,e.zmax<i)return!1}else if(i=e.zmin,t.zmax<i)return!1;return!0}function c(e,t){var r,n=t.points,o=t.hasZ?a.b:a.a,s=Object(i.a)(n);try{for(s.s();!(r=s.n()).done;){if(o(e,r.value))return!0}}catch(c){s.e(c)}finally{s.f()}return!1}var l=[0,0],u=[0,0],d=[0,0],h=[0,0],f=[l,u,d,h],p=[[d,l],[l,u],[u,h],[h,d]];function b(e,t){l[0]=e.xmin,l[1]=e.ymax,u[0]=e.xmax,u[1]=e.ymax,d[0]=e.xmin,d[1]=e.ymin,h[0]=e.xmax,h[1]=e.ymin;var r,n=Object(i.a)(f);try{for(n.s();!(r=n.n()).done;){var o=r.value;if(Object(a.f)(t,o))return!0}}catch(O){n.e(O)}finally{n.f()}var s,c=Object(i.a)(t.rings);try{for(c.s();!(s=c.n()).done;){var b=s.value;if(b.length){var v=b[0];if(Object(a.a)(e,v))return!0;for(var m=1;m<b.length;m++){var y=b[m];if(Object(a.a)(e,y)||g(v,y,p))return!0;v=y}}}}catch(O){c.e(O)}finally{c.f()}return!1}function v(e,t){l[0]=e.xmin,l[1]=e.ymax,u[0]=e.xmax,u[1]=e.ymax,d[0]=e.xmin,d[1]=e.ymin,h[0]=e.xmax,h[1]=e.ymin;var r,n=t.paths,o=Object(i.a)(n);try{for(o.s();!(r=o.n()).done;){var s=r.value;if(n.length){var c=s[0];if(Object(a.a)(e,c))return!0;for(var f=1;f<s.length;f++){var b=s[f];if(Object(a.a)(e,b)||g(c,b,p))return!0;c=b}}}}catch(v){o.e(v)}finally{o.f()}return!1}var m=[0,0];function y(e){for(var t=0;t<e.length;t++){for(var r=e[t],n=0;n<r.length-1;n++)for(var i=r[n],a=r[n+1],o=t+1;o<e.length;o++)for(var s=0;s<e[o].length-1;s++){var c=e[o][s],l=e[o][s+1];if(O(i,a,c,l,m)&&!(m[0]===i[0]&&m[1]===i[1]||m[0]===c[0]&&m[1]===c[1]||m[0]===a[0]&&m[1]===a[1]||m[0]===l[0]&&m[1]===l[1]))return!0}var u=r.length;if(!(u<=4))for(var d=0;d<u-3;d++){var h=u-1;0===d&&(h=u-2);for(var f=r[d],p=r[d+1],b=d+2;b<h;b++){var v=r[b],y=r[b+1];if(O(f,p,v,y,m)&&!(m[0]===f[0]&&m[1]===f[1]||m[0]===v[0]&&m[1]===v[1]||m[0]===p[0]&&m[1]===p[1]||m[0]===y[0]&&m[1]===y[1]))return!0}}}return!1}function g(e,t,r){for(var n=0;n<r.length;n++)if(O(e,t,r[n][0],r[n][1]))return!0;return!1}function O(e,t,r,i,a){var o=Object(n.a)(e,2),s=o[0],c=o[1],l=Object(n.a)(t,2),u=l[0],d=l[1],h=Object(n.a)(r,2),f=h[0],p=h[1],b=Object(n.a)(i,2),v=b[0]-f,m=s-f,y=u-s,g=b[1]-p,O=c-p,j=d-c,_=g*y-v*j;if(0===_)return!1;var w=(v*O-g*m)/_,x=(y*O-j*m)/_;return w>=0&&w<=1&&x>=0&&x<=1&&(a&&(a[0]=s+w*(u-s),a[1]=c+w*(d-c)),!0)}function j(e){switch(e){case"esriGeometryEnvelope":case"extent":return s;case"esriGeometryMultipoint":case"multipoint":return c;case"esriGeometryPoint":case"point":return o;case"esriGeometryPolygon":case"polygon":return b;case"esriGeometryPolyline":case"polyline":return v}}},function(e,t,r){"use strict";r.d(t,"a",(function(){return A})),r.d(t,"b",(function(){return R}));var n=r(8),i=r.n(n),a=r(33),o=r(16),s=r(13),c=r(123),l=r(22),u=r(15),d=r(3),h=r(158),f=r(176),p=r(179),b=r(59),v=r(61),m=r(14),y=(r(126),r(99)),g=r(39),O=r(100);function j(e,t,r,n){return _.apply(this,arguments)}function _(){return(_=Object(o.a)(i.a.mark((function e(t,r,n,a){var o,s,c,l,u,d,h,f;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o="string"==typeof t?Object(g.K)(t):t,s=r[0].spatialReference,c=Object(m.a)(Object(m.a)({},a),{},{query:Object(m.a)(Object(m.a)({},o.query),{},{f:"json",sr:JSON.stringify(s),target:JSON.stringify({geometryType:Object(O.c)(r[0]),geometries:r}),cutter:JSON.stringify(n)})}),e.next=5,Object(y.default)(o.path+"/cut",c);case 5:return l=e.sent,u=l.data,d=u.cutIndexes,h=u.geometries,f=void 0===h?[]:h,e.abrupt("return",{cutIndexes:d,geometries:f.map((function(e){var t=Object(O.a)(e);return t.spatialReference=s,t}))});case 11:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function w(e,t,r){return x.apply(this,arguments)}function x(){return(x=Object(o.a)(i.a.mark((function e(t,r,n){var a,o,s,c;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a="string"==typeof t?Object(g.K)(t):t,o=r[0].spatialReference,s=Object(O.c)(r[0]),c=Object(m.a)(Object(m.a)({},n),{},{query:Object(m.a)(Object(m.a)({},a.query),{},{f:"json",sr:o.wkid?o.wkid:JSON.stringify(o),geometries:JSON.stringify(k(r))})}),e.t0=S,e.next=4,Object(y.default)(a.path+"/simplify",c);case 4:return e.t1=e.sent.data,e.t2=s,e.t3=o,e.abrupt("return",(0,e.t0)(e.t1,e.t2,e.t3));case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function k(e){return{geometryType:Object(O.c)(e[0]),geometries:e.map((function(e){return e.toJSON()}))}}function S(e,t,r){var n=Object(O.b)(t);return e.map((function(e){var t=n.fromJSON(e);return t.spatialReference=r,t}))}var T=u.a.getLogger("esri.geometry.support.normalizeUtils");function C(e,t,r){if(t){var n=function(e,t){if(!(e instanceof f.a||e instanceof h.a)){var r="straightLineDensify: the input geometry is neither polyline nor polygon";throw T.error(r),new l.a(r)}var n,i=Object(p.b)(e),a=[],o=Object(s.a)(i);try{for(o.s();!(n=o.n()).done;){var c=n.value,u=[];a.push(u),u.push([c[0][0],c[0][1]]);for(var d=0;d<c.length-1;d++){var b=c[d][0],v=c[d][1],m=c[d+1][0],y=c[d+1][1],g=Math.sqrt((m-b)*(m-b)+(y-v)*(y-v)),O=(y-v)/g,j=(m-b)/g,_=g/t;if(_>1){for(var w=1;w<=_-1;w++){var x=w*t,k=j*x+b,S=O*x+v;u.push([k,S])}var C=(g+Math.floor(_-1)*t)/2,M=j*C+b,P=O*C+v;u.push([M,P])}u.push([m,y])}}}catch(A){o.e(A)}finally{o.f()}return function(e){return"polygon"===e.type}(e)?new h.a({rings:a,spatialReference:e.spatialReference}):new f.a({paths:a,spatialReference:e.spatialReference})}(e,1e6);e=Object(v.e)(n,!0)}return r&&(e=Object(p.e)(e,r)),e}function M(e,t,r){if(Array.isArray(e)){var n=e[0];if(n>t){var i=Object(p.d)(n,t);e[0]=n+i*(-2*t)}else if(n<r){var a=Object(p.d)(n,r);e[0]=n+a*(-2*r)}}else{var o=e.x;if(o>t){var s=Object(p.d)(o,t);e=e.clone().offset(s*(-2*t),0)}else if(o<r){var c=Object(p.d)(o,r);e=e.clone().offset(c*(-2*r),0)}}return e}function P(e,t){for(var r=-1,n=function(n){for(var i=t.cutIndexes[n],a=t.geometries[n],o=Object(p.b)(a),c=function(e){var t=o[e];t.some((function(r){if(r[0]<180)return!0;for(var n=0,i=0;i<t.length;i++){var o=t[i][0];n=o>n?o:n}n=Number(n.toFixed(9));for(var s=-360*Object(p.d)(n,180),c=0;c<t.length;c++){var l=a.getPoint(e,c);a.setPoint(e,c,l.clone().offset(s,0))}return!0}))},l=0;l<o.length;l++)c(l);if(i===r){if(function(e){return"polygon"===e[0].type}(e)){var u,d=Object(s.a)(Object(p.b)(a));try{for(d.s();!(u=d.n()).done;){var h=u.value;e[i]=e[i].addRing(h)}}catch(m){d.e(m)}finally{d.f()}}else if(function(e){return"polyline"===e[0].type}(e)){var f,b=Object(s.a)(Object(p.b)(a));try{for(b.s();!(f=b.n()).done;){var v=f.value;e[i]=e[i].addPath(v)}}catch(m){b.e(m)}finally{b.f()}}}else r=i,e[i]=a},i=0;i<t.cutIndexes.length;i++)n(i);return e}function A(e,t,r){return E.apply(this,arguments)}function E(){return(E=Object(o.a)(i.a.mark((function e(t,r,n){var a,o,l,u,m,y,g,O,_,x,k,S,T,E,R,I,D,F,L,z,V,N,U,B,G,q,H,W,Q,Z,X,Y,$,J,K,ee,te,re,ne,ie;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Array.isArray(t)){e.next=2;break}return e.abrupt("return",A([t],r));case 2:a=r?r.url:c.a.geometryServiceUrl,x=0,k=[],S=[],T=Object(s.a)(t);try{for(T.s();!(E=T.n()).done;)R=E.value,Object(d.i)(R)?S.push(R):(o||(o=R.spatialReference,l=Object(b.d)(o),u=o.isWebMercator,g=u?102100:4326,m=p.a[g].maxX,y=p.a[g].minX,O=p.a[g].plus180Line,_=p.a[g].minus180Line),l?"mesh"===R.type?S.push(R):"point"===R.type?S.push(M(R.clone(),m,y)):"multipoint"===R.type?((I=R.clone()).points=I.points.map((function(e){return M(e,m,y)})),S.push(I)):"extent"===R.type?(D=R.clone()._normalize(!1,!1,l),S.push(D.rings?new h.a(D):D)):R.extent?(F=R.extent,L=Object(p.d)(F.xmin,y)*(2*m),z=0===L?R.clone():Object(p.e)(R.clone(),L),F.offset(L,0),F.intersects(O)&&F.xmax!==m?(x=F.xmax>x?F.xmax:x,z=C(z,u),k.push(z),S.push("cut")):F.intersects(_)&&F.xmin!==y?(x=F.xmax*(2*m)>x?F.xmax*(2*m):x,z=C(z,u,360),k.push(z),S.push("cut")):S.push(z)):S.push(R.clone()):S.push(R))}catch(i){T.e(i)}finally{T.f()}for(V=Object(p.d)(x,m),N=-90,U=V,B=new f.a;V>0;)G=360*V-180,B.addPath([[G,N],[G,-1*N]]),N*=-1,V--;if(!(k.length>0&&U>0)){e.next=28;break}return e.t0=P,e.t1=k,e.next=15,j(a,k,B,n);case 15:for(e.t2=e.sent,q=(0,e.t0)(e.t1,e.t2),H=[],W=[],Q=0;Q<S.length;Q++)"cut"!==(Z=S[Q])?W.push(Z):(X=q.shift(),Y=t[Q],Object(d.j)(Y)&&"polygon"===Y.type&&Y.rings&&Y.rings.length>1&&X.rings.length>=Y.rings.length?(H.push(X),W.push("simplify")):W.push(u?Object(v.b)(X):X));if(H.length){e.next=22;break}return e.abrupt("return",W);case 22:return e.next=24,w(a,H,n);case 24:for($=e.sent,J=[],K=0;K<W.length;K++)"simplify"!==(ee=W[K])?J.push(ee):J.push(u?Object(v.b)($.shift()):$.shift());return e.abrupt("return",J);case 28:for(te=[],re=0;re<S.length;re++)"cut"!==(ne=S[re])?te.push(ne):(ie=k.shift(),te.push(!0===u?Object(v.b)(ie):ie));return e.abrupt("return",Promise.resolve(te));case 31:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function R(e,t){var r=Object(b.d)(t);if(r){var n=Object(a.a)(r.valid,2),i=n[0],o=n[1],s=o-i;if(e<i)for(;e<i;)e+=s;if(e>o)for(;e>o;)e-=s}return e}},function(e,t,r){"use strict";r.d(t,"a",(function(){return l})),r.d(t,"b",(function(){return d})),r.d(t,"c",(function(){return c}));r(17);var n=r(22),i=r(113),a=r(192),o=r(257),s=r(419);function c(e,t,r,a){var o=function(e,t){return e?function(e,t){if(!t||"web-scene"!==t.origin)return!0;switch(e.type){case"simple":case"unique-value":case"class-breaks":return!0;case"heatmap":case"dictionary":case"dot-density":default:return!1}}(e,t)?e.write({},t):(t.messages&&t.messages.push(new n.a("renderer:unsupported","Renderer of type '".concat(e.declaredClass,"' are not supported in scenes."),{renderer:e,context:t})),null):null}(e,a);o&&Object(i.c)(r,o,t)}function l(e,t){return d(e,null,t)}var u=Object(o.b)({types:s.a});function d(e,t,r){return e?e&&(e.styleName||e.styleUrl)&&"uniqueValue"!==e.type?(r&&r.messages&&r.messages.push(new a.a("renderer:unsupported","Only UniqueValueRenderer can be referenced from a web style, but found '"+e.type+"'",{definition:e,context:r})),null):u(e,t,r):null}},function(e,t,r){"use strict";r.d(t,"a",(function(){return p}));var n=r(13),i=r(14),a=r(2),o=r(5),s=r(101),c=r(191),l=r(15),u=r(3),d=r(23),h=r(369),f=l.a.getLogger("esri.core.workers.WorkerHandle"),p=function(){function e(t,r,o){var s=this,c=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};Object(a.a)(this,e),this._mainMethod=r,this._listeners=[],this._promise=Object(h.b)(t,Object(i.a)(Object(i.a)({},c),{},{schedule:o})).then((function(e){if(void 0===s._thread){s._thread=e,s._promise=null,c.hasInitialize&&s.broadcast({},"initialize");var t,r=Object(n.a)(s._listeners);try{for(r.s();!(t=r.n()).done;){var i=t.value;s._connectListener(i)}}catch(a){r.e(a)}finally{r.f()}}else e.close()})),this._promise.catch((function(e){return f.error("Failed to initialize ".concat(t," worker: ").concat(e))}))}return Object(o.a)(e,[{key:"on",value:function(e,t){var r=this,n={removed:!1,eventName:e,callback:t,threadHandle:null};return this._listeners.push(n),this._connectListener(n),Object(c.b)((function(){n.removed=!0,Object(s.j)(r._listeners,n),r._thread&&Object(u.j)(n.threadHandle)&&n.threadHandle.remove()}))}},{key:"destroy",value:function(){this._thread&&(this._thread.close(),this._thread=null),this._promise=null}},{key:"invoke",value:function(e,t){return this.invokeMethod(this._mainMethod,e,t)}},{key:"invokeMethod",value:function(e,t,r){var n=this;if(this._thread){var i=this.getTransferList(t,e);return this._thread.invoke(e,t,{transferList:i,signal:r})}return this._promise?this._promise.then((function(){return Object(d.x)(r),n.invokeMethod(e,t,r)})):Promise.reject(null)}},{key:"broadcast",value:function(e,t){var r=this;return this._thread?Promise.all(this._thread.broadcast(t,e)).then((function(){})):this._promise?this._promise.then((function(){return r.broadcast(e,t)})):Promise.reject()}},{key:"promise",get:function(){return this._promise}},{key:"_connectListener",value:function(e){this._thread&&this._thread.on(e.eventName,e.callback).then((function(t){e.removed||(e.threadHandle=t)}))}}]),e}()},function(e,t,r){"use strict";r.d(t,"a",(function(){return o})),r.d(t,"b",(function(){return s}));var n=r(3),i=r(9),a=r(51);function o(e,t,r){if(null==e||Object(n.i)(r))return!1;var i=!0;return c[0]=null!=e.xmin?e.xmin:0,c[1]=null!=e.ymin?e.ymin:0,c[2]=null!=e.zmin?e.zmin:0,i=i&&Object(a.q)(c,e.spatialReference,0,t,r,0,1),c[0]=null!=e.xmax?e.xmax:0,c[1]=null!=e.ymax?e.ymax:0,c[2]=null!=e.zmax?e.zmax:0,i=i&&Object(a.q)(c,e.spatialReference,0,t,r,3,1),null==e.xmin&&(t[0]=-1/0),null==e.ymin&&(t[1]=-1/0),null==e.zmin&&(t[2]=-1/0),null==e.xmax&&(t[3]=1/0),null==e.ymax&&(t[4]=1/0),null==e.zmax&&(t[5]=1/0),i}function s(e,t,r){if(null==e)return!1;var n=!0;return c[0]=null!=e.xmin?e.xmin:0,c[1]=null!=e.ymin?e.ymin:0,c[2]=null!=e.zmin?e.zmin:0,n=n&&Object(a.q)(c,e.spatialReference,0,c,r,0,1),t[0]=c[0],t[1]=c[1],c[0]=null!=e.xmax?e.xmax:0,c[1]=null!=e.ymax?e.ymax:0,c[2]=null!=e.zmax?e.zmax:0,n=n&&Object(a.q)(c,e.spatialReference,0,c,r,0,1),t[2]=c[0],t[3]=c[1],null==e.xmin&&(t[0]=-1/0),null==e.ymin&&(t[1]=-1/0),null==e.xmax&&(t[2]=1/0),null==e.ymax&&(t[3]=1/0),n}var c=Object(i.e)()},function(e,t,r){"use strict";r.d(t,"a",(function(){return v})),r.d(t,"b",(function(){return m}));var n=r(8),i=r.n(n),a=r(16),o=r(2),s=r(5),c=r(6),l=r(7),u=r(0),d=r(15),h=r(23),f=r(62),p=(r(17),r(18),r(1)),b=r(10),v=function(e){var t=function(e){Object(c.a)(r,e);var t=Object(l.a)(r);function r(){var e;return Object(o.a)(this,r),(e=t.apply(this,arguments)).refreshTimestamp=null,e.refreshDebounced=Object(h.j)(function(){var t=Object(a.a)(i.a.mark((function t(r,n){var a;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if("number"==typeof r?a=r:(a=Date.now(),n=r),e._set("refreshTimestamp",a),t.t0=e.doRefresh,!t.t0){t.next=6;break}return t.next=6,e.doRefresh(n).catch((function(t){Object(h.n)(t)||d.a.getLogger(e.declaredClass).error(t)}));case 6:case"end":return t.stop()}}),t)})));return function(e,r){return t.apply(this,arguments)}}(),2e3),e}return Object(s.a)(r,[{key:"refresh",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Date.now();this._set("refreshTimestamp",t),this.doRefresh&&this.doRefresh().catch((function(t){Object(h.n)(t)||d.a.getLogger(e.declaredClass).error(t)}))}}]),r}(e);return Object(u.a)([Object(p.b)()],t.prototype,"layer",void 0),Object(u.a)([Object(f.a)("layer.refreshInterval")],t.prototype,"refreshInterval",void 0),Object(u.a)([Object(p.b)({readOnly:!0})],t.prototype,"refreshTimestamp",void 0),t=Object(u.a)([Object(b.a)("esri.layers.mixins.RefreshableLayerView")],t)};function m(e){return"refresh"in e}},function(e,t,r){"use strict";r.d(t,"a",(function(){return h})),r.d(t,"b",(function(){return f})),r.d(t,"c",(function(){return v})),r.d(t,"d",(function(){return p}));var n=r(33);function i(e){return void 0!==e.xmin&&void 0!==e.ymin&&void 0!==e.xmax&&void 0!==e.ymax}function a(e){return void 0!==e.points}function o(e){return void 0!==e.x&&void 0!==e.y}function s(e){return void 0!==e.paths}function c(e){return void 0!==e.rings}function l(e){return function(t,r){return null==t?r:null==r?t:e(t,r)}}var u=l(Math.min),d=l(Math.max);function h(e,t){return s(t)?p(e,t.paths,!1,!1):c(t)?p(e,t.rings,!1,!1):a(t)?v(e,t.points,!1,!1,!1,!1):i(t)?b(e,t):(o(t)&&(e[0]=t.x,e[1]=t.y,e[2]=t.x,e[3]=t.y),e)}function f(e,t){return s(t)?p(e,t.paths,!0,!1):c(t)?p(e,t.rings,!0,!1):a(t)?v(e,t.points,!0,!1,!0,!1):i(t)?b(e,t,!0,!1,!0,!1):(o(t)&&(e[0]=t.x,e[1]=t.y,e[2]=t.z,e[3]=t.x,e[4]=t.y,e[5]=t.z),e)}function p(e,t,r,i){var a=r?3:2;if(!t.length||!t[0].length)return null;for(var o,s,c,l,h=Object(n.a)(t[0][0],2),f=h[0],p=h[1],b=Object(n.a)(t[0][0],2),v=b[0],m=b[1],y=0;y<t.length;y++)for(var g=t[y],O=0;O<g.length;O++){var j=g[O],_=Object(n.a)(j,2),w=_[0],x=_[1];if(f=u(f,w),p=u(p,x),v=d(v,w),m=d(m,x),r&&j.length>2){var k=j[2];o=u(o,k),s=d(s,k)}if(i&&j.length>a){var S=j[a];c=u(o,S),l=d(s,S)}}return r?i?(e[0]=f,e[1]=p,e[2]=o,e[3]=c,e[4]=v,e[5]=m,e[6]=s,e[7]=l,e.length=8,e):(e[0]=f,e[1]=p,e[2]=o,e[3]=v,e[4]=m,e[5]=s,e.length=6,e):i?(e[0]=f,e[1]=p,e[2]=c,e[3]=v,e[4]=m,e[5]=l,e.length=6,e):(e[0]=f,e[1]=p,e[2]=v,e[3]=m,e.length=4,e)}function b(e,t,r,n,i,a){var o=t.xmin,s=t.xmax,c=t.ymin,l=t.ymax,u=t.zmin,d=t.zmax,h=t.mmin,f=t.mmax;return i?(u=u||0,d=d||0,a?(h=h||0,f=f||0,e[0]=o,e[1]=c,e[2]=u,e[3]=h,e[4]=s,e[5]=l,e[6]=d,e[7]=f,e):(e[0]=o,e[1]=c,e[2]=u,e[3]=s,e[4]=l,e[5]=d,e)):a?(h=h||0,f=f||0,e[0]=o,e[1]=c,e[2]=h,e[3]=s,e[4]=l,e[5]=f,e):(e[0]=o,e[1]=c,e[2]=s,e[3]=l,e)}function v(e,t,r,i,a,o){var s=r?3:2,c=i&&o,l=r&&a;if(!t.length||!t[0].length)return null;for(var h,f,p,b,v=Object(n.a)(t[0],2),m=v[0],y=v[1],g=Object(n.a)(t[0],2),O=g[0],j=g[1],_=0;_<t.length;_++){var w=t[_],x=Object(n.a)(w,2),k=x[0],S=x[1];if(m=u(m,k),y=u(y,S),O=d(O,k),j=d(j,S),l&&w.length>2){var T=w[2];h=u(h,T),f=d(f,T)}if(c&&w.length>s){var C=w[s];p=u(h,C),b=d(f,C)}}return a?(h=h||0,f=f||0,o?(p=p||0,b=b||0,e[0]=m,e[1]=y,e[2]=h,e[3]=p,e[4]=O,e[5]=j,e[6]=f,e[7]=b,e):(e[0]=m,e[1]=y,e[2]=h,e[3]=O,e[4]=j,e[5]=f,e)):o?(p=p||0,b=b||0,e[0]=m,e[1]=y,e[2]=p,e[3]=O,e[4]=j,e[5]=b,e):(e[0]=m,e[1]=y,e[2]=O,e[3]=j,e)}},function(e,t,r){"use strict";var n,i=r(2),a=r(5),o=r(6),s=r(7),c=r(0),l=r(58),u=r(27),d=r(25),h=r(1),f=(r(18),r(17),r(15),r(10)),p=r(44),b=new l.a({count:"count",sum:"sum",min:"min",max:"max",avg:"avg",stddev:"stddev",var:"var",exceedslimit:"exceedslimit",percentile_cont:"percentile-continuous",percentile_disc:"percentile-discrete"}),v=n=function(e){Object(o.a)(r,e);var t=Object(s.a)(r);function r(e){var n;return Object(i.a)(this,r),(n=t.call(this,e)).maxPointCount=void 0,n.maxRecordCount=void 0,n.maxVertexCount=void 0,n.onStatisticField=null,n.outStatisticFieldName=null,n.statisticType=null,n.statisticParameters=null,n}return Object(a.a)(r,[{key:"writeStatisticParameters",value:function(e,t){"percentile-continuous"!==this.statisticType&&"percentile-discrete"!==this.statisticType||(t.statisticParameters=Object(d.a)(e))}},{key:"clone",value:function(){return new n({maxPointCount:this.maxPointCount,maxRecordCount:this.maxRecordCount,maxVertexCount:this.maxVertexCount,onStatisticField:this.onStatisticField,outStatisticFieldName:this.outStatisticFieldName,statisticType:this.statisticType,statisticParameters:Object(d.a)(this.statisticParameters)})}}]),r}(u.a);Object(c.a)([Object(h.b)({type:Number,json:{write:!0}})],v.prototype,"maxPointCount",void 0),Object(c.a)([Object(h.b)({type:Number,json:{write:!0}})],v.prototype,"maxRecordCount",void 0),Object(c.a)([Object(h.b)({type:Number,json:{write:!0}})],v.prototype,"maxVertexCount",void 0),Object(c.a)([Object(h.b)({type:String,json:{write:!0}})],v.prototype,"onStatisticField",void 0),Object(c.a)([Object(h.b)({type:String,json:{write:!0}})],v.prototype,"outStatisticFieldName",void 0),Object(c.a)([Object(h.b)({type:String,json:{read:{source:"statisticType",reader:b.read},write:{target:"statisticType",writer:b.write}}})],v.prototype,"statisticType",void 0),Object(c.a)([Object(h.b)({type:Object})],v.prototype,"statisticParameters",void 0),Object(c.a)([Object(p.a)("statisticParameters")],v.prototype,"writeStatisticParameters",null);var m=v=n=Object(c.a)([Object(f.a)("esri.rest.support.StatisticDefinition")],v);t.a=m},function(e,t,r){"use strict";r.d(t,"a",(function(){return m})),r.d(t,"b",(function(){return y})),r.d(t,"c",(function(){return h})),r.d(t,"d",(function(){return b}));var n=r(8),i=r.n(n),a=r(14),o=r(16),s=r(13),c=r(49),l=r(3),u=r(420);function d(e,t){if(!e||e.symbol)return null;var r=t&&t.renderer;return e&&Object(l.j)(r)&&r.getObservationRenderer?r.getObservationRenderer(e):r}function h(e,t){var r=d(e,t),n=function(e,t){if(Object(l.j)(e.symbol))return e.symbol;var r=d(e,t);return Object(l.j)(r)&&"dot-density"!==r.type?r.getSymbol(e,t):null}(e,t);if(Object(l.i)(n))return null;var i={renderer:r,symbol:n};if(Object(l.i)(r)||!("visualVariables"in r)||!r.visualVariables)return i;var a,o=Object(u.getVisualVariableValues)(r,e,t),c=["proportional","proportional","proportional"],h=Object(s.a)(o);try{for(h.s();!(a=h.n()).done;){var f=a.value,p=f.variable,b=f.value;switch(p.type){case"color":i.color=b.toRgba();break;case"size":if("outline"===p.target)i.outlineSize=b;else{var v=p.axis,m=p.useSymbolValue?"symbol-value":b;switch(v){case"width":c[0]=m;break;case"depth":c[1]=m;break;case"height":c[2]=m;break;case"width-and-depth":c[0]=c[1]=m;break;default:c[0]=c[1]=c[2]=m}}break;case"opacity":i.opacity=b;break;case"rotation":switch(p.axis){case"tilt":i.tilt=b;break;case"roll":i.roll=b;break;default:i.heading=b}}}}catch(y){h.e(y)}finally{h.f()}return"proportional"===c[0]&&"proportional"===c[1]&&"proportional"===c[2]||(i.size=c),i}function f(e,t){return p.apply(this,arguments)}function p(){return(p=Object(o.a)(i.a.mark((function e(t,r){var n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!Object(l.j)(t.symbol)){e.next=2;break}return e.abrupt("return",t.symbol);case 2:return n=d(t,r),e.abrupt("return",Object(l.j)(n)&&n.getSymbolAsync(t,Object(a.a)(Object(a.a)({},r),{},{abortOptions:{signal:r.signal}})));case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function b(e,t){return v.apply(this,arguments)}function v(){return(v=Object(o.a)(i.a.mark((function e(t,r){var n,a,o,l,h,p,b,v,m,y,g,O;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=d(t,r),e.next=3,f(t,r);case 3:if(a=e.sent){e.next=6;break}return e.abrupt("return",null);case 6:if(o={renderer:n,symbol:a},n&&"visualVariables"in n&&n.visualVariables){e.next=9;break}return e.abrupt("return",o);case 9:l=Object(u.getVisualVariableValues)(n,t,r),h=["proportional","proportional","proportional"],p=Object(s.a)(l);try{for(p.s();!(b=p.n()).done;)v=b.value,m=v.variable,y=v.value,"color"===m.type?o.color=c.a.toUnitRGBA(y):"size"===m.type?"outline"===m.target?o.outlineSize=y:(g=m.axis,O=m.useSymbolValue?"symbol-value":y,"width"===g?h[0]=O:"depth"===g?h[1]=O:"height"===g?h[2]=O:h[0]=h[1]="width-and-depth"===g?O:h[2]=O):"opacity"===m.type?o.opacity=y:"rotation"===m.type&&"tilt"===m.axis?o.tilt=y:"rotation"===m.type&&"roll"===m.axis?o.roll=y:"rotation"===m.type&&(o.heading=y)}catch(i){p.e(i)}finally{p.f()}return e.abrupt("return",((isFinite(h[0])||isFinite(h[1])||isFinite(h[2]))&&(o.size=h),o));case 13:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function m(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=e[t];return"number"==typeof r&&isFinite(r)?r:null}function y(e){for(var t=0;t<3;t++){var r=e[t];if("number"==typeof r)return isFinite(r)?r:0}return 0}},function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var n=r(13);r(3);function i(e,t){var r,i=Object(n.a)(e.entries());try{for(i.s();!(r=i.n()).done;){if(t(r.value[0]))return!0}}catch(a){i.e(a)}finally{i.f()}return!1}},function(e,t,r){"use strict";r.d(t,"a",(function(){return s})),r.d(t,"b",(function(){return i})),r.d(t,"c",(function(){return a})),r.d(t,"d",(function(){return o}));var n=r(3);function i(e){return e&&"function"==typeof e.highlight}function a(e){return e&&"function"==typeof e.maskOccludee}function o(e,t,r){return Object(n.i)(e)||e>r&&(0===t||e<t)}function s(e){var t=e.minScale,r=e.maxScale;return{minScale:t=t||0,maxScale:r=r||0}}},function(e,t,r){"use strict";r.d(t,"a",(function(){return d})),r.d(t,"b",(function(){return f}));var n=r(50),i=r(8),a=r.n(i),o=r(16),s=r(128),c=r(53),l=r(180),u=r(3);function d(e,t){return h.apply(this,arguments)}function h(){return(h=Object(o.a)(a.a.mark((function e(t,r){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.load();case 2:return e.abrupt("return",f(t,r));case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function f(e,t){return p.apply(this,arguments)}function p(){return(p=Object(o.a)(a.a.mark((function e(t,r){var i,d;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=[],r((function e(){for(var t=arguments.length,r=new Array(t),a=0;a<t;a++)r[a]=arguments[a];for(var o=0,s=r;o<s.length;o++){var d=s[o];Object(u.i)(d)||(Array.isArray(d)?e.apply(void 0,Object(n.a)(d)):c.a.isCollection(d)?d.forEach((function(t){return e(t)})):l.a.isLoadable(d)&&i.push(d))}})),d=null,e.next=5,Object(s.c)(i,function(){var e=Object(o.a)(a.a.mark((function e(t){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t1=!1,e.next=3,Object(s.d)(b(t)?t.loadAll():t.load());case 3:if(e.t2=e.sent.ok,e.t0=e.t1!==e.t2,e.t0){e.next=7;break}e.t0=d;case 7:if(e.t3=e.t0,e.t3){e.next=10;break}d=t;case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 5:if(!d){e.next=7;break}throw d.loadError;case 7:return e.abrupt("return",t);case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function b(e){return"loadAll"in e&&"function"==typeof e.loadAll}},function(e,t,r){"use strict";function n(e){return 32+e.length}function i(){return 16}function a(e){if(!e)return 0;var t=32;for(var r in e)if(e.hasOwnProperty(r)){var i=e[r];switch(typeof i){case"string":t+=n(i);break;case"number":t+=16;break;case"boolean":t+=4}}return t}function o(e,t){return 32+e.length*t}r.d(t,"a",(function(){return a})),r.d(t,"b",(function(){return o})),r.d(t,"c",(function(){return i})),r.d(t,"d",(function(){return n}))},function(e,t,r){"use strict";var n,i=r(2),a=r(5),o=r(45),s=r(42),c=r(6),l=r(7),u=r(14),d=r(0),h=r(22),f=r(58),p=r(15),b=r(28),v=r(1),m=(r(17),r(64)),y=r(48),g=r(10),O=r(44),j=r(291),_=r(647),w=(r(18),r(519)),x=n=function(e){Object(c.a)(r,e);var t=Object(l.a)(r);function r(){var e;return Object(i.a)(this,r),(e=t.apply(this,arguments)).customValues=null,e}return Object(a.a)(r,[{key:"clone",value:function(){return new n({title:this.title,showLegend:this.showLegend,customValues:this.customValues&&this.customValues.slice(0)})}}]),r}(w.a);Object(d.a)([Object(v.b)({type:[Number],json:{write:!0}})],x.prototype,"customValues",void 0);var k,S=x=n=Object(d.a)([Object(g.a)("esri.renderers.visualVariables.support.SizeVariableLegendOptions")],x),T=r(215),C=r(420),M=p.a.getLogger("esri.renderers.visualVariables.SizeVariable"),P=new f.a({width:"width",depth:"depth",height:"height",widthAndDepth:"width-and-depth",all:"all"}),A=new f.a({unknown:"unknown",inch:"inches",foot:"feet",yard:"yards",mile:"miles","nautical-mile":"nautical-miles",millimeter:"millimeters",centimeter:"centimeters",decimeter:"decimeters",meter:"meters",kilometer:"kilometers","decimal-degree":"decimal-degrees"});function E(e){if(null!=e)return"string"==typeof e||"number"==typeof e?Object(b.j)(e):"size"===e.type?Object(T.c)(e)?e:(delete(e=Object(u.a)({},e)).type,new I(e)):void 0}function R(e,t,r){if("object"!=typeof e)return e;var n=new I;return n.read(e,r),n}var I=k=function(e){Object(c.a)(r,e);var t=Object(l.a)(r);function r(e){var n;return Object(i.a)(this,r),(n=t.call(this,e)).axis=null,n.legendOptions=null,n.normalizationField=null,n.scaleBy=null,n.target=null,n.type="size",n.useSymbolValue=null,n.valueExpression=null,n.valueRepresentation=null,n.valueUnit=null,n}return Object(a.a)(r,[{key:"cache",get:function(){return{ipData:this._interpolateData(),hasExpression:!!this.valueExpression,compiledFunc:null,isScaleDriven:C.viewScaleRE.test(this.valueExpression)}}},{key:"expression",set:function(e){M.warn("'expression' is deprecated since version 4.2. Use 'valueExpression' instead. The only supported expression is 'view.scale'."),"view.scale"===e?(this.valueExpression="$view.scale",this._set("expression",e)):this._set("expression",null)}},{key:"index",set:function(e){Object(T.c)(this.maxSize)&&(this.maxSize.index="visualVariables[".concat(e,"].maxSize")),Object(T.c)(this.minSize)&&(this.minSize.index="visualVariables[".concat(e,"].minSize")),this._set("index",e)}},{key:"inputValueType",get:function(){return Object(T.a)(this)}},{key:"maxDataValue",set:function(e){e&&this.stops&&(M.warn("cannot set maxDataValue when stops is not null."),e=null),this._set("maxDataValue",e)}},{key:"maxSize",set:function(e){e&&this.stops&&(M.warn("cannot set maxSize when stops is not null."),e=null),this._set("maxSize",e)}},{key:"castMaxSize",value:function(e){return E(e)}},{key:"readMaxSize",value:function(e,t,r){return R(e,0,r)}},{key:"minDataValue",set:function(e){e&&this.stops&&(M.warn("cannot set minDataValue when stops is not null."),e=null),this._set("minDataValue",e)}},{key:"minSize",set:function(e){e&&this.stops&&(M.warn("cannot set minSize when stops is not null."),e=null),this._set("minSize",e)}},{key:"castMinSize",value:function(e){return E(e)}},{key:"readMinSize",value:function(e,t,r){return R(e,0,r)}},{key:"arcadeRequired",get:function(){return!!this.valueExpression||this.minSize&&"object"==typeof this.minSize&&this.minSize.arcadeRequired||this.maxSize&&"object"==typeof this.maxSize&&this.maxSize.arcadeRequired}},{key:"stops",set:function(e){null==this.minDataValue&&null==this.maxDataValue&&null==this.minSize&&null==this.maxSize?e&&Array.isArray(e)&&(e=e.filter((function(e){return!!e}))).sort((function(e,t){return e.value-t.value})):e&&(M.warn("cannot set stops when one of minDataValue, maxDataValue, minSize or maxSize is not null."),e=null),this._set("stops",e)}},{key:"transformationType",get:function(){return Object(T.b)(this,this.inputValueType)}},{key:"readValueExpression",value:function(e,t){return e||t.expression&&"$view.scale"}},{key:"writeValueExpressionWebScene",value:function(e,t,r,n){if("$view.scale"===e){if(n&&n.messages){var i=this.index,a="string"==typeof i?i:"visualVariables[".concat(i,"]");n.messages.push(new h.a("property:unsupported",this.type+"VisualVariable.valueExpression = '$view.scale' is not supported in Web Scene. Please remove this property to save the Web Scene.",{instance:this,propertyName:a+".valueExpression",context:n}))}}else t[r]=e}},{key:"readValueUnit",value:function(e){return e?A.read(e):null}},{key:"clone",value:function(){return new k({axis:this.axis,field:this.field,valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle,maxDataValue:this.maxDataValue,maxSize:Object(T.c)(this.maxSize)?this.maxSize.clone():this.maxSize,minDataValue:this.minDataValue,minSize:Object(T.c)(this.minSize)?this.minSize.clone():this.minSize,normalizationField:this.normalizationField,stops:this.stops&&this.stops.map((function(e){return e.clone()})),target:this.target,useSymbolValue:this.useSymbolValue,valueRepresentation:this.valueRepresentation,valueUnit:this.valueUnit,legendOptions:this.legendOptions&&this.legendOptions.clone()})}},{key:"flipSizes",value:function(){if("clamped-linear"===this.transformationType){var e=this.minSize,t=this.maxSize;return this.minSize=t,this.maxSize=e,this}if("stops"===this.transformationType){for(var r=this.stops,n=r.map((function(e){return e.size})).reverse(),i=r.length,a=0;a<i;a++)r[a].size=n[a];return this}return this}},{key:"getAttributeHash",value:function(){return"".concat(Object(o.a)(Object(s.a)(r.prototype),"getAttributeHash",this).call(this),"-").concat(this.target,"-").concat(this.normalizationField)}},{key:"_interpolateData",value:function(){return this.stops&&this.stops.map((function(e){return e.value||0}))}}]),r}(j.a);Object(d.a)([Object(v.b)({readOnly:!0})],I.prototype,"cache",null),Object(d.a)([Object(v.b)({type:P.apiValues,json:{type:P.jsonValues,origins:{"web-map":{read:!1}},read:P.read,write:P.write}})],I.prototype,"axis",void 0),Object(d.a)([Object(v.b)({type:String,value:null,json:{read:!1}})],I.prototype,"expression",null),Object(d.a)([Object(v.b)()],I.prototype,"index",null),Object(d.a)([Object(v.b)({type:String,readOnly:!0})],I.prototype,"inputValueType",null),Object(d.a)([Object(v.b)({type:S,json:{write:!0}})],I.prototype,"legendOptions",void 0),Object(d.a)([Object(v.b)({type:Number,value:null,json:{write:!0}})],I.prototype,"maxDataValue",null),Object(d.a)([Object(v.b)({type:Number,value:null,json:{write:!0}})],I.prototype,"maxSize",null),Object(d.a)([Object(m.a)("maxSize")],I.prototype,"castMaxSize",null),Object(d.a)([Object(y.a)("maxSize")],I.prototype,"readMaxSize",null),Object(d.a)([Object(v.b)({type:Number,value:null,json:{write:!0}})],I.prototype,"minDataValue",null),Object(d.a)([Object(v.b)({type:Number,value:null,json:{write:!0}})],I.prototype,"minSize",null),Object(d.a)([Object(m.a)("minSize")],I.prototype,"castMinSize",null),Object(d.a)([Object(y.a)("minSize")],I.prototype,"readMinSize",null),Object(d.a)([Object(v.b)({type:String,json:{write:!0}})],I.prototype,"normalizationField",void 0),Object(d.a)([Object(v.b)({readOnly:!0})],I.prototype,"arcadeRequired",null),Object(d.a)([Object(v.b)({type:String})],I.prototype,"scaleBy",void 0),Object(d.a)([Object(v.b)({type:[_.a],value:null,json:{write:!0}})],I.prototype,"stops",null),Object(d.a)([Object(v.b)({type:["outline"],json:{write:!0}})],I.prototype,"target",void 0),Object(d.a)([Object(v.b)({type:String,readOnly:!0})],I.prototype,"transformationType",null),Object(d.a)([Object(v.b)({type:["size"],json:{type:["sizeInfo"]}})],I.prototype,"type",void 0),Object(d.a)([Object(v.b)({type:Boolean,json:{write:!0,origins:{"web-map":{read:!1}}}})],I.prototype,"useSymbolValue",void 0),Object(d.a)([Object(v.b)({type:String,json:{write:!0}})],I.prototype,"valueExpression",void 0),Object(d.a)([Object(y.a)("valueExpression",["valueExpression","expression"])],I.prototype,"readValueExpression",null),Object(d.a)([Object(O.a)("web-scene","valueExpression")],I.prototype,"writeValueExpressionWebScene",null),Object(d.a)([Object(v.b)({type:["radius","diameter","area","width","distance"],json:{write:!0}})],I.prototype,"valueRepresentation",void 0),Object(d.a)([Object(v.b)({type:A.apiValues,json:{write:A.write,origins:{"web-map":{read:!1},"web-scene":{write:!0}}}})],I.prototype,"valueUnit",void 0),Object(d.a)([Object(y.a)("valueUnit")],I.prototype,"readValueUnit",null);var D=I=k=Object(d.a)([Object(g.a)("esri.renderers.visualVariables.SizeVariable")],I);t.a=D},function(e,t,r){"use strict";r.d(t,"a",(function(){return c}));var n,i=r(271),a=function(e,t){for(var r=[];e&&e!==t;)r.push(e),e=e.parentNode;return r};n=Array.prototype.find?function(e,t){return e.find(t)}:function(e,t){return e.filter(t)[0]};var o=function(e,t){var r=e;return t.forEach((function(e){r=r&&r.children?n(r.children,(function(t){return t.domNode===e})):void 0})),r},s=function(e,t,r){var n=function(n){r("domEvent",n);var i=t(),s=a(n.currentTarget,i.domNode);s.reverse();var c,l=o(i.getLastRender(),s);return e.scheduleRender(),l&&(c=l.properties["on".concat(n.type)].apply(l.properties.bind||this,arguments)),r("domEventProcessed",n),c};return function(e,t,r,i){return n}},c=function(e){var t,r,n=Object(i.a)(e),a=n.performanceLogger,o=!0,c=!1,l=[],u=[],d=function(e,r,i){var o;n.eventHandlerInterceptor=s(t,(function(){return o}),a),o=e(r,i(),n),l.push(o),u.push(i)},h=function(){if(r=void 0,o){o=!1,a("renderStart",void 0);for(var e=0;e<l.length;e++){var t=u[e]();a("rendered",void 0),l[e].update(t),a("patched",void 0)}a("renderDone",void 0),o=!0}};return t={renderNow:h,scheduleRender:function(){r||c||(r=requestAnimationFrame(h))},stop:function(){r&&(cancelAnimationFrame(r),r=void 0),c=!0},resume:function(){c=!1,o=!0,t.scheduleRender()},append:function(e,t){d(i.b.append,e,t)},insertBefore:function(e,t){d(i.b.insertBefore,e,t)},merge:function(e,t){d(i.b.merge,e,t)},replace:function(e,t){d(i.b.replace,e,t)},detach:function(e){for(var t=0;t<u.length;t++)if(u[t]===e)return u.splice(t,1),l.splice(t,1)[0];throw new Error("renderFunction was not found")}}}},function(e,t,r){"use strict";r.d(t,"a",(function(){return i})),r.d(t,"b",(function(){return a}));var n=r(3);function i(e){return Object(n.i)(e)?e:e.slice()}function a(e){return[e,e]}},function(e,t,r){"use strict";r.d(t,"a",(function(){return de})),r.d(t,"b",(function(){return le})),r.d(t,"c",(function(){return ue}));var n,i,a,o,s,c,l,u,d,h,f,p,b,v,m,y,g,O,j,_,w,x,k,S,T,C,M,P,A,E,R,I,D,F,L,z=r(12),V=r(72),N=r(665),U=r(666),B=r(276),G=r(76),q=r(245),H=r(221),W=r(283),Q=r(145),Z=r(220),X=r(109),Y=r(120),$=r(564),J=r(474),K=r(565),ee=r(278),te=r(112),re=r(274),ne=r(667),ie=r(148),ae=r(426),oe=r(110),se=r(11),ce=r(87),le=new Map([["position",0],["normal",1],["normalCompressed",1],["color",2],["uv0",3],["uvRegion",4],["componentIndex",5]]);function ue(e){var t=new ce.a;t.include(Q.a,e),t.include(W.a,e),t.include(H.a,e),t.include(q.a,e),t.include(B.a,e),t.include(N.a,e),t.include(oe.a,e),t.include(G.a,e),t.include(ne.a,e),t.include(U.a,e),t.fragment.uniforms.add("view","mat4"),1!==e.pbrMode&&2!==e.pbrMode||(t.include(re.b,e),e.hasNormalTexture&&t.include(J.a,e)),3===e.output&&1===e.componentData?t.vertex.code.add(Object(se.a)(n||(n=Object(z.a)(["#define discardShadows(castShadows) { if(!castShadows) { gl_Position = vec4(1e38, 1e38, 1e38, 1.0); return; } }"])))):t.vertex.code.add(Object(se.a)(i||(i=Object(z.a)(["#define discardShadows(castShadows) {}"]))));var r=e.overlayEnabled&&0===e.output&&4===e.pbrMode;return e.overlayEnabled&&(t.include(ae.a,e),1===e.viewingMode?t.vertex.code.add(Object(se.a)(a||(a=Object(z.a)(["\n      const float invEllipsoidRadius = ",";\n      vec2 projectOverlay(vec3 pos) {\n        return pos.xy / (1.0 + invEllipsoidRadius * pos.z);\n      }\n      "])),se.a.float(1/(1===e.ellipsoidMode?V.a.radius:2===e.ellipsoidMode?V.b.radius:V.c.radius)))):t.vertex.code.add(Object(se.a)(o||(o=Object(z.a)(["vec2 projectOverlay(vec3 pos) { return pos.xy; }"]))))),r&&(t.varyings.add("tbnTangent","vec3"),t.varyings.add("tbnBiTangent","vec3"),t.varyings.add("groundNormal","vec3"),t.varyings.add("positionView","vec3")),t.vertex.code.add(Object(se.a)(s||(s=Object(z.a)(["\n    void main() {\n      bool castShadows;\n      vec4 externalColor = forwardExternalColor(castShadows);\n      discardShadows(castShadows);\n\n      vertexDiscardByOpacity(externalColor.a);\n\n      if (externalColor.a < ",") {\n        // Discard this vertex\n        gl_Position = vec4(1e38, 1e38, 1e38, 1.0);\n        return;\n      }\n      forwardPosition();\n      forwardNormal();\n      ","\n\n      ","\n      forwardTextureCoordinates();\n      forwardVertexColor();\n      forwardLinearDepth(); // depends on forwardPosition()\n    }\n  "])),se.a.float(oe.c),r?Object(se.a)(c||(c=Object(z.a)(["\n        positionView = position_view();\n        ","\n        "])),1===e.viewingMode?Object(se.a)(l||(l=Object(z.a)(["\n        groundNormal = normalize(positionWorld());\n        tbnTangent = normalize(cross(vec3(0.0, 0.0, 1.0), groundNormal));\n        tbnBiTangent = normalize(cross(groundNormal, tbnTangent));"]))):Object(se.a)(u||(u=Object(z.a)(["\n        groundNormal = vec3(0.0, 0.0, 1.0);\n        tbnTangent = vec3(1.0, 0.0, 0.0);\n        tbnBiTangent = normalize(cross(groundNormal, tbnTangent));"])))):"",e.overlayEnabled?Object(se.a)(d||(d=Object(z.a)(["setOverlayVTC(projectOverlay(position));"]))):"")),7===e.output&&(t.fragment.include(Y.a),e.multipassTerrainEnabled&&t.include(te.b,e),t.include($.a,e),t.fragment.code.add(Object(se.a)(h||(h=Object(z.a)(["\n      void main() {\n        discardBySlice(vPositionWorldCameraRelative);\n        ","\n\n        vec4 textureColor = readBaseColorTexture();\n        discardOrAdjustAlpha(textureColor);\n\n        vec4 externalColor;\n        int externalColorMixMode;\n        readExternalColor(externalColor, externalColorMixMode);\n\n        vec4 materialColor = computeMaterialColor(\n          textureColor,\n          externalColor,\n          externalColorMixMode\n        );\n        ","\n\n        gl_FragColor = vec4(materialColor.a);\n      }\n    "])),e.multipassTerrainEnabled?Object(se.a)(f||(f=Object(z.a)(["terrainDepthTest(gl_FragCoord, vPosition_view.z);"]))):"",e.overlayEnabled?Object(se.a)(p||(p=Object(z.a)(["\n        vec4 overlayColorOpaque = getOverlayColor(ovColorTex, vtcOverlay);\n        vec4 overlayColor = overlayOpacity * overlayColorOpaque;\n        materialColor = materialColor * (1.0 - overlayColor.a) + overlayColor;"]))):""))),0===e.output&&(t.fragment.include(Y.a),e.multipassTerrainEnabled&&t.include(te.b,e),t.include($.a,e),t.include(K.a,e),t.include(ee.a,e),r&&t.fragment.uniforms.add("ovNormalTex","sampler2D"),e.receiveShadows?(t.include(ie.a,e),t.fragment.code.add(Object(se.a)(b||(b=Object(z.a)(["float evaluateShadow() {\nreturn readShadowMap(vPositionWorldCameraRelative, linearDepth);\n}"]))))):t.fragment.code.add(Object(se.a)(v||(v=Object(z.a)(["float evaluateShadow() { return 0.0; }"])))),t.fragment.code.add(Object(se.a)(m||(m=Object(z.a)(["\n      void main() {\n        discardBySlice(vPositionWorldCameraRelative);\n        ","\n\n        vec4 textureColor = readBaseColorTexture();\n        discardOrAdjustAlpha(textureColor);\n\n        vec4 externalColor;\n        int externalColorMixMode;\n        readExternalColor(externalColor, externalColorMixMode);\n\n        vec4 materialColor = computeMaterialColor(\n          textureColor,\n          externalColor,\n          externalColorMixMode\n        );\n        ","\n    "])),e.multipassTerrainEnabled?Object(se.a)(y||(y=Object(z.a)(["terrainDepthTest(gl_FragCoord, vPosition_view.z);"]))):"",e.overlayEnabled?Object(se.a)(g||(g=Object(z.a)(["\n        vec4 overlayColorOpaque = getOverlayColor(ovColorTex, vtcOverlay);\n        vec4 overlayColor = overlayOpacity * overlayColorOpaque;\n        materialColor = materialColor * (1.0 - overlayColor.a) + overlayColor;"]))):"")),1===e.pbrMode||2===e.pbrMode?(t.fragment.code.add(Object(se.a)(O||(O=Object(z.a)(["\n        ","\n        vec3 normalVertex = shadingNormalWorld();\n        float additionalIrradiance = 0.02 * lightingMainIntensity[2];\n      "])),1===e.pbrMode?Object(se.a)(j||(j=Object(z.a)(["\n        applyPBRFactors();\n        if (int(externalColorMixMode) == 3) {\n          mrr = vec3(0.0, 0.6, 0.2);\n        }"]))):"")),e.hasNormalTexture?t.fragment.code.add(Object(se.a)(_||(_=Object(z.a)(["mat3 tangentSpace = computeTangentSpace(normalVertex, vPositionWorldCameraRelative, vuv0);\nvec3 shadingNormal = computeTextureNormal(tangentSpace, vuv0);"])))):t.fragment.code.add(Object(se.a)(w||(w=Object(z.a)(["vec3 shadingNormal = normalVertex;"])))),t.fragment.code.add(Object(se.a)(x||(x=Object(z.a)(["","\n      "])),1===e.viewingMode?Object(se.a)(k||(k=Object(z.a)(["vec3 normalGround = normalize(positionWorld());"]))):Object(se.a)(S||(S=Object(z.a)(["vec3 normalGround = vec3(0.0, 0.0, 1.0);"]))))),t.fragment.code.add(Object(se.a)(T||(T=Object(z.a)(["vec3 viewDir = normalize(vPositionWorldCameraRelative);\nfloat ssao = 1.0 - occlusion * (1.0 - evaluateAmbientOcclusion());\nvec3 additionalLight = evaluateAdditionalLighting(ssao, positionWorld());\nvec4 shadedColor = vec4(evaluateSceneLightingPBR(shadingNormal, materialColor.rgb, evaluateShadow(), ssao, additionalLight, viewDir, normalGround, mrr, emission, additionalIrradiance), materialColor.a);"]))))):(e.receiveShadows?t.fragment.code.add(Object(se.a)(C||(C=Object(z.a)(["float shadow = evaluateShadow();"])))):1===e.viewingMode?t.fragment.code.add(Object(se.a)(M||(M=Object(z.a)(["float additionalAmbientScale = additionalDirectedAmbientLight(positionWorld());\nfloat shadow = lightingGlobalFactor * (1.0 - additionalAmbientScale);"])))):t.fragment.code.add(Object(se.a)(P||(P=Object(z.a)(["float shadow = 0.0;"])))),t.fragment.code.add(Object(se.a)(A||(A=Object(z.a)(["\n      float ambientOcclusion = evaluateAmbientOcclusion();\n      // At global scale we create some additional ambient light based on the main light to simulate global illumination\n      vec3 additionalLight = evaluateAdditionalLighting(ambientOcclusion, positionWorld());\n      vec4 shadedColor = vec4(evaluateSceneLighting(shadingNormalWorld(), materialColor.rgb, shadow, ambientOcclusion, additionalLight), materialColor.a);\n      ","\n      "])),r?Object(se.a)(E||(E=Object(z.a)(["\n          vec4 overlayWaterMask = getOverlayColor(ovNormalTex, vtcOverlay);\n          float waterNormalLength = length(overlayWaterMask);\n          if (waterNormalLength > 0.95) {\n            mat3 tbnMatrix = mat3(tbnTangent, tbnBiTangent, groundNormal);\n            vec4 waterOverlayColor = vec4(overlayColorOpaque.xyz, overlayColor.w);\n            vec4 waterColorLinear = getOverlayWaterColor(overlayWaterMask, waterOverlayColor, -normalize(vPositionWorldCameraRelative), shadow, groundNormal, tbnMatrix, positionView);\n            vec4 waterColorNonLinear = delinearizeGamma(vec4(waterColorLinear.xyz, 1.0));\n            // un-gamma the ground color to mix in linear space\n            shadedColor = mix(shadedColor, waterColorNonLinear, waterColorLinear.w);\n          }"]))):""))),t.fragment.code.add(Object(se.a)(R||(R=Object(z.a)(["\n        gl_FragColor = highlightSlice(shadedColor, vPositionWorldCameraRelative);\n        ","\n      }\n    "])),e.OITEnabled?"gl_FragColor = premultiplyAlpha(gl_FragColor);":""))),1!==e.output&&3!==e.output||(t.include(Z.a,e),t.fragment.code.add(Object(se.a)(I||(I=Object(z.a)(["void main() {\ndiscardBySlice(vPositionWorldCameraRelative);\nvec4 textureColor = readBaseColorTexture();\ndiscardOrAdjustAlpha(textureColor);\noutputDepth(linearDepth);\n}"]))))),2===e.output&&(t.include(K.a,e),t.fragment.code.add(Object(se.a)(D||(D=Object(z.a)(["\n      void main() {\n        discardBySlice(vPositionWorldCameraRelative);\n\n        vec4 textureColor = readBaseColorTexture();\n        discardOrAdjustAlpha(textureColor);\n\n        // note: the alpha component needs to be 1.0 in order for this material\n        // to influence ambient occlusion, see the ssao fragment shader\n        float alpha = ",";\n        gl_FragColor = vec4(vec3(.5) + .5 * shadingNormal_view(), alpha);\n      }\n    "])),2===e.normalType?"0.0":"1.0"))),4===e.output&&(t.include(X.a),t.fragment.code.add(Object(se.a)(F||(F=Object(z.a)(["\n      void main() {\n        discardBySlice(vPositionWorldCameraRelative);\n\n        vec4 textureColor = readBaseColorTexture();\n        discardOrAdjustAlpha(textureColor);\n\n        ","\n\n        outputHighlight();\n      }\n    "])),e.overlayEnabled?Object(se.a)(L||(L=Object(z.a)(["\n        vec4 overlayColor = getCombinedOverlayColor();\n\n        if (overlayColor.a == 0.0) {\n          gl_FragColor = vec4(0.0);\n          return;\n        }"]))):""))),t}var de=Object.freeze({__proto__:null,attributeLocations:le,build:ue})},function(e,t,r){"use strict";r.d(t,"a",(function(){return _})),r.d(t,"b",(function(){return j})),r.d(t,"c",(function(){return g}));var n,i,a,o,s,c,l,u,d=r(12),h=r(277),f=r(120),p=r(148),b=r(379),v=r(194),m=r(11),y=r(87),g=255,O=1/g;function j(e){var t=new y.a;t.fragment.include(v.a),t.fragment.include(f.a),t.include(b.a),t.include(h.a);var r=e.pass;if(1===r){var j=e.visualization,_=e.bandsEnabled;t.fragment.constants.add("inverseSampleValue","float",g),t.fragment.uniforms.add("shadowAccumulationMap","sampler2D"),t.fragment.uniforms.add("sampleScale","float"),t.fragment.uniforms.add("opacityFromElevation","float"),0===j?(t.fragment.uniforms.add("colorRamp","sampler2D"),t.fragment.uniforms.add("rampSize","float"),t.fragment.code.add(Object(m.a)(n||(n=Object(d.a)(["vec4 sampleColorRamp(sampler2D ramp, float rampSize, float u) {\nfloat rampU = (u * (rampSize - 1.0) + 0.5) / rampSize;\nreturn texture2D(ramp, vec2(rampU, 0.5));\n}"])))),_&&t.fragment.uniforms.add("bandSize","float")):1===j&&(t.fragment.uniforms.add("threshold","float"),t.fragment.uniforms.add("colors","vec4",2)),t.fragment.code.add(Object(m.a)(i||(i=Object(d.a)(["\n      void main(void) {\n        vec4 record = texture2D(shadowAccumulationMap, uv);\n        float pixelSamples = record.r * inverseSampleValue;\n\n        if (pixelSamples < 1.0) {\n          discard;\n        }\n\n        float strength = pixelSamples * sampleScale;\n\n        ","\n\n        gl_FragColor = ",";\n\n        gl_FragColor.a *= opacityFromElevation;\n      }\n    "])),0===j&&_?Object(m.a)(a||(a=Object(d.a)(["strength = ceil(strength / bandSize) * bandSize;"]))):"",0===j?Object(m.a)(o||(o=Object(d.a)(["sampleColorRamp(colorRamp, rampSize, strength)"]))):Object(m.a)(s||(s=Object(d.a)(["strength <= threshold ? colors[0] : colors[1]"])))))}else 0!==r&&2!==r||(t.include(p.a),t.fragment.uniforms.add("depthMap","sampler2D"),t.fragment.uniforms.add("inverseView","mat4"),t.fragment.uniforms.add("nearFar","vec2"),0===r?t.fragment.constants.add("sampleValue","float",O):t.fragment.constants.add("shadowColor","vec4",[0,0,0,.8]),t.fragment.code.add(Object(m.a)(c||(c=Object(d.a)(["\n      void main(void) {\n\n        float depth = rgba2float(texture2D(depthMap, uv));\n        // 0.0 is the clear value of depthMap, which means nothing has been drawn there and we should discard\n        if (depth == 0.0) {\n          discard;\n        }\n\n        float currentPixelDepth = linearDepthFromFloat(depth, nearFar);\n\n        if (-currentPixelDepth > nearFar.y || -currentPixelDepth < nearFar.x) {\n          discard;\n        }\n\n        vec4 currentPixelPos = vec4(reconstructPosition(gl_FragCoord.xy, currentPixelDepth), 1.0);\n        vec4 worldSpacePos = inverseView * currentPixelPos;\n\n        mat4 shadowMatrix;\n        float linearDepth = -currentPixelDepth;\n        int i = chooseCascade(linearDepth, shadowMatrix);\n\n        if (i >= uShadowMapNum) {\n          discard;\n        }\n\n        vec3 lvpos = lightSpacePosition(worldSpacePos.xyz, shadowMatrix);\n\n        // vertex completely outside? -> no shadow\n        if (lvpos.z >= 1.0 || lvpos.x < 0.0 || lvpos.x > 1.0 || lvpos.y < 0.0 || lvpos.y > 1.0) {\n          discard;\n        }\n\n        vec2 uvShadow = cascadeCoordinates(i, lvpos);\n\n        float depthShadow = readShadowMapDepth(uvShadow, uShadowMapTex);\n        bool shadow = depthShadow < lvpos.z;\n\n        if (!shadow) {\n          discard;\n        }\n\n        gl_FragColor = ",";\n      }\n    "])),0===r?Object(m.a)(l||(l=Object(d.a)(["vec4(sampleValue)"]))):Object(m.a)(u||(u=Object(d.a)(["shadowColor"]))))));return t}var _=Object.freeze({__proto__:null,shadowAccumulationMaxSamples:g,build:j})},function(e,t,r){"use strict";var n=r(2),i=r(5),a=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;Object(n.a)(this,e),this._seed=t}return Object(i.a)(e,[{key:"seed",set:function(t){this._seed=null==t?Math.random()*e._m:t}},{key:"getInt",value:function(){return this._seed=(e._a*this._seed+e._c)%e._m,this._seed}},{key:"getFloat",value:function(){return this.getInt()/(e._m-1)}},{key:"getIntRange",value:function(e,t){return Math.round(this.getFloatRange(e,t))}},{key:"getFloatRange",value:function(t,r){var n=r-t;return t+this.getInt()/e._m*n}}]),e}();a._m=2147483647,a._a=48271,a._c=0,t.a=a},function(e,t,r){"use strict";r.d(t,"a",(function(){return a})),r.d(t,"b",(function(){return i}));var n=r(69);function i(e,t){var r=t||e.extent,i=e.width,a=Object(n.f)(r&&r.spatialReference);return r&&i?r.width/i*a*n.j*96:0}function a(e,t){return e/(Object(n.f)(t)*n.j*96)}},function(e,t,r){"use strict";var n=r(2),i=r(5),a=r(6),o=r(7),s=r(3),c=function(e){Object(a.a)(r,e);var t=Object(o.a)(r);function r(e){var i;return Object(n.a)(this,r),(i=t.call(this,e))._textureIDs=new Set,i._textureRepository=e.textureRep,i._textureId=e.textureId,i._initTransparent=!!e.initTextureTransparent,i._texture=i._acquire(i._textureId),i._textureNormal=i._acquire(e.normalTextureId),i._textureEmissive=i._acquire(e.emissiveTextureId),i._textureOcclusion=i._acquire(e.occlusionTextureId),i._textureMetallicRoughness=i._acquire(e.metallicRoughnessTextureId),i}return Object(i.a)(r,[{key:"dispose",value:function(){var e=this;this._textureIDs.forEach((function(t){return e._textureRepository.release(t)})),this._textureIDs.clear()}},{key:"updateTexture",value:function(e){e!==this._textureId&&(this._release(this._textureId),this._textureId=e,this._texture=this._acquire(this._textureId))}},{key:"bindTextures",value:function(e){Object(s.j)(this._texture)&&e.bindTexture(this._texture.glTexture,"tex"),Object(s.j)(this._textureNormal)&&e.bindTexture(this._textureNormal.glTexture,"normalTexture"),Object(s.j)(this._textureEmissive)&&e.bindTexture(this._textureEmissive.glTexture,"texEmission"),Object(s.j)(this._textureOcclusion)&&e.bindTexture(this._textureOcclusion.glTexture,"texOcclusion"),Object(s.j)(this._textureMetallicRoughness)&&e.bindTexture(this._textureMetallicRoughness.glTexture,"texMetallicRoughness")}},{key:"bindTextureScale",value:function(e){var t=Object(s.j)(this._texture)&&this._texture.glTexture;t&&t.descriptor.textureCoordinateScaleFactor?e.setUniform2fv("textureCoordinateScaleFactor",t.descriptor.textureCoordinateScaleFactor):e.setUniform2f("textureCoordinateScaleFactor",1,1)}},{key:"_acquire",value:function(e){if(!Object(s.i)(e))return this._textureIDs.add(e),this._textureRepository.acquire(e,this._initTransparent)}},{key:"_release",value:function(e){Object(s.i)(e)||(this._textureIDs.delete(e),this._textureRepository.release(e))}}]),r}(r(195).a);t.a=c},function(e,t,r){"use strict";r.d(t,"a",(function(){return l}));var n,i,a,o,s=r(12),c=r(11);function l(e,t){e.constants.add("stippleAlphaColorDiscard","float",.001),e.constants.add("stippleAlphaHighlightDiscard","float",.5),t.stippleEnabled?function(e,t){e.vertex.uniforms.add("stipplePatternPixelSizeInv","float"),t.stippleUVMaxEnabled&&e.varyings.add("stipplePatternUvMax","float"),e.varyings.add("stipplePatternUv","float"),e.fragment.uniforms.add("stipplePatternTexture","sampler2D"),t.stippleOffColorEnabled&&e.fragment.uniforms.add("stippleOffColor","vec4"),e.fragment.code.add(Object(c.a)(n||(n=Object(s.a)(["\n  float getStippleAlpha() {\n    float stipplePatternUvClamped = stipplePatternUv * gl_FragCoord.w;\n    ","\n\n    return texture2D(stipplePatternTexture, vec2(mod(stipplePatternUvClamped, 1.0), 0.5)).a;\n  }"])),t.stippleUVMaxEnabled?"stipplePatternUvClamped = clamp(stipplePatternUvClamped, 0.0, stipplePatternUvMax);":"")),t.stippleOffColorEnabled?e.fragment.code.add(Object(c.a)(i||(i=Object(s.a)(["#define discardByStippleAlpha(stippleAlpha, threshold) {}\n#define blendStipple(color, stippleAlpha) mix(color, stippleOffColor, stippleAlpha)"])))):e.fragment.code.add(Object(c.a)(a||(a=Object(s.a)(["#define discardByStippleAlpha(stippleAlpha, threshold) if (stippleAlpha < threshold) { discard; }\n#define blendStipple(color, stippleAlpha) vec4(color.rgb, color.a * stippleAlpha)"]))))}(e,t):function(e){e.fragment.code.add(Object(c.a)(o||(o=Object(s.a)(["float getStippleAlpha() { return 1.0; }\n#define discardByStippleAlpha(_stippleAlpha_, _threshold_) {}\n#define blendStipple(color, _stippleAlpha_) color"]))))}(e)}},function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n,i=r(12),a=r(11);function o(e){e.vertex.code.add(Object(a.a)(n||(n=Object(i.a)(["vec4 offsetBackfacingClipPosition(vec4 posClip, vec3 posWorld, vec3 normalWorld, vec3 camPosWorld) {\nvec3 camToVert = posWorld - camPosWorld;\nbool isBackface = dot(camToVert, normalWorld) > 0.0;\nif (isBackface) {\nposClip.z += 0.0000003 * posClip.w;\n}\nreturn posClip;\n}"]))))}},function(e,t,r){"use strict";r.d(t,"a",(function(){return c}));var n,i,a=r(12),o=r(533),s=r(11);function c(e,t){t.symbolColor?(e.include(o.a),e.attributes.add("symbolColor","vec4"),e.varyings.add("colorMixMode","mediump float")):e.fragment.uniforms.add("colorMixMode","int"),t.symbolColor?e.vertex.code.add(Object(s.a)(n||(n=Object(a.a)(["int symbolColorMixMode;\nvec4 getSymbolColor() {\nreturn decodeSymbolColor(symbolColor, symbolColorMixMode) * 0.003921568627451;\n}\nvoid forwardColorMixMode() {\ncolorMixMode = float(symbolColorMixMode) + 0.5;\n}"])))):e.vertex.code.add(Object(s.a)(i||(i=Object(a.a)(["vec4 getSymbolColor() { return vec4(1.0); }\nvoid forwardColorMixMode() {}"]))))}},function(e,t,r){"use strict";r.d(t,"a",(function(){return S}));var n,i,a,o,s,c,l,u,d,h,f,p,b=r(12),v=r(76),m=r(132),y=r(321),g=r(245),O=r(283),j=r(220),_=r(109),w=r(197),x=r(110),k=r(11);function S(e,t){var r=e.vertex.code,S=e.fragment.code;1!==t.output&&3!==t.output||(e.include(m.a,{linearDepth:!0}),e.include(g.a,t),e.include(w.a,t),e.include(j.a,t),e.include(v.a,t),e.vertex.uniforms.add("cameraNearFar","vec2"),e.varyings.add("depth","float"),t.hasColorTexture&&e.fragment.uniforms.add("tex","sampler2D"),r.add(Object(k.a)(n||(n=Object(b.a)(["void main(void) {\nvpos = calculateVPos();\nvpos = subtractOrigin(vpos);\nvpos = addVerticalOffset(vpos, localOrigin);\ngl_Position = transformPositionWithDepth(proj, view, vpos, cameraNearFar, depth);\nforwardTextureCoordinates();\n}"])))),e.include(x.a,t),S.add(Object(k.a)(i||(i=Object(b.a)(["\n      void main(void) {\n        discardBySlice(vpos);\n        ","\n        outputDepth(depth);\n      }\n    "])),t.hasColorTexture?Object(k.a)(a||(a=Object(b.a)(["\n        vec4 texColor = texture2D(tex, vuv0);\n        discardOrAdjustAlpha(texColor);"]))):""))),2===t.output&&(e.include(m.a,{linearDepth:!1}),e.include(y.a,t),e.include(O.a,t),e.include(g.a,t),e.include(w.a,t),t.hasColorTexture&&e.fragment.uniforms.add("tex","sampler2D"),e.vertex.uniforms.add("viewNormal","mat4"),e.varyings.add("vPositionView","vec3"),r.add(Object(k.a)(o||(o=Object(b.a)(["\n      void main(void) {\n        vpos = calculateVPos();\n        vpos = subtractOrigin(vpos);\n        ","\n        vpos = addVerticalOffset(vpos, localOrigin);\n        gl_Position = transformPosition(proj, view, vpos);\n        forwardTextureCoordinates();\n      }\n    "])),0===t.normalType?Object(k.a)(s||(s=Object(b.a)(["\n        vNormalWorld = dpNormalView(vvLocalNormal(normalModel()));"]))):"")),e.include(v.a,t),e.include(x.a,t),S.add(Object(k.a)(c||(c=Object(b.a)(["\n      void main() {\n        discardBySlice(vpos);\n        ","\n\n        ","\n        gl_FragColor = vec4(vec3(0.5) + 0.5 * normal, 1.0);\n      }\n    "])),t.hasColorTexture?Object(k.a)(l||(l=Object(b.a)(["\n        vec4 texColor = texture2D(tex, vuv0);\n        discardOrAdjustAlpha(texColor);"]))):"",3===t.normalType?Object(k.a)(u||(u=Object(b.a)(["\n            vec3 normal = screenDerivativeNormal(vPositionView);"]))):Object(k.a)(d||(d=Object(b.a)(["\n            vec3 normal = normalize(vNormalWorld);\n            if (gl_FrontFacing == false) normal = -normal;"])))))),4===t.output&&(e.include(m.a,{linearDepth:!1}),e.include(g.a,t),e.include(w.a,t),t.hasColorTexture&&e.fragment.uniforms.add("tex","sampler2D"),r.add(Object(k.a)(h||(h=Object(b.a)(["void main(void) {\nvpos = calculateVPos();\nvpos = subtractOrigin(vpos);\nvpos = addVerticalOffset(vpos, localOrigin);\ngl_Position = transformPosition(proj, view, vpos);\nforwardTextureCoordinates();\n}"])))),e.include(v.a,t),e.include(x.a,t),e.include(_.a),S.add(Object(k.a)(f||(f=Object(b.a)(["\n      void main() {\n        discardBySlice(vpos);\n        ","\n        outputHighlight();\n      }\n    "])),t.hasColorTexture?Object(k.a)(p||(p=Object(b.a)(["\n        vec4 texColor = texture2D(tex, vuv0);\n        discardOrAdjustAlpha(texColor);"]))):"")))}},function(e,t,r){"use strict";r.d(t,"a",(function(){return u}));var n,i,a,o,s=r(12),c=r(399),l=r(11);function u(e,t){var r=e.fragment;t.vertexTangents?(e.attributes.add("tangent","vec4"),e.varyings.add("vTangent","vec4"),2===t.doubleSidedMode?r.code.add(Object(l.a)(n||(n=Object(s.a)(["mat3 computeTangentSpace(vec3 normal) {\nfloat tangentHeadedness = gl_FrontFacing ? vTangent.w : -vTangent.w;\nvec3 tangent = normalize(gl_FrontFacing ? vTangent.xyz : -vTangent.xyz);\nvec3 bitangent = cross(normal, tangent) * tangentHeadedness;\nreturn mat3(tangent, bitangent, normal);\n}"])))):r.code.add(Object(l.a)(i||(i=Object(s.a)(["mat3 computeTangentSpace(vec3 normal) {\nfloat tangentHeadedness = vTangent.w;\nvec3 tangent = normalize(vTangent.xyz);\nvec3 bitangent = cross(normal, tangent) * tangentHeadedness;\nreturn mat3(tangent, bitangent, normal);\n}"]))))):(e.extensions.add("GL_OES_standard_derivatives"),r.code.add(Object(l.a)(a||(a=Object(s.a)(["mat3 computeTangentSpace(vec3 normal, vec3 pos, vec2 st) {\nvec3 Q1 = dFdx(pos);\nvec3 Q2 = dFdy(pos);\nvec2 stx = dFdx(st);\nvec2 sty = dFdy(st);\nfloat det = stx.t * sty.s - sty.t * stx.s;\nvec3 T = stx.t * Q2 - sty.t * Q1;\nT = T - normal * dot(normal, T);\nT *= inversesqrt(max(dot(T,T), 1.e-10));\nvec3 B = sign(det) * cross(normal, T);\nreturn mat3(T, B, normal);\n}"]))))),0!==t.attributeTextureCoordinates&&(e.include(c.a,t),r.uniforms.add("normalTexture","sampler2D"),r.uniforms.add("normalTextureSize","vec2"),r.code.add(Object(l.a)(o||(o=Object(s.a)(["\n    vec3 computeTextureNormal(mat3 tangentSpace, vec2 uv) {\n      vtc.uv = uv;\n      ","\n      vec3 rawNormal = textureLookup(normalTexture, vtc).rgb * 2.0 - 1.0;\n      return tangentSpace * rawNormal;\n    }\n  "])),t.supportsTextureAtlas?"vtc.size = normalTextureSize;":"")))}},function(e,t,r){"use strict";r.d(t,"a",(function(){return l}));var n,i,a,o,s=r(12),c=r(11);function l(e,t){var r=e.fragment;r.code.add(Object(c.a)(n||(n=Object(s.a)(["struct ShadingNormalParameters {\nvec3 normalView;\nvec3 viewDirection;\n} shadingParams;"])))),1===t.doubleSidedMode?r.code.add(Object(c.a)(i||(i=Object(s.a)(["vec3 shadingNormal(ShadingNormalParameters params) {\nreturn dot(params.normalView, params.viewDirection) > 0.0 ? normalize(-params.normalView) : normalize(params.normalView);\n}"])))):2===t.doubleSidedMode?r.code.add(Object(c.a)(a||(a=Object(s.a)(["vec3 shadingNormal(ShadingNormalParameters params) {\nreturn gl_FrontFacing ? normalize(params.normalView) : normalize(-params.normalView);\n}"])))):r.code.add(Object(c.a)(o||(o=Object(s.a)(["vec3 shadingNormal(ShadingNormalParameters params) {\nreturn normalize(params.normalView);\n}"]))))}},function(e,t,r){"use strict";r.d(t,"a",(function(){return s}));var n,i=r(12),a=r(11),o=r(159);function s(e,t){var r=Object(a.a)(n||(n=Object(i.a)(["\n  /*\n  *  ","\n  *  ","\n  */\n  "])),t.name,0===t.output?"RenderOutput: Color":1===t.output?"RenderOutput: Depth":3===t.output?"RenderOutput: Shadow":2===t.output?"RenderOutput: Normal":4===t.output?"RenderOutput: Highlight":"");Object(o.c)()&&(e.fragment.code.add(r),e.vertex.code.add(r))}},function(e,t,r){"use strict";r.d(t,"a",(function(){return i})),r.d(t,"b",(function(){return a})),r.d(t,"c",(function(){return o}));var n=r(43),i=1.2,a=n.b,o=n.a},function(e,t,r){"use strict";var n,i=r(14),a=r(2),o=r(5),s=r(45),c=r(42),l=r(6),u=r(7),d=r(0),h=r(49),f=r(3),p=r(1),b=(r(17),r(18),r(15),r(10)),v=r(442),m=r(361),y=n=function(e){Object(l.a)(r,e);var t=Object(u.a)(r);function r(e){var n;return Object(a.a)(this,r),(n=t.call(this,e)).emissiveColor=null,n.emissiveTexture=null,n.occlusionTexture=null,n.metallic=1,n.roughness=1,n.metallicRoughnessTexture=null,n}return Object(o.a)(r,[{key:"clone",value:function(){return this.cloneWithDeduplication(null,new Map)}},{key:"cloneWithDeduplication",value:function(e,t){var r=Object(f.j)(e)?e.get(this):null;if(r)return r;var i=new n(this.clonePropertiesWithDeduplication(t));return Object(f.j)(e)&&e.set(this,i),i}},{key:"clonePropertiesWithDeduplication",value:function(e){return Object(i.a)(Object(i.a)({},Object(s.a)(Object(c.a)(r.prototype),"clonePropertiesWithDeduplication",this).call(this,e)),{},{emissiveColor:Object(f.j)(this.emissiveColor)?this.emissiveColor.clone():null,emissiveTexture:Object(f.j)(this.emissiveTexture)?this.emissiveTexture.cloneWithDeduplication(e):null,occlusionTexture:Object(f.j)(this.occlusionTexture)?this.occlusionTexture.cloneWithDeduplication(e):null,metallic:this.metallic,roughness:this.roughness,metallicRoughnessTexture:Object(f.j)(this.metallicRoughnessTexture)?this.metallicRoughnessTexture.cloneWithDeduplication(e):null})}}]),r}(v.a);Object(d.a)([Object(p.b)({type:h.a,json:{write:!0}})],y.prototype,"emissiveColor",void 0),Object(d.a)([Object(p.b)({type:m.a,json:{write:!0}})],y.prototype,"emissiveTexture",void 0),Object(d.a)([Object(p.b)({type:m.a,json:{write:!0}})],y.prototype,"occlusionTexture",void 0),Object(d.a)([Object(p.b)({type:Number,nonNullable:!0,json:{write:!0},range:{min:0,max:1}})],y.prototype,"metallic",void 0),Object(d.a)([Object(p.b)({type:Number,nonNullable:!0,json:{write:!0},range:{min:0,max:1}})],y.prototype,"roughness",void 0),Object(d.a)([Object(p.b)({type:m.a,json:{write:!0}})],y.prototype,"metallicRoughnessTexture",void 0);var g=y=n=Object(d.a)([Object(b.a)("esri.geometry.support.MeshMaterialMetallicRoughness")],y);t.a=g},function(e,t,r){"use strict";r.d(t,"a",(function(){return o})),r.d(t,"b",(function(){return a}));var n=r(335);function i(e,t,r){for(var n=e.typedBuffer,i=e.typedBufferStride,a=t.typedBuffer,o=t.typedBufferStride,s=r?r.count:t.count,c=(r&&r.dstIndex?r.dstIndex:0)*i,l=(r&&r.srcIndex?r.srcIndex:0)*o,u=0;u<s;++u)n[c]=a[l],n[c+1]=a[l+1],c+=i,l+=o}function a(e,t,r){var a=e.typedBuffer,o=e.typedBufferStride,s=t.typedBuffer,c=t.typedBufferStride,l=r?r.count:t.count,u=(r&&r.dstIndex?r.dstIndex:0)*o,d=(r&&r.srcIndex?r.srcIndex:0)*c;if(Object(n.b)(t.elementType)){var h=Object(n.d)(t.elementType);if(Object(n.c)(t.elementType))for(var f=0;f<l;++f)a[u]=Math.max(s[d]/h,-1),a[u+1]=Math.max(s[d+1]/h,-1),u+=o,d+=c;else for(var p=0;p<l;++p)a[u]=s[d]/h,a[u+1]=s[d+1]/h,u+=o,d+=c}else i(e,t,r);return e}function o(e,t,r,n){for(var i,a,o=e.typedBuffer,s=e.typedBufferStride,c=null!=(i=null==n?void 0:n.count)?i:e.count,l=(null!=(a=null==n?void 0:n.dstIndex)?a:0)*s,u=0;u<c;++u)o[l]=t,o[l+1]=r,l+=s}Object.freeze({__proto__:null,copy:i,normalizeIntegerBuffer:a,fill:o})},function(e,t,r){"use strict";var n,i=r(2),a=r(5),o=r(6),s=r(7),c=r(0),l=r(272),u=r(98),d=r(27),h=r(25),f=r(28),p=r(1),b=(r(18),r(17),r(15),r(10)),v=n=function(e){Object(o.a)(r,e);var t=Object(s.a)(r);function r(){var e;return Object(i.a)(this,r),(e=t.apply(this,arguments)).statisticType=null,e.onStatisticField=null,e.onStatisticValueExpression=null,e}return Object(a.a)(r,[{key:"clone",value:function(){return new n({statisticType:this.statisticType,onStatisticField:this.onStatisticField,onStatisticValueExpression:this.onStatisticValueExpression})}}]),r}(d.a);Object(c.a)([Object(p.b)({type:String,json:{write:!0}})],v.prototype,"statisticType",void 0),Object(c.a)([Object(p.b)({type:String,json:{write:!0}})],v.prototype,"onStatisticField",void 0),Object(c.a)([Object(p.b)({type:String,json:{write:!0}})],v.prototype,"onStatisticValueExpression",void 0);var m,y=v=n=Object(c.a)([Object(b.a)("esri.layers.support.OutStatistic")],v),g=m=function(e){Object(o.a)(r,e);var t=Object(s.a)(r);function r(){var e;return Object(i.a)(this,r),(e=t.apply(this,arguments)).name=null,e}return Object(a.a)(r,[{key:"clone",value:function(){return new m({name:this.name,outStatistic:this.outStatistic.clone()})}}]),r}(d.a);Object(c.a)([Object(p.b)({type:String,json:{write:!0}})],g.prototype,"name",void 0),Object(c.a)([Object(p.b)({type:y,json:{write:!0}})],g.prototype,"outStatistic",void 0);var O,j=g=m=Object(c.a)([Object(b.a)("esri.layers.support.AggregateField")],g),_=r(188),w=r(373),x=O=function(e){Object(o.a)(r,e);var t=Object(s.a)(r);function r(e){var n;return Object(i.a)(this,r),(n=t.call(this,e)).type="cluster",n.clusterRadius=Object(f.j)("80px"),n.clusterMinSize=Object(f.j)("12px"),n.clusterMaxSize=Object(f.j)("50px"),n.popupEnabled=!0,n.popupTemplate=null,n.symbol=null,n.labelingInfo=null,n.labelsVisible=!0,n.fields=null,n}return Object(a.a)(r,[{key:"clone",value:function(){return new O({clusterRadius:this.clusterRadius,clusterMinSize:this.clusterMinSize,clusterMaxSize:this.clusterMaxSize,labelingInfo:Object(h.a)(this.labelingInfo),labelsVisible:this.labelsVisible,fields:Object(h.a)(this.fields),popupEnabled:this.popupEnabled,popupTemplate:Object(h.a)(this.popupTemplate)})}}]),r}(d.a);Object(c.a)([Object(p.b)({type:["cluster"],readOnly:!0,json:{write:!0}})],x.prototype,"type",void 0),Object(c.a)([Object(p.b)({type:Number,cast:function(e){return"auto"===e?e:Object(f.j)(e)},json:{write:!0}})],x.prototype,"clusterRadius",void 0),Object(c.a)([Object(p.b)({type:Number,cast:f.j,json:{write:!0}})],x.prototype,"clusterMinSize",void 0),Object(c.a)([Object(p.b)({type:Number,cast:f.j,json:{write:!0}})],x.prototype,"clusterMaxSize",void 0),Object(c.a)([Object(p.b)(_.j)],x.prototype,"popupEnabled",void 0),Object(c.a)([Object(p.b)({type:l.a,json:{read:{source:"popupInfo"},write:{target:"popupInfo"}}})],x.prototype,"popupTemplate",void 0),Object(c.a)([Object(p.b)({types:u.f})],x.prototype,"symbol",void 0),Object(c.a)([Object(p.b)({type:[w.a],json:{read:{source:"drawingInfo.labelingInfo"},write:{target:"drawingInfo.labelingInfo"}}})],x.prototype,"labelingInfo",void 0),Object(c.a)([Object(p.b)(_.d)],x.prototype,"labelsVisible",void 0),Object(c.a)([Object(p.b)({type:[j],json:{write:!0}})],x.prototype,"fields",void 0);var k=x=O=Object(c.a)([Object(b.a)("esri.layers.support.FeatureReductionCluster")],x);t.a=k},function(e,t,r){"use strict";var n,i={values:[1,.3048,.3048006096012192,.3047972654,.9143917962,.201166195164,.9143984146160287,.3047994715386762,20.11676512155263,20.11678249437587,.9143985307444408,.91439523,.3047997101815088,20.116756,5e4,15e4],units:["Meter","Foot","Foot_US","Foot_Clarke","Yard_Clarke","Link_Clarke","Yard_Sears","Foot_Sears","Chain_Sears","Chain_Benoit_1895_B","Yard_Indian","Yard_Indian_1937","Foot_Gold_Coast","Chain_Sears_1922_Truncated","50_Kilometers","150_Kilometers"],2066:5,2136:12,2155:2,2157:0,2158:0,2159:12,2160:12,2204:2,2219:0,2220:0,2254:2,2255:2,2256:1,2265:1,2266:1,2267:2,2268:2,2269:1,2270:1,2271:2,2272:2,2273:1,2294:0,2295:0,2314:3,2899:2,2900:2,2901:1,2909:1,2910:1,2911:2,2912:2,2913:1,2914:1,2992:1,2993:0,2994:1,3080:1,3089:2,3090:0,3091:2,3102:2,3141:0,3142:0,3167:13,3359:2,3360:0,3361:1,3362:0,3363:2,3364:0,3365:2,3366:3,3404:2,3405:0,3406:0,3407:3,3439:0,3440:0,3479:1,3480:0,3481:1,3482:0,3483:1,3484:0,3485:2,3486:0,3487:2,3488:0,3489:0,3490:2,3491:0,3492:2,3493:0,3494:2,3495:0,3496:2,3497:0,3498:2,3499:0,3500:2,3501:0,3502:2,3503:0,3504:2,3505:0,3506:2,3507:0,3508:2,3509:0,3510:2,3511:0,3512:2,3513:0,3514:0,3515:2,3516:0,3517:2,3518:0,3519:2,3520:0,3521:2,3522:0,3523:2,3524:0,3525:2,3526:0,3527:2,3528:0,3529:2,3530:0,3531:2,3532:0,3533:2,3534:0,3535:2,3536:0,3537:2,3538:0,3539:2,3540:0,3541:2,3542:0,3543:2,3544:0,3545:2,3546:0,3547:2,3548:0,3549:2,3550:0,3551:2,3552:0,3553:2,3582:2,3583:0,3584:2,3585:0,3586:2,3587:0,3588:1,3589:0,3590:1,3591:0,3592:0,3593:1,3598:2,3599:0,3600:2,3605:1,3606:0,3607:0,3608:2,3609:0,3610:2,3611:0,3612:2,3613:0,3614:2,3615:0,3616:2,3617:0,3618:2,3619:0,3620:2,3621:0,3622:2,3623:0,3624:2,3625:0,3626:2,3627:0,3628:2,3629:0,3630:2,3631:0,3632:2,3633:0,3634:1,3635:0,3636:1,3640:2,3641:0,3642:2,3643:0,3644:1,3645:0,3646:1,3647:0,3648:1,3649:0,3650:2,3651:0,3652:2,3653:0,3654:2,3655:0,3656:1,3657:0,3658:2,3659:0,3660:2,3661:0,3662:2,3663:0,3664:2,3668:2,3669:0,3670:2,3671:0,3672:2,3673:0,3674:2,3675:0,3676:1,3677:2,3678:0,3679:1,3680:2,3681:0,3682:1,3683:2,3684:0,3685:0,3686:2,3687:0,3688:2,3689:0,3690:2,3691:0,3692:2,3696:2,3697:0,3698:2,3699:0,3700:2,3793:0,3794:0,3812:0,3854:0,3857:0,3920:0,3978:0,3979:0,3991:2,3992:2,4026:0,4037:0,4038:0,4071:0,4082:0,4083:0,4087:0,4088:0,4217:2,4414:0,4415:0,4417:0,4434:0,4437:0,4438:2,4439:2,4462:0,4467:0,4471:0,4474:0,4559:0,4647:0,4822:0,4826:0,4839:0,5018:0,5048:0,5167:0,5168:0,5221:0,5223:0,5234:0,5235:0,5243:0,5247:0,5266:0,5316:0,5320:0,5321:0,5325:0,5337:0,5361:0,5362:0,5367:0,5382:0,5383:0,5396:0,5456:0,5457:0,5469:0,5472:4,5490:0,5513:0,5514:0,5523:0,5559:0,5588:1,5589:3,5596:0,5627:0,5629:0,5641:0,5643:0,5644:0,5646:2,5654:2,5655:2,5659:0,5700:0,5825:0,5836:0,5837:0,5839:0,5842:0,5844:0,5858:0,5879:0,5880:0,5887:0,5890:0,6128:1,6129:1,6141:1,6204:0,6210:0,6211:0,6307:0,6312:0,6316:0,6362:0,6391:1,6405:1,6406:0,6407:1,6408:0,6409:1,6410:0,6411:2,6412:0,6413:2,6414:0,6415:0,6416:2,6417:0,6418:2,6419:0,6420:2,6421:0,6422:2,6423:0,6424:2,6425:0,6426:2,6427:0,6428:2,6429:0,6430:2,6431:0,6432:2,6433:0,6434:2,6435:0,6436:2,6437:0,6438:2,6439:0,6440:0,6441:2,6442:0,6443:2,6444:0,6445:2,6446:0,6447:2,6448:0,6449:2,6450:0,6451:2,6452:0,6453:2,6454:0,6455:2,6456:0,6457:2,6458:0,6459:2,6460:0,6461:2,6462:0,6463:2,6464:0,6465:2,6466:0,6467:2,6468:0,6469:2,6470:0,6471:2,6472:0,6473:2,6474:0,6475:2,6476:0,6477:2,6478:0,6479:2,6484:2,6485:0,6486:2,6487:0,6488:2,6489:0,6490:2,6491:0,6492:2,6493:0,6494:1,6495:0,6496:1,6497:0,6498:0,6499:1,6500:0,6501:2,6502:0,6503:2,6504:0,6505:2,6506:0,6507:2,6508:0,6509:0,6510:2,6515:1,6516:0,6518:0,6519:2,6520:0,6521:2,6522:0,6523:2,6524:0,6525:2,6526:0,6527:2,6528:0,6529:2,6530:0,6531:2,6532:0,6533:2,6534:0,6535:2,6536:0,6537:2,6538:0,6539:2,6540:0,6541:2,6542:0,6543:2,6544:0,6545:1,6546:0,6547:1,6548:0,6549:2,6550:0,6551:2,6552:0,6553:2,6554:0,6555:2,6556:0,6557:1,6558:0,6559:1,6560:0,6561:1,6562:0,6563:2,6564:0,6565:2,6566:0,6567:0,6568:2,6569:0,6570:1,6571:0,6572:2,6573:0,6574:2,6575:0,6576:2,6577:0,6578:2,6582:2,6583:0,6584:2,6585:0,6586:2,6587:0,6588:2,6589:0,6590:2,6591:0,6592:0,6593:2,6594:0,6595:2,6596:0,6597:2,6598:0,6599:2,6600:0,6601:2,6602:0,6603:2,6605:2,6606:0,6607:2,6608:0,6609:2,6610:0,6611:0,6612:2,6613:0,6614:2,6615:0,6616:2,6617:0,6618:2,6633:2,6646:0,6703:0,6784:0,6785:1,6786:0,6787:1,6788:0,6789:1,6790:0,6791:1,6792:0,6793:1,6794:0,6795:1,6796:0,6797:1,6798:0,6799:1,6800:0,6801:1,6802:0,6803:1,6804:0,6805:1,6806:0,6807:1,6808:0,6809:1,6810:0,6811:1,6812:0,6813:1,6814:0,6815:1,6816:0,6817:1,6818:0,6819:1,6820:0,6821:1,6822:0,6823:1,6824:0,6825:1,6826:0,6827:1,6828:0,6829:1,6830:0,6831:1,6832:0,6833:1,6834:0,6835:1,6836:0,6837:1,6838:0,6839:1,6840:0,6841:1,6842:0,6843:1,6844:0,6845:1,6846:0,6847:1,6848:0,6849:1,6850:0,6851:1,6852:0,6853:1,6854:0,6855:1,6856:0,6857:1,6858:0,6859:1,6860:0,6861:1,6862:0,6863:1,6867:0,6868:1,6870:0,6875:0,6876:0,6879:0,6880:2,6884:0,6885:1,6886:0,6887:1,6915:0,6922:0,6923:2,6924:0,6925:2,6962:0,6984:0,6991:0,7128:2,7131:0,7132:2,7142:0,7257:0,7258:2,7259:0,7260:2,7261:0,7262:2,7263:0,7264:2,7265:0,7266:2,7267:0,7268:2,7269:0,7270:2,7271:0,7272:2,7273:0,7274:2,7275:0,7276:2,7277:0,7278:2,7279:0,7280:2,7281:0,7282:2,7283:0,7284:2,7285:0,7286:2,7287:0,7288:2,7289:0,7290:2,7291:0,7292:2,7293:0,7294:2,7295:0,7296:2,7297:0,7298:2,7299:0,7300:2,7301:0,7302:2,7303:0,7304:2,7305:0,7306:2,7307:0,7308:2,7309:0,7310:2,7311:0,7312:2,7313:0,7314:2,7315:0,7316:2,7317:0,7318:2,7319:0,7320:2,7321:0,7322:2,7323:0,7324:2,7325:0,7326:2,7327:0,7328:2,7329:0,7330:2,7331:0,7332:2,7333:0,7334:2,7335:0,7336:2,7337:0,7338:2,7339:0,7340:2,7341:0,7342:2,7343:0,7344:2,7345:0,7346:2,7347:0,7348:2,7349:0,7350:2,7351:0,7352:2,7353:0,7354:2,7355:0,7356:2,7357:0,7358:2,7359:0,7360:2,7361:0,7362:2,7363:0,7364:2,7365:0,7366:2,7367:0,7368:2,7369:0,7370:2,7877:0,7878:0,7882:0,7883:0,7887:0,7899:0,7991:0,7992:0,8035:2,8036:2,8058:0,8059:0,8082:0,8083:0,8088:0,8090:0,8091:2,8092:0,8093:2,8095:0,8096:2,8097:0,8098:2,8099:0,8100:2,8101:0,8102:2,8103:0,8104:2,8105:0,8106:2,8107:0,8108:2,8109:0,8110:2,8111:0,8112:2,8113:0,8114:2,8115:0,8116:2,8117:0,8118:2,8119:0,8120:2,8121:0,8122:2,8123:0,8124:2,8125:0,8126:2,8127:0,8128:2,8129:0,8130:2,8131:0,8132:2,8133:0,8134:2,8135:0,8136:2,8137:0,8138:2,8139:0,8140:2,8141:0,8142:2,8143:0,8144:2,8145:0,8146:2,8147:0,8148:2,8149:0,8150:2,8151:0,8152:2,8153:0,8154:2,8155:0,8156:2,8157:0,8158:2,8159:0,8160:2,8161:0,8162:2,8163:0,8164:2,8165:0,8166:2,8167:0,8168:2,8169:0,8170:2,8171:0,8172:2,8173:0,8177:2,8179:0,8180:2,8181:0,8182:2,8184:0,8185:2,8187:0,8189:2,8191:0,8193:2,8196:0,8197:2,8198:0,8200:2,8201:0,8202:2,8203:0,8204:2,8205:0,8206:2,8207:0,8208:2,8209:0,8210:2,8212:0,8213:2,8214:0,8216:2,8218:0,8220:2,8222:0,8224:2,8225:0,8226:2,8311:0,8312:1,8313:0,8314:1,8315:0,8316:1,8317:0,8318:1,8319:0,8320:1,8321:0,8322:1,8323:0,8324:1,8325:0,8326:1,8327:0,8328:1,8329:0,8330:1,8331:0,8332:1,8333:0,8334:1,8335:0,8336:1,8337:0,8338:1,8339:0,8340:1,8341:0,8342:1,8343:0,8344:1,8345:0,8346:1,8347:0,8348:1,8352:0,8353:0,8379:0,8380:2,8381:0,8382:2,8383:0,8384:2,8385:0,8387:2,8391:0,8395:0,8433:0,8441:0,8455:0,8456:0,8531:2,8682:0,8686:0,8687:0,8692:0,8693:0,8826:0,8903:0,8950:0,8951:0,9039:0,9040:0,9141:0,9149:0,9150:0,9191:0,9221:0,9222:0,9249:0,9250:0,9252:0,9254:0,9265:0,9284:0,9285:0,9300:0,9354:0,9367:0,9373:0,9377:0,9387:0,9391:0,9456:0,9473:0,9498:0,9674:0,9678:0,9680:0,20499:0,20538:0,20539:0,20790:0,20791:0,21291:0,21292:0,21500:0,21817:0,21818:0,22032:0,22033:0,22091:0,22092:0,22332:0,22391:0,22392:0,22700:0,22770:0,22780:0,22832:0,23090:0,23095:0,23239:0,23240:0,23433:0,23700:0,24047:0,24048:0,24100:3,24200:0,24305:0,24306:0,24382:10,24383:0,24500:0,24547:0,24548:0,24571:9,24600:0,25e3:0,25231:0,25884:0,25932:0,26237:0,26331:0,26332:0,26432:0,26591:0,26592:0,26632:0,26692:0,27120:0,27200:0,27291:6,27292:6,27429:0,27492:0,27493:0,27500:0,27700:0,28232:0,28600:0,28991:0,28992:0,29100:0,29101:0,29220:0,29221:0,29333:0,29635:0,29636:0,29701:0,29738:0,29739:0,29849:0,29850:0,29871:8,29872:7,29873:0,29874:0,30200:5,30339:0,30340:0,30591:0,30592:0,30791:0,30792:0,30800:0,31028:0,31121:0,31154:0,31170:0,31171:0,31370:0,31528:0,31529:0,31600:0,31700:0,31838:0,31839:0,31900:0,31901:0,32061:0,32062:0,32098:0,32099:2,32100:0,32104:0,32161:0,32766:0,53048:0,53049:0,54090:0,54091:0,65061:2,65062:2,65161:0,65163:0,102041:2,102064:11,102068:14,102069:15,102118:2,102119:1,102120:2,102121:2,102217:2,102218:0,102219:2,102220:2,102378:1,102379:1,102380:0,102381:1,102589:2,102599:2,102600:2,102604:2,102647:0,102704:2,102705:2,102706:0,102761:2,102762:0,102763:2,102764:0,102765:0,102766:2,102962:0,102963:0,102970:1,102974:2,102993:0,102994:0,102995:2,102996:2,103015:0,103016:2,103017:0,103018:2,103025:0,103026:0,103027:2,103028:2,103035:0,103036:0,103037:2,103038:2,103039:0,103040:0,103041:2,103042:2,103043:0,103044:0,103045:2,103046:2,103047:0,103048:0,103049:2,103050:2,103051:0,103052:2,103053:0,103054:2,103055:0,103056:2,103057:0,103058:0,103059:2,103060:2,103061:0,103062:0,103063:2,103064:2,103069:2,103070:0,103071:0,103072:2,103073:2,103086:0,103087:0,103088:2,103089:2,103094:1,103095:0,103096:2,103103:0,103104:2,103105:0,103106:2,103121:0,103122:2,103123:0,103124:0,103125:1,103126:1,103127:0,103128:0,103129:2,103130:2,103131:0,103132:0,103133:2,103134:2,103135:0,103136:0,103137:1,103138:1,103139:0,103140:2,103141:0,103142:2,103143:0,103144:2,103145:0,103146:1,103147:0,103148:0,103149:2,103150:2,103151:0,103152:2,103172:0,103173:2,103174:0,103175:0,103176:2,103177:2,103178:0,103179:0,103180:2,103181:2,103182:0,103183:0,103184:2,103185:2,103228:0,103229:0,103230:2,103231:2,103250:0,103251:2,103252:0,103253:2,103260:0,103261:0,103262:2,103263:2,103270:0,103271:0,103272:2,103273:2,103274:0,103275:0,103276:2,103277:2,103278:0,103279:0,103280:2,103281:2,103282:0,103283:0,103284:2,103285:2,103286:0,103287:2,103288:0,103289:2,103290:0,103291:2,103292:0,103293:0,103294:2,103295:2,103296:0,103297:0,103298:2,103299:2,103376:2,103377:0,103378:0,103379:2,103380:2,103393:0,103394:0,103395:2,103396:2,103472:0,103473:1,103474:0,103475:2,103482:0,103483:2,103484:0,103485:2,103500:0,103501:2,103502:0,103503:0,103504:1,103505:1,103506:0,103507:0,103508:2,103509:2,103510:0,103511:0,103512:2,103513:2,103514:0,103515:2,103516:0,103517:2,103518:0,103519:2,103520:0,103521:1,103522:0,103523:0,103524:2,103525:2,103526:0,103527:2,103561:2,103562:2,103563:0,103564:0,103565:2,103566:2,103567:0,103568:0,103569:2,103570:2,103584:0,103585:2,103586:0,103587:2,103588:1,103589:0,103590:2,103591:1,103592:0,103593:2,103594:1,103695:2};for(n=2e3;n<=2045;n++)i[n]=0;for(n=2056;n<=2065;n++)i[n]=0;for(n=2067;n<=2135;n++)i[n]=0;for(n=2137;n<=2154;n++)i[n]=0;for(n=2161;n<=2170;n++)i[n]=0;for(n=2172;n<=2193;n++)i[n]=0;for(n=2195;n<=2198;n++)i[n]=0;for(n=2200;n<=2203;n++)i[n]=0;for(n=2205;n<=2217;n++)i[n]=0;for(n=2222;n<=2224;n++)i[n]=1;for(n=2225;n<=2250;n++)i[n]=2;for(n=2251;n<=2253;n++)i[n]=1;for(n=2257;n<=2264;n++)i[n]=2;for(n=2274;n<=2279;n++)i[n]=2;for(n=2280;n<=2282;n++)i[n]=1;for(n=2283;n<=2289;n++)i[n]=2;for(n=2290;n<=2292;n++)i[n]=0;for(n=2308;n<=2313;n++)i[n]=0;for(n=2315;n<=2491;n++)i[n]=0;for(n=2494;n<=2866;n++)i[n]=0;for(n=2867;n<=2869;n++)i[n]=1;for(n=2870;n<=2888;n++)i[n]=2;for(n=2891;n<=2895;n++)i[n]=2;for(n=2896;n<=2898;n++)i[n]=1;for(n=2902;n<=2908;n++)i[n]=2;for(n=2915;n<=2920;n++)i[n]=2;for(n=2921;n<=2923;n++)i[n]=1;for(n=2924;n<=2930;n++)i[n]=2;for(n=2931;n<=2962;n++)i[n]=0;for(n=2964;n<=2968;n++)i[n]=2;for(n=2969;n<=2973;n++)i[n]=0;for(n=2975;n<=2991;n++)i[n]=0;for(n=2995;n<=3051;n++)i[n]=0;for(n=3054;n<=3079;n++)i[n]=0;for(n=3081;n<=3088;n++)i[n]=0;for(n=3092;n<=3101;n++)i[n]=0;for(n=3106;n<=3138;n++)i[n]=0;for(n=3146;n<=3151;n++)i[n]=0;for(n=3153;n<=3166;n++)i[n]=0;for(n=3168;n<=3172;n++)i[n]=0;for(n=3174;n<=3203;n++)i[n]=0;for(n=3294;n<=3358;n++)i[n]=0;for(n=3367;n<=3403;n++)i[n]=0;for(n=3408;n<=3416;n++)i[n]=0;for(n=3417;n<=3438;n++)i[n]=2;for(n=3441;n<=3446;n++)i[n]=2;for(n=3447;n<=3450;n++)i[n]=0;for(n=3451;n<=3459;n++)i[n]=2;for(n=3460;n<=3478;n++)i[n]=0;for(n=3554;n<=3559;n++)i[n]=0;for(n=3560;n<=3570;n++)i[n]=2;for(n=3571;n<=3581;n++)i[n]=0;for(n=3594;n<=3597;n++)i[n]=0;for(n=3601;n<=3604;n++)i[n]=0;for(n=3637;n<=3639;n++)i[n]=0;for(n=3665;n<=3667;n++)i[n]=0;for(n=3693;n<=3695;n++)i[n]=0;for(n=3701;n<=3727;n++)i[n]=0;for(n=3728;n<=3739;n++)i[n]=2;for(n=3740;n<=3751;n++)i[n]=0;for(n=3753;n<=3760;n++)i[n]=2;for(n=3761;n<=3773;n++)i[n]=0;for(n=3775;n<=3777;n++)i[n]=0;for(n=3779;n<=3781;n++)i[n]=0;for(n=3783;n<=3785;n++)i[n]=0;for(n=3788;n<=3791;n++)i[n]=0;for(n=3797;n<=3802;n++)i[n]=0;for(n=3814;n<=3816;n++)i[n]=0;for(n=3825;n<=3829;n++)i[n]=0;for(n=3832;n<=3841;n++)i[n]=0;for(n=3844;n<=3852;n++)i[n]=0;for(n=3873;n<=3885;n++)i[n]=0;for(n=3890;n<=3893;n++)i[n]=0;for(n=3907;n<=3912;n++)i[n]=0;for(n=3942;n<=3950;n++)i[n]=0;for(n=3968;n<=3970;n++)i[n]=0;for(n=3973;n<=3976;n++)i[n]=0;for(n=3986;n<=3989;n++)i[n]=0;for(n=3994;n<=3997;n++)i[n]=0;for(n=4048;n<=4051;n++)i[n]=0;for(n=4056;n<=4063;n++)i[n]=0;for(n=4093;n<=4096;n++)i[n]=0;for(n=4390;n<=4398;n++)i[n]=0;for(n=4399;n<=4413;n++)i[n]=2;for(n=4418;n<=4433;n++)i[n]=2;for(n=4455;n<=4457;n++)i[n]=2;for(n=4484;n<=4489;n++)i[n]=0;for(n=4491;n<=4554;n++)i[n]=0;for(n=4568;n<=4589;n++)i[n]=0;for(n=4652;n<=4656;n++)i[n]=0;for(n=4766;n<=4800;n++)i[n]=0;for(n=5014;n<=5016;n++)i[n]=0;for(n=5069;n<=5072;n++)i[n]=0;for(n=5105;n<=5130;n++)i[n]=0;for(n=5173;n<=5188;n++)i[n]=0;for(n=5253;n<=5259;n++)i[n]=0;for(n=5269;n<=5275;n++)i[n]=0;for(n=5292;n<=5311;n++)i[n]=0;for(n=5329;n<=5331;n++)i[n]=0;for(n=5343;n<=5349;n++)i[n]=0;for(n=5355;n<=5357;n++)i[n]=0;for(n=5387;n<=5389;n++)i[n]=0;for(n=5459;n<=5463;n++)i[n]=0;for(n=5479;n<=5482;n++)i[n]=0;for(n=5518;n<=5520;n++)i[n]=0;for(n=5530;n<=5539;n++)i[n]=0;for(n=5550;n<=5552;n++)i[n]=0;for(n=5562;n<=5583;n++)i[n]=0;for(n=5623;n<=5625;n++)i[n]=2;for(n=5631;n<=5639;n++)i[n]=0;for(n=5649;n<=5653;n++)i[n]=0;for(n=5663;n<=5680;n++)i[n]=0;for(n=5682;n<=5685;n++)i[n]=0;for(n=5875;n<=5877;n++)i[n]=0;for(n=5896;n<=5899;n++)i[n]=0;for(n=5921;n<=5940;n++)i[n]=0;for(n=6050;n<=6125;n++)i[n]=0;for(n=6244;n<=6275;n++)i[n]=0;for(n=6328;n<=6348;n++)i[n]=0;for(n=6350;n<=6356;n++)i[n]=0;for(n=6366;n<=6372;n++)i[n]=0;for(n=6381;n<=6387;n++)i[n]=0;for(n=6393;n<=6404;n++)i[n]=0;for(n=6480;n<=6483;n++)i[n]=0;for(n=6511;n<=6514;n++)i[n]=0;for(n=6579;n<=6581;n++)i[n]=0;for(n=6619;n<=6624;n++)i[n]=0;for(n=6625;n<=6627;n++)i[n]=2;for(n=6628;n<=6632;n++)i[n]=0;for(n=6634;n<=6637;n++)i[n]=0;for(n=6669;n<=6692;n++)i[n]=0;for(n=6707;n<=6709;n++)i[n]=0;for(n=6720;n<=6723;n++)i[n]=0;for(n=6732;n<=6738;n++)i[n]=0;for(n=6931;n<=6933;n++)i[n]=0;for(n=6956;n<=6959;n++)i[n]=0;for(n=7005;n<=7007;n++)i[n]=0;for(n=7057;n<=7070;n++)i[n]=2;for(n=7074;n<=7082;n++)i[n]=0;for(n=7109;n<=7118;n++)i[n]=0;for(n=7119;n<=7127;n++)i[n]=1;for(n=7374;n<=7376;n++)i[n]=0;for(n=7528;n<=7586;n++)i[n]=0;for(n=7587;n<=7645;n++)i[n]=2;for(n=7692;n<=7696;n++)i[n]=0;for(n=7755;n<=7787;n++)i[n]=0;for(n=7791;n<=7795;n++)i[n]=0;for(n=7799;n<=7801;n++)i[n]=0;for(n=7803;n<=7805;n++)i[n]=0;for(n=7825;n<=7831;n++)i[n]=0;for(n=7845;n<=7859;n++)i[n]=0;for(n=8013;n<=8032;n++)i[n]=0;for(n=8065;n<=8068;n++)i[n]=1;for(n=8518;n<=8529;n++)i[n]=2;for(n=8533;n<=8536;n++)i[n]=2;for(n=8538;n<=8540;n++)i[n]=2;for(n=8677;n<=8679;n++)i[n]=0;for(n=8836;n<=8840;n++)i[n]=0;for(n=8857;n<=8859;n++)i[n]=0;for(n=8908;n<=8910;n++)i[n]=0;for(n=9154;n<=9159;n++)i[n]=0;for(n=9205;n<=9218;n++)i[n]=0;for(n=9271;n<=9273;n++)i[n]=0;for(n=9295;n<=9297;n++)i[n]=0;for(n=9356;n<=9360;n++)i[n]=0;for(n=9404;n<=9407;n++)i[n]=0;for(n=9476;n<=9482;n++)i[n]=0;for(n=9487;n<=9494;n++)i[n]=0;for(n=9697;n<=9699;n++)i[n]=0;for(n=20002;n<=20032;n++)i[n]=0;for(n=20062;n<=20092;n++)i[n]=0;for(n=20135;n<=20138;n++)i[n]=0;for(n=20248;n<=20258;n++)i[n]=0;for(n=20348;n<=20358;n++)i[n]=0;for(n=20436;n<=20440;n++)i[n]=0;for(n=20822;n<=20824;n++)i[n]=0;for(n=20934;n<=20936;n++)i[n]=0;for(n=21035;n<=21037;n++)i[n]=0;for(n=21095;n<=21097;n++)i[n]=0;for(n=21148;n<=21150;n++)i[n]=0;for(n=21413;n<=21423;n++)i[n]=0;for(n=21453;n<=21463;n++)i[n]=0;for(n=21473;n<=21483;n++)i[n]=0;for(n=21780;n<=21782;n++)i[n]=0;for(n=21891;n<=21894;n++)i[n]=0;for(n=21896;n<=21899;n++)i[n]=0;for(n=22171;n<=22177;n++)i[n]=0;for(n=22181;n<=22187;n++)i[n]=0;for(n=22191;n<=22197;n++)i[n]=0;for(n=22234;n<=22236;n++)i[n]=0;for(n=22521;n<=22525;n++)i[n]=0;for(n=22991;n<=22994;n++)i[n]=0;for(n=23028;n<=23038;n++)i[n]=0;for(n=23830;n<=23853;n++)i[n]=0;for(n=23866;n<=23872;n++)i[n]=0;for(n=23877;n<=23884;n++)i[n]=0;for(n=23886;n<=23894;n++)i[n]=0;for(n=23946;n<=23948;n++)i[n]=0;for(n=24311;n<=24313;n++)i[n]=0;for(n=24342;n<=24347;n++)i[n]=0;for(n=24370;n<=24374;n++)i[n]=10;for(n=24375;n<=24381;n++)i[n]=0;for(n=24718;n<=24721;n++)i[n]=0;for(n=24817;n<=24821;n++)i[n]=0;for(n=24877;n<=24882;n++)i[n]=0;for(n=24891;n<=24893;n++)i[n]=0;for(n=25391;n<=25395;n++)i[n]=0;for(n=25828;n<=25838;n++)i[n]=0;for(n=26191;n<=26195;n++)i[n]=0;for(n=26391;n<=26393;n++)i[n]=0;for(n=26701;n<=26722;n++)i[n]=0;for(n=26729;n<=26799;n++)i[n]=2;for(n=26801;n<=26803;n++)i[n]=2;for(n=26811;n<=26813;n++)i[n]=2;for(n=26847;n<=26870;n++)i[n]=2;for(n=26891;n<=26899;n++)i[n]=0;for(n=26901;n<=26923;n++)i[n]=0;for(n=26929;n<=26946;n++)i[n]=0;for(n=26948;n<=26998;n++)i[n]=0;for(n=27037;n<=27040;n++)i[n]=0;for(n=27205;n<=27232;n++)i[n]=0;for(n=27258;n<=27260;n++)i[n]=0;for(n=27391;n<=27398;n++)i[n]=0;for(n=27561;n<=27564;n++)i[n]=0;for(n=27571;n<=27574;n++)i[n]=0;for(n=27581;n<=27584;n++)i[n]=0;for(n=27591;n<=27594;n++)i[n]=0;for(n=28191;n<=28193;n++)i[n]=0;for(n=28348;n<=28358;n++)i[n]=0;for(n=28402;n<=28432;n++)i[n]=0;for(n=28462;n<=28492;n++)i[n]=0;for(n=29118;n<=29122;n++)i[n]=0;for(n=29168;n<=29172;n++)i[n]=0;for(n=29177;n<=29185;n++)i[n]=0;for(n=29187;n<=29195;n++)i[n]=0;for(n=29900;n<=29903;n++)i[n]=0;for(n=30161;n<=30179;n++)i[n]=0;for(n=30491;n<=30494;n++)i[n]=0;for(n=30729;n<=30732;n++)i[n]=0;for(n=31251;n<=31259;n++)i[n]=0;for(n=31265;n<=31268;n++)i[n]=0;for(n=31275;n<=31279;n++)i[n]=0;for(n=31281;n<=31297;n++)i[n]=0;for(n=31461;n<=31469;n++)i[n]=0;for(n=31491;n<=31495;n++)i[n]=0;for(n=31917;n<=31922;n++)i[n]=0;for(n=31965;n<=32e3;n++)i[n]=0;for(n=32001;n<=32003;n++)i[n]=2;for(n=32005;n<=32031;n++)i[n]=2;for(n=32033;n<=32060;n++)i[n]=2;for(n=32064;n<=32067;n++)i[n]=2;for(n=32074;n<=32077;n++)i[n]=2;for(n=32081;n<=32086;n++)i[n]=0;for(n=32107;n<=32130;n++)i[n]=0;for(n=32133;n<=32158;n++)i[n]=0;for(n=32164;n<=32167;n++)i[n]=2;for(n=32180;n<=32199;n++)i[n]=0;for(n=32201;n<=32260;n++)i[n]=0;for(n=32301;n<=32360;n++)i[n]=0;for(n=32601;n<=32662;n++)i[n]=0;for(n=32664;n<=32667;n++)i[n]=2;for(n=32701;n<=32761;n++)i[n]=0;for(n=53001;n<=53004;n++)i[n]=0;for(n=53008;n<=53019;n++)i[n]=0;for(n=53021;n<=53032;n++)i[n]=0;for(n=53034;n<=53037;n++)i[n]=0;for(n=53042;n<=53046;n++)i[n]=0;for(n=53074;n<=53080;n++)i[n]=0;for(n=54001;n<=54004;n++)i[n]=0;for(n=54008;n<=54019;n++)i[n]=0;for(n=54021;n<=54032;n++)i[n]=0;for(n=54034;n<=54037;n++)i[n]=0;for(n=54042;n<=54046;n++)i[n]=0;for(n=54048;n<=54053;n++)i[n]=0;for(n=54074;n<=54080;n++)i[n]=0;for(n=54098;n<=54101;n++)i[n]=0;for(n=102001;n<=102040;n++)i[n]=0;for(n=102042;n<=102063;n++)i[n]=0;for(n=102065;n<=102067;n++)i[n]=0;for(n=102070;n<=102117;n++)i[n]=0;for(n=102122;n<=102216;n++)i[n]=0;for(n=102221;n<=102377;n++)i[n]=0;for(n=102382;n<=102388;n++)i[n]=0;for(n=102389;n<=102398;n++)i[n]=2;for(n=102399;n<=102444;n++)i[n]=0;for(n=102445;n<=102447;n++)i[n]=2;for(n=102448;n<=102458;n++)i[n]=0;for(n=102459;n<=102468;n++)i[n]=2;for(n=102469;n<=102499;n++)i[n]=0;for(n=102500;n<=102519;n++)i[n]=1;for(n=102520;n<=102524;n++)i[n]=0;for(n=102525;n<=102529;n++)i[n]=2;for(n=102530;n<=102588;n++)i[n]=0;for(n=102590;n<=102598;n++)i[n]=0;for(n=102601;n<=102603;n++)i[n]=0;for(n=102605;n<=102628;n++)i[n]=0;for(n=102629;n<=102646;n++)i[n]=2;for(n=102648;n<=102700;n++)i[n]=2;for(n=102701;n<=102703;n++)i[n]=0;for(n=102707;n<=102730;n++)i[n]=2;for(n=102733;n<=102758;n++)i[n]=2;for(n=102767;n<=102900;n++)i[n]=0;for(n=102965;n<=102969;n++)i[n]=0;for(n=102971;n<=102973;n++)i[n]=0;for(n=102975;n<=102989;n++)i[n]=0;for(n=102990;n<=102992;n++)i[n]=1;for(n=102997;n<=103002;n++)i[n]=0;for(n=103003;n<=103008;n++)i[n]=2;for(n=103009;n<=103011;n++)i[n]=0;for(n=103012;n<=103014;n++)i[n]=2;for(n=103019;n<=103021;n++)i[n]=0;for(n=103022;n<=103024;n++)i[n]=2;for(n=103029;n<=103031;n++)i[n]=0;for(n=103032;n<=103034;n++)i[n]=2;for(n=103065;n<=103068;n++)i[n]=0;for(n=103074;n<=103076;n++)i[n]=0;for(n=103077;n<=103079;n++)i[n]=1;for(n=103080;n<=103082;n++)i[n]=0;for(n=103083;n<=103085;n++)i[n]=2;for(n=103090;n<=103093;n++)i[n]=0;for(n=103097;n<=103099;n++)i[n]=0;for(n=103100;n<=103102;n++)i[n]=2;for(n=103107;n<=103109;n++)i[n]=0;for(n=103110;n<=103112;n++)i[n]=2;for(n=103113;n<=103116;n++)i[n]=0;for(n=103117;n<=103120;n++)i[n]=2;for(n=103153;n<=103157;n++)i[n]=0;for(n=103158;n<=103162;n++)i[n]=2;for(n=103163;n<=103165;n++)i[n]=0;for(n=103166;n<=103168;n++)i[n]=1;for(n=103169;n<=103171;n++)i[n]=2;for(n=103186;n<=103188;n++)i[n]=0;for(n=103189;n<=103191;n++)i[n]=2;for(n=103192;n<=103195;n++)i[n]=0;for(n=103196;n<=103199;n++)i[n]=2;for(n=103200;n<=103224;n++)i[n]=0;for(n=103225;n<=103227;n++)i[n]=1;for(n=103232;n<=103237;n++)i[n]=0;for(n=103238;n<=103243;n++)i[n]=2;for(n=103244;n<=103246;n++)i[n]=0;for(n=103247;n<=103249;n++)i[n]=2;for(n=103254;n<=103256;n++)i[n]=0;for(n=103257;n<=103259;n++)i[n]=2;for(n=103264;n<=103266;n++)i[n]=0;for(n=103267;n<=103269;n++)i[n]=2;for(n=103300;n<=103375;n++)i[n]=0;for(n=103381;n<=103383;n++)i[n]=0;for(n=103384;n<=103386;n++)i[n]=1;for(n=103387;n<=103389;n++)i[n]=0;for(n=103390;n<=103392;n++)i[n]=2;for(n=103397;n<=103399;n++)i[n]=0;for(n=103400;n<=103471;n++)i[n]=2;for(n=103476;n<=103478;n++)i[n]=0;for(n=103479;n<=103481;n++)i[n]=2;for(n=103486;n<=103488;n++)i[n]=0;for(n=103489;n<=103491;n++)i[n]=2;for(n=103492;n<=103495;n++)i[n]=0;for(n=103496;n<=103499;n++)i[n]=2;for(n=103528;n<=103543;n++)i[n]=0;for(n=103544;n<=103548;n++)i[n]=2;for(n=103549;n<=103551;n++)i[n]=0;for(n=103552;n<=103554;n++)i[n]=1;for(n=103555;n<=103557;n++)i[n]=2;for(n=103558;n<=103560;n++)i[n]=0;for(n=103571;n<=103573;n++)i[n]=0;for(n=103574;n<=103576;n++)i[n]=2;for(n=103577;n<=103580;n++)i[n]=0;for(n=103581;n<=103583;n++)i[n]=2;for(n=103595;n<=103694;n++)i[n]=0;for(n=103696;n<=103699;n++)i[n]=0;for(n=103700;n<=103793;n++)i[n]=2;for(n=103794;n<=103872;n++)i[n]=0;for(n=103900;n<=103971;n++)i[n]=2;t.a=i},function(e,t,r){"use strict";r.d(t,"a",(function(){return u})),r.d(t,"b",(function(){return d})),r.d(t,"c",(function(){return h}));var n=r(455);var i=[];function a(e,t,r,n){return{xmin:e,ymin:t,xmax:r,ymax:n}}function o(e,t,r,n,i,a){return{xmin:e,ymin:t,zmin:r,xmax:n,ymax:i,zmax:a}}function s(e,t,r,n,i,a){return{xmin:e,ymin:t,mmin:r,xmax:n,ymax:i,mmax:a}}function c(e,t,r,n,i,a,o,s){return{xmin:e,ymin:t,zmin:r,mmin:n,xmax:i,ymax:a,zmax:o,mmax:s}}function l(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return t?r?c(e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]):o(e[0],e[1],e[2],e[3],e[4],e[5]):r?s(e[0],e[1],e[2],e[3],e[4],e[5]):a(e[0],e[1],e[2],e[3])}function u(e){return e?function(e){return void 0!==e.xmin&&void 0!==e.ymin&&void 0!==e.xmax&&void 0!==e.ymax}(e)?e:function(e){return void 0!==e.x&&void 0!==e.y}(e)?function(e){var t=e.x,r=e.y,n=e.z,i=e.m,l=null!=i;return null!=n?l?c(t,r,n,i,t,r,n,i):o(t,r,n,t,r,n):l?s(t,r,i,t,r,i):a(t,r,t,r)}(e):function(e){return void 0!==e.rings}(e)?d(e):function(e){return void 0!==e.paths}(e)?h(e):function(e){return void 0!==e.points}(e)?function(e){var t=e.hasZ,r=e.hasM,a=e.points;return l(Object(n.c)(i,a,t,r),t,r)}(e):null:null}function d(e){var t=e.hasZ,r=e.hasM,a=e.rings,o=Object(n.d)(i,a,t,r);return o?l(o,t,r):null}function h(e){var t=e.hasZ,r=e.hasM,a=e.paths,o=Object(n.d)(i,a,t,r);return o?l(o,t,r):null}},function(e,t,r){"use strict";var n,i=r(2),a=r(5),o=r(6),s=r(7),c=r(0),l=r(27),u=r(1),d=(r(17),r(18),r(15),r(10)),h=n=function(e){Object(o.a)(r,e);var t=Object(s.a)(r);function r(e){var n;return Object(i.a)(this,r),(n=t.call(this,e)).name=null,n.title=null,n.expression=null,n.returnType=null,n}return Object(a.a)(r,[{key:"clone",value:function(){return new n({name:this.name,title:this.title,expression:this.expression,returnType:this.returnType})}}]),r}(l.a);Object(c.a)([Object(u.b)({type:String,json:{write:!0}})],h.prototype,"name",void 0),Object(c.a)([Object(u.b)({type:String,json:{write:!0}})],h.prototype,"title",void 0),Object(c.a)([Object(u.b)({type:String,json:{write:!0}})],h.prototype,"expression",void 0),Object(c.a)([Object(u.b)({type:["string","number"],json:{write:!0}})],h.prototype,"returnType",void 0);var f=h=n=Object(c.a)([Object(d.a)("esri.popup.ExpressionInfo")],h);t.a=f},function(e,t,r){"use strict";r.d(t,"b",(function(){return O}));var n,i=r(2),a=r(5),o=r(6),s=r(7),c=r(0),l=r(58),u=r(27),d=r(39),h=r(1),f=(r(17),r(18),r(15),r(52)),p=r(48),b=r(10),v=r(44),m=r(130),y=Object(l.b)()({circle:"circle",square:"square",cross:"cross",x:"x",kite:"kite",triangle:"triangle"}),g=n=function(e){Object(o.a)(r,e);var t=Object(s.a)(r);function r(e){return Object(i.a)(this,r),t.call(this,e)}return Object(a.a)(r,[{key:"readHref",value:function(e,t,r){return e?Object(m.a)(e,r):t.dataURI}},{key:"writeHref",value:function(e,t,r,n){e&&(Object(d.u)(e)?t.dataURI=e:(t.href=Object(m.e)(e,n),Object(d.s)(t.href)&&(t.href=Object(d.D)(t.href))))}},{key:"clone",value:function(){return new n({href:this.href,primitive:this.primitive})}}]),r}(u.a);Object(c.a)([Object(h.b)({type:String,json:{write:!0,read:{source:["href","dataURI"]}}})],g.prototype,"href",void 0),Object(c.a)([Object(p.a)("href")],g.prototype,"readHref",null),Object(c.a)([Object(v.a)("href",{href:{type:String},dataURI:{type:String}})],g.prototype,"writeHref",null),Object(c.a)([Object(f.a)(y)],g.prototype,"primitive",void 0),g=n=Object(c.a)([Object(b.a)("esri.symbols.support.IconSymbol3DLayerResource")],g);var O="circle",j=g;t.a=j},function(e,t,r){"use strict";var n,i=r(2),a=r(5),o=r(6),s=r(7),c=r(0),l=r(49),u=r(25),d=r(3),h=r(28),f=r(1),p=(r(18),r(17),r(15),r(52)),b=r(10),v=r(516),m=r(486),y=r(131),g=n=function(e){Object(o.a)(r,e);var t=Object(s.a)(r);function r(e){var n;return Object(i.a)(this,r),(n=t.call(this,e)).type="line",n.color=new l.a([0,0,0,1]),n.size=Object(h.h)(1),n.border=null,n}return Object(a.a)(r,[{key:"visible",get:function(){return this.size>0&&Object(d.j)(this.color)&&this.color.a>0}},{key:"clone",value:function(){return new n({color:Object(u.a)(this.color),size:this.size,border:Object(u.a)(this.border)})}}]),r}(v.a);Object(c.a)([Object(p.a)({line:"line"},{readOnly:!0})],g.prototype,"type",void 0),Object(c.a)([Object(f.b)(y.a)],g.prototype,"color",void 0),Object(c.a)([Object(f.b)(y.b)],g.prototype,"size",void 0),Object(c.a)([Object(f.b)({type:m.a,json:{write:!0}})],g.prototype,"border",void 0),Object(c.a)([Object(f.b)({readOnly:!0})],g.prototype,"visible",null);var O=g=n=Object(c.a)([Object(b.a)("esri.symbols.callouts.LineCallout3D")],g);t.a=O},function(e,t,r){"use strict";r.d(t,"a",(function(){return v}));var n,i=r(2),a=r(5),o=r(6),s=r(7),c=r(0),l=r(49),u=r(27),d=r(25),h=r(1),f=(r(18),r(17),r(15),r(10)),p=r(131),b=n=function(e){Object(o.a)(r,e);var t=Object(s.a)(r);function r(){var e;return Object(i.a)(this,r),(e=t.apply(this,arguments)).color=new l.a("white"),e}return Object(a.a)(r,[{key:"clone",value:function(){return new n({color:Object(d.a)(this.color)})}}]),r}(u.a);Object(c.a)([Object(h.b)(p.a)],b.prototype,"color",void 0);var v=b=n=Object(c.a)([Object(f.a)("esri.symbols.callouts.LineCallout3DBorder")],b);Object.freeze({__proto__:null,get LineCallout3DBorder(){return b},default:v})},function(e,t,r){"use strict";var n=r(2),i=r(5),a=function(){function e(){Object(n.a)(this,e),this.objectIdFieldName=null,this.globalIdFieldName=null,this.geohashFieldName=null,this.geometryProperties=null,this.geometryType=null,this.spatialReference=null,this.hasZ=!1,this.hasM=!1,this.features=[],this.fields=[],this.transform=null,this.exceededTransferLimit=!1,this.uniqueIdField=null,this.queryGeometryType=null,this.queryGeometry=null}return Object(i.a)(e,[{key:"weakClone",value:function(){var t=new e;return t.objectIdFieldName=this.objectIdFieldName,t.globalIdFieldName=this.globalIdFieldName,t.geohashFieldName=this.geohashFieldName,t.geometryProperties=this.geometryProperties,t.geometryType=this.geometryType,t.spatialReference=this.spatialReference,t.hasZ=this.hasZ,t.hasM=this.hasM,t.features=this.features,t.fields=this.fields,t.transform=this.transform,t.exceededTransferLimit=this.exceededTransferLimit,t.uniqueIdField=this.uniqueIdField,t.queryGeometry=this.queryGeometry,t.queryGeometryType=this.queryGeometryType,t}}]),e}();t.a=a},function(e,t,r){"use strict";var n,i=r(2),a=r(5),o=r(6),s=r(7),c=r(0),l=r(22),u=r(1),d=(r(17),r(18),r(15),r(10)),h=r(44),f=r(291),p=n=function(e){Object(o.a)(r,e);var t=Object(s.a)(r);function r(e){var n;return Object(i.a)(this,r),(n=t.call(this,e)).axis=null,n.type="rotation",n.rotationType="geographic",n.valueExpressionTitle=null,n}return Object(a.a)(r,[{key:"cache",get:function(){return{hasExpression:!!this.valueExpression,compiledFunc:null}}},{key:"writeValueExpressionTitleWebScene",value:function(e,t,r,n){if(n&&n.messages){var i="visualVariables[".concat(this.index,"]");n.messages.push(new l.a("property:unsupported",this.type+"VisualVariable.valueExpressionTitle is not supported in Web Scene. Please remove this property to save the Web Scene.",{instance:this,propertyName:i+".valueExpressionTitle",context:n}))}}},{key:"clone",value:function(){return new n({axis:this.axis,rotationType:this.rotationType,field:this.field,valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle,legendOptions:this.legendOptions&&this.legendOptions.clone()})}}]),r}(f.a);Object(c.a)([Object(u.b)({readOnly:!0})],p.prototype,"cache",null),Object(c.a)([Object(u.b)({type:["heading","tilt","roll"],json:{origins:{"web-scene":{default:"heading",write:!0}}}})],p.prototype,"axis",void 0),Object(c.a)([Object(u.b)({type:["rotation"],json:{type:["rotationInfo"]}})],p.prototype,"type",void 0),Object(c.a)([Object(u.b)({type:["geographic","arithmetic"],json:{write:!0,origins:{"web-document":{write:!0,default:"geographic"}}}})],p.prototype,"rotationType",void 0),Object(c.a)([Object(u.b)({type:String,json:{write:!0}})],p.prototype,"valueExpressionTitle",void 0),Object(c.a)([Object(h.a)("web-scene","valueExpressionTitle")],p.prototype,"writeValueExpressionTitleWebScene",null);var b=p=n=Object(c.a)([Object(d.a)("esri.renderers.visualVariables.RotationVariable")],p);t.a=b},function(e,t,r){"use strict";r.d(t,"a",(function(){return l})),r.d(t,"b",(function(){return c})),r.d(t,"c",(function(){return u}));var n=r(22),i=r(113),a=r(375),o=r(480),s=r(422),c={key:"type",base:a.a,typeMap:{selection:s.a}};function l(e,t){var r=(t=t.layerDefinition||t).featureReduction;if(r)switch(r.type){case"selection":return s.a.fromJSON(r);case"cluster":return o.a.fromJSON(r)}return null}function u(e,t,r,a){var o=function(e,t,r){return e?"selection"!==e.type?(r.messages&&r.messages.push(new n.a("featureReduction:unsupported","FeatureReduction of type '".concat(e.declaredClass,"' are not supported in scenes."),{featureReduction:e,context:r})),null):e.write(t,r):null}(e,{},a);o&&Object(i.c)(r,o,t)}},function(e,t,r){"use strict";r.d(t,"a",(function(){return m}));var n=r(50),i=r(2),a=r(5),o=r(3),s=r(31),c=r(4),l=r(9),u=r(51),d=r(115),h=r(294),f=r(163),p=r(279),b=r(344),v=0,m=function(){function e(t){Object(i.a)(this,e),this._originSR=t,this.ROOT_ORIGIN_ID="rg_root_"+v++,this._origins=new Map,this._gridSize=125e4,this._objects=new Map}return Object(a.a)(e,[{key:"getOrigin",value:function(e){var t=this._origins.get(this.ROOT_ORIGIN_ID);if(null==t){if(Object(o.j)(y))return this._origins.set(this.ROOT_ORIGIN_ID,Object(h.a)(y[0],y[1],y[2],this.ROOT_ORIGIN_ID)),this.getOrigin(e);var r=Object(h.a)(e[0]+Math.random()-.5,e[1]+Math.random()-.5,e[2]+Math.random()-.5,this.ROOT_ORIGIN_ID);return this._origins.set(this.ROOT_ORIGIN_ID,r),r}var i=this._gridSize,a=Math.round(e[0]/i),s=Math.round(e[1]/i),l=Math.round(e[2]/i),u="".concat("rg_").concat(a,"/").concat(s,"/").concat(l),d=this._origins.get(u),f=.5*i;if(Object(c.l)(g,e,t.vec3),g[0]=Math.abs(g[0]),g[1]=Math.abs(g[1]),g[2]=Math.abs(g[2]),g[0]<f&&g[1]<f&&g[2]<f){if(d){var p=Math.max.apply(Math,Object(n.a)(g));if(Object(c.l)(g,e,d.vec3),g[0]=Math.abs(g[0]),g[1]=Math.abs(g[1]),g[2]=Math.abs(g[2]),Math.max.apply(Math,Object(n.a)(g))<p)return d}return t}return d||(d=Object(h.a)(a*i,s*i,l*i,u),this._origins.set(u,d)),d}},{key:"_drawOriginBox",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[1,1,0,1],r=window.view,n=r._stage,i=t.toString();if(!this._objects.has(i)){this._material=new b.a({width:2,color:t}),n.add(this._material);var a=new p.a({isPickable:!1}),o=new f.a({castShadow:!1});n.add(o),a.add(o),n.add(a),this._objects.set(i,o)}for(var c=this._objects.get(i),l=[0,1,5,4,0,2,1,7,6,2,0,1,3,7,5,4,6,2,0],h=l.length,v=new Array(3*h),m=new Uint16Array(2*(h-1)),y=.5*this._gridSize,g=0;g<h;g++)v[3*g+0]=e[0]+(1&l[g]?y:-y),v[3*g+1]=e[1]+(2&l[g]?y:-y),v[3*g+2]=e[2]+(4&l[g]?y:-y),g>0&&(m[2*g+0]=g-1,m[2*g+1]=g);Object(u.q)(v,this._originSR,0,v,r.renderSpatialReference,0,h);var O=new d.a([["position",{size:3,data:v,exclusive:!0}]],[["position",m]],2);n.add(O),c.addGeometry(O,this._material,s.a)}},{key:"test",get:function(){var e=this;return{get gridSize(){return e._gridSize},set gridSize(t){e._gridSize=t}}}}]),e}(),y=null;var g=Object(l.e)()},function(e,t,r){"use strict";r.d(t,"a",(function(){return p}));var n=r(8),i=r.n(n),a=r(16),o=r(2),s=r(5),c=r(99),l=r(128),u=r(22),d=r(3),h=r(23),f=r(39),p=function(){function e(t){Object(o.a)(this,e),this.streamDataRequester=t}return Object(s.a)(e,[{key:"loadJSON",value:function(){var e=Object(a.a)(i.a.mark((function e(t,r){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.load("json",t,r));case 1:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"loadBinary",value:function(){var e=Object(a.a)(i.a.mark((function e(t,r){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Object(f.u)(t)?(Object(h.x)(r),Object(f.j)(t)):this.load("binary",t,r));case 1:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"loadImage",value:function(){var e=Object(a.a)(i.a.mark((function e(t,r){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.load("image",t,r));case 1:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"load",value:function(){var e=Object(a.a)(i.a.mark((function e(t,r,n){var a;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!Object(d.i)(this.streamDataRequester)){e.next=4;break}return e.next=3,Object(c.default)(r,{responseType:b[t]});case 3:return e.abrupt("return",e.sent.data);case 4:return e.next=6,Object(l.d)(this.streamDataRequester.request(r,t,n));case 6:if(!0!==(a=e.sent).ok){e.next=9;break}return e.abrupt("return",a.value);case 9:throw Object(h.w)(a.error),new u.a("","Request for resource failed: ".concat(a.error));case 10:case"end":return e.stop()}}),e,this)})));return function(t,r,n){return e.apply(this,arguments)}}()}]),e}(),b={image:"image",binary:"array-buffer",json:"json"}},function(e,t,r){"use strict";r.d(t,"a",(function(){return m})),r.d(t,"b",(function(){return y}));var n,i,a,o,s,c,l,u,d,h,f,p=r(12),b=r(319),v=r(11);function m(e,t){e.attributes.add("featureValue","vec4"),e.vertex.code.add(Object(v.a)(n||(n=Object(p.a)(["bool isCapVertex() {\nreturn featureValue.w == 1.0;\n}"])))),e.vertex.uniforms.add("size","vec3"),t.vvSize?(e.vertex.uniforms.add("vvSizeMinSize","vec3"),e.vertex.uniforms.add("vvSizeMaxSize","vec3"),e.vertex.uniforms.add("vvSizeOffset","vec3"),e.vertex.uniforms.add("vvSizeFactor","vec3"),e.vertex.code.add(Object(v.a)(i||(i=Object(p.a)(["vec2 getSize() {\nreturn size.xy*clamp(vvSizeOffset + featureValue.x * vvSizeFactor, vvSizeMinSize, vvSizeMaxSize).xz;\n}"]))))):e.vertex.code.add(Object(v.a)(a||(a=Object(p.a)(["vec2 getSize(){\nreturn size.xy;\n}"])))),t.vvOpacity?(e.vertex.constants.add("vvOpacityNumber","int",8),e.vertex.code.add(Object(v.a)(o||(o=Object(p.a)(["uniform float vvOpacityValues[vvOpacityNumber];\nuniform float vvOpacityOpacities[vvOpacityNumber];\nvec4 applyOpacity(vec4 color) {\nfloat value = featureValue.z;\nif (value <= vvOpacityValues[0]) {\nreturn vec4( color.xyz, vvOpacityOpacities[0]);\n}\nfor (int i = 1; i < vvOpacityNumber; ++i) {\nif (vvOpacityValues[i] >= value) {\nfloat f = (value - vvOpacityValues[i-1]) / (vvOpacityValues[i] - vvOpacityValues[i-1]);\nreturn vec4( color.xyz, mix(vvOpacityOpacities[i-1], vvOpacityOpacities[i], f));\n}\n}\nreturn vec4( color.xyz, vvOpacityOpacities[vvOpacityNumber - 1]);\n}"]))))):e.vertex.code.add(Object(v.a)(s||(s=Object(p.a)(["vec4 applyOpacity(vec4 color){\nreturn color;\n}"])))),t.vvColor?(e.vertex.constants.add("vvColorNumber","int",8),e.vertex.code.add(Object(v.a)(c||(c=Object(p.a)(["uniform float vvColorValues[vvColorNumber];\nuniform vec4 vvColorColors[vvColorNumber];\nvec4 getColor() {\nfloat value = featureValue.y;\nif (value <= vvColorValues[0]) {\nreturn applyOpacity(vvColorColors[0]);\n}\nfor (int i = 1; i < vvColorNumber; ++i) {\nif (vvColorValues[i] >= value) {\nfloat f = (value - vvColorValues[i-1]) / (vvColorValues[i] - vvColorValues[i-1]);\nreturn applyOpacity(mix(vvColorColors[i-1], vvColorColors[i], f));\n}\n}\nreturn applyOpacity(vvColorColors[vvColorNumber - 1]);\n}"]))))):e.vertex.code.add(Object(v.a)(l||(l=Object(p.a)(["vec4 getColor(){\nreturn applyOpacity(vec4(1, 1, 1, 1));\n}"])))),e.include(b.a),e.attributes.add("profileRight","vec4"),e.attributes.add("profileUp","vec4"),e.attributes.add("profileVertexAndNormal","vec4"),e.vertex.code.add(Object(v.a)(u||(u=Object(p.a)(["vec3 calculateVPos() {\nvec2 size = getSize();\nvec3 origin = position;\nvec3 right = profileRight.xyz;\nvec3 up = profileUp.xyz;\nvec3 forward = cross(up, right);\nvec2 profileVertex = profileVertexAndNormal.xy * size;\nvec2 profileNormal = profileVertexAndNormal.zw;\nfloat positionOffsetAlongProfilePlaneNormal = 0.0;\nfloat normalOffsetAlongProfilePlaneNormal = 0.0;"])))),e.vertex.code.add(Object(v.a)(d||(d=Object(p.a)(["if(!isCapVertex()) {\nvec2 rotationRight = vec2(profileRight.w, profileUp.w);\nfloat maxDistance = length(rotationRight);"])))),e.vertex.code.add(Object(v.a)(h||(h=Object(p.a)(["rotationRight = maxDistance > 0.0 ? normalize(rotationRight) : vec2(0, 0);\nfloat rx = dot(profileVertex, rotationRight);\nif (abs(rx) > maxDistance) {\nvec2 rotationUp = vec2(-rotationRight.y, rotationRight.x);\nfloat ry = dot(profileVertex, rotationUp);\nprofileVertex = rotationRight * maxDistance * sign(rx) + rotationUp * ry;\n}\n}else{\npositionOffsetAlongProfilePlaneNormal = profileRight.w * size[0];\nnormalOffsetAlongProfilePlaneNormal = profileUp.w;\n}\nvec3 offset = right * profileVertex.x + up * profileVertex.y + forward * positionOffsetAlongProfilePlaneNormal;\nreturn origin + offset;\n}"])))),e.vertex.code.add(Object(v.a)(f||(f=Object(p.a)(["vec3 localNormal() {\nvec3 right = profileRight.xyz;\nvec3 up = profileUp.xyz;\nvec3 forward = cross(up, right);\nvec2 profileNormal = profileVertexAndNormal.zw;\nvec3 normal = right * profileNormal.x + up * profileNormal.y;\nif(isCapVertex()) {\nnormal += forward * profileUp.w;\n}\nreturn normal;\n}"]))))}function y(e,t){t.vvSizeEnabled&&(e.setUniform3fv("vvSizeMinSize",t.vvSizeMinSize),e.setUniform3fv("vvSizeMaxSize",t.vvSizeMaxSize),e.setUniform3fv("vvSizeOffset",t.vvSizeOffset),e.setUniform3fv("vvSizeFactor",t.vvSizeFactor)),t.vvColorEnabled&&(e.setUniform1fv("vvColorValues",t.vvColorValues),e.setUniform4fv("vvColorColors",t.vvColorColors)),t.vvOpacityEnabled&&(e.setUniform1fv("vvOpacityValues",t.vvOpacityValues),e.setUniform1fv("vvOpacityOpacities",t.vvOpacityOpacities))}},function(e,t,r){"use strict";var n=r(2),i=r(5),a=r(6),o=r(7),s=r(0),c=r(27),l=r(1),u=(r(17),r(18),r(15),r(10)),d=r(100),h=function(e){Object(a.a)(r,e);var t=Object(o.a)(r);function r(e){var i;return Object(n.a)(this,r),(i=t.call(this,e)).geometries=null,i.outSpatialReference=null,i.transformation=null,i.transformForward=null,i}return Object(i.a)(r,[{key:"toJSON",value:function(){var e=this.geometries.map((function(e){return e.toJSON()})),t=this.geometries[0],r={};return r.outSR=this.outSpatialReference.wkid||JSON.stringify(this.outSpatialReference.toJSON()),r.inSR=t.spatialReference.wkid||JSON.stringify(t.spatialReference.toJSON()),r.geometries=JSON.stringify({geometryType:Object(d.c)(t),geometries:e}),this.transformation&&(r.transformation=this.transformation.wkid||JSON.stringify(this.transformation)),null!=this.transformForward&&(r.transformForward=this.transformForward),r}}]),r}(c.a);Object(s.a)([Object(l.b)()],h.prototype,"geometries",void 0),Object(s.a)([Object(l.b)({json:{read:{source:"outSR"}}})],h.prototype,"outSpatialReference",void 0),Object(s.a)([Object(l.b)()],h.prototype,"transformation",void 0),Object(s.a)([Object(l.b)()],h.prototype,"transformForward",void 0);var f=h=Object(s.a)([Object(u.a)("esri.rest.support.ProjectParameters")],h);t.a=f},function(e,t,r){"use strict";r.d(t,"a",(function(){return Z}));var n=r(50),i=r(13),a=r(8),o=r.n(a),s=r(16),c=r(3),l=r(31),u=r(2),d=r(5),h=r(22),f=r(15).a.getLogger("esri.views.3d.glTF"),p=function(){function e(){Object(u.a)(this,e)}return Object(d.a)(e,[{key:"error",value:function(e){throw new h.a("gltf-loader-error",e)}},{key:"errorUnsupported",value:function(e){throw new h.a("gltf-loader-unsupported-feature",e)}},{key:"errorUnsupportedIf",value:function(e,t){e&&this.errorUnsupported(t)}},{key:"assert",value:function(e,t){e||this.error(t)}},{key:"warn",value:function(e){f.warn(e)}},{key:"warnUnsupported",value:function(e){this.warn("[Unsupported Feature] "+e)}},{key:"warnUnsupportedIf",value:function(e,t){e&&this.warnUnsupported(t)}}]),e}(),b=r(14);var v=r(134),m=r(39),y=r(401),g=r(26),O=r(193),j=r(196),_=r(32),w=r(400),x=function(){function e(t){Object(u.a)(this,e),this.data=t,this.offset4=0,this.dataUint32=new Uint32Array(this.data,0,Math.floor(this.data.byteLength/4))}return Object(d.a)(e,[{key:"readUint32",value:function(){var e=this.offset4;return this.offset4+=1,this.dataUint32[e]}},{key:"readUint8Array",value:function(e){var t=4*this.offset4;return this.offset4+=e/4,new Uint8Array(this.data,t,e)}},{key:"remainingBytes",value:function(){return this.data.byteLength-4*this.offset4}}]),e}(),k={baseColorFactor:[1,1,1,1],metallicFactor:1,roughnessFactor:1},S={pbrMetallicRoughness:k,emissiveFactor:[0,0,0],alphaMode:"OPAQUE",alphaCutoff:.5,doubleSided:!1},T={ESRI_externalColorMixMode:"tint"},C=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=Object(b.a)(Object(b.a)({},k),e.pbrMetallicRoughness),r=M(Object(b.a)(Object(b.a)({},T),e.extras));return Object(b.a)(Object(b.a)(Object(b.a)({},S),e),{},{pbrMetallicRoughness:t,extras:r})};function M(e){switch(e.ESRI_externalColorMixMode){case"multiply":case"tint":case"ignore":case"replace":break;default:Object(v.a)(e.ESRI_externalColorMixMode),e.ESRI_externalColorMixMode="tint"}return e}var P={magFilter:9729,minFilter:9987,wrapS:10497,wrapT:10497},A=function(e){return Object(b.a)(Object(b.a)({},P),e)};var E=1179937895,R=1313821514,I=5130562,D=function(){function e(t,r,n,i,a){Object(u.a)(this,e),this.context=t,this.errorContext=r,this.uri=n,this.json=i,this.glbBuffer=a,this.bufferCache=new Map,this.textureCache=new Map,this.materialCache=new Map,this.nodeParentMap=new Map,this.nodeTransformCache=new Map,this.baseUri=function(e){var t,r;return e.replace(/^(.*\/)?([^/]*)$/,(function(e,n,i){return t=n||"",r=i||"",""})),{dirPart:t,filePart:r}}(this.uri).dirPart,this.checkVersionSupported(),this.checkRequiredExtensionsSupported(),r.errorUnsupportedIf(null==i.scenes,"Scenes must be defined."),r.errorUnsupportedIf(null==i.meshes,"Meshes must be defined"),r.errorUnsupportedIf(null==i.nodes,"Nodes must be defined."),this.computeNodeParents()}return Object(d.a)(e,[{key:"getBuffer",value:function(){var e=Object(s.a)(o.a.mark((function e(t,r){var n,i,a,s;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this.json.buffers[t],i=this.errorContext,null!=n.uri){e.next=3;break}return e.abrupt("return",(i.assert(null!=this.glbBuffer,"GLB buffer not present"),this.glbBuffer));case 3:if(a=this.bufferCache.get(t)){e.next=9;break}return e.next=7,this.context.loadBinary(this.resolveUri(n.uri),r);case 7:s=e.sent,a=new Uint8Array(s),this.bufferCache.set(t,a),i.assert(a.byteLength===n.byteLength,"Buffer byte lengths should match.");case 9:return e.abrupt("return",a);case 10:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"getAccessor",value:function(){var e=Object(s.a)(o.a.mark((function e(t,r){var n,i,a,s,c,l,u,d;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.json.accessors[t],(i=this.errorContext).errorUnsupportedIf(null==n.bufferView,"Some accessor does not specify a bufferView."),i.errorUnsupportedIf(n.type in["MAT2","MAT3","MAT4"],"AttributeType ".concat(n.type," is not supported")),a=this.json.bufferViews[n.bufferView],e.next=5,this.getBuffer(a.buffer,r);case 5:return s=e.sent,c=V[n.type],l=N[n.componentType],u=c*l,d=a.byteStride||u,e.abrupt("return",{raw:s.buffer,byteStride:d,byteOffset:s.byteOffset+(a.byteOffset||0)+(n.byteOffset||0),entryCount:n.count,isDenselyPacked:d===u,componentCount:c,componentByteSize:l,componentType:n.componentType,min:n.min,max:n.max,normalized:!!n.normalized});case 11:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"getIndexData",value:function(){var e=Object(s.a)(o.a.mark((function e(t,r){var n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=t.indices){e.next=2;break}return e.abrupt("return",null);case 2:return e.next=4,this.getAccessor(t.indices,r);case 4:if(!(n=e.sent).isDenselyPacked){e.next=14;break}e.t0=n.componentType,e.next=5121===e.t0?9:5123===e.t0?10:5125===e.t0?11:12;break;case 9:return e.abrupt("return",new Uint8Array(n.raw,n.byteOffset,n.entryCount));case 10:return e.abrupt("return",new Uint16Array(n.raw,n.byteOffset,n.entryCount));case 11:return e.abrupt("return",new Uint32Array(n.raw,n.byteOffset,n.entryCount));case 12:e.next=20;break;case 14:e.t1=n.componentType,e.next=5121===e.t1?17:5123===e.t1?18:5125===e.t1?19:20;break;case 17:return e.abrupt("return",Object(w.a)(this.wrapAccessor(_.l,n)));case 18:return e.abrupt("return",Object(w.a)(this.wrapAccessor(_.j,n)));case 19:return e.abrupt("return",Object(w.a)(this.wrapAccessor(_.k,n)));case 20:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"getPositionData",value:function(){var e=Object(s.a)(o.a.mark((function e(t,r){var n,i;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(n=this.errorContext).errorUnsupportedIf(null==t.attributes.POSITION,"No POSITION vertex data found."),e.next=4,this.getAccessor(t.attributes.POSITION,r);case 4:return i=e.sent,e.abrupt("return",(n.errorUnsupportedIf(5126!==i.componentType,"Expected type FLOAT for POSITION vertex attribute, but found "+W[i.componentType]),n.errorUnsupportedIf(3!==i.componentCount,"POSITION vertex attribute must have 3 components, but found "+i.componentCount.toFixed()),this.wrapAccessor(_.u,i)));case 6:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"getNormalData",value:function(){var e=Object(s.a)(o.a.mark((function e(t,r){var n,i;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(n=this.errorContext).assert(null!=t.attributes.NORMAL,"No NORMAL vertex data found."),e.next=4,this.getAccessor(t.attributes.NORMAL,r);case 4:return i=e.sent,e.abrupt("return",(n.errorUnsupportedIf(5126!==i.componentType,"Expected type FLOAT for NORMAL vertex attribute, but found "+W[i.componentType]),n.errorUnsupportedIf(3!==i.componentCount,"NORMAL vertex attribute must have 3 components, but found "+i.componentCount.toFixed()),this.wrapAccessor(_.u,i)));case 6:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"getTangentData",value:function(){var e=Object(s.a)(o.a.mark((function e(t,r){var n,i;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(n=this.errorContext).assert(null!=t.attributes.TANGENT,"No TANGENT vertex data found."),e.next=4,this.getAccessor(t.attributes.TANGENT,r);case 4:return i=e.sent,e.abrupt("return",(n.errorUnsupportedIf(5126!==i.componentType,"Expected type FLOAT for TANGENT vertex attribute, but found "+W[i.componentType]),n.errorUnsupportedIf(4!==i.componentCount,"TANGENT vertex attribute must have 4 components, but found "+i.componentCount.toFixed()),new _.C(i.raw,i.byteOffset,i.byteStride,i.byteOffset+i.byteStride*i.entryCount)));case 6:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"getTextureCoordinates",value:function(){var e=Object(s.a)(o.a.mark((function e(t,r){var n,i;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(n=this.errorContext).assert(null!=t.attributes.TEXCOORD_0,"No TEXCOORD_0 vertex data found."),e.next=4,this.getAccessor(t.attributes.TEXCOORD_0,r);case 4:return i=e.sent,e.abrupt("return",(n.errorUnsupportedIf(2!==i.componentCount,"TEXCOORD_0 vertex attribute must have 2 components, but found "+i.componentCount.toFixed()),5126===i.componentType?this.wrapAccessor(_.m,i):(n.errorUnsupportedIf(!i.normalized,"Integer component types are only supported for a normalized accessor for TEXCOORD_0."),U(i))));case 6:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"getVertexColors",value:function(){var e=Object(s.a)(o.a.mark((function e(t,r){var n,i;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(n=this.errorContext).assert(null!=t.attributes.COLOR_0,"No COLOR_0 vertex data found."),e.next=4,this.getAccessor(t.attributes.COLOR_0,r);case 4:if(i=e.sent,n.errorUnsupportedIf(4!==i.componentCount&&3!==i.componentCount,"COLOR_0 attribute must have 3 or 4 components, but found "+i.componentCount.toFixed()),4!==i.componentCount){e.next=14;break}if(5126!==i.componentType){e.next=8;break}return e.abrupt("return",this.wrapAccessor(_.C,i));case 8:if(5121!==i.componentType){e.next=10;break}return e.abrupt("return",this.wrapAccessor(_.J,i));case 10:if(5123!==i.componentType){e.next=12;break}return e.abrupt("return",this.wrapAccessor(_.H,i));case 12:e.next=21;break;case 14:if(3!==i.componentCount){e.next=21;break}if(5126!==i.componentType){e.next=17;break}return e.abrupt("return",this.wrapAccessor(_.u,i));case 17:if(5121!==i.componentType){e.next=19;break}return e.abrupt("return",this.wrapAccessor(_.B,i));case 19:if(5123!==i.componentType){e.next=21;break}return e.abrupt("return",this.wrapAccessor(_.z,i));case 21:n.errorUnsupported("Unsupported component type for COLOR_0 attribute: "+W[i.componentType]);case 22:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"hasPositions",value:function(e){return void 0!==e.attributes.POSITION}},{key:"hasNormals",value:function(e){return void 0!==e.attributes.NORMAL}},{key:"hasVertexColors",value:function(e){return void 0!==e.attributes.COLOR_0}},{key:"hasTextureCoordinates",value:function(e){return void 0!==e.attributes.TEXCOORD_0}},{key:"hasTangents",value:function(e){return void 0!==e.attributes.TANGENT}},{key:"getMaterial",value:function(){var e=Object(s.a)(o.a.mark((function e(t,r,n){var i,a,s,c,l,u,d,h,f,p,b;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=this.errorContext,a=this.materialCache.get(t.material)){e.next=48;break}if(s=null!=t.material?C(this.json.materials[t.material]):C(),c=s.pbrMetallicRoughness,l=this.hasVertexColors(t),e.t0=c.baseColorTexture,!e.t0){e.next=10;break}return i.errorUnsupportedIf(0!==(c.baseColorTexture.texCoord||0),"Only TEXCOORD with index 0 is supported."),e.next=9,this.getTexture(c.baseColorTexture.index,r);case 9:u=e.sent;case 10:if(e.t1=s.normalTexture,!e.t1){e.next=19;break}if(0===(s.normalTexture.texCoord||0)){e.next=16;break}i.warnUnsupported("Only TEXCOORD with index 0 is supported for the normal map texture."),e.next=19;break;case 16:return e.next=18,this.getTexture(s.normalTexture.index,r);case 18:d=e.sent;case 19:if(e.t2=s.occlusionTexture&&n,!e.t2){e.next=28;break}if(0===(s.occlusionTexture.texCoord||0)){e.next=25;break}i.warnUnsupported("Only TEXCOORD with index 0 is supported for the occlusion texture."),e.next=28;break;case 25:return e.next=27,this.getTexture(s.occlusionTexture.index,r);case 27:h=e.sent;case 28:if(e.t3=s.emissiveTexture&&n,!e.t3){e.next=37;break}if(0===(s.emissiveTexture.texCoord||0)){e.next=34;break}i.warnUnsupported("Only TEXCOORD with index 0 is supported for the emissive texture."),e.next=37;break;case 34:return e.next=36,this.getTexture(s.emissiveTexture.index,r);case 36:f=e.sent;case 37:if(e.t4=c.metallicRoughnessTexture&&n,!e.t4){e.next=46;break}if(0===(c.metallicRoughnessTexture.texCoord||0)){e.next=43;break}i.warnUnsupported("Only TEXCOORD with index 0 is supported for the metallicRoughness texture."),e.next=46;break;case 43:return e.next=45,this.getTexture(c.metallicRoughnessTexture.index,r);case 45:p=e.sent;case 46:b=null!=t.material?t.material:-1,a={alphaMode:s.alphaMode,alphaCutoff:s.alphaCutoff,color:c.baseColorFactor,doubleSided:!!s.doubleSided,colorTexture:u,normalTexture:d,name:s.name,id:b,occlusionTexture:h,emissiveTexture:f,emissiveFactor:s.emissiveFactor,metallicFactor:c.metallicFactor,roughnessFactor:c.roughnessFactor,metallicRoughnessTexture:p,vertexColors:l,ESRI_externalColorMixMode:s.extras.ESRI_externalColorMixMode};case 48:return e.abrupt("return",a);case 49:case"end":return e.stop()}}),e,this)})));return function(t,r,n){return e.apply(this,arguments)}}()},{key:"getTexture",value:function(){var e=Object(s.a)(o.a.mark((function e(t,r){var n,i,a,s,c,l,u,d,h,f;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this.errorContext,i=this.json.textures[t],a=A(null!=i.sampler?this.json.samplers[i.sampler]:{}),n.errorUnsupportedIf(null==i.source,"Source is expected to be defined for a texture."),s=this.json.images[i.source],c=this.textureCache.get(t)){e.next=22;break}if(!s.uri){e.next=11;break}return e.next=8,this.context.loadImage(this.resolveUri(s.uri),r);case 8:l=e.sent,e.next=20;break;case 11:return n.errorUnsupportedIf(null==s.bufferView,"Image bufferView must be defined."),n.errorUnsupportedIf(null==s.mimeType,"Image mimeType must be defined."),u=this.json.bufferViews[s.bufferView],e.next=15,this.getBuffer(u.buffer,r);case 15:return d=e.sent,n.errorUnsupportedIf(null!=u.byteStride,"byteStride not supported for image buffer"),e.next=19,q(new Uint8Array(d.buffer,d.byteOffset+(u.byteOffset||0),u.byteLength),s.mimeType);case 19:l=e.sent;case 20:f=function(e){return n.error("Unexpected TextureSampler WrapMode: ".concat(e,". Using default REPEAT(10497).")),10497},c={data:l,wrapS:(h=function(e){return 33071===e||33648===e||10497===e})(a.wrapS)?a.wrapS:f(a.wrapS),wrapT:h(a.wrapT)?a.wrapT:f(a.wrapT),minFilter:a.minFilter,name:s.name,id:t},this.textureCache.set(t,c);case 22:return e.abrupt("return",c);case 23:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"getNodeTransform",value:function(e){if(void 0===e)return L;var t=this.nodeTransformCache.get(e);if(!t){var r=this.getNodeTransform(this.getNodeParent(e)),n=this.json.nodes[e];n.matrix?t=Object(g.m)(Object(l.d)(),r,n.matrix):n.translation||n.rotation||n.scale?(t=Object(l.c)(r),n.translation&&Object(g.t)(t,t,n.translation),n.rotation&&(z[3]=Object(O.c)(z,n.rotation),Object(g.c)(t,t,z[3],z)),n.scale&&Object(g.s)(t,t,n.scale)):t=r,this.nodeTransformCache.set(e,t)}return t}},{key:"wrapAccessor",value:function(e,t){return new e(t.raw,t.byteOffset,t.byteStride,t.byteOffset+t.byteStride*(t.entryCount-1)+t.componentByteSize*t.componentCount)}},{key:"resolveUri",value:function(e){return Object(m.A)(e,this.baseUri)}},{key:"getNodeParent",value:function(e){return this.nodeParentMap.get(e)}},{key:"checkVersionSupported",value:function(){var e=y.a.parse(this.json.asset.version,"glTF");F.validate(e)}},{key:"checkRequiredExtensionsSupported",value:function(){var e=this.json,t=this.errorContext;e.extensionsRequired&&0!==e.extensionsRequired.length&&t.errorUnsupported("gltf loader was not able to load unsupported feature. Required extensions: "+e.extensionsRequired.join(", "))}},{key:"computeNodeParents",value:function(){var e=this;this.json.nodes.forEach((function(t,r){t.children&&t.children.forEach((function(t){e.nodeParentMap.set(t,r)}))}))}}],[{key:"load",value:function(){var t=Object(s.a)(o.a.mark((function t(r,n,i,a){var s,c,l,u,d,h;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!Object(m.u)(i)){t.next=13;break}if("model/gltf-binary"===(s=Object(m.i)(i)).mediaType){t.next=10;break}return t.prev=3,c=JSON.parse(s.isBase64?atob(s.data):s.data),t.abrupt("return",new e(r,n,i,c));case 8:t.prev=8,t.t0=t.catch(3);case 10:if(l=Object(m.j)(i),!e.isGLBData(l)){t.next=13;break}return t.abrupt("return",this.fromGLBData(r,n,i,l));case 13:if(!i.endsWith(".gltf")){t.next=18;break}return t.next=16,r.loadJSON(i,a);case 16:return u=t.sent,t.abrupt("return",new e(r,n,i,u));case 18:return t.next=20,r.loadBinary(i,a);case 20:if(d=t.sent,!e.isGLBData(d)){t.next=23;break}return t.abrupt("return",this.fromGLBData(r,n,i,d));case 23:return t.next=25,r.loadJSON(i,a);case 25:return h=t.sent,t.abrupt("return",new e(r,n,i,h));case 27:case"end":return t.stop()}}),t,this,[[3,8]])})));return function(e,r,n,i){return t.apply(this,arguments)}}()},{key:"isGLBData",value:function(e){var t=new x(e);return t.remainingBytes()>=4&&t.readUint32()===E}},{key:"fromGLBData",value:function(){var t=Object(s.a)(o.a.mark((function t(r,n,i,a){var s;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.parseGLBData(n,a);case 2:return s=t.sent,t.abrupt("return",new e(r,n,i,s.json,s.binaryData));case 4:case"end":return t.stop()}}),t)})));return function(e,r,n,i){return t.apply(this,arguments)}}()},{key:"parseGLBData",value:function(){var e=Object(s.a)(o.a.mark((function e(t,r){var n,i,a,s,c,l,u,d,h;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=new x(r),t.assert(n.remainingBytes()>=12,"GLB binary data is insufficiently large."),i=n.readUint32(),a=n.readUint32(),s=n.readUint32(),t.assert(i===E,"Magic first 4 bytes do not fit to expected GLB value."),t.assert(r.byteLength>=s,"GLB binary data is smaller than header specifies."),t.errorUnsupportedIf(2!==a,"An unsupported GLB container version was detected. Only version 2 is supported."),u=0;case 5:if(!(n.remainingBytes()>=8)){e.next=19;break}if(d=n.readUint32(),h=n.readUint32(),0!==u){e.next=15;break}return t.assert(h===R,"First GLB chunk must be JSON."),t.assert(d>=0,"No JSON data found."),e.next=12,B(n.readUint8Array(d));case 12:c=e.sent,e.next=16;break;case 15:1===u?(t.errorUnsupportedIf(h!==I,"Second GLB chunk expected to be BIN."),l=n.readUint8Array(d)):t.warnUnsupported("More than 2 GLB chunks detected. Skipping.");case 16:u+=1;case 17:e.next=5;break;case 19:return e.abrupt("return",(c||t.error("No GLB JSON chunk detected."),{json:c,binaryData:l}));case 20:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}()}]),e}(),F=new y.a(2,0,"glTF"),L=Object(g.n)(Object(l.d)(),Math.PI/2),z=Object(j.b)(),V={SCALAR:1,VEC2:2,VEC3:3,VEC4:4},N={5120:1,5121:1,5122:2,5123:2,5126:4,5125:4};function U(e){switch(e.componentType){case 5120:return new _.q(e.raw,e.byteOffset,e.byteStride,e.byteOffset+e.byteStride*e.entryCount);case 5121:return new _.t(e.raw,e.byteOffset,e.byteStride,e.byteOffset+e.byteStride*e.entryCount);case 5122:return new _.o(e.raw,e.byteOffset,e.byteStride,e.byteOffset+e.byteStride*e.entryCount);case 5123:return new _.r(e.raw,e.byteOffset,e.byteStride,e.byteOffset+e.byteStride*e.entryCount);case 5125:return new _.s(e.raw,e.byteOffset,e.byteStride,e.byteOffset+e.byteStride*e.entryCount);case 5126:return new _.m(e.raw,e.byteOffset,e.byteStride,e.byteOffset+e.byteStride*e.entryCount);default:return void Object(v.a)(e.componentType)}}function B(e){return G.apply(this,arguments)}function G(){return(G=Object(s.a)(o.a.mark((function e(t){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,r){var n=new Blob([t]),i=new FileReader;i.onload=function(){var t=i.result;e(JSON.parse(t))},i.onerror=function(e){r(e)},i.readAsText(n)})));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function q(e,t){return H.apply(this,arguments)}function H(){return(H=Object(s.a)(o.a.mark((function e(t,r){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,n){var i=new Blob([t],{type:r}),a=URL.createObjectURL(i),o=new Image;o.addEventListener("load",(function(){URL.revokeObjectURL(a),"decode"in o?o.decode().then((function(){return e(o)}),(function(){return e(o)})):e(o)})),o.addEventListener("error",(function(e){URL.revokeObjectURL(a),n(e)})),o.src=a})));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var W={5120:"BYTE",5121:"UNSIGNED_BYTE",5122:"SHORT",5123:"UNSIGNED_SHORT",5125:"UNSIGNED_INT",5126:"FLOAT"},Q=0;function Z(e,t){return X.apply(this,arguments)}function X(){return(X=Object(s.a)(o.a.mark((function e(t,r){var n,i,a,u,d,h,f=arguments;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=f.length>2&&void 0!==f[2]?f[2]:{},i=!(f.length>3&&void 0!==f[3])||f[3],e.next=4,D.load(t,te,r,n);case 4:return a=e.sent,u="gltf_"+Q++,d={lods:[],materials:new Map,textures:new Map,meta:Y(a)},h=!(!a.json.asset.extras||"symbolResource"!==a.json.asset.extras.ESRI_type),e.next=10,$(a,function(){var e=Object(s.a)(o.a.mark((function e(t,r,s,h){var f,p,b,v,m;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(f=void 0!==t.mode?t.mode:4,p=4===f||5===f||6===f?f:null,!Object(c.i)(p)){e.next=3;break}return e.abrupt("return",void te.warnUnsupported("Unsupported primitive mode ("+ne[f]+"). Skipping primitive."));case 3:if(a.hasPositions(t)){e.next=5;break}return e.abrupt("return",void te.warn("Skipping primitive without POSITION vertex attribute."));case 5:return e.next=7,a.getMaterial(t,n,i);case 7:return b=e.sent,e.t0=Object(l.c)(r),e.next=11,a.getPositionData(t,n);case 11:return e.t1=e.sent,e.t2={position:e.t1,normal:null,texCoord0:null,color:null,tangent:null},e.next=15,a.getIndexData(t,n);case 15:if(e.t3=e.sent,e.t4=p,e.t5=ee(d,b,u),v={transform:e.t0,attributes:e.t2,indices:e.t3,primitiveType:e.t4,material:e.t5},e.t6=a.hasNormals(t),!e.t6){e.next=24;break}return e.next=23,a.getNormalData(t,n);case 23:v.attributes.normal=e.sent;case 24:if(e.t7=a.hasTangents(t),!e.t7){e.next=29;break}return e.next=28,a.getTangentData(t,n);case 28:v.attributes.tangent=e.sent;case 29:if(e.t8=a.hasTextureCoordinates(t),!e.t8){e.next=34;break}return e.next=33,a.getTextureCoordinates(t,n);case 33:v.attributes.texCoord0=e.sent;case 34:if(e.t9=a.hasVertexColors(t),!e.t9){e.next=39;break}return e.next=38,a.getVertexColors(t,n);case 38:v.attributes.color=e.sent;case 39:m=null,Object(c.j)(d.meta)&&Object(c.j)(d.meta.ESRI_lod)&&"screenSpaceRadius"===d.meta.ESRI_lod.metric&&(m=d.meta.ESRI_lod.thresholds[s]),d.lods[s]=d.lods[s]||{parts:[],name:h,lodThreshold:m},d.lods[s].parts.push(v);case 41:case"end":return e.stop()}}),e)})));return function(t,r,n,i){return e.apply(this,arguments)}}());case 10:return e.abrupt("return",{model:d,meta:{isEsriSymbolResource:h,uri:a.uri},customMeta:{}});case 11:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Y(e){var t=e.json,r=null;return t.nodes.forEach((function(e){var t=e.extras;Object(c.j)(t)&&(t.ESRI_proxyEllipsoid||t.ESRI_lod)&&(r=t)})),r}function $(e,t){return J.apply(this,arguments)}function J(){return(J=Object(s.a)(o.a.mark((function e(t,r){var a,c,l,u,d,h,f,p,b,v,m;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:m=function(){return(m=Object(s.a)(o.a.mark((function e(n,s){var c,l,u,d,h,f,p,b,m;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(c=a.nodes[n],l=t.getNodeTransform(n),te.warnUnsupportedIf(null!=c.weights,"Morph targets are not supported."),null==c.mesh){e.next=20;break}u=a.meshes[c.mesh],d=Object(i.a)(u.primitives),e.prev=4,d.s();case 6:if((h=d.n()).done){e.next=12;break}return f=h.value,e.next=10,r(f,l,s,u.name);case 10:e.next=6;break;case 12:e.next=17;break;case 14:e.prev=14,e.t0=e.catch(4),d.e(e.t0);case 17:return e.prev=17,d.f(),e.finish(17);case 20:p=Object(i.a)(c.children||[]),e.prev=21,p.s();case 23:if((b=p.n()).done){e.next=29;break}return m=b.value,e.next=27,v(m,s);case 27:e.next=23;break;case 29:e.next=34;break;case 31:e.prev=31,e.t1=e.catch(21),p.e(e.t1);case 34:return e.prev=34,p.f(),e.finish(34);case 37:case"end":return e.stop()}}),e,null,[[4,14,17,20],[21,31,34,37]])})))).apply(this,arguments)},v=function(e,t){return m.apply(this,arguments)},a=t.json,c=a.scenes[a.scene||0].nodes,l=c.length>1,u=Object(i.a)(c),e.prev=4,u.s();case 6:if((d=u.n()).done){e.next=14;break}return h=d.value,f=a.nodes[h],p=[v(h,0)],K(f)&&!l&&(b=f.extensions.MSFT_lod.ids,p.push.apply(p,Object(n.a)(b.map((function(e,t){return v(e,t+1)}))))),e.next=12,Promise.all(p);case 12:e.next=6;break;case 14:e.next=19;break;case 16:e.prev=16,e.t0=e.catch(4),u.e(e.t0);case 19:return e.prev=19,u.f(),e.finish(19);case 22:case"end":return e.stop()}}),e,null,[[4,16,19,22]])})))).apply(this,arguments)}function K(e){return e.extensions&&e.extensions.MSFT_lod&&Array.isArray(e.extensions.MSFT_lod.ids)}function ee(e,t,r){var n=function(t){var n="".concat(r,"_tex_").concat(t&&t.id).concat(t&&t.name?"_"+t.name:"");if(t&&!e.textures.has(n)){var i=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return{data:e,parameters:Object(b.a)({wrap:Object(b.a)({s:10497,t:10497},t.wrap),noUnpackFlip:!0,mipmap:!1},t)}}(t.data,{wrap:{s:t.wrapS,t:t.wrapT},mipmap:re.some((function(e){return e===t.minFilter})),noUnpackFlip:!0});e.textures.set(n,i)}return n},i="".concat(r,"_mat_").concat(t.id,"_").concat(t.name);if(!e.materials.has(i)){var a=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(b.a)({color:[1,1,1],opacity:1,alphaMode:"OPAQUE",alphaCutoff:.5,doubleSided:!1,castShadows:!0,receiveShadows:!0,receiveAmbientOcclustion:!0,textureColor:null,textureNormal:null,textureOcclusion:null,textureEmissive:null,textureMetallicRoughness:null,emissiveFactor:[0,0,0],metallicFactor:1,roughnessFactor:1,colorMixMode:"multiply"},e)}({color:[t.color[0],t.color[1],t.color[2]],opacity:t.color[3],alphaMode:t.alphaMode,alphaCutoff:t.alphaCutoff,doubleSided:t.doubleSided,colorMixMode:t.ESRI_externalColorMixMode,textureColor:t.colorTexture?n(t.colorTexture):void 0,textureNormal:t.normalTexture?n(t.normalTexture):void 0,textureOcclusion:t.occlusionTexture?n(t.occlusionTexture):void 0,textureEmissive:t.emissiveTexture?n(t.emissiveTexture):void 0,textureMetallicRoughness:t.metallicRoughnessTexture?n(t.metallicRoughnessTexture):void 0,emissiveFactor:[t.emissiveFactor[0],t.emissiveFactor[1],t.emissiveFactor[2]],metallicFactor:t.metallicFactor,roughnessFactor:t.roughnessFactor});e.materials.set(i,a)}return i}var te=new p,re=[9987,9985],ne=["POINTS","LINES","LINE_LOOP","LINE_STRIP","TRIANGLES","TRIANGLE_STRIP","TRIANGLE_FAN"]},function(e,t,r){"use strict";r.d(t,"a",(function(){return x}));var n=r(14),i=r(2),a=r(5),o=r(6),s=r(7),c=r(0),l=r(49),u=r(27),d=r(25),h=r(28),f=r(1),p=(r(18),r(17),r(15),r(10)),b=r(131),v=function(e){Object(o.a)(r,e);var t=Object(s.a)(r);function r(e){var n;return Object(i.a)(this,r),(n=t.call(this,e)).color=new l.a([0,0,0,1]),n.extensionLength=0,n.size=Object(h.h)(1),n}return Object(a.a)(r,[{key:"clone",value:function(){}},{key:"cloneProperties",value:function(){return{color:Object(d.a)(this.color),size:this.size,extensionLength:this.extensionLength}}}]),r}(u.a);Object(c.a)([Object(f.b)({type:["solid","sketch"],readOnly:!0,json:{read:!0,write:{ignoreOrigin:!0}}})],v.prototype,"type",void 0),Object(c.a)([Object(f.b)(b.a)],v.prototype,"color",void 0),Object(c.a)([Object(f.b)(Object(n.a)(Object(n.a)({},b.b),{},{json:{write:{overridePolicy:function(e){return{enabled:!!e}}}}}))],v.prototype,"extensionLength",void 0),Object(c.a)([Object(f.b)(b.b)],v.prototype,"size",void 0);var m,y=v=Object(c.a)([Object(p.a)("esri.symbols.edges.Edges3D")],v),g=r(52),O=m=function(e){Object(o.a)(r,e);var t=Object(s.a)(r);function r(e){var n;return Object(i.a)(this,r),(n=t.call(this,e)).type="sketch",n}return Object(a.a)(r,[{key:"clone",value:function(){return new m(this.cloneProperties())}}]),r}(y);Object(c.a)([Object(g.a)({sketch:"sketch"},{readOnly:!0})],O.prototype,"type",void 0);var j,_=O=m=Object(c.a)([Object(p.a)("esri.symbols.edges.SketchEdges3D")],O),w=j=function(e){Object(o.a)(r,e);var t=Object(s.a)(r);function r(e){var n;return Object(i.a)(this,r),(n=t.call(this,e)).type="solid",n}return Object(a.a)(r,[{key:"clone",value:function(){return new j(this.cloneProperties())}}]),r}(y);Object(c.a)([Object(g.a)({solid:"solid"},{readOnly:!0})],w.prototype,"type",void 0);var x={types:{key:"type",base:y,typeMap:{solid:w=j=Object(c.a)([Object(p.a)("esri.symbols.support.SolidEdges3D")],w),sketch:_}},json:{write:!0}}},function(e,t,r){"use strict";var n,i=r(2),a=r(5),o=r(6),s=r(7),c=r(0),l=r(232),u=r(365),d=r(27),h=r(25),f=r(3),p=r(1),b=(r(18),r(17),r(15),r(48)),v=r(10),m=r(44),y=n=function(e){Object(o.a)(r,e);var t=Object(s.a)(r);function r(e){var n;return Object(i.a)(this,r),(n=t.call(this,e)).respectsDaylightSaving=!1,n.timezone=null,n}return Object(a.a)(r,[{key:"readRespectsDaylightSaving",value:function(e,t){return void 0!==t.respectsDaylightSaving?t.respectsDaylightSaving:void 0!==t.respectDaylightSaving&&t.respectDaylightSaving}},{key:"clone",value:function(){var e=this.respectsDaylightSaving,t=this.timezone;return new n({respectsDaylightSaving:e,timezone:t})}}]),r}(d.a);Object(c.a)([Object(p.b)({type:Boolean,json:{write:!0}})],y.prototype,"respectsDaylightSaving",void 0),Object(c.a)([Object(b.a)("respectsDaylightSaving",["respectsDaylightSaving","respectDaylightSaving"])],y.prototype,"readRespectsDaylightSaving",null),Object(c.a)([Object(p.b)({type:String,json:{read:{source:"timeZone"},write:{target:"timeZone"}}})],y.prototype,"timezone",void 0);var g,O=y=n=Object(c.a)([Object(v.a)("esri.layers.support.TimeReference")],y),j=r(297),_=g=function(e){Object(o.a)(r,e);var t=Object(s.a)(r);function r(e){var n;return Object(i.a)(this,r),(n=t.call(this,e)).cumulative=!1,n.endField=null,n.fullTimeExtent=null,n.hasLiveData=!1,n.interval=null,n.startField=null,n.timeReference=null,n.trackIdField=null,n.useTime=!0,n}return Object(a.a)(r,[{key:"readFullTimeExtent",value:function(e,t){if(!t.timeExtent||!Array.isArray(t.timeExtent)||2!==t.timeExtent.length)return null;var r=new Date(t.timeExtent[0]),n=new Date(t.timeExtent[1]);return new l.a({start:r,end:n})}},{key:"writeFullTimeExtent",value:function(e,t){e&&Object(f.j)(e.start)&&Object(f.j)(e.end)?t.timeExtent=[e.start.getTime(),e.end.getTime()]:t.timeExtent=null}},{key:"readInterval",value:function(e,t){return t.timeInterval&&t.timeIntervalUnits?new u.a({value:t.timeInterval,unit:j.a.fromJSON(t.timeIntervalUnits)}):t.defaultTimeInterval&&t.defaultTimeIntervalUnits?new u.a({value:t.defaultTimeInterval,unit:j.a.fromJSON(t.defaultTimeIntervalUnits)}):null}},{key:"writeInterval",value:function(e,t){if(e){var r=e.toJSON();t.timeInterval=r.value,t.timeIntervalUnits=r.unit}else t.timeInterval=null,t.timeIntervalUnits=null}},{key:"clone",value:function(){var e=this.cumulative,t=this.endField,r=this.hasLiveData,n=this.interval,i=this.startField,a=this.timeReference,o=this.fullTimeExtent,s=this.trackIdField,c=this.useTime;return new g({cumulative:e,endField:t,hasLiveData:r,interval:n,startField:i,timeReference:Object(h.a)(a),fullTimeExtent:Object(h.a)(o),trackIdField:s,useTime:c})}}]),r}(d.a);Object(c.a)([Object(p.b)({type:Boolean,json:{read:{source:"exportOptions.timeDataCumulative"},write:{target:"exportOptions.timeDataCumulative"}}})],_.prototype,"cumulative",void 0),Object(c.a)([Object(p.b)({type:String,json:{read:{source:"endTimeField"},write:{target:"endTimeField",allowNull:!0}}})],_.prototype,"endField",void 0),Object(c.a)([Object(p.b)({type:l.a,json:{write:{enabled:!0,allowNull:!0}}})],_.prototype,"fullTimeExtent",void 0),Object(c.a)([Object(b.a)("fullTimeExtent",["timeExtent"])],_.prototype,"readFullTimeExtent",null),Object(c.a)([Object(m.a)("fullTimeExtent")],_.prototype,"writeFullTimeExtent",null),Object(c.a)([Object(p.b)({type:Boolean,json:{write:!0}})],_.prototype,"hasLiveData",void 0),Object(c.a)([Object(p.b)({type:u.a,json:{write:{enabled:!0,allowNull:!0}}})],_.prototype,"interval",void 0),Object(c.a)([Object(b.a)("interval",["timeInterval","timeIntervalUnits","defaultTimeInterval","defaultTimeIntervalUnits"])],_.prototype,"readInterval",null),Object(c.a)([Object(m.a)("interval")],_.prototype,"writeInterval",null),Object(c.a)([Object(p.b)({type:String,json:{read:{source:"startTimeField"},write:{target:"startTimeField",allowNull:!0}}})],_.prototype,"startField",void 0),Object(c.a)([Object(p.b)({type:O,json:{write:{enabled:!0,allowNull:!0}}})],_.prototype,"timeReference",void 0),Object(c.a)([Object(p.b)({type:String,json:{write:{enabled:!0,allowNull:!0}}})],_.prototype,"trackIdField",void 0),Object(c.a)([Object(p.b)({type:Boolean,json:{read:{source:"exportOptions.useTime"},write:{target:"exportOptions.useTime"}}})],_.prototype,"useTime",void 0);var w=_=g=Object(c.a)([Object(v.a)("esri.layers.support.TimeInfo")],_);t.a=w},function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var n=r(50);function i(e){return function(t){t.hasOwnProperty("_delegatedEventNames")||(t._delegatedEventNames=t._delegatedEventNames?t._delegatedEventNames.slice():[]);var r=t._delegatedEventNames,i=Array.isArray(e)?e:function(e){return e.split(",").map((function(e){return e.trim()}))}(e);r.push.apply(r,Object(n.a)(i))}}},function(e,t,r){"use strict";r.d(t,"a",(function(){return p}));var n,i=r(12),a=r(529),o=r(11);function s(e){e.fragment.code.add(Object(o.a)(n||(n=Object(i.a)(["const float GAMMA = 2.2;\nconst float INV_GAMMA = 0.4545454545;\nvec4 delinearizeGamma(vec4 color) {\nreturn vec4(pow(color.rgb, vec3(INV_GAMMA)), color.w);\n}\nvec3 linearizeGamma(vec3 color) {\nreturn pow(color, vec3(GAMMA));\n}"]))))}var c,l,u,d,h=r(320),f=r(333);function p(e,t){e.include(h.a,t),e.include(s),e.include(a.a),t.ssrEnabled&&e.include(f.a,t),e.fragment.constants.add("fresnelSky","vec3",[.02,1,15]).add("fresnelMaterial","vec2",[.02,.1]).add("roughness","float",.015).add("foamIntensityExternal","float",1.7).add("ssrIntensity","float",.65).add("ssrHeightFadeStart","float",3e5).add("ssrHeightFadeEnd","float",5e5).add("waterDiffusion","float",.775).add("waterSeeColorMod","float",.8).add("correctionViewingPowerFactor","float",.4).add("skyZenitColor","vec3",[.52,.68,.9]).add("skyColor","vec3",[.67,.79,.9]),e.fragment.code.add(Object(o.a)(c||(c=Object(i.a)(["PBRShadingWater shadingInfo;\nvec3 getSkyGradientColor(in float cosTheta, in vec3 horizon, in vec3 zenit) {\nfloat exponent = pow((1.0 - cosTheta), fresnelSky[2]);\nreturn mix(zenit, horizon, exponent);\n}"])))),e.fragment.code.add(Object(o.a)(l||(l=Object(i.a)(["vec3 getSeaColor(in vec3 n, in vec3 v, in vec3 l, vec3 color, in vec3 lightIntensity, in vec3 localUp, in float shadow, float foamIntensity, vec3 positionView) {\nfloat reflectionHit = 0.;\nvec3 seaWaterColor = linearizeGamma(color);\nvec3 h = normalize(l + v);\nshadingInfo.NdotL = clamp(dot(n, l), 0.0, 1.0);\nshadingInfo.NdotV = clamp(dot(n, v), 0.001, 1.0);\nshadingInfo.VdotN = clamp(dot(v, n), 0.001, 1.0);\nshadingInfo.NdotH = clamp(dot(n, h), 0.0, 1.0);\nshadingInfo.VdotH = clamp(dot(v, h), 0.0, 1.0);\nshadingInfo.LdotH = clamp(dot(l, h), 0.0, 1.0);\nfloat upDotV = max(dot(localUp,v), 0.0);\nvec3 skyHorizon = linearizeGamma(skyColor);\nvec3 skyZenit = linearizeGamma(skyZenitColor);\nvec3 skyColor = getSkyGradientColor(upDotV, skyHorizon, skyZenit );\nfloat upDotL = max(dot(localUp,l),0.0);\nfloat daytimeMod = 0.1 + upDotL * 0.9;\nskyColor *= daytimeMod;\nfloat shadowModifier = clamp(shadow, 0.8, 1.0);\nvec3 fresnelModifier = fresnelReflection(shadingInfo.VdotN, vec3(fresnelSky[0]), fresnelSky[1]);\nvec3 reflSky = fresnelModifier * skyColor * shadowModifier;\nvec3 reflSea = seaWaterColor * mix(skyColor, upDotL * lightIntensity * LIGHT_NORMALIZATION, 2.0 / 3.0) * shadowModifier;\nvec3 specular = vec3(0.0);\nif(upDotV > 0.0 && upDotL > 0.0) {\nvec3 specularSun = brdfSpecularWater(shadingInfo, roughness, vec3(fresnelMaterial[0]), fresnelMaterial[1]);\nvec3 incidentLight = lightIntensity * LIGHT_NORMALIZATION * shadow;\nspecular = shadingInfo.NdotL * incidentLight * specularSun;\n}\nvec3 foam = vec3(0.0);\nif(upDotV > 0.0) {\nfoam = foamIntensity2FoamColor(foamIntensityExternal, foamIntensity, skyZenitColor, daytimeMod);\n}"])))),t.ssrEnabled?e.fragment.code.add(Object(o.a)(u||(u=Object(i.a)(["vec4 viewPosition = vec4(positionView.xyz, 1.0);\nvec3 viewDir = normalize(viewPosition.xyz);\nvec4 viewNormalVectorCoordinate = ssrViewMat *vec4(n, 0.0);\nvec3 viewNormal = normalize(viewNormalVectorCoordinate.xyz);\nvec4 viewUp = ssrViewMat *vec4(localUp, 0.0);\nfloat correctionViewingFactor = pow(max(dot(-viewDir, viewUp.xyz), 0.0), correctionViewingPowerFactor);\nvec3 viewNormalCorrected = mix(viewUp.xyz, viewNormal, correctionViewingFactor);\nvec3 reflected = normalize(reflect(viewDir, viewNormalCorrected));\nvec3 hitCoordinate = screenSpaceIntersection( normalize(reflected), viewPosition.xyz, viewDir, viewUp.xyz);\nvec3 reflectedColor = vec3(0.0);\nif (hitCoordinate.z > 0.0)\n{\nvec2 reprojectedCoordinate = reprojectionCoordinate(hitCoordinate);\nvec2 dCoords = smoothstep(0.3, 0.6, abs(vec2(0.5, 0.5) - hitCoordinate.xy));\nfloat heightMod = smoothstep(ssrHeightFadeEnd, ssrHeightFadeStart, -positionView.z);\nreflectionHit = waterDiffusion * clamp(1.0 - (1.3*dCoords.y), 0.0, 1.0) * heightMod;\nreflectedColor = linearizeGamma(texture2D(lastFrameColorMap, reprojectedCoordinate).xyz)* reflectionHit * fresnelModifier.y * ssrIntensity;\n}\nfloat seeColorMod =  mix(waterSeeColorMod, waterSeeColorMod*0.5, reflectionHit);\nreturn tonemapACES((1. - reflectionHit) * reflSky + reflectedColor + reflSea * seeColorMod + specular + foam);\n}"])))):e.fragment.code.add(Object(o.a)(d||(d=Object(i.a)(["return tonemapACES(reflSky + reflSea * waterSeeColorMod + specular + foam);\n}"]))))}},function(e,t,r){"use strict";function n(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}r.d(t,"a",(function(){return n}))},function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r(2),i=r(5),a=r(101),o=function(){function e(t,r){Object(n.a)(this,e),this._observers=t,this._observer=r}return Object(i.a)(e,[{key:"remove",value:function(){Object(a.j)(this._observers,this._observer)}}]),e}()},function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r(13),i=(r(17),r(15)),a=r(200);function o(e,t,r){if(e&&t)if("object"==typeof t){var i,s=Object(n.a)(Object.getOwnPropertyNames(t));try{for(s.s();!(i=s.n()).done;){var c=i.value;o(e,c,t[c])}}catch(d){s.e(d)}finally{s.f()}}else{if(-1!==t.indexOf(".")){var l=t.split("."),u=l.splice(l.length-1,1)[0];return void o(Object(a.b)(e,l),u,r)}e[t]=r}}i.a.getLogger("esri.core.accessorSupport.set")},function(e,t,r){"use strict";r.d(t,"a",(function(){return u}));var n=r(2),i=r(5),a=r(45),o=r(42),s=r(6),c=r(7),l=r(3),u=function(e){Object(s.a)(r,e);var t=Object(c.a)(r);function r(){var e;return Object(n.a)(this,r),(e=t.apply(this,arguments))._set=new Set,e}return Object(i.a)(r,[{key:"destroy",value:function(){Object(a.a)(Object(o.a)(r.prototype),"destroy",this).call(this),this._set=Object(l.p)(this._set)}},{key:"acquire",value:function(){for(var e,t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];var s=(e=Object(a.a)(Object(o.a)(r.prototype),"acquire",this)).call.apply(e,[this].concat(n));return this._set.delete(s),s}},{key:"release",value:function(e){e&&!this._set.has(e)&&(Object(a.a)(Object(o.a)(r.prototype),"release",this).call(this,e),this._set.add(e))}},{key:"_dispose",value:function(e){this._set.delete(e),Object(a.a)(Object(o.a)(r.prototype),"_dispose",this).call(this,e)}}]),r}(r(117).a)},function(e,t,r){"use strict";var n=r(2),i=r(5),a=r(113);var o=function(){function e(t,r,i){Object(n.a)(this,e),this.name=t,this.details=i,this.message=void 0,this instanceof e&&(this.message=r&&function(e,t){return e.replace(/\$\{([^\s\:\}]*)(?:\:([^\s\:\}]+))?\}/g,(function(e,r){if(""===r)return"$";var n=Object(a.b)(r,t),i=null==n?"":n;if(void 0===i)throw new Error('could not find key "'.concat(r,'" in template'));return i.toString()}))}(r,i)||"")}return Object(i.a)(e,[{key:"toString",value:function(){return"["+this.name+"]: "+this.message}}]),e}();t.a=o},function(e,t,r){"use strict";function n(e){return!!e&&e.prototype&&e.prototype.declaredClass&&0===e.prototype.declaredClass.indexOf("esri.core.Collection")}r.d(t,"a",(function(){return n}))},function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r(17),i=r(3),a=r(23);function o(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=arguments.length>3?arguments[3]:void 0;return new Promise((function(c,l){if(Object(a.o)(o))l(s());else{var u=function(){f(),l(new Error("Unable to load ".concat(t)))},d=function(){var t=e;f(),c(t)},h=function(){if(e){var t=e;f(),t.src="",l(s())}},f=function(){Object(n.a)("esri-image-decode")||(e.removeEventListener("error",u),e.removeEventListener("load",d)),u=null,d=null,e=null,Object(i.j)(o)&&o.removeEventListener("abort",h),h=null,r&&URL.revokeObjectURL(t)};Object(i.j)(o)&&o.addEventListener("abort",h),Object(n.a)("esri-image-decode")?e.decode().then(d,u):(e.addEventListener("error",u),e.addEventListener("load",d))}}))}function s(){try{return new DOMException("Aborted","AbortError")}catch(t){var e=new Error;return e.name="AbortError",e}}},function(e,t,r){"use strict";r.d(t,"a",(function(){return u})),r.d(t,"b",(function(){return d})),r.d(t,"c",(function(){return h})),r.d(t,"d",(function(){return f}));var n=r(402),i=r(53),a=r(15),o=r(39),s=r(18),c=r(339),l=a.a.getLogger("esri.support.basemapUtils");function u(){return{}}function d(e){for(var t in e){var r=e[t];!1===(null==r?void 0:r.destroyed)&&r.destroy(),delete e[t]}}function h(e,t){var r,i;if("string"==typeof e){if(!(e in c.a)){var a=Object.keys(c.a).map((function(e){return'"'.concat(e,'"')})).join(", ");return l.warn("Unable to find basemap definition for: ".concat(e,". Try one of these: ").concat(a)),null}t&&(i=t[e]),i||(i=n.default.fromId(e),t&&(t[e]=i))}else i=Object(s.m)(n.default,e);return null!=(r=i)&&r.destroyed&&(l.warn("The provided basemap is already destroyed",{basemap:i}),i=null),i}function f(e){var t=null,r=p(e),n=!r.baseLayers.length;for(var i in c.a){var a=g(r,m(c.a[i]),{mustMatchReferences:n});if("equal"===a){t=i;break}"base-layers-equal"===a&&(t=i)}return t}function p(e){return e?!e.loaded&&e.resourceInfo?m(e.resourceInfo.data):{baseLayers:b(e.baseLayers),referenceLayers:b(e.referenceLayers)}:null}function b(e){return(i.a.isCollection(e)?e.toArray():e).map(v)}function v(e){return{type:e.type,url:_("urlTemplate"in e&&e.urlTemplate||e.url||"styleUrl"in e&&e.styleUrl),minScale:"minScale"in e&&null!=e.minScale?e.minScale:0,maxScale:"maxScale"in e&&null!=e.maxScale?e.maxScale:0,opacity:null!=e.opacity?e.opacity:1,visible:null==e.visible||!!e.visible}}function m(e){return e?{baseLayers:y(e.baseMapLayers.filter((function(e){return!e.isReference}))),referenceLayers:y(e.baseMapLayers.filter((function(e){return e.isReference})))}:null}function y(e){return e.map((function(e){return function(e){var t;switch(e.layerType){case"VectorTileLayer":t="vector-tile";break;case"ArcGISTiledMapServiceLayer":t="tile";break;default:t="unknown"}return{type:t,url:_(e.templateUrl||e.urlTemplate||e.styleUrl||e.url),minScale:null!=e.minScale?e.minScale:0,maxScale:null!=e.maxScale?e.maxScale:0,opacity:null!=e.opacity?e.opacity:1,visible:null==e.visibility||!!e.visibility}}(e)}))}function g(e,t,r){return null!=e!=(null!=t)?"not-equal":e?O(e.baseLayers,t.baseLayers)?O(e.referenceLayers,t.referenceLayers)?"equal":r.mustMatchReferences?"not-equal":"base-layers-equal":"not-equal":"equal"}function O(e,t){if(e.length!==t.length)return!1;for(var r=0;r<e.length;r++)if(!j(e[r],t[r]))return!1;return!0}function j(e,t){return e.type===t.type&&e.url===t.url&&e.minScale===t.minScale&&e.maxScale===t.maxScale&&e.visible===t.visible&&e.opacity===t.opacity}function _(e){return e?Object(o.D)(e).replace(/^\s*https?:/i,"").toLowerCase():""}},function(e,t,r){"use strict";r.d(t,"a",(function(){return a})),r.d(t,"b",(function(){return o}));var n=r(33),i=r(235);function a(e){return e?o(e.rings,e.hasZ):null}function o(e,t){if(!e||!e.length)return null;for(var r=[],n=[],a=t?[1/0,-1/0,1/0,-1/0,1/0,-1/0]:[1/0,-1/0,1/0,-1/0],o=0,c=e.length;o<c;o++){var l=s(e[o],t,a);l&&n.push(l)}if(n.sort((function(e,r){var n=e[2]-r[2];return 0===n&&t&&(n=e[4]-r[4]),n})),n.length&&(r[0]=n[0][0],r[1]=n[0][1],t&&(r[2]=n[0][3]),(r[0]<a[0]||r[0]>a[1]||r[1]<a[2]||r[1]>a[3]||t&&(r[2]<a[4]||r[2]>a[5]))&&(r.length=0)),!r.length){var u=e[0]&&e[0].length?function(e,t){for(var r=t?[0,0,0]:[0,0],n=t?[0,0,0]:[0,0],a=0,o=0,s=0,c=0,l=0,u=e.length;l<u-1;l++){var d=e[l],h=e[l+1];if(d&&h){r[0]=d[0],r[1]=d[1],n[0]=h[0],n[1]=h[1],t&&d.length>2&&h.length>2&&(r[2]=d[2],n[2]=h[2]);var f=Object(i.a)(r,n);if(f){a+=f;var p=Object(i.b)(d,h);o+=f*p[0],s+=f*p[1],t&&p.length>2&&(c+=f*p[2])}}}return a>0?t?[o/a,s/a,c/a]:[o/a,s/a]:e.length?e[0]:null}(e[0],t):null;if(!u)return null;r[0]=u[0],r[1]=u[1],t&&u.length>2&&(r[2]=u[2])}return r}function s(e,t,r){for(var i=0,a=0,o=0,s=0,c=0,l=e.length?e[0][0]:0,u=e.length?e[0][1]:0,d=e.length&&t?e[0][2]:0,h=0;h<e.length;h++){var f=e[h],p=e[(h+1)%e.length],b=Object(n.a)(f,3),v=b[0],m=b[1],y=b[2],g=v-l,O=m-u,j=t?y-d:void 0,_=Object(n.a)(p,3),w=_[0],x=_[1],k=_[2],S=w-l,T=x-u,C=t?k-d:void 0,M=g*T-S*O;if(s+=M,i+=(g+S)*M,a+=(O+T)*M,t&&f.length>2&&p.length>2){var P=g*C-S*j;o+=(j+C)*P,c+=P}v<r[0]&&(r[0]=v),v>r[1]&&(r[1]=v),m<r[2]&&(r[2]=m),m>r[3]&&(r[3]=m),t&&(y<r[4]&&(r[4]=y),y>r[5]&&(r[5]=y))}if(s>0&&(s*=-1),c>0&&(c*=-1),!s)return null;c*=.5;var A=[i/(6*(s*=.5))+l,a/(6*s)+u,s];return t&&(r[4]===r[5]||0===c?(A[3]=(r[4]+r[5])/2,A[4]=0):(A[3]=o/(6*c)+d,A[4]=c)),A}},function(e,t,r){"use strict";var n,i=r(2),a=r(5),o=r(6),s=r(7),c=r(0),l=r(1),u=(r(17),r(18),r(15),r(10)),d=r(332),h=r(328),f=n=function(e){Object(o.a)(r,e);var t=Object(s.a)(r);function r(e){var n;return Object(i.a)(this,r),(n=t.call(this,e)).type="bar-chart",n}return Object(a.a)(r,[{key:"clone",value:function(){return new n({altText:this.altText,title:this.title,caption:this.caption,value:this.value?this.value.clone():null})}}]),r}(d.a);Object(c.a)([Object(l.b)({type:["bar-chart"],readOnly:!0,json:{type:["barchart"],read:!1,write:h.a.write}})],f.prototype,"type",void 0);var p=f=n=Object(c.a)([Object(u.a)("esri.popup.content.BarChartMediaInfo")],f);t.a=p},function(e,t,r){"use strict";var n,i=r(2),a=r(5),o=r(6),s=r(7),c=r(0),l=r(30),u=r(62),d=(r(17),r(18),r(15),r(1)),h=r(10),f=n=function(e){Object(o.a)(r,e);var t=Object(s.a)(r);function r(e){var n;return Object(i.a)(this,r),(n=t.call(this,e)).tooltip=null,n.value=null,n.x=null,n.y=null,n}return Object(a.a)(r,[{key:"clone",value:function(){return new n({tooltip:this.tooltip,value:this.value})}}]),r}(l.a);Object(c.a)([Object(d.b)()],f.prototype,"tooltip",void 0),Object(c.a)([Object(d.b)()],f.prototype,"value",void 0),Object(c.a)([Object(u.a)("value")],f.prototype,"x",void 0),Object(c.a)([Object(u.a)("tooltip")],f.prototype,"y",void 0);var p=f=n=Object(c.a)([Object(h.a)("esri.popup.content.support.ChartMediaInfoValueSeries")],f);t.a=p},function(e,t,r){"use strict";var n,i=r(2),a=r(5),o=r(6),s=r(7),c=r(0),l=r(1),u=(r(17),r(18),r(15),r(10)),d=r(332),h=r(328),f=n=function(e){Object(o.a)(r,e);var t=Object(s.a)(r);function r(e){var n;return Object(i.a)(this,r),(n=t.call(this,e)).type="column-chart",n}return Object(a.a)(r,[{key:"clone",value:function(){return new n({altText:this.altText,title:this.title,caption:this.caption,value:this.value?this.value.clone():null})}}]),r}(d.a);Object(c.a)([Object(l.b)({type:["column-chart"],readOnly:!0,json:{type:["columnchart"],read:!1,write:h.a.write}})],f.prototype,"type",void 0);var p=f=n=Object(c.a)([Object(u.a)("esri.popup.content.ColumnChartMediaInfo")],f);t.a=p},function(e,t,r){"use strict";var n,i=r(2),a=r(5),o=r(6),s=r(7),c=r(0),l=r(1),u=(r(17),r(18),r(15),r(10)),d=r(332),h=r(328),f=n=function(e){Object(o.a)(r,e);var t=Object(s.a)(r);function r(e){var n;return Object(i.a)(this,r),(n=t.call(this,e)).type="line-chart",n}return Object(a.a)(r,[{key:"clone",value:function(){return new n({altText:this.altText,title:this.title,caption:this.caption,value:this.value?this.value.clone():null})}}]),r}(d.a);Object(c.a)([Object(l.b)({type:["line-chart"],readOnly:!0,json:{type:["linechart"],read:!1,write:h.a.write}})],f.prototype,"type",void 0);var p=f=n=Object(c.a)([Object(u.a)("esri.popup.content.LineChartMediaInfo")],f);t.a=p},function(e,t,r){"use strict";var n,i=r(2),a=r(5),o=r(6),s=r(7),c=r(0),l=r(1),u=(r(17),r(18),r(15),r(10)),d=r(332),h=r(328),f=n=function(e){Object(o.a)(r,e);var t=Object(s.a)(r);function r(e){var n;return Object(i.a)(this,r),(n=t.call(this,e)).type="pie-chart",n}return Object(a.a)(r,[{key:"clone",value:function(){return new n({altText:this.altText,title:this.title,caption:this.caption,value:this.value?this.value.clone():null})}}]),r}(d.a);Object(c.a)([Object(l.b)({type:["pie-chart"],readOnly:!0,json:{type:["piechart"],read:!1,write:h.a.write}})],f.prototype,"type",void 0);var p=f=n=Object(c.a)([Object(u.a)("esri.popup.content.PieChartMediaInfo")],f);t.a=p},function(e,t,r){"use strict";r.d(t,"a",(function(){return c}));var n=r(508),i=r(510),a=r(542),o=r(511),s=r(512),c={base:r(394).a,key:"type",defaultKeyValue:"image",typeMap:{"bar-chart":n.a,"column-chart":i.a,"line-chart":o.a,"pie-chart":s.a,image:a.a}}},function(e,t,r){"use strict";var n,i=r(2),a=r(5),o=r(6),s=r(7),c=r(0),l=r(27),u=r(1),d=(r(17),r(18),r(15),r(10)),h=n=function(e){Object(o.a)(r,e);var t=Object(s.a)(r);function r(e){var n;return Object(i.a)(this,r),(n=t.call(this,e)).field=null,n.order=null,n}return Object(a.a)(r,[{key:"clone",value:function(){return new n({field:this.field,order:this.order})}}]),r}(l.a);Object(c.a)([Object(u.b)({type:String,json:{write:!0}})],h.prototype,"field",void 0),Object(c.a)([Object(u.b)({type:["asc","desc"],json:{write:!0}})],h.prototype,"order",void 0);var f=h=n=Object(c.a)([Object(d.a)("esri.popup.support.RelatedRecordsInfoFieldOrder")],h);t.a=f},function(e,t,r){"use strict";var n,i=r(2),a=r(5),o=r(6),s=r(7),c=r(0),l=r(1),u=(r(17),r(18),r(15),r(10)),d=r(329),h=n=function(e){Object(o.a)(r,e);var t=Object(s.a)(r);function r(e){var n;return Object(i.a)(this,r),(n=t.call(this,e)).image=null,n.type="toggle",n.value=!1,n}return Object(a.a)(r,[{key:"clone",value:function(){return new n({active:this.active,className:this.className,disabled:this.disabled,id:this.id,indicator:this.indicator,title:this.title,visible:this.visible,image:this.image,value:this.value})}}]),r}(d.a);Object(c.a)([Object(l.b)()],h.prototype,"image",void 0),Object(c.a)([Object(l.b)()],h.prototype,"value",void 0);var f=h=n=Object(c.a)([Object(u.a)("esri.support.Action.ActionToggle")],h);t.a=f},function(e,t,r){"use strict";var n=r(2),i=r(5),a=r(6),o=r(7),s=r(0),c=r(27),l=r(1),u=(r(17),r(18),r(15),r(10)),d=function(e){Object(a.a)(r,e);var t=Object(o.a)(r);function r(e){var i;return Object(n.a)(this,r),(i=t.call(this,e)).visible=!0,i}return Object(i.a)(r,[{key:"clone",value:function(){}}]),r}(c.a);Object(s.a)([Object(l.b)({type:["line"],readOnly:!0,json:{read:!1,write:{ignoreOrigin:!0}}})],d.prototype,"type",void 0),Object(s.a)([Object(l.b)({readOnly:!0})],d.prototype,"visible",void 0);var h=d=Object(s.a)([Object(u.a)("esri.symbols.callouts.Callout3D")],d);t.a=h},function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var n=r(392),i=r(499);function a(e,t,r){return(a=Object(i.a)()?Reflect.construct:function(e,t,r){var i=[null];i.push.apply(i,t);var a=new(Function.bind.apply(e,i));return r&&Object(n.a)(a,r.prototype),a}).apply(null,arguments)}},function(e,t,r){"use strict";var n,i=r(2),a=r(5),o=r(6),s=r(7),c=r(0),l=r(27),u=r(1),d=(r(17),r(18),r(15),r(10)),h=n=function(e){Object(o.a)(r,e);var t=Object(s.a)(r);function r(e){var n;return Object(i.a)(this,r),(n=t.call(this,e)).groupByFields=void 0,n.topCount=void 0,n.orderByFields=void 0,n}return Object(a.a)(r,[{key:"clone",value:function(){return new n({groupByFields:this.groupByFields,topCount:this.topCount,orderByFields:this.orderByFields})}}]),r}(l.a);Object(c.a)([Object(u.b)({type:[String],json:{write:!0}})],h.prototype,"groupByFields",void 0),Object(c.a)([Object(u.b)({type:Number,json:{write:!0}})],h.prototype,"topCount",void 0),Object(c.a)([Object(u.b)({type:[String],json:{write:!0}})],h.prototype,"orderByFields",void 0);var f=h=n=Object(c.a)([Object(d.a)("esri.rest.support.TopFilter")],h);t.a=f},function(e,t,r){"use strict";var n,i=r(2),a=r(5),o=r(6),s=r(7),c=r(0),l=r(1),u=(r(17),r(18),r(15),r(10)),d=r(371),h=n=function(e){Object(o.a)(r,e);var t=Object(s.a)(r);function r(){var e;return Object(i.a)(this,r),(e=t.apply(this,arguments)).showLegend=null,e}return Object(a.a)(r,[{key:"clone",value:function(){return new n({title:this.title,showLegend:this.showLegend})}}]),r}(d.a);Object(c.a)([Object(l.b)({type:Boolean,json:{write:!0}})],h.prototype,"showLegend",void 0);var f=h=n=Object(c.a)([Object(u.a)("esri.renderers.visualVariables.support.VisualVariableLegendOptions")],h);t.a=f},function(e,t,r){"use strict";r.d(t,"a",(function(){return l}));var n=r(2),i=r(5),a=r(74),o=r(4),s=r(9),c=r(46),l=function(){function e(t,r,i,a){Object(n.a)(this,e),this.primitiveIndices=t,this._numIndexPerPrimitive=r,this.indices=i,this.position=a,this.center=Object(s.e)(),Object(c.a)(t.length>=1),Object(c.a)(i.length%this._numIndexPerPrimitive==0),Object(c.a)(i.length>=t.length*this._numIndexPerPrimitive),Object(c.a)(3===a.size||4===a.size);var l=a.data,d=a.size,h=t.length,f=d*i[this._numIndexPerPrimitive*t[0]];u.clear(),u.push(f),this.bbMin=Object(s.g)(l[f],l[f+1],l[f+2]),this.bbMax=Object(s.c)(this.bbMin);for(var p=0;p<h;++p)for(var b=this._numIndexPerPrimitive*t[p],v=0;v<this._numIndexPerPrimitive;++v){f=d*i[b+v],u.push(f);var m=l[f];this.bbMin[0]=Math.min(m,this.bbMin[0]),this.bbMax[0]=Math.max(m,this.bbMax[0]),m=l[f+1],this.bbMin[1]=Math.min(m,this.bbMin[1]),this.bbMax[1]=Math.max(m,this.bbMax[1]),m=l[f+2],this.bbMin[2]=Math.min(m,this.bbMin[2]),this.bbMax[2]=Math.max(m,this.bbMax[2])}Object(o.k)(this.center,this.bbMin,this.bbMax,.5),this.radius=.5*Math.max(Math.max(this.bbMax[0]-this.bbMin[0],this.bbMax[1]-this.bbMin[1]),this.bbMax[2]-this.bbMin[2]);for(var y=this.radius*this.radius,g=0;g<u.length;++g){var O=l[f=u.getItemAt(g)]-this.center[0],j=l[f+1]-this.center[1],_=l[f+2]-this.center[2],w=O*O+j*j+_*_;if(!(w<=y)){var x=Math.sqrt(w),k=.5*(x-this.radius);this.radius=this.radius+k,y=this.radius*this.radius;var S=k/x;this.center[0]+=O*S,this.center[1]+=j*S,this.center[2]+=_*S}}u.clear()}return Object(i.a)(e,[{key:"getCenter",value:function(){return this.center}},{key:"getBSRadius",value:function(){return this.radius}},{key:"getBBMin",value:function(){return this.bbMin}},{key:"getBBMax",value:function(){return this.bbMax}},{key:"getChildren",value:function(){if(this._children)return this._children;if(Object(o.n)(this.bbMin,this.bbMax)>1){for(var t=Object(o.k)(Object(s.e)(),this.bbMin,this.bbMax,.5),r=this.primitiveIndices.length,n=new Uint8Array(r),i=new Array(8),a=0;a<8;++a)i[a]=0;for(var c=this.position,l=c.data,u=c.size,d=0;d<r;++d){for(var h=0,f=this._numIndexPerPrimitive*this.primitiveIndices[d],p=u*this.indices[f],b=l[p],v=l[p+1],m=l[p+2],y=1;y<this._numIndexPerPrimitive;++y){var g=l[p=u*this.indices[f+y]],O=l[p+1],j=l[p+2];g<b&&(b=g),O<v&&(v=O),j<m&&(m=j)}b<t[0]&&(h|=1),v<t[1]&&(h|=2),m<t[2]&&(h|=4),n[d]=h,++i[h]}for(var _=0,w=0;w<8;++w)i[w]>0&&++_;if(_<2)return;for(var x=new Array(8),k=0;k<8;++k)x[k]=i[k]>0?new Uint32Array(i[k]):void 0;for(var S=0;S<8;++S)i[S]=0;for(var T=0;T<r;++T){var C=n[T];x[C][i[C]++]=this.primitiveIndices[T]}this._children=new Array(8);for(var M=0;M<8;++M)void 0!==x[M]&&(this._children[M]=new e(x[M],this._numIndexPerPrimitive,this.indices,this.position))}return this._children}}],[{key:"prune",value:function(){u.prune()}}]),e}(),u=new a.a({deallocator:null})},function(e,t,r){"use strict";r.d(t,"a",(function(){return c})),r.d(t,"b",(function(){return s}));var n=r(38),i=r(4),a=r(9),o=r(37);function s(e,t,r,n){return h(e,t,r,u(n,t,r,!0))}function c(e,t,r,n){var a=Object(i.j)(r,Object(i.l)(e,n,t));return Object(i.h)(e,t,Object(i.g)(e,r,a))}var l={dir:Object(a.e)(),len:0,clip:Object(n.b)()};function u(e,t,r,n){var a=l;return e?(r&&n&&(a.len=Object(i.o)(t,r)),Object(i.m)(a.dir,e)):n?(a.len=Object(i.o)(t,r),Object(i.l)(a.dir,r,t),Object(i.g)(a.dir,a.dir,1/a.len)):(Object(i.l)(a.dir,r,t),Object(i.t)(a.dir,a.dir)),a}function d(e,t,r){var n=Object(i.j)(Object(o.s)(e),r.dir),a=-Object(o.w)(e,t);if(a<0&&n>=0)return!1;if(n>-1e-6&&n<1e-6)return a>0;if((a<0||n<0)&&!(a<0&&n<0))return!0;var s=a/n;return n>0?s<r.clip[1]&&(r.clip[1]=s):s>r.clip[0]&&(r.clip[0]=s),r.clip[0]<=r.clip[1]}function h(e,t,r,n){n.clip[0]=0,n.clip[1]=r?n.len:Number.MAX_VALUE;for(var i=0;i<e.length;i++)if(!d(e[i],t,n))return!1;return!0}},function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var n=r(20);function i(e,t,r){var i,l=e.byteLength/(4*t),u=new Uint32Array(e,0,l*t),d=new Uint32Array(l),h=null!=(i=null==r?void 0:r.minReduction)?i:0,f=(null==r?void 0:r.originalIndices)||null,p=f?f.length:0,b=(null==r?void 0:r.componentOffsets)||null,v=0;if(b)for(var m=0;m<b.length-1;m++){var y=b[m+1]-b[m];y>v&&(v=y)}else v=l;var g=Math.floor(1.1*v)+1;(null==c||c.length<2*g)&&(c=new Uint32Array(Object(n.p)(2*g)));for(var O=0;O<2*g;O++)c[O]=0;for(var j=0,_=!!b&&!!f,w=_?p:l,x=_?new Uint32Array(p):null,k=1.96,S=0!==h?Math.ceil(4*k*k/(h*h)*h*(1-h)):w,T=1,C=b?b[1]:w,M=0;M<w;M++){if(M===S){var P=1-j/M;if(P+k*Math.sqrt(P*(1-P)/M)<h)return null;S*=2}if(M===C){for(var A=0;A<2*g;A++)c[A]=0;if(f)for(var E=b[T-1];E<b[T];E++)x[E]=d[f[E]];C=b[++T]}for(var R=_?f[M]:M,I=R*t,D=s(u,I,t),F=D%g,L=j;0!==c[2*F+1];){if(c[2*F]===D){var z=c[2*F+1]-1;if(a(u,I,z*t,t)){L=d[z];break}}++F>=g&&(F-=g)}L===j&&(c[2*F]=D,c[2*F+1]=R+1,j++),d[R]=L}if(0!==h&&1-j/l<h)return null;if(_){for(var V=b[T-1];V<x.length;V++)x[V]=d[f[V]];d=x}var N=new Uint32Array(t*j);j=0;for(var U=0;U<w;U++)d[U]===j&&(o(u,(_?f[U]:U)*t,N,j*t,t),j++);if(f&&!_){for(var B=new Uint32Array(p),G=0;G<B.length;G++)B[G]=d[f[G]];d=B}return{buffer:N.buffer,indices:d,uniqueCount:j}}function a(e,t,r,n){for(var i=0;i<n;i++)if(e[t+i]!==e[r+i])return!1;return!0}function o(e,t,r,n,i){for(var a=0;a<i;a++)r[n+a]=e[t+a]}function s(e,t,r){for(var n=0,i=0;i<r;i++)n=(n=e[t+i]+n|0)+(n<<11)+(n>>>2)|0;return n>>>0}var c=null},function(e,t,r){"use strict";r.d(t,"a",(function(){return u}));var n=r(8),i=r.n(n),a=r(16),o=r(5),s=r(2),c=r(3),l=function e(t){Object(s.a)(this,e),this.technique=t,this.refCount=0,this.refZeroFrame=0},u=function(){function e(t){Object(s.a)(this,e),this._context=t,this._perConstructorInstances=new Map,this._frameCounter=0,this._keepAliveFrameCount=1200}return Object(o.a)(e,[{key:"viewingMode",get:function(){return this._context.viewingMode}},{key:"constructionContext",get:function(){return this._context}},{key:"dispose",value:function(){this._perConstructorInstances.forEach((function(e){return e.forEach((function(e){return e.technique.dispose()}))})),this._perConstructorInstances.clear()}},{key:"acquire",value:function(e,t){var r=this,n=t.key,i=this._perConstructorInstances.get(e);i||(i=new Map,this._perConstructorInstances.set(e,i));var a=i.get(n);if(void 0===a){var o=new e(this._context,t,(function(){return r.release(o)}));a=new l(o),i.set(n,a)}return++a.refCount,a.technique}},{key:"releaseAndAcquire",value:function(e,t,r){if(Object(c.j)(r)){if(t.key===r.key)return r;r.release()}return this.acquire(e,t)}},{key:"release",value:function(e){if(!Object(c.i)(e)){var t=this._perConstructorInstances.get(e.constructor).get(e.key);--t.refCount,0===t.refCount&&(t.refZeroFrame=this._frameCounter)}}},{key:"frameUpdate",value:function(){var e=this;this._frameCounter++,this._perConstructorInstances.forEach((function(t,r){t.forEach((function(r,n){0===r.refCount&&r.refZeroFrame+e._keepAliveFrameCount<e._frameCounter&&(r.technique.dispose(),t.delete(n))})),0===t.size&&e._perConstructorInstances.delete(r)}))}},{key:"hotReload",value:function(){var e=Object(a.a)(i.a.mark((function e(){var t,r=this;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=new Array,this._perConstructorInstances.forEach((function(e,n){var o=function(){var e=Object(a.a)(i.a.mark((function e(t,n){var a;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=n.shader,e.t0=a,!e.t0){e.next=6;break}return e.next=5,a.reload();case 5:t.forEach((function(e){e.technique.reload(r._context)}));case 6:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}();t.push(o(e,n))})),e.next=4,Promise.all(t);case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),e}()},function(e,t,r){"use strict";var n=r(13),i=r(2),a=r(5),o=r(3),s=r(117),c=r(74),l=r(4),u=r(9),d=r(118),h=r(79),f=r(70),p=r(46),b=function(){function e(t,r){Object(i.a)(this,e),this._objectToBoundingSphere=t,this._maximumObjectsPerNode=10,this._maximumDepth=20,this._degenerateObjects=new Set,this._root=new v,this._objectCount=0,r&&(void 0!==r.maximumObjectsPerNode&&(this._maximumObjectsPerNode=r.maximumObjectsPerNode),void 0!==r.maximumDepth&&(this._maximumDepth=r.maximumDepth))}return Object(a.a)(e,[{key:"bounds",get:function(){return this._root.bounds}},{key:"halfSize",get:function(){return this._root.halfSize}},{key:"root",get:function(){return this._root.node}},{key:"maximumObjectsPerNode",get:function(){return this._maximumObjectsPerNode}},{key:"maximumDepth",get:function(){return this._maximumDepth}},{key:"objectCount",get:function(){return this._objectCount}},{key:"destroy",value:function(){this._degenerateObjects.clear(),v.clearPool(),C[0]=null,R.prune(),V.prune()}},{key:"add",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.length;this._objectCount+=t,this._grow(e,t);for(var r=v.acquire(),n=0;n<t;n++){var i=e[n];this._isDegenerate(i)?this._degenerateObjects.add(i):(r.init(this._root),this._add(i,r))}v.release(r)}},{key:"remove",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;this._objectCount-=e.length;var r,i=v.acquire(),a=Object(n.a)(e);try{for(a.s();!(r=a.n()).done;){var s=r.value,c=Object(o.j)(t)?t:Object(f.h)(this._objectToBoundingSphere(s),I);x(c[3])?(i.init(this._root),this._remove(s,c,i)):this._degenerateObjects.delete(s)}}catch(l){a.e(l)}finally{a.f()}v.release(i),this._shrink()}},{key:"update",value:function(e,t){if(x(t[3])||!this._isDegenerate(e)){var r=function(e){return C[0]=e,C}(e);this.remove(r,t),this.add(r)}}},{key:"forEachAlongRay",value:function(e,t,r){var n=this,i=Object(h.g)(e,t);this._forEachNode(this._root,(function(e){if(!n._intersectsNode(i,e))return!1;var t=e.node;return t.terminals.forAll((function(e){n._intersectsObject(i,e)&&r(e)})),null!==t.residents&&t.residents.forAll((function(e){n._intersectsObject(i,e)&&r(e)})),!0}))}},{key:"forEachAlongRayWithVerticalOffset",value:function(e,t,r,n){var i=this,a=Object(h.g)(e,t);this._forEachNode(this._root,(function(e){if(!i._intersectsNodeWithOffset(a,e,n))return!1;var t=e.node;return t.terminals.forAll((function(e){i._intersectsObjectWithOffset(a,e,n)&&r(e)})),null!==t.residents&&t.residents.forAll((function(e){i._intersectsObjectWithOffset(a,e,n)&&r(e)})),!0}))}},{key:"forEach",value:function(e){this._forEachNode(this._root,(function(t){var r=t.node;return r.terminals.forAll(e),null!==r.residents&&r.residents.forAll(e),!0})),this._degenerateObjects.forEach(e)}},{key:"forEachDegenerateObject",value:function(e){this._degenerateObjects.forEach(e)}},{key:"findClosest",value:function(e,t,r){var n=this,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:function(){return!0},a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1/0,o=1/0,s=1/0,c=null,u=_(e,t),h=function(l){if(--a,i(l)){var u=n._objectToBoundingSphere(l);if(Object(d.j)(r,u)){var h=w(e,t,Object(f.g)(u)),p=h-u[3],b=h+u[3];p<o&&(o=p,s=b,c=l)}}};return this._forEachNodeDepthOrdered(this._root,(function(n){if(a<=0||!Object(d.j)(r,n.bounds))return!1;if(Object(l.g)(P,u,n.halfSize),Object(l.h)(P,P,n.bounds),w(e,t,P)>s)return!1;var i=n.node;return i.terminals.forAll((function(e){return h(e)})),null!==i.residents&&i.residents.forAll((function(e){return h(e)})),!0}),e,t),c}},{key:"forEachInDepthRange",value:function(e,t,r,n,i,a,o){var s=this,c=-1/0,u=1/0,h={setRange:function(e){1===r?(c=Math.max(c,e.near),u=Math.min(u,e.far)):(c=Math.max(c,-e.far),u=Math.min(u,-e.near))}};h.setRange(n);var p=w(t,r,e),b=_(t,r),v=_(t,-1*r),m=function(e){if(o(e)){var n=s._objectToBoundingSphere(e),l=Object(f.g)(n),b=w(t,r,l)-p,v=b-n[3],m=b+n[3];v>u||m<c||!Object(d.j)(a,n)||i(e,h)}};this._forEachNodeDepthOrdered(this._root,(function(e){if(!Object(d.j)(a,e.bounds))return!1;if(Object(l.g)(P,b,e.halfSize),Object(l.h)(P,P,e.bounds),w(t,r,P)-p>u)return!1;if(Object(l.g)(P,v,e.halfSize),Object(l.h)(P,P,e.bounds),w(t,r,P)-p<c)return!1;var n=e.node;return n.terminals.forAll((function(e){return m(e)})),null!==n.residents&&n.residents.forAll((function(e){return m(e)})),!0}),t,r)}},{key:"forEachNode",value:function(e){this._forEachNode(this._root,(function(t){return e(t.node,t.bounds,t.halfSize)}))}},{key:"_intersectsNode",value:function(e,t){return g(t.bounds,2*-t.halfSize,A),g(t.bounds,2*t.halfSize,E),Object(p.k)(e.origin,e.direction,A,E)}},{key:"_intersectsNodeWithOffset",value:function(e,t,r){return g(t.bounds,2*-t.halfSize,A),g(t.bounds,2*t.halfSize,E),r.applyToMinMax(A,E),Object(p.k)(e.origin,e.direction,A,E)}},{key:"_intersectsObject",value:function(e,t){var r=this._objectToBoundingSphere(t);return!(r[3]>0)||Object(f.j)(r,e)}},{key:"_intersectsObjectWithOffset",value:function(e,t,r){var n=this._objectToBoundingSphere(t);return!(n[3]>0)||Object(f.j)(r.applyToBoundingSphere(n),e)}},{key:"_forEachNode",value:function(e,t){for(var r=v.acquire().init(e),n=[r];0!==n.length;){if(t(r=n.pop())&&!r.isLeaf())for(var i=0;i<r.node.children.length;i++)r.node.children[i]&&n.push(v.acquire().init(r).advance(i));v.release(r)}}},{key:"_forEachNodeDepthOrdered",value:function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,i=v.acquire().init(e),a=[i];for(j(r,n,N);0!==a.length;){if(t(i=a.pop())&&!i.isLeaf())for(var o=7;o>=0;--o){var s=N[o];i.node.children[s]&&a.push(v.acquire().init(i).advance(s))}v.release(i)}}},{key:"_remove",value:function(e,t,r){R.clear();var n=r.advanceTo(t,(function(e,t){R.push(e.node),R.push(t)}))?r.node.terminals:r.node.residents;if(n.removeUnordered(e),0===n.length)for(var i=R.length-2;i>=0;i-=2){var a=R.data[i],o=R.data[i+1];if(!this._purge(a,o))break}}},{key:"_nodeIsEmpty",value:function(e){if(0!==e.terminals.length)return!1;if(null!==e.residents)return 0===e.residents.length;for(var t=0;t<e.children.length;t++)if(e.children[t])return!1;return!0}},{key:"_purge",value:function(e,t){return t>=0&&(e.children[t]=null),!!this._nodeIsEmpty(e)&&(null===e.residents&&(e.residents=new c.a({shrink:!0})),!0)}},{key:"_add",value:function(e,t){t.advanceTo(this._objectToBoundingSphere(e))?t.node.terminals.push(e):(t.node.residents.push(e),t.node.residents.length>this._maximumObjectsPerNode&&t.depth<this._maximumDepth&&this._split(t))}},{key:"_split",value:function(e){var t=e.node.residents;e.node.residents=null;for(var r=0;r<t.length;r++){var n=v.acquire().init(e);this._add(t.getItemAt(r),n),v.release(n)}}},{key:"_grow",value:function(e,t){var r=this;if(0!==t&&(O(e,t,(function(e){return r._objectToBoundingSphere(e)}),D),x(D[3])&&!this._fitsInsideTree(D)))if(this._nodeIsEmpty(this._root.node))Object(f.h)(D,this._root.bounds),this._root.halfSize=1.25*D[3];else{var n=this._rootBoundsForRootAsSubNode(D);this._placingRootViolatesMaxDepth(n)?this._rebuildTree(D,n):this._growRootAsSubNode(n),v.release(n)}}},{key:"_rebuildTree",value:function(e,t){var r=this;Object(l.m)(F,t.bounds),F[3]=t.halfSize,O([e,F],2,(function(e){return e}),L);var n=v.acquire().init(this._root);this._root.initFrom(null,L,1.25*L[3]),this._forEachNode(n,(function(e){return r.add(e.node.terminals.data,e.node.terminals.length),null!==e.node.residents&&r.add(e.node.residents.data,e.node.residents.length),!0})),v.release(n)}},{key:"_placingRootViolatesMaxDepth",value:function(e){var t=this,r=Math.log(e.halfSize/this._root.halfSize)*Math.LOG2E,n=0;return this._forEachNode(this._root,(function(e){return(n=Math.max(n,e.depth))+r<=t._maximumDepth})),n+r>this._maximumDepth}},{key:"_rootBoundsForRootAsSubNode",value:function(e){for(var t=e[3],r=e,n=-1/0,i=this._root.bounds,a=this._root.halfSize,o=0;o<3;o++){var s=i[o]-a-(r[o]-t),c=r[o]+t-(i[o]+a),l=Math.max(0,Math.ceil(s/(2*a))),u=Math.max(0,Math.ceil(c/(2*a)))+1,d=Math.pow(2,Math.ceil(Math.log(l+u)*Math.LOG2E));n=Math.max(n,d),z[o].min=l,z[o].max=u}for(var h=0;h<3;h++){var f=z[h].min,p=z[h].max,b=(n-(f+p))/2;f+=Math.ceil(b),p+=Math.floor(b);var m=i[h]-a-f*a*2;M[h]=m+(p+f)*a}return M[3]=n*a*T,v.acquire().initFrom(null,M,n*a,0)}},{key:"_growRootAsSubNode",value:function(e){var t=this._root.node;Object(l.m)(D,this._root.bounds),D[3]=this._root.halfSize,this._root.init(e),e.advanceTo(D,null,!0),e.node.children=t.children,e.node.residents=t.residents,e.node.terminals=t.terminals}},{key:"_shrink",value:function(){for(;;){var e=this._findShrinkIndex();if(-1===e)break;this._root.advance(e),this._root.depth=0}}},{key:"_findShrinkIndex",value:function(){if(0!==this._root.node.terminals.length||this._root.isLeaf())return-1;for(var e=null,t=this._root.node.children,r=0,n=0;n<t.length&&null==e;)e=t[r=n++];for(;n<t.length;)if(t[n++])return-1;return r}},{key:"_isDegenerate",value:function(e){return!x(this._objectToBoundingSphere(e)[3])}},{key:"_fitsInsideTree",value:function(e){var t=this._root.bounds,r=this._root.halfSize;return e[3]<=r&&e[0]>=t[0]-r&&e[0]<=t[0]+r&&e[1]>=t[1]-r&&e[1]<=t[1]+r&&e[2]>=t[2]-r&&e[2]<=t[2]+r}}]),e}(),v=function(){function e(){Object(i.a)(this,e),this.bounds=Object(f.c)(),this.halfSize=0,this.initFrom(null,null,0,0)}return Object(a.a)(e,[{key:"init",value:function(e){return this.initFrom(e.node,e.bounds,e.halfSize,e.depth)}},{key:"initFrom",value:function(t,r,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:this.depth;return this.node=Object(o.j)(t)?t:e.createEmptyNode(),Object(o.j)(r)&&Object(f.h)(r,this.bounds),this.halfSize=n,this.depth=i,this}},{key:"advance",value:function(t){var r=this.node.children[t];r||(r=e.createEmptyNode(),this.node.children[t]=r),this.node=r,this.halfSize/=2,this.depth++;var n=k[t];return this.bounds[0]+=n[0]*this.halfSize,this.bounds[1]+=n[1]*this.halfSize,this.bounds[2]+=n[2]*this.halfSize,this.bounds[3]=this.halfSize*T,this}},{key:"advanceTo",value:function(e,t){for(var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];;){if(this.isTerminalFor(e))return t&&t(this,-1),!0;if(this.isLeaf()){if(!r)return t&&t(this,-1),!1;this.node.residents=null}var n=this._childIndex(e);t&&t(this,n),this.advance(n)}}},{key:"isLeaf",value:function(){return null!=this.node.residents}},{key:"isTerminalFor",value:function(e){return e[3]>this.halfSize/2}},{key:"_childIndex",value:function(e){var t=this.bounds;return(t[0]<e[0]?1:0)+(t[1]<e[1]?2:0)+(t[2]<e[2]?4:0)}}],[{key:"createEmptyNode",value:function(){return{children:[null,null,null,null,null,null,null,null],terminals:new c.a({shrink:!0}),residents:new c.a({shrink:!0})}}},{key:"acquire",value:function(){return e._pool.acquire()}},{key:"release",value:function(t){e._pool.release(t)}},{key:"clearPool",value:function(){e._pool.prune()}}]),e}();function m(e,t){e[0]=Math.min(e[0],t[0]-t[3]),e[1]=Math.min(e[1],t[1]-t[3]),e[2]=Math.min(e[2],t[2]-t[3])}function y(e,t){e[0]=Math.max(e[0],t[0]+t[3]),e[1]=Math.max(e[1],t[1]+t[3]),e[2]=Math.max(e[2],t[2]+t[3])}function g(e,t,r){r[0]=e[0]+t,r[1]=e[1]+t,r[2]=e[2]+t}function O(e,t,r,n){if(1===t){var i=r(e[0]);Object(f.h)(i,n)}else{A[0]=1/0,A[1]=1/0,A[2]=1/0,E[0]=-1/0,E[1]=-1/0,E[2]=-1/0;for(var a=0;a<t;a++){var o=r(e[a]);x(o[3])&&(m(A,o),y(E,o))}Object(l.k)(n,A,E,.5),n[3]=Math.max(E[0]-A[0],E[1]-A[1],E[2]-A[2])/2}}function j(e,t,r){if(!V.length)for(var n=0;n<8;++n)V.push({index:0,distance:0});for(var i=0;i<8;++i){var a=k[i];V.data[i].index=i,V.data[i].distance=w(e,t,a)}V.sort((function(e,t){return e.distance-t.distance}));for(var o=0;o<8;++o)r[o]=V.data[o].index}function _(e,t){for(var r=1/0,n=null,i=0;i<8;++i){var a=w(e,t,S[i]);a<r&&(r=a,n=S[i])}return n}function w(e,t,r){return t*(e[0]*r[0]+e[1]*r[1]+e[2]*r[2])}function x(e){return!isNaN(e)&&e!==-1/0&&e!==1/0&&e>0}v._pool=new s.a(v);var k=[Object(u.g)(-1,-1,-1),Object(u.g)(1,-1,-1),Object(u.g)(-1,1,-1),Object(u.g)(1,1,-1),Object(u.g)(-1,-1,1),Object(u.g)(1,-1,1),Object(u.g)(-1,1,1),Object(u.g)(1,1,1)],S=[Object(u.g)(-1,-1,-1),Object(u.g)(-1,-1,1),Object(u.g)(-1,1,-1),Object(u.g)(-1,1,1),Object(u.g)(1,-1,-1),Object(u.g)(1,-1,1),Object(u.g)(1,1,-1),Object(u.g)(1,1,1)],T=Math.sqrt(3),C=[null];var M=Object(f.c)(),P=Object(u.e)(),A=Object(u.e)(),E=Object(u.e)(),R=new c.a,I=Object(f.c)(),D=Object(f.c)(),F=Object(f.c)(),L=Object(f.c)(),z=[{min:0,max:0},{min:0,max:0},{min:0,max:0}],V=new c.a,N=[0,0,0,0,0,0,0,0];t.a=b},function(e,t,r){"use strict";var n,i=r(96),a=r(73);!function(e){e.Default={vvSizeEnabled:!1,vvSizeMinSize:Object(a.d)(1,1,1),vvSizeMaxSize:Object(a.d)(100,100,100),vvSizeOffset:Object(a.d)(0,0,0),vvSizeFactor:Object(a.d)(1,1,1),vvSizeValue:Object(a.d)(1,1,1),vvColorEnabled:!1,vvColorValues:[0,0,0,0,0,0,0,0],vvColorColors:[1,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0],vvOpacityEnabled:!1,vvOpacityValues:[0,0,0,0,0,0,0,0],vvOpacityOpacities:[1,1,1,1,1,1,1,1],vvSymbolAnchor:[0,0,0],vvSymbolRotationMatrix:Object(i.b)()}}(n||(n={}));var o=n;t.a=o},function(e,t,r){"use strict";r.d(t,"a",(function(){return c})),r.d(t,"b",(function(){return l}));var n=r(6),i=r(7),a=r(2),o=r(5),s=r(86),c=function(){function e(t){Object(a.a)(this,e),this.rctx=t,this.camera=null,this.lastFrameCamera=new s.a,this.pass=0,this.slot=0,this.highlightDepthTexture=null,this.renderOccludedMask=u,this.hasOccludees=!1}return Object(o.a)(e,[{key:"resetRenderOccludedMask",value:function(){this.renderOccludedMask=u}},{key:"isHighlightPass",get:function(){return 5===this.pass}}]),e}(),l=function(e){Object(n.a)(r,e);var t=Object(i.a)(r);function r(e,n,i,o,s,c){var l;return Object(a.a)(this,r),(l=t.call(this,e)).offscreenRenderingHelper=n,l.scenelightingData=i,l.shadowMap=o,l.ssaoHelper=s,l.sliceHelper=c,l}return r}(c),u=13},function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var n=r(398);function i(e){var t=new Map,r=function(e){var r=t.get(e);return r||(r=new n.b,t.set(e,r)),r};return e.adds.forAll((function(e){a(e)&&r(e.material).adds.push(e)})),e.removes.forAll((function(e){a(e)&&r(e.material).removes.push(e)})),e.updates.forAll((function(e){a(e.renderGeometry)&&r(e.renderGeometry.material).updates.push(e)})),t}function a(e){return e.data.indexCount>=1}},function(e,t,r){"use strict";r.d(t,"a",(function(){return w})),r.d(t,"b",(function(){return x}));var n=r(2),i=r(5),a=r(6),o=r(7),s=r(0),c=r(76),l=r(109),u=r(112),d=r(148),h=r(333),f=r(430),p=r(106),b=r(91),v=r(95),m=r(24),y=r(77),g=r(89),O=r(88),j=r(614),_=r(41),w=function(e){Object(a.a)(r,e);var t=Object(o.a)(r);function r(e,i,a){var o;return Object(n.a)(this,r),(o=t.call(this,e,i,a))._textureRepository=e.waterTextureRepository,o}return Object(i.a)(r,[{key:"initializeProgram",value:function(e){var t=r.shader.get(),n=this.configuration,i=t.build({OITEnabled:0===n.transparencyPassType,output:n.output,viewingMode:e.viewingMode,slicePlaneEnabled:n.slicePlaneEnabled,sliceHighlightDisabled:!1,sliceEnabledForVertexPrograms:!1,receiveShadows:n.receiveShadows,pbrMode:3,useCustomDTRExponentForWater:!0,ssrEnabled:n.useSSR,highStepCount:!0,multipassTerrainEnabled:n.multipassTerrainEnabled,cullAboveGround:n.cullAboveGround});return new O.a(e.rctx,i,y.a)}},{key:"ensureResource",value:function(e){return this._textureRepository.ready||this._textureRepository.updating||this._textureRepository.loadTextures(e),this._textureRepository.ready?2:1}},{key:"bindPass",value:function(e,t){Object(p.c)(this.program,t.camera.projectionMatrix),t.multipassTerrainEnabled&&(this.program.setUniform2fv("cameraNearFar",t.camera.nearFar),this.program.setUniform2fv("inverseViewport",t.inverseViewport),Object(u.a)(this.program,t)),0===this.configuration.output&&(t.lighting.setUniforms(this.program,!1),Object(h.b)(this.program,t)),0!==this.configuration.output&&2!==this.configuration.output||(Object(f.b)(this.program,e),this._textureRepository.bind(this.program)),this.program.setUniform4fv("waterColor",e.color),4===this.configuration.output&&Object(l.b)(this.program,t)}},{key:"bindDraw",value:function(e){Object(p.d)(this.program,e),this.program.rebindTextures(),0!==this.configuration.output&&7!==this.configuration.output||Object(p.a)(this.program,e.origin,e.camera.viewInverseTransposeMatrix),0===this.configuration.output&&Object(d.b)(this.program,e),0!==this.configuration.output&&7!==this.configuration.output&&4!==this.configuration.output||Object(c.c)(this.program,this.configuration,e)}},{key:"setPipelineState",value:function(e){var t=this.configuration,r=3===e,n=2===e;return Object(_.g)({blending:2!==t.output&&4!==t.output&&t.transparent?r?g.f:Object(g.a)(e):null,depthTest:{func:Object(g.b)(e)},depthWrite:r?t.writeDepth&&_.e:Object(g.c)(e),colorWrite:_.d,polygonOffset:r||n?null:Object(g.g)(t.enableOffset)})}},{key:"initializePipeline",value:function(){return this.setPipelineState(this.configuration.transparencyPassType)}}]),r}(v.a);w.shader=new b.a(j.a,(function(){return r.e(214).then(r.bind(null,706))}));var x=function(e){Object(a.a)(r,e);var t=Object(o.a)(r);function r(){var e;return Object(n.a)(this,r),(e=t.apply(this,arguments)).output=0,e.receiveShadows=!1,e.slicePlaneEnabled=!1,e.transparent=!1,e.enableOffset=!0,e.writeDepth=!1,e.useSSR=!1,e.isDraped=!1,e.transparencyPassType=3,e.multipassTerrainEnabled=!1,e.cullAboveGround=!1,e}return r}(m.a);Object(s.a)([Object(m.b)({count:8})],x.prototype,"output",void 0),Object(s.a)([Object(m.b)()],x.prototype,"receiveShadows",void 0),Object(s.a)([Object(m.b)()],x.prototype,"slicePlaneEnabled",void 0),Object(s.a)([Object(m.b)()],x.prototype,"transparent",void 0),Object(s.a)([Object(m.b)()],x.prototype,"enableOffset",void 0),Object(s.a)([Object(m.b)()],x.prototype,"writeDepth",void 0),Object(s.a)([Object(m.b)()],x.prototype,"useSSR",void 0),Object(s.a)([Object(m.b)()],x.prototype,"isDraped",void 0),Object(s.a)([Object(m.b)({count:4})],x.prototype,"transparencyPassType",void 0),Object(s.a)([Object(m.b)()],x.prototype,"multipassTerrainEnabled",void 0),Object(s.a)([Object(m.b)()],x.prototype,"cullAboveGround",void 0)},function(e,t,r){"use strict";r.d(t,"a",(function(){return c})),r.d(t,"b",(function(){return s}));var n,i,a=r(12),o=r(11);function s(e){e.fragment.code.add(Object(o.a)(n||(n=Object(a.a)(["float normals2FoamIntensity(vec3 n, float waveStrength){\nfloat normalizationFactor =  max(0.015, waveStrength);\nreturn max((n.x + n.y)*0.3303545/normalizationFactor + 0.3303545, 0.0);\n}"]))))}function c(e){e.fragment.code.add(Object(o.a)(i||(i=Object(a.a)(["vec3 foamIntensity2FoamColor(float foamIntensityExternal, float foamPixelIntensity, vec3 skyZenitColor, float dayMod){\nreturn foamIntensityExternal * (0.075 * skyZenitColor * pow(foamPixelIntensity, 4.) +  50.* pow(foamPixelIntensity, 23.0)) * dayMod;\n}"]))))}},function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r(2),i=r(5),a=r(3);function o(e){var t=e.capabilities.disjointTimerQuery;return Object(a.i)(t)?null:t.timestampBits()>0?new s(t):l?null:new c(t)}var s=function(){function e(t){Object(n.a)(this,e),this.timer=t,this.start=t.createQuery(),t.createTimestamp(this.start)}return Object(i.a)(e,[{key:"stop",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:50;this.end=this.timer.createQuery(),this.timer.createTimestamp(this.end),this.checkQueryResult(e,t)}},{key:"checkQueryResult",value:function(e,t){var r=this;if(this.timer.resultAvailable(this.end))if(this.timer.disjoint())e(null);else{var n=this.timer.getResult(this.start),i=this.timer.getResult(this.end);e((i-n)/1e6)}else setTimeout((function(){return r.checkQueryResult(e,t)}),t)}}]),e}(),c=function(){function e(t){Object(n.a)(this,e),this.timer=t,this.query=t.createQuery(),l=!0,this.timer.beginTimeElapsed(this.query)}return Object(i.a)(e,[{key:"stop",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:50;this.timer.endTimeElapsed(),l=!1,this.checkQueryResult(e,t)}},{key:"checkQueryResult",value:function(e,t){var r=this,n=this.timer.resultAvailable(this.query),i=this.timer.disjoint();if(!n||i)i?e(null):setTimeout((function(){return r.checkQueryResult(e,t)}),t);else{var a=this.timer.getResult(this.query);e(a/1e6)}}}]),e}(),l=!1},function(e,t,r){"use strict";r.d(t,"a",(function(){return c}));var n=r(13),i=r(2),a=r(5),o=r(3),s=(r(81),r(107),r(17),r(122),r(159),r(239),r(60)),c=(r(104),function(){function e(t){Object(i.a)(this,e),this._rctx=t,this.cache=new Map}return Object(a.a)(e,[{key:"dispose",value:function(){this.cache.forEach((function(e){return e.texture=Object(o.f)(e.texture)})),this.cache.clear()}},{key:"acquire",value:function(e){var t=this;if(Object(o.i)(e))return null;var r=this.patternId(e),n=this.cache.get(r);if(n)return n.refCount++,n.bind;var i=this.patternToTextureData(e,2),a=i.length/2,c={refCount:1,texture:null,bind:function(e){return Object(o.i)(c.texture)&&(c.texture=new s.a(t._rctx,{width:i.length,height:1,internalFormat:6406,pixelFormat:6406,dataType:5121,wrapMode:33071},i)),e.bindTexture(c.texture,"stipplePatternTexture"),a}};return this.cache.set(r,c),c.bind}},{key:"release",value:function(e){if(!Object(o.i)(e)){var t=this.patternId(e),r=this.cache.get(t);r&&(r.refCount--,0===r.refCount&&(Object(o.j)(r.texture)&&r.texture.dispose(),this.cache.delete(t)))}}},{key:"swap",value:function(e,t){var r=this.acquire(t);return this.release(e),r}},{key:"patternId",value:function(e){return e.join(",")}},{key:"patternToTextureData",value:function(e,t){var r,i=e.reduce((function(e,t){return e+t}))*t,a=new Uint8Array(i),o=!0,s=0,c=Object(n.a)(e);try{for(c.s();!(r=c.n()).done;){for(var l=r.value,u=0;u<l*t;u++)a[s++]=o?255:0;o=!o}}catch(d){c.e(d)}finally{c.f()}return a}}]),e}())},function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n,i=r(12),a=r(11);function o(e){e.extensions.add("GL_EXT_shader_texture_lod"),e.extensions.add("GL_OES_standard_derivatives"),e.fragment.code.add(Object(a.a)(n||(n=Object(i.a)(["#ifndef GL_EXT_shader_texture_lod\nfloat calcMipMapLevel(const vec2 ddx, const vec2 ddy) {\nfloat deltaMaxSqr = max(dot(ddx, ddx), dot(ddy, ddy));\nreturn max(0.0, 0.5 * log2(deltaMaxSqr));\n}\n#endif\nvec4 textureAtlasLookup(sampler2D texture, vec2 textureSize, vec2 textureCoordinates, vec4 atlasRegion) {\nvec2 atlasScale = atlasRegion.zw - atlasRegion.xy;\nvec2 uvAtlas = fract(textureCoordinates) * atlasScale + atlasRegion.xy;\nfloat maxdUV = 0.125;\nvec2 dUVdx = clamp(dFdx(textureCoordinates), -maxdUV, maxdUV) * atlasScale;\nvec2 dUVdy = clamp(dFdy(textureCoordinates), -maxdUV, maxdUV) * atlasScale;\n#ifdef GL_EXT_shader_texture_lod\nreturn texture2DGradEXT(texture, uvAtlas, dUVdx, dUVdy);\n#else\nvec2 dUVdxAuto = dFdx(uvAtlas);\nvec2 dUVdyAuto = dFdy(uvAtlas);\nfloat mipMapLevel = calcMipMapLevel(dUVdx * textureSize, dUVdy * textureSize);\nfloat autoMipMapLevel = calcMipMapLevel(dUVdxAuto * textureSize, dUVdyAuto * textureSize);\nreturn texture2D(texture, uvAtlas, mipMapLevel - autoMipMapLevel);\n#endif\n}"]))))}},function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n,i=r(12),a=r(11);function o(e){e.vertex.code.add(Object(a.a)(n||(n=Object(i.a)(["\n    vec4 decodeSymbolColor(vec4 symbolColor, out int colorMixMode) {\n      float symbolAlpha = 0.0;\n\n      const float maxTint = 85.0;\n      const float maxReplace = 170.0;\n      const float scaleAlpha = 3.0;\n\n      if (symbolColor.a > maxReplace) {\n        colorMixMode = ",";\n        symbolAlpha = scaleAlpha * (symbolColor.a - maxReplace);\n      } else if (symbolColor.a > maxTint) {\n        colorMixMode = ",";\n        symbolAlpha = scaleAlpha * (symbolColor.a - maxTint);\n      } else if (symbolColor.a > 0.0) {\n        colorMixMode = ",";\n        symbolAlpha = scaleAlpha * symbolColor.a;\n      } else {\n        colorMixMode = ",";\n        symbolAlpha = 0.0;\n      }\n\n      return vec4(symbolColor.r, symbolColor.g, symbolColor.b, symbolAlpha);\n    }\n  "])),a.a.int(1),a.a.int(3),a.a.int(4),a.a.int(1)))}},function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n,i=r(12),a=r(11);function o(e){var t=e.fragment;t.uniforms.add("lightingMainDirection","vec3"),t.uniforms.add("lightingMainIntensity","vec3"),t.uniforms.add("lightingFixedFactor","float"),t.code.add(Object(a.a)(n||(n=Object(i.a)(["vec3 evaluateMainLighting(vec3 normal_global, float shadowing) {\nfloat dotVal = clamp(dot(normal_global, lightingMainDirection), 0.0, 1.0);\ndotVal = mix(dotVal, 1.0, lightingFixedFactor);\nreturn lightingMainIntensity * ((1.0 - shadowing) * dotVal);\n}"]))))}},function(e,t,r){"use strict";r.d(t,"a",(function(){return o})),r.d(t,"b",(function(){return a})),r.d(t,"c",(function(){return i}));var n=r(407);function i(e,t,r){if(e.count===t.count)for(var i=e.count,a=r[0],o=r[1],s=r[2],c=r[3],l=r[4],u=r[5],d=r[6],h=r[7],f=r[8],p=e.typedBuffer,b=e.typedBufferStride,v=t.typedBuffer,m=t.typedBufferStride,y=0;y<i;y++){var g=y*b,O=y*m,j=v[O],_=v[O+1],w=v[O+2],x=v[O+3];p[g]=a*j+c*_+d*w,p[g+1]=o*j+l*_+h*w,p[g+2]=s*j+u*_+f*w,p[g+3]=x}else n.a.error("source and destination buffers need to have the same number of elements")}function a(e,t,r){for(var n=Math.min(e.count,t.count),i=e.typedBuffer,a=e.typedBufferStride,o=t.typedBuffer,s=t.typedBufferStride,c=0;c<n;c++){var l=c*a,u=c*s;i[l]=r*o[u],i[l+1]=r*o[u+1],i[l+2]=r*o[u+2],i[l+3]=r*o[u+3]}}function o(e,t,r){for(var n=Math.min(e.count,t.count),i=e.typedBuffer,a=e.typedBufferStride,o=t.typedBuffer,s=t.typedBufferStride,c=0;c<n;c++){var l=c*a,u=c*s;i[l]=o[u]>>r,i[l+1]=o[u+1]>>r,i[l+2]=o[u+2]>>r,i[l+3]=o[u+3]>>r}}Object.freeze({__proto__:null,transformMat4:function(e,t,r){if(e.count===t.count)for(var i=e.count,a=r[0],o=r[1],s=r[2],c=r[3],l=r[4],u=r[5],d=r[6],h=r[7],f=r[8],p=r[9],b=r[10],v=r[11],m=r[12],y=r[13],g=r[14],O=r[15],j=e.typedBuffer,_=e.typedBufferStride,w=t.typedBuffer,x=t.typedBufferStride,k=0;k<i;k++){var S=k*_,T=k*x,C=w[T],M=w[T+1],P=w[T+2],A=w[T+3];j[S]=a*C+l*M+f*P+m*A,j[S+1]=o*C+u*M+p*P+y*A,j[S+2]=s*C+d*M+b*P+g*A,j[S+3]=c*C+h*M+v*P+O*A}else n.a.error("source and destination buffers need to have the same number of elements")},transformMat3:i,scale:a,shiftRight:o})},function(e,t,r){"use strict";r.d(t,"a",(function(){return s})),r.d(t,"b",(function(){return o})),r.d(t,"c",(function(){return a}));var n=r(94),i=r(150);function a(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:i.d;return"number"==typeof e?t(e):Object(n.i)(e)||Object(n.k)(e)?new Uint32Array(e):e}function o(e){var t="number"==typeof e?e:e.length;if(t<3)return new Uint16Array(0);var r=t-2,n=r<=65536?new Uint16Array(3*r):new Uint32Array(3*r);if("number"==typeof e)for(var i=0,a=0;a<r;a+=1)a%2==0?(n[i++]=a,n[i++]=a+1,n[i++]=a+2):(n[i++]=a+1,n[i++]=a,n[i++]=a+2);else for(var o=0,s=0;s<r;s+=1)if(s%2==0){var c=e[s],l=e[s+1],u=e[s+2];n[o++]=c,n[o++]=l,n[o++]=u}else{var d=e[s+1],h=e[s],f=e[s+2];n[o++]=d,n[o++]=h,n[o++]=f}return n}function s(e){var t="number"==typeof e?e:e.length;if(t<3)return new Uint16Array(0);var r=t-2,n=r<=65536?new Uint16Array(3*r):new Uint32Array(3*r);if("number"==typeof e){for(var i=0,a=0;a<r;++a)n[i++]=0,n[i++]=a+1,n[i++]=a+2;return n}for(var o=e[0],s=e[1],c=0,l=0;l<r;++l){var u=e[l+2];n[c++]=o,n[c++]=s,n[c++]=u,s=u}return n}},function(e,t,r){"use strict";r.d(t,"a",(function(){return l}));var n=r(2),i=r(5),a=r(49),o=r(3),s=r(28),c=r(43),l=function(){function e(t){Object(n.a)(this,e),this.definition=t,this.key=JSON.stringify(t),this.haloSize=Math.round(t.halo.size),this.fillStyle=this.colorToRGBA(t.color),this.haloStyle=this.colorToRGB(t.halo.color)}return Object(i.a)(e,[{key:"colorToRGB",value:function(e){return"rgb(".concat(e.slice(0,3).map((function(e){return Math.floor(255*e)})).toString(),")")}},{key:"colorToRGBA",value:function(e){return"rgba(".concat(e.slice(0,3).map((function(e){return Math.floor(255*e)})).toString(),",").concat(e[3],")")}}],[{key:"fromSymbol",value:function(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=Object(o.h)(t,"material","color"),i=Object(o.j)(n)?a.a.toUnitRGBA(n):c.b,l=t.halo,u=null!=t.size?Object(s.g)(t.size):12,d={family:t.font&&t.font.family?t.font.family:"sans-serif",weight:t.font&&t.font.weight?t.font.weight:"normal",style:t.font&&t.font.style?t.font.style:"normal"},h=Object(o.j)(l)&&Object(o.j)(l.color)&&l.size>0?{size:Object(s.g)(l.size),color:a.a.toUnitRGBA(l.color)}:{size:0,color:c.b};return new e({size:u,color:i,font:d,halo:h,pixelRatio:r})}}]),e}()},function(e,t,r){"use strict";var n=r(2),i=r(5),a=r(6),o=r(7),s=r(0),c=r(402),l=r(337),u=r(30),d=r(280),h=r(82),f=r(15),p=r(1),b=(r(17),r(64)),v=r(10);function m(e){var t;return!!(e&&e.loaded&&"capabilities"in e&&null!=e&&null!=(t=e.capabilities)&&t.operations&&"supportsEditing"in e.capabilities.operations&&!0===e.capabilities.operations.supportsEditing)&&!("editingEnabled"in e&&!e.editingEnabled)}var y=r(506),g=r(18),O=f.a.getLogger("esri.support.groundUtils"),j={"world-elevation":{id:"worldElevation",url:"//elevation3d.arcgis.com/arcgis/rest/services/WorldElevation3D/Terrain3D/ImageServer",layerType:"ArcGISTiledElevationServiceLayer"},"world-topobathymetry":{id:"worldTopoBathymetry",url:"//elevation3d.arcgis.com/arcgis/rest/services/WorldElevation3D/TopoBathy3D/ImageServer",layerType:"ArcGISTiledElevationServiceLayer"}};var _=r(639),w=r(640),x=f.a.getLogger("esri.Map"),k=function(e){Object(a.a)(r,e);var t=Object(o.a)(r);function r(e){var i;return Object(n.a)(this,r),(i=t.call(this,e)).allLayers=new d.a({getCollections:function(){var e,t,r;return[null==(e=i.basemap)?void 0:e.baseLayers,null==(t=i.ground)?void 0:t.layers,i.layers,null==(r=i.basemap)?void 0:r.referenceLayers]},getChildrenFunction:function(e){return"layers"in e?e.layers:null}}),i.allTables=new d.a({getCollections:function(){return[i.tables,i.layers]},getChildrenFunction:function(e){var t=[];return"tables"in e&&t.push(e.tables),"layers"in e&&t.push(e.layers),t},itemFilterFunction:function(e){var t=e.parent;return t&&"tables"in t&&t.tables.includes(e)}}),i.basemap=null,i.editableLayers=new d.a({getCollections:function(){return[i.allLayers]},itemFilterFunction:m}),i.ground=new l.a,i._basemapCache=Object(y.a)(),i}return Object(i.a)(r,[{key:"destroy",value:function(){var e,t;this.allLayers.destroy(),this.allTables.destroy(),this.editableLayers.destroy(),null==(e=this.ground)||e.destroy(),null==(t=this.basemap)||t.destroy(),Object(y.b)(this._basemapCache),this._basemapCache=null}},{key:"castBasemap",value:function(e){return Object(y.c)(e,this._basemapCache)}},{key:"castGround",value:function(e){return function(e){var t;if("string"==typeof e)if(e in j){var r=j[e];t=new l.a({resourceInfo:{data:{layers:[r]}}})}else O.warn("Unable to find ground definition for: ".concat(e,'. Try "world-elevation"'));else t=Object(g.m)(l.a,e);return t}(e)||(x.error("Map.ground may not be set to null or undefined"),this._get("ground"))}},{key:"findLayerById",value:function(e){return this.allLayers.find((function(t){return t.id===e}))}},{key:"findTableById",value:function(e){return this.allTables.find((function(t){return t.id===e}))}}]),r}(Object(w.a)(Object(_.a)(h.a.EventedMixin(u.a))));Object(s.a)([Object(p.b)({readOnly:!0,dependsOn:[]})],k.prototype,"allLayers",void 0),Object(s.a)([Object(p.b)({readOnly:!0})],k.prototype,"allTables",void 0),Object(s.a)([Object(p.b)({type:c.default})],k.prototype,"basemap",void 0),Object(s.a)([Object(b.a)("basemap")],k.prototype,"castBasemap",null),Object(s.a)([Object(p.b)({readOnly:!0})],k.prototype,"editableLayers",void 0),Object(s.a)([Object(p.b)({type:l.a,nonNullable:!0})],k.prototype,"ground",void 0),Object(s.a)([Object(b.a)("ground")],k.prototype,"castGround",null);var S=k=Object(s.a)([Object(v.a)("esri.Map")],k);t.a=S},function(e,t,r){"use strict";var n=r(50),i=r(13),a=r(2),o=r(5),s=r(121),c=r(3),l=r(26),u=r(31),d=r(142),h=r(20),f=function(){function e(t){Object(a.a)(this,e),null==t?t=16:t<65536&&(t=Object(h.p)(t)),this._array=new Float32Array(t),this._size=0}return Object(o.a)(e,[{key:"resize",value:function(e,t){if(this._size=e,this._size>this._array.length){for(var r=this._array.length||1;r<this._size;)r*=2;var n=new Float32Array(r);return t&&n.set(this._array),this._array=n,!0}var i=2*this._size;if(i<=this._array.length){for(var a=this._array.length;a>=i;)a=Math.floor(a/2);var o=new Float32Array(a);return t&&o.set(this._array.subarray(0,a)),this._array=o,!0}return!1}},{key:"append",value:function(e){var t=this._size;this.resize(this._size+e.length,!0),this._array.set(e,t)}},{key:"erase",value:function(e,t){for(var r=e;r<t;++r)this._array[r]=0}},{key:"array",get:function(){return this._array}},{key:"size",get:function(){return this._size}}]),e}(),p=r(46),b=r(440),v=function e(t,r,n,i,o,s){Object(a.a)(this,e),this.from=t,this.to=r,this.isVisible=n,this.hasHighlights=i,this.hasOccludees=o,this.transformation=s,null!=s&&(this.transformationNormal=Object(u.c)(s),Object(l.a)(this.transformationNormal,this.transformationNormal),Object(l.e)(this.transformationNormal,this.transformationNormal))};function m(e,t){var r=function(e){return{first:e.from,count:e.to-e.from}};if(0!==e.length){var n=e[e.length-1];if(function(e,t){return e.first+e.count>=t.from}(n,t)){var i=t.from-n.first+t.to-t.from;n.count=i}else e.push(r(t))}else e.push(r(t))}var y=r(136),g=r(441),O=r(81),j=r(92),_=r(104),w=function(){function e(t,r,n){Object(a.a)(this,e),this.type="MergedRenderer",this._dataByOrigin=new Map,this._hasHighlights=!1,this._hasOccludees=!1,this._rctx=t,this._material=n,this._materialRep=r,this._glMaterials=Object(y.a)(this._material,this._materialRep),this._bufferWriter=n.createBufferWriter()}return Object(o.a)(e,[{key:"dispose",value:function(){Object(y.f)(this._material,this._materialRep),this._dataByOrigin&&(this._dataByOrigin.forEach((function(e){e.vao.dispose(!0),e.vao=null})),this._dataByOrigin.clear(),this._dataByOrigin=null),this._glMaterials&&(this._glMaterials.forEach((function(e){e&&e.dispose()})),this._glMaterials.clear(),this._glMaterials=null)}},{key:"isEmpty",get:function(){return 0===this._dataByOrigin.size}},{key:"hasHighlights",get:function(){return this._hasHighlights}},{key:"hasOccludees",get:function(){return this._hasOccludees}},{key:"hasWater",get:function(){return!this.isEmpty&&Object(s.b)(this._glMaterials,(function(e){return e instanceof b.a}))}},{key:"rendersOccluded",get:function(){return!this.isEmpty&&1!==this._material.renderOccluded}},{key:"modify",value:function(e){this.updateGeometries(e.updates),this.addAndRemoveGeometries(e.adds,e.removes),this.updateRenderCommands()}},{key:"addAndRemoveGeometries",value:function(e,t){var r=this,n=this._bufferWriter,a=n.vertexBufferLayout,o=a.stride/4,s=this._dataByOrigin,l=function(e,t,r,n){var a,o=new Map,s=t.vertexBufferLayout.stride/4,l=function(r,n){var i=r.origin;if(!Object(c.i)(i)){var a=e.get(i.id),l=o.get(i.id);null==l&&(l={optimalCount:null==a?0:a.optimalCount,sparseCount:null==a?0:a.buffer.size,toAdd:[],toRemove:[],origin:i.vec3},o.set(i.id,l));var u=t.elementCount(r.data)*s;n?(l.optimalCount+=u,l.sparseCount+=u,l.toAdd.push(r)):(l.optimalCount-=u,l.toRemove.push(r))}},u=Object(i.a)(r);try{for(u.s();!(a=u.n()).done;){l(a.value,!0)}}catch(f){u.e(f)}finally{u.f()}var d,h=Object(i.a)(n);try{for(h.s();!(d=h.n()).done;){l(d.value,!1)}}catch(f){h.e(f)}finally{h.f()}return o}(s,n,e,t);l.forEach((function(e,t){l.delete(t);var n=e.optimalCount,i=e.sparseCount,c=s.get(t);if(null==c)Object(p.a)(n>0),c=r.createData(a,n,e.origin),s.set(t,c);else if(0===n)return c.vao.dispose(!0),c.vao=null,void s.delete(t);var u=n<e.sparseCount/2,d=u?n:i,h=k,f=c.buffer.size,b=c.buffer.array,v=c.buffer.resize(d,!1);u||v?r.removeAndRebuild(c,e.toRemove,o,b,h):e.toRemove.length>0?(r.removeByErasing(c,e.toRemove,o,h),e.toAdd.length>0&&(h.end=f)):(h.begin=f,h.end=f);var m=S;Object(p.m)(m,-e.origin[0],-e.origin[1],-e.origin[2]),r.append(c,e.toAdd,o,m,h);var y=c.vao.vertexBuffers.geometry;if(y.byteSize!==c.buffer.array.buffer.byteLength)y.setData(c.buffer.array);else{var g=h.begin,O=h.end;if(g<O){var j=c.buffer.array,_=4*g,w=4*O;y.setSubData(j,_,_,w)}}c.drawCommandsDirty=!0}))}},{key:"updateGeometries",value:function(e){var t,r=this._bufferWriter,n=r.vertexBufferLayout.stride/4,a=Object(i.a)(e);try{for(a.s();!(t=a.n()).done;){var o=t.value,s=o.updateType,c=o.renderGeometry,l=this._dataByOrigin.get(c.origin.id),u=l&&l.instances.get(c.id);if(!u)return;if(1&s&&(u.isVisible=c.instanceParameters.visible),9&s){var d=c.instanceParameters.visible;u.hasHighlights=!!c.instanceParameters.highlights&&d}if(16&s&&(u.hasOccludees=!!c.instanceParameters.occludees),6&s){var h=l.buffer.array,f=l.vao;Object(y.c)(c,T,C),r.write({transformation:T,invTranspTransformation:C},c.data,r.vertexBufferLayout.createView(h.buffer),u.from),Object(p.a)(u.from+r.elementCount(c.data)===u.to,"material VBO layout has changed"),f.vertexBuffers.geometry.setSubData(h,u.from*n*4,u.from*n*4,u.to*n*4)}l.drawCommandsDirty=!0}}catch(b){a.e(b)}finally{a.f()}}},{key:"updateRenderCommands",value:function(){var e=this;this._hasHighlights=!1,this._hasOccludees=!1,this._dataByOrigin.forEach((function(t){t.hasHiddenInstances=!1,t.hasHighlights=!1,t.hasOccludees=!1,Object(s.b)(t.instances,(function(r){return r.isVisible?(r.hasHighlights&&(e._hasHighlights=!0,t.hasHighlights=!0),r.hasOccludees&&(e._hasOccludees=!0,t.hasOccludees=!0)):t.hasHiddenInstances=!0,t.hasHiddenInstances&&t.hasHighlights&&t.hasOccludees}))}));this._dataByOrigin.forEach((function(e){e.drawCommandsDirty&&(function(e){if(e.drawCommandsDefault=null,e.drawCommandsHighlight=null,e.drawCommandsOccludees=null,e.drawCommandsShadowHighlightRest=null,e.stats={default:0,highlight:0,occludees:0,shadowHighlightRest:0},0!==e.instances.size){if(!x(e)){var t=4*e.buffer.size/Object(j.d)(e.vao.layout.geometry);return e.drawCommandsDefault=[{first:0,count:t}],void(e.stats={default:t,highlight:0,occludees:0,shadowHighlightRest:0})}var r=function(e){return e.sort((function(e,t){return e.from===t.from?e.to>t.to?1:e.to<t.to?-1:0:e.from>t.from?1:e.from<t.from?-1:0}))}(Object(n.a)(e.instances.values()));e.drawCommandsDefault=[],e.drawCommandsHighlight=[],e.drawCommandsOccludees=[],e.drawCommandsShadowHighlightRest=[];var a,o=Object(i.a)(r);try{for(o.s();!(a=o.n()).done;){var s=a.value;s.isVisible&&(s.hasOccludees?m(e.drawCommandsOccludees,s):m(e.drawCommandsDefault,s),s.hasHighlights?m(e.drawCommandsHighlight,s):m(e.drawCommandsShadowHighlightRest,s))}}catch(l){o.e(l)}finally{o.f()}var c=function(e){var t,r=0,n=Object(i.a)(e);try{for(n.s();!(t=n.n()).done;)r+=t.value.count}catch(l){n.e(l)}finally{n.f()}return r/3};e.stats={default:c(e.drawCommandsDefault),highlight:c(e.drawCommandsHighlight),occludees:c(e.drawCommandsOccludees),shadowHighlightRest:c(e.drawCommandsShadowHighlightRest)}}}(e),e.drawCommandsDirty=!1)}))}},{key:"updateLogic",value:function(e){return this._material.update(e)}},{key:"render",value:function(e,t,r,n){var i=this,a=this._rctx,o=this._glMaterials.get(t),s=5===t||7===t,l=6===t,u=!(s||l);if(3===t&&null===e&&(e=22),!o||2!==o.ensureResources(a)||null!=e&&!o.beginSlot(e)||s&&!this._hasHighlights)return!1;o.ensureParameters(r);var d=o.getPipelineState(e,!1);a.setPipelineState(d);var h=o.technique;a.useProgram(h.program),o.bind(r);var f=!1;return this._dataByOrigin.forEach((function(t){if(!(Object(c.i)(t.drawCommandsDefault)&&Object(c.i)(t.drawCommandsHighlight)&&Object(c.i)(t.drawCommandsOccludees)&&Object(c.i)(t.drawCommandsShadowHighlightRest))&&(!s||t.hasHighlights)){r.origin=t.origin,h.bindDraw(r,{},{}),h.ensureAttributeLocations(t.vao),a.bindVAO(t.vao);var p=h.primitiveType,b=s?t.drawCommandsHighlight:l&&x(t)?t.drawCommandsShadowHighlightRest:t.drawCommandsDefault;if(Object(c.j)(b)){i.renderCommands(a,p,b);var v=s?t.stats.highlight:l&&x(t)?t.stats.shadowHighlightRest:t.stats.default;Object(g.b)(b.length,v,n),f=!0}if(u){var m=t.drawCommandsOccludees;if(Object(c.j)(m)){var y=o.getPipelineState(e,!0);a.setPipelineState(y),i.renderCommands(a,p,m),a.setPipelineState(d),Object(g.b)(m.length,t.stats.occludees,n),f=!0}}}})),f}},{key:"renderCommands",value:function(e,t,r){for(var n=0;n<r.length;n++)e.drawArrays(t,r[n].first,r[n].count)}},{key:"createData",value:function(e,t,r){return{instances:new Map,vao:new _.a(this._rctx,this._material.vertexAttributeLocations,{geometry:Object(d.a)(e)},{geometry:O.a.createVertex(this._rctx,35044)}),buffer:new f(t),optimalCount:0,origin:r,hasHiddenInstances:!1,hasHighlights:!1,hasOccludees:!1,drawCommandsDirty:!1,drawCommandsDefault:null,drawCommandsOccludees:null,drawCommandsHighlight:null,drawCommandsShadowHighlightRest:null,stats:{default:0,highlight:0,occludees:0,shadowHighlightRest:0}}}},{key:"removeAndRebuild",value:function(e,t,r,n,a){var o,s=Object(i.a)(t);try{for(s.s();!(o=s.n()).done;){var c=o.value.id,l=e.instances.get(c);e.optimalCount-=(l.to-l.from)*r,e.instances.delete(c)}}catch(b){s.e(b)}finally{s.f()}var u=0,d=e.buffer.array;a.begin=0,a.end=0;var h=-1,f=-1,p=0;e.instances.forEach((function(e){var t=e.from*r,i=e.to*r,a=i-t;h!==f&&f!==t?(d.set(n.subarray(h,f),p),p+=f-h,h=t):-1===h&&(h=t),f=i,e.from=u/r,u+=a,e.to=u/r})),h!==f&&d.set(n.subarray(h,f),p),a.end=u}},{key:"removeByErasing",value:function(e,t,r,n){n.begin=1/0,n.end=-1/0;var a,o=-1,s=-1,c=Object(i.a)(t);try{for(c.s();!(a=c.n()).done;){var l=a.value.id,u=e.instances.get(l),d=u.from*r,h=u.to*r;o!==s&&s!==d?(e.buffer.erase(o,s),o=d):-1===o&&(o=d),s=h,e.instances.delete(l),e.optimalCount-=h-d,d<n.begin&&(n.begin=d),h>n.end&&(n.end=h)}}catch(f){c.e(f)}finally{c.f()}o!==s&&e.buffer.erase(o,s)}},{key:"append",value:function(e,t,r,n,a){var o,s=this._bufferWriter,u=Object(i.a)(t);try{for(u.s();!(o=u.n()).done;){var d=o.value,h=Object(c.j)(d.transformation)?Object(l.m)(T,n,d.transformation):n;Object(l.a)(C,h),Object(l.e)(C,C);var f=a.end;s.write({transformation:h,invTranspTransformation:C},d.data,s.vertexBufferLayout.createView(e.buffer.array.buffer),a.end/r);var b=s.elementCount(d.data)*r,m=f+b;Object(p.a)(null==e.instances.get(d.id));var y=d.instanceParameters.visible,g=!!d.instanceParameters.highlights&&y,O=!!d.instanceParameters.occludees,j=new v(f/r,m/r,y,g,O);e.instances.set(d.id,j),e.optimalCount+=b,a.end+=b}}catch(_){u.e(_)}finally{u.f()}}},{key:"test",get:function(){return{material:this._material,glMaterials:this._glMaterials}}}]),e}();function x(e){return e.hasOccludees||e.hasHighlights||e.hasHiddenInstances}var k={begin:0,end:0},S=Object(u.d)(),T=Object(u.d)(),C=Object(u.d)();t.a=w},function(e,t,r){"use strict";r.d(t,"a",(function(){return x}));var n=r(2),i=r(5),a=r(4),o=r(9),s=r(231),c=r(13),l=r(20);function u(e,t,r){(r=r||e).length=e.length;for(var n=0;n<e.length;n++)r[n]=e[n]*t[n];return r}function d(e,t,r){(r=r||e).length=e.length;for(var n=0;n<e.length;n++)r[n]=e[n]*t;return r}function h(e,t,r){(r=r||e).length=e.length;for(var n=0;n<e.length;n++)r[n]=e[n]+t[n];return r}function f(e){return(e+1)*(e+1)}function p(e,t,r){var n=e[0],i=e[1],a=e[2],o=r||[];return o.length=f(t),t>=0&&(o[0]=.28209479177),t>=1&&(o[1]=.4886025119*n,o[2]=.4886025119*a,o[3]=.4886025119*i),t>=2&&(o[4]=1.09254843059*n*i,o[5]=1.09254843059*i*a,o[6]=.31539156525*(3*a*a-1),o[7]=1.09254843059*n*a,o[8]=.54627421529*(n*n-i*i)),o}function b(e,t){var r,n,i=(r=t.r.length,Object(l.e)(Math.floor(Math.sqrt(r)-1),0,2)),o=Object(c.a)(e);try{for(o.s();!(n=o.n()).done;){var s=n.value;Object(a.u)(_,s.direction),p(_,i,O),u(O,w),d(O,s.intensity[0],j),h(t.r,j),d(O,s.intensity[1],j),h(t.g,j),d(O,s.intensity[2],j),h(t.b,j)}}catch(f){o.e(f)}finally{o.f()}return t}function v(e,t,r,n){(function(e,t){var r=f(e),n=t||{r:[],g:[],b:[]};n.r.length=n.g.length=n.b.length=r;for(var i=0;i<r;i++)n.r[i]=n.g[i]=n.b[i]=0})(t,n),Object(a.y)(r.intensity,0,0,0);var i=!1,o=m,l=y,u=g;o.length=0,l.length=0,u.length=0;var d,v=Object(c.a)(e);try{for(v.s();!(d=v.n()).done;){var j=d.value;j instanceof s.c&&!i?(Object(a.m)(r.direction,j.direction),r.intensity[0]=j.intensity[0],r.intensity[1]=j.intensity[1],r.intensity[2]=j.intensity[2],r.castShadows=j.castShadows,i=!0):j instanceof s.c||j instanceof s.b?o.push(j):j instanceof s.a?l.push(j):j instanceof s.d&&u.push(j)}}catch(T){v.e(T)}finally{v.f()}b(o,n),function(e,t){p(_,0,O);var r,n=Object(c.a)(e);try{for(n.s();!(r=n.n()).done;){var i=r.value;t.r[0]+=O[0]*w[0]*i.intensity[0]*4*Math.PI,t.g[0]+=O[0]*w[0]*i.intensity[1]*4*Math.PI,t.b[0]+=O[0]*w[0]*i.intensity[2]*4*Math.PI}}catch(T){n.e(T)}finally{n.f()}}(l,n);var x,k=Object(c.a)(u);try{for(k.s();!(x=k.n()).done;){var S=x.value;h(n.r,S.r),h(n.g,S.g),h(n.b,S.b)}}catch(T){k.e(T)}finally{k.f()}}var m=[],y=[],g=[],O=[0],j=[0],_=Object(o.e)(),w=[3.141593,2.094395,2.094395,2.094395,.785398,.785398,.785398,.785398,.785398],x=function(){function e(){Object(n.a)(this,e),this._shOrder=2,this._ambientBoost=.4,this._oldSunlight={direction:Object(o.e)(),ambient:{color:Object(o.e)(),intensity:1},diffuse:{color:Object(o.e)(),intensity:1}},this.globalFactor=.5,this.groundLightingFactor=.5,this._sphericalHarmonics=new s.d,this._mainLight={intensity:Object(o.e)(),direction:Object(o.g)(1,0,0),castShadows:!1}}return Object(i.a)(e,[{key:"lightingMainDirection",get:function(){return this._mainLight.direction}},{key:"setLightDirectionUniform",value:function(e){e.setUniform3fv("lightingMainDirection",this._mainLight.direction)}},{key:"setUniforms",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=t?(1-this.groundLightingFactor)*(1-this.globalFactor):0;e.setUniform1f("lightingFixedFactor",r),e.setUniform1f("lightingGlobalFactor",this.globalFactor),this.setLightDirectionUniform(e),e.setUniform3fv("lightingMainIntensity",this._mainLight.intensity),e.setUniform1f("ambientBoostFactor",this._ambientBoost);var n=this._sphericalHarmonics;0===this._shOrder?e.setUniform3f("lightingAmbientSH0",n.r[0],n.g[0],n.b[0]):1===this._shOrder?(e.setUniform4f("lightingAmbientSH_R",n.r[0],n.r[1],n.r[2],n.r[3]),e.setUniform4f("lightingAmbientSH_G",n.g[0],n.g[1],n.g[2],n.g[3]),e.setUniform4f("lightingAmbientSH_B",n.b[0],n.b[1],n.b[2],n.b[3])):2===this._shOrder&&(e.setUniform3f("lightingAmbientSH0",n.r[0],n.g[0],n.b[0]),e.setUniform4f("lightingAmbientSH_R1",n.r[1],n.r[2],n.r[3],n.r[4]),e.setUniform4f("lightingAmbientSH_G1",n.g[1],n.g[2],n.g[3],n.g[4]),e.setUniform4f("lightingAmbientSH_B1",n.b[1],n.b[2],n.b[3],n.b[4]),e.setUniform4f("lightingAmbientSH_R2",n.r[5],n.r[6],n.r[7],n.r[8]),e.setUniform4f("lightingAmbientSH_G2",n.g[5],n.g[6],n.g[7],n.g[8]),e.setUniform4f("lightingAmbientSH_B2",n.b[5],n.b[6],n.b[7],n.b[8]))}},{key:"set",value:function(e){v(e,this._shOrder,this._mainLight,this._sphericalHarmonics),Object(a.m)(this._oldSunlight.direction,this._mainLight.direction);var t=1/Math.PI;this._oldSunlight.ambient.color[0]=.282095*this._sphericalHarmonics.r[0]*t,this._oldSunlight.ambient.color[1]=.282095*this._sphericalHarmonics.g[0]*t,this._oldSunlight.ambient.color[2]=.282095*this._sphericalHarmonics.b[0]*t,Object(a.g)(this._oldSunlight.diffuse.color,this._mainLight.intensity,t),Object(a.m)(k,this._oldSunlight.diffuse.color),Object(a.g)(k,k,this._ambientBoost*this.globalFactor),Object(a.h)(this._oldSunlight.ambient.color,this._oldSunlight.ambient.color,k)}},{key:"old",get:function(){return this._oldSunlight}}]),e}(),k=Object(o.e)()},function(e,t,r){"use strict";r.r(t);var n=r(2),i=r(5),a=r(6),o=r(7),s=r(0),c=r(22),l=r(27),u=r(1),d=(r(17),r(18),r(15),r(10)),h=function(e){Object(a.a)(r,e);var t=Object(o.a)(r);function r(e){var i;return Object(n.a)(this,r),(i=t.call(this,e)).created=null,i.id=null,i.portal=null,i.title=null,i.username=null,i}return Object(i.a)(r,[{key:"url",get:function(){var e=this.get("portal.restUrl");return e?"".concat(e,"/content/users/").concat(this.username,"/").concat(this.id):null}},{key:"toJSON",value:function(){throw new c.a("internal:not-yet-implemented","PortalFolder.toJSON is not yet implemented")}}]),r}(l.a);Object(s.a)([Object(u.b)({type:Date})],h.prototype,"created",void 0),Object(s.a)([Object(u.b)()],h.prototype,"id",void 0),Object(s.a)([Object(u.b)()],h.prototype,"portal",void 0),Object(s.a)([Object(u.b)()],h.prototype,"title",void 0),Object(s.a)([Object(u.b)({readOnly:!0})],h.prototype,"url",null),Object(s.a)([Object(u.b)()],h.prototype,"username",void 0);var f,p=h=Object(s.a)([Object(d.a)("esri.portal.PortalFolder")],h),b=r(566),v=f=function(e){Object(a.a)(s,e);var t=Object(o.a)(s);function s(){var e;Object(n.a)(this,s);for(var r=arguments.length,i=new Array(r),a=0;a<r;a++)i[a]=arguments[a];return(e=t.call.apply(t,[this].concat(i))).access=null,e.created=null,e.culture=null,e.description=null,e.email=null,e.fullName=null,e.modified=null,e.orgId=null,e.portal=null,e.preferredView=null,e.privileges=null,e.region=null,e.role=null,e.roleId=null,e.sourceJSON=null,e.units=null,e.username=null,e.userType=null,e}return Object(i.a)(s,[{key:"thumbnailUrl",get:function(){var e=this.url,t=this.thumbnail;return e&&t?this.portal._normalizeUrl("".concat(e,"/info/").concat(t,"?f=json")):null}},{key:"userContentUrl",get:function(){var e=this.get("portal.restUrl");return e?"".concat(e,"/content/users/").concat(this.username):null}},{key:"url",get:function(){var e=this.get("portal.restUrl");return e?"".concat(e,"/community/users/").concat(this.username):null}},{key:"addItem",value:function(e){var t=this,r=e&&e.item,n=e&&e.data,i=e&&e.folder,a={method:"post"};r&&(a.query=r.createPostQuery(),null!=n&&("string"==typeof n?a.query.text=n:"object"==typeof n&&(a.query.text=JSON.stringify(n))));var o=this.userContentUrl;return i&&(o+="/"+("string"==typeof i?i:i.id)),this.portal._request(o+"/addItem",a).then((function(e){return r.id=e.id,r.portal=t.portal,r.loaded?r.reload():r.load()}))}},{key:"deleteItem",value:function(e){var t=this.userContentUrl;return e.ownerFolder&&(t+="/"+e.ownerFolder),this.portal._request(t+"/items/".concat(e.id,"/delete"),{method:"post"}).then((function(){e.id=null,e.portal=null}))}},{key:"deleteItems",value:function(e){var t=this.userContentUrl+"/deleteItems",r=e.map((function(e){return e.id}));if(r.length){var n={method:"post",query:{items:r.join(",")}};return this.portal._request(t,n).then((function(){e.forEach((function(e){e.id=null,e.portal=null}))}))}return Promise.resolve(void 0)}},{key:"fetchFolders",value:function(){var e=this;return this.portal._request(this.userContentUrl,{query:{num:1}}).then((function(t){return t&&t.folders?t.folders.map((function(t){var r=p.fromJSON(t);return r.portal=e.portal,r})):[]}))}},{key:"fetchGroups",value:function(){var e=this;return this.portal._request(this.url).then((function(t){return t&&t.groups?t.groups.map((function(t){var r=b.default.fromJSON(t);return r.portal=e.portal,r})):[]}))}},{key:"fetchItems",value:function(e){var t=this;e||(e={});var n,i=this.userContentUrl;return e.folder&&(i+="/"+e.folder.id),Promise.resolve().then(r.bind(null,418)).then((function(r){var a=r.default;n=a;var o={folders:!1,num:e.num||10,start:e.start||1,sortField:e.sortField||"created",sortOrder:e.sortOrder||"asc"};return t.portal._request(i,{query:o})})).then((function(e){var r;return e&&e.items?(r=e.items.map((function(e){var r=n.fromJSON(e);return r.portal=t.portal,r})),Promise.all(r.map((function(e){return e.load()}))).catch((function(e){return e})).then((function(){return{items:r,nextStart:e.nextStart,total:e.total}}))):{items:[],nextStart:-1,total:0}}))}},{key:"fetchTags",value:function(){return this.portal._request(this.url+"/tags").then((function(e){return e.tags}))}},{key:"getThumbnailUrl",value:function(e){var t=this.thumbnailUrl;return t&&e&&(t+="&w=".concat(e)),t}},{key:"queryFavorites",value:function(e){return this.favGroupId?(this._favGroup||(this._favGroup=new b.default({id:this.favGroupId,portal:this.portal})),this._favGroup.queryItems(e)):Promise.reject(new c.a("internal:unknown","Unknown internal error",{internalError:"Unknown favGroupId"}))}},{key:"toJSON",value:function(){throw new c.a("internal:not-yet-implemented","PortalGroup.toJSON is not yet implemented")}}],[{key:"fromJSON",value:function(e){if(!e)return null;if(e.declaredClass)throw new Error("JSON object is already hydrated");var t=new f;return t.sourceJSON=e,t.read(e),t}}]),s}(l.a);Object(s.a)([Object(u.b)()],v.prototype,"access",void 0),Object(s.a)([Object(u.b)({type:Date})],v.prototype,"created",void 0),Object(s.a)([Object(u.b)()],v.prototype,"culture",void 0),Object(s.a)([Object(u.b)()],v.prototype,"description",void 0),Object(s.a)([Object(u.b)()],v.prototype,"email",void 0),Object(s.a)([Object(u.b)()],v.prototype,"favGroupId",void 0),Object(s.a)([Object(u.b)()],v.prototype,"fullName",void 0),Object(s.a)([Object(u.b)({type:Date})],v.prototype,"modified",void 0),Object(s.a)([Object(u.b)()],v.prototype,"orgId",void 0),Object(s.a)([Object(u.b)()],v.prototype,"portal",void 0),Object(s.a)([Object(u.b)()],v.prototype,"preferredView",void 0),Object(s.a)([Object(u.b)()],v.prototype,"privileges",void 0),Object(s.a)([Object(u.b)()],v.prototype,"region",void 0),Object(s.a)([Object(u.b)()],v.prototype,"role",void 0),Object(s.a)([Object(u.b)()],v.prototype,"roleId",void 0),Object(s.a)([Object(u.b)()],v.prototype,"sourceJSON",void 0),Object(s.a)([Object(u.b)()],v.prototype,"thumbnail",void 0),Object(s.a)([Object(u.b)({readOnly:!0})],v.prototype,"thumbnailUrl",null),Object(s.a)([Object(u.b)()],v.prototype,"units",void 0),Object(s.a)([Object(u.b)({readOnly:!0})],v.prototype,"userContentUrl",null),Object(s.a)([Object(u.b)({readOnly:!0})],v.prototype,"url",null),Object(s.a)([Object(u.b)()],v.prototype,"username",void 0),Object(s.a)([Object(u.b)()],v.prototype,"userType",void 0);var m=v=f=Object(s.a)([Object(d.a)("esri.portal.PortalUser")],v);t.default=m},function(e,t,r){"use strict";var n,i=r(2),a=r(5),o=r(6),s=r(7),c=r(0),l=r(1),u=(r(17),r(18),r(15),r(10)),d=r(394),h=r(27),f=n=function(e){Object(o.a)(r,e);var t=Object(s.a)(r);function r(e){var n;return Object(i.a)(this,r),(n=t.call(this,e)).linkURL=null,n.sourceURL=null,n}return Object(a.a)(r,[{key:"clone",value:function(){return new n({linkURL:this.linkURL,sourceURL:this.sourceURL})}}]),r}(h.a);Object(c.a)([Object(l.b)({type:String,json:{write:!0}})],f.prototype,"linkURL",void 0),Object(c.a)([Object(l.b)({type:String,json:{write:!0}})],f.prototype,"sourceURL",void 0);var p,b=f=n=Object(c.a)([Object(u.a)("esri.popup.content.support.ImageMediaInfoValue")],f),v=p=function(e){Object(o.a)(r,e);var t=Object(s.a)(r);function r(e){var n;return Object(i.a)(this,r),(n=t.call(this,e)).refreshInterval=null,n.type="image",n.value=null,n}return Object(a.a)(r,[{key:"clone",value:function(){return new p({altText:this.altText,title:this.title,caption:this.caption,refreshInterval:this.refreshInterval,value:this.value?this.value.clone():null})}}]),r}(d.a);Object(c.a)([Object(l.b)({type:Number,json:{write:!0}})],v.prototype,"refreshInterval",void 0),Object(c.a)([Object(l.b)({type:["image"],readOnly:!0,json:{read:!1,write:!0}})],v.prototype,"type",void 0),Object(c.a)([Object(l.b)({type:b,json:{write:!0}})],v.prototype,"value",void 0);var m=v=p=Object(c.a)([Object(u.a)("esri.popup.content.ImageMediaInfo")],v);t.a=m},function(e,t,r){"use strict";var n,i=r(2),a=r(5),o=r(6),s=r(7),c=r(0),l=r(27),u=r(1),d=(r(17),r(18)),h=(r(15),r(10));var f={1:{id:1,rotation:0,mirrored:!1},2:{id:2,rotation:0,mirrored:!0},3:{id:3,rotation:180,mirrored:!1},4:{id:4,rotation:180,mirrored:!0},5:{id:5,rotation:-90,mirrored:!0},6:{id:6,rotation:90,mirrored:!1},7:{id:7,rotation:90,mirrored:!0},8:{id:8,rotation:-90,mirrored:!1}},p=n=function(e){Object(o.a)(r,e);var t=Object(s.a)(r);function r(e){var n;return Object(i.a)(this,r),(n=t.call(this,e)).contentType=null,n.exifInfo=null,n.id=null,n.globalId=null,n.keywords=null,n.name=null,n.parentGlobalId=null,n.parentObjectId=null,n.size=null,n.url=null,n}return Object(a.a)(r,[{key:"orientationInfo",get:function(){var e=function(e){var t=e.exifInfo,r=e.exifName,n=e.tagName;if(!t||!r||!n)return null;var i=t.find((function(e){return e.name===r}));return i?function(e){var t=e.tagName,r=e.tags;if(!r||!t)return null;var n=r.find((function(e){return e.name===t}));return n&&n.value||null}({tagName:n,tags:i.tags}):null}({exifName:"Exif IFD0",tagName:"Orientation",exifInfo:this.exifInfo});return f[e]||null}},{key:"clone",value:function(){return new n({contentType:this.contentType,exifInfo:this.exifInfo,id:this.id,globalId:this.globalId,keywords:this.keywords,name:this.name,parentGlobalId:this.parentGlobalId,parentObjectId:this.parentObjectId,size:this.size,url:this.url})}}]),r}(l.a);Object(c.a)([Object(u.b)({type:String})],p.prototype,"contentType",void 0),Object(c.a)([Object(u.b)()],p.prototype,"exifInfo",void 0),Object(c.a)([Object(u.b)({readOnly:!0})],p.prototype,"orientationInfo",null),Object(c.a)([Object(u.b)({type:d.a})],p.prototype,"id",void 0),Object(c.a)([Object(u.b)({type:String})],p.prototype,"globalId",void 0),Object(c.a)([Object(u.b)({type:String})],p.prototype,"keywords",void 0),Object(c.a)([Object(u.b)({type:String})],p.prototype,"name",void 0),Object(c.a)([Object(u.b)({json:{read:!1}})],p.prototype,"parentGlobalId",void 0),Object(c.a)([Object(u.b)({json:{read:!1}})],p.prototype,"parentObjectId",void 0),Object(c.a)([Object(u.b)({type:d.a})],p.prototype,"size",void 0),Object(c.a)([Object(u.b)({json:{read:!1}})],p.prototype,"url",void 0);var b=p=n=Object(c.a)([Object(h.a)("esri.layers.support.AttachmentInfo")],p);t.a=b},function(e,t,r){"use strict";var n=r(13),i=r(2),a=r(5),o=r(15),s=r(3),c=[{output:0,name:"color"},{output:1,name:"depth"},{output:2,name:"normal"},{output:3,name:"depthShadowMap"},{output:4,name:"highlight"},{output:5,name:"draped"},{output:6,name:"occlusion"},{output:7,name:"alpha"}];function l(e,t){return e+"_"+c.find((function(e){return e.output===t})).name}var u=r(46),d=o.a.getLogger("esri.views.3d.webgl-engine.lib.GLMaterialRep"),h=function(){function e(t){Object(i.a)(this,e),this.refCnt=0,this.glMaterial=t}return Object(a.a)(e,[{key:"incRefCnt",value:function(){++this.refCnt}},{key:"decRefCnt",value:function(){--this.refCnt,Object(u.a)(this.refCnt>=0)}},{key:"getRefCnt",value:function(){return this.refCnt}},{key:"getGLMaterial",value:function(){return this.glMaterial}}]),e}(),f=function(){function e(t,r,n){Object(i.a)(this,e),this._textureRep=t,this._techniqueRep=r,this.onMaterialChanged=n,this._id2glMaterialRef=new Map}return Object(a.a)(e,[{key:"dispose",value:function(){this._textureRep.dispose()}},{key:"acquire",value:function(e,t){this.ownMaterial(e);var r=l(e.id,t),n=this._id2glMaterialRef.get(r);if(null==n){var i=e.getGLMaterial({material:e,techniqueRep:this._techniqueRep,textureRep:this._textureRep,output:t});return(n=new h(i)).incRefCnt(),this._id2glMaterialRef.set(r,n),i}return n.incRefCnt(),n.getGLMaterial()}},{key:"release",value:function(e,t){var r=l(e.id,t),n=this._id2glMaterialRef.get(r);if(n.decRefCnt(),0===n.getRefCnt()){var i=n.getGLMaterial();i&&i.dispose(),this._id2glMaterialRef.delete(r)}}},{key:"materialChanged",value:function(e){var t,r=Object(n.a)(c);try{for(r.s();!(t=r.n()).done;){var i=t.value;if(5!==i.output&&6!==i.output){var a=this._id2glMaterialRef.get(l(e.id,i.output));if(a&&a.getGLMaterial()){var o=a.getGLMaterial();o.updateParameters&&o.updateParameters()}}}}catch(s){r.e(s)}finally{r.f()}this.onMaterialChanged&&this.onMaterialChanged(e)}},{key:"ownMaterial",value:function(e){Object(s.j)(e.materialRepository)&&e.materialRepository!==this&&d.error("Material is already owned by a different material repository"),e.materialRepository=this}}]),e}();t.a=f},function(e,t,r){"use strict";r.r(t);var n,i=r(50),a=r(14),o=r(33),s=r(8),c=r.n(s),l=r(13),u=r(16),d=r(2),h=r(5),f=r(45),p=r(42),b=r(6),v=r(7),m=r(0),y=r(49),g=r(99),O=r(22),j=r(25),_=r(15),w=r(588),x=r(3),k=r(23),S=r(147),T=r(1),C=(r(18),r(17),r(10)),M=r(44),P=r(103),A=r(190),E=r(286),R=r(153),I=r(290),D=_.a.getLogger("esri.renderers.DictionaryRenderer"),F={type:"CIMSimpleLineCallout",lineSymbol:{type:"CIMLineSymbol",symbolLayers:[{type:"CIMSolidStroke",width:.5,color:[0,0,0,255]}]}},L=n=function(e){Object(b.a)(r,e);var t=Object(v.a)(r);function r(e){var n;return Object(d.a)(this,r),(n=t.call(this,e))._ongoingRequests=new Map,n._symbolCache=new w.a(100),n.config=null,n.fieldMap=null,n.scaleExpression=null,n.scaleExpressionTitle=null,n.url=null,n.type="dictionary",n}return Object(h.a)(r,[{key:"writeData",value:function(e,t){e&&(t.scalingExpressionInfo={expression:e,returnType:"number"})}},{key:"writeVisualVariables",value:function(e,t,n,i){null!=i&&i.origin||Object(f.a)(Object(p.a)(r.prototype),"writeVisualVariables",this).call(this,e,t,n,i)}},{key:"clone",value:function(){return new n({config:Object(j.a)(this.config),scaleExpression:this.scaleExpression,scaleExpressionTitle:this.scaleExpressionTitle,fieldMap:Object(j.a)(this.fieldMap),url:Object(j.a)(this.url),visualVariables:Object(j.a)(this.visualVariables)})}},{key:"getSymbolAsync",value:function(){var e=Object(u.a)(c.a.mark((function e(t,r){var n,i,a,o,s,u,d,h,f,p,b,v,m,g,O,j,_,w,T,C,M,P,A,E,R,I,D=this;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this._dictionaryPromise||(this._dictionaryPromise=this.fetchResources(r)),e.prev=1,e.next=4,this._dictionaryPromise;case 4:n=e.sent,e.next=11;break;case 7:if(e.prev=7,e.t0=e.catch(1),!Object(k.n)(e.t0)){e.next=11;break}return e.abrupt("return",(this._dictionaryPromise=null,null));case 11:if(i={},this.fieldMap){a=Object(l.a)(this._symbolFields);try{for(a.s();!(o=a.n()).done;)s=o.value,(u=this.fieldMap[s])&&null!==t.attributes[u]&&void 0!==t.attributes[u]?(d=""+t.attributes[u],i[s]=d):i[s]=""}catch(c){a.e(c)}finally{a.f()}}if((h=n(i,r))&&"string"==typeof h){e.next=16;break}return e.abrupt("return",null);case 16:if(f=Object(S.b)(h).toString(),!(p=this._symbolCache.get(f))){e.next=19;break}return e.abrupt("return",(p.catch((function(){D._symbolCache.pop(f)})),p));case 19:b=h.split(";"),v=[],m=[],g=Object(l.a)(b);try{for(g.s();!(O=g.n()).done;)if((j=O.value)&&0!==j.length)if(-1===j.indexOf("po:"))if(-1!==j.indexOf("|")){_=Object(l.a)(j.split("|"));try{for(_.s();!(w=_.n()).done;)T=w.value,this._itemNames.has(T)&&v.push(T)}catch(c){_.e(c)}finally{_.f()}}else this._itemNames.has(j)&&v.push(j);else 3===(C=j.substr(3).split("|")).length&&(M=C[0],P=C[1],A=C[2],"DashTemplate"===P?A=A.split(" ").map((function(e){return Number(e)})):"Color"===P?(E=new y.a(A).toRgba(),A=[E[0],E[1],E[2],255*E[3]]):A=Number(A),m.push({primitiveName:M,propertyName:P,value:A}))}catch(c){g.e(c)}finally{g.f()}return R=!Object(x.j)(t.geometry)||!t.geometry.hasZ&&"point"===t.geometry.type,I=this._cimPartsToCIMSymbol(v,m,R,r),e.abrupt("return",(this._symbolCache.put(f,I,1),I));case 24:case"end":return e.stop()}}),e,this,[[1,7]])})));return function(t,r){return e.apply(this,arguments)}}()},{key:"collectRequiredFields",value:function(){var e=Object(u.a)(c.a.mark((function e(t,r){var n,i;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.collectVVRequiredFields(t,r);case 2:if(e.t0=this.scaleExpression,!e.t0){e.next=6;break}return e.next=6,Object(P.a)(t,r,this.scaleExpression);case 6:for(n in this.fieldMap)i=this.fieldMap[n],r.has(i)&&t.add(i);case 7:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"arcadeRequired",get:function(){return!0}},{key:"fetchResources",value:function(){var e=Object(u.a)(c.a.mark((function e(t){var r,n,i,s,u,d,h,f,p,b,v,m,y,j,_,w,k,S=this;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._dictionaryPromise){e.next=2;break}return e.abrupt("return",this._dictionaryPromise);case 2:if(this.url){e.next=4;break}return e.abrupt("return",void D.error("no valid URL!"));case 4:return r=Object(x.j)(t)?t.abortOptions:null,n=Object(g.default)(this.url+"/resources/styles/dictionary-info.json",Object(a.a)({responseType:"json",query:{f:"json"}},r)),e.next=8,Promise.all([n,Object(R.e)()]);case 8:if(i=e.sent,s=Object(o.a)(i,1),u=s[0].data){e.next=13;break}throw this._dictionaryPromise=null,new O.a("esri.renderers.DictionaryRenderer","Bad dictionary data!");case 13:if(d=u.expression,h=u.authoringInfo,this._refSymbolUrlTemplate=this.url+"/"+u.cimRefTemplateUrl,this._itemNames=new Set(u.itemsNames),this._symbolFields=h.symbol,f={},this.config)for(b in p=this.config)f[b]=p[b];if(h.configuration){v=Object(l.a)(h.configuration);try{for(v.s();!(m=v.n()).done;)y=m.value,f.hasOwnProperty(y.name)||(f[y.name]=y.value)}catch(c){v.e(c)}finally{v.f()}}if(j=[],Object(x.j)(t)&&t.fields&&this.fieldMap){_=Object(l.a)(this._symbolFields);try{for(k=function(){var e=w.value,r=S.fieldMap[e],n=t.fields.filter((function(e){return e.name===r}));n.length>0&&j.push(Object(a.a)(Object(a.a)({},n[0]),{},{name:e}))},_.s();!(w=_.n()).done;)k()}catch(c){_.e(c)}finally{_.f()}}return e.abrupt("return",(this._dictionaryPromise=Object(R.b)(d,Object(x.j)(t)?t.spatialReference:null,j,f).then((function(e){var t={scale:0};return function(r,n){var i=e.repurposeFeature({geometry:null,attributes:r});return t.scale=Object(x.j)(n)?n.scale:void 0,e.evaluate({$feature:i,$view:t})}})).catch((function(e){return D.error("Creating dictinoary expression failed:",e),null})),this._dictionaryPromise));case 21:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getSymbol",value:function(){return null}},{key:"getSymbols",value:function(){return[]}},{key:"getAttributeHash",value:function(){return this.visualVariables&&this.visualVariables.reduce((function(e,t){return e+t.getAttributeHash()}),"")}},{key:"getMeshHash",value:function(){return"".concat(this.url,"-").concat(JSON.stringify(this.fieldMap))}},{key:"getSymbolFields",value:function(){return this._symbolFields}},{key:"_getSymbolPart",value:function(){var e=Object(u.a)(c.a.mark((function e(t,r){var n,i;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._ongoingRequests.has(t)){e.next=2;break}return e.abrupt("return",this._ongoingRequests.get(t).then((function(e){return e.data})));case 2:return n=this._refSymbolUrlTemplate.replace(/\{itemName\}/gi,t),i=Object(g.default)(n,Object(a.a)({responseType:"json",query:{f:"json"}},r)),this._ongoingRequests.set(t,i),e.prev=4,e.next=7,i;case 7:return e.abrupt("return",e.sent.data);case 10:return e.prev=10,e.t0=e.catch(4),e.abrupt("return",(this._ongoingRequests.delete(t),Promise.reject(e.t0)));case 13:case"end":return e.stop()}}),e,this,[[4,10]])})));return function(t,r){return e.apply(this,arguments)}}()},{key:"_combineSymbolParts",value:function(e,t,r){if(!e||0===e.length)return null;var n=Object(a.a)({},e[0]);if(e.length>1){n.symbolLayers=[];var o,s=Object(l.a)(e);try{for(s.s();!(o=s.n()).done;){var c,u=o.value;(c=n.symbolLayers).unshift.apply(c,Object(i.a)(u.symbolLayers))}}catch(d){s.e(d)}finally{s.f()}}return r&&(n.callout=F),{type:"CIMSymbolReference",symbol:n,primitiveOverrides:t}}},{key:"_cimPartsToCIMSymbol",value:function(){var e=Object(u.a)(c.a.mark((function e(t,r,n,i){var a,o,s;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(a=new Array(t.length),o=0;o<t.length;o++)a[o]=this._getSymbolPart(t[o],i);return e.next=4,Promise.all(a);case 4:return s=e.sent,e.abrupt("return",new I.a({data:this._combineSymbolParts(s,r,n)}));case 6:case"end":return e.stop()}}),e,this)})));return function(t,r,n,i){return e.apply(this,arguments)}}()}]),r}(Object(E.a)(A.a));Object(m.a)([Object(T.b)({type:Object,json:{read:{source:"configuration"},write:{target:"configuration"}}})],L.prototype,"config",void 0),Object(m.a)([Object(T.b)({type:Object,json:{write:!0}})],L.prototype,"fieldMap",void 0),Object(m.a)([Object(T.b)({type:String,json:{read:{source:"scalingExpressionInfo.expression"},write:!0}})],L.prototype,"scaleExpression",void 0),Object(m.a)([Object(M.a)("scaleExpression")],L.prototype,"writeData",null),Object(m.a)([Object(T.b)({type:String,json:{read:{source:"scalingExpressionInfo.title"},write:{target:"scalingExpressionInfo.title",overridePolicy:function(e){return{enabled:!!e&&!!this.scaleExpression}}}}})],L.prototype,"scaleExpressionTitle",void 0),Object(m.a)([Object(T.b)({type:String,json:{write:!0}})],L.prototype,"url",void 0),Object(m.a)([Object(M.a)("visualVariables")],L.prototype,"writeVisualVariables",null);var z=L=n=Object(m.a)([Object(C.a)("esri.renderers.DictionaryRenderer")],L);t.default=z},function(e,t,r){"use strict";var n,i=r(13),a=r(8),o=r.n(a),s=r(16),c=r(2),l=r(5),u=r(6),d=r(7),h=r(0),f=r(49),p=r(25),b=r(62),v=r(18),m=(r(17),r(15)),y=r(52),g=r(1),O=r(10),j=r(103),_=r(190),w=r(286),x=r(27),k=r(64),S=m.a.getLogger("esri.renderers.support.AttributeColorInfo"),T=n=function(e){Object(u.a)(r,e);var t=Object(d.a)(r);function r(e){var n;return Object(c.a)(this,r),(n=t.call(this,e)).color=null,n.field=null,n.label=null,n.valueExpression=null,n.valueExpressionTitle=null,n}return Object(l.a)(r,[{key:"castField",value:function(e){return null==e?e:"function"==typeof e?(S.error(".field: field must be a string value"),null):Object(v.l)(e)}},{key:"getAttributeHash",value:function(){return"".concat(this.field,"-").concat(this.valueExpression)}},{key:"clone",value:function(){return new n({color:this.color&&this.color.clone(),field:this.field,label:this.label,valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle})}}]),r}(x.a);Object(h.a)([Object(g.b)({type:f.a,json:{type:[Number],write:!0}})],T.prototype,"color",void 0),Object(h.a)([Object(g.b)({type:String,json:{write:!0}})],T.prototype,"field",void 0),Object(h.a)([Object(k.a)("field")],T.prototype,"castField",null),Object(h.a)([Object(g.b)({type:String,json:{write:!0}})],T.prototype,"label",void 0),Object(h.a)([Object(g.b)({type:String,json:{write:!0}})],T.prototype,"valueExpression",void 0),Object(h.a)([Object(g.b)({type:String,json:{write:!0}})],T.prototype,"valueExpressionTitle",void 0);var C,M=T=n=Object(h.a)([Object(O.a)("esri.renderers.support.AttributeColorInfo")],T),P=C=function(e){Object(u.a)(r,e);var t=Object(d.a)(r);function r(){var e;return Object(c.a)(this,r),(e=t.apply(this,arguments)).unit=null,e}return Object(l.a)(r,[{key:"clone",value:function(){return new C({unit:this.unit})}}]),r}(x.a);Object(h.a)([Object(g.b)({type:String,json:{write:!0}})],P.prototype,"unit",void 0);var A,E=P=C=Object(h.a)([Object(O.a)("esri.renderers.support.DotDensityLegendOptions")],P),R=r(222),I=r(166),D=A=function(e){Object(u.a)(r,e);var t=Object(d.a)(r);function r(e){var n;return Object(c.a)(this,r),(n=t.call(this,e)).attributes=null,n.backgroundColor=new f.a([0,0,0,0]),n.blendDots=!0,n.dotBlendingEnabled=!0,n.dotShape="square",n.dotSize=1,n.legendOptions=null,n.outline=new I.a,n.dotValue=null,n.referenceDotValue=null,n.referenceScale=null,n.seed=1,n.type="dot-density",n}return Object(l.a)(r,[{key:"calculateDotValue",value:function(e){if(null==this.referenceScale)return this.dotValue;var t=e/this.referenceScale*this.dotValue;return t<1?1:t}},{key:"getSymbol",value:function(){return new R.a({outline:this.outline})}},{key:"getSymbolAsync",value:function(){var e=Object(s.a)(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.getSymbol());case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getSymbols",value:function(){return[this.getSymbol()]}},{key:"getAttributeHash",value:function(){return this.attributes&&this.attributes.reduce((function(e,t){return e+t.getAttributeHash()}),"")}},{key:"getMeshHash",value:function(){return JSON.stringify(this.outline)}},{key:"clone",value:function(){return new A({attributes:Object(p.a)(this.attributes),backgroundColor:Object(p.a)(this.backgroundColor),dotBlendingEnabled:Object(p.a)(this.dotBlendingEnabled),dotShape:Object(p.a)(this.dotShape),dotSize:Object(p.a)(this.dotSize),dotValue:Object(p.a)(this.dotValue),legendOptions:Object(p.a)(this.legendOptions),outline:Object(p.a)(this.outline),referenceScale:Object(p.a)(this.referenceScale),visualVariables:Object(p.a)(this.visualVariables),authoringInfo:this.authoringInfo&&this.authoringInfo.clone()})}},{key:"getControllerHash",value:function(){return"".concat(this.attributes.map((function(e){return e.field||e.valueExpression||""})),"-").concat(this.outline&&JSON.stringify(this.outline.toJSON())||"")}},{key:"collectRequiredFields",value:function(){var e=Object(s.a)(o.a.mark((function e(t,r){var n,a,s;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.collectVVRequiredFields(t,r);case 2:n=Object(i.a)(this.attributes),e.prev=3,n.s();case 5:if((a=n.n()).done){e.next=14;break}if(s=a.value,e.t0=s.valueExpression,!e.t0){e.next=11;break}return e.next=11,Object(j.a)(t,r,s.valueExpression);case 11:s.field&&t.add(s.field);case 12:e.next=5;break;case 14:e.next=19;break;case 16:e.prev=16,e.t1=e.catch(3),n.e(e.t1);case 19:return e.prev=19,n.f(),e.finish(19);case 22:case"end":return e.stop()}}),e,this,[[3,16,19,22]])})));return function(t,r){return e.apply(this,arguments)}}()}]),r}(Object(w.a)(_.a));Object(h.a)([Object(g.b)({type:[M],json:{write:!0}})],D.prototype,"attributes",void 0),Object(h.a)([Object(g.b)({type:f.a,json:{write:!0}})],D.prototype,"backgroundColor",void 0),Object(h.a)([Object(g.b)({type:Boolean}),Object(b.a)("dotBlendingEnabled")],D.prototype,"blendDots",void 0),Object(h.a)([Object(g.b)({type:Boolean,json:{write:!0}})],D.prototype,"dotBlendingEnabled",void 0),Object(h.a)([Object(g.b)({type:String,json:{write:!1}})],D.prototype,"dotShape",void 0),Object(h.a)([Object(g.b)({type:Number,json:{write:!1}})],D.prototype,"dotSize",void 0),Object(h.a)([Object(g.b)({type:E,json:{write:!0}})],D.prototype,"legendOptions",void 0),Object(h.a)([Object(g.b)({type:I.a,json:{default:null,write:!0}})],D.prototype,"outline",void 0),Object(h.a)([Object(g.b)({type:Number,json:{write:!0}})],D.prototype,"dotValue",void 0),Object(h.a)([Object(g.b)({type:Number}),Object(b.a)("dotValue")],D.prototype,"referenceDotValue",void 0),Object(h.a)([Object(g.b)({type:Number,json:{write:!0}})],D.prototype,"referenceScale",void 0),Object(h.a)([Object(g.b)({type:Number,json:{write:!0}})],D.prototype,"seed",void 0),Object(h.a)([Object(y.a)({dotDensity:"dot-density"})],D.prototype,"type",void 0);var F=D=A=Object(h.a)([Object(O.a)("esri.renderers.DotDensityRenderer")],D);t.a=F},function(e,t,r){"use strict";var n,i=r(8),a=r.n(i),o=r(16),s=r(2),c=r(5),l=r(6),u=r(7),d=r(0),h=r(49),f=r(25),p=r(1),b=(r(18),r(17),r(15),r(52)),v=r(10),m=r(103),y=r(190),g=r(27),O=n=function(e){Object(l.a)(r,e);var t=Object(u.a)(r);function r(e){var n;return Object(s.a)(this,r),(n=t.call(this,e)).color=null,n.ratio=null,n}return Object(c.a)(r,[{key:"clone",value:function(){return new n({color:this.color,ratio:this.ratio})}}]),r}(g.a);Object(d.a)([Object(p.b)({type:h.a,json:{write:!0}})],O.prototype,"color",void 0),Object(d.a)([Object(p.b)({type:Number,json:{write:!0}})],O.prototype,"ratio",void 0);var j,_=O=n=Object(d.a)([Object(v.a)("esri.renderers.support.HeatmapColorStop")],O),w=j=function(e){Object(l.a)(r,e);var t=Object(u.a)(r);function r(e){var n;return Object(s.a)(this,r),(n=t.call(this,e)).blurRadius=10,n.colorStops=[new _({ratio:0,color:new h.a("rgba(255, 140, 0, 0)")}),new _({ratio:.75,color:new h.a("rgba(255, 140, 0, 1)")}),new _({ratio:.9,color:new h.a("rgba(255, 0,   0, 1)")})],n.field=null,n.fieldOffset=0,n.maxPixelIntensity=100,n.minPixelIntensity=0,n.type="heatmap",n}return Object(c.a)(r,[{key:"collectRequiredFields",value:function(){var e=Object(o.a)(a.a.mark((function e(t,r){var n;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(n=this.field)&&"string"==typeof n&&Object(m.d)(t,r,n);case 2:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"getAttributeHash",value:function(){return null}},{key:"getMeshHash",value:function(){return"".concat(JSON.stringify(this.colorStops),".").concat(this.blurRadius,".").concat(this.field)}},{key:"clone",value:function(){return new j({blurRadius:this.blurRadius,colorStops:Object(f.a)(this.colorStops),field:this.field,maxPixelIntensity:this.maxPixelIntensity,minPixelIntensity:this.minPixelIntensity})}}]),r}(y.a);Object(d.a)([Object(p.b)({type:Number,json:{write:!0}})],w.prototype,"blurRadius",void 0),Object(d.a)([Object(p.b)({type:[_],json:{write:!0}})],w.prototype,"colorStops",void 0),Object(d.a)([Object(p.b)({type:String,json:{write:!0}})],w.prototype,"field",void 0),Object(d.a)([Object(p.b)({type:Number,json:{write:{overridePolicy:function(e,t,r){return{enabled:null==r}}}}})],w.prototype,"fieldOffset",void 0),Object(d.a)([Object(p.b)({type:Number,json:{write:!0}})],w.prototype,"maxPixelIntensity",void 0),Object(d.a)([Object(p.b)({type:Number,json:{write:!0}})],w.prototype,"minPixelIntensity",void 0),Object(d.a)([Object(b.a)({heatmap:"heatmap"})],w.prototype,"type",void 0);var x=w=j=Object(d.a)([Object(v.a)("esri.renderers.HeatmapRenderer")],w);t.a=x},function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var n=r(373),i=/\[([^\[\]]+)\]/gi;function a(e,t,r){var a=this;return e?e.map((function(e){var o=new n.a;if(o.read(e,r),o.labelExpression){var s=t.fields||t.layerDefinition&&t.layerDefinition.fields||a.fields;o.labelExpression=o.labelExpression.replace(i,(function(e,t){return"[".concat(function(e,t){if(!t)return e;for(var r=e.toLowerCase(),n=0;n<t.length;n++){var i=t[n].name;if(i.toLowerCase()===r)return i}return e}(t,s),"]")}))}return o})):null}},function(e,t,r){"use strict";r.d(t,"a",(function(){return n})),r.d(t,"b",(function(){return i}));var n=function(){var e=new Array;return e[0]=10,e[1]=10,e[2]=10,e[3]=10,e[4]=5,e}(),i=30},function(e,t,r){"use strict";r.d(t,"a",(function(){return i})),r.d(t,"b",(function(){return n})),r.d(t,"c",(function(){return a}));var n=!0,i=32,a=200},function(e,t,r){"use strict";r.d(t,"a",(function(){return s})),r.d(t,"b",(function(){return o}));var n=r(428),i=r(395),a=r(561),o={key:"type",base:i.a,typeMap:{algorithmic:n.a,multipart:a.a}};function s(e){return e&&e.type?"algorithmic"===e.type?n.a.fromJSON(e):"multipart"===e.type?a.a.fromJSON(e):null:null}},function(e,t,r){"use strict";var n=r(2),i=r(5),a=r(6),o=r(7),s=r(0),c=r(27),l=r(25),u=r(1),d=(r(18),r(17),r(15),r(48)),h=r(10),f=r(44),p=(r(249),r(436)),b=r(348),v=r(345),m=r(349),y=function(e){Object(a.a)(r,e);var t=Object(o.a)(r);function r(e){var i;return Object(n.a)(this,r),(i=t.call(this,e)).id=null,i.name=null,i.domains=null,i.templates=null,i}return Object(i.a)(r,[{key:"readDomains",value:function(e){var t={};for(var r in e)if(e.hasOwnProperty(r)){var n=e[r];switch(n.type){case"range":t[r]=m.a.fromJSON(n);break;case"codedValue":t[r]=v.a.fromJSON(n);break;case"inherited":t[r]=b.a.fromJSON(n)}}return t}},{key:"writeDomains",value:function(e,t){var r={};for(var n in e)e.hasOwnProperty(n)&&(r[n]=e[n]&&e[n].toJSON());Object(l.c)(r),t.domains=r}},{key:"readTemplates",value:function(e){return e&&e.map((function(e){return new p.a(e)}))}},{key:"writeTemplates",value:function(e,t){t.templates=e&&e.map((function(e){return e.toJSON()}))}}]),r}(c.a);Object(s.a)([Object(u.b)({json:{write:!0}})],y.prototype,"id",void 0),Object(s.a)([Object(u.b)({json:{write:!0}})],y.prototype,"name",void 0),Object(s.a)([Object(u.b)({json:{write:!0}})],y.prototype,"domains",void 0),Object(s.a)([Object(d.a)("domains")],y.prototype,"readDomains",null),Object(s.a)([Object(f.a)("domains")],y.prototype,"writeDomains",null),Object(s.a)([Object(u.b)({json:{write:!0}})],y.prototype,"templates",void 0),Object(s.a)([Object(d.a)("templates")],y.prototype,"readTemplates",null),Object(s.a)([Object(f.a)("templates")],y.prototype,"writeTemplates",null);var g=y=Object(s.a)([Object(h.a)("esri.layers.support.FeatureType")],y);t.a=g},function(e,t,r){"use strict";r.d(t,"a",(function(){return p})),r.d(t,"b",(function(){return x})),r.d(t,"c",(function(){return _}));var n,i,a,o,s,c,l,u,d,h,f,p,b=r(12),v=r(76),m=r(376),y=r(318),g=r(324),O=r(11),j=r(87);function _(e){var t=new j.a;return t.include(m.a),t.include(y.a,e),t.include(v.a,e),t.attributes.add("uv0","vec2"),t.vertex.uniforms.add("lineSize","float").add("pixelToNDC","vec2").add("borderSize","float").add("screenOffset","vec2"),t.varyings.add("coverageSampling","vec4"),t.varyings.add("lineSizes","vec2"),e.multipassGeometryEnabled&&t.varyings.add("depth","float"),t.vertex.code.add(Object(O.a)(n||(n=Object(b.a)(["\n    void main(void) {\n      ProjectHUDAux projectAux;\n      vec4 endPoint = projectPositionHUD(projectAux);\n\n      vec3 vpos = projectAux.posModel;\n      if (rejectBySlice(vpos)) {\n        gl_Position = vec4(1e38, 1e38, 1e38, 1.0);\n        return;\n      }\n    ","\n\n    ","\n      // Add view dependent polygon offset to get exact same original starting point. This is mostly\n      // used to get the correct depth value\n      vec3 posView = (view * vec4(position, 1.0)).xyz;\n      ","\n\n      applyHUDViewDependentPolygonOffset(auxpos1.w, projectAux.absCosAngle, posView);\n      vec4 startPoint = proj * vec4(posView, 1.0);\n      // Apply screen offset to both start and end point\n      vec2 screenOffsetNorm = screenOffsetScaled * 2.0 / viewport.zw;\n      startPoint.xy += screenOffsetNorm * startPoint.w;\n      endPoint.xy += screenOffsetNorm * endPoint.w;\n      // Align start and end to pixel origin\n      vec4 startAligned = alignToPixelOrigin(startPoint, viewport.zw);\n      vec4 endAligned = alignToPixelOrigin(endPoint, viewport.zw);\n    ","\n      vec4 projectedPosition = mix(startAligned, endAligned, uv0.y);\n      // The direction of the line in screen space\n      vec2 screenSpaceDirection = normalize(endAligned.xy / endAligned.w - startAligned.xy / startAligned.w);\n      vec2 perpendicularScreenSpaceDirection = vec2(screenSpaceDirection.y, -screenSpaceDirection.x);\n    ","\n      float halfPixelSize = lineSizeScaled * 0.5;\n      // Calculate a pixel offset from the edge of the pixel, s.t. we keep the line aligned\n      // to pixels if it has a full pixel size. Since pixel aligned biases to the bottom-left,\n      // we bias the size to the right (for odd sizes) to balance out the bias. Grow sub-pixel\n      // sizes towards the left or right s.t. there is a smooth transition (e.g. from 2 to 3 px).\n      float halfWholePixelSize = floor(lineSizeScaled) * 0.5;\n      float halfPixelSizeInt = floor(halfWholePixelSize);\n\n      // Sub-pixel offset if we need to grow sub-pixels to the left\n      float subpixelOffset = -fract(lineSizeScaled) * float(halfWholePixelSize > 0.0);\n\n      // Pixel offset aligning to whole pixels and adding subpixel offset if needed\n      float pixelOffset = -halfPixelSizeInt + subpixelOffset;\n\n      // Compute full ndc offset, adding 1px padding for doing anti-aliasing and the border size\n      float padding = 1.0 + borderSizeScaled;\n      vec2 ndcOffset = (pixelOffset - padding + uv0.x * (lineSizeScaled + padding + padding)) * pixelToNDC;\n\n      // Offset x/y from the center of the line in screen space\n      projectedPosition.xy += perpendicularScreenSpaceDirection * ndcOffset * projectedPosition.w;\n\n      // Compute a coverage varying which we can use in the fragment shader to determine\n      // how much a pixel is actually covered by the line (i.e. to anti alias the line).\n      // This works by computing two coordinates that can be linearly interpolated and then\n      // subtracted to find out how far away from the line edge we are.\n      float edgeDirection = (uv0.x * 2.0 - 1.0);\n\n      float halfBorderSize = 0.5 * borderSizeScaled;\n      float halfPixelSizeAndBorder = halfPixelSize + halfBorderSize;\n      float outerEdgeCoverageSampler = edgeDirection * (halfPixelSizeAndBorder + halfBorderSize + 1.0);\n\n      float isOneSided = float(lineSizeScaled < 2.0 && borderSize < 2.0);\n\n      coverageSampling = vec4(\n        // Edge coordinate\n        outerEdgeCoverageSampler,\n\n        // Border edge coordinate\n        outerEdgeCoverageSampler - halfPixelSizeAndBorder * isOneSided,\n\n        // Line offset\n        halfPixelSize - 0.5,\n\n        // Border offset\n        halfBorderSize - 0.5 + halfPixelSizeAndBorder * (1.0 - isOneSided)\n      );\n\n      lineSizes = vec2(lineSizeScaled, borderSizeScaled);\n\n      gl_Position = projectedPosition;\n    }\n  "])),e.occlusionTestEnabled?Object(O.a)(i||(i=Object(b.a)(["\n      if (!testVisibilityHUD(endPoint)) {\n        gl_Position = vec4(1e38, 1e38, 1e38, 1.0);\n        return;\n      }"]))):"",e.screenSizePerspectiveEnabled?Object(O.a)(a||(a=Object(b.a)(["\n      vec4 perspectiveFactor = screenSizePerspectiveScaleFactor(projectAux.absCosAngle, projectAux.distanceToCamera, screenSizePerspectiveAlignment);\n      vec2 screenOffsetScaled = applyScreenSizePerspectiveScaleFactorVec2(screenOffset, perspectiveFactor);\n        "]))):Object(O.a)(o||(o=Object(b.a)(["\n      vec2 screenOffsetScaled = screenOffset;\n        "]))),e.multipassGeometryEnabled?"depth = posView.z;":"",e.depthHudEnabled?e.depthHudAlignStartEnabled?Object(O.a)(s||(s=Object(b.a)(["endAligned = vec4(endAligned.xy / endAligned.w * startAligned.w, startAligned.zw);"]))):Object(O.a)(c||(c=Object(b.a)(["startAligned = vec4(startAligned.xy / startAligned.w * endAligned.w, endAligned.zw);"]))):"",e.screenSizePerspectiveEnabled?Object(O.a)(l||(l=Object(b.a)(["\n      float lineSizeScaled = applyScreenSizePerspectiveScaleFactorFloat(lineSize, perspectiveFactor);\n      float borderSizeScaled = applyScreenSizePerspectiveScaleFactorFloat(borderSize, perspectiveFactor);\n        "]))):Object(O.a)(u||(u=Object(b.a)(["\n      float lineSizeScaled = lineSize;\n      float borderSizeScaled = borderSize;\n        "]))))),t.fragment.uniforms.add("color","vec4"),t.fragment.uniforms.add("borderColor","vec4"),e.multipassGeometryEnabled&&(t.fragment.include(g.b,e),t.fragment.uniforms.add("inverseViewport","vec2")),t.fragment.code.add(Object(O.a)(d||(d=Object(b.a)(["\n    void main() {\n      ","\n\n      // Mix between line and border coverage offsets depending on whether we need\n      // a border (based on the sidedness).\n      vec2 coverage = min(1.0 - clamp(abs(coverageSampling.xy) - coverageSampling.zw, 0.0, 1.0), lineSizes);\n\n      // Mix between border and line color based on the line coverage (conceptually the line\n      // blends on top of the border background).\n      //\n      // Anti-alias by blending final result using the full (including optional border) coverage\n      // and the color alpha\n      float borderAlpha = color.a * borderColor.a * coverage.y;\n      float colorAlpha = color.a * coverage.x;\n\n      float finalAlpha = mix(borderAlpha, 1.0, colorAlpha);\n\n    ","\n  }\n  "])),e.multipassGeometryEnabled?"if( geometryDepthTest(gl_FragCoord.xy * inverseViewport, depth) ){ discard; }":"",e.depthHudEnabled?Object(O.a)(h||(h=Object(b.a)(["\n      if (finalAlpha < 0.01) {\n        discard;\n      }\n      "]))):Object(O.a)(f||(f=Object(b.a)(["\n      // Compute the finalRgb, but keep it pre-multiplied (for unpre-multiplied you\n      // need to divide by finalAlpha). We avoid the division here by setting the\n      // appropriate blending function in the material.\n      vec3 finalRgb = mix(borderColor.rgb * borderAlpha, color.rgb, colorAlpha);\n      gl_FragColor = vec4(finalRgb, finalAlpha);\n      "]))))),t}function w(e,t,r){3===r.length?e.setUniform4f(t,r[0],r[1],r[2],1):e.setUniform4fv(t,r)}(p||(p={})).bindUniforms=function(e,t,r){w(e,"color",t.color),e.setUniform1f("pixelRatio",r),e.setUniform2f("screenOffset",t.screenOffset[0]*r,t.screenOffset[1]*r),null!==t.borderColor?(w(e,"borderColor",t.borderColor),e.setUniform1f("borderSize",r)):(e.setUniform4f("borderColor",0,0,0,0),e.setUniform1f("borderSize",0))};var x=Object.freeze({__proto__:null,build:_,get LineCallout(){return p}})},function(e,t,r){"use strict";function n(){var e=new Float32Array(4);return e[3]=1,e}function i(e){var t=new Float32Array(4);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t}function a(e,t){return new Float32Array(e,t,4)}r.d(t,"a",(function(){return i})),r.d(t,"b",(function(){return n})),r.d(t,"c",(function(){return a}));Object.freeze({__proto__:null,create:n,clone:i,fromValues:function(e,t,r,n){var i=new Float32Array(4);return i[0]=e,i[1]=t,i[2]=r,i[3]=n,i},createView:a})},function(e,t,r){"use strict";r.d(t,"a",(function(){return M}));var n=r(14),i=r(2),a=r(5),o=r(6),s=r(7),c=r(195),l=r(116),u=r(89),d=r(246),h=r(102),f=r(0),p=r(76),b=r(109),v=r(112),m=r(106),y=r(91),g=r(95),O=r(24),j=r(77),_=r(88),w=r(111),x=r(621),k=r(41),S=function(e){Object(o.a)(r,e);var t=Object(s.a)(r);function r(){return Object(i.a)(this,r),t.apply(this,arguments)}return Object(a.a)(r,[{key:"initializeProgram",value:function(e){var t=r.shader.get(),n=this.configuration,i=t.build({output:n.output,OITEnabled:0===n.transparencyPassType,attributeColor:n.vertexColors,slicePlaneEnabled:n.slicePlaneEnabled,sliceHighlightDisabled:!1,sliceEnabledForVertexPrograms:!1,multipassTerrainEnabled:n.multipassTerrainEnabled,cullAboveGround:n.cullAboveGround});return new _.a(e.rctx,i,j.a)}},{key:"bindPass",value:function(e,t){Object(m.c)(this.program,t.camera.projectionMatrix),this.program.setUniform4fv("eColor",e.color),4===this.configuration.output&&Object(b.b)(this.program,t),(1===this.configuration.output||t.multipassTerrainEnabled)&&this.program.setUniform2fv("cameraNearFar",t.camera.nearFar),t.multipassTerrainEnabled&&(this.program.setUniform2fv("inverseViewport",t.inverseViewport),Object(v.a)(this.program,t))}},{key:"bindDraw",value:function(e){Object(m.d)(this.program,e),this.program.rebindTextures(),Object(p.c)(this.program,this.configuration,e)}},{key:"setPipelineState",value:function(e,t){var r=this.configuration,n=3===e,i=2===e;return Object(k.g)({blending:0!==r.output&&7!==r.output||!r.transparent?null:n?u.f:Object(u.a)(e),culling:Object(k.c)(r.cullFace),depthTest:{func:Object(u.b)(e)},depthWrite:n||i?r.writeDepth&&k.e:null,colorWrite:k.d,stencilWrite:r.sceneHasOcludees?w.j:null,stencilTest:r.sceneHasOcludees?t?w.f:w.e:null,polygonOffset:n||i?r.polygonOffset&&T:Object(u.g)(r.enableOffset)})}},{key:"initializePipeline",value:function(){return this._occludeePipelineState=this.setPipelineState(this.configuration.transparencyPassType,!0),this.setPipelineState(this.configuration.transparencyPassType,!1)}},{key:"getPipelineState",value:function(e){return e?this._occludeePipelineState:this.pipeline}}]),r}(g.a);S.shader=new y.a(x.a,(function(){return r.e(195).then(r.bind(null,1068))}));var T={factor:1,units:1},C=function(e){Object(o.a)(r,e);var t=Object(s.a)(r);function r(){var e;return Object(i.a)(this,r),(e=t.apply(this,arguments)).output=0,e.cullFace=0,e.slicePlaneEnabled=!1,e.vertexColors=!1,e.transparent=!1,e.polygonOffset=!1,e.enableOffset=!0,e.writeDepth=!0,e.sceneHasOcludees=!1,e.transparencyPassType=3,e.multipassTerrainEnabled=!1,e.cullAboveGround=!1,e}return r}(O.a);Object(f.a)([Object(O.b)({count:8})],C.prototype,"output",void 0),Object(f.a)([Object(O.b)({count:3})],C.prototype,"cullFace",void 0),Object(f.a)([Object(O.b)()],C.prototype,"slicePlaneEnabled",void 0),Object(f.a)([Object(O.b)()],C.prototype,"vertexColors",void 0),Object(f.a)([Object(O.b)()],C.prototype,"transparent",void 0),Object(f.a)([Object(O.b)()],C.prototype,"polygonOffset",void 0),Object(f.a)([Object(O.b)()],C.prototype,"enableOffset",void 0),Object(f.a)([Object(O.b)()],C.prototype,"writeDepth",void 0),Object(f.a)([Object(O.b)()],C.prototype,"sceneHasOcludees",void 0),Object(f.a)([Object(O.b)({count:4})],C.prototype,"transparencyPassType",void 0),Object(f.a)([Object(O.b)()],C.prototype,"multipassTerrainEnabled",void 0),Object(f.a)([Object(O.b)()],C.prototype,"cullAboveGround",void 0);var M=function(e){Object(o.a)(r,e);var t=Object(s.a)(r);function r(e){var n;return Object(i.a)(this,r),(n=t.call(this,e,A)).supportsEdges=!0,n.techniqueConfig=new C,n}return Object(a.a)(r,[{key:"getTechniqueConfig",value:function(e,t){return this.techniqueConfig.output=e,this.techniqueConfig.cullFace=this.params.cullFace,this.techniqueConfig.vertexColors=this.params.vertexColors,this.techniqueConfig.slicePlaneEnabled=this.params.slicePlaneEnabled,this.techniqueConfig.transparent=this.params.transparent,this.techniqueConfig.polygonOffset=this.params.polygonOffset,this.techniqueConfig.writeDepth=this.params.writeDepth,this.techniqueConfig.sceneHasOcludees=this.params.sceneHasOcludees,this.techniqueConfig.transparencyPassType=t?t.transparencyPassType:3,this.techniqueConfig.enableOffset=!t||t.camera.relativeElevation<u.e,this.techniqueConfig.multipassTerrainEnabled=!!t&&t.multipassTerrainEnabled,this.techniqueConfig.cullAboveGround=!!t&&t.cullAboveGround,this.techniqueConfig}},{key:"getPassParameters",value:function(){return this.params}},{key:"intersect",value:function(e,t,r,n,i,a,o){Object(h.i)(e,t,n,i,a,void 0,o)}},{key:"getGLMaterial",value:function(e){return 0===e.output||7===e.output||4===e.output||1===e.output&&this.params.writeLinearDepth?new P(e):void 0}},{key:"createBufferWriter",value:function(){return new d.a(d.b)}}]),r}(l.a),P=function(e){Object(o.a)(r,e);var t=Object(s.a)(r);function r(e){var n;return Object(i.a)(this,r),(n=t.call(this,e)).updateParameters(),n}return Object(a.a)(r,[{key:"updateParameters",value:function(e){this._technique=this._techniqueRep.releaseAndAcquire(S,this._material.getTechniqueConfig(this._output,e),this._technique)}},{key:"beginSlot",value:function(e){return 4===this._output?3===e:e===(this._technique.configuration.transparent?this._technique.configuration.writeDepth?5:8:3)}},{key:"_updateOccludeeState",value:function(e){e.hasOccludees!==this._material.params.sceneHasOcludees&&this._material.setParameterValues({sceneHasOcludees:e.hasOccludees})}},{key:"ensureParameters",value:function(e){0!==this._output&&7!==this._output||this._updateOccludeeState(e),this.updateParameters(e)}},{key:"bind",value:function(e){this._technique.bindPass(this._material.getPassParameters(),e)}},{key:"getPipelineState",value:function(e,t){return this._technique.getPipelineState(t)}}]),r}(c.a),A=Object(n.a)({color:[1,1,1,1],transparent:!1,writeDepth:!0,writeLinearDepth:!1,vertexColors:!1,polygonOffset:!1,slicePlaneEnabled:!1,cullFace:0,sceneHasOcludees:!1},l.b)},function(e,t,r){"use strict";var n=Object.getOwnPropertySymbols,i=Object.prototype.hasOwnProperty,a=Object.prototype.propertyIsEnumerable;function o(e){if(null===e||void 0===e)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}e.exports=function(){try{if(!Object.assign)return!1;var e=new String("abc");if(e[5]="de","5"===Object.getOwnPropertyNames(e)[0])return!1;for(var t={},r=0;r<10;r++)t["_"+String.fromCharCode(r)]=r;if("0123456789"!==Object.getOwnPropertyNames(t).map((function(e){return t[e]})).join(""))return!1;var n={};return"abcdefghijklmnopqrst".split("").forEach((function(e){n[e]=e})),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},n)).join("")}catch(i){return!1}}()?Object.assign:function(e,t){for(var r,s,c=o(e),l=1;l<arguments.length;l++){for(var u in r=Object(arguments[l]))i.call(r,u)&&(c[u]=r[u]);if(n){s=n(r);for(var d=0;d<s.length;d++)a.call(r,s[d])&&(c[s[d]]=r[s[d]])}}return c}},function(e,t,r){"use strict";r.r(t),r.d(t,"fetchStyle",(function(){return g})),r.d(t,"fetchSymbolFromStyle",(function(){return j})),r.d(t,"resolveWebStyleSymbol",(function(){return O})),r.d(t,"styleNameFromItem",(function(){return w}));var n=r(14),i=r(13),a=r(99),o=r(98),s=r(405),c=r(22),l=r(39),u=r(149),d=r(250),h=r(322),f=r(130),p=r(185),b=r(364),v=r(356),m={};function y(e,t,r){var n,a=t.portal||u.a.getDefault(),o="".concat(a.url," - ").concat(a.user&&a.user.username," - ").concat(e);return m[o]||(m[o]=function(e,t,r){return t.load(r).then((function(){var n=new d.a({disableExtraQuery:!0,query:"owner:".concat(k," AND type:").concat(S,' AND typekeywords:"').concat(e,'"')});return t.queryItems(n,r)})).then((function(t){var n=t.results,a=null,o=e.toLowerCase();if(n&&Array.isArray(n)){var s,l=Object(i.a)(n);try{for(l.s();!(s=l.n()).done;){var u=s.value;if(u.typeKeywords.some((function(e){return e.toLowerCase()===o}))&&u.type===S&&u.owner===k){a=u;break}}}catch(d){l.e(d)}finally{l.f()}}if(!a)throw new c.a("symbolstyleutils:style-not-found","The style '".concat(e,"' could not be found"),{styleName:e});return a.load(r)}))}(e,a,r).then((function(e){return n=e,e.fetchData()})).then((function(t){return{data:t,baseUrl:n.itemUrl,styleName:e}}))),m[o]}function g(e,t,r){return e.styleUrl?function(e,t){return x(e,t).then((function(t){return{data:t.data,baseUrl:Object(l.G)(e),styleUrl:e}}))}(e.styleUrl,r):e.styleName?y(e.styleName,t,r):Promise.reject(new c.a("symbolstyleutils:style-url-and-name-missing","Either styleUrl or styleName is required to resolve a style"))}function O(e,t,r,n){return e.name?e.styleName&&"Esri2DPointSymbolsStyle"===e.styleName?function(e,t,r){var n=T.replace(/\{SymbolName\}/gi,e.name);return x(n,r).then((function(e){var r=_(e.data);return Object(p.a)(r,{portal:t.portal,url:Object(l.K)(Object(l.G)(n)),origin:"portal-item"})}))}(e,t,n):g(e,t,n).then((function(i){return j(i,e.name,t,r,n)})):Promise.reject(new c.a("symbolstyleutils:style-symbol-reference-name-missing","Missing name in style symbol reference"))}function j(e,t,r,n,a){var u=e.data,d={portal:r.portal,url:Object(l.K)(e.baseUrl),origin:"portal-item"},m=u.items.find((function(e){return e.name===t}));if(!m){var y="The symbol name '".concat(t,"' could not be found");return Promise.reject(new c.a("symbolstyleutils:symbol-name-not-found",y,{symbolName:t}))}var g=Object(f.a)(function(e,t){if("cimRef"===t)return e.cimRef;if(e.formatInfos&&!Object(h.c)()){var r,n=Object(i.a)(e.formatInfos);try{for(n.s();!(r=n.n()).done;){var a=r.value;if("gltf"===a.type)return a.href}}catch(o){n.e(o)}finally{n.f()}}return e.webRef}(m,n),d),O=m.thumbnail&&m.thumbnail.href,j=m.thumbnail&&m.thumbnail.imageData;Object(s.b)()&&(g=Object(s.a)(g),O=Object(s.a)(O));var w={portal:r.portal,url:Object(l.K)(Object(l.G)(g)),origin:"portal-item"};return x(g,a).then((function(i){var a="cimRef"===n?_(i.data):i.data,s=Object(p.a)(a,w);if(s&&Object(o.c)(s)){if(O){var c=Object(f.a)(O,d);s.thumbnail=new v.a({url:c})}else j&&(s.thumbnail=new v.a({url:"data:image/png;base64,".concat(j)}));e.styleUrl?s.styleOrigin=new b.a({portal:r.portal,styleUrl:e.styleUrl,name:t}):e.styleName&&(s.styleOrigin=new b.a({portal:r.portal,styleName:e.styleName,name:t}))}return s}))}function _(e){return null===e||"CIMSymbolReference"===e.type?e:{type:"CIMSymbolReference",symbol:e}}function w(e){var t,r=Object(i.a)(e.typeKeywords);try{for(r.s();!(t=r.n()).done;){var n=t.value;if(/^Esri.*Style$/.test(n)&&"Esri Style"!==n)return n}}catch(a){r.e(a)}finally{r.f()}}function x(e,t){var r=Object(n.a)({responseType:"json",query:{f:"json"}},t);return Object(a.default)(Object(l.D)(e),r)}var k="esri_en",S="Style",T="https://cdn.arcgis.com/sharing/rest/content/items/220936cc6ed342c9937abd8f180e7d1e/resources/styles/cim/{SymbolName}.json?f=json"},function(e,t,r){"use strict";r.d(t,"a",(function(){return p}));var n=r(22),i=r(25),a=r(3),o=r(113),s=r(363),c=new Set(["bing-maps","imagery","imagery-tile","map-image","open-street-map","tile","unknown","unsupported","vector-tile","web-tile"]),l=new Set(["csv","feature","geo-rss","group","imagery","imagery-tile","kml","map-image","map-notes","ogc-feature","tile","unknown","unsupported","vector-tile","web-tile","wfs"]);function u(e){return!("feature"!==e.type||e.url||!e.source||"memory"!==e.source.type)}function d(e,t){if(t.restrictedWebMapWriting){var r=function(e){return"basemap"===e.layerContainerType?c:"operational-layers"===e.layerContainerType?l:null}(t);return!Object(a.j)(r)||r.has(e.type)&&!u(e)}return!0}function h(e,t){"maxScale"in e&&(t.maxScale=Object(s.b)(e.maxScale)),"minScale"in e&&(t.minScale=Object(s.b)(e.minScale))}function f(e,t){if(function(e,t){if(u(e)){var r=Object(o.b)("featureCollection.layers",t),n=r&&r[0]&&r[0].layerDefinition;n&&h(e,n)}else"stream"===e.type?h(e,t.layerDefinition=t.layerDefinition||{}):"group"!==e.type&&h(e,t)}(e,t),"blendMode"in e&&(t.blendMode=e.blendMode,"normal"===t.blendMode&&delete t.blendMode),t.opacity=Object(s.b)(e.opacity),t.title=e.title||"Layer",t.visibility=e.visible,"legendEnabled"in e&&"wmts"!==e.type)if(u(e)){var r=t.featureCollection;r&&(r.showLegend=e.legendEnabled)}else t.showLegend=e.legendEnabled}function p(e,t,r){if(!("write"in e)||!e.write)return r&&r.messages&&r.messages.push(new n.a("layer:unsupported","Layers (".concat(e.title,", ").concat(e.id,") of type '").concat(e.declaredClass,"' cannot be persisted"),{layer:e})),null;if(d(e,r)){var o={};return e.write(o,r)?o:null}return Object(a.j)(t)&&f(e,t=Object(i.a)(t)),t}},function(e,t,r){"use strict";r.d(t,"a",(function(){return h}));var n,i=r(2),a=r(5),o=r(6),s=r(7),c=r(0),l=r(30),u=r(1),d=(r(17),r(18),r(15),r(10)),h=n=function(e){Object(o.a)(r,e);var t=Object(s.a)(r);function r(){var e;return Object(i.a)(this,r),(e=t.apply(this,arguments)).x=0,e.y=0,e}return Object(a.a)(r,[{key:"clone",value:function(){return new n({x:this.x,y:this.y})}}]),r}(l.a);Object(c.a)([Object(u.b)({type:Number})],h.prototype,"x",void 0),Object(c.a)([Object(u.b)({type:Number})],h.prototype,"y",void 0);var f=h=n=Object(c.a)([Object(d.a)("esri.symbols.support.Symbol3DAnchorPosition2D")],h);t.b=f},function(e,t,r){"use strict";r.d(t,"a",(function(){return h})),r.d(t,"b",(function(){return d}));var n=r(14),i=r(13),a=r(129),o=r(99),s=r(39),c=r(543),l=r(331);function u(e){var t=e.toJSON();return t.attachmentTypes&&(t.attachmentTypes=t.attachmentTypes.join(",")),t.keywords&&(t.keywords=t.keywords.join(",")),t.globalIds&&(t.globalIds=t.globalIds.join(",")),t.objectIds&&(t.objectIds=t.objectIds.join(",")),t.size&&(t.size=t.size.join(",")),t}function d(e,t){var r,n={},o=Object(i.a)(e);try{for(o.s();!(r=o.n()).done;){var l,u=r.value,d=u.parentObjectId,h=u.parentGlobalId,f=u.attachmentInfos,p=Object(i.a)(f);try{for(p.s();!(l=p.n()).done;){var b=l.value,v=b.id,m=Object(s.b)(Object(a.a)("".concat(t,"/").concat(d,"/attachments/").concat(v))),y=c.a.fromJSON(b);y.set({url:m,parentObjectId:d,parentGlobalId:h}),n[d]?n[d].push(y):n[d]=[y]}}catch(g){p.e(g)}finally{p.f()}}}catch(g){o.e(g)}finally{o.f()}return n}function h(e,t,r){var i={query:Object(l.a)(Object(n.a)(Object(n.a)({},e.query),{},{f:"json"},u(t)))};return r&&(i=Object(n.a)(Object(n.a)(Object(n.a)({},r),i),{},{query:Object(n.a)(Object(n.a)({},r.query),i.query)})),Object(o.default)(e.path+"/queryAttachments",i)}},function(e,t,r){"use strict";var n,i=r(2),a=r(5),o=r(6),s=r(7),c=r(0),l=r(25),u=r(1),d=(r(18),r(17),r(15),r(10)),h=r(428),f=r(395),p=n=function(e){Object(o.a)(r,e);var t=Object(s.a)(r);function r(e){var n;return Object(i.a)(this,r),(n=t.call(this,e)).colorRamps=null,n.type="multipart",n}return Object(a.a)(r,[{key:"clone",value:function(){return new n({colorRamps:Object(l.a)(this.colorRamps)})}}]),r}(f.a);Object(c.a)([Object(u.b)({type:[h.a],json:{write:!0}})],p.prototype,"colorRamps",void 0),Object(c.a)([Object(u.b)({type:["multipart"]})],p.prototype,"type",void 0);var b=p=n=Object(c.a)([Object(d.a)("esri.rest.support.MultipartColorRamp")],p);t.a=b},function(e,t,r){"use strict";var n=r(13),i=r(2),a=r(5),o=r(3),s=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(e){return e.values().next().value};Object(i.a)(this,e),this._peeker=t,this._items=new Set}return Object(a.a)(e,[{key:"length",get:function(){return this._items.size}},{key:"clear",value:function(){this._items.clear()}},{key:"last",value:function(){if(0!==this._items.size){var e,t,r=Object(n.a)(this._items);try{for(r.s();!(t=r.n()).done;)e=t.value}catch(i){r.e(i)}finally{r.f()}return e}}},{key:"peek",value:function(){if(0!==this._items.size)return this._peeker(this._items)}},{key:"push",value:function(e){this.contains(e)||this._items.add(e)}},{key:"contains",value:function(e){return this._items.has(e)}},{key:"pop",value:function(){if(0!==this.length){var e=this.peek();return this._items.delete(Object(o.d)(e)),e}}},{key:"popLast",value:function(){if(0!==this.length){var e=this.last();return this._items.delete(Object(o.d)(e)),e}}},{key:"remove",value:function(e){this._items.delete(e)}},{key:"filter",value:function(e){var t=this;return this._items.forEach((function(r){e(r)||t._items.delete(r)})),this}}]),e}();t.a=s},function(e,t,r){"use strict";r.d(t,"b",(function(){return v}));var n=r(2),i=r(5),a=r(6),o=r(7),s=r(0),c=r(137),l=r(53),u=r(207),d=(r(17),r(15)),h=r(1),f=(r(18),r(10)),p=l.a.ofType(c.a);d.a.getLogger("esri.support.GraphicsCollection");var b=function(e){Object(a.a)(r,e);var t=Object(o.a)(r);function r(e){var i;return Object(n.a)(this,r),(i=t.call(this,e)).on("before-add",(function(e){e.item||e.preventDefault()})),i.on("after-add",(function(e){return i._own(e.item)})),i.on("after-remove",(function(e){e.item.layer=null})),i}return Object(i.a)(r,[{key:"destroy",value:function(){this._unownAll()}},{key:"owner",get:function(){return this._get("owner")},set:function(e){e!==this._get("owner")&&(this._unownAll(),this._set("owner",e),this._ownAll())}},{key:"_createNewInstance",value:function(e){return new p(e)}},{key:"_ownAll",value:function(){var e=this;this.items.forEach((function(t){return e._own(t)}))}},{key:"_own",value:function(e){e.layer&&"remove"in e.layer&&e.layer!==this.owner&&e.layer.remove(e),e.layer=this.owner}},{key:"_unownAll",value:function(){var e=this;this.items.forEach((function(t){return e._unown(t)}))}},{key:"_unown",value:function(e){e.layer===this.owner&&(e.layer=null)}}]),r}(p);Object(s.a)([Object(h.b)()],b.prototype,"owner",null),b=Object(s.a)([Object(f.a)("esri.support.GraphicsCollection")],b);var v=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"graphics";return{type:b,cast:u.a,set:function(t){var r=Object(u.b)(t,this._get(e),b);r.owner=this,this._set(e,r)}}},m=b;t.a=m},function(e,t,r){"use strict";r.d(t,"a",(function(){return u}));var n,i,a,o=r(12),s=r(221),c=r(325),l=r(11);function u(e,t){e.include(s.a,t),e.fragment.include(c.a);var r=e.fragment;r.uniforms.add("uBaseColor","vec4"),r.uniforms.add("uObjectOpacity","float"),t.attributeColor?r.code.add(Object(l.a)(n||(n=Object(o.a)(["vec3 _baseColor() {\nreturn uBaseColor.rgb * vColor.rgb;\n}\nfloat _baseOpacity() {\nreturn uBaseColor.a * vColor.a;\n}"])))):r.code.add(Object(l.a)(i||(i=Object(o.a)(["vec3 _baseColor() {\nreturn uBaseColor.rgb;\n}\nfloat _baseOpacity() {\nreturn uBaseColor.a;\n}"])))),r.code.add(Object(l.a)(a||(a=Object(o.a)(["vec4 computeMaterialColor(vec4 textureColor, vec4 externalColor, int externalColorMixMode) {\nvec3 baseColor = _baseColor();\nfloat baseOpacity = _baseOpacity();\nvec3 color = mixExternalColor(\nbaseColor,\ntextureColor.rgb,\nexternalColor.rgb,\nexternalColorMixMode\n);\nfloat opacity = uObjectOpacity * mixExternalOpacity(\nbaseOpacity,\ntextureColor.a,\nexternalColor.a,\nexternalColorMixMode\n);\nreturn vec4(color, opacity);\n}"]))))}},function(e,t,r){"use strict";r.d(t,"a",(function(){return b}));var n,i,a,o,s,c,l,u,d=r(12),h=r(283),f=r(145),p=r(11);function b(e,t){var r=e.fragment;0===t.doubleSidedMode?r.code.add(Object(p.a)(n||(n=Object(d.a)(["vec3 _adjustDoublesided(vec3 normal) {\nreturn normal;\n}"])))):1===t.doubleSidedMode?(e.include(f.a,t),r.uniforms.add("uTransform_ViewFromCameraLocal_T","vec3"),r.code.add(Object(p.a)(i||(i=Object(d.a)(["vec3 _adjustDoublesided(vec3 normal) {\nvec3 viewDir = vPositionWorldCameraRelative + uTransform_ViewFromCameraLocal_T;\nreturn dot(normal, viewDir) > 0.0 ? -normal : normal;\n}"]))))):2===t.doubleSidedMode&&r.code.add(Object(p.a)(a||(a=Object(d.a)(["vec3 _adjustDoublesided(vec3 normal) {\nreturn gl_FrontFacing ? normal : -normal;\n}"])))),0===t.normalType||1===t.normalType?(e.include(h.a,t),r.code.add(Object(p.a)(o||(o=Object(d.a)(["vec3 shadingNormalWorld() {\nreturn _adjustDoublesided(normalize(vNormalWorld));\n}\nvec3 shadingNormal_view() {\nvec3 normal = normalize(vNormalView);\nreturn gl_FrontFacing ? normal : -normal;\n}"]))))):3===t.normalType?(e.extensions.add("GL_OES_standard_derivatives"),e.include(f.a,t),r.code.add(Object(p.a)(s||(s=Object(d.a)(["vec3 shadingNormalWorld() {\nreturn normalize(cross(\ndFdx(vPositionWorldCameraRelative),\ndFdy(vPositionWorldCameraRelative)\n));\n}\nvec3 shadingNormal_view() {\nreturn normalize(cross(dFdx(vPosition_view),dFdy(vPosition_view)));\n}"]))))):2===t.normalType&&(1===t.viewingMode?(e.include(f.a,t),r.code.add(Object(p.a)(c||(c=Object(d.a)(["vec3 shadingNormalWorld() {\nreturn normalize(positionWorld());\n}"]))))):2===t.viewingMode&&r.code.add(Object(p.a)(l||(l=Object(d.a)(["vec3 shadingNormalWorld() {\nreturn vec3(0.0, 0.0, 1.0);\n}"])))),e.extensions.add("GL_OES_standard_derivatives"),r.code.add(Object(p.a)(u||(u=Object(d.a)(["vec3 shadingNormal_view() {\nreturn normalize(cross(dFdx(vPosition_view),dFdy(vPosition_view))).xyz;\n}"])))))}},function(e,t,r){"use strict";r.r(t);var n=r(2),i=r(5),a=r(6),o=r(7),s=r(0),c=r(22),l=r(27),u=r(1),d=(r(17),r(18)),h=(r(15),r(10)),f=r(250),p=function(e){Object(a.a)(r,e);var t=Object(o.a)(r);function r(e){var i;return Object(n.a)(this,r),(i=t.call(this,e)).access=null,i.created=null,i.description=null,i.id=null,i.isInvitationOnly=!1,i.modified=null,i.owner=null,i.portal=null,i.snippet=null,i.sortField=null,i.sortOrder=null,i.tags=null,i.title=null,i}return Object(i.a)(r,[{key:"thumbnailUrl",get:function(){var e=this.url,t=this.thumbnail;return e&&t?this.portal._normalizeUrl("".concat(e,"/info/").concat(t,"?f=json")):null}},{key:"url",get:function(){var e=this.get("portal.restUrl");return e?e+"/community/groups/"+this.id:null}},{key:"fetchCategorySchema",value:function(e){var t=this;return this.portal._request(this.url+"/categorySchema",e).then((function(r){var n=r.categorySchema||[];return n.some((function(e){return"contentCategorySetsGroupQuery.LivingAtlas"===e.source}))?t._fetchCategorySchemaSet("LivingAtlas",e):n}))}},{key:"fetchMembers",value:function(e){return this.portal._request(this.url+"/users",e)}},{key:"getThumbnailUrl",value:function(e){var t=this.thumbnailUrl;return t&&e&&(t+="&w=".concat(e)),t}},{key:"toJSON",value:function(){throw new c.a("internal:not-yet-implemented","PortalGroup.toJSON is not yet implemented")}},{key:"queryItems",value:function(e,t){var r=Object(d.m)(f.a,e);return parseFloat(this.portal.currentVersion)>5?(r=r||new f.a,this.portal._queryPortal("/content/groups/".concat(this.id,"/search"),r,"PortalItem",t)):((r=r?r.clone():new f.a).query="group:"+this.id+(r.query?" "+r.query:""),this.portal.queryItems(r,t))}},{key:"_fetchCategorySchemaSet",value:function(e,t){var r=this;return this.portal._fetchSelf(this.portal.authMode,!0,t).then((function(e){var n=e.contentCategorySetsGroupQuery;if(n){var i=new f.a;return i.disableExtraQuery=!0,i.num=1,i.query=n,r.portal.queryGroups(i,t)}throw new c.a("portal-group:fetchCategorySchema","contentCategorySetsGroupQuery value not found")})).then((function(r){if(r.total){var n=r.results[0],i=new f.a;return i.num=1,i.query='typekeywords:"'.concat(e,'"'),n.queryItems(i,t)}throw new c.a("portal-group:fetchCategorySchema","contentCategorySetsGroupQuery group not found")})).then((function(e){return e.total?e.results[0].fetchData("json",t).then((function(e){var t=e&&e.categorySchema;return t&&t.length?t:[]})):[]}))}}]),r}(l.a);Object(s.a)([Object(u.b)()],p.prototype,"access",void 0),Object(s.a)([Object(u.b)({type:Date})],p.prototype,"created",void 0),Object(s.a)([Object(u.b)()],p.prototype,"description",void 0),Object(s.a)([Object(u.b)()],p.prototype,"id",void 0),Object(s.a)([Object(u.b)()],p.prototype,"isInvitationOnly",void 0),Object(s.a)([Object(u.b)({type:Date})],p.prototype,"modified",void 0),Object(s.a)([Object(u.b)()],p.prototype,"owner",void 0),Object(s.a)([Object(u.b)()],p.prototype,"portal",void 0),Object(s.a)([Object(u.b)()],p.prototype,"snippet",void 0),Object(s.a)([Object(u.b)()],p.prototype,"sortField",void 0),Object(s.a)([Object(u.b)()],p.prototype,"sortOrder",void 0),Object(s.a)([Object(u.b)()],p.prototype,"tags",void 0),Object(s.a)([Object(u.b)()],p.prototype,"thumbnail",void 0),Object(s.a)([Object(u.b)({readOnly:!0})],p.prototype,"thumbnailUrl",null),Object(s.a)([Object(u.b)()],p.prototype,"title",void 0),Object(s.a)([Object(u.b)({readOnly:!0})],p.prototype,"url",null);var b=p=Object(s.a)([Object(h.a)("esri.portal.PortalGroup")],p);t.default=b},function(e,t,r){"use strict";r.d(t,"a",(function(){return x})),r.d(t,"b",(function(){return k}));var n=r(13),i=r(2),a=r(5),o=r(6),s=r(7),c=r(0),l=r(30),u=r(19),d=r(3),h=r(50),f=r(25),p=r(164),b=function(){function e(){Object(i.a)(this,e),this._propertyOriginMap=new Map,this._originStores=new Array(p.a),this._values=new Map}return Object(a.a)(e,[{key:"clone",value:function(t){var r=this,n=new e,i=this._originStores[0];i&&i.forEach((function(e,t){n.set(t,Object(f.a)(e),0)}));for(var a=function(e){var i=r._originStores[e];i&&i.forEach((function(r,i){t&&t.has(i)||n.set(i,Object(f.a)(r),e)}))},o=2;o<p.a;o++)a(o);return n}},{key:"get",value:function(e,t){var r=void 0===t?this._values:this._originStores[t];return r?r.get(e):void 0}},{key:"keys",value:function(e){var t=null==e?this._values:this._originStores[e];return t?Object(h.a)(t.keys()):[]}},{key:"set",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:6,n=this._originStores[r];if(n||(n=new Map,this._originStores[r]=n),n.set(e,t),!this._values.has(e)||Object(d.d)(this._propertyOriginMap.get(e))<=r){var i=this._values.get(e);return this._values.set(e,t),this._propertyOriginMap.set(e,r),i!==t}return!1}},{key:"delete",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:6,r=this._originStores[t];if(r){var n=r.get(e);if(r.delete(e),this._values.has(e)&&this._propertyOriginMap.get(e)===t){this._values.delete(e);for(var i=t-1;i>=0;i--){var a=this._originStores[i];if(a&&a.has(e)){this._values.set(e,a.get(e)),this._propertyOriginMap.set(e,i);break}}}return n}}},{key:"has",value:function(e,t){var r=void 0===t?this._values:this._originStores[t];return!!r&&r.has(e)}},{key:"revert",value:function(e,t){for(;t>0&&!this.has(e,t);)--t;var r=this._originStores[t],n=r&&r.get(e),i=this._values.get(e);return this._values.set(e,n),this._propertyOriginMap.set(e,t),i!==n}},{key:"originOf",value:function(e){return this._propertyOriginMap.get(e)||0}},{key:"forEach",value:function(e){this._values.forEach(e)}}]),e}(),v=r(393),m=r(114),y=r(10),g=function(e){var t=function(e){Object(o.a)(r,e);var t=Object(s.a)(r);function r(){var e;Object(i.a)(this,r);for(var n=arguments.length,a=new Array(n),o=0;o<n;o++)a[o]=arguments[o];e=t.call.apply(t,[this].concat(a));var s=Object(d.d)(Object(m.a)(Object(u.a)(e))),c=s.metadatas,l=s.store,h=new b;return s.store=h,l.keys().forEach((function(e){h.set(e,l.get(e),0)})),Object.keys(c).forEach((function(e){s.internalGet(e)&&h.set(e,s.internalGet(e),0)})),e}return Object(a.a)(r,[{key:"read",value:function(e,t){Object(v.a)(this,e,t)}},{key:"getAtOrigin",value:function(e,t){var r=O(this),n=Object(p.d)(t);if("string"==typeof e)return r.get(e,n);var i={};return e.forEach((function(e){i[e]=r.get(e,n)})),i}},{key:"originOf",value:function(e){return Object(p.b)(this.originIdOf(e))}},{key:"originIdOf",value:function(e){return O(this).originOf(e)}},{key:"revert",value:function(e,t){var r=O(this),n=Object(p.d)(t),i=Object(m.a)(this);("string"==typeof e?"*"===e?r.keys(n):[e]:e).forEach((function(e){i.invalidate(e),r.revert(e,n),i.commit(e)}))}}]),r}(e);return t=Object(c.a)([Object(y.a)("esri.core.ReadOnlyMultiOriginJSONSupport")],t),t};function O(e){return Object(m.a)(e).store}var j=function(e){Object(o.a)(r,e);var t=Object(s.a)(r);function r(){return Object(i.a)(this,r),t.apply(this,arguments)}return r}(g(l.a));j=Object(c.a)([Object(y.a)("esri.core.ReadOnlyMultiOriginJSONSupport")],j);var _=r(385);function w(e){return Object(m.a)(e).store}var x=function(e){var t=function(e){Object(o.a)(r,e);var t=Object(s.a)(r);function r(){Object(i.a)(this,r);for(var e=arguments.length,n=new Array(e),a=0;a<e;a++)n[a]=arguments[a];return t.call.apply(t,[this].concat(n))}return r}(function(e){var t=function(e){Object(o.a)(r,e);var t=Object(s.a)(r);function r(){Object(i.a)(this,r);for(var e=arguments.length,n=new Array(e),a=0;a<e;a++)n[a]=arguments[a];return t.call.apply(t,[this].concat(n))}return Object(a.a)(r,[{key:"clear",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"user";return w(this).delete(e,Object(p.d)(t))}},{key:"write",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;return Object(_.b)(this,e=e||{},t),e}},{key:"setAtOrigin",value:function(e,t,r){Object(m.a)(this).setAtOrigin(e,t,Object(p.d)(r))}},{key:"removeOrigin",value:function(e){var t,r=w(this),i=Object(p.d)(e),a=r.keys(i),o=Object(n.a)(a);try{for(o.s();!(t=o.n()).done;){var s=t.value;r.originOf(s)===i&&r.set(s,r.get(s,i),6)}}catch(c){o.e(c)}finally{o.f()}}},{key:"updateOrigin",value:function(e,t){for(var r=w(this),n=Object(p.d)(t),i=this.get(e),a=n+1;a<p.a;++a)r.delete(e,a);r.set(e,i,n)}},{key:"toJSON",value:function(e){return this.write({},e)}}]),r}(e);return(t=Object(c.a)([Object(y.a)("esri.core.WriteableMultiOriginJSONSupport")],t)).prototype.toJSON.isDefaultToJSON=!0,t}(g(e)));return t=Object(c.a)([Object(y.a)("esri.core.MultiOriginJSONSupport")],t)},k=function(e){Object(o.a)(r,e);var t=Object(s.a)(r);function r(){return Object(i.a)(this,r),t.apply(this,arguments)}return r}(x(l.a));k=Object(c.a)([Object(y.a)("esri.core.MultiOriginJSONSupport")],k)},function(e,t,r){"use strict";r.d(t,"a",(function(){return P}));var n=r(14),i=r(8),a=r.n(i),o=r(16),s=r(2),c=r(5),l=r(45),u=r(42),d=r(6),h=r(7),f=r(0),p=r(129),b=r(99),v=r(128),m=r(22),y=r(15),g=r(3),O=r(23),j=r(39),_=r(1),w=(r(17),r(18),r(48)),x=r(10),k=r(44),S=r(149),T=r(418),C=r(541),M=y.a.getLogger("esri.layers.mixins.PortalLayer"),P=function(e){var t=function(e){Object(d.a)(i,e);var t=Object(h.a)(i);function i(){var e;return Object(s.a)(this,i),(e=t.apply(this,arguments)).resourceReferences={portalItem:null,paths:[]},e.userHasEditingPrivileges=!0,e}return Object(c.a)(i,[{key:"destroy",value:function(){var e;null==(e=this.portalItem)||e.destroy(),this.portalItem=null}},{key:"portalItem",set:function(e){e!==this._get("portalItem")&&(this.removeOrigin("portal-item"),this._set("portalItem",e))}},{key:"readPortalItem",value:function(e,t,r){if(t.itemId)return new T.default({id:t.itemId,portal:r&&r.portal})}},{key:"writePortalItem",value:function(e,t){e&&e.id&&(t.itemId=e.id)}},{key:"loadFromPortal",value:function(){var e=Object(o.a)(a.a.mark((function e(t,n){var i;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.portalItem||!this.portalItem.id){e.next=14;break}return e.prev=1,e.next=4,r.e(10).then(r.bind(null,702));case 4:return i=e.sent,Object(O.x)(n),e.next=8,i.load({instance:this,supportedTypes:t.supportedTypes,validateItem:t.validateItem,supportsData:t.supportsData},n);case 8:return e.abrupt("return",e.sent);case 11:throw e.prev=11,e.t0=e.catch(1),Object(O.n)(e.t0)||M.warn("Failed to load layer (".concat(this.title,", ").concat(this.id,") portal item (").concat(this.portalItem.id,")\n  ").concat(e.t0)),e.t0;case 14:case"end":return e.stop()}}),e,this,[[1,11]])})));return function(t,r){return e.apply(this,arguments)}}()},{key:"finishLoadEditablePortalLayer",value:function(){var e=Object(o.a)(a.a.mark((function e(t){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=this,e.next=3,this.fetchUserHasEditingPrivileges(t).catch((function(e){return Object(O.w)(e),!0}));case 3:e.t1=e.sent,e.t0._set.call(e.t0,"userHasEditingPrivileges",e.t1);case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"fetchUserHasEditingPrivileges",value:function(){var e=Object(o.a)(a.a.mark((function e(t){var r,n;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=this.url?null==p.b?void 0:p.b.findCredential(this.url):null){e.next=3;break}return e.abrupt("return",!0);case 3:if(A.credential!==r){e.next=7;break}e.t0=A.user,e.next=10;break;case 7:return e.next=9,this.fetchEditingUser(t);case 9:e.t0=e.sent;case 10:return n=e.t0,e.abrupt("return",(A.credential=r,A.user=n,Object(g.i)(n)||null==n.privileges||n.privileges.includes("features:user:edit")));case 12:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"fetchEditingUser",value:function(){var e=Object(o.a)(a.a.mark((function e(t){var r,n,i,o,s,c,l,u,d;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(i=null==(r=this.portalItem)||null==(n=r.portal)?void 0:n.user)){e.next=3;break}return e.abrupt("return",i);case 3:if(null!=(o=p.b.findServerInfo(this.url))&&o.owningSystemUrl){e.next=6;break}return e.abrupt("return",null);case 6:if(s="".concat(o.owningSystemUrl,"/sharing/rest"),!(c=S.a.getDefault())||!c.loaded||Object(j.D)(c.restUrl)!==Object(j.D)(s)){e.next=9;break}return e.abrupt("return",c.user);case 9:return l="".concat(s,"/community/self"),u=Object(g.j)(t)?t.signal:null,e.next=13,Object(v.d)(Object(b.default)(l,{authMode:"no-prompt",query:{f:"json"},signal:u}));case 13:return d=e.sent,e.abrupt("return",d.ok?C.default.fromJSON(d.value.data):null);case 15:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"read",value:function(e,t){t&&(t.layer=this),Object(l.a)(Object(u.a)(i.prototype),"read",this).call(this,e,t)}},{key:"write",value:function(e,t){var r=t&&t.portal,a=this.portalItem&&this.portalItem.id&&(this.portalItem.portal||S.a.getDefault());return r&&a&&!Object(j.r)(a.restUrl,r.restUrl)?(t.messages&&t.messages.push(new m.a("layer:cross-portal","The layer '".concat(this.title," (").concat(this.id,")' cannot be persisted because it refers to an item on a different portal than the one being saved to. To save the scene, set the layer.portalItem to null or save the scene to the same portal as the item associated with the layer"),{layer:this})),null):Object(l.a)(Object(u.a)(i.prototype),"write",this).call(this,e,Object(n.a)(Object(n.a)({},t),{},{layer:this}))}}]),i}(e);return Object(f.a)([Object(_.b)({type:T.default})],t.prototype,"portalItem",null),Object(f.a)([Object(w.a)("web-document","portalItem",["itemId"])],t.prototype,"readPortalItem",null),Object(f.a)([Object(k.a)("web-document","portalItem",{itemId:{type:String}})],t.prototype,"writePortalItem",null),Object(f.a)([Object(_.b)()],t.prototype,"resourceReferences",void 0),Object(f.a)([Object(_.b)({readOnly:!0})],t.prototype,"userHasEditingPrivileges",void 0),t=Object(f.a)([Object(x.a)("esri.layers.mixins.PortalLayer")],t),t},A={credential:null,user:null}},function(e,t,r){"use strict";r.d(t,"a",(function(){return g}));var n=r(14),i=r(2),a=r(5),o=r(45),s=r(42),c=r(6),l=r(7),u=r(0),d=r(22),h=r(1),f=(r(17),r(18),r(15),r(10)),p=r(44),b=r(393),v=r(385),m={"web-scene/operational-layers":{ArcGISFeatureLayer:!0,ArcGISImageServiceLayer:!0,ArcGISMapServiceLayer:!0,ArcGISSceneServiceLayer:!0,ArcGISTiledElevationServiceLayer:!0,ArcGISTiledImageServiceLayer:!0,ArcGISTiledMapServiceLayer:!0,BuildingSceneLayer:!0,GroupLayer:!0,IntegratedMeshLayer:!0,PointCloudLayer:!0,WebTiledLayer:!0,CSV:!0,VectorTileLayer:!0,WMS:!0,KML:!0,RasterDataLayer:!0},"web-scene/basemap":{ArcGISTiledImageServiceLayer:!0,ArcGISTiledMapServiceLayer:!0,WebTiledLayer:!0,OpenStreetMap:!0,VectorTileLayer:!0,ArcGISImageServiceLayer:!0,WMS:!0,ArcGISMapServiceLayer:!0},"web-scene/ground":{ArcGISTiledElevationServiceLayer:!0,RasterDataElevationLayer:!0},"web-map/operational-layers":{ArcGISFeatureLayer:!0,ArcGISImageServiceLayer:!0,ArcGISImageServiceVectorLayer:!0,ArcGISMapServiceLayer:!0,ArcGISStreamLayer:!0,ArcGISTiledImageServiceLayer:!0,ArcGISTiledMapServiceLayer:!0,BingMapsAerial:!0,BingMapsHybrid:!0,BingMapsRoad:!0,CSV:!0,GeoRSS:!0,GroupLayer:!0,KML:!0,OGCFeatureLayer:!0,SubtypeGroupLayer:!0,VectorTileLayer:!0,WFS:!0,WMS:!0,WebTiledLayer:!0},"web-map/basemap":{ArcGISImageServiceLayer:!0,ArcGISImageServiceVectorLayer:!0,ArcGISMapServiceLayer:!0,ArcGISTiledImageServiceLayer:!0,ArcGISTiledMapServiceLayer:!0,OpenStreetMap:!0,VectorTileLayer:!0,WMS:!0,WebTiledLayer:!0,BingMapsAerial:!0,BingMapsRoad:!0,BingMapsHybrid:!0},"web-map/tables":{ArcGISFeatureLayer:!0},"portal-item/operational-layers":{ArcGISSceneServiceLayer:!0,PointCloudLayer:!0,BuildingSceneLayer:!0,IntegratedMeshLayer:!0}},y=r(188),g=function(e){var t=function(e){Object(c.a)(r,e);var t=Object(l.a)(r);function r(){var e;return Object(i.a)(this,r),(e=t.apply(this,arguments)).title=null,e}return Object(a.a)(r,[{key:"writeListMode",value:function(e,t,r,n){(n&&"ground"===n.layerContainerType||e&&Object(v.a)(this,r,{},n))&&(t[r]=e)}},{key:"writeOperationalLayerType",value:function(e,t,r,n){!e||n&&"tables"===n.layerContainerType||(t.layerType=e)}},{key:"writeTitle",value:function(e,t){t.title=e||"Layer"}},{key:"read",value:function(e,t){var n=this;t&&(t.layer=this),Object(b.b)(this,e,(function(t){return Object(o.a)(Object(s.a)(r.prototype),"read",n).call(n,e,t)}),t)}},{key:"write",value:function(e,t){if(t&&t.origin){var i="".concat(t.origin,"/").concat(t.layerContainerType||"operational-layers"),a=m[i],c=a&&a[this.operationalLayerType];if("ArcGISTiledElevationServiceLayer"===this.operationalLayerType&&"web-scene/operational-layers"===i&&(c=!1),!c)return t.messages&&t.messages.push(new d.a("layer:unsupported","Layers (".concat(this.title,", ").concat(this.id,") of type '").concat(this.declaredClass,"' are not supported in the context of '").concat(i,"'"),{layer:this})),null}var l=Object(o.a)(Object(s.a)(r.prototype),"write",this).call(this,e,Object(n.a)(Object(n.a)({},t),{},{layer:this})),u=!!t&&!!t.messages&&!!t.messages.filter((function(e){return e instanceof d.a&&"web-document-write:property-required"===e.name})).length;return!this.url&&u?null:l}},{key:"beforeSave",value:function(){}}]),r}(e);return Object(u.a)([Object(h.b)({type:String,json:{write:{ignoreOrigin:!0},origins:{"web-scene":{write:{isRequired:!0,ignoreOrigin:!0}},"portal-item":{write:!1}}}})],t.prototype,"id",void 0),Object(u.a)([Object(h.b)({json:{write:{ignoreOrigin:!0},origins:{"web-map":{read:!1,write:!1}}}})],t.prototype,"listMode",void 0),Object(u.a)([Object(p.a)("listMode")],t.prototype,"writeListMode",null),Object(u.a)([Object(h.b)({type:String,readOnly:!0,json:{read:!1,write:{target:"layerType",ignoreOrigin:!0},origins:{"portal-item":{write:!1}}}})],t.prototype,"operationalLayerType",void 0),Object(u.a)([Object(p.a)("operationalLayerType")],t.prototype,"writeOperationalLayerType",null),Object(u.a)([Object(h.b)(y.h)],t.prototype,"opacity",void 0),Object(u.a)([Object(h.b)({type:String,json:{write:{ignoreOrigin:!0,allowNull:!0},origins:{"web-scene":{write:{isRequired:!0,ignoreOrigin:!0,allowNull:!0}},"portal-item":{write:!1}}},value:"Layer"})],t.prototype,"title",void 0),Object(u.a)([Object(p.a)("title")],t.prototype,"writeTitle",null),Object(u.a)([Object(h.b)({type:Boolean,json:{name:"visibility",origins:{"web-document":{name:"visibility",default:!0},"portal-item":{name:"visibility",read:{source:["visible","visibility"]}}}}})],t.prototype,"visible",void 0),t=Object(u.a)([Object(f.a)("esri.layers.mixins.OperationalLayer")],t)}},function(e,t,r){"use strict";r.d(t,"a",(function(){return u}));var n=r(2),i=r(5),a=r(6),o=r(7),s=r(0),c=r(1),l=(r(17),r(18),r(15),r(10)),u=function(e){var t=function(e){Object(a.a)(r,e);var t=Object(o.a)(r);function r(){var e;return Object(n.a)(this,r),(e=t.apply(this,arguments)).minScale=0,e.maxScale=0,e}return Object(i.a)(r,[{key:"scaleRangeId",get:function(){return"".concat(this.minScale,",").concat(this.maxScale)}}]),r}(e);return Object(s.a)([Object(c.b)({type:Number,nonNullable:!0,json:{write:!0}})],t.prototype,"minScale",void 0),Object(s.a)([Object(c.b)({type:Number,nonNullable:!0,json:{write:!0}})],t.prototype,"maxScale",void 0),Object(s.a)([Object(c.b)({readOnly:!0})],t.prototype,"scaleRangeId",null),t=Object(s.a)([Object(l.a)("esri.layers.mixins.ScaleRangeLayer")],t)}},function(e,t,r){"use strict";var n=r(2),i=r(5),a=r(6),o=r(7),s=r(0),c=r(30),l=r(82),u=r(189),d=r(370),h=r(15),f=r(238),p=r(1),b=(r(17),r(18),r(10)),v=function(e){Object(a.a)(r,e);var t=Object(o.a)(r);function r(e){var i;return Object(n.a)(this,r),(i=t.call(this,e)).layer=null,i.parent=null,i}return Object(i.a)(r,[{key:"initialize",value:function(){var e=this;this.when().catch((function(t){if("layerview:create-error"!==t.name){var r=e.layer&&e.layer.id||"no id",n=e.layer&&e.layer.title||"no title";throw h.a.getLogger(e.declaredClass).error("#resolve()","Failed to resolve layer view (layer title: '".concat(n,"', id: '").concat(r,"')"),t),t}}))}},{key:"fullOpacity",get:function(){var e=function(e){return null==e?1:e};return e(this.get("layer.opacity"))*e(this.get("parent.fullOpacity"))}},{key:"suspended",get:function(){return!this.canResume()}},{key:"suspendInfo",get:function(){return this.getSuspendInfo()}},{key:"legendEnabled",get:function(){return!this.suspended&&!0===this.layer.legendEnabled}},{key:"updating",get:function(){return!!(this.updatingHandles&&this.updatingHandles.updating||this.isUpdating())}},{key:"updatingProgress",get:function(){return this.updating?0:1}},{key:"visible",get:function(){return!0===this.get("layer.visible")},set:function(e){void 0!==e?this._override("visible",e):this._clearOverride("visible")}},{key:"canResume",value:function(){return!this.get("parent.suspended")&&this.get("view.ready")&&this.get("layer.loaded")&&this.visible||!1}},{key:"getSuspendInfo",value:function(){var e=this.parent&&this.parent.suspended?this.parent.suspendInfo:{};return this.view&&this.view.ready||(e.viewNotReady=!0),this.layer&&this.layer.loaded||(e.layerNotLoaded=!0),this.visible||(e.layerInvisible=!0),e}},{key:"isUpdating",value:function(){return!1}}]),r}(Object(u.b)(Object(d.a)(Object(f.b)(l.a.EventedMixin(c.a)))));Object(s.a)([Object(p.b)()],v.prototype,"fullOpacity",null),Object(s.a)([Object(p.b)()],v.prototype,"layer",void 0),Object(s.a)([Object(p.b)()],v.prototype,"parent",void 0),Object(s.a)([Object(p.b)({readOnly:!0})],v.prototype,"suspended",null),Object(s.a)([Object(p.b)({readOnly:!0})],v.prototype,"suspendInfo",null),Object(s.a)([Object(p.b)({readOnly:!0})],v.prototype,"legendEnabled",null),Object(s.a)([Object(p.b)({type:Boolean,readOnly:!0})],v.prototype,"updating",null),Object(s.a)([Object(p.b)({readOnly:!0})],v.prototype,"updatingProgress",null),Object(s.a)([Object(p.b)()],v.prototype,"visible",null);var m=v=Object(s.a)([Object(b.a)("esri.views.layers.LayerView")],v);t.a=m},function(e,t,r){"use strict";r.d(t,"a",(function(){return m}));var n=r(8),i=r.n(n),a=r(16),o=r(2),s=r(5),c=r(45),l=r(42),u=r(6),d=r(7),h=r(0),f=r(35),p=r(1),b=(r(17),r(18),r(15),r(10)),v=r(406),m=function(e){var t=function(e){Object(u.a)(r,e);var t=Object(d.a)(r);function r(){var e;return Object(o.a)(this,r),(e=t.apply(this,arguments)).slicePlaneEnabled=!1,e.supportsHeightUnitConversion=!1,e}return Object(s.a)(r,[{key:"postscript",value:function(e){Object(c.a)(Object(l.a)(r.prototype),"postscript",this).call(this,e),Object(v.b)(this.layer)&&this.addResolvingPromise(this._validateHeightModelInfo())}},{key:"_validateHeightModelInfo",value:function(){var e=Object(a.a)(i.a.mark((function e(){var t,r;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=Object(f.h)(this.view.defaultsFromMap,"isHeightModelInfoSearching"),this.handles.add(t),e.next=4,t;case 4:if(!(r=Object(v.c)(this.layer,this.view.heightModelInfo,this.supportsHeightUnitConversion))){e.next=7;break}throw r;case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),r}(e);return Object(h.a)([Object(p.b)()],t.prototype,"view",void 0),Object(h.a)([Object(p.b)()],t.prototype,"slicePlaneEnabled",void 0),t=Object(h.a)([Object(b.a)("esri.views.3d.layers.LayerView3D")],t)}},function(e,t,r){"use strict";r.d(t,"a",(function(){return l}));var n=r(2),i=r(6),a=r(7),o=r(0),s=r(1),c=(r(17),r(18),r(15),r(10)),l=function(e){var t=function(e){Object(i.a)(r,e);var t=Object(a.a)(r);function r(){var e;return Object(n.a)(this,r),(e=t.apply(this,arguments)).blendMode="normal",e.effect=null,e}return r}(e);return Object(o.a)([Object(s.b)({type:["average","color-burn","color-dodge","color","darken","destination-atop","destination-in","destination-out","destination-over","difference","exclusion","hard-light","hue","invert","lighten","lighter","luminosity","minus","multiply","normal","overlay","plus","reflect","saturation","screen","soft-light","source-atop","source-in","source-out","vivid-light","xor"],nonNullable:!0,json:{read:!1,write:!1,origins:{"web-map":{default:"normal",read:!0,write:!0}}}})],t.prototype,"blendMode",void 0),Object(o.a)([Object(s.b)()],t.prototype,"effect",void 0),t=Object(o.a)([Object(c.a)("esri.layers.mixins.BlendLayer")],t)}},function(e,t,r){"use strict";var n=r(13),i=r(2),a=r(5);function o(e){return"date"===e.type||"esriFieldTypeDate"===e.type}var s=function(){function e(t){if(Object(i.a)(this,e),this.fields=t,this._fieldsMap=new Map,this._dateFieldsSet=new Set,this.dateFields=[],t){var r,a=[],s=Object(n.a)(t);try{for(s.s();!(r=s.n()).done;){var l=r.value,u=l&&l.name;if(u){var d=c(u);this._fieldsMap.set(u,l),this._fieldsMap.set(d,l),a.push(d),o(l)&&(this.dateFields.push(l),this._dateFieldsSet.add(l))}}}catch(h){s.e(h)}finally{s.f()}a.sort(),this.uid=a.join(",")}}return Object(a.a)(e,[{key:"destroy",value:function(){this._fieldsMap.clear()}},{key:"has",value:function(e){return null!=this.get(e)}},{key:"get",value:function(e){return null!=e?this._fieldsMap.get(e)||this._fieldsMap.get(c(e)):void 0}},{key:"isDateField",value:function(e){return this._dateFieldsSet.has(this.get(e))}},{key:"normalizeFieldName",value:function(e){var t=this.get(e);if(t)return t.name}}]),e}();function c(e){return e.toLowerCase().trim()}t.a=s},function(e,t,r){"use strict";r.d(t,"a",(function(){return u}));var n=r(2),i=r(5),a=r(6),o=r(7),s=r(0),c=r(1),l=(r(17),r(18),r(15),r(10)),u=function(e){var t=function(e){Object(a.a)(r,e);var t=Object(o.a)(r);function r(){var e;return Object(n.a)(this,r),(e=t.apply(this,arguments)).refreshInterval=0,e}return Object(i.a)(r,[{key:"refresh",value:function(){this.emit("refresh")}}]),r}(e);return Object(s.a)([Object(c.b)({type:Number,cast:function(e){return e>=.1?e:e<=0?0:.1},json:{write:!0,origins:{"web-document":{write:!0}}}})],t.prototype,"refreshInterval",void 0),t=Object(s.a)([Object(l.a)("esri.layers.mixins.RefreshableLayer")],t)}},function(e,t,r){"use strict";r.r(t),r.d(t,"create",(function(){return u})),r.d(t,"projectGeometry",(function(){return h}));var n=r(8),i=r.n(n),a=r(16),o=r(123),s=r(22),c=r(149),l=r(493);function u(){return d.apply(this,arguments)}function d(){return(d=Object(a.a)(i.a.mark((function e(){var t,n,a,l=arguments;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=l.length>0&&void 0!==l[0]?l[0]:null,n=l.length>1?l[1]:void 0,!o.a.geometryServiceUrl){e.next=9;break}return e.next=6,r.e(20).then(r.bind(null,684));case 6:return e.t0=e.sent.default,e.t1={url:o.a.geometryServiceUrl},e.abrupt("return",new e.t0(e.t1));case 9:if(t){e.next=11;break}throw new s.a("internal:geometry-service-url-not-configured");case 11:return a="portal"in t?t.portal||c.a.getDefault():t,e.next=14,a.load({signal:n});case 14:if(!(a.helperServices&&a.helperServices.geometry&&a.helperServices.geometry.url)){e.next=21;break}return e.next=18,r.e(20).then(r.bind(null,684));case 18:return e.t2=e.sent.default,e.t3={url:a.helperServices.geometry.url},e.abrupt("return",new e.t2(e.t3));case 21:throw new s.a("internal:geometry-service-url-not-configured");case 22:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function h(e,t){return f.apply(this,arguments)}function f(){return(f=Object(a.a)(i.a.mark((function e(t,r){var n,a,o,c,d,h=arguments;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=h.length>2&&void 0!==h[2]?h[2]:null,a=h.length>3?h[3]:void 0,e.next=4,u(n,a);case 4:return o=e.sent,(c=new l.a).geometries=[t],c.outSpatialReference=r,e.next=9,o.project(c,{signal:a});case 9:if(!(d=e.sent)||!Array.isArray(d)||1!==d.length){e.next=12;break}return e.abrupt("return",d[0]);case 12:throw new s.a("internal:geometry-service-projection-failed");case 13:case"end":return e.stop()}}),e)})))).apply(this,arguments)}},function(e,t,r){"use strict";r.d(t,"a",(function(){return m})),r.d(t,"b",(function(){return b})),r.d(t,"c",(function(){return v})),r.d(t,"d",(function(){return y}));var n=r(21),i=r(13),a=r(30),o=r(53),s=r(3),c=r(114),l=["esri.Color","esri.portal.Portal","esri.symbols.support.Symbol3DAnchorPosition2D","esri.symbols.support.Symbol3DAnchorPosition3D"];function u(e){return e instanceof a.a}function d(e){return e instanceof o.a?Object.keys(e.items):u(e)?Object(c.a)(e).keys():e?Object.keys(e):[]}function h(e,t){return e instanceof o.a?e.items[t]:e[t]}function f(e){return e?e.declaredClass:null}function p(e,t){var r=e.diff;if(r&&"function"==typeof r)return r(e,t);var a=d(e),o=d(t);if(0!==a.length||0!==o.length){if(!a.length||!o.length||function(e,t){return!(!Array.isArray(e)||!Array.isArray(t))&&e.length!==t.length}(e,t))return{type:"complete",oldValue:e,newValue:t};var c,b=o.filter((function(e){return-1===a.indexOf(e)})),v=a.filter((function(e){return-1===o.indexOf(e)})),m=a.filter((function(r){return o.indexOf(r)>-1&&h(e,r)!==h(t,r)})).concat(b,v).sort(),y=f(e);if(y&&l.indexOf(y)>-1&&m.length)return{type:"complete",oldValue:e,newValue:t};var g,O=u(e)&&u(t),j=Object(i.a)(m);try{for(j.s();!(g=j.n()).done;){var _=g.value,w=h(e,_),x=h(t,_),k=void 0;(O||"function"!=typeof w&&"function"!=typeof x)&&w!==x&&(null==w&&null==x||(k=r&&r[_]&&"function"==typeof r[_]?r[_](w,x):"object"==typeof w&&"object"==typeof x&&f(w)===f(x)?p(w,x):{type:"complete",oldValue:w,newValue:x},Object(s.j)(k)&&(Object(s.j)(c)?c.diff[_]=k:c={type:"partial",diff:Object(n.a)({},_,k)})))}}catch(S){j.e(S)}finally{j.f()}return c}}function b(e,t){if(Object(s.i)(e))return!1;var r,n=t.split("."),a=e,o=Object(i.a)(n);try{for(o.s();!(r=o.n()).done;){var c=r.value;if("complete"===a.type)return!0;if("partial"!==a.type)return!1;var l=a.diff[c];if(!l)return!1;a=l}}catch(u){o.e(u)}finally{o.f()}return!0}function v(e,t){var r,n=Object(i.a)(t);try{for(n.s();!(r=n.n()).done;){if(b(e,r.value))return!0}}catch(a){n.e(a)}finally{n.f()}return!1}function m(e,t){if("function"!=typeof e&&"function"!=typeof t&&(e||t))return!e||!t||"object"==typeof e&&"object"==typeof t&&f(e)!==f(t)?{type:"complete",oldValue:e,newValue:t}:p(e,t)}function y(e){if(Object(s.i)(e))return!0;switch(e.type){case"complete":return!1;case"collection":var t,r=e,n=Object(i.a)(r.added);try{for(n.s();!(t=n.n()).done;){if(!y(t.value))return!1}}catch(d){n.e(d)}finally{n.f()}var a,o=Object(i.a)(r.removed);try{for(o.s();!(a=o.n()).done;){if(!y(a.value))return!1}}catch(d){o.e(d)}finally{o.f()}var c,l=Object(i.a)(r.changed);try{for(l.s();!(c=l.n()).done;){if(!y(c.value))return!1}}catch(d){l.e(d)}finally{l.f()}return!0;case"partial":for(var u in e.diff)if(!y(e.diff[u]))return!1;return!0}}},function(e,t,r){"use strict";r.d(t,"a",(function(){return d}));var n=r(272),i=r(103),a=r(288),o=(r(181),r(423),r(263)),s=(r(302),r(259),r(289)),c=r(338),l=["oid","global-id"],u=["oid","global-id","guid"];function d(e,t){var r=e.displayField,s=e.editFieldsInfo,c=e.fields,l=e.objectIdField,u=e.title;if(!c)return null;var d=m({editFieldsInfo:s,fields:c,objectIdField:l},t);if(!d.length)return null;var h=function(e){var t=Object(i.l)(e),r=e.titleBase;return t?"".concat(r,": {").concat(t.trim(),"}"):r}({titleBase:u,fields:c,displayField:r}),f=[new o.a,new a.a];return new n.a({title:h,content:f,fieldInfos:d})}var h=[/^fnode_$/i,/^tnode_$/i,/^lpoly_$/i,/^rpoly_$/i,/^poly_$/i,/^subclass$/i,/^subclass_$/i,/^rings_ok$/i,/^rings_nok$/i,/shape/i,/perimeter/i,/objectid/i,/_i$/i],f=function(e,t){var r=t.editFieldsInfo,n=t.objectIdField,i=t.visibleFieldNames;return i?i.has(e.name):!b(e.name,r)&&(!n||e.name!==n)&&!(l.indexOf(e.type)>-1)&&!h.some((function(t){return t.test(e.name)}))};function p(e,t){return"oid"===e.type?-1:"oid"===t.type?1:g(e)?-1:g(t)?1:(e.alias||e.name).toLocaleLowerCase().localeCompare((t.alias||t.name).toLocaleLowerCase())}function b(e,t){if(!e||!t)return!1;var r=t.creationDateField,n=t.creatorField,i=t.editDateField,a=t.editorField;return-1!==[r&&r.toLowerCase(),n&&n.toLowerCase(),i&&i.toLowerCase(),a&&a.toLowerCase()].indexOf(e.toLowerCase())}function v(e,t){return e.editable&&-1===u.indexOf(e.type)&&!b(e.name,t)}function m(e,t){var r=e.editFieldsInfo,n=e.fields,i=e.objectIdField;return function(e,t){var r=e;return t&&(e=e.filter((function(e){return-1===t.indexOf(e.type)}))),e===r&&(e=e.slice()),e.sort(p),e}(n,(null==t?void 0:t.ignoreFieldTypes)||O).map((function(e){return new s.a({fieldName:e.name,isEditable:v(e,r),label:e.alias,format:y(e),visible:f(e,{editFieldsInfo:r,objectIdField:i,visibleFieldNames:null==t?void 0:t.visibleFieldNames})})}))}function y(e){switch(e.type){case"small-integer":case"integer":case"single":return new c.a({digitSeparator:!0,places:0});case"double":return new c.a({digitSeparator:!0,places:2});case"date":return new c.a({dateFormat:"long-month-day-year"});default:return null}}function g(e){return"name"===(e.name&&e.name.toLowerCase())||("name"===(e.alias&&e.alias.toLowerCase())||void 0)}var O=["geometry","blob","raster","guid","xml"]},function(e,t,r){"use strict";r.d(t,"a",(function(){return f}));var n=r(2),i=r(5),a=r(6),o=r(7),s=r(0),c=r(15),l=r(3),u=r(1),d=(r(17),r(18),r(10)),h=r(255),f=function(e){var t=function(e){Object(a.a)(r,e);var t=Object(o.a)(r);function r(){return Object(n.a)(this,r),t.apply(this,arguments)}return Object(i.a)(r,[{key:"title",get:function(){if(this._get("title")&&"defaults"!==this.originOf("title"))return this._get("title");if(this.url){var e=Object(h.e)(this.url);if(Object(l.j)(e)&&e.title)return e.title}return this._get("title")||""},set:function(e){this._set("title",e)}},{key:"url",set:function(e){this._set("url",Object(h.g)(e,c.a.getLogger(this.declaredClass)))}}]),r}(e);return Object(s.a)([Object(u.b)()],t.prototype,"title",null),Object(s.a)([Object(u.b)({type:String})],t.prototype,"url",null),t=Object(s.a)([Object(d.a)("esri.layers.mixins.ArcGISService")],t)}},function(e,t,r){"use strict";var n=r(33),i=r(2),a=r(5),o=r(117),s=function(){function e(t,r,n,a){Object(i.a)(this,e),this.set(t,r,n,a)}return Object(a.a)(e,[{key:"key",get:function(){return this}},{key:"id",get:function(){return this.toString()},set:function(e){this.set(e)}},{key:"acquire",value:function(e,t,r,n){this.set(e,t,r,n)}},{key:"contains",value:function(e){var t=e.level-this.level;return this.row===e.row>>t&&this.col===e.col>>t&&this.world===e.world}},{key:"equals",value:function(e){return this.level===e.level&&this.row===e.row&&this.col===e.col&&this.world===e.world}},{key:"clone",value:function(){return new e(this)}},{key:"release",value:function(){this.level=0,this.row=0,this.col=0,this.world=0}},{key:"set",value:function(e,t,r,i){if(null==e)this.level=0,this.row=0,this.col=0,this.world=0;else if("object"==typeof e)this.level=e.level||0,this.row=e.row||0,this.col=e.col||0,this.world=e.world||0;else if("string"==typeof e){var a=e.split("/"),o=Object(n.a)(a,4),s=o[0],c=o[1],l=o[2],u=o[3];this.level=parseFloat(s),this.row=parseFloat(c),this.col=parseFloat(l),this.world=parseFloat(u)}else this.level=+e,this.row=+t,this.col=+r,this.world=+i||0;return this}},{key:"toString",value:function(){return"".concat(this.level,"/").concat(this.row,"/").concat(this.col,"/").concat(this.world)}},{key:"getParentKey",value:function(){return this.level<=0?null:new e(this.level-1,this.row>>1,this.col>>1,this.world)}},{key:"getChildKeys",value:function(){var t=this.level+1,r=this.row<<1,n=this.col<<1,i=this.world;return[new e(t,r,n,i),new e(t,r,n+1,i),new e(t,r+1,n,i),new e(t,r+1,n+1,i)]}},{key:"compareRowMajor",value:function(e){return this.row<e.row?-1:this.row>e.row?1:this.col<e.col?-1:this.col>e.col?1:0}}],[{key:"getId",value:function(e,t,r,n){return"object"==typeof e?"".concat(e.level,"/").concat(e.row,"/").concat(e.col,"/").concat(e.world):"".concat(e,"/").concat(t,"/").concat(r,"/").concat(n)}}]),e}();s.pool=new o.a(s,null,null,25,50),t.a=s},function(e,t,r){"use strict";r.d(t,"a",(function(){return l}));var n=r(13),i=r(15),a=r(314),o=r(574),s=r(103),c=i.a.getLogger("esri.layers.support.fieldProperties");function l(){return{fields:{type:[a.a],value:null},fieldsIndex:{readOnly:!0,get:function(){return new o.a(this.fields||[])}},outFields:{type:[String],json:{read:!1},set:function(e){this._userOutFields=e,this.notifyChange("outFields")},get:function(){var e=this._userOutFields;if(!e||!e.length)return null;if(e.includes("*"))return["*"];if(!this.fields)return e;var t,r=Object(n.a)(e);try{for(r.s();!(t=r.n()).done;){var i=t.value;this.fieldsIndex.has(i)||c.error("field-attributes-layer:invalid-field","Invalid field ".concat(i," found in outFields"),{layer:this,outFields:e})}}catch(a){r.e(a)}finally{r.f()}return Object(s.i)(this.fieldsIndex,e)}}}}},function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var n=r(71);function i(){var e=a.getRandomValues(new Uint16Array(8));e[3]=4095&e[3]|16384,e[4]=16383&e[4]|32768;var t=function(t){return e[t].toString(16)};return t(0)+t(1)+"-"+t(2)+"-"+t(3)+"-"+t(4)+"-"+t(5)+t(6)+t(7)}var a=n.a.crypto||n.a.msCrypto},function(e,t,r){"use strict";var n,i=r(2),a=r(5),o=r(6),s=r(7),c=r(0),l=(r(126),r(58)),u=r(27),d=r(25),h=r(1),f=(r(18),r(17),r(15),r(10)),p=r(66),b=new l.a({upperLeft:"upper-left",lowerLeft:"lower-left"}),v=n=function(e){Object(o.a)(r,e);var t=Object(s.a)(r);function r(e){var n;return Object(i.a)(this,r),(n=t.call(this,e)).extent=null,n.mode="view",n.originPosition="upper-left",n.tolerance=1,n}return Object(a.a)(r,[{key:"clone",value:function(){return new n(Object(d.a)({extent:this.extent,mode:this.mode,originPosition:this.originPosition,tolerance:this.tolerance}))}}]),r}(u.a);Object(c.a)([Object(h.b)({type:p.a,json:{write:{overridePolicy:function(){return{enabled:"view"===this.mode}}}}})],v.prototype,"extent",void 0),Object(c.a)([Object(h.b)({type:["view","edit"],json:{write:!0}})],v.prototype,"mode",void 0),Object(c.a)([Object(h.b)({type:String,json:{read:b.read,write:b.write}})],v.prototype,"originPosition",void 0),Object(c.a)([Object(h.b)({type:Number,json:{write:{overridePolicy:function(){return{enabled:"view"===this.mode}}}}})],v.prototype,"tolerance",void 0);var m=v=n=Object(c.a)([Object(f.a)("esri.rest.support.QuantizationParameters")],v);t.a=m},function(e,t,r){"use strict";r.d(t,"a",(function(){return u}));var n=r(2),i=r(5),a=r(6),o=r(7),s=r(0),c=r(1),l=(r(17),r(18),r(15),r(10));var u=function(e){var t=function(e){Object(a.a)(r,e);var t=Object(o.a)(r);function r(){return Object(n.a)(this,r),t.apply(this,arguments)}return Object(i.a)(r,[{key:"apiKey",get:function(){var e;return this._isOverridden("apiKey")?this._get("apiKey"):function(e){return"portalItem"in e}(this)?null==(e=this.portalItem)?void 0:e.apiKey:null},set:function(e){null!=e?this._override("apiKey",e):(this._clearOverride("apiKey"),this.clear("apiKey","user"))}}]),r}(e);return Object(s.a)([Object(c.b)({type:String})],t.prototype,"apiKey",null),t=Object(s.a)([Object(l.a)("esri.layers.mixins.APIKeyMixin")],t)}},function(e,t,r){"use strict";r.d(t,"a",(function(){return d}));r(17);var n=r(3);function i(e,t){if(e===t)return!0;if(null==e||null==t)return!1;if(e.length!==t.length)return!1;for(var r=0;r<e.length;r++){var n=e[r],i=t[r];if(n.length!==i.length)return!1;for(var a=0;a<n.length;a++)if(n[a]!==i[a])return!1}return!0}function a(e,t){if(e===t)return!0;if(null==e||null==t)return!1;if(e.length!==t.length)return!1;for(var r=0;r<e.length;r++)if(!i(e[r],t[r]))return!1;return!0}function o(e,t){return e.hasZ===t.hasZ&&e.hasM===t.hasM&&!!l(e.spatialReference,t.spatialReference)&&a(e.paths,t.paths)}function s(e,t){return e.hasZ===t.hasZ&&e.hasM===t.hasM&&!!l(e.spatialReference,t.spatialReference)&&a(e.rings,t.rings)}function c(e,t){return e.hasZ===t.hasZ&&e.hasM===t.hasM&&!!l(e.spatialReference,t.spatialReference)&&i(e.points,t.points)}function l(e,t){return e===t||e&&t&&e.equals(t)}function u(e,t){if(e===t)return!0;if(Object(n.i)(e)||Object(n.i)(t))return!1;if(e.type!==t.type)return!1;switch(e.type){case"point":return function(e,t){return!!l(e.spatialReference,t.spatialReference)&&e.x===t.x&&e.y===t.y&&e.z===t.z&&e.m===t.m}(e,t);case"extent":return function(e,t){return e.hasZ===t.hasZ&&e.hasM===t.hasM&&!!l(e.spatialReference,t.spatialReference)&&e.xmin===t.xmin&&e.ymin===t.ymin&&e.zmin===t.zmin&&e.xmax===t.xmax&&e.ymax===t.ymax&&e.zmax===t.zmax}(e,t);case"polyline":return o(e,t);case"polygon":return s(e,t);case"multipoint":return c(e,t);case"mesh":return!1;default:return}}function d(e,t){return e===t||null!=e&&null!=t&&e.objectId===t.objectId&&!!u(e.geometry,t.geometry)&&!!function(e,t){if(e===t)return!0;if(!e||!t)return!1;var r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(var i=0,a=r;i<a.length;i++){var o=a[i];if(e[o]!==t[o])return!1}return!0}(e.attributes,t.attributes)}},function(e,t,r){"use strict";var n,i=r(2),a=r(5),o=r(45),s=r(42),c=r(6),l=r(7),u=r(0),d=r(58),h=r(27),f=r(3),p=r(1),b=(r(17),r(18),r(15),r(48)),v=r(10),m=r(44),y=r(8),g=r.n(y),O=r(16),j=r(103),_=n=function(e){Object(c.a)(r,e);var t=Object(l.a)(r);function r(){return Object(i.a)(this,r),t.apply(this,arguments)}return Object(a.a)(r,[{key:"collectRequiredFields",value:function(){var e=Object(O.a)(g.a.mark((function e(t,r){return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Object(j.a)(t,r,this.expression));case 1:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"clone",value:function(){return new n({expression:this.expression,title:this.title})}}]),r}(h.a);Object(u.a)([Object(p.b)({type:String,json:{write:!0}})],_.prototype,"expression",void 0),Object(u.a)([Object(p.b)({type:String,json:{write:!0}})],_.prototype,"title",void 0);var w,x=_=n=Object(u.a)([Object(v.a)("esri.layers.support.FeatureExpressionInfo")],_),k=r(421),S=Object(d.b)()({onTheGround:"on-the-ground",relativeToGround:"relative-to-ground",relativeToScene:"relative-to-scene",absoluteHeight:"absolute-height"}),T=new d.a({foot:"feet",kilometer:"kilometers",meter:"meters",mile:"miles","us-foot":"us-feet",yard:"yards"}),C=w=function(e){Object(c.a)(r,e);var t=Object(l.a)(r);function r(){var e;return Object(i.a)(this,r),(e=t.apply(this,arguments)).offset=null,e}return Object(a.a)(r,[{key:"readFeatureExpressionInfo",value:function(e,t){return null!=e?e:t.featureExpression&&0===t.featureExpression.value?{expression:"0"}:void 0}},{key:"writeFeatureExpressionInfo",value:function(e,t,r,n){t[r]=e.write(null,n),"0"===e.expression&&(t.featureExpression={value:0})}},{key:"mode",get:function(){var e=this.offset,t=this.featureExpressionInfo;return this._isOverridden("mode")?this._get("mode"):Object(f.j)(e)||t?"relative-to-ground":"on-the-ground"},set:function(e){this._override("mode",e)}},{key:"unit",set:function(e){this._set("unit",e)}},{key:"write",value:function(e,t){return this.offset||this.mode||this.featureExpressionInfo||this.unit?Object(o.a)(Object(s.a)(r.prototype),"write",this).call(this,e,t):null}},{key:"clone",value:function(){return new w({mode:this.mode,offset:this.offset,featureExpressionInfo:this.featureExpressionInfo?this.featureExpressionInfo.clone():void 0,unit:this.unit})}}]),r}(h.a);Object(u.a)([Object(p.b)({type:x,json:{write:!0}})],C.prototype,"featureExpressionInfo",void 0),Object(u.a)([Object(b.a)("featureExpressionInfo",["featureExpressionInfo","featureExpression"])],C.prototype,"readFeatureExpressionInfo",null),Object(u.a)([Object(m.a)("featureExpressionInfo",{featureExpressionInfo:{type:x},"featureExpression.value":{type:[0]}})],C.prototype,"writeFeatureExpressionInfo",null),Object(u.a)([Object(p.b)({type:S.apiValues,nonNullable:!0,json:{type:S.jsonValues,read:S.read,write:{writer:S.write,isRequired:!0}}})],C.prototype,"mode",null),Object(u.a)([Object(p.b)({type:Number,json:{write:!0}})],C.prototype,"offset",void 0),Object(u.a)([Object(p.b)({type:k.b,json:{type:String,read:T.read,write:T.write}})],C.prototype,"unit",null);var M=C=w=Object(u.a)([Object(v.a)("esri.layers.support.ElevationInfo")],C);t.a=M},function(e,t,r){"use strict";var n=r(14),i=r(2),a=r(5),o=r(6),s=r(7),c=r(0),l=r(30),u=r(39),d=r(1),h=(r(17),r(18),r(15),r(10)),f=function(e){Object(o.a)(r,e);var t=Object(s.a)(r);function r(){var e;Object(i.a)(this,r);for(var n=arguments.length,a=new Array(n),o=0;o<n;o++)a[o]=arguments[o];return(e=t.call.apply(t,[this].concat(a))).requestOptions=null,e.url=null,e}return Object(a.a)(r,[{key:"normalizeCtorArgs",value:function(e,t){return"string"!=typeof e?e:Object(n.a)({url:e},t)}},{key:"parsedUrl",get:function(){return this._parseUrl(this.url)}},{key:"_parseUrl",value:function(e){return e?Object(u.K)(e):null}},{key:"_encode",value:function(e,t,r){var n={};for(var i in e)if("declaredClass"!==i){var a=e[i];if(null!=a&&"function"!=typeof a)if(Array.isArray(a)){n[i]=[];for(var o=0;o<a.length;o++)n[i][o]=this._encode(a[o])}else if("object"==typeof a)if(a.toJSON){var s=a.toJSON(r&&r[i]);n[i]=t?s:JSON.stringify(s)}else n[i]=t?a:JSON.stringify(a);else n[i]=a}return n}}]),r}(l.a);Object(c.a)([Object(d.b)({readOnly:!0})],f.prototype,"parsedUrl",null),Object(c.a)([Object(d.b)()],f.prototype,"requestOptions",void 0),Object(c.a)([Object(d.b)({type:String})],f.prototype,"url",void 0);var p=f=Object(c.a)([Object(h.a)("esri.tasks.Task")],f);t.a=p},function(e,t,r){"use strict";var n=r(2),i=r(5),a=r(346),o=function(){function e(t,r){Object(n.a)(this,e),this._storage=new a.c,this._storage.maxSize=t,r&&this._storage.registerRemoveFunc("",r)}return Object(i.a)(e,[{key:"put",value:function(e,t,r){this._storage.put(e,t,r,1)}},{key:"pop",value:function(e){return this._storage.pop(e)}},{key:"get",value:function(e){return this._storage.get(e)}},{key:"clear",value:function(){this._storage.clearAll()}},{key:"destroy",value:function(){this._storage.destroy()}},{key:"maxSize",get:function(){return this._storage.maxSize},set:function(e){this._storage.maxSize=e}}]),e}();t.a=o},function(e,t,r){"use strict";r.d(t,"a",(function(){return l}));var n=r(2),i=r(6),a=r(7),o=r(0),s=r(1),c=(r(17),r(18),r(15),r(10)),l=function(e){var t=function(e){Object(i.a)(r,e);var t=Object(a.a)(r);function r(){var e;return Object(n.a)(this,r),(e=t.apply(this,arguments)).customParameters=null,e}return r}(e);return Object(o.a)([Object(s.b)({type:Object,json:{write:!0}})],t.prototype,"customParameters",void 0),t=Object(o.a)([Object(c.a)("esri.layers.mixins.CustomParametersMixin")],t)}},function(e,t,r){"use strict";r.d(t,"a",(function(){return v}));var n=r(2),i=r(5),a=r(6),o=r(7),s=r(0),c=r(232),l=r(365),u=r(1),d=(r(17),r(18),r(15),r(48)),h=r(10),f=r(496),p=r(103),b=r(297);var v=function(e){var t=function(e){Object(a.a)(r,e);var t=Object(o.a)(r);function r(){var e;return Object(n.a)(this,r),(e=t.apply(this,arguments)).timeExtent=null,e.timeOffset=null,e.useViewTime=!0,e}return Object(i.a)(r,[{key:"readOffset",value:function(e,t){var r=t.timeInfo.exportOptions;if(!r)return null;var n=r.timeOffset,i=b.a.fromJSON(r.timeOffsetUnits);return n&&i?new l.a({value:n,unit:i}):null}},{key:"timeInfo",set:function(e){Object(p.k)(e,this.fieldsIndex),this._set("timeInfo",e)}}]),r}(e);return Object(s.a)([Object(u.b)({type:c.a,json:{write:!1}})],t.prototype,"timeExtent",void 0),Object(s.a)([Object(u.b)({type:l.a})],t.prototype,"timeOffset",void 0),Object(s.a)([Object(d.a)("service","timeOffset",["timeInfo.exportOptions"])],t.prototype,"readOffset",null),Object(s.a)([Object(u.b)({value:null,type:f.a,json:{write:!0,origins:{"web-document":{read:!1,write:!1}}}})],t.prototype,"timeInfo",null),Object(s.a)([Object(u.b)({type:Boolean,json:{read:{source:"timeAnimation"},write:{target:"timeAnimation"},origins:{"web-scene":{read:!1,write:!1}}}})],t.prototype,"useViewTime",void 0),t=Object(s.a)([Object(h.a)("esri.layers.mixins.TemporalLayer")],t),t}},function(e,t,r){"use strict";var n=r(13),i=r(2),a=r(5),o=r(23),s=function(){function e(){Object(i.a)(this,e),this._tasks=new Array}return Object(a.a)(e,[{key:"length",get:function(){return this._tasks.length}},{key:"push",value:function(e,t,r){var n=this;return new Promise((function(i,a){return n._tasks.push(new c(i,a,e,t,r))}))}},{key:"unshift",value:function(e,t,r){var n=this;return new Promise((function(i,a){return n._tasks.unshift(new c(i,a,e,t,r))}))}},{key:"process",value:function(){if(0===this._tasks.length)return!1;var e=this._tasks.shift();try{var t=Object(o.o)(e.signal);if(t&&!e.abortCallback)e.reject(Object(o.f)());else{var r=t?e.abortCallback(Object(o.f)()):e.callback();Object(o.p)(r)?r.then(e.resolve,e.reject):e.resolve(r)}}catch(c){e.reject(c)}return!0}},{key:"cancelAll",value:function(){var e,t=Object(o.f)(),r=Object(n.a)(this._tasks);try{for(r.s();!(e=r.n()).done;){var i=e.value;if(i.abortCallback){var a=i.abortCallback(t);i.resolve(a)}else i.reject(t)}}catch(s){r.e(s)}finally{r.f()}this._tasks.length=0}}]),e}(),c=function e(t,r,n,a,o){Object(i.a)(this,e),this.resolve=t,this.reject=r,this.callback=n,this.signal=a,this.abortCallback=o};t.a=s},function(e,t,r){"use strict";function n(){var e=new Float32Array(6);return e[0]=1,e[3]=1,e}function i(e,t,r,n){var i=t[n],a=t[n+1];e[n]=r[0]*i+r[2]*a+r[4],e[n+1]=r[1]*i+r[3]*a+r[5]}function a(e,t,r){for(var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:2,s=a||t.length/o,c=n;c<s;c++)i(e,t,r,c*o)}r.d(t,"a",(function(){return n})),r.d(t,"b",(function(){return a}));Object.freeze({__proto__:null,create:n,clone:function(e){var t=new Float32Array(6);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t},fromValues:function(e,t,r,n,i,a){var o=new Float32Array(6);return o[0]=e,o[1]=t,o[2]=r,o[3]=n,o[4]=i,o[5]=a,o},createView:function(e,t){return new Float32Array(e,t,6)},transform:i,transformMany:a})},function(e,t,r){"use strict";var n,i=r(2),a=r(5),o=r(6),s=r(7),c=r(0),l=r(27),u=r(1),d=(r(17),r(18)),h=(r(15),r(10)),f=n=function(e){Object(o.a)(r,e);var t=Object(s.a)(r);function r(e){var n;return Object(i.a)(this,r),(n=t.call(this,e)).level=0,n.levelValue=null,n.resolution=0,n.scale=0,n}return Object(a.a)(r,[{key:"clone",value:function(){return new n({level:this.level,levelValue:this.levelValue,resolution:this.resolution,scale:this.scale})}}]),r}(l.a);Object(c.a)([Object(u.b)({type:d.a,json:{write:!0}})],f.prototype,"level",void 0),Object(c.a)([Object(u.b)({type:String,json:{write:!0}})],f.prototype,"levelValue",void 0),Object(c.a)([Object(u.b)({type:Number,json:{write:!0}})],f.prototype,"resolution",void 0),Object(c.a)([Object(u.b)({type:Number,json:{write:!0}})],f.prototype,"scale",void 0);var p=f=n=Object(c.a)([Object(h.a)("esri.layers.support.LOD")],f);t.a=p},function(e,t,r){"use strict";r.d(t,"a",(function(){return l}));var n=r(8),i=r.n(n),a=r(16),o=r(128),s=r(23),c=r(192);function l(e,t,r){return u.apply(this,arguments)}function u(){return(u=Object(a.a)(i.a.mark((function e(t,r,n){var a,l,u;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(a=t&&t.getAtOrigin&&t.getAtOrigin("renderer",r.origin))||"unique-value"!==a.type||!a.styleOrigin){e.next=6;break}return e.next=4,Object(o.d)(a.populateFromStyle());case 4:l=e.sent,Object(s.x)(n),!1===l.ok&&(u=l.error,r&&r.messages&&r.messages.push(new c.a("renderer:style-reference","Failed to create unique value renderer from style reference: ".concat(u.message),{error:u,context:r})),t.clear("renderer",r.origin));case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}},function(e,t,r){"use strict";r.d(t,"a",(function(){return p}));var n=r(2),i=r(5),a=r(6),o=r(7),s=r(0),c=r(22),l=r(35),u=r(1),d=(r(17),r(18),r(15),r(10)),h=r(416),f=r(78),p=function(e){var t=function(e){Object(a.a)(r,e);var t=Object(o.a)(r);function r(){return Object(n.a)(this,r),t.apply(this,arguments)}return Object(i.a)(r,[{key:"imageFormatIsOpaque",get:function(){return!1}},{key:"isOpaque",get:function(){return this.fullOpacity>=1&&this.imageFormatIsOpaque}},{key:"dataLevelRange",get:function(){var e=this.tileInfo.lods,t=e[0].scale,r=e[e.length-1].scale;return this.levelRangeFromScaleRange(t,r)}},{key:"displayLevelRange",get:function(){var e=this.tileInfo.lods,t=this.layer.minScale||e[0].scale,r=this.layer.maxScale||e[e.length-1].scale,n=this.levelRangeFromScaleRange(t,r);return this.layer.maxScale&&n.maxLevel++,n}},{key:"getTileUrl",value:function(e,t,r){return this.layer.getTileUrl(e,t,r)}},{key:"_addTilingSchemeMatchPromise",value:function(){var e=this,t=this._getTileInfoSupportError(this.tileInfo,this.layer.fullExtent);if(t)this.addResolvingPromise(Promise.reject(t));else{var r=Object(l.l)(this.view,"basemapTerrain.tilingSchemeLocked").then((function(){var t=e.view.basemapTerrain.tilingScheme,r=e._getTileInfoCompatibilityError(e.tileInfo,t);if(r)throw r}));this.addResolvingPromise(r)}}},{key:"_getTileInfoSupportError",value:function(e,t){var r=Object(f.a)(e,t,this.view.spatialReference,this.view.state.viewingMode);if(r){var n,i={layer:this.layer,error:r};switch(r.name){case"tilingscheme:local-gcs-not-supported":n=new c.a("layerview:local-gcs-not-supported","Geographic coordinate systems are not supported in local scenes",i);break;case"tilingscheme:spatial-reference-mismatch":case"tilingscheme:global-unsupported-spatial-reference":n=new c.a("layerview:spatial-reference-incompatible","The spatial reference of this layer does not meet the requirements of the view",i);break;default:n=new c.a("layerview:tiling-scheme-unsupported","The tiling scheme of this layer is not supported by SceneView",i)}return n}return null}},{key:"_getTileInfoCompatibilityError",value:function(e,t){return t.compatibleWith(e)?null:new c.a("layerview:tiling-scheme-incompatible","The tiling scheme of this layer is incompatible with the tiling scheme of the surface")}},{key:"levelRangeFromScaleRange",value:function(e,t){var r={minLevel:0,maxLevel:1/0},n=this.view&&this.view.basemapTerrain&&this.view.basemapTerrain.tilingScheme;if(!n)return r;var i=n.levels[0],a=function(e){var t=Math.log(i.scale/e)/Math.LN2;return.5-Math.abs(.5-t%1)<1e-9?Math.round(t):Math.ceil(t)};return null!=e&&e>0&&(r.minLevel=Math.max(0,a(e))),null!=t&&t>0&&(r.maxLevel=Math.max(0,a(t))),r}},{key:"isUpdating",value:function(){return!!(this.view&&this.view.basemapTerrain&&this.view.basemapTerrain.updating)}}]),r}(e);return Object(s.a)([Object(u.b)({readOnly:!0})],t.prototype,"imageFormatIsOpaque",null),Object(s.a)([Object(u.b)({readOnly:!0})],t.prototype,"updating",void 0),Object(s.a)([Object(u.b)(h.a)],t.prototype,"updatingProgress",void 0),Object(s.a)([Object(u.b)(h.b)],t.prototype,"updatingProgressValue",void 0),Object(s.a)([Object(u.b)({readOnly:!0})],t.prototype,"fullExtent",void 0),Object(s.a)([Object(u.b)({readOnly:!0})],t.prototype,"isOpaque",null),Object(s.a)([Object(u.b)({readOnly:!0})],t.prototype,"dataLevelRange",null),Object(s.a)([Object(u.b)({readOnly:!0})],t.prototype,"displayLevelRange",null),Object(s.a)([Object(u.b)()],t.prototype,"layer",void 0),Object(s.a)([Object(u.b)({readOnly:!0})],t.prototype,"tileInfo",void 0),t=Object(s.a)([Object(d.a)("esri.views.3d.layers.TiledLayerView3D")],t)}},function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));var n=new(r(58).a)({esriFieldTypeSmallInteger:"small-integer",esriFieldTypeInteger:"integer",esriFieldTypeSingle:"single",esriFieldTypeDouble:"double",esriFieldTypeLong:"long",esriFieldTypeString:"string",esriFieldTypeDate:"date",esriFieldTypeOID:"oid",esriFieldTypeGeometry:"geometry",esriFieldTypeBlob:"blob",esriFieldTypeRaster:"raster",esriFieldTypeGUID:"guid",esriFieldTypeGlobalID:"global-id",esriFieldTypeXML:"xml"})},function(e,t,r){"use strict";var n=r(2),i=r(5),a=r(17),o=r(117),s=4294967296,c=Object(a.a)("esri-text-decoder")?new TextDecoder("utf-8"):null,l=Object(a.a)("safari")||Object(a.a)("ios")?6:Object(a.a)("ff")?12:32,u=function(){function e(t,r){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:t?t.byteLength:0;Object(n.a)(this,e),this._tag=0,this._dataType=99,this.init(t,r,i,a)}return Object(i.a)(e,[{key:"init",value:function(e,t,r,n){this._data=e,this._dataView=t,this._pos=r,this._end=n}},{key:"clone",value:function(){return new e(this._data,this._dataView,this._pos,this._end)}},{key:"pos",value:function(){return this._pos}},{key:"move",value:function(e){this._pos=e}},{key:"nextTag",value:function(e){for(;;){if(this._pos===this._end)return!1;var t=this._decodeVarint();if(this._tag=t>>3,this._dataType=7&t,!e||e===this._tag)break;this.skip()}return!0}},{key:"next",value:function(){if(this._pos===this._end)return!1;var e=this._decodeVarint();return this._tag=e>>3,this._dataType=7&e,!0}},{key:"empty",value:function(){return this._pos>=this._end}},{key:"tag",value:function(){return this._tag}},{key:"getInt32",value:function(){return this._decodeVarint()}},{key:"getInt64",value:function(){return this._decodeVarint()}},{key:"getUInt32",value:function(){var e=4294967295;return e=(127&this._data[this._pos])>>>0,this._data[this._pos++]<128?e:(e=(e|(127&this._data[this._pos])<<7)>>>0,this._data[this._pos++]<128?e:(e=(e|(127&this._data[this._pos])<<14)>>>0,this._data[this._pos++]<128?e:(e=(e|(127&this._data[this._pos])<<21)>>>0,this._data[this._pos++]<128?e:(e=(e|(15&this._data[this._pos])<<28)>>>0,this._data[this._pos++]<128?e:void 0))))}},{key:"getUInt64",value:function(){return this._decodeVarint()}},{key:"getSInt32",value:function(){var e=this.getUInt32();return e>>>1^-(1&e)|0}},{key:"getSInt64",value:function(){return this._decodeSVarint()}},{key:"getBool",value:function(){var e=0!==this._data[this._pos];return this._skip(1),e}},{key:"getEnum",value:function(){return this._decodeVarint()}},{key:"getFixed64",value:function(){var e=this._dataView,t=this._pos,r=e.getUint32(t,!0)+e.getUint32(t+4,!0)*s;return this._skip(8),r}},{key:"getSFixed64",value:function(){var e=this._dataView,t=this._pos,r=e.getUint32(t,!0)+e.getInt32(t+4,!0)*s;return this._skip(8),r}},{key:"getDouble",value:function(){var e=this._dataView.getFloat64(this._pos,!0);return this._skip(8),e}},{key:"getFixed32",value:function(){var e=this._dataView.getUint32(this._pos,!0);return this._skip(4),e}},{key:"getSFixed32",value:function(){var e=this._dataView.getInt32(this._pos,!0);return this._skip(4),e}},{key:"getFloat",value:function(){var e=this._dataView.getFloat32(this._pos,!0);return this._skip(4),e}},{key:"getString",value:function(){var e=this._getLength(),t=this._pos,r=this._toString(this._data,t,t+e);return this._skip(e),r}},{key:"getBytes",value:function(){var e=this._getLength(),t=this._pos,r=this._toBytes(this._data,t,t+e);return this._skip(e),r}},{key:"getLength",value:function(){return this._getLengthUnsafe()}},{key:"processMessageWithArgs",value:function(e,t,r,n){var i=this.getMessage(),a=e(i,t,r,n);return i.release(),a}},{key:"processMessage",value:function(e){var t=this.getMessage(),r=e(t);return t.release(),r}},{key:"getMessage",value:function(){var t=this._getLength(),r=e.pool.acquire();return r.init(this._data,this._dataView,this._pos,this._pos+t),this._skip(t),r}},{key:"release",value:function(){e.pool.release(this)}},{key:"dataType",value:function(){return this._dataType}},{key:"skip",value:function(){switch(this._dataType){case 0:this._decodeVarint();break;case 1:this._skip(8);break;case 2:this._skip(this._getLength());break;case 5:this._skip(4);break;default:throw new Error("Invalid data type!")}}},{key:"skipLen",value:function(e){this._skip(e)}},{key:"_skip",value:function(e){if(this._pos+e>this._end)throw new Error("Attempt to skip past the end of buffer!");this._pos+=e}},{key:"_decodeVarint",value:function(){var e,t=this._data,r=this._pos,n=0;if(this._end-r>=10)do{if(n|=127&(e=t[r++]),0==(128&e))break;if(n|=(127&(e=t[r++]))<<7,0==(128&e))break;if(n|=(127&(e=t[r++]))<<14,0==(128&e))break;if(n|=(127&(e=t[r++]))<<21,0==(128&e))break;if(n+=268435456*(127&(e=t[r++])),0==(128&e))break;if(n+=34359738368*(127&(e=t[r++])),0==(128&e))break;if(n+=4398046511104*(127&(e=t[r++])),0==(128&e))break;if(n+=562949953421312*(127&(e=t[r++])),0==(128&e))break;if(n+=72057594037927940*(127&(e=t[r++])),0==(128&e))break;if(n+=0x8000000000000000*(127&(e=t[r++])),0==(128&e))break;throw new Error("Varint too long!")}while(0);else{for(var i=1;r!==this._end&&0!=(128&(e=t[r]));)++r,n+=(127&e)*i,i*=128;if(r===this._end)throw new Error("Varint overrun!");++r,n+=e*i}return this._pos=r,n}},{key:"_decodeSVarint",value:function(){var e=this._decodeVarint();return e%2?-(e+1)/2:e/2}},{key:"_getLength",value:function(){if(2!==this._dataType)throw new Error("Not a delimited data type!");return this._decodeVarint()}},{key:"_getLengthUnsafe",value:function(){return this.getUInt32()}},{key:"_toString",value:function(e,t,r){if((r=Math.min(this._end,r))-t>l&&c){var n=e.subarray(t,r);return c.decode(n)}for(var i="",a="",o=t;o<r;++o){var s=e[o];128&s?a+="%"+s.toString(16):(i+=decodeURIComponent(a)+String.fromCharCode(s),a="")}return a.length&&(i+=decodeURIComponent(a)),i}},{key:"_toBytes",value:function(e,t,r){return r=Math.min(this._end,r),new Uint8Array(e.buffer,t,r-t)}}]),e}();u.pool=new o.a(u,null,(function(e){e._data=null,e._dataView=null})),t.a=u},function(e,t,r){"use strict";var n=r(2),i=r(5),a=r(346),o=function(){function e(t,r){Object(n.a)(this,e),this._storage=new a.c,this._storage.maxSize=t,r&&this._storage.registerRemoveFunc("",r)}return Object(i.a)(e,[{key:"put",value:function(e,t){this._storage.put(e,t,1,1)}},{key:"pop",value:function(e){return this._storage.pop(e)}},{key:"get",value:function(e){return this._storage.get(e)}},{key:"clear",value:function(){this._storage.clearAll()}},{key:"destroy",value:function(){this._storage.destroy()}}]),e}();t.a=o},function(e,t,r){"use strict";var n,i=r(2),a=r(5),o=r(6),s=r(7),c=r(0),l=r(27),u=r(25),d=r(15),h=r(1),f=r(64),p=(r(17),r(10)),b=r(18),v=r(442),m=r(478),y=r(600),g=d.a.getLogger("esri.geometry.support.MeshComponent"),O=n=function(e){Object(o.a)(r,e);var t=Object(s.a)(r);function r(e){var n;return Object(i.a)(this,r),(n=t.call(this,e)).faces=null,n.material=null,n.shading="source",n.trustSourceNormals=!1,n}return Object(a.a)(r,[{key:"castFaces",value:function(e){return Object(y.b)(e,Uint32Array,[Uint16Array],{loggerTag:".faces=",stride:3},g)}},{key:"castMaterial",value:function(e){return Object(b.d)(e&&"object"==typeof e&&("metallic"in e||"roughness"in e||"metallicRoughnessTexture"in e)?m.a:v.a,e)}},{key:"clone",value:function(){return new n({faces:Object(u.a)(this.faces),shading:this.shading,material:Object(u.a)(this.material),trustSourceNormals:this.trustSourceNormals})}},{key:"cloneWithDeduplication",value:function(e,t){var r={faces:Object(u.a)(this.faces),shading:this.shading,material:this.material?this.material.cloneWithDeduplication(e,t):null,trustSourceNormals:this.trustSourceNormals};return new n(r)}}],[{key:"from",value:function(e){return Object(b.d)(n,e)}}]),r}(l.a);Object(c.a)([Object(h.b)({json:{write:!0}})],O.prototype,"faces",void 0),Object(c.a)([Object(f.a)("faces")],O.prototype,"castFaces",null),Object(c.a)([Object(h.b)({type:v.a,json:{write:!0}})],O.prototype,"material",void 0),Object(c.a)([Object(f.a)("material")],O.prototype,"castMaterial",null),Object(c.a)([Object(h.b)({type:String,json:{write:!0}})],O.prototype,"shading",void 0),Object(c.a)([Object(h.b)({type:Boolean})],O.prototype,"trustSourceNormals",void 0);var j=O=n=Object(c.a)([Object(p.a)("esri.geometry.support.MeshComponent")],O);t.a=j},function(e,t,r){"use strict";r.d(t,"a",(function(){return m})),r.d(t,"b",(function(){return g}));var n,i=r(13),a=r(2),o=r(5),s=r(6),c=r(7),l=r(0),u=r(27),d=r(25),h=r(15),f=r(1),p=r(64),b=(r(17),r(10)),v=h.a.getLogger("esri.geometry.support.MeshVertexAttributes"),m=n=function(e){Object(s.a)(r,e);var t=Object(c.a)(r);function r(e){var n;return Object(a.a)(this,r),(n=t.call(this,e)).color=null,n.position=new Float64Array(0),n.uv=null,n.normal=null,n.tangent=null,n}return Object(o.a)(r,[{key:"castColor",value:function(e){return g(e,Uint8Array,[Uint8ClampedArray],{loggerTag:".color=",stride:4},v)}},{key:"castPosition",value:function(e){return e&&e instanceof Float32Array&&v.warn(".position=","Setting position attribute from a Float32Array may cause precision problems. Consider storing data in a Float64Array or a regular number array"),g(e,Float64Array,[Float32Array],{loggerTag:".position=",stride:3},v)}},{key:"castUv",value:function(e){return g(e,Float32Array,[Float64Array],{loggerTag:".uv=",stride:2},v)}},{key:"castNormal",value:function(e){return g(e,Float32Array,[Float64Array],{loggerTag:".normal=",stride:3},v)}},{key:"castTangent",value:function(e){return g(e,Float32Array,[Float64Array],{loggerTag:".tangent=",stride:4},v)}},{key:"clone",value:function(){var e={position:Object(d.a)(this.position),uv:Object(d.a)(this.uv),normal:Object(d.a)(this.normal),tangent:Object(d.a)(this.tangent),color:Object(d.a)(this.color)};return new n(e)}},{key:"clonePositional",value:function(){var e={position:Object(d.a)(this.position),normal:Object(d.a)(this.normal),tangent:Object(d.a)(this.tangent),uv:this.uv,color:this.color};return new n(e)}}]),r}(u.a);function y(e,t,r,n){var i=t.loggerTag,a=t.stride;return e.length%a!=0?(n.error(i,"Invalid array length, expected a multiple of ".concat(a)),new r([])):e}function g(e,t,r,n,a){if(!e)return e;if(e instanceof t)return y(e,n,t,a);var o,s=Object(i.a)(r);try{for(s.s();!(o=s.n()).done;){if(e instanceof o.value)return y(new t(e),n,t,a)}}catch(l){s.e(l)}finally{s.f()}if(Array.isArray(e))return y(new t(e),n,t,a);var c=r.map((function(e){return"'".concat(e.name,"'")}));return a.error("Failed to set property, expected one of ".concat(c,", but got ").concat(e.constructor.name)),new t([])}function O(e,t,r){t[r]=function(e){for(var t=new Array(e.length),r=0;r<e.length;r++)t[r]=e[r];return t}(e)}Object(l.a)([Object(f.b)({json:{write:O}})],m.prototype,"color",void 0),Object(l.a)([Object(p.a)("color")],m.prototype,"castColor",null),Object(l.a)([Object(f.b)({nonNullable:!0,json:{write:O}})],m.prototype,"position",void 0),Object(l.a)([Object(p.a)("position")],m.prototype,"castPosition",null),Object(l.a)([Object(f.b)({json:{write:O}})],m.prototype,"uv",void 0),Object(l.a)([Object(p.a)("uv")],m.prototype,"castUv",null),Object(l.a)([Object(f.b)({json:{write:O}})],m.prototype,"normal",void 0),Object(l.a)([Object(p.a)("normal")],m.prototype,"castNormal",null),Object(l.a)([Object(f.b)({json:{write:O}})],m.prototype,"tangent",void 0),Object(l.a)([Object(p.a)("tangent")],m.prototype,"castTangent",null);var j=m=n=Object(l.a)([Object(b.a)("esri.geometry.support.MeshVertexAttributes")],m);t.c=j},function(e,t,r){"use strict";r.d(t,"a",(function(){return l})),r.d(t,"b",(function(){return u})),r.d(t,"c",(function(){return c})),r.d(t,"d",(function(){return d}));var n=r(33),i=r(13),a=r(5),o=r(2),s=(r(3),r(658));function c(e,t,r,n,i,a){var o=r-i;if(o>=0)return(t>>o)+(n-(a<<o))*(e>>o);var s=-o;return t-(a-(n<<s))*(e>>s)<<s}var l=function(){function e(t,r,n){Object(o.a)(this,e),this._rows=Math.ceil(r/n),this._columns=Math.ceil(t/n),this._cellSize=n,this.cells=new Array(this._rows);for(var i=0;i<this._rows;i++){this.cells[i]=new Array(this._columns);for(var a=0;a<this._columns;a++)this.cells[i][a]=[]}}return Object(a.a)(e,[{key:"getCell",value:function(e,t){var r=Math.min(Math.max(Math.floor(t/this._cellSize),0),this._rows-1),n=Math.min(Math.max(Math.floor(e/this._cellSize),0),this._columns-1);return this.cells[r]&&this.cells[r][n]||null}},{key:"getCellSpan",value:function(e,t,r,n){return[Math.min(Math.max(Math.floor(e/this._cellSize),0),this.columns-1),Math.min(Math.max(Math.floor(t/this._cellSize),0),this.rows-1),Math.min(Math.max(Math.floor(r/this._cellSize),0),this.columns-1),Math.min(Math.max(Math.floor(n/this._cellSize),0),this.rows-1)]}},{key:"cellSize",get:function(){return this._cellSize}},{key:"columns",get:function(){return this._columns}},{key:"rows",get:function(){return this._rows}}]),e}();function u(e,t,r,n,i,a){for(var o=t[n++],c=0;c<o;c++){var l=new s.a(a);l.xTile=t[n++],l.yTile=t[n++],l.hash=t[n++],l.priority=t[n++];for(var u=t[n++],d=0;d<u;d++){var h=t[n++],f=t[n++],p=t[n++],b=t[n++],v=!!t[n++],m=t[n++],y=r[n++],g=r[n++],O=t[n++],j=t[n++];l.colliders.push({xTile:h,yTile:f,dxPixels:p,dyPixels:b,hard:v,partIndex:m,width:O,height:j,minLod:y,maxLod:g})}for(var _=e[n++],w=0;w<_;w++)l.textVertexRanges.push([e[n++],e[n++]]);for(var x=e[n++],k=0;k<x;k++)l.iconVertexRanges.push([e[n++],e[n++]]);i.push(l)}return n}function d(e,t,r){var a,o=Object(i.a)(e.symbols);try{for(o.s();!(a=o.n()).done;){var s=Object(n.a)(a.value,2),c=s[0];h(e,t,r,s[1],c)}}catch(l){o.e(l)}finally{o.f()}}function h(e,t,r,a,o){var s=e.layerData.get(o);if(3===s.type){var c,l=Object(i.a)(a);try{for(l.s();!(c=l.n()).done;){var u=c.value,d=u.unique,h=void 0;if(u.selectedForRendering){var f=d.parts[0],p=f.startOpacity,b=f.targetOpacity;e.allSymbolsFadingOut=e.allSymbolsFadingOut&&0===b;var v=r?Math.floor(127*p)|b<<7:b?255:0;h=v<<24|v<<16|v<<8|v}else h=0;var m,y=Object(i.a)(u.iconVertexRanges);try{for(y.s();!(m=y.n()).done;)for(var g=Object(n.a)(m.value,2),O=g[0],j=g[1],_=O;_<O+j;_+=4)s.iconOpacity[_/4]=h}catch(R){y.e(R)}finally{y.f()}if(u.selectedForRendering){var w=d.parts[1],x=w.startOpacity,k=w.targetOpacity;e.allSymbolsFadingOut=e.allSymbolsFadingOut&&0===k;var S=r?Math.floor(127*x)|k<<7:k?255:0;h=S<<24|S<<16|S<<8|S}else h=0;var T,C=Object(i.a)(u.textVertexRanges);try{for(C.s();!(T=C.n()).done;)for(var M=Object(n.a)(T.value,2),P=M[0],A=M[1],E=P;E<P+A;E+=4)s.textOpacity[E/4]=h}catch(R){C.e(R)}finally{C.f()}}}catch(R){l.e(R)}finally{l.f()}s.lastOpacityUpdate=t,s.opacityChanged=!0}}},function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var n=r(108);function i(e){var t=Object(n.a)().vec3f("position");return e.normals&&t.vec2i16("normalCompressed",{glNormalized:!0}),1===e.textureCoordinates?t.vec2f("uv0"):2===e.textureCoordinates&&(t.vec2f("uv0"),t.vec4u16("uvRegion",{glNormalized:!0})),e.colors&&t.vec4u8("color",{glNormalized:!0}),t.alignTo(4)}},function(e,t,r){"use strict";var n=r(13),i=r(8),a=r.n(i),o=r(14),s=r(16),c=r(2),l=r(5),u=r(6),d=r(7),h=r(0),f=r(22),p=r(17),b=r(3),v=r(23),m=r(1),y=(r(18),r(15),r(10)),g=r(305),O=r(146),j=r(560),_=r(357);function w(){return(w=Object(s.a)(a.a.mark((function e(t,r,n){var i;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=Object(O.c)(t),e.abrupt("return",Object(j.a)(i,_.a.from(r),Object(o.a)({},n)).then((function(e){return Object(j.b)(e.data.attachmentGroups,i.path)})));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var x=r(273),k=r(152);function S(){return(S=Object(s.a)(a.a.mark((function e(t,r,n){var i;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=Object(O.c)(t),e.abrupt("return",Object(x.executeQueryForCount)(i,k.a.from(r),Object(o.a)({},n)).then((function(e){return e.data.count})));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}r(126);var T=r(66);function C(){return(C=Object(s.a)(a.a.mark((function e(t,r,n){var i;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=Object(O.c)(t),e.abrupt("return",Object(x.executeQueryForExtent)(i,k.a.from(r),Object(o.a)({},n)).then((function(e){return{count:e.data.count,extent:T.a.fromJSON(e.data.extent)}})));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function M(){return(M=Object(s.a)(a.a.mark((function e(t,r,n){var i;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=Object(O.c)(t),e.abrupt("return",Object(x.executeQueryForIds)(i,k.a.from(r),Object(o.a)({},n)).then((function(e){return e.data.objectIds})));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var P=r(216);function A(e,t,r){return E.apply(this,arguments)}function E(){return(E=Object(s.a)(a.a.mark((function e(t,r,n){var i,s,c,l,u;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=Object(O.c)(t),s=Object(o.a)({},n),c=k.a.from(r),e.next=5,Object(x.executeQuery)(i,c,c.sourceSpatialReference,s);case 5:return l=e.sent,u=l.data,e.abrupt("return",u);case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var R=r(134),I=r(412),D=r(372);function F(e,t){return t}function L(e,t,r,n){switch(r){case 0:return U(e,t+n,0);case 1:return"lowerLeft"===e.originPosition?U(e,t+n,1):function(e,t,r){var n=e.translate,i=e.scale;return n[r]-t*i[r]}(e,t+n,1)}}function z(e,t,r,n){switch(r){case 2:return U(e,t,2);default:return L(e,t,r,n)}}function V(e,t,r,n){switch(r){case 2:return U(e,t,3);default:return L(e,t,r,n)}}function N(e,t,r,n){switch(r){case 3:return U(e,t,3);default:return z(e,t,r,n)}}function U(e,t,r){var n=e.translate,i=e.scale;return n[r]+t*i[r]}var B=function(){function e(t){Object(c.a)(this,e),this.options=t,this.geometryTypes=["esriGeometryPoint","esriGeometryMultipoint","esriGeometryPolyline","esriGeometryPolygon"],this.previousCoordinate=[0,0],this.transform=null,this.applyTransform=F,this.lengths=[],this.currentLengthIndex=0,this.toAddInCurrentPath=0,this.vertexDimension=0,this.coordinateBuffer=null,this.coordinateBufferPtr=0,this.AttributesConstructor=function(){}}return Object(l.a)(e,[{key:"createFeatureResult",value:function(){return{fields:[],features:[]}}},{key:"finishFeatureResult",value:function(e){if(this.options.applyTransform&&(e.transform=null),this.AttributesConstructor=function(){},this.coordinateBuffer=null,this.lengths.length=0,e.hasZ){var t=Object(D.a)(e.geometryType,this.options.sourceSpatialReference,e.spatialReference);if(t){var r,i=Object(n.a)(e.features);try{for(i.s();!(r=i.n()).done;){t(r.value.geometry)}}catch(a){i.e(a)}finally{i.f()}}}}},{key:"createSpatialReference",value:function(){return{}}},{key:"addField",value:function(e,t){e.fields.push(t);var r=e.fields.map((function(e){return e.name}));this.AttributesConstructor=function(){var e,t=Object(n.a)(r);try{for(t.s();!(e=t.n()).done;){this[e.value]=null}}catch(i){t.e(i)}finally{t.f()}}}},{key:"addFeature",value:function(e,t){e.features.push(t)}},{key:"prepareFeatures",value:function(e){var t=this;switch(this.transform=e.transform,this.options.applyTransform&&e.transform&&(this.applyTransform=this.deriveApplyTransform(e)),this.vertexDimension=2,e.hasZ&&this.vertexDimension++,e.hasM&&this.vertexDimension++,e.geometryType){case"esriGeometryPoint":this.addCoordinate=function(e,r,n){return t.addCoordinatePoint(e,r,n)},this.createGeometry=function(e){return t.createPointGeometry(e)};break;case"esriGeometryPolygon":this.addCoordinate=function(e,r,n){return t.addCoordinatePolygon(e,r,n)},this.createGeometry=function(e){return t.createPolygonGeometry(e)};break;case"esriGeometryPolyline":this.addCoordinate=function(e,r,n){return t.addCoordinatePolyline(e,r,n)},this.createGeometry=function(e){return t.createPolylineGeometry(e)};break;case"esriGeometryMultipoint":this.addCoordinate=function(e,r,n){return t.addCoordinateMultipoint(e,r,n)},this.createGeometry=function(e){return t.createMultipointGeometry(e)};break;default:Object(R.a)(e.geometryType)}}},{key:"createFeature",value:function(){return this.lengths.length=0,this.currentLengthIndex=0,this.previousCoordinate[0]=0,this.previousCoordinate[1]=0,this.coordinateBuffer=null,this.coordinateBufferPtr=0,{attributes:new this.AttributesConstructor}}},{key:"allocateCoordinates",value:function(){}},{key:"addLength",value:function(e,t,r){0===this.lengths.length&&(this.toAddInCurrentPath=t),this.lengths.push(t)}},{key:"addQueryGeometry",value:function(e,t){var r=t.queryGeometry,n=t.queryGeometryType,i=Object(I.w)(r.clone(),r,!1,!1,this.transform),a=Object(I.h)(i,n,!1,!1);e.queryGeometryType=n,e.queryGeometry=Object(o.a)({},a)}},{key:"createPointGeometry",value:function(e){var t={x:0,y:0,spatialReference:e.spatialReference};return e.hasZ&&(t.z=0),e.hasM&&(t.m=0),t}},{key:"addCoordinatePoint",value:function(e,t,r){switch(t=this.applyTransform(this.transform,t,r,0),r){case 0:e.x=t;break;case 1:e.y=t;break;case 2:"z"in e?e.z=t:e.m=t;break;case 3:e.m=t}}},{key:"transformPathLikeValue",value:function(e,t){var r=0;return t<=1&&(r=this.previousCoordinate[t],this.previousCoordinate[t]+=e),this.applyTransform(this.transform,e,t,r)}},{key:"addCoordinatePolyline",value:function(e,t,r){this.dehydratedAddPointsCoordinate(e.paths,t,r)}},{key:"addCoordinatePolygon",value:function(e,t,r){this.dehydratedAddPointsCoordinate(e.rings,t,r)}},{key:"addCoordinateMultipoint",value:function(e,t,r){0===r&&e.points.push([]);var n=this.transformPathLikeValue(t,r);e.points[e.points.length-1].push(n)}},{key:"createPolygonGeometry",value:function(e){return{rings:[[]],spatialReference:e.spatialReference,hasZ:!!e.hasZ,hasM:!!e.hasM}}},{key:"createPolylineGeometry",value:function(e){return{paths:[[]],spatialReference:e.spatialReference,hasZ:!!e.hasZ,hasM:!!e.hasM}}},{key:"createMultipointGeometry",value:function(e){return{points:[],spatialReference:e.spatialReference,hasZ:!!e.hasZ,hasM:!!e.hasM}}},{key:"dehydratedAddPointsCoordinate",value:function(e,t,r){0===r&&0==this.toAddInCurrentPath--&&(e.push([]),this.toAddInCurrentPath=this.lengths[++this.currentLengthIndex]-1,this.previousCoordinate[0]=0,this.previousCoordinate[1]=0);var n=this.transformPathLikeValue(t,r),i=e[e.length-1];0===r&&(this.coordinateBufferPtr=0,this.coordinateBuffer=new Array(this.vertexDimension),i.push(this.coordinateBuffer)),this.coordinateBuffer[this.coordinateBufferPtr++]=n}},{key:"deriveApplyTransform",value:function(e){var t=e.hasZ,r=e.hasM;return t&&r?N:t?z:r?V:L}}]),e}();function G(e,t,r){return q.apply(this,arguments)}function q(){return(q=Object(s.a)(a.a.mark((function e(t,r,n){var i,s,c,l,u,d;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=Object(O.c)(t),s=Object(o.a)({},n),c=k.a.from(r),l=!c.quantizationParameters,e.next=6,Object(x.executeQueryPBF)(i,c,new B({sourceSpatialReference:c.sourceSpatialReference,applyTransform:l}),s);case 6:return u=e.sent,d=u.data,e.abrupt("return",d);case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var H=r(99),W=r(331);function Q(e,t){var r=e.toJSON();return r.objectIds&&(r.objectIds=r.objectIds.join(",")),r.orderByFields&&(r.orderByFields=r.orderByFields.join(",")),!r.outFields||null!=t&&t.returnCountOnly?delete r.outFields:-1!==r.outFields.indexOf("*")?r.outFields="*":r.outFields=r.outFields.join(","),r.outSpatialReference&&(r.outSR=r.outSR.wkid||JSON.stringify(r.outSR.toJSON()),delete r.outSpatialReference),r.dynamicDataSource&&(r.layer=JSON.stringify({source:r.dynamicDataSource}),delete r.dynamicDataSource),r}function Z(e,t,r){return X.apply(this,arguments)}function X(){return(X=Object(s.a)(a.a.mark((function e(t,r,i){var s,c,l,u,d,h,f,p,b,v;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,J(t,r,i);case 2:s=e.sent,c=s.data,l=c.geometryType,u=c.spatialReference,d={},h=Object(n.a)(c.relatedRecordGroups);try{for(h.s();!(f=h.n()).done;)if(p=f.value,b={fields:void 0,objectIdFieldName:void 0,geometryType:l,spatialReference:u,hasZ:!!c.hasZ,hasM:!!c.hasM,features:p.relatedRecords},null!=p.objectId)d[p.objectId]=b;else for(v in p)p.hasOwnProperty(v)&&"relatedRecords"!==v&&(d[p[v]]=b)}catch(a){h.e(a)}finally{h.f()}return e.abrupt("return",Object(o.a)(Object(o.a)({},s),{},{data:d}));case 10:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Y(e,t,r){return $.apply(this,arguments)}function $(){return($=Object(s.a)(a.a.mark((function e(t,r,i){var s,c,l,u,d,h;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,J(t,r,i,{returnCountOnly:!0});case 2:s=e.sent,c=s.data,l={},u=Object(n.a)(c.relatedRecordGroups);try{for(u.s();!(d=u.n()).done;)null!=(h=d.value).objectId&&(l[h.objectId]=h.count)}catch(a){u.e(a)}finally{u.f()}return e.abrupt("return",Object(o.a)(Object(o.a)({},s),{},{data:l}));case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function J(e,t){return K.apply(this,arguments)}function K(){return(K=Object(s.a)(a.a.mark((function e(t,r){var n,i,s,c=arguments;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=c.length>2&&void 0!==c[2]?c[2]:{},i=c.length>3?c[3]:void 0,s=Object(W.a)(Object(o.a)(Object(o.a)(Object(o.a)({},t.query),{},{f:"json"},i),Q(r,i))),e.abrupt("return",Object(H.default)(t.path+"/queryRelatedRecords",Object(o.a)(Object(o.a)({},n),{},{query:Object(o.a)(Object(o.a)({},n.query),s)})));case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var ee=r(265);function te(){return(te=Object(s.a)(a.a.mark((function e(t,r,n){var i;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=ee.a.from(r),i=Object(O.c)(t),e.abrupt("return",Z(i,r,n).then((function(e){var t=e.data,r={};return Object.keys(t).forEach((function(e){return r[e]=P.default.fromJSON(t[e])})),r})));case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function re(){return(re=Object(s.a)(a.a.mark((function e(t,r,n){var i;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=ee.a.from(r),i=Object(O.c)(t),e.abrupt("return",Y(i,r,Object(o.a)({},n)).then((function(e){return e.data})));case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var ne=r(39),ie=r(100),ae=r(450),oe=r(358),se="Layer does not support extent calculation.";function ce(e,t){var r,n,i=e.geometry,a=e.toJSON(),o=a;if(Object(b.j)(i)&&(o.geometry=JSON.stringify(i),o.geometryType=Object(ie.c)(i),o.inSR=i.spatialReference.wkid||JSON.stringify(i.spatialReference)),null!=(r=a.topFilter)&&r.groupByFields&&(o.topFilter.groupByFields=a.topFilter.groupByFields.join(",")),null!=(n=a.topFilter)&&n.orderByFields&&(o.topFilter.orderByFields=a.topFilter.orderByFields.join(",")),a.topFilter&&(o.topFilter=JSON.stringify(o.topFilter)),a.objectIds&&(o.objectIds=a.objectIds.join(",")),a.orderByFields&&(o.orderByFields=a.orderByFields.join(",")),a.outFields&&!(null!=t&&t.returnCountOnly||null!=t&&t.returnExtentOnly||null!=t&&t.returnIdsOnly)?-1!==a.outFields.indexOf("*")?o.outFields="*":o.outFields=a.outFields.join(","):delete o.outFields,a.outSR?o.outSR=a.outSR.wkid||JSON.stringify(a.outSR):i&&a.returnGeometry&&(o.outSR=o.inSR),a.returnGeometry&&delete a.returnGeometry,a.timeExtent){var s=a.timeExtent,c=s.start,l=s.end;null==c&&null==l||(o.time=c===l?c:"".concat(null==c?"null":c,",").concat(null==l?"null":l)),delete a.timeExtent}return o}function le(e,t,r,n){return ue.apply(this,arguments)}function ue(){return(ue=Object(s.a)(a.a.mark((function e(t,r,n,i){var o;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ve(t,r,"json",i);case 2:return o=e.sent,e.abrupt("return",(Object(oe.a)(r,n,o.data),o));case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function de(e,t,r){return he.apply(this,arguments)}function he(){return(he=Object(s.a)(a.a.mark((function e(t,r,n){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Object(b.j)(r.timeExtent)&&r.timeExtent.isEmpty?Promise.resolve({data:{objectIds:[]}}):ve(t,r,"json",n,{returnIdsOnly:!0}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function fe(e,t,r){return pe.apply(this,arguments)}function pe(){return(pe=Object(s.a)(a.a.mark((function e(t,r,n){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Object(b.j)(r.timeExtent)&&r.timeExtent.isEmpty?Promise.resolve({data:{count:0,extent:null}}):ve(t,r,"json",n,{returnExtentOnly:!0,returnCountOnly:!0}).then((function(e){var t=e.data;if(t.hasOwnProperty("extent"))return e;if(t.features)throw new Error(se);if(t.hasOwnProperty("count"))throw new Error(se);return e})));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function be(e,t,r){return Object(b.j)(t.timeExtent)&&t.timeExtent.isEmpty?Promise.resolve({data:{count:0}}):ve(e,t,"json",r,{returnIdsOnly:!0,returnCountOnly:!0})}function ve(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},a="string"==typeof e?Object(ne.K)(e):e,s=t.geometry?[t.geometry]:[];return n.responseType="pbf"===r?"array-buffer":"json",Object(ae.a)(s,null,n).then((function(e){var s=e&&e[0];Object(b.j)(s)&&((t=t.clone()).geometry=s);var c=Object(W.a)(Object(o.a)(Object(o.a)(Object(o.a)({},a.query),{},{f:r},i),ce(t,i)));return Object(H.default)(Object(ne.z)(a.path,"queryTopFeatures"),Object(o.a)(Object(o.a)({},n),{},{query:Object(o.a)(Object(o.a)({},c),n.query)}))}))}var me=r(213);function ye(){return(ye=Object(s.a)(a.a.mark((function e(t,r,n,i){var s,c,l,u;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=Object(O.c)(t),c=Object(o.a)({},i),e.next=4,le(s,me.a.from(r),n,c);case 4:return l=e.sent,u=l.data,e.abrupt("return",P.default.fromJSON(u));case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ge(){return(ge=Object(s.a)(a.a.mark((function e(t,r,n){var i;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=Object(O.c)(t),e.next=3,de(i,me.a.from(r),Object(o.a)({},n));case 3:return e.abrupt("return",e.sent.data.objectIds);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Oe(){return(Oe=Object(s.a)(a.a.mark((function e(t,r,n){var i,s;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=Object(O.c)(t),e.next=3,fe(i,me.a.from(r),Object(o.a)({},n));case 3:return s=e.sent,e.abrupt("return",{count:s.data.count,extent:T.a.fromJSON(s.data.extent)});case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function je(){return(je=Object(s.a)(a.a.mark((function e(t,r,n){var i;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=Object(O.c)(t),e.next=3,be(i,me.a.from(r),Object(o.a)({},n));case 3:return e.abrupt("return",e.sent.data.count);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var _e=function(e){Object(u.a)(i,e);var t=Object(d.a)(i);function i(e){var r;return Object(c.a)(this,i),(r=t.call(this,e)).dynamicDataSource=null,r.fieldsIndex=null,r.format="json",r.gdbVersion=null,r.infoFor3D=null,r.sourceSpatialReference=null,r}return Object(l.a)(i,[{key:"execute",value:function(e,t){var r=this;return this.executeJSON(e,t).then((function(n){return r.featureSetFromJSON(e,n,t)}))}},{key:"executeJSON",value:function(){var e=Object(s.a)(a.a.mark((function e(t,r){var n,i,s,c,l,u,d;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=Object(o.a)(Object(o.a)({},this.requestOptions),r),s=this._normalizeQuery(t),c=null!=(null==(n=t.outStatistics)?void 0:n[0]),l=Object(p.a)("featurelayer-pbf-statistics"),u=!c||l,"pbf"!==this.format||!u){e.next=13;break}return e.prev=2,e.next=5,G(this.url,s,i);case 5:d=e.sent,e.next=13;break;case 8:if(e.prev=8,e.t0=e.catch(2),"query:parsing-pbf"===e.t0.name){e.next=12;break}throw e.t0;case 12:this.format="json";case 13:if(e.t1="json"!==this.format&&u,e.t1){e.next=18;break}return e.next=17,A(this.url,s,i);case 17:d=e.sent;case 18:return this._normalizeFields(d.fields),e.abrupt("return",d);case 20:case"end":return e.stop()}}),e,this,[[2,8]])})));return function(t,r){return e.apply(this,arguments)}}()},{key:"featureSetFromJSON",value:function(){var e=Object(s.a)(a.a.mark((function e(t,n,i){var o,s;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._queryIs3DObjectFormat(t)&&Object(b.j)(this.infoFor3D)&&n.features&&n.features.length){e.next=2;break}return e.abrupt("return",P.default.fromJSON(n));case 2:return e.next=4,Object(v.A)(r.e(69).then(r.bind(null,1173)),i);case 4:return o=e.sent,s=o.meshFeatureSetFromJSON,e.abrupt("return",s(t,this.infoFor3D,n));case 7:case"end":return e.stop()}}),e,this)})));return function(t,r,n){return e.apply(this,arguments)}}()},{key:"executeForCount",value:function(e,t){var r=Object(o.a)(Object(o.a)({},this.requestOptions),t),n=this._normalizeQuery(e);return function(e,t,r){return S.apply(this,arguments)}(this.url,n,r)}},{key:"executeForExtent",value:function(e,t){var r=Object(o.a)(Object(o.a)({},this.requestOptions),t),n=this._normalizeQuery(e);return function(e,t,r){return C.apply(this,arguments)}(this.url,n,r)}},{key:"executeForIds",value:function(e,t){var r=Object(o.a)(Object(o.a)({},this.requestOptions),t),n=this._normalizeQuery(e);return function(e,t,r){return M.apply(this,arguments)}(this.url,n,r)}},{key:"executeRelationshipQuery",value:function(e,t){e=ee.a.from(e);var r=Object(o.a)(Object(o.a)({},this.requestOptions),t);return(this.gdbVersion||this.dynamicDataSource)&&((e=e.clone()).gdbVersion=e.gdbVersion||this.gdbVersion,e.dynamicDataSource=e.dynamicDataSource||this.dynamicDataSource),function(e,t,r){return te.apply(this,arguments)}(this.url,e,r)}},{key:"executeRelationshipQueryForCount",value:function(e,t){e=ee.a.from(e);var r=Object(o.a)(Object(o.a)({},this.requestOptions),t);return(this.gdbVersion||this.dynamicDataSource)&&((e=e.clone()).gdbVersion=e.gdbVersion||this.gdbVersion,e.dynamicDataSource=e.dynamicDataSource||this.dynamicDataSource),function(e,t,r){return re.apply(this,arguments)}(this.url,e,r)}},{key:"executeAttachmentQuery",value:function(e,t){var r=Object(o.a)(Object(o.a)({},this.requestOptions),t);return function(e,t,r){return w.apply(this,arguments)}(this.url,e,r)}},{key:"executeTopFeaturesQuery",value:function(e,t){var r=Object(o.a)(Object(o.a)({},this.requestOptions),t);return function(e,t,r,n){return ye.apply(this,arguments)}(this.parsedUrl,e,this.sourceSpatialReference,r)}},{key:"executeForTopIds",value:function(e,t){var r=Object(o.a)(Object(o.a)({},this.requestOptions),t);return function(e,t,r){return ge.apply(this,arguments)}(this.parsedUrl,e,r)}},{key:"executeForTopExtents",value:function(e,t){var r=Object(o.a)(Object(o.a)({},this.requestOptions),t);return function(e,t,r){return Oe.apply(this,arguments)}(this.parsedUrl,e,r)}},{key:"executeForTopCount",value:function(e,t){var r=Object(o.a)(Object(o.a)({},this.requestOptions),t);return function(e,t,r){return je.apply(this,arguments)}(this.parsedUrl,e,r)}},{key:"_normalizeQuery",value:function(e){var t=k.a.from(e);if(t.sourceSpatialReference=t.sourceSpatialReference||this.sourceSpatialReference,(this.gdbVersion||this.dynamicDataSource)&&((t=t===e?t.clone():t).gdbVersion=e.gdbVersion||this.gdbVersion,t.dynamicDataSource=e.dynamicDataSource?g.a.from(e.dynamicDataSource):this.dynamicDataSource),Object(b.j)(this.infoFor3D)&&this._queryIs3DObjectFormat(e)){(t=t===e?t.clone():t).formatOf3DObjects=null;var r,i=Object(n.a)(this.infoFor3D.queryFormats);try{for(i.s();!(r=i.n()).done;){var a=r.value;if("3D_glb"===a.id){t.formatOf3DObjects=a.id;break}"3D_gltf"!==a.id||t.formatOf3DObjects||(t.formatOf3DObjects=a.id)}}catch(w){i.e(w)}finally{i.f()}if(!t.formatOf3DObjects)throw new f.a("query:unsupported-3d-query-formats","Could not find any supported 3D object query format. Only supported formats are 3D_glb and 3D_gltf");if(Object(b.i)(t.outFields)||!t.outFields.includes("*")){t=t===e?t.clone():t,Object(b.i)(t.outFields)&&(t.outFields=[]);var o=this.infoFor3D.transformFieldRoles,s=o.originX,c=o.originY,l=o.originZ,u=o.translationX,d=o.translationY,h=o.translationZ,p=o.scaleX,v=o.scaleY,m=o.scaleZ,y=o.rotationX,O=o.rotationY,j=o.rotationZ,_=o.rotationDeg;t.outFields.push(s,c,l,u,d,h,p,v,m,y,O,j,_)}}return t}},{key:"_normalizeFields",value:function(e){if(Object(b.j)(this.fieldsIndex)&&Object(b.j)(e)){var t,r=Object(n.a)(e);try{for(r.s();!(t=r.n()).done;){var i=t.value,a=this.fieldsIndex.get(i.name);a&&Object.assign(i,a.toJSON())}}catch(o){r.e(o)}finally{r.f()}}}},{key:"_queryIs3DObjectFormat",value:function(e){return Object(b.j)(this.infoFor3D)&&e.returnGeometry&&"xyFootprint"!==e.multipatchOption&&!e.outStatistics}}]),i}(r(587).a);Object(h.a)([Object(m.b)({type:g.a})],_e.prototype,"dynamicDataSource",void 0),Object(h.a)([Object(m.b)()],_e.prototype,"fieldsIndex",void 0),Object(h.a)([Object(m.b)()],_e.prototype,"format",void 0),Object(h.a)([Object(m.b)()],_e.prototype,"gdbVersion",void 0),Object(h.a)([Object(m.b)()],_e.prototype,"infoFor3D",void 0),Object(h.a)([Object(m.b)()],_e.prototype,"sourceSpatialReference",void 0);var we=_e=Object(h.a)([Object(y.a)("esri.tasks.QueryTask")],_e);t.a=we},function(e,t,r){"use strict";r.d(t,"a",(function(){return d})),r.d(t,"b",(function(){return h}));var n=r(13),i=r(2),a=r(5),o=r(69),s=r(59),c=r(299),l=r(487),u=r(217),d=["esriGeometryPoint","esriGeometryMultipoint","esriGeometryPolyline","esriGeometryPolygon"],h=function(){function e(t){Object(i.a)(this,e),this.options=t,this.geometryTypes=d,this._coordinatePtr=0,this._vertexDimension=0}return Object(a.a)(e,[{key:"createFeatureResult",value:function(){return new l.a}},{key:"prepareFeatures",value:function(e){this._vertexDimension=2,e.hasZ&&this._vertexDimension++,e.hasM&&this._vertexDimension++}},{key:"finishFeatureResult",value:function(e){if(e&&e.features&&e.hasZ&&this.options.sourceSpatialReference&&e.spatialReference&&!Object(s.c)(e.spatialReference,this.options.sourceSpatialReference)&&!e.spatialReference.vcsWkid){var t=Object(o.g)(this.options.sourceSpatialReference)/Object(o.g)(e.spatialReference);if(1!==t){var r,i=Object(n.a)(e.features);try{for(i.s();!(r=i.n()).done;){var a=r.value;if(a.geometry&&a.geometry.coords)for(var c=a.geometry.coords,l=2;l<c.length;l+=3)c[l]*=t}}catch(u){i.e(u)}finally{i.f()}}}}},{key:"addFeature",value:function(e,t){e.features.push(t)}},{key:"createFeature",value:function(){return new c.a}},{key:"createSpatialReference",value:function(){return{wkid:0}}},{key:"createGeometry",value:function(){return new u.a}},{key:"addField",value:function(e,t){e.fields.push(t)}},{key:"allocateCoordinates",value:function(e){e.coords.length=e.lengths.reduce((function(e,t){return e+t}),0)*this._vertexDimension,this._coordinatePtr=0}},{key:"addCoordinate",value:function(e,t){e.coords[this._coordinatePtr++]=t}},{key:"addCoordinatePoint",value:function(e,t){e.coords.push(t)}},{key:"addLength",value:function(e,t){e.lengths.push(t)}},{key:"addQueryGeometry",value:function(e,t){e.queryGeometry=t.queryGeometry,e.queryGeometryType=t.queryGeometryType}},{key:"createPointGeometry",value:function(){return new u.a}}]),e}()},function(e,t,r){"use strict";var n,i=r(2),a=r(5),o=r(6),s=r(7),c=r(0),l=r(49),u=r(27),d=r(1),h=(r(17),r(18)),f=(r(15),r(10)),p=r(44),b=n=function(e){Object(o.a)(r,e);var t=Object(s.a)(r);function r(e){var n;return Object(i.a)(this,r),(n=t.call(this,e)).color=null,n.label=null,n.value=null,n}return Object(a.a)(r,[{key:"writeValue",value:function(e,t,r){t[r]=null==e?0:e}},{key:"clone",value:function(){return new n({color:this.color&&this.color.clone(),label:this.label,value:this.value})}}]),r}(u.a);Object(c.a)([Object(d.b)({type:l.a,json:{type:[h.a],write:!0}})],b.prototype,"color",void 0),Object(c.a)([Object(d.b)({type:String,json:{write:!0}})],b.prototype,"label",void 0),Object(c.a)([Object(d.b)({type:Number,json:{write:{allowNull:!0}}})],b.prototype,"value",void 0),Object(c.a)([Object(p.a)("value")],b.prototype,"writeValue",null);var v=b=n=Object(c.a)([Object(f.a)("esri.renderers.visualVariables.support.ColorStop")],b);t.a=v},function(e,t,r){"use strict";r.d(t,"a",(function(){return b}));var n=r(98),i=r(22),a=r(227),o=r(218),s=r(166),c=r(304),l=r(234),u=r(317),d=r(222),h=r(256),f=r(258),p=r(303);function b(e){var t,r=arguments.length>1&&void 0!==arguments[1]&&arguments[1],b=arguments.length>2&&void 0!==arguments[2]&&arguments[2],v=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];if(!e)return{symbol:null};if(Object(n.c)(e)||e instanceof a.a)t=e.clone();else if("cim"===e.type)t=o.a.fromCIMSymbol(e);else if(e instanceof s.a)t=c.a.fromSimpleLineSymbol(e);else if(e instanceof l.a)t=o.a.fromSimpleMarkerSymbol(e);else if(e instanceof u.a)t=o.a.fromPictureMarkerSymbol(e);else if(e instanceof d.a)t=h.a.fromSimpleFillSymbol(e);else{if(!(e instanceof f.a))return{error:new i.a("symbol-conversion:unsupported-2d-symbol","2D symbol of type '".concat(e.type||e.declaredClass,"' is unsupported in 3D"),{symbol:e})};t=v?p.a.fromTextSymbol(e):o.a.fromTextSymbol(e)}if(r&&(t.id=e.id),b&&Object(n.c)(t))for(var m=0;m<t.symbolLayers.length;++m)t.symbolLayers.getItemAt(m)._ignoreDrivers=!0;return{symbol:t}}},function(e,t,r){"use strict";r.d(t,"a",(function(){return c})),r.d(t,"b",(function(){return u})),r.d(t,"c",(function(){return l})),r.d(t,"d",(function(){return d})),r.d(t,"e",(function(){return h})),r.d(t,"f",(function(){return p})),r.d(t,"g",(function(){return f}));r(17),r(3);var n=r(222),i=r(166),a=r(234),o=r(258),s=r(315),c=a.a.fromJSON(s.c),l=i.a.fromJSON(s.e),u=n.a.fromJSON(s.d),d=o.a.fromJSON(s.f);var h=a.a.fromJSON(s.g),f=i.a.fromJSON(s.i),p=n.a.fromJSON(s.h)},function(e,t,r){"use strict";r.d(t,"a",(function(){return m})),r.d(t,"b",(function(){return f})),r.d(t,"c",(function(){return p})),r.d(t,"d",(function(){return b}));var n=r(93),i=r(49),a=r(99),o=r(598),s=r(28),c=r(609),l="picture-fill",u="simple-fill",d="simple-marker",h=new o.a(1e3);function f(e){var t=e.style,r=null;if(e)switch(e.type){case d:"cross"!==t&&"x"!==t&&(r=e.color);break;case u:"solid"===t?r=e.color:"none"!==t&&(r={type:"pattern",x:0,y:0,src:Object(n.b)("esri/symbols/patterns/".concat(t,".png")),width:5,height:5});break;case l:r={type:"pattern",src:e.url,width:Object(s.g)(e.width)*e.xscale,height:Object(s.g)(e.height)*e.yscale,x:Object(s.g)(e.xoffset),y:Object(s.g)(e.yoffset)};break;case"text":r=e.color;break;case"cim":r=Object(c.a)(e)}return r}function p(e,t){var r=e+"-"+t;return void 0!==h.get(r)?Promise.resolve(h.get(r)):Object(a.default)(e,{responseType:"image"}).then((function(e){var n=e.data,i=n.naturalWidth,a=n.naturalHeight,o=document.createElement("canvas");o.width=i,o.height=a;var s=o.getContext("2d");s.fillStyle=t,s.fillRect(0,0,i,a),s.globalCompositeOperation="destination-in",s.drawImage(n,0,0);var c=o.toDataURL();return h.put(r,c),c}))}function b(e){if(!e)return null;var t;switch(e.type){case u:case l:case d:t=b(e.outline);break;case"simple-line":var r=Object(s.g)(e.width);"none"!==e.style&&0!==r&&(t={color:e.color,style:v(e.style),width:r,cap:e.cap,join:"miter"===e.join?Object(s.g)(e.miterLimit):e.join});break;default:t=null}return t}var v=function(){var e={};return function(t){if(e[t])return e[t];var r=t.replace(/-/g,"");return e[t]=r,r}}(),m=new i.a([128,128,128])},function(e,t,r){"use strict";r.d(t,"a",(function(){return h})),r.d(t,"b",(function(){return s})),r.d(t,"c",(function(){return u})),r.d(t,"d",(function(){return c}));var n=r(14),i=r(13),a=r(49),o=r(175);function s(e){var t=Object(o.k)(e);if("CIMTextSymbol"===t.type)return t.height;var r=0;if(t.symbolLayers){var n,a=Object(i.a)(t.symbolLayers);try{for(a.s();!(n=a.n()).done;){var s=n.value;Object(o.g)(s)&&s.size>r?r=s.size:Object(o.i)(s)&&s.width>r?r=s.width:Object(o.f)(s)}}catch(c){a.e(c)}finally{a.f()}}return r}function c(e,t,r){var n=Object(o.k)(e),a=s(e);0!==a?l(n,t/a,!1,r):function(e,t){if("CIMTextSymbol"!==e.type){if(e.symbolLayers){var r,n=Object(i.a)(e.symbolLayers);try{for(n.s();!(r=n.n()).done;){var a=r.value;switch(a.type){case"CIMPictureMarker":case"CIMVectorMarker":a.size=t;break;case"CIMPictureStroke":case"CIMSolidStroke":a.width=t}}}catch(o){n.e(o)}finally{n.f()}}}else e.height=t}(n,t)}function l(e,t,r,a){if("CIMTextSymbol"!==e.type){if(r&&e.effects){var o,s=Object(i.a)(e.effects);try{for(s.s();!(o=s.n()).done;){d(o.value,t)}}catch(p){s.e(p)}finally{s.f()}}if(e.symbolLayers){var c,h=Object(i.a)(e.symbolLayers);try{for(h.s();!(c=h.n()).done;){var f=c.value;switch(f.type){case"CIMPictureMarker":case"CIMVectorMarker":u(f,t,a);break;case"CIMPictureStroke":case"CIMSolidStroke":null!=a&&a.preserveOutlineWidth||(f.width*=t);break;case"CIMPictureFill":f.height*=t,f.offsetX*=t,f.offsetY*=t;break;case"CIMHatchFill":l(f.lineSymbol,t,!0,Object(n.a)(Object(n.a)({},a),{},{preserveOutlineWidth:!1})),f.offsetX*=t,f.offsetY*=t,f.separation*=t}}}catch(p){h.e(p)}finally{h.f()}}}else e.height*=t}function u(e,t,r){if(e.markerPlacement&&function(e,t){switch(Object(o.h)(e)&&(e.offset*=t),e.type){case"CIMMarkerPlacementAlongLineRandomSize":case"CIMMarkerPlacementAlongLineSameSize":if(e.customEndingOffset*=t,e.offsetAlongLine*=t,e.placementTemplate&&e.placementTemplate.length){var r=e.placementTemplate.map((function(e){return e*t}));e.placementTemplate=r}break;case"CIMMarkerPlacementAlongLineVariableSize":if(e.maxRandomOffset*=t,e.placementTemplate&&e.placementTemplate.length){var n=e.placementTemplate.map((function(e){return e*t}));e.placementTemplate=n}break;case"CIMMarkerPlacementOnLine":e.startPointOffset*=t;break;case"CIMMarkerPlacementAtExtremities":e.offsetAlongLine*=t;break;case"CIMMarkerPlacementAtMeasuredUnits":case"CIMMarkerPlacementOnVertices":break;case"CIMMarkerPlacementAtRatioPositions":e.beginPosition*=t,e.endPosition*=t;break;case"CIMMarkerPlacementPolygonCenter":e.offsetX*=t,e.offsetY*=t;break;case"CIMMarkerPlacementInsidePolygon":e.offsetX*=t,e.offsetY*=t,e.stepX*=t,e.stepY*=t}}(e.markerPlacement,t),e.offsetX*=t,e.offsetY*=t,e.anchorPoint&&"Absolute"===e.anchorPointUnits&&(e.anchorPoint={x:e.anchorPoint.x*t,y:e.anchorPoint.y*t}),e.size*=t,"CIMVectorMarker"===e.type&&e.markerGraphics){var n,a=Object(i.a)(e.markerGraphics);try{for(a.s();!(n=a.n()).done;){var s=n.value;e.scaleSymbolsProportionally||l(s.symbol,t,!0,r)}}catch(c){a.e(c)}finally{a.f()}}}function d(e,t){switch(e.type){case"CIMGeometricEffectArrow":case"CIMGeometricEffectDonut":e.width*=t;break;case"CIMGeometricEffectBuffer":e.size*=t;break;case"CIMGeometricEffectCut":e.beginCut*=t,e.endCut*=t,e.middleCut*=t;break;case"CIMGeometricEffectDashes":if(e.customEndingOffset*=t,e.offsetAlongLine*=t,e.dashTemplate&&e.dashTemplate.length){var r=e.dashTemplate.map((function(e){return e*t}));e.dashTemplate=r}break;case"CIMGeometricEffectExtension":case"CIMGeometricEffectJog":case"CIMGeometricEffectRadial":e.length*=t;break;case"CIMGeometricEffectMove":e.offsetX*=t,e.offsetY*=t;break;case"CIMGeometricEffectOffset":case"CIMGeometricEffectOffsetTangent":e.offset*=t;break;case"CIMGeometricEffectRegularPolygon":e.radius*=t;break;case"CIMGeometricEffectTaperedPolygon":e.fromWidth*=t,e.length*=t,e.toWidth*=t;break;case"CIMGeometricEffectWave":e.amplitude*=t,e.period*=t}}function h(e){var t=[];return f(Object(o.k)(e),t),t.length?new a.a(Object(o.e)(t[0])):null}function f(e,t){var r;r="CIMTextSymbol"===e.type?e.symbol:e;var n="CIMPolygonSymbol"===e.type;if(r.symbolLayers){var a,s=Object(i.a)(r.symbolLayers);try{for(s.s();!(a=s.n()).done;){var c=a.value;if(!(c.colorLocked||n&&(Object(o.i)(c)||Object(o.g)(c)&&c.markerPlacement&&Object(o.h)(c.markerPlacement))))switch(c.type){case"CIMPictureMarker":case"CIMPictureStroke":case"CIMPictureFill":break;case"CIMVectorMarker":c.markerGraphics.forEach((function(e){f(e.symbol,t)}));break;case"CIMSolidStroke":case"CIMSolidFill":p(t,c.color);break;case"CIMHatchFill":f(c.lineSymbol,t)}}}catch(l){s.e(l)}finally{s.f()}}}function p(e,t){var r,n=Object(i.a)(e);try{for(n.s();!(r=n.n()).done;){if(r.value.join(".")===t.join("."))return}}catch(a){n.e(a)}finally{n.f()}e.push(t)}},function(e,t,r){"use strict";r.d(t,"a",(function(){return v})),r.d(t,"b",(function(){return b}));var n,i,a,o,s,c,l,u,d=r(12),h=r(132),f=r(11),p=r(87);function b(e){var t=new p.a;if(2===e.geometry)t.attributes.add("position","vec2"),t.varyings.add("color","vec4"),t.vertex.uniforms.add("lightingMainDirection","vec3").add("cameraPosition","vec3").add("undergroundFadeAlpha","float"),t.vertex.code.add(Object(f.a)(n||(n=Object(d.a)(["void main(void) {\nfloat ndotl = dot(normalize(cameraPosition), lightingMainDirection);\nfloat lighting = max(0.0, smoothstep(-1.0, 0.8, 2.0 * ndotl));\ncolor = vec4(vec3(lighting), undergroundFadeAlpha);\ngl_Position = vec4(position.xy, 1.0, 1.0);\n}"])))),t.fragment.code.add(Object(f.a)(i||(i=Object(d.a)(["void main() {\ngl_FragColor = color;\n}"]))));else{t.include(h.a,{linearDepth:!1}),t.attributes.add("position","vec3"),t.varyings.add("vtc","vec2"),t.varyings.add("falloff","float");var r=1===e.geometry;t.vertex.uniforms.add("proj","mat4").add("view","mat4").add("lightingMainDirection","vec3"),r||(t.varyings.add("innerFactor","float"),t.vertex.uniforms.add("silCircleCenter","vec3").add("silCircleV1","vec3").add("silCircleV2","vec3").add("texV","vec2").add("innerScale","float"));var b=1/128;t.vertex.code.add(Object(f.a)(a||(a=Object(d.a)(["\n\t\tvoid main(void) {\n      ","\n      falloff = max(0.0, smoothstep(-1.0, 0.8, 2.0 * ndotl));\n\n\t\t  gl_Position = transformPosition(proj, view, pos);\n\t\t  gl_Position.z = gl_Position.w; // project atmosphere onto the far plane\n    }\n\t  "])),r?Object(f.a)(o||(o=Object(d.a)(["\n      vec3 pos = position;\n      float ndotl = lightingMainDirection.z;\n      vtc = vec2(0.0, position.z + 0.05);"]))):Object(f.a)(s||(s=Object(d.a)(["\n      innerFactor = clamp(-position.z, 0.0, 1.0);\n      float scale = position.y * (1.0 + innerFactor * innerScale);\n      float phi = position.x * "," + 1.0;\n      vec3 pos =  (silCircleCenter + sin(phi) * silCircleV1 + cos(phi) * silCircleV2) * scale;\n      float ndotl = dot(normalize(position.y > 0.0 ? pos: silCircleCenter), lightingMainDirection);\n      vtc.x = position.x  * ",";\n      vtc.y = texV.x * (1.0 - position.z) + texV.y * position.z;\n      "])),f.a.float(6.2831853*b),f.a.float(b)))),t.fragment.uniforms.add("tex","sampler2D"),r||t.fragment.uniforms.add("altitudeFade","float"),t.fragment.code.add(Object(f.a)(c||(c=Object(d.a)(["\n\t\tvoid main() {\n\t\t\tvec4 atmosphereColor = texture2D(tex, vtc) * falloff;\n      ","\n    }"])),r?Object(f.a)(l||(l=Object(d.a)(["gl_FragColor = atmosphereColor;"]))):Object(f.a)(u||(u=Object(d.a)(["\n\t\t\tvec4 innerColor = vec4(atmosphereColor.rgb, 1.0 - altitudeFade);\n\t\t\tgl_FragColor = mix(atmosphereColor, innerColor, smoothstep(0.0, 1.0, innerFactor));\n      "])))))}return t}var v=Object.freeze({__proto__:null,build:b})},function(e,t,r){"use strict";r.d(t,"a",(function(){return M})),r.d(t,"b",(function(){return C}));var n,i,a,o,s,c,l,u,d,h,f,p,b,v,m,y,g,O,j,_,w,x=r(12),k=r(177),S=r(11),T=r(87);function C(e){var t=new T.a;return t.attributes.add("position","vec2"),t.attributes.add("uv0","vec2"),t.varyings.add("worldRay","vec3"),t.varyings.add("vtc","vec2"),e.haze&&t.varyings.add("eyeDir","vec3"),t.vertex.uniforms.add("projectionInverse","mat4"),t.vertex.uniforms.add("viewInverse","mat4"),t.vertex.code.add(Object(S.a)(n||(n=Object(x.a)(["\n    void main(void) {\n      vec3 posViewNear = (projectionInverse * vec4(position, -1, 1)).xyz;\n\n      worldRay = (viewInverse * vec4(posViewNear, 0)).xyz;\n      vtc = uv0;\n\n      ","\n\n      gl_Position = vec4(position, 1, 1);\n    }\n  "])),e.haze?Object(S.a)(i||(i=Object(x.a)(["eyeDir = posViewNear;"]))):"")),t.fragment.uniforms.add("lightingMainDirection","vec3").add("invWavelength","vec3").add("invWavelengthScaled","vec3").add("radii","vec2").add("atmosphereParameters1","vec4").add("atmosphereParameters2","vec4").add("cameraPosition","vec3").add("nearFar","vec2").add("heightParameters","vec4"),e.haze?t.fragment.uniforms.add("depthTex","sampler2D"):t.fragment.uniforms.add("atmosphereParameters3","vec3").add("innerFadeDistance","float").add("altitudeFade","float"),t.fragment.include(k.a),t.fragment.code.add(Object(S.a)(a||(a=Object(x.a)(["const float krESun = 0.075;\nconst float kmESun = 0.015;\n#define innerRadius radii[0]\n#define outerRadius radii[1]\n#define shellScale atmosphereParameters1.x\n#define shellDepth vec2(atmosphereParameters1.y, atmosphereParameters2.y)\n#define scaleOverScaleDepth vec2(atmosphereParameters1.z, atmosphereParameters2.z)\n#define oneOverScaleDepth vec2(atmosphereParameters1.w, atmosphereParameters2.w)"])))),e.haze||t.fragment.code.add(Object(S.a)(o||(o=Object(x.a)(["#define g atmosphereParameters2.x\n#define gSq atmosphereParameters3.x\n#define miePhaseCoefficients atmosphereParameters3.y\n#define lowerAlphaBlendBound atmosphereParameters3.z"])))),t.fragment.code.add(Object(S.a)(s||(s=Object(x.a)(["\n  // The camera's current height\n  #define cameraHeight heightParameters[0]\n  // cameraHeight^2\n  #define cameraHeightSq heightParameters[1]\n  // cameraHeightSq - outerRadiusSq; // C = ||o-c||^2 - r^2\n  #define C heightParameters[2]\n  // cameraHeightSq - (innerRadiusSq - 63756370000.0); // C = ||o-c||^2 - r^2\n  #define CSur heightParameters[3]\n\n  ","\n    // Loop constants for integral approximation\n    const float samples = 5.0;\n    const int maxSamples = 5;\n\n    // ToneMapping operators\n    vec3 expTM(vec3 inputColor,float _exposure) {\n        return pow(1.0 - exp(inputColor * -_exposure), oneOverGamma);\n    }\n\n    // Approximation for inner integral based on a radii ratio of 10.25:10\n    float scale(float _cos) {\n      float x = 1.0 - _cos;\n      return exp( -0.00287 + x * ( 0.459 + x * ( 3.83 + x * (-6.80 + x * 5.25 ))));\n    }\n\n    void main() {\n      // Obtain ray from Camera\n      vec3 worldSpaceRay = normalize(worldRay);\n\n      // Compute Atmosphere intersection; i.e. ray/sphere intersection\n      float B = 2.0 * dot(cameraPosition, worldSpaceRay); // B = 2(l * (o-c))\n      float det = B * B - 4.0 * C; // det = B^2 - 4.0* C\n\n      // idealized sphere intersection to discard early some pixels\n      float detSur = B * B - 4.0 * CSur; // det = B^2 - 4.0* C\n\n      // the minimal sample start position:\n      // at the camera by default, on the earth radius surface if the camera is underground.\n      float minRayStart = 0.0;\n  "])),e.haze?"// Camera HDR\n        const float exposure = 1.5;\n        const vec3 oneOverGamma = vec3(1.0); //Gamma = 1.0":"const float exposure = 2.0;\n        const vec3 oneOverGamma = vec3(0.454545); // Gamma = 2.2\n        vec3 reinhardTM(vec3 inputColor, float _exposure) {\n          vec3 intermediate = inputColor * _exposure;\n          intermediate /= ( 1.0 + intermediate );\n          return pow(intermediate, oneOverGamma);\n        }\n        ")),e.haze||t.fragment.code.add(Object(S.a)(c||(c=Object(x.a)(["float surfaceBlend = 0.0;\nvec4 surfaceColor = vec4(0.0);\nif (detSur >= 0.0) {\nfloat nearSurface = max(0.0, 0.5 *(-B - sqrt(detSur)));\nfloat farSurface = max(0.0, 0.5 *(-B + sqrt(detSur)));\nif (nearSurface == 0.0) {\nminRayStart = farSurface;\n}\nvec3 vPos = cameraPosition + worldSpaceRay * nearSurface;\nfloat lightAngle = dot(lightingMainDirection, normalize(vPos));\nfloat brightness = max(0.0, (smoothstep(-1.0, 0.8, 2.0 * lightAngle)));\nsurfaceColor = vec4(brightness, brightness, brightness, 1.0 - altitudeFade);\nfloat relDist = (farSurface - nearSurface) / innerFadeDistance;\nif (relDist > 1.0) {\ngl_FragColor = surfaceColor;\nreturn;\n}\nsurfaceBlend = smoothstep(0.0, 1.0, relDist * relDist);\n}"])))),t.fragment.code.add(Object(S.a)(l||(l=Object(x.a)(["\n    if (det >= 0.0) {\n    ","\n    float rayStart = 0.5 *(-B - sqrt(det)); //near intersection with atmosphere\n    ","\n\n    float scatterDistance; // calculate its scattering offset\n    // Calculate the ray's starting position\n    if (rayStart < minRayStart)\n    { // ray starts from camera or inner radius sphere to far\n      rayStart = minRayStart;\n      ","\n    }\n    ","\n    // Initialize the scattering loop variables\n    vec3 start = cameraPosition + worldSpaceRay * rayStart;\n  "])),e.haze?"\n          float depthSample = texture2D(depthTex, vtc).r;\n\n          float zNear = nearFar[0];\n          float zFar = nearFar[1];\n\n          // http://web.archive.org/web/20130416194336/http://olivers.posterous.com/linear-depth-in-glsl-for-real\n          float zNorm = 2.0 * depthSample - 1.0;\n          float linDepth = 2.0 * zNear * zFar /\n            (zFar + zNear - zNorm * (zFar - zNear));\n\n          float rayEnd;\n          float altitudeAlpha = 1.0;\n\n          // find intersections with ground, but only between the near and far\n          // clipping planes.\n          if (depthSample < 1.0 && depthSample > 0.0) {\n            vec3 cameraSpaceRay = normalize(eyeDir);\n            cameraSpaceRay /= cameraSpaceRay.z;\n            cameraSpaceRay *= linDepth;\n\n            float cameraSpaceRayLength = length(cameraSpaceRay);\n\n            vec3 world = cameraPosition + worldSpaceRay * cameraSpaceRayLength;\n            float worldRadiusSq = dot(world, world);\n\n            // Handle tall structures:\n            // https://devtopia.esri.com/WebGIS/arcgis-js-api/issues/5450\n            float transitionStart = innerRadius + 20000.0;\n            float transitionHeight = 25000.0;\n            float transitionEnd = transitionStart + transitionHeight;\n\n            float edge0 = transitionStart * transitionStart;\n            float edge1 = transitionEnd * transitionEnd;\n\n            altitudeAlpha = 1.0 - clamp((worldRadiusSq - edge0) / (edge1 - edge0), 0.0, 1.0);\n            rayEnd = cameraSpaceRayLength;\n\n            if (altitudeAlpha > 0.0 && detSur > 0.0) {\n              float nearSurface = 0.5 * ( -B - sqrt(detSur) );\n              float interp = clamp(((cameraHeight - innerRadius) - 2000000.0) / 6000000.0, 0.0, 1.0);\n              rayEnd = mix(cameraSpaceRayLength, nearSurface, interp);\n            }\n          }":"",e.haze?"float near = abs(rayStart);\n        float far = abs(rayEnd);":"float rayEnd = 0.5 *(-B + sqrt(det)); //far intersection with atmosphere",e.haze?"":"// clamp to value at inner radius altitude\n          scatterDistance = shellScale * min(0.0, innerRadius - cameraHeight);",e.haze?"":"else { // outside atmosphere\n          scatterDistance = -1.0;\n        }")),e.haze&&t.fragment.code.add(Object(S.a)(u||(u=Object(x.a)(["vec3 end = cameraPosition + worldSpaceRay * rayEnd;\nfloat endLength = length(end);\nvec2 altitudeInterval = vec2(length(start) - innerRadius, endLength - innerRadius);\nif (altitudeInterval.x < 0.0) {\naltitudeInterval = -altitudeInterval;\n}\nfloat lightAngle = dot(lightingMainDirection, end) / endLength;\nif (near > far)\n{\nif (altitudeInterval.x < altitudeInterval.y)\n{\nend = cameraPosition + worldSpaceRay * rayStart;\nstart = cameraPosition + worldSpaceRay * rayEnd;\nworldSpaceRay *= -1.0;\nfloat tmp = altitudeInterval.x;\naltitudeInterval.x = altitudeInterval.y;\naltitudeInterval.y = tmp;\n}\nelse if (altitudeInterval.x == altitudeInterval.y)\n{\naltitudeInterval.x += 1.0;\n}\n}\nif (altitudeInterval.x > outerRadius - innerRadius)\n{\nscatterDistance = innerRadius - outerRadius;\n} else\n{\nscatterDistance = altitudeInterval.y - altitudeInterval.x;\n}"])))),t.fragment.code.add(Object(S.a)(d||(d=Object(x.a)(["vec2 opticalStartDepth = exp(scatterDistance * oneOverScaleDepth);\nfloat rayLength = rayEnd - rayStart;\nfloat sampleLength = rayLength / samples;\nfloat scaledLength = sampleLength * shellScale;\nvec3 sampleRay = worldSpaceRay * sampleLength;\nvec3 samplePoint = start + sampleRay * 0.5;"])))),e.haze?t.fragment.code.add(Object(S.a)(h||(h=Object(x.a)(["float cameraAngle = dot(-worldSpaceRay, end) / length(end);\nfloat scaleCameraAngle = scale(cameraAngle);\nvec2 cameraOffset = scaleCameraAngle * opticalStartDepth;\nfloat scaledValues = scale(lightAngle) + scaleCameraAngle;\nvec2 scaledValuesDepth = scaledValues * shellDepth;"])))):t.fragment.code.add(Object(S.a)(f||(f=Object(x.a)(["float cameraAngle = dot(worldSpaceRay, start / length(start));\nfloat angleMultiplier = cameraAngle > 0.0 ? cameraAngle : 0.0;\nfloat scaleCameraAngle = scale(cameraAngle);\nvec2 cameraOffset = scaleCameraAngle * opticalStartDepth * shellDepth;"])))),t.fragment.code.add(Object(S.a)(p||(p=Object(x.a)(["vec3 frontColor = vec3(0.0);\nvec3 frontColorBlue = vec3(0.0);\nvec3 attenuate = vec3(0.0);\nvec3 attenuateBlue = vec3(0.0);\nfor(int i=0; i<maxSamples; i++) {\nfloat height = length(samplePoint);\nfloat altitude = abs(height - innerRadius);\nvec2 depth = exp(-altitude * scaleOverScaleDepth);"])))),e.haze?t.fragment.code.add(Object(S.a)(b||(b=Object(x.a)(["vec2 scatter = depth * scaledValuesDepth - cameraOffset;"])))):t.fragment.code.add(Object(S.a)(v||(v=Object(x.a)(["float lightAngle = dot(lightingMainDirection, samplePoint) / height;\nfloat cameraAngle = dot(worldSpaceRay, samplePoint) / height;\nfloat tmpScaledValues = scale(lightAngle) - scale(cameraAngle);\nvec2 scatter = cameraOffset + tmpScaledValues * depth * shellDepth;"])))),t.fragment.code.add(Object(S.a)(m||(m=Object(x.a)(["attenuate = exp(-scatter.x * invWavelengthScaled);\nattenuateBlue = exp(-scatter.y * invWavelengthScaled);\nfrontColor += attenuate * depth.x;\nfrontColorBlue += attenuateBlue * depth.y;\nsamplePoint += sampleRay;\n}\nfloat LdotR = clamp(dot(lightingMainDirection, -worldSpaceRay ),-0.9999999,1.0);\nfloat LdotRSq = LdotR * LdotR + 1.0;"])))),e.haze?t.fragment.code.add(Object(S.a)(y||(y=Object(x.a)(["vec3 colorCoefficients = (scaledLength * 0.75 * LdotRSq) * (krESun * invWavelength + kmESun );\nvec3 color = colorCoefficients * frontColor;\nvec3 colorBlue = colorCoefficients * frontColorBlue;"])))):t.fragment.code.add(Object(S.a)(g||(g=Object(x.a)(["vec3 rayleighCoefficients = (scaledLength * 0.75 * LdotRSq * krESun) * invWavelength;\nfloat mieCoefficients = scaledLength * kmESun * miePhaseCoefficients * LdotRSq / pow(1.0 + gSq - 2.0 * g * LdotR, 1.5);\nvec3 color = rayleighCoefficients * frontColor + mieCoefficients * frontColor;\nvec3 colorBlue = rayleighCoefficients * frontColorBlue + mieCoefficients * frontColorBlue;"])))),t.fragment.code.add(Object(S.a)(O||(O=Object(x.a)(["vec3 ldrBlue = expTM(colorBlue, 2.0 * exposure);\nvec3 ldrRed = expTM(color, exposure);\nvec3 LDR = mix(ldrBlue, ldrRed, 0.2);"])))),e.haze?t.fragment.code.add(Object(S.a)(j||(j=Object(x.a)(["LDR *= (1.0 - cameraAngle);\nvec3 hsv = rgb2hsv(LDR);\nhsv.y = clamp(hsv.y * 1.5, 0.0, 1.0);\nLDR = hsv2rgb(hsv);\nvec3 finalColor = LDR;"])))):t.fragment.code.add(Object(S.a)(_||(_=Object(x.a)(["vec3 ldrReinhard = reinhardTM(color, exposure);\nLDR += angleMultiplier * ldrReinhard;\nfloat side = (rayEnd + rayStart) * 0.5;\nfloat atmoHeight = sqrt(cameraHeightSq - side * side);\nfloat h2 = clamp(1.0 - ( atmoHeight - lowerAlphaBlendBound ) / ( outerRadius - lowerAlphaBlendBound ), 0.0, 1.0);\nvec3 finalColor = LDR * h2;\nvec3 hsv = rgb2hsv(finalColor);\nhsv.y = clamp(hsv.y * 1.5, 0.0, 1.0);\nfinalColor = hsv2rgb(hsv);"])))),t.fragment.code.add(Object(S.a)(w||(w=Object(x.a)(["\n    ","\n      } else { // Outside Atmosphere\n        gl_FragColor = vec4(0.0);\n      }\n    }\n  "])),e.haze?"gl_FragColor = vec4(finalColor, 1.0) * altitudeAlpha;":"float atmosStrength = clamp((length(ldrRed) - 0.05) * 1.05, 0.0, 1.0);\n          gl_FragColor = vec4(finalColor, atmosStrength * clamp(1.0 - ( atmoHeight - innerRadius ) / (outerRadius - innerRadius), 0.0, 1.0));\n          if (surfaceBlend > 0.0) {\n            gl_FragColor = mix(gl_FragColor, surfaceColor, surfaceBlend);\n          }")),t}var M=Object.freeze({__proto__:null,build:C})},function(e,t,r){"use strict";r.d(t,"a",(function(){return u})),r.d(t,"b",(function(){return l}));var n,i,a=r(12),o=r(376),s=r(11),c=r(87);function l(){var e=new c.a;return e.attributes.add("position","vec3"),e.attributes.add("color","vec4"),e.attributes.add("size","float"),e.varyings.add("vcolor","vec4"),e.varyings.add("vsize","float"),e.vertex.uniforms.add("transform","mat4").add("viewport","vec4").add("pixelRatio","float"),e.include(o.a),e.vertex.code.add(Object(s.a)(n||(n=Object(a.a)(["void main(void) {\nvec4 posProj = transform * vec4(position, 0);\ngl_Position = alignToPixelCenter(posProj, viewport.zw);\nvcolor = color / 1.2;\nvsize = size * 5.0 * pixelRatio;\ngl_PointSize = vsize;\n}"])))),e.fragment.code.add(Object(s.a)(i||(i=Object(a.a)(["void main() {\nfloat cap = 0.7;\nfloat scale = 1.0 / cap;\nfloat helper = clamp(length(abs(gl_PointCoord - vec2(0.5))), 0.0, cap);\nfloat alpha = clamp((cap - helper) * scale, 0.0, 1.0);\nfloat intensity = alpha * alpha * alpha;\nif (vsize < 3.0) {\nintensity *= 0.5;\n}\ngl_FragColor = vec4(vcolor.xyz, intensity);\n}"])))),e}var u=Object.freeze({__proto__:null,build:l})},function(e,t,r){"use strict";r.d(t,"a",(function(){return q})),r.d(t,"b",(function(){return G}));var n,i,a,o,s,c,l,u,d,h,f,p,b,v,m,y,g,O,j,_,w,x,k,S,T,C,M,P,A=r(12),E=r(76),R=r(654),I=r(220),D=r(120),F=r(470),L=r(112),z=r(390),V=r(110),N=r(177),U=r(11),B=r(87);function G(e){var t=new B.a;t.extensions.add("GL_OES_standard_derivatives"),t.include(z.a),t.include(R.a,e),t.include(F.a,e),1===e.output&&t.include(I.a,e),t.vertex.uniforms.add("proj","mat4").add("view","mat4").add("cameraNearFar","vec2").add("pixelRatio","float").add("miterLimit","float").add("screenSize","vec2"),t.attributes.add("position","vec3"),t.attributes.add("subdivisionFactor","float"),t.attributes.add("uv0","vec2"),t.attributes.add("auxpos1","vec3"),t.attributes.add("auxpos2","vec3"),t.varyings.add("vColor","vec4"),t.varyings.add("vpos","vec3"),t.varyings.add("linearDepth","float"),e.multipassTerrainEnabled&&t.varyings.add("depth","float");var r=e.falloffEnabled,G=e.innerColorEnabled;return G&&t.varyings.add("vLineDistance","float"),r&&t.varyings.add("vLineDistanceNorm","float"),e.falloffEnabled&&t.fragment.uniforms.add("falloff","float"),e.innerColorEnabled&&(t.fragment.uniforms.add("innerColor","vec4"),t.fragment.uniforms.add("innerWidth","float")),t.vertex.code.add(Object(U.a)(n||(n=Object(A.a)(["#define PERPENDICULAR(v) vec2(v.y, -v.x);\n#define ISOUTSIDE (left.x * right.y - left.y * right.x)*uv0.y > 0.0\nfloat interp(float ncp, vec4 a, vec4 b) {\nreturn (-ncp - a.z) / (b.z - a.z);\n}\nvec2 rotate(vec2 v, float a) {\nfloat s = sin(a);\nfloat c = cos(a);\nmat2 m = mat2(c, -s, s, c);\nreturn m * v;\n}"])))),t.vertex.code.add(Object(U.a)(i||(i=Object(A.a)(["vec4 projectAndScale(vec4 pos) {\nvec4 posNdc = proj * pos;\nposNdc.xy *= screenSize / posNdc.w;\nreturn posNdc;\n}"])))),t.vertex.code.add(Object(U.a)(a||(a=Object(A.a)(["\n    void clipAndTransform(inout vec4 pos, inout vec4 prev, inout vec4 next, in bool isStartVertex) {\n      float vnp = cameraNearFar[0] * 0.99;\n\n      //current pos behind ncp --\x3e we need to clip\n      if(pos.z > -cameraNearFar[0]) {\n        if (!isStartVertex) {\n          //previous in front of ncp\n          if(prev.z < -cameraNearFar[0]) {\n            pos = mix(prev, pos, interp(vnp, prev, pos));\n            next = pos;\n          } else {\n            pos = vec4(0.0, 0.0, 0.0, 1.0);\n          }\n        }\n        //next in front of ncp\n        if(isStartVertex) {\n          if(next.z < -cameraNearFar[0]) {\n            pos = mix(pos, next, interp(vnp, pos, next));\n            prev = pos;\n          } else {\n            pos = vec4(0.0, 0.0, 0.0, 1.0);\n          }\n        }\n      } else {\n        //current position visible\n        //previous behind ncp\n        if (prev.z > -cameraNearFar[0]) {\n          prev = mix(pos, prev, interp(vnp, pos, prev));\n        }\n        //next behind ncp\n        if (next.z > -cameraNearFar[0]) {\n          next = mix(next, pos, interp(vnp, next, pos));\n        }\n      }\n\n      ","\n      linearDepth = (-pos.z - cameraNearFar[0]) / (cameraNearFar[1] - cameraNearFar[0]);\n\n      pos = projectAndScale(pos);\n      next = projectAndScale(next);\n      prev = projectAndScale(prev);\n    }\n"])),e.multipassTerrainEnabled?"depth = pos.z;":"")),t.vertex.code.add(Object(U.a)(o||(o=Object(A.a)(["void main(void) {\nfloat coverage = 1.0;\nvpos = position;\nif (uv0.y == 0.0) {\ngl_Position = vec4(1e038, 1e038, 1e038, 1.0);\n}\nelse {\nbool isStartVertex = abs(abs(uv0.y)-3.0) == 1.0;\nbool isJoin = abs(uv0.y)-3.0 < 0.0;\nfloat lineWidth = getSize() * pixelRatio;\nif (lineWidth < 1.0) {\ncoverage = lineWidth;\nlineWidth = 1.0;\n}else{\nlineWidth = floor(lineWidth + 0.5);\n}\nvec4 pos  = view * vec4(position.xyz, 1.0);\nvec4 prev = view * vec4(auxpos1.xyz, 1.0);\nvec4 next = view * vec4(auxpos2.xyz, 1.0);\nclipAndTransform(pos, prev, next, isStartVertex);\nvec2 left = (pos.xy - prev.xy);\nvec2 right = (next.xy - pos.xy);\nfloat leftLen = length(left);\nfloat rightLen = length(right);"])))),e.stippleEnabled&&t.vertex.code.add(Object(U.a)(s||(s=Object(A.a)(["vec4 stippleSegmentInfo = mix(vec4(pos.xy, right), vec4(prev.xy, left), uv0.x);\nvec2 stippleSegmentOrigin = stippleSegmentInfo.xy;\nvec2 stippleSegmentDirection = stippleSegmentInfo.zw;"])))),t.vertex.code.add(Object(U.a)(c||(c=Object(A.a)(["left = (leftLen > 0.001) ? left/leftLen : vec2(0.0, 0.0);\nright = (rightLen > 0.001) ? right/rightLen : vec2(0.0, 0.0);\nvec2 capDisplacementDir = vec2(0, 0);\nvec2 joinDisplacementDir = vec2(0, 0);\nfloat displacementLen = lineWidth;\nif (isJoin) {\nbool isOutside = ISOUTSIDE;\njoinDisplacementDir = normalize(left + right);\njoinDisplacementDir = PERPENDICULAR(joinDisplacementDir);\nif (leftLen > 0.001 && rightLen > 0.001) {\nfloat nDotSeg = dot(joinDisplacementDir, left);\ndisplacementLen /= length(nDotSeg * left - joinDisplacementDir);\nif (!isOutside) {\ndisplacementLen = min(displacementLen, min(leftLen, rightLen)/abs(nDotSeg));\n}\n}\nif (isOutside && (displacementLen > miterLimit * lineWidth)) {"])))),e.roundJoins?t.vertex.code.add(Object(U.a)(l||(l=Object(A.a)(["vec2 startDir;\nvec2 endDir;\nif (leftLen < 0.001) {\nstartDir = right;\n}\nelse{\nstartDir = left;\n}\nstartDir = normalize(startDir);\nstartDir = PERPENDICULAR(startDir);\nif (rightLen < 0.001) {\nendDir = left;\n}\nelse{\nendDir = right;\n}\nendDir = normalize(endDir);\nendDir = PERPENDICULAR(endDir);\nfloat rotationAngle = acos(clamp(dot(startDir, endDir), -1.0, 1.0));\njoinDisplacementDir = rotate(startDir, -sign(uv0.y) * subdivisionFactor * rotationAngle);"])))):t.vertex.code.add(Object(U.a)(u||(u=Object(A.a)(["if (leftLen < 0.001) {\njoinDisplacementDir = right;\n}\nelse if (rightLen < 0.001) {\njoinDisplacementDir = left;\n}\nelse {\njoinDisplacementDir = isStartVertex ? right : left;\n}\njoinDisplacementDir = normalize(joinDisplacementDir);\njoinDisplacementDir = PERPENDICULAR(joinDisplacementDir);"])))),t.vertex.code.add(Object(U.a)(d||(d=Object(A.a)(["displacementLen = lineWidth;\n}\n} else {\nif (leftLen < 0.001) {\njoinDisplacementDir = right;\n}\nelse if (rightLen < 0.001) {\njoinDisplacementDir = left;\n}\nelse {\njoinDisplacementDir = isStartVertex ? right : left;\n}\njoinDisplacementDir = normalize(joinDisplacementDir);\njoinDisplacementDir = PERPENDICULAR(joinDisplacementDir);\ndisplacementLen = lineWidth;\ncapDisplacementDir = isStartVertex ? -right : left;"])))),e.roundCaps?t.vertex.code.add(Object(U.a)(h||(h=Object(A.a)(["float angle = subdivisionFactor*PI*0.5;\njoinDisplacementDir *= cos(angle);\ncapDisplacementDir *= sin(angle);"])))):t.vertex.code.add(Object(U.a)(f||(f=Object(A.a)(["capDisplacementDir *= subdivisionFactor;"])))),t.vertex.code.add(Object(U.a)(p||(p=Object(A.a)(["\n  }\n\n  // Displacement (in pixels) caused by join/or cap\n  vec2 dpos = joinDisplacementDir * sign(uv0.y) * displacementLen + capDisplacementDir * displacementLen;\n\n  ","\n\n  ","\n  ","\n\n  pos.xy += dpos;\n  "])),r||G?Object(U.a)(b||(b=Object(A.a)(["float lineDist = lineWidth * sign(uv0.y) * pos.w;"]))):"",G?Object(U.a)(v||(v=Object(A.a)(["vLineDistance = lineDist;"]))):"",r?Object(U.a)(m||(m=Object(A.a)(["vLineDistanceNorm = lineDist / lineWidth;"]))):"")),e.stippleEnabled&&(t.vertex.code.add(Object(U.a)(y||(y=Object(A.a)(["{\nvec2 posVec = pos.xy - stippleSegmentOrigin;\nfloat stippleSegmentDirectionLength = length(stippleSegmentDirection);"])))),e.stippleIntegerRepeatsEnabled&&t.vertex.code.add(Object(U.a)(g||(g=Object(A.a)(["float numberOfPatternRepeats = stippleSegmentDirectionLength * 0.5 * stipplePatternPixelSizeInv;\nfloat roundedNumberOfPatternRepeats = floor(numberOfPatternRepeats);\nstipplePatternUvMax = roundedNumberOfPatternRepeats;"])))),t.vertex.code.add(Object(U.a)(O||(O=Object(A.a)(["\n      if (stippleSegmentDirectionLength >= 0.001) {\n        // Project the vertex position onto the line segment.\n        float projectedLength = dot(stippleSegmentDirection, posVec) / stippleSegmentDirectionLength * 0.5;\n     ","\n        stipplePatternUv = projectedLength * wholeNumberOfRepeatsScale * stipplePatternPixelSizeInv * pos.w;\n        } else {\n          stipplePatternUv = 1.0;\n        }\n      }\n    "])),e.stippleIntegerRepeatsEnabled?"float wholeNumberOfRepeatsScale = roundedNumberOfPatternRepeats / numberOfPatternRepeats;":"float wholeNumberOfRepeatsScale = 1.0;"))),t.vertex.code.add(Object(U.a)(j||(j=Object(A.a)(["pos.xy = pos.xy / screenSize * pos.w;\nvColor = getColor();\nvColor.a *= coverage;\ngl_Position = pos;\n}\n}"])))),e.multipassTerrainEnabled&&(t.fragment.include(D.a),t.include(L.b,e)),t.include(E.a,e),t.fragment.uniforms.add("intrinsicColor","vec4"),t.fragment.include(N.a),t.fragment.code.add(Object(U.a)(_||(_=Object(A.a)(["\n  void main() {\n    discardBySlice(vpos);\n    ","\n    float stippleAlpha = getStippleAlpha();\n    discardByStippleAlpha(stippleAlpha, stippleAlphaColorDiscard);\n\n    vec4 color = intrinsicColor * vColor;\n  "])),e.multipassTerrainEnabled?"terrainDepthTest(gl_FragCoord, depth);":"")),e.innerColorEnabled&&(t.fragment.uniforms.add("pixelRatio","float"),t.fragment.code.add(Object(U.a)(w||(w=Object(A.a)(["float distToInner = abs(vLineDistance * gl_FragCoord.w) - innerWidth;\nfloat innerAA = clamp(0.5 - distToInner, 0.0, 1.0);\nfloat innerAlpha = innerColor.a + color.a * (1.0 - innerColor.a);\ncolor = mix(color, vec4(innerColor.rgb, innerAlpha), innerAA);"]))))),t.fragment.code.add(Object(U.a)(x||(x=Object(A.a)(["vec4 finalColor = blendStipple(color, stippleAlpha);"])))),e.falloffEnabled&&t.fragment.code.add(Object(U.a)(k||(k=Object(A.a)(["finalColor.a *= pow(max(0.0, 1.0 - abs(vLineDistanceNorm * gl_FragCoord.w)), falloff);"])))),t.fragment.code.add(Object(U.a)(S||(S=Object(A.a)(["\n    if (finalColor.a < ",") {\n      discard;\n    }\n\n    ","\n    ","\n    ","\n    ","\n    ","\n  }\n  "])),U.a.float(V.c),7===e.output?Object(U.a)(T||(T=Object(A.a)(["gl_FragColor = vec4(finalColor.a);"]))):"",0===e.output?Object(U.a)(C||(C=Object(A.a)(["gl_FragColor = highlightSlice(finalColor, vpos);"]))):"",0===e.output&&e.OITEnabled?"gl_FragColor = premultiplyAlpha(gl_FragColor);":"",4===e.output?Object(U.a)(M||(M=Object(A.a)(["gl_FragColor = vec4(1.0);"]))):"",1===e.output?Object(U.a)(P||(P=Object(A.a)(["outputDepth(linearDepth);"]))):"")),t}var q=Object.freeze({__proto__:null,build:G})},function(e,t,r){"use strict";r.d(t,"a",(function(){return M})),r.d(t,"b",(function(){return C}));var n,i,a,o,s,c,l,u,d,h,f=r(12),p=r(276),b=r(76),v=r(132),m=r(109),y=r(120),g=r(112),O=r(261),j=r(148),_=r(498),w=r(430),x=r(110),k=r(177),S=r(11),T=r(87);function C(e){var t=new T.a;return t.include(v.a,{linearDepth:!1}),t.attributes.add("position","vec3"),t.attributes.add("uv0","vec2"),t.vertex.uniforms.add("proj","mat4").add("view","mat4").add("localOrigin","vec3"),t.vertex.uniforms.add("waterColor","vec4"),0!==e.output&&7!==e.output||(t.include(O.a,e),t.include(p.a,e),t.varyings.add("vuv","vec2"),t.varyings.add("vpos","vec3"),t.varyings.add("vnormal","vec3"),t.varyings.add("vtbnMatrix","mat3"),e.multipassTerrainEnabled&&t.varyings.add("depth","float"),t.vertex.code.add(Object(S.a)(n||(n=Object(f.a)(["\n      void main(void) {\n        if (waterColor.a < ",") {\n          // Discard this vertex\n          gl_Position = vec4(1e38, 1e38, 1e38, 1.0);\n          return;\n        }\n\n        vuv = uv0;\n        vpos = position;\n\n        vnormal = getLocalUp(vpos, localOrigin);\n        vtbnMatrix = getTBNMatrix(vnormal);\n\n        ","\n\n        gl_Position = transformPosition(proj, view, vpos);\n        ","\n      }\n    "])),S.a.float(x.c),e.multipassTerrainEnabled?"depth = (view * vec4(vpos, 1.0)).z;":"",0===e.output?"forwardLinearDepth();":""))),e.multipassTerrainEnabled&&(t.fragment.include(y.a),t.include(g.b,e)),7===e.output&&(t.include(b.a,e),t.fragment.uniforms.add("waterColor","vec4"),t.fragment.code.add(Object(S.a)(i||(i=Object(f.a)(["\n        void main() {\n          discardBySlice(vpos);\n          ","\n\n          gl_FragColor = vec4(waterColor.a);\n        }\n      "])),e.multipassTerrainEnabled?"terrainDepthTest(gl_FragCoord, depth);":""))),0===e.output&&(t.include(w.a,e),t.include(b.a,e),e.receiveShadows&&t.include(j.a,e),t.include(_.a,e),t.fragment.uniforms.add("waterColor","vec4").add("lightingMainDirection","vec3").add("lightingMainIntensity","vec3").add("camPos","vec3").add("timeElapsed","float").add("view","mat4"),t.fragment.include(k.a),t.fragment.code.add(Object(S.a)(a||(a=Object(f.a)(["\n      void main() {\n        discardBySlice(vpos);\n        ","\n        vec3 localUp = vnormal;\n        // the created normal is in tangent space\n        vec4 tangentNormalFoam = getSurfaceNormalAndFoam(vuv, timeElapsed);\n\n        // we rotate the normal according to the tangent-bitangent-normal-Matrix\n        vec3 n = normalize(vtbnMatrix * tangentNormalFoam.xyz);\n        vec3 v = -normalize(vpos - camPos);\n        float shadow = ",";\n        vec4 vPosView = view*vec4(vpos, 1.0);\n        vec4 final = vec4(getSeaColor(n, v, lightingMainDirection, waterColor.rgb, lightingMainIntensity, localUp, shadow, tangentNormalFoam.w, vPosView.xyz), waterColor.w);\n\n        // gamma correction\n        gl_FragColor = delinearizeGamma(final);\n        gl_FragColor = highlightSlice(gl_FragColor, vpos);\n        ","\n      }\n    "])),e.multipassTerrainEnabled?"terrainDepthTest(gl_FragCoord, depth);":"",e.receiveShadows?Object(S.a)(o||(o=Object(f.a)(["1.0 - readShadowMap(vpos, linearDepth)"]))):"1.0",e.OITEnabled?"gl_FragColor = premultiplyAlpha(gl_FragColor);":""))),2===e.output&&(t.include(O.a,e),t.include(w.a,e),t.include(b.a,e),t.varyings.add("vpos","vec3"),t.varyings.add("vuv","vec2"),t.vertex.code.add(Object(S.a)(s||(s=Object(f.a)(["\n        void main(void) {\n          if (waterColor.a < ",") {\n            // Discard this vertex\n            gl_Position = vec4(1e38, 1e38, 1e38, 1.0);\n            return;\n          }\n\n          vuv = uv0;\n          vpos = position;\n\n          gl_Position = transformPosition(proj, view, vpos);\n        }\n    "])),S.a.float(x.c))),t.fragment.uniforms.add("timeElapsed","float"),t.fragment.code.add(Object(S.a)(c||(c=Object(f.a)(["void main() {\ndiscardBySlice(vpos);\nvec4 tangentNormalFoam = getSurfaceNormalAndFoam(vuv, timeElapsed);\ntangentNormalFoam.xyz = normalize(tangentNormalFoam.xyz);\ngl_FragColor = vec4((tangentNormalFoam.xyz + vec3(1.0)) * 0.5, tangentNormalFoam.w);\n}"]))))),5===e.output&&(t.varyings.add("vpos","vec3"),t.vertex.code.add(Object(S.a)(l||(l=Object(f.a)(["\n        void main(void) {\n          if (waterColor.a < ",") {\n            // Discard this vertex\n            gl_Position = vec4(1e38, 1e38, 1e38, 1.0);\n            return;\n          }\n\n          vpos = position;\n          gl_Position = transformPosition(proj, view, vpos);\n        }\n    "])),S.a.float(x.c))),t.fragment.uniforms.add("waterColor","vec4"),t.fragment.code.add(Object(S.a)(u||(u=Object(f.a)(["void main() {\ngl_FragColor = waterColor;\n}"]))))),4===e.output&&(t.include(m.a),t.varyings.add("vpos","vec3"),t.vertex.code.add(Object(S.a)(d||(d=Object(f.a)(["\n      void main(void) {\n        if (waterColor.a < ",") {\n          // Discard this vertex\n          gl_Position = vec4(1e38, 1e38, 1e38, 1.0);\n          return;\n        }\n\n        vpos = position;\n        gl_Position = transformPosition(proj, view, vpos);\n      }\n    "])),S.a.float(x.c))),t.include(b.a,e),t.fragment.code.add(Object(S.a)(h||(h=Object(f.a)(["void main() {\ndiscardBySlice(vpos);\noutputHighlight();\n}"]))))),t}var M=Object.freeze({__proto__:null,build:C})},function(e,t,r){"use strict";r.d(t,"a",(function(){return l})),r.d(t,"b",(function(){return c}));var n,i=r(12),a=r(277),o=r(11),s=r(87);function c(){var e=new s.a;return e.include(a.a),e.fragment.uniforms.add("tex","sampler2D"),e.fragment.uniforms.add("color","vec4"),e.fragment.code.add(Object(o.a)(n||(n=Object(i.a)(["void main() {\nvec4 texColor = texture2D(tex, uv);\ngl_FragColor = texColor * color;\n}"])))),e}var l=Object.freeze({__proto__:null,build:c})},function(e,t,r){"use strict";r.d(t,"a",(function(){return J})),r.d(t,"b",(function(){return $}));var n,i,a,o,s,c,l,u,d,h,f,p,b,v,m,y,g,O,j,_=r(12),w=r(276),x=r(471),k=r(76),S=r(132),T=r(381),C=r(321),M=r(319),P=r(472),A=r(245),E=r(221),R=r(283),I=r(281),D=r(473),F=r(120),L=r(474),z=r(316),V=r(278),N=r(112),U=r(475),B=r(320),G=r(274),q=r(148),H=r(197),W=r(110),Q=r(476),Z=r(325),X=r(11),Y=r(87);function $(e){var t=new Y.a,r=t.vertex.code,$=t.fragment.code;return t.include(Q.a,{name:"Default Material Shader",output:e.output}),t.vertex.uniforms.add("proj","mat4").add("view","mat4").add("camPos","vec3").add("localOrigin","vec3"),t.include(M.a),t.varyings.add("vpos","vec3"),t.include(H.a,e),t.include(T.a,e),t.include(I.a,e),0!==e.output&&7!==e.output||(t.include(C.a,e),t.include(S.a,{linearDepth:!1}),0===e.normalType&&e.offsetBackfaces&&t.include(x.a),t.include(L.a,e),t.include(R.a,e),e.instancedColor&&t.attributes.add("instanceColor","vec4"),t.varyings.add("localvpos","vec3"),t.include(A.a,e),t.include(w.a,e),t.include(P.a,e),t.include(E.a,e),t.vertex.uniforms.add("externalColor","vec4"),t.varyings.add("vcolorExt","vec4"),e.multipassTerrainEnabled&&t.varyings.add("depth","float"),r.add(Object(X.a)(n||(n=Object(_.a)(["\n      void main(void) {\n        forwardNormalizedVertexColor();\n        vcolorExt = externalColor;\n        ","\n        vcolorExt *= vvColor();\n        vcolorExt *= getSymbolColor();\n        forwardColorMixMode();\n\n        if (vcolorExt.a < ",") {\n          gl_Position = vec4(1e38, 1e38, 1e38, 1.0);\n        }\n        else {\n          vpos = calculateVPos();\n          localvpos = vpos - view[3].xyz;\n          vpos = subtractOrigin(vpos);\n          ","\n          vpos = addVerticalOffset(vpos, localOrigin);\n          ","\n          gl_Position = transformPosition(proj, view, vpos);\n          ","\n        }\n\n        ","\n        forwardLinearDepth();\n        forwardTextureCoordinates();\n      }\n    "])),e.instancedColor?"vcolorExt *= instanceColor;":"",X.a.float(W.c),0===e.normalType?Object(X.a)(i||(i=Object(_.a)(["\n          vNormalWorld = dpNormal(vvLocalNormal(normalModel()));"]))):"",e.vertexTangents?"vTangent = dpTransformVertexTangent(tangent);":"",0===e.normalType&&e.offsetBackfaces?"gl_Position = offsetBackfacingClipPosition(gl_Position, vpos, vNormalWorld, camPos);":"",e.multipassTerrainEnabled?"depth = (view * vec4(vpos, 1.0)).z;":""))),7===e.output&&(t.include(k.a,e),t.include(W.a,e),e.multipassTerrainEnabled&&(t.fragment.include(F.a),t.include(N.b,e)),t.fragment.uniforms.add("camPos","vec3").add("localOrigin","vec3").add("opacity","float").add("layerOpacity","float"),e.hasColorTexture&&t.fragment.uniforms.add("tex","sampler2D"),t.fragment.include(Z.a),$.add(Object(X.a)(a||(a=Object(_.a)(["\n      void main() {\n        discardBySlice(vpos);\n        ","\n        ","\n        ","\n        gl_FragColor = vec4(opacity_);\n      }\n    "])),e.multipassTerrainEnabled?"terrainDepthTest(gl_FragCoord, depth);":"",e.hasColorTexture?Object(X.a)(o||(o=Object(_.a)(["\n        vec4 texColor = texture2D(tex, vuv0);\n        ","\n        discardOrAdjustAlpha(texColor);"])),e.textureAlphaPremultiplied?"texColor.rgb /= texColor.a;":""):Object(X.a)(s||(s=Object(_.a)(["vec4 texColor = vec4(1.0);"]))),e.attributeColor?Object(X.a)(c||(c=Object(_.a)(["\n        float opacity_ = layerOpacity * mixExternalOpacity(vColor.a * opacity, texColor.a, vcolorExt.a, int(colorMixMode));"]))):Object(X.a)(l||(l=Object(_.a)(["\n        float opacity_ = layerOpacity * mixExternalOpacity(opacity, texColor.a, vcolorExt.a, int(colorMixMode));\n        "])))))),0===e.output&&(t.include(k.a,e),t.include(V.a,e),t.include(z.a,e),t.include(W.a,e),e.receiveShadows&&t.include(q.a,e),e.multipassTerrainEnabled&&(t.fragment.include(F.a),t.include(N.b,e)),t.fragment.uniforms.add("camPos","vec3").add("localOrigin","vec3").add("ambient","vec3").add("diffuse","vec3").add("opacity","float").add("layerOpacity","float"),e.hasColorTexture&&t.fragment.uniforms.add("tex","sampler2D"),t.include(G.b,e),t.include(B.a,e),t.fragment.include(Z.a),t.include(U.a,e),$.add(Object(X.a)(u||(u=Object(_.a)(["\n      void main() {\n        discardBySlice(vpos);\n        ","\n        ","\n        shadingParams.viewDirection = normalize(vpos - camPos);\n        ","\n        ","\n        float ssao = evaluateAmbientOcclusionInverse();\n        ssao *= getBakedOcclusion();\n\n        float additionalAmbientScale = additionalDirectedAmbientLight(vpos + localOrigin);\n        vec3 additionalLight = ssao * lightingMainIntensity * additionalAmbientScale * ambientBoostFactor * lightingGlobalFactor;\n        ","\n        vec3 matColor = max(ambient, diffuse);\n        ","\n        ","\n        ","\n        ","\n        gl_FragColor = highlightSlice(vec4(shadedColor, opacity_), vpos);\n        ","\n      }\n    "])),e.multipassTerrainEnabled?"terrainDepthTest(gl_FragCoord, depth);":"",e.hasColorTexture?Object(X.a)(d||(d=Object(_.a)(["\n        vec4 texColor = texture2D(tex, vuv0);\n        ","\n        discardOrAdjustAlpha(texColor);"])),e.textureAlphaPremultiplied?"texColor.rgb /= texColor.a;":""):Object(X.a)(h||(h=Object(_.a)(["vec4 texColor = vec4(1.0);"]))),3===e.normalType?Object(X.a)(f||(f=Object(_.a)(["\n        vec3 normal = screenDerivativeNormal(localvpos);"]))):Object(X.a)(p||(p=Object(_.a)(["\n        shadingParams.normalView = vNormalWorld;\n        vec3 normal = shadingNormal(shadingParams);"]))),1===e.pbrMode?"applyPBRFactors();":"",e.receiveShadows?"float shadow = readShadowMap(vpos, linearDepth);":1===e.viewingMode?"float shadow = lightingGlobalFactor * (1.0 - additionalAmbientScale);":"float shadow = 0.0;",e.attributeColor?Object(X.a)(b||(b=Object(_.a)(["\n        vec3 albedo_ = mixExternalColor(vColor.rgb * matColor, texColor.rgb, vcolorExt.rgb, int(colorMixMode));\n        float opacity_ = layerOpacity * mixExternalOpacity(vColor.a * opacity, texColor.a, vcolorExt.a, int(colorMixMode));"]))):Object(X.a)(v||(v=Object(_.a)(["\n        vec3 albedo_ = mixExternalColor(matColor, texColor.rgb, vcolorExt.rgb, int(colorMixMode));\n        float opacity_ = layerOpacity * mixExternalOpacity(opacity, texColor.a, vcolorExt.a, int(colorMixMode));\n        "]))),e.hasNormalTexture?Object(X.a)(m||(m=Object(_.a)(["\n              mat3 tangentSpace = ","\n              vec3 shadedNormal = computeTextureNormal(tangentSpace, vuv0);"])),e.vertexTangents?"computeTangentSpace(normal);":"computeTangentSpace(normal, vpos, vuv0);"):"vec3 shadedNormal = normal;",1===e.pbrMode||2===e.pbrMode?1===e.viewingMode?Object(X.a)(y||(y=Object(_.a)(["vec3 normalGround = normalize(vpos + localOrigin);"]))):Object(X.a)(g||(g=Object(_.a)(["vec3 normalGround = vec3(0.0, 0.0, 1.0);"]))):Object(X.a)(O||(O=Object(_.a)([""]))),1===e.pbrMode||2===e.pbrMode?Object(X.a)(j||(j=Object(_.a)(["\n            float additionalAmbientIrradiance = additionalAmbientIrradianceFactor * lightingMainIntensity[2];\n            vec3 shadedColor = evaluateSceneLightingPBR(shadedNormal, albedo_, shadow, 1.0 - ssao, additionalLight, shadingParams.viewDirection, normalGround, mrr, emission, additionalAmbientIrradiance);"]))):"vec3 shadedColor = evaluateSceneLighting(shadedNormal, albedo_, shadow, 1.0 - ssao, additionalLight);",e.OITEnabled?"gl_FragColor = premultiplyAlpha(gl_FragColor);":""))),t.include(D.a,e),t}var J=Object.freeze({__proto__:null,build:$})},function(e,t,r){"use strict";r.d(t,"a",(function(){return Z})),r.d(t,"b",(function(){return Q}));var n,i,a,o,s,c,l,u,d,h,f,p,b,v,m,y,g,O,j,_=r(12),w=r(276),x=r(471),k=r(76),S=r(132),T=r(381),C=r(321),M=r(319),P=r(472),A=r(245),E=r(221),R=r(281),I=r(473),D=r(120),F=r(316),L=r(278),z=r(112),V=r(320),N=r(274),U=r(148),B=r(197),G=r(110),q=r(325),H=r(11),W=r(87);function Q(e){var t=new W.a,r=t.vertex.code,Q=t.fragment.code;return t.vertex.uniforms.add("proj","mat4").add("view","mat4").add("camPos","vec3").add("localOrigin","vec3"),t.include(M.a),t.varyings.add("vpos","vec3"),t.include(B.a,e),t.include(T.a,e),t.include(R.a,e),0!==e.output&&7!==e.output||(t.include(C.a,e),t.include(S.a,{linearDepth:!1}),e.offsetBackfaces&&t.include(x.a),e.instancedColor&&t.attributes.add("instanceColor","vec4"),t.varyings.add("vNormalWorld","vec3"),t.varyings.add("localvpos","vec3"),e.multipassTerrainEnabled&&t.varyings.add("depth","float"),t.include(A.a,e),t.include(w.a,e),t.include(P.a,e),t.include(E.a,e),t.vertex.uniforms.add("externalColor","vec4"),t.varyings.add("vcolorExt","vec4"),r.add(Object(H.a)(n||(n=Object(_.a)(["\n        void main(void) {\n          forwardNormalizedVertexColor();\n          vcolorExt = externalColor;\n          ","\n          vcolorExt *= vvColor();\n          vcolorExt *= getSymbolColor();\n          forwardColorMixMode();\n\n          if (vcolorExt.a < ",") {\n            gl_Position = vec4(1e38, 1e38, 1e38, 1.0);\n          }\n          else {\n            vpos = calculateVPos();\n            localvpos = vpos - view[3].xyz;\n            vpos = subtractOrigin(vpos);\n            vNormalWorld = dpNormal(vvLocalNormal(normalModel()));\n            vpos = addVerticalOffset(vpos, localOrigin);\n            gl_Position = transformPosition(proj, view, vpos);\n            ","\n          }\n          ","\n          forwardLinearDepth();\n          forwardTextureCoordinates();\n        }\n      "])),e.instancedColor?"vcolorExt *= instanceColor;":"",H.a.float(G.c),e.offsetBackfaces?"gl_Position = offsetBackfacingClipPosition(gl_Position, vpos, vNormalWorld, camPos);":"",e.multipassTerrainEnabled?Object(H.a)(i||(i=Object(_.a)(["depth = (view * vec4(vpos, 1.0)).z;"]))):""))),7===e.output&&(t.include(k.a,e),t.include(G.a,e),e.multipassTerrainEnabled&&(t.fragment.include(D.a),t.include(z.b,e)),t.fragment.uniforms.add("camPos","vec3").add("localOrigin","vec3").add("opacity","float").add("layerOpacity","float"),t.fragment.uniforms.add("view","mat4"),e.hasColorTexture&&t.fragment.uniforms.add("tex","sampler2D"),t.fragment.include(q.a),Q.add(Object(H.a)(a||(a=Object(_.a)(["\n      void main() {\n        discardBySlice(vpos);\n        ","\n        ","\n        ","\n\n        gl_FragColor = vec4(opacity_);\n      }\n    "])),e.multipassTerrainEnabled?Object(H.a)(o||(o=Object(_.a)(["terrainDepthTest(gl_FragCoord, depth);"]))):"",e.hasColorTexture?Object(H.a)(s||(s=Object(_.a)(["\n        vec4 texColor = texture2D(tex, vuv0);\n        ","\n        discardOrAdjustAlpha(texColor);"])),e.textureAlphaPremultiplied?"texColor.rgb /= texColor.a;":""):Object(H.a)(c||(c=Object(_.a)(["vec4 texColor = vec4(1.0);"]))),e.attributeColor?Object(H.a)(l||(l=Object(_.a)(["\n        float opacity_ = layerOpacity * mixExternalOpacity(vColor.a * opacity, texColor.a, vcolorExt.a, int(colorMixMode));"]))):Object(H.a)(u||(u=Object(_.a)(["\n        float opacity_ = layerOpacity * mixExternalOpacity(opacity, texColor.a, vcolorExt.a, int(colorMixMode));\n        "])))))),0===e.output&&(t.include(k.a,e),t.include(L.a,e),t.include(F.a,e),t.include(G.a,e),e.receiveShadows&&t.include(U.a,e),e.multipassTerrainEnabled&&(t.fragment.include(D.a),t.include(z.b,e)),t.fragment.uniforms.add("camPos","vec3").add("localOrigin","vec3").add("ambient","vec3").add("diffuse","vec3").add("opacity","float").add("layerOpacity","float"),t.fragment.uniforms.add("view","mat4"),e.hasColorTexture&&t.fragment.uniforms.add("tex","sampler2D"),t.include(N.b,e),t.include(V.a,e),t.fragment.include(q.a),Q.add(Object(H.a)(d||(d=Object(_.a)(["\n      void main() {\n        discardBySlice(vpos);\n        ","\n        ","\n        vec3 viewDirection = normalize(vpos - camPos);\n        ","\n        float ssao = evaluateAmbientOcclusionInverse();\n        ssao *= getBakedOcclusion();\n\n        float additionalAmbientScale = additionalDirectedAmbientLight(vpos + localOrigin);\n        vec3 additionalLight = ssao * lightingMainIntensity * additionalAmbientScale * ambientBoostFactor * lightingGlobalFactor;\n        ","\n        vec3 matColor = max(ambient, diffuse);\n        ","\n        ","\n        ","\n        ","\n        gl_FragColor = highlightSlice(vec4(shadedColor, opacity_), vpos);\n        ","\n      }\n    "])),e.multipassTerrainEnabled?Object(H.a)(h||(h=Object(_.a)(["terrainDepthTest(gl_FragCoord, depth);"]))):"",e.hasColorTexture?Object(H.a)(f||(f=Object(_.a)(["\n        vec4 texColor = texture2D(tex, vuv0);\n        ","\n        discardOrAdjustAlpha(texColor);"])),e.textureAlphaPremultiplied?"texColor.rgb /= texColor.a;":""):Object(H.a)(p||(p=Object(_.a)(["vec4 texColor = vec4(1.0);"]))),1===e.pbrMode?"applyPBRFactors();":"",e.receiveShadows?"float shadow = readShadowMap(vpos, linearDepth);":1===e.viewingMode?"float shadow = lightingGlobalFactor * (1.0 - additionalAmbientScale);":"float shadow = 0.0;",e.attributeColor?Object(H.a)(b||(b=Object(_.a)(["\n        vec3 albedo_ = mixExternalColor(vColor.rgb * matColor, texColor.rgb, vcolorExt.rgb, int(colorMixMode));\n        float opacity_ = layerOpacity * mixExternalOpacity(vColor.a * opacity, texColor.a, vcolorExt.a, int(colorMixMode));"]))):Object(H.a)(v||(v=Object(_.a)(["\n        vec3 albedo_ = mixExternalColor(matColor, texColor.rgb, vcolorExt.rgb, int(colorMixMode));\n        float opacity_ = layerOpacity * mixExternalOpacity(opacity, texColor.a, vcolorExt.a, int(colorMixMode));\n        "]))),Object(H.a)(m||(m=Object(_.a)(["\n        vec3 shadedNormal = normalize(vNormalWorld);\n        albedo_ *= 1.2;\n        vec3 viewForward = vec3(view[0][2], view[1][2], view[2][2]);\n        float alignmentLightView = clamp(dot(viewForward, -lightingMainDirection), 0.0, 1.0);\n        float transmittance = 1.0 - clamp(dot(viewForward, shadedNormal), 0.0, 1.0);\n        float treeRadialFalloff = vColor.r;\n        float backLightFactor = 0.5 * treeRadialFalloff * alignmentLightView * transmittance * (1.0 - shadow);\n        additionalLight += backLightFactor * lightingMainIntensity;"]))),1===e.pbrMode||2===e.pbrMode?1===e.viewingMode?Object(H.a)(y||(y=Object(_.a)(["vec3 normalGround = normalize(vpos + localOrigin);"]))):Object(H.a)(g||(g=Object(_.a)(["vec3 normalGround = vec3(0.0, 0.0, 1.0);"]))):Object(H.a)(O||(O=Object(_.a)([""]))),1===e.pbrMode||2===e.pbrMode?Object(H.a)(j||(j=Object(_.a)(["\n            float additionalAmbientIrradiance = additionalAmbientIrradianceFactor * lightingMainIntensity[2];\n            vec3 shadedColor = evaluateSceneLightingPBR(shadedNormal, albedo_, shadow, 1.0 - ssao, additionalLight, viewDirection, normalGround, mrr, emission, additionalAmbientIrradiance);"]))):"vec3 shadedColor = evaluateSceneLighting(shadedNormal, albedo_, shadow, 1.0 - ssao, additionalLight);",e.OITEnabled?"gl_FragColor = premultiplyAlpha(gl_FragColor);":""))),t.include(I.a,e),t}var Z=Object.freeze({__proto__:null,build:Q})},function(e,t,r){"use strict";var n=r(14),i=r(22),a=r(15),o=r(293);var s=new Map;function c(e,t,r){var c=r.transform,l=r.hasZ,u=r.hasM;s.has(t)||s.set(t,function(e){var t={};switch(e){case"esriGeometryPoint":return function(e,r,n,i){return Object(o.c)(r,t,e,n,i)};case"esriGeometryPolygon":return function(e,r,n,i){return Object(o.d)(r,t,e,n,i)};case"esriGeometryPolyline":return function(e,r,n,i){return Object(o.e)(r,t,e,n,i)};case"esriGeometryMultipoint":return function(e,r,n,i){return Object(o.b)(r,t,e,n,i)};default:return a.a.getLogger("esri.views.2d.support.arcadeOnDemand").error(new i.a("mapview-arcade","Unable to handle geometryType: ".concat(e))),function(e){return e}}}(t));var d=s.get(t)(e.geometry,c,l,u);return Object(n.a)(Object(n.a)({},e),{},{geometry:d})}t.a=function(e,t,r,i,o){var s=e.referencesGeometry()&&o?c(t,i,o):t,l=e.repurposeFeature(s);try{return e.evaluate(Object(n.a)(Object(n.a)({},r),{},{$feature:l}))}catch(u){return a.a.getLogger("esri.views.2d.support.arcadeOnDemand").warn("Feature arcade evaluation failed:",u),null}}},function(e,t,r){"use strict";r.d(t,"a",(function(){return g})),r.d(t,"b",(function(){return y}));var n,i,a,o,s,c,l=r(12),u=r(76),d=r(132),h=r(221),f=r(109),p=r(470),b=r(110),v=r(11),m=r(87);function y(e){var t=new m.a;return t.include(d.a,{linearDepth:!1}),t.include(h.a,e),t.include(p.a,e),t.vertex.uniforms.add("proj","mat4").add("view","mat4"),t.attributes.add("position","vec3"),t.varyings.add("vpos","vec3"),t.vertex.code.add(Object(v.a)(n||(n=Object(l.a)(["void main(void) {\nvpos = position;\nforwardNormalizedVertexColor();\ngl_Position = transformPosition(proj, view, vpos);"])))),e.stippleEnabled&&(t.attributes.add("auxpos1","vec3"),t.vertex.uniforms.add("ndcToPixel","vec2"),t.vertex.code.add(Object(v.a)(i||(i=Object(l.a)(["\n    vec4 vpos2 = transformPosition(proj, view, auxpos1);\n    float lineSegmentPixelSize = length((vpos2.xy / vpos2.w - gl_Position.xy / gl_Position.w) * ndcToPixel);\n\n    stipplePatternUv = lineSegmentPixelSize * stipplePatternPixelSizeInv;\n    ","\n\n    // Cancel out perspective correct interpolation because we want this length the really represent\n    // the screen distance\n    stipplePatternUv *= gl_Position.w;\n    "])),e.stippleIntegerRepeatsEnabled?"stipplePatternUv = floor(stipplePatternUv + 0.5);":""))),t.vertex.code.add(Object(v.a)(a||(a=Object(l.a)(["}"])))),4===e.output&&t.include(f.a),t.include(u.a,e),t.fragment.uniforms.add("constantColor","vec4").add("alphaCoverage","float"),t.fragment.code.add(Object(v.a)(o||(o=Object(l.a)(["\n  void main() {\n    discardBySlice(vpos);\n\n    vec4 color = ",";\n\n    float stippleAlpha = getStippleAlpha();\n    discardByStippleAlpha(stippleAlpha, stippleAlphaColorDiscard);\n\n    vec4 finalColor = blendStipple(vec4(color.rgb, color.a * alphaCoverage), stippleAlpha);\n\n    if (finalColor.a < ",") {\n      discard;\n    }\n\n    ","\n    ","\n  }\n  "])),e.attributeColor?"vColor":"constantColor",v.a.float(b.c),0===e.output?Object(v.a)(s||(s=Object(l.a)(["gl_FragColor = highlightSlice(finalColor, vpos);"]))):"",4===e.output?Object(v.a)(c||(c=Object(l.a)(["outputHighlight();"]))):"")),t}var g=Object.freeze({__proto__:null,build:y})},function(e,t,r){"use strict";r.d(t,"a",(function(){return P})),r.d(t,"b",(function(){return M}));var n,i,a,o,s,c,l,u,d,h=r(12),f=r(276),p=r(76),b=r(132),v=r(492),m=r(220),y=r(109),g=r(120),O=r(316),j=r(278),_=r(112),w=r(475),x=r(261),k=r(148),S=r(177),T=r(11),C=r(87);function M(e){var t=new C.a;return t.vertex.uniforms.add("proj","mat4").add("view","mat4").add("camPos","vec3").add("localOrigin","vec3"),t.varyings.add("vpos","vec3"),t.include(v.a,e),0!==e.output&&7!==e.output||(t.include(b.a,{linearDepth:!1}),e.receiveShadows&&t.include(k.a,e),t.include(f.a,e),t.varyings.add("vnormal","vec3"),t.varyings.add("vcolor","vec4"),e.multipassTerrainEnabled&&t.varyings.add("depth","float"),t.vertex.code.add(Object(T.a)(n||(n=Object(h.a)(["\n      void main() {\n        vpos = calculateVPos();\n        vnormal = normalize(localNormal());\n\n        ","\n        gl_Position = transformPosition(proj, view, vpos);\n\n        ","\n\n        vcolor = getColor();\n      }\n    "])),e.multipassTerrainEnabled?"depth = (view * vec4(vpos, 1.0)).z;":"",0===e.output?"forwardLinearDepth();":""))),e.multipassTerrainEnabled&&(t.fragment.include(g.a),t.include(_.b,e)),7===e.output&&(t.include(p.a,e),t.fragment.uniforms.add("camPos","vec3"),t.fragment.uniforms.add("localOrigin","vec3"),t.fragment.uniforms.add("opacity","float"),t.fragment.code.add(Object(T.a)(i||(i=Object(h.a)(["\n      void main() {\n        discardBySlice(vpos);\n        ","\n        float combinedOpacity = vcolor.a * opacity;\n        gl_FragColor = vec4(combinedOpacity);\n      }\n    "])),e.multipassTerrainEnabled?"terrainDepthTest(gl_FragCoord, depth);":""))),0===e.output&&(t.include(p.a,e),t.include(j.a,e),t.include(O.a,e),e.receiveShadows&&t.include(k.a,e),t.include(w.a,e),t.fragment.uniforms.add("camPos","vec3").add("localOrigin","vec3").add("ambient","vec3").add("diffuse","vec3").add("specular","vec3").add("opacity","float"),t.fragment.include(S.a),t.fragment.code.add(Object(T.a)(a||(a=Object(h.a)(["\n      void main() {\n        discardBySlice(vpos);\n        ","\n\n        shadingParams.viewDirection = normalize(vpos - camPos);\n        shadingParams.normalView = vnormal;\n        vec3 normal = shadingNormal(shadingParams);\n        float ssao = evaluateAmbientOcclusionInverse();\n\n        float additionalAmbientScale = additionalDirectedAmbientLight(vpos + localOrigin);\n        vec3 additionalLight = ssao * lightingMainIntensity * additionalAmbientScale * ambientBoostFactor * lightingGlobalFactor;\n        ","\n        vec3 albedo = vcolor.rgb * max(ambient, diffuse); // combine the old material parameters into a single one\n        float combinedOpacity = vcolor.a * opacity;\n        albedo += 0.25 * specular; // don't completely ignore specular for now\n\n        vec3 shadedColor = evaluateSceneLighting(normal, albedo, shadow, 1.0 - ssao, additionalLight);\n        gl_FragColor = vec4(shadedColor, combinedOpacity);\n        gl_FragColor = highlightSlice(gl_FragColor, vpos);\n        ","\n      }\n    "])),e.multipassTerrainEnabled?"terrainDepthTest(gl_FragCoord, depth);":"",e.receiveShadows?"float shadow = readShadowMap(vpos, linearDepth);":1===e.viewingMode?"float shadow = lightingGlobalFactor * (1.0 - additionalAmbientScale);":"float shadow = 0.0;",e.OITEnabled?"gl_FragColor = premultiplyAlpha(gl_FragColor);":""))),1!==e.output&&3!==e.output||(t.include(b.a,{linearDepth:!0}),t.vertex.uniforms.add("nearFar","vec2"),t.varyings.add("depth","float"),t.vertex.code.add(Object(T.a)(o||(o=Object(h.a)(["void main() {\nvpos = calculateVPos();\ngl_Position = transformPositionWithDepth(proj, view, vpos, nearFar, depth);\n}"])))),t.include(p.a,e),t.include(m.a,e),t.fragment.uniforms.add("timeElapsed","float"),t.fragment.code.add(Object(T.a)(s||(s=Object(h.a)(["void main() {\ndiscardBySlice(vpos);\noutputDepth(depth);\n}"]))))),2===e.output&&(t.include(b.a,{linearDepth:!1}),t.include(x.a,e),t.vertex.uniforms.add("viewNormal","mat4"),t.varyings.add("vnormal","vec3"),t.vertex.code.add(Object(T.a)(c||(c=Object(h.a)(["void main(void) {\nvpos = calculateVPos();\nvnormal = normalize((viewNormal * vec4(localNormal(), 1.0)).xyz);\ngl_Position = transformPosition(proj, view, vpos);\n}"])))),t.include(p.a,e),t.fragment.uniforms.add("waterColor","vec4"),t.fragment.code.add(Object(T.a)(l||(l=Object(h.a)(["void main() {\ndiscardBySlice(vpos);\nvec3 normal = normalize(vnormal);\nif (gl_FrontFacing == false) normal = -normal;\ngl_FragColor = vec4(vec3(0.5) + 0.5 * normal, 1.0);\n}"]))))),4===e.output&&(t.include(b.a,{linearDepth:!1}),t.include(x.a,e),t.vertex.uniforms.add("viewNormal","mat4"),t.varyings.add("vnormal","vec3"),t.vertex.code.add(Object(T.a)(u||(u=Object(h.a)(["void main(void) {\nvpos = calculateVPos();\ngl_Position = transformPosition(proj, view, vpos);\n}"])))),t.include(p.a,e),t.include(y.a),t.fragment.code.add(Object(T.a)(d||(d=Object(h.a)(["void main() {\ndiscardBySlice(vpos);\noutputHighlight();\n}"]))))),t}var P=Object.freeze({__proto__:null,build:M})},function(e,t,r){"use strict";r.d(t,"a",(function(){return x})),r.d(t,"b",(function(){return w}));var n,i,a,o,s,c,l,u,d=r(12),h=r(76),f=r(132),p=r(221),b=r(220),v=r(109),m=r(120),y=r(112),g=r(110),O=r(177),j=r(11),_=r(87);function w(e){var t=new _.a,r=1===e.output;return t.include(f.a,{linearDepth:r}),t.include(p.a,e),t.vertex.uniforms.add("proj","mat4").add("view","mat4"),t.attributes.add("position","vec3"),t.varyings.add("vpos","vec3"),e.multipassTerrainEnabled&&t.varyings.add("depth","float"),r&&(t.include(b.a,e),t.vertex.uniforms.add("cameraNearFar","vec2"),t.varyings.add("linearDepth","float")),t.vertex.code.add(Object(j.a)(n||(n=Object(d.a)(["\n    void main(void) {\n      vpos = position;\n      forwardNormalizedVertexColor();\n      ","\n      gl_Position = ","\n    }\n  "])),e.multipassTerrainEnabled?"depth = (view * vec4(vpos, 1.0)).z;":"",r?Object(j.a)(i||(i=Object(d.a)(["transformPositionWithDepth(proj, view, vpos, cameraNearFar, linearDepth);"]))):Object(j.a)(a||(a=Object(d.a)(["transformPosition(proj, view, vpos);"]))))),t.include(h.a,e),t.fragment.include(O.a),e.multipassTerrainEnabled&&(t.fragment.include(m.a),t.include(y.b,e)),t.fragment.uniforms.add("eColor","vec4"),4===e.output&&t.include(v.a),t.fragment.code.add(Object(j.a)(o||(o=Object(d.a)(["\n  void main() {\n    discardBySlice(vpos);\n    ","\n    vec4 color = ","\n\n    if (color.a < ",") {\n      discard;\n    }\n\n    ","\n\n    ","\n    ",";\n    ",";\n  }\n  "])),e.multipassTerrainEnabled?"terrainDepthTest(gl_FragCoord, depth);":"",e.attributeColor?"vColor * eColor;":"eColor;",j.a.float(g.c),7===e.output?Object(j.a)(s||(s=Object(d.a)(["gl_FragColor = vec4(color.a);"]))):"",0===e.output?Object(j.a)(c||(c=Object(d.a)(["gl_FragColor = highlightSlice(color, vpos); ",""])),e.OITEnabled?"gl_FragColor = premultiplyAlpha(gl_FragColor);":""):"",4===e.output?Object(j.a)(l||(l=Object(d.a)(["outputHighlight();"]))):"",1===e.output?Object(j.a)(u||(u=Object(d.a)(["outputDepth(linearDepth);"]))):"")),t}var x=Object.freeze({__proto__:null,build:w})},function(e,t,r){"use strict";r.d(t,"a",(function(){return V})),r.d(t,"b",(function(){return z}));var n,i,a,o,s,c,l,u,d,h,f,p,b,v,m,y,g,O,j,_,w,x=r(12),k=r(76),S=r(132),T=r(221),C=r(220),M=r(109),P=r(120),A=r(112),E=r(110),R=r(177),I=r(11),D=r(87),F=.70710678118,L=F;function z(e){var t=new D.a;e.draped||t.extensions.add("GL_OES_standard_derivatives");var r=1===e.output;t.include(S.a,{linearDepth:r}),t.include(T.a,e),t.vertex.uniforms.add("proj","mat4"),t.vertex.uniforms.add("view","mat4"),r&&(t.include(C.a,e),t.vertex.uniforms.add("cameraNearFar","vec2"),t.varyings.add("linearDepth","float")),e.draped?t.vertex.uniforms.add("worldToScreenRatio","float"):(t.vertex.uniforms.add("worldToScreenPerDistanceRatio","float"),t.vertex.uniforms.add("camPos","vec3"),t.attributes.add("boundingRect","mat3")),t.attributes.add("position","vec3"),t.attributes.add("uvMapSpace","vec4"),t.varyings.add("vpos","vec3"),t.varyings.add("vuv","vec2"),e.multipassTerrainEnabled&&t.varyings.add("depth","float");var z=3===e.style||4===e.style||5===e.style;return z&&t.vertex.code.add(Object(I.a)(n||(n=Object(x.a)(["\n      const mat2 rotate45 = mat2(",", ",",\n                                 ",", ",");\n    "])),I.a.float(F),I.a.float(-L),I.a.float(L),I.a.float(F))),e.draped||(t.vertex.code.add(Object(I.a)(i||(i=Object(x.a)(["vec3 projectPointToLineSegment(vec3 center, vec3 halfVector, vec3 point) {\nfloat projectedLength = dot(halfVector, point - center) / dot(halfVector, halfVector);\nreturn center + halfVector * clamp(projectedLength, -1.0, 1.0);\n}"])))),t.vertex.code.add(Object(I.a)(a||(a=Object(x.a)(["vec3 intersectRayPlane(vec3 rayDir, vec3 rayOrigin, vec3 planeNormal, vec3 planePoint) {\nfloat d = dot(planeNormal, planePoint);\nfloat t = (d - dot(planeNormal, rayOrigin)) / dot(planeNormal, rayDir);\nreturn rayOrigin + t * rayDir;\n}"])))),t.vertex.code.add(Object(I.a)(o||(o=Object(x.a)(["\n      float boundingRectDistanceToCamera() {\n        vec3 center = vec3(boundingRect[0][0], boundingRect[0][1], boundingRect[0][2]);\n        vec3 halfU = vec3(boundingRect[1][0], boundingRect[1][1], boundingRect[1][2]);\n        vec3 halfV = vec3(boundingRect[2][0], boundingRect[2][1], boundingRect[2][2]);\n        vec3 n = normalize(cross(halfU, halfV));\n\n        vec3 viewDir = - vec3(view[0][2], view[1][2], view[2][2]);\n\n        float viewAngle = dot(viewDir, n);\n        float minViewAngle = ",";\n\n        if (abs(viewAngle) < minViewAngle) {\n          // view direction is (almost) parallel to plane -> clamp it to min angle\n          float normalComponent = sign(viewAngle) * minViewAngle - viewAngle;\n          viewDir = normalize(viewDir + normalComponent * n);\n        }\n\n        // intersect view direction with infinite plane that contains bounding rect\n        vec3 planeProjected = intersectRayPlane(viewDir, camPos, n, center);\n\n        // clip to bounds by projecting to u and v line segments individually\n        vec3 uProjected = projectPointToLineSegment(center, halfU, planeProjected);\n        vec3 vProjected = projectPointToLineSegment(center, halfV, planeProjected);\n\n        // use to calculate the closest point to camera on bounding rect\n        vec3 closestPoint = uProjected + vProjected - center;\n\n        return length(closestPoint - camPos);\n      }\n    "])),I.a.float(.08715574274)))),t.vertex.code.add(Object(I.a)(s||(s=Object(x.a)(["\n    vec2 scaledUV() {\n      vec2 uv = uvMapSpace.xy ",";\n      vec2 uvCellOrigin = uvMapSpace.zw ",";\n\n      ","\n\n      vec2 uvOffset = mod(uvCellOrigin * ratio, ",");\n      return uvOffset + (uv * ratio);\n    }\n  "])),z?" * rotate45":"",z?" * rotate45":"",e.draped?Object(I.a)(c||(c=Object(x.a)(["\n            float ratio = worldToScreenRatio;\n          "]))):Object(I.a)(l||(l=Object(x.a)(["\n            float distanceToCamera = boundingRectDistanceToCamera();\n            float ratio = worldToScreenPerDistanceRatio / distanceToCamera;\n\n            // Logarithmically discretize ratio to avoid jittering\n            float step = 0.1;\n            ratio = log(ratio);\n            ratio = ceil(ratio / step) * step;\n            ratio = exp(ratio);\n          "]))),I.a.float(e.patternSpacing))),t.vertex.code.add(Object(I.a)(u||(u=Object(x.a)(["\n    void main(void) {\n      vuv = scaledUV();\n      vpos = position;\n      ","\n      forwardNormalizedVertexColor();\n      gl_Position = ","\n    }\n  "])),e.multipassTerrainEnabled?"depth = (view * vec4(vpos, 1.0)).z;":"",r?Object(I.a)(d||(d=Object(x.a)(["transformPositionWithDepth(proj, view, vpos, cameraNearFar, linearDepth);"]))):Object(I.a)(h||(h=Object(x.a)(["transformPosition(proj, view, vpos);"]))))),t.include(k.a,e),t.fragment.include(R.a),t.fragment.uniforms.add("matColor","vec4"),e.draped&&t.fragment.uniforms.add("texelSize","float"),4===e.output&&t.include(M.a),e.multipassTerrainEnabled&&(t.fragment.include(P.a),t.include(A.b,e)),4!==e.output&&(t.fragment.code.add(Object(I.a)(f||(f=Object(x.a)(["\n      const float lineWidth = ",";\n      const float spacing = ",";\n      const float spacingINV = ",";\n\n      float coverage(float p, float txlSize) {\n        p = mod(p, spacing);\n\n        float halfTxlSize = txlSize / 2.0;\n\n        float start = p - halfTxlSize;\n        float end = p + halfTxlSize;\n\n        float coverage = (ceil(end * spacingINV) - floor(start * spacingINV)) * lineWidth;\n        coverage -= min(lineWidth, mod(start, spacing));\n        coverage -= max(lineWidth - mod(end, spacing), 0.0);\n\n        return coverage / txlSize;\n      }\n    "])),I.a.float(e.lineWidth),I.a.float(e.patternSpacing),I.a.float(1/e.patternSpacing))),e.draped||t.fragment.code.add(Object(I.a)(p||(p=Object(x.a)(["const int maxSamples = 5;\nfloat sample(float p) {\nvec2 dxdy = abs(vec2(dFdx(p), dFdy(p)));\nfloat fwidth = dxdy.x + dxdy.y;\nivec2 samples = 1 + ivec2(clamp(dxdy, 0.0, float(maxSamples - 1)));\nvec2 invSamples = 1.0 / vec2(samples);\nfloat accumulator = 0.0;\nfor (int j = 0; j < maxSamples; j++) {\nif(j >= samples.y) {\nbreak;\n}\nfor (int i = 0; i < maxSamples; i++) {\nif(i >= samples.x) {\nbreak;\n}\nvec2 step = vec2(i,j) * invSamples - 0.5;\naccumulator += coverage(p + step.x * dxdy.x + step.y * dxdy.y, fwidth);\n}\n}\naccumulator /= float(samples.x * samples.y);\nreturn accumulator;\n}"]))))),t.fragment.code.add(Object(I.a)(b||(b=Object(x.a)(["\n    void main() {\n      discardBySlice(vpos);\n      ","\n      vec4 color = ","\n      color = highlightSlice(color, vpos);\n\n      ","\n\n      if (color.a < ",") {\n        discard;\n      }\n\n      ","\n\n      ","\n      ","\n      ",";\n    }\n  "])),e.multipassTerrainEnabled?"terrainDepthTest(gl_FragCoord, depth);":"",e.attributeColor?"vColor * matColor;":"matColor;",4!==e.output?Object(I.a)(v||(v=Object(x.a)(["color.a *= ",";"])),function(e){function t(t){return e.draped?Object(I.a)(j||(j=Object(x.a)(["coverage(vuv.",", texelSize)"])),t):Object(I.a)(_||(_=Object(x.a)(["sample(vuv.",")"])),t)}switch(e.style){case 3:case 0:return t("y");case 4:case 1:return t("x");case 5:case 2:return Object(I.a)(w||(w=Object(x.a)(["\n        1.0 - (1.0 - ",") * (1.0 - ",")\n      "])),t("x"),t("y"));default:return"0.0"}}(e)):"",I.a.float(E.c),7===e.output?Object(I.a)(m||(m=Object(x.a)(["gl_FragColor = vec4(color.a);"]))):"",0===e.output?Object(I.a)(y||(y=Object(x.a)(["gl_FragColor = color; ",""])),e.OITEnabled?"gl_FragColor = premultiplyAlpha(gl_FragColor);":""):"",4===e.output?Object(I.a)(g||(g=Object(x.a)(["outputHighlight();"]))):"",1===e.output?Object(I.a)(O||(O=Object(x.a)(["outputDepth(linearDepth);"]))):"")),t}var V=Object.freeze({__proto__:null,build:z})},function(e,t,r){"use strict";r.d(t,"a",(function(){return _}));var n=r(13),i=r(2),a=r(5),o=r(134),s=r(20),c=r(26),l=r(31),u=r(4),d=r(9),h=r(51),f=r(68),p=r(34),b=r(40),v=r(125),m=r(37),y=r(79),g=r(521),O=.5*Math.PI,j=O/Math.PI*180,_=function(){function e(t){Object(i.a)(this,e),this.renderCoordsHelper=t.renderCoordsHelper,this.extent=new Array(4),this.planes=new Array(6),this.maxSpan=0,this.center={origin:Object(d.e)(),direction:Object(d.e)()};for(var r=0;r<4;r++)this.extent[r]={origin:Object(d.e)(),direction:Object(d.e)(),cap:{next:null,direction:Object(d.e)()}},this.planes[r]=Object(m.d)();this.planes[4]=Object(m.d)(),this.planes[5]=Object(m.d)(),this.planesWithoutFar=this.planes.slice(0,5)}return Object(a.a)(e,[{key:"update",value:function(e,t,r){var n=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],i=this.extent;this.toRenderBoundingExtent(e,t,r),Object(u.h)(this.center.origin,i[0].origin,i[2].origin),Object(u.g)(this.center.origin,this.center.origin,.5),this.renderCoordsHelper.worldUpAtPosition(this.center.origin,this.center.direction),n||Object(u.g)(this.center.direction,this.center.direction,-1);for(var a=0;a<4;a++){var o=i[a];this.renderCoordsHelper.worldUpAtPosition(o.origin,o.direction);var s=i[3===a?0:a+1];o.cap.next=s.origin,Object(u.x)(o.cap.direction,o.origin,s.origin),Object(m.j)(o.direction,o.cap.direction,o.origin,this.planes[a]),n||Object(u.g)(o.direction,o.direction,-1)}Object(m.j)(i[0].cap.direction,i[1].cap.direction,i[0].origin,this.planes[4]),n?Object(m.r)(this.planes[4],this.planes[5]):(Object(m.c)(this.planes[4],this.planes[5]),Object(m.r)(this.planes[4],this.planes[4])),this.maxSpan=Math.max(Math.abs(e[0]-e[2]),Math.abs(e[1]-e[3])),this.maxSpanSpatialReference=t,this.minGlobalAltitude=.9*Object(f.e)(this.maxSpanSpatialReference).radius}},{key:"isVisibleInFrustum",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(null==e)return!1;if(1===this.renderCoordsHelper.viewingMode){var n=this.maxSpanSpatialReference.isGeographic?j:O*t;if(this.maxSpan>n)return!0;if(e.altitude>=this.minGlobalAltitude)return this.isVisibleInFrustumGlobal(e)}if(0===this.maxSpan){var i=this.extent[0];return!(r||!e.intersectsRay(Object(y.g)(i.origin,i.direction)))}for(var a=0;a<this.extent.length;a++){var o=this.extent[a];if(!r&&e.intersectsRay(Object(y.g)(o.origin,o.direction)))return!0;if(e.intersectsLineSegment(Object(v.e)(o.origin,o.cap.next,C),o.cap.direction))return!0}for(var s=r?this.planes:this.planesWithoutFar,c=0;c<e.lines.length;c++){var l=e.lines[c];if(Object(g.b)(s,l.origin,l.endpoint,l.direction))return!0}return!1}},{key:"toRenderBoundingExtentGlobal",value:function(e,t,r){Object(b.e)(e,x),x[2]=r,Object(h.d)(t,x,k,this.renderCoordsHelper.spatialReference),Object(c.a)(S,k),Object(p.k)(T);var i,a=Object(n.a)(w);try{for(a.s();!(i=a.n()).done;)for(var o=i.value,l=o.x0,d=o.x1,f=o.y0,v=o.y1,m=0;m<5;m++){var y=m/4;x[0]=Object(s.m)(e[l],e[d],y),x[1]=Object(s.m)(e[f],e[v],y),x[2]=r,Object(h.z)(x,t,x,this.renderCoordsHelper.spatialReference),Object(u.s)(x,x,S),Object(p.r)(T,x)}}catch(O){a.e(O)}finally{a.f()}Object(u.y)(this.extent[0].origin,T[0],T[1],T[2]),Object(u.y)(this.extent[1].origin,T[3],T[1],T[2]),Object(u.y)(this.extent[2].origin,T[3],T[4],T[2]),Object(u.y)(this.extent[3].origin,T[0],T[4],T[2]);for(var g=0;g<4;++g)Object(u.s)(this.extent[g].origin,this.extent[g].origin,k)}},{key:"toRenderBoundingExtentLocal",value:function(e,t){Object(u.y)(this.extent[0].origin,e[0],e[1],t),Object(u.y)(this.extent[1].origin,e[2],e[1],t),Object(u.y)(this.extent[2].origin,e[2],e[3],t),Object(u.y)(this.extent[3].origin,e[0],e[3],t)}},{key:"toRenderBoundingExtent",value:function(e,t,r){switch(this.renderCoordsHelper.viewingMode){case 1:this.toRenderBoundingExtentGlobal(e,t,r);break;case 2:this.toRenderBoundingExtentLocal(e,r);break;default:Object(o.a)(this.renderCoordsHelper.viewingMode)}}},{key:"isVisibleInFrustumGlobal",value:function(e){if(Object(u.j)(this.center.direction,e.direction)<0)return!0;for(var t=0;t<4;t++){var r=this.extent[t];if(Object(u.j)(r.direction,e.direction)<0)return!0}return!1}}]),e}(),w=[{x0:0,y0:1,x1:2,y1:1},{x0:0,y0:3,x1:2,y1:3},{x0:0,y0:1,x1:0,y1:3},{x0:2,y0:1,x1:2,y1:3}],x=Object(d.e)(),k=Object(l.d)(),S=Object(l.d)(),T=Object(p.h)(),C=Object(v.c)()},function(e,t,r){"use strict";r.d(t,"a",(function(){return l})),r.d(t,"b",(function(){return c}));var n,i,a=r(12),o=r(11),s=r(87);function c(){var e=new s.a;return e.attributes.add("position","vec2"),e.attributes.add("uv0","vec2"),e.vertex.uniforms.add("scale","float"),e.vertex.uniforms.add("offset","vec2"),e.varyings.add("uv","vec2"),e.vertex.code.add(Object(o.a)(n||(n=Object(a.a)(["void main(void) {\ngl_Position = vec4(position, 0.0, 1.0);\nuv = uv0 * scale + offset;\n}"])))),e.fragment.uniforms.add("tex","sampler2D"),e.fragment.uniforms.add("opacity","float"),e.fragment.code.add(Object(o.a)(i||(i=Object(a.a)(["void main() {\nvec4 color = texture2D(tex, uv);\ngl_FragColor = vec4(color.xyz, 1.0) * color.a * opacity;\n}"])))),e}var l=Object.freeze({__proto__:null,build:c})},function(e,t,r){"use strict";r.d(t,"a",(function(){return j})),r.d(t,"b",(function(){return O}));var n,i,a,o,s,c,l,u,d,h,f=r(12),p=r(660),b=r(661),v=r(675),m=r(177),y=r(11),g=r(87);function O(e){var t=new g.a;return t.include(p.a),t.include(v.a),t.include(b.a),0===e.output?function(e,t){e.fragment.uniforms.add("u_bandCount","int"),e.fragment.uniforms.add("u_minCutOff","float",3),e.fragment.uniforms.add("u_maxCutOff","float",3),e.fragment.uniforms.add("u_factor","float",3),e.fragment.uniforms.add("u_minOutput","float"),e.fragment.uniforms.add("u_maxOutput","float"),e.fragment.uniforms.add("u_useGamma","bool"),e.fragment.uniforms.add("u_gamma","float",3),e.fragment.uniforms.add("u_gammaCorrection","float",3),e.fragment.code.add(Object(y.a)(i||(i=Object(f.a)(["float stretchOneValue(float val, float minCutOff, float maxCutOff, float minOutput, float maxOutput, float factor, bool useGamma, float gamma, float gammaCorrection) {\nif (val >= maxCutOff) {\nreturn maxOutput;\n} else if (val <= minCutOff) {\nreturn minOutput;\n}\nfloat stretchedVal;\nif (useGamma) {\nfloat tempf = 1.0;\nfloat outRange = maxOutput - minOutput;\nfloat relativeVal = (val - minCutOff) / (maxCutOff - minCutOff);\nif (gamma > 1.0) {\ntempf -= pow(1.0 / outRange, relativeVal * gammaCorrection);\n}\nstretchedVal = (tempf * outRange * pow(relativeVal, 1.0 / gamma) + minOutput) / 255.0;\n} else {\nstretchedVal = minOutput + (val - minCutOff) * factor;\n}\nreturn stretchedVal;\n}"]))));var r=t?Object(y.a)(a||(a=Object(f.a)(["gl_FragColor = colormap(vec4(grayVal, grayVal, grayVal, currentPixel.a), !u_useGamma);"]))):Object(y.a)(o||(o=Object(f.a)(["gl_FragColor = vec4(grayVal, grayVal, grayVal, 1.0) * currentPixel.a * u_opacity;"])));e.fragment.code.add(Object(y.a)(s||(s=Object(f.a)(["\n      void main() {\n        vec2 pixelLocation = getPixelLocation(v_texcoord);\n        if (isOutside(pixelLocation)) {\n          gl_FragColor = vec4(0.0, 0.0, 0.0, 0.0);\n          return;\n        }\n\n        vec4 currentPixel = getPixel(pixelLocation);\n        if (currentPixel.a == 0.0) {\n          gl_FragColor = vec4(0.0, 0.0, 0.0, 0.0);\n          return;\n        }\n\n        if (u_bandCount == 1) {\n          float grayVal = stretchOneValue(currentPixel.r, u_minCutOff[0], u_maxCutOff[0], u_minOutput, u_maxOutput, u_factor[0], u_useGamma, u_gamma[0], u_gammaCorrection[0]);\n          ","\n        } else {\n          float redVal = stretchOneValue(currentPixel.r, u_minCutOff[0], u_maxCutOff[0], u_minOutput, u_maxOutput, u_factor[0], u_useGamma, u_gamma[0], u_gammaCorrection[0]);\n          float greenVal = stretchOneValue(currentPixel.g, u_minCutOff[1], u_maxCutOff[1], u_minOutput, u_maxOutput, u_factor[1], u_useGamma, u_gamma[1], u_gammaCorrection[1]);\n          float blueVal = stretchOneValue(currentPixel.b, u_minCutOff[2], u_maxCutOff[2], u_minOutput, u_maxOutput, u_factor[2], u_useGamma, u_gamma[2], u_gammaCorrection[2]);\n          gl_FragColor = vec4(redVal, greenVal, blueVal, 1.0) * currentPixel.a * u_opacity;\n        }\n      }\n    "])),r))}(t,e.applyColormap):1===e.output?t.fragment.code.add(Object(y.a)(n||(n=Object(f.a)(["void main() {\nvec2 pixelLocation = getPixelLocation(v_texcoord);\nif (isOutside(pixelLocation)) {\ngl_FragColor = vec4(0.0, 0.0, 0.0, 0.0);\nreturn;\n}\nvec4 currentPixel = getPixel(pixelLocation);\ngl_FragColor = colormap(currentPixel, true);\n}"])))):2===e.output&&function(e,t){e.fragment.uniforms.add("u_hillshadeType","int"),e.fragment.uniforms.add("u_sinZcosAs","float",6),e.fragment.uniforms.add("u_sinZsinAs","float",6),e.fragment.uniforms.add("u_cosZs","float",6),e.fragment.uniforms.add("u_weights","float",6),e.fragment.uniforms.add("u_factor","vec2"),e.fragment.uniforms.add("u_applyColormap","bool"),e.fragment.uniforms.add("u_minValue","float"),e.fragment.uniforms.add("u_maxValue","float"),e.fragment.uniforms.add("u_srcImageSize","vec2"),e.fragment.include(m.a),e.fragment.code.add(Object(y.a)(c||(c=Object(f.a)(["vec4 overlay(float val, float minValue, float maxValue, float hillshade, float alpha) {\nval = clamp((val - minValue) / (maxValue - minValue), 0.0, 1.0);\nvec4 rgb = colormap(vec4(val, val, val, 1.0), false);\nvec3 hsv = rgb2hsv(rgb.xyz);\nhsv.z = hillshade;\nreturn vec4(hsv2rgb(hsv) * alpha, alpha);\n}"])))),e.fragment.code.add(Object(y.a)(l||(l=Object(f.a)(["float getNeighborHoodAlpha(float a, float b, float c, float d, float e, float f, float g, float h, float i){\nif (a == 0.0 || a == 0.0 || a==0.0 || a == 0.0 || a == 0.0 || a==0.0 || a == 0.0 || a == 0.0 || a==0.0) {\nreturn 0.0;\n}  else {\nreturn e;\n}\n}"]))));var r=t?Object(y.a)(u||(u=Object(f.a)(["gl_FragColor = overlay(ve.r, u_minValue, u_maxValue, hillshade, alpha);"]))):Object(y.a)(d||(d=Object(f.a)(["hillshade *= alpha;\ngl_FragColor = vec4(hillshade, hillshade, hillshade, alpha);"])));e.fragment.code.add(Object(y.a)(h||(h=Object(f.a)(["\n    void main() {\n      vec2 pixelLocation = getPixelLocation(v_texcoord);\n      if (isOutside(pixelLocation)) {\n        gl_FragColor = vec4(0.0, 0.0, 0.0, 0.0);\n        return;\n      }\n\n      vec4 currentPixel = getPixel(pixelLocation);\n      if (currentPixel.a == 0.0) {\n        gl_FragColor = vec4(0.0, 0.0, 0.0, 0.0);\n        return;\n      }\n\n      //mirror edge pixels\n      vec2 axy = vec2(-1.0, -1.0);\n      vec2 bxy = vec2(0.0, -1.0);\n      vec2 cxy = vec2(1.0, -1.0);\n      vec2 dxy = vec2(-1.0, 0.0);\n      vec2 fxy = vec2(1.0, 0.0);\n      vec2 gxy = vec2(-1.0, 1.0);\n      vec2 hxy = vec2(0.0, 1.0);\n      vec2 ixy = vec2(1.0, 1.0);\n      vec2 onePixel = 1.0 / u_srcImageSize;\n      if (pixelLocation.s < onePixel.s) {\n        axy[0] = 1.0;\n        dxy[0] = 1.0;\n        gxy[0] = 1.0;\n      }\n      if (pixelLocation.t < onePixel.t) {\n        axy[1] = 1.0;\n        bxy[1] = 1.0;\n        cxy[1] = 1.0;\n      }\n      if (pixelLocation.s > 1.0 - onePixel.s) {\n        cxy[0] = -1.0;\n        fxy[0] = -1.0;\n        ixy[0] = -1.0;\n      }\n      if (pixelLocation.t > 1.0 - onePixel.t) {\n        gxy[1] = -1.0;\n        hxy[1] = -1.0;\n        ixy[1] = -1.0;\n      }\n\n      // calculate hillshade\n      vec4 va = texture2D(u_image, pixelLocation + onePixel * axy);\n      vec4 vb = texture2D(u_image, pixelLocation + onePixel * bxy);\n      vec4 vc = texture2D(u_image, pixelLocation + onePixel * cxy);\n      vec4 vd = texture2D(u_image, pixelLocation + onePixel * dxy);\n      vec4 ve = texture2D(u_image, pixelLocation);\n      vec4 vf = texture2D(u_image, pixelLocation + onePixel * fxy);\n      vec4 vg = texture2D(u_image, pixelLocation + onePixel * gxy);\n      vec4 vh = texture2D(u_image, pixelLocation + onePixel * hxy);\n      vec4 vi = texture2D(u_image, pixelLocation + onePixel * ixy);\n\n      // calculate the rate of z change along the x, y, and diagonal direction\n      float dzx = (vc + 2.0 * vf + vi - va - 2.0 * vd - vg).r * u_factor.s;\n      float dzy = (vg + 2.0 * vh + vi - va - 2.0 * vb - vc).r * u_factor.t;\n      float dzd = sqrt(1.0 + dzx * dzx + dzy * dzy);\n      float hillshade = 0.0;\n\n      // traditional single light source\n      if (u_hillshadeType == 0){\n        float cosDelta = u_sinZsinAs[0] * dzy - u_sinZcosAs[0] * dzx;\n        float z = (u_cosZs[0] + cosDelta) / dzd;\n        if (z < 0.0)  z = 0.0;\n        hillshade = z;\n      } else {\n        // multi-directional with 6 light sources\n        for (int k = 0; k < 6; k++) {\n        float cosDelta = u_sinZsinAs[k] * dzy - u_sinZcosAs[k] * dzx;\n        float z = (u_cosZs[k] + cosDelta) / dzd;\n        if (z < 0.0) z = 0.0;\n        hillshade = hillshade + z * u_weights[k];\n        if (k == 5) break;\n        }\n      }\n\n      // set color\n      float alpha = getNeighborHoodAlpha(va.a, vb.a, vc.a, vd.a, ve.a, vf.a, vg.a, vh.a, vi.a);\n      alpha *= u_opacity;\n      ","\n    }\n  "])),r))}(t,e.applyColormap),t}var j=Object.freeze({__proto__:null,build:O})},function(e,t,r){"use strict";r.d(t,"a",(function(){return B})),r.d(t,"b",(function(){return U}));var n,i,a,o,s,c,l,u,d,h,f,p,b,v,m,y,g,O,j,_,w,x,k,S,T=r(12),C=r(76),M=r(132),P=r(662),A=r(220),E=r(109),R=r(278),I=r(261),D=r(426),F=r(663),L=r(664),z=r(476),V=r(11),N=r(87);function U(e){var t=new N.a;if(t.include(z.a,{name:"Terrain Shader",output:e.output}),t.include(F.a),t.attributes.add("position","vec3"),t.attributes.add("uv0","vec2"),t.vertex.uniforms.add("proj","mat4").add("view","mat4").add("origin","vec3").add("skirtScale","float"),0===e.output){t.include(M.a,{linearDepth:!1}),t.include(I.a,e),t.include(L.a,e);var r=0!==e.overlayMode,U=2===e.overlayMode;r&&t.include(D.a,{pbrMode:3,useCustomDTRExponentForWater:!1,ssrEnabled:e.ssrEnabled,highStepCount:e.highStepCount}),U&&t.include(P.a,e),t.varyings.add("vnormal","vec3"),t.varyings.add("vpos","vec3"),t.vertex.uniforms.add("viewNormal","mat4"),e.receiveShadows&&t.varyings.add("linearDepth","float"),e.tileBorders&&t.varyings.add("vuv","vec2"),e.atmosphere&&(t.vertex.uniforms.add("lightingMainDirection","vec3"),t.varyings.add("wnormal","vec3"),t.varyings.add("wlight","vec3")),e.screenSizePerspective&&(t.vertex.uniforms.add("screenSizePerspective","vec4"),t.varyings.add("screenSizeDistanceToCamera","float"),t.varyings.add("screenSizeCosAngle","float")),t.vertex.code.add(Object(V.a)(n||(n=Object(T.a)(["\n      void main(void) {\n        vpos = position;\n        vnormal = getLocalUp(vpos, origin);\n\n        vec2 uv = uv0;\n        vpos = applySkirts(uv, vpos, vnormal, skirtScale);\n        ","\n        ","\n        ","\n        gl_Position = transformPosition(proj, view, vpos);\n        ","\n        forwardTextureCoordinates(uv);\n        ","\n        ","\n      }\n    "])),e.atmosphere?Object(V.a)(i||(i=Object(T.a)(["\n        wnormal = (viewNormal * vec4(normalize(vpos + origin), 1.0)).xyz;\n        wlight = (view  * vec4(lightingMainDirection, 1.0)).xyz;"]))):"",e.tileBorders?Object(V.a)(a||(a=Object(T.a)(["vuv = uv;"]))):"",e.screenSizePerspective?Object(V.a)(o||(o=Object(T.a)(["\n        vec3 viewPos = (view * vec4(vpos, 1.0)).xyz;\n        screenSizeDistanceToCamera = length(viewPos);\n        vec3 viewSpaceNormal = (viewNormal * vec4(normalize(vpos + origin), 1.0)).xyz;\n        screenSizeCosAngle = abs(viewSpaceNormal.z);"]))):"",e.receiveShadows?Object(V.a)(s||(s=Object(T.a)(["linearDepth = gl_Position.w;"]))):"",r?Object(V.a)(c||(c=Object(T.a)(["setOverlayVTC(uv);"]))):"",U?Object(V.a)(l||(l=Object(T.a)(["forwardVertexTangent(vnormal);"]))):Object(V.a)(u||(u=Object(T.a)([""]))))),t.extensions.add("GL_OES_standard_derivatives"),t.extensions.add("GL_EXT_shader_texture_lod"),t.include(C.a,e),t.include(R.a,e),t.fragment.uniforms.add("camPos","vec3").add("viewDirection","vec3").add("ssaoTex","sampler2D").add("viewportPixelSz","vec4").add("opacity","float"),e.screenSizePerspective&&t.fragment.uniforms.add("screenSizePerspective","vec4"),U&&(t.fragment.uniforms.add("ovWaterTex","sampler2D"),t.fragment.uniforms.add("view","mat4")),t.fragment.code.add(Object(V.a)(d||(d=Object(T.a)(["const vec3 ambient = vec3(0.2, 0.2, 0.2);\nconst vec3 diffuse = vec3(0.8, 0.8, 0.8);\nconst float diffuseHardness = 2.5;\nconst float sliceOpacity = 0.2;\nfloat lum(vec3 c) {\nfloat max = max(max(c.r, c.g), c.b);\nfloat min = min(min(c.r, c.g), c.b);\nreturn (min + max) * 0.5;\n}"])))),e.atmosphere&&t.fragment.code.add(Object(V.a)(h||(h=Object(T.a)(["vec3 atmosphere(vec3 lightPos, vec3 normal, vec3 view) {\nvec3 surfaceColor   = vec3(0.0);\nvec3 fuzzySpecColor = vec3(1.0);\nvec3 subColor       = vec3(0.0);\nfloat rollOff       = 1.0;\nvec3 Ln = normalize(lightPos);\nvec3 Nn = normalize(normal);\nvec3 Hn = normalize(view + Ln);\nfloat ldn = dot(Ln, Nn);\nfloat diffComp = max(0.0, ldn);\nfloat vdn = clamp(1.0 - dot(view, Nn), 0.0, 1.0);\nfloat ndv = dot(view, Ln);\nvec3 diffContrib = surfaceColor * diffComp;\nfloat subLamb = max(0.0, smoothstep(-rollOff, 1.0, ldn) - smoothstep(0.0, 1.0, ldn));\nvec3 subContrib = subLamb * subColor;\nvec3 vecColor = vec3(vdn);\nvec3 diffuseContrib = (subContrib + diffContrib);\nvec3 specularContrib = (vecColor * fuzzySpecColor);\nreturn (diffContrib + specularContrib) * rollOff;\n}"])))),t.fragment.code.add(Object(V.a)(f||(f=Object(T.a)(["\n      void main() {\n        ","\n        float vndl = dot(normalize(vnormal), lightingMainDirection);\n        float k = smoothstep(0.0, 1.0, clamp(vndl*diffuseHardness, 0.0, 1.0));\n        vec3 d = (1.0 - shadow/1.8) * diffuse * k;\n\n        float ssao = viewportPixelSz.w < .0 ? 1.0 : texture2D(ssaoTex, (gl_FragCoord.xy - viewportPixelSz.xy) * viewportPixelSz.zw).a;\n        vec4 tileColor = getTileColor() * opacity;\n        ","\n        if (rejectBySlice(vpos)) {\n          tileColor *= sliceOpacity;\n        }\n        vec3 atm = vec3(0.0);\n        ","\n        vec3 albedo = atm + tileColor.rgb;\n        vec3 normal = normalize(vnormal);\n\n        // heuristic shading function used in the old terrain, now used to add ambient lighting\n        float additionalAmbientScale = smoothstep(0.0, 1.0, clamp(vndl*2.5, 0.0, 1.0));\n        vec3 additionalLight = ssao * lightingMainIntensity * additionalAmbientScale * ambientBoostFactor * lightingGlobalFactor;\n\n        gl_FragColor = vec4(evaluateSceneLighting(normal, albedo, shadow, 1.0 - ssao, additionalLight), tileColor.a);\n        ","\n        ","\n        ","\n        gl_FragColor = highlightSlice(gl_FragColor, vpos);\n      }\n    "])),e.receiveShadows?Object(V.a)(p||(p=Object(T.a)(["float shadow = readShadowMap(vpos, linearDepth);"]))):Object(V.a)(b||(b=Object(T.a)(["float shadow = 0.0;"]))),r?Object(V.a)(v||(v=Object(T.a)(["\n            vec4 overlayColorOpaque = getOverlayColor(ovColorTex, vtcOverlay);\n            vec4 overlayColor = overlayOpacity * overlayColorOpaque;\n            vec4 groundColor = tileColor;\n            tileColor = tileColor * (1.0 - overlayColor.a) + overlayColor;"]))):"",e.atmosphere?Object(V.a)(m||(m=Object(T.a)(["\n            float ndotl = max(0.0, min(1.0, vndl));\n            atm = atmosphere(wlight, wnormal, -viewDirection);\n            atm *= max(0.0, min(1.0, (1.0-lum(tileColor.rgb)*1.5))); //avoid atmosphere on bright base maps\n            atm *= max(0.0, min(1.0, ndotl*2.0)); // avoid atmosphere on dark side of the globe\n            atm *= tileColor.a; // premultiply with tile alpha"]))):"",U?Object(V.a)(y||(y=Object(T.a)(["\n            vec4 overlayWaterMask = getOverlayColor(ovWaterTex, vtcOverlay);\n            float waterNormalLength = length(overlayWaterMask);\n            if (waterNormalLength > 0.95) {\n              mat3 tbnMatrix = mat3(tbnTangent, tbnBiTangent, vnormal);\n              vec4 waterOverlayColor = vec4(overlayColor.w > 0.0 ? overlayColorOpaque.xyz/overlayColor.w : vec3(1.0), overlayColor.w);\n              vec4 viewPosition = view*vec4(vpos, 1.0);\n              vec4 waterColorLinear = getOverlayWaterColor(overlayWaterMask, waterOverlayColor, -normalize(vpos - camPos), shadow, vnormal, tbnMatrix, viewPosition.xyz);\n              vec4 waterColorNonLinear = delinearizeGamma(vec4(waterColorLinear.xyz, 1.0));\n              // un-gamma the ground color to mix in linear space\n              gl_FragColor = mix(groundColor, waterColorNonLinear, waterColorLinear.w);\n            }"]))):"",e.screenSizePerspective?Object(V.a)(g||(g=Object(T.a)(["\n          float perspectiveScale = screenSizePerspectiveScaleFloat(1.0, screenSizeCosAngle, screenSizeDistanceToCamera, screenSizePerspective);\n          if (perspectiveScale <= 0.25) {\n            gl_FragColor = mix(gl_FragColor, vec4(1.0, 0.0, 0.0, 1.0), perspectiveScale * 4.0);\n          }\n          else if (perspectiveScale <= 0.5) {\n            gl_FragColor = mix(gl_FragColor, vec4(0.0, 0.0, 1.0, 1.0), (perspectiveScale - 0.25) * 4.0);\n          }\n          else if (perspectiveScale >= 0.99) {\n            gl_FragColor = mix(gl_FragColor, vec4(0.0, 1.0, 0.0, 1.0), 0.2);\n          }\n          else {\n            gl_FragColor = mix(gl_FragColor, vec4(1.0, 0.0, 1.0, 1.0), (perspectiveScale - 0.5) * 2.0);\n          }"]))):"",e.tileBorders?Object(V.a)(O||(O=Object(T.a)(["\n            vec2 dVuv = fwidth(vuv);\n            vec2 edgeFactors = smoothstep(vec2(0.0), 1.5 * dVuv, min(vuv, 1.0 - vuv));\n            float edgeFactor = 1.0 - min(edgeFactors.x, edgeFactors.y);\n            gl_FragColor = mix(gl_FragColor, vec4(1.0, 0.0, 0.0, 1.0), edgeFactor);"]))):""))}return 1!==e.output&&3!==e.output||(t.include(M.a,{linearDepth:!0}),t.include(A.a,{output:e.output}),t.include(I.a,e),t.varyings.add("linearDepth","float"),t.vertex.uniforms.add("nearFar","vec2"),t.vertex.code.add(Object(V.a)(j||(j=Object(T.a)(["void main(void) {\nvec3 normal = getLocalUp(position, origin);\nvec2 uv = uv0;\nvec3 vpos = applySkirts(uv, position, normal.xyz, skirtScale);\ngl_Position = transformPositionWithDepth(proj, view, vpos, nearFar, linearDepth);\n}"])))),t.fragment.code.add(Object(V.a)(_||(_=Object(T.a)(["void main() {\noutputDepth(linearDepth);\n}"]))))),2===e.output&&(t.include(M.a,{linearDepth:!1}),t.include(I.a,e),t.varyings.add("vnormal","vec3"),t.varyings.add("vpos","vec3"),t.vertex.uniforms.add("viewNormal","mat4"),t.vertex.code.add(Object(V.a)(w||(w=Object(T.a)(["void main(void) {\nvec3 normal = getLocalUp(position, origin);\nvec2 uv = uv0;\nvpos = applySkirts(uv, position, normal, skirtScale);\ngl_Position = transformPosition(proj, view, vpos);\nvnormal = normalize((viewNormal * vec4(normal, 1.0)).xyz);\n}"])))),t.fragment.code.add(Object(V.a)(x||(x=Object(T.a)(["void main() {\nvec3 normal = normalize(vnormal);\nif (gl_FrontFacing == false) {\nnormal = -normal;\n}\ngl_FragColor = vec4(vec3(0.5) + 0.5 * normal, 0.0);\n}"]))))),4===e.output&&(t.include(M.a,{linearDepth:!1}),t.include(I.a,e),t.include(D.a,{pbrMode:0}),t.vertex.code.add(Object(V.a)(k||(k=Object(T.a)(["void main() {\nvec3 vnormal = getLocalUp(position, origin);\nvec2 uv = uv0;\nvec3 vpos = applySkirts(uv, position, vnormal, skirtScale);\nsetOverlayVTC(uv);\ngl_Position = transformPosition(proj, view, vpos);\n}"])))),t.include(E.a),t.fragment.code.add(Object(V.a)(S||(S=Object(T.a)(["void main() {\nvec4 overlayColor = getCombinedOverlayColor();\nif (overlayColor.a == 0.0) {\ngl_FragColor = vec4(0.0);\nreturn;\n}\noutputHighlight();\n}"]))))),t}var B=Object.freeze({__proto__:null,build:U})},function(e,t,r){"use strict";r.d(t,"a",(function(){return f})),r.d(t,"b",(function(){return h}));var n,i,a,o,s,c=r(12),l=r(277),u=r(11),d=r(87);function h(e){var t=new d.a;return t.include(l.a),t.fragment.uniforms.add("tex","sampler2D"),0===e.function&&(e.hasOpacityFactor?(t.fragment.uniforms.add("opacity","float"),t.fragment.code.add(Object(u.a)(n||(n=Object(c.a)(["void main() {\ngl_FragColor = texture2D(tex, uv) * opacity;\n}"]))))):t.fragment.code.add(Object(u.a)(i||(i=Object(c.a)(["void main() {\ngl_FragColor = texture2D(tex, uv);\n}"]))))),3===e.function&&(t.fragment.uniforms.add("overlayIdx","int"),e.hasOpacityFactor&&t.fragment.uniforms.add("opacity","float"),t.fragment.code.add(Object(u.a)(a||(a=Object(c.a)(["\n      void main() {\n        vec2 overlayUV = overlayIdx == 0 ? vec2(uv.x * 0.5, uv.y) : vec2(uv.x * 0.5+ 0.5, uv.y);\n        gl_FragColor = texture2D(tex, overlayUV) ",";\n      }"])),e.hasOpacityFactor?"* opacity":""))),1===e.function&&t.fragment.code.add(Object(u.a)(o||(o=Object(c.a)(["void main() {\ngl_FragColor = vec4(1.0 - texture2D(tex, uv).a);\n}"])))),2===e.function&&(t.fragment.uniforms.add("colorTexture","sampler2D"),t.fragment.uniforms.add("alphaTexture","sampler2D"),t.fragment.uniforms.add("frontFaceTexture","sampler2D"),t.fragment.code.add(Object(u.a)(s||(s=Object(c.a)(["void main() {\nvec4 srcColor = texture2D(colorTexture, uv);\nfloat srcAlpha = texture2D(alphaTexture, uv).r;\nvec4 frontFace = texture2D(frontFaceTexture, uv);\nif(srcColor.a <= 1e-5){\ndiscard;\n}\ngl_FragColor = vec4(mix(srcColor.rgb/srcColor.a, frontFace.rgb, frontFace.a), 1.0 - srcAlpha);\n}"]))))),t}var f=Object.freeze({__proto__:null,build:h})},function(e,t,r){"use strict";r.d(t,"a",(function(){return y})),r.d(t,"b",(function(){return m}));var n,i,a,o,s,c,l,u,d,h,f,p=r(12),b=r(11),v=r(87);function m(e){var t=new v.a,r=t.vertex.code,m=t.fragment.code;return t.attributes.add("position","vec2"),2===e.highlightStage&&(r.add(Object(b.a)(n||(n=Object(p.a)(["void main() {\ngl_Position = vec4(vec2(1.0) - position * 2.0, 0.0, 1.0);\n}"])))),t.fragment.uniforms.add("tex","sampler2D"),t.fragment.uniforms.add("invFramebufferDim","vec2"),m.add(Object(b.a)(i||(i=Object(p.a)(["void main() {\nvec2 coord = gl_FragCoord.xy * invFramebufferDim;\nvec4 value = texture2D(tex, coord);\nfloat mx = floor(max(value.g, value.b));\ngl_FragColor = vec4(ceil(value.r), mx, mx, 1.0);\n}"]))))),0===e.highlightStage&&(t.attributes.add("uv0","vec2"),e.gridOptimization?(t.vertex.uniforms.add("coverageTex","sampler2D"),t.fragment.uniforms.add("blurSize","vec2"),t.varyings.add("blurCoordinate","vec3")):(t.vertex.uniforms.add("blurSize","vec2"),t.varyings.add("blurCoordinates[5]","vec2")),r.add(Object(b.a)(a||(a=Object(p.a)(["\n    void main() {\n      gl_Position = vec4(position, 0.0, 1.0);\n      ","\n    }"])),e.gridOptimization?Object(b.a)(o||(o=Object(p.a)(["\n      vec4 cov = texture2D(coverageTex, uv0);\n      if (cov.r == 0.0) {\n        gl_Position = vec4(0.0);\n      }\n      blurCoordinate = vec3(gl_Position.xy * 0.5 + vec2(0.5), max(cov.g, cov.b));\n      "]))):Object(b.a)(s||(s=Object(p.a)(["\n      vec2 uv = position.xy * 0.5 + vec2(0.5);\n      blurCoordinates[0] = uv;\n      blurCoordinates[1] = uv + blurSize * 1.407333;\n      blurCoordinates[2] = uv - blurSize * 1.407333;\n      blurCoordinates[3] = uv + blurSize * 3.294215;\n      blurCoordinates[4] = uv - blurSize * 3.294215;\n          "]))))),t.fragment.uniforms.add("tex","sampler2D"),m.add(Object(b.a)(c||(c=Object(p.a)(["\n    void main() {\n      ","\n    }"])),e.gridOptimization?Object(b.a)(l||(l=Object(p.a)(["\n          vec2 uv = blurCoordinate.xy;\n          vec4 center = texture2D(tex, uv);\n\n          // do not blur if no pixel or all pixels in neighborhood are set\n          if (blurCoordinate.z == 1.0) {\n            gl_FragColor = center;\n          } else {\n            vec4 sum = vec4(0.0);\n            sum += center * 0.204164;\n            sum += texture2D(tex, uv + blurSize * 1.407333) * 0.304005;\n            sum += texture2D(tex, uv - blurSize * 1.407333) * 0.304005;\n            sum += texture2D(tex, uv + blurSize * 3.294215) * 0.093913;\n            sum += texture2D(tex, uv - blurSize * 3.294215) * 0.093913;\n            gl_FragColor = sum;\n          }"]))):Object(b.a)(u||(u=Object(p.a)(["\n          vec4 sum = vec4(0.0);\n          sum += texture2D(tex, blurCoordinates[0]) * 0.204164;\n          sum += texture2D(tex, blurCoordinates[1]) * 0.304005;\n          sum += texture2D(tex, blurCoordinates[2]) * 0.304005;\n          sum += texture2D(tex, blurCoordinates[3]) * 0.093913;\n          sum += texture2D(tex, blurCoordinates[4]) * 0.093913;\n          gl_FragColor = sum;"])))))),1===e.highlightStage&&(t.varyings.add("uv","vec2"),e.gridOptimization&&(t.attributes.add("uv0","vec2"),t.vertex.uniforms.add("coverageTex","sampler2D")),r.add(Object(b.a)(d||(d=Object(p.a)(["\n      void main() {\n        ","\n        gl_Position = vec4(position, 0.0, 1.0);\n        uv = position.xy * 0.5 + vec2(0.5);\n      }"])),e.gridOptimization?Object(b.a)(h||(h=Object(p.a)(["\n            vec4 cov = texture2D(coverageTex, uv0);\n            // if no highlight pixel set in this block, hide block\n            if (cov.r == 0.0) {\n              gl_Position = vec4(0.0);\n              return;\n            }"]))):"")),t.fragment.uniforms.add("tex","sampler2D"),t.fragment.uniforms.add("origin","sampler2D"),t.fragment.uniforms.add("color","vec4"),t.fragment.uniforms.add("haloColor","vec4"),t.fragment.uniforms.add("outlineSize","float"),t.fragment.uniforms.add("blurSize","float"),t.fragment.uniforms.add("opacities","vec4"),m.add(Object(b.a)(f||(f=Object(p.a)(["void main() {\nvec4 blurredHighlightValue = texture2D(tex, uv);\nfloat highlightIntensity = blurredHighlightValue.a;\nif (highlightIntensity == 0.0) {\ndiscard;\n}\nvec4 origin_color = texture2D(origin, uv);\nfloat outlineIntensity;\nfloat fillIntensity;\nif (blurredHighlightValue.g > blurredHighlightValue.b) {\noutlineIntensity = haloColor.w * opacities[1];\nfillIntensity = color.w * opacities[3];\n}\nelse {\noutlineIntensity = haloColor.w * opacities[0];\nfillIntensity = color.w * opacities[2];\n}\nfloat inner = 1.0 - outlineSize / 9.0;\nfloat outer = 1.0 - (outlineSize + blurSize) / 9.0;\nfloat outlineFactor = smoothstep(outer, inner, highlightIntensity);\nfloat fillFactor = any(notEqual(origin_color, vec4(0.0, 0.0, 0.0, 0.0))) ? 1.0 : 0.0;\nfloat intensity = outlineIntensity * outlineFactor * (1.0 - fillFactor) + fillIntensity * fillFactor;\ngl_FragColor = vec4(mix(haloColor.rgb, color.rgb, fillFactor), intensity);\n}"]))))),t}var y=Object.freeze({__proto__:null,build:m})},function(e,t,r){"use strict";r.d(t,"a",(function(){return b})),r.d(t,"b",(function(){return p}));var n,i,a=r(12),o=r(277),s=r(109),c=r(120),l=r(148),u=r(379),d=r(194),h=r(11),f=r(87);function p(e){var t=new f.a;return t.include(l.a),t.fragment.include(d.a),t.fragment.include(c.a),t.include(u.a),t.include(o.a),t.fragment.uniforms.add("defaultDepthTex","sampler2D").add("highlightDepthTex","sampler2D").add("depthMap","sampler2D").add("highlightMap","sampler2D").add("color","vec4").add("nearFar","vec2").add("opacity","float").add("occludedOpacity","float").add("terminationFactor","float").add("inverseView","mat4").add("lightingMainDirectionView","vec3").add("texelSize","vec2"),t.fragment.constants.add("unoccludedHighlightFlag","vec4",s.c).add("highlightedThreshold","float",e.highlightedThreshold).add("selfShadowThreshold","float",e.selfShadowThreshold),t.fragment.code.add(Object(h.a)(n||(n=Object(a.a)(["vec3 normalFromDepth(vec3 pixelPos, vec2 fragCoord, vec2 uv, vec2 texelSize, sampler2D depthMap, vec2 nearFar) {\nfloat leftPixelDepth = linearDepthFromTexture(depthMap, uv + vec2(-1.0, 0.0) * texelSize, nearFar);\nfloat rightPixelDepth = linearDepthFromTexture(depthMap, uv + vec2(1.0, 0.0) * texelSize, nearFar);\nfloat bottomPixelDepth = linearDepthFromTexture(depthMap, uv + vec2(0.0, -1.0) * texelSize, nearFar);\nfloat topPixelDepth = linearDepthFromTexture(depthMap, uv + vec2(0.0, 1.0) * texelSize, nearFar);\nbool pickLeft = abs(pixelPos.z - leftPixelDepth) < abs(pixelPos.z - rightPixelDepth);\nbool pickBottom = abs(pixelPos.z - bottomPixelDepth) < abs(pixelPos.z - topPixelDepth);\nvec3 fragCoordHorizontal = pickLeft\n? vec3(fragCoord + vec2(-1.0, 0.0), leftPixelDepth)\n: vec3(fragCoord + vec2(1.0, 0.0), rightPixelDepth);\nvec3 fragCoordVertical = pickBottom\n? vec3(fragCoord + vec2(0.0, -1.0), bottomPixelDepth)\n: vec3(fragCoord + vec2(0.0, 1.0), topPixelDepth);\nvec3 verticalPixelPos = reconstructPosition(fragCoordHorizontal.xy, fragCoordHorizontal.z);\nvec3 horizontalPixelPos = reconstructPosition(fragCoordVertical.xy, fragCoordVertical.z);\nvec3 normal = normalize(cross(verticalPixelPos - pixelPos, horizontalPixelPos - pixelPos));\nreturn pickLeft == pickBottom ? normal : -normal;\n}"])))),t.fragment.code.add(Object(h.a)(i||(i=Object(a.a)(["void main(void) {\nvec4 highlightInfo = texture2D(highlightMap, uv);\nfloat visiblyHighlighted = (1.0 - clamp(distance(unoccludedHighlightFlag, highlightInfo), 0.0, 1.0)) * highlightInfo.a;\nif (visiblyHighlighted > highlightedThreshold) {\ndiscard;\n}\nfloat depth = rgba2float(texture2D(depthMap, uv));\nif (depth == 0.0) {\ndiscard;\n}\nfloat currentPixelDepth = linearDepthFromFloat(depth, nearFar);\nif (-currentPixelDepth>nearFar.y || -currentPixelDepth<nearFar.x) {\ndiscard;\n}\nvec4 currentPixelPos = vec4(reconstructPosition(gl_FragCoord.xy, currentPixelDepth), 1.0);\nvec4 worldSpacePos = inverseView * currentPixelPos;\nmat4 shadowMatrix;\nfloat linearDepth = -currentPixelDepth;\nint i = chooseCascade(linearDepth, shadowMatrix);\nif (i >= uShadowMapNum) {\ndiscard;\n}\nvec3 lvpos = lightSpacePosition(worldSpacePos.xyz, shadowMatrix);\nif (lvpos.z >= 1.0 || lvpos.x < 0.0 || lvpos.x > 1.0 || lvpos.y < 0.0 || lvpos.y > 1.0) {\ndiscard;\n}\nvec2 uvShadow = cascadeCoordinates(i, lvpos);\nfloat depthHighlight = readShadowMapDepth(uvShadow, highlightDepthTex);\nbool shadowHighlight = depthHighlight < lvpos.z;\nif (!shadowHighlight) {\ndiscard;\n}\nfloat depthDefault = readShadowMapDepth(uvShadow, defaultDepthTex);\nbool shadowDefault = depthDefault < lvpos.z;\nvec3 normal = normalFromDepth(currentPixelPos.xyz, gl_FragCoord.xy, uv, texelSize, depthMap, nearFar);\nbool shaded = dot(normal, lightingMainDirectionView) < selfShadowThreshold;\nfloat differenceOpacity = opacity;\nfloat bothOpacity = occludedOpacity;\nfloat fragOpacity = (shadowDefault || shaded) ? bothOpacity : differenceOpacity;\ngl_FragColor = vec4(color.rgb, color.a * fragOpacity * terminationFactor);\n}"])))),t}var b=Object.freeze({__proto__:null,build:p})},function(e,t,r){"use strict";r.d(t,"a",(function(){return f})),r.d(t,"b",(function(){return h}));var n,i,a,o,s,c,l=r(12),u=r(11),d=r(87);function h(e){var t=new d.a;return 0===e.output&&(t.attributes.add("position","vec2"),t.vertex.uniforms.add("uResolution","vec4"),t.varyings.add("fTexCoord","vec2"),t.varyings.add("fOffset[3]","vec4"),t.vertex.code.add(Object(u.a)(n||(n=Object(l.a)(["void SMAAEdgeDetectionVS( vec2 texcoord ) {\nfOffset[0] = texcoord.xyxy + uResolution.xyxy * vec4( -1.0, 0.0, 0.0,  1.0 );\nfOffset[1] = texcoord.xyxy + uResolution.xyxy * vec4(  1.0, 0.0, 0.0, -1.0 );\nfOffset[2] = texcoord.xyxy + uResolution.xyxy * vec4( -2.0, 0.0, 0.0,  2.0 );\n}\nvoid main() {\nfTexCoord = (position + 1.0 ) * 0.5;\ngl_Position = vec4(position, 0, 1);\nSMAAEdgeDetectionVS( fTexCoord );\n}"])))),t.fragment.uniforms.add("tColor","sampler2D"),t.fragment.code.add(Object(u.a)(i||(i=Object(l.a)(["\n      vec4 SMAAColorEdgeDetectionPS( vec2 texcoord, vec4 offset[3], sampler2D colorTex ) {\n        vec2 threshold = vec2( "," );\n\n        // Calculate color deltas:\n        vec4 delta;\n        vec3 C = texture2D( colorTex, texcoord ).rgb;\n\n        vec3 Cleft = texture2D( colorTex, offset[0].xy ).rgb;\n        vec3 t = abs( C - Cleft );\n        delta.x = max( max( t.r, t.g ), t.b );\n\n        vec3 Ctop = texture2D( colorTex, offset[0].zw ).rgb;\n        t = abs( C - Ctop );\n        delta.y = max( max( t.r, t.g ), t.b );\n\n        // We do the usual threshold:\n        vec2 edges = step( threshold, delta.xy );\n\n        // Then discard if there is no edge:\n        if ( dot( edges, vec2( 1.0, 1.0 ) ) == 0.0 )\n            discard;\n\n        // Calculate right and bottom deltas:\n        vec3 Cright = texture2D( colorTex, offset[1].xy ).rgb;\n        t = abs( C - Cright );\n        delta.z = max( max( t.r, t.g ), t.b );\n\n        vec3 Cbottom  = texture2D( colorTex, offset[1].zw ).rgb;\n        t = abs( C - Cbottom );\n        delta.w = max( max( t.r, t.g ), t.b );\n\n        // Calculate the maximum delta in the direct neighborhood:\n        float maxDelta = max( max( max( delta.x, delta.y ), delta.z ), delta.w );\n\n        // Calculate left-left and top-top deltas:\n        vec3 Cleftleft  = texture2D( colorTex, offset[2].xy ).rgb;\n        t = abs( C - Cleftleft );\n        delta.z = max( max( t.r, t.g ), t.b );\n\n        vec3 Ctoptop = texture2D( colorTex, offset[2].zw ).rgb;\n        t = abs( C - Ctoptop );\n        delta.w = max( max( t.r, t.g ), t.b );\n\n        // Calculate the final maximum delta:\n        maxDelta = max( max( maxDelta, delta.z ), delta.w );\n\n        // Local contrast adaptation in action:\n        edges.xy *= step( maxDelta, float(",") * delta.xy );\n\n        return vec4( edges, 0.0, 0.0 );\n      }\n\n      void main() {\n        gl_FragColor = SMAAColorEdgeDetectionPS( fTexCoord, fOffset, tColor );\n      }\n    "])),u.a.float(e.threshold),u.a.float(e.localConstrastAdaption)))),1===e.output&&(t.attributes.add("position","vec2"),t.vertex.uniforms.add("uResolution","vec4"),t.varyings.add("fTexCoord","vec2"),t.varyings.add("fOffset[3]","vec4"),t.varyings.add("fPixCoord","vec2"),t.vertex.code.add(Object(u.a)(a||(a=Object(l.a)(["\n      void SMAABlendingWeightCalculationVS( vec2 texcoord ) {\n        fPixCoord = texcoord * uResolution.zw;\n        fOffset[0] = texcoord.xyxy + uResolution.xyxy * vec4( -0.25, 0.125, 1.25, 0.125 );\n        fOffset[1] = texcoord.xyxy + uResolution.xyxy * vec4( -0.125, 0.25, -0.125, -1.25 );\n        fOffset[2] = vec4( fOffset[0].xz, fOffset[1].yw ) + vec4( -2.0, 2.0, -2.0, 2.0 ) * uResolution.xxyy * float( "," );\n      }\n\n      void main() {\n        fTexCoord = (position + 1.0 ) * 0.5;\n        gl_Position = vec4(position, 0, 1);\n        SMAABlendingWeightCalculationVS( fTexCoord );\n      }\n    "])),u.a.int(e.maxSearchSteps))),t.fragment.uniforms.add("tEdges","sampler2D").add("tArea","sampler2D").add("tSearch","sampler2D").add("tColor","sampler2D").add("uResolution","vec4"),t.fragment.code.add(Object(u.a)(o||(o=Object(l.a)(["\n      #define SMAA_AREATEX_PIXEL_SIZE ( 1.0 / vec2( 160.0, 560.0 ) )\n      #define SMAA_AREATEX_SUBTEX_SIZE ( 1.0 / 7.0 )\n\n      vec4 SMAASampleLevelZeroOffset(sampler2D tex, vec2 coord, vec2 offset) {\n        return texture2D( tex, coord + offset.x * uResolution.xy, 0.0 );\n      }\n\n      vec2 round( vec2 x ) {\n        return sign( x ) * floor( abs( x ) + 0.5 );\n      }\n\n      float SMAASearchLength( sampler2D searchTex, vec2 e, float bias, float scale ) {\n        e.r = bias + e.r * scale;\n        return 255.0 * texture2D( searchTex, e, 0.0 ).r;\n      }\n\n      float SMAASearchXLeft( sampler2D edgesTex, sampler2D searchTex, vec2 texcoord, float end ) {\n        vec2 e = vec2( 0.0, 1.0 );\n        for ( int i = 0; i < ","; i ++ ) {\n          e = texture2D( edgesTex, texcoord, 0.0 ).rg;\n          texcoord -= vec2( 2.0, 0.0 ) * uResolution.xy;\n          if ( ! ( texcoord.x > end && e.g > 0.8281 && e.r == 0.0 ) ) break;\n        }\n        texcoord.x += 0.25 * uResolution.x;\n        texcoord.x += uResolution.x;\n        texcoord.x += 2.0 * uResolution.x;\n        texcoord.x -= uResolution.x * SMAASearchLength(searchTex, e, 0.0, 0.5);\n        return texcoord.x;\n      }\n\n      float SMAASearchXRight( sampler2D edgesTex, sampler2D searchTex, vec2 texcoord, float end ) {\n        vec2 e = vec2( 0.0, 1.0 );\n        for ( int i = 0; i < ","; i ++ ) {\n          e = texture2D( edgesTex, texcoord, 0.0 ).rg;\n          texcoord += vec2( 2.0, 0.0 ) * uResolution.xy;\n          if ( ! ( texcoord.x < end && e.g > 0.8281 && e.r == 0.0 ) ) break;\n        }\n        texcoord.x -= 0.25 * uResolution.x;\n        texcoord.x -= uResolution.x;\n        texcoord.x -= 2.0 * uResolution.x;\n        texcoord.x += uResolution.x * SMAASearchLength( searchTex, e, 0.5, 0.5 );\n        return texcoord.x;\n      }\n\n      float SMAASearchYUp( sampler2D edgesTex, sampler2D searchTex, vec2 texcoord, float end ) {\n        vec2 e = vec2( 1.0, 0.0 );\n        for ( int i = 0; i < ","; i ++ ) {\n          e = texture2D( edgesTex, texcoord, 0.0 ).rg;\n          texcoord += vec2( 0.0, 2.0 ) * uResolution.xy;\n          if ( ! ( texcoord.y > end && e.r > 0.8281 && e.g == 0.0 ) ) break;\n        }\n        texcoord.y -= 0.25 * uResolution.y;\n        texcoord.y -= uResolution.y;\n        texcoord.y -= 2.0 * uResolution.y;\n        texcoord.y += uResolution.y * SMAASearchLength( searchTex, e.gr, 0.0, 0.5 );\n        return texcoord.y;\n      }\n\n      float SMAASearchYDown( sampler2D edgesTex, sampler2D searchTex, vec2 texcoord, float end ) {\n        vec2 e = vec2( 1.0, 0.0 );\n        for ( int i = 0; i < ","; i ++ ) {\n          e = texture2D( edgesTex, texcoord, 0.0 ).rg;\n          texcoord -= vec2( 0.0, 2.0 ) * uResolution.xy;\n          if ( ! ( texcoord.y < end && e.r > 0.8281 && e.g == 0.0 ) ) break;\n        }\n        texcoord.y += 0.25 * uResolution.y;\n        texcoord.y += uResolution.y;\n        texcoord.y += 2.0 * uResolution.y;\n        texcoord.y -= uResolution.y * SMAASearchLength( searchTex, e.gr, 0.5, 0.5 );\n        return texcoord.y;\n      }\n\n      vec2 SMAAArea( sampler2D areaTex, vec2 dist, float e1, float e2, float offset ) {\n        vec2 texcoord = float( "," ) * round( 4.0 * vec2( e1, e2 ) ) + dist;\n        texcoord = SMAA_AREATEX_PIXEL_SIZE * texcoord + ( 0.5 * SMAA_AREATEX_PIXEL_SIZE );\n        texcoord.y += SMAA_AREATEX_SUBTEX_SIZE * offset;\n        return texture2D( areaTex, texcoord, 0.0 ).rg;\n      }\n\n      vec4 SMAABlendingWeightCalculationPS( vec2 texcoord, vec2 pixcoord, vec4 offset[ 3 ], sampler2D edgesTex, sampler2D areaTex, sampler2D searchTex, ivec4 subsampleIndices ) {\n        vec4 weights = vec4( 0.0, 0.0, 0.0, 0.0 );\n        vec2 e = texture2D( edgesTex, texcoord ).rg;\n        if ( e.g > 0.0 ) {\n          vec2 d;\n          vec2 coords;\n          coords.x = SMAASearchXLeft( edgesTex, searchTex, offset[ 0 ].xy, offset[ 2 ].x );\n          coords.y = offset[ 1 ].y;\n          d.x = coords.x;\n          float e1 = texture2D( edgesTex, coords, 0.0 ).r;\n          coords.x = SMAASearchXRight( edgesTex, searchTex, offset[ 0 ].zw, offset[ 2 ].y );\n          d.y = coords.x;\n          d = d * uResolution.z - pixcoord.x;\n          vec2 sqrt_d = sqrt( abs( d ) );\n          coords.y -= 1.0 * uResolution.y;\n          float e2 = SMAASampleLevelZeroOffset( edgesTex, coords, vec2( 1.0, 0.0 ) ).r;\n          weights.rg = SMAAArea( areaTex, sqrt_d, e1, e2, float( subsampleIndices.y ) );\n        }\n\n        if ( e.r > 0.0 ) {\n          vec2 d;\n          vec2 coords;\n          coords.y = SMAASearchYUp( edgesTex, searchTex, offset[ 1 ].xy, offset[ 2 ].z );\n          coords.x = offset[ 0 ].x;\n          d.x = coords.y;\n          float e1 = texture2D( edgesTex, coords, 0.0 ).g;\n          coords.y = SMAASearchYDown( edgesTex, searchTex, offset[ 1 ].zw, offset[ 2 ].w );\n          d.y = coords.y;\n          d = d * uResolution.w - pixcoord.y;\n          vec2 sqrt_d = sqrt( abs( d ) );\n          coords.y -= 1.0 * uResolution.y;\n          float e2 = SMAASampleLevelZeroOffset( edgesTex, coords, vec2( 0.0, 1.0 ) ).g;\n          weights.ba = SMAAArea( areaTex, sqrt_d, e1, e2, float( subsampleIndices.x ) );\n\n          // for some reason the following lines are necessary to prevent\n          // texture lookup precision issues on some Intel integrated graphics chips\n          vec4 dbg = (offset[ 0 ]+offset[ 1 ]+offset[ 2 ] + coords.xyyx);\n          weights.r += 0.00000001 * dot(vec4(0,1,0,1),dbg);\n        }\n        return weights;\n      }\n\n      void main() {\n        gl_FragColor = SMAABlendingWeightCalculationPS( fTexCoord, fPixCoord, fOffset, tEdges, tArea, tSearch, ivec4( 0.0 ) );\n      }\n    "])),u.a.int(e.maxSearchSteps),u.a.int(e.maxSearchSteps),u.a.int(e.maxSearchSteps),u.a.int(e.maxSearchSteps),u.a.int(e.maxDistanceAreaTex)))),2===e.output&&(t.attributes.add("position","vec2"),t.vertex.uniforms.add("uResolution","vec4"),t.varyings.add("fTexCoord","vec2"),t.varyings.add("fOffset[2]","vec4"),t.vertex.code.add(Object(u.a)(s||(s=Object(l.a)(["void SMAANeighborhoodBlendingVS( vec2 texcoord ) {\nfOffset[0] = texcoord.xyxy + uResolution.xyxy * vec4( -1.0, 0.0, 0.0, 1.0 );\nfOffset[1] = texcoord.xyxy + uResolution.xyxy * vec4( 1.0, 0.0, 0.0, -1.0 );\n}\nvoid main() {\nfTexCoord = (position + 1.0 ) * 0.5;\ngl_Position = vec4(position, 0, 1);\nSMAANeighborhoodBlendingVS(fTexCoord);\n}"])))),t.fragment.uniforms.add("tBlendWeights","sampler2D"),t.fragment.uniforms.add("tColor","sampler2D"),t.fragment.uniforms.add("uResolution","vec4"),t.fragment.code.add(Object(u.a)(c||(c=Object(l.a)(["vec4 SMAANeighborhoodBlendingPS( vec2 texcoord, vec4 offset[ 2 ], sampler2D colorTex, sampler2D blendTex ) {\nvec4 a;\na.xz = texture2D( blendTex, texcoord ).xz;\na.y = texture2D( blendTex, offset[ 1 ].zw ).g;\na.w = texture2D( blendTex, offset[ 1 ].xy ).a;\nif ( dot(a, vec4( 1.0, 1.0, 1.0, 1.0 )) < 1e-5 ) {\nreturn texture2D( colorTex, texcoord, 0.0 );\n} else {\nvec2 offset;\noffset.x = a.a > a.b ? a.a : -a.b;\noffset.y = a.g > a.r ? -a.g : a.r;\nif ( abs( offset.x ) > abs( offset.y )) {\noffset.y = 0.0;\n} else {\noffset.x = 0.0;\n}\nvec4 C = texture2D( colorTex, texcoord, 0.0 );\ntexcoord += sign( offset ) * uResolution.xy;\nvec4 Cop = texture2D( colorTex, texcoord, 0.0 );\nfloat s = abs( offset.x ) > abs( offset.y ) ? abs( offset.x ) : abs( offset.y );\nvec4 mixed = mix(C, Cop, s);\nreturn mixed;\n}\n}\nvoid main() {\ngl_FragColor = SMAANeighborhoodBlendingPS( fTexCoord, fOffset, tColor, tBlendWeights );\n}"]))))),t}var f=Object.freeze({__proto__:null,build:h})},function(e,t,r){"use strict";r.d(t,"a",(function(){return p})),r.d(t,"b",(function(){return f}));var n,i,a,o,s=r(12),c=r(277),l=r(120),u=r(379),d=r(11),h=r(87);function f(e){var t=new h.a;return t.include(c.a),1===e.output&&(t.fragment.include(l.a),t.fragment.uniforms.add("normalMap","sampler2D").add("depthMap","sampler2D").add("tex","sampler2D").add("blurSize","vec2").add("g_BlurFalloff","float").add("projScale","float").add("nearFar","vec2").add("zScale","vec2"),t.fragment.code.add(Object(d.a)(n||(n=Object(s.a)(["\n      float blurFunction(vec2 uv, float r, float center_d, inout float w_total, float sharpness) {\n        float c = texture2D(tex, uv).r;\n        float d = linearDepthFromTexture(depthMap, uv, nearFar);\n\n        float ddiff = d - center_d;\n\n        float w = exp(-r*r*g_BlurFalloff - ddiff*ddiff*sharpness);\n\n        w_total += w;\n\n        return w*c;\n      }\n\n      void main(void) {\n        float b = 0.0;\n        float w_total = 0.0;\n\n        float center_d = linearDepthFromTexture(depthMap, uv, nearFar);\n\n        float sharpness = -0.05 * projScale/(center_d*zScale.x+zScale.y);\n        for (int r = -","; r <= ","; ++r) {\n          float rf = float(r);\n          vec2 uvOffset = uv + rf*blurSize;\n          b += blurFunction(uvOffset, rf, center_d, w_total, sharpness);\n        }\n\n        gl_FragColor = vec4(b/w_total);\n      }\n    "])),d.a.int(e.radius),d.a.int(e.radius)))),0===e.output&&(t.fragment.include(l.a),t.include(u.a),t.fragment.uniforms.add("projMatrixInv","mat4").add("normalMap","sampler2D").add("depthMap","sampler2D").add("intensity","float").add("projScale","float").add("radius","float").add("nearFar","vec2").add("screenDimensions","vec2").add("rnmScale","vec2").add("rnm","sampler2D"),t.fragment.code.add(Object(d.a)(i||(i=Object(s.a)(["\n    uniform vec3 pSphere[","];\n\n    float fallOffFunction(float vv, float vn, float bias) {\n      float radius2 = radius * radius;\n      float f = max(radius2 - vv, 0.0);\n      return f * f * f * max(vn-bias, 0.0);\n    }\n    "])),d.a.int(e.samples))),t.fragment.code.add(Object(d.a)(a||(a=Object(s.a)(["float aoValueFromPositionsAndNormal(vec3 C, vec3 n_C, vec3 Q) {\nvec3 v = Q - C;\nfloat vv = dot(v, v);\nfloat vn = dot(normalize(v), n_C);\nreturn fallOffFunction(vv, vn, 0.1);\n}"])))),t.fragment.code.add(Object(d.a)(o||(o=Object(s.a)(["\n      void main(void) {\n        vec3 fres = normalize((texture2D(rnm, uv * rnmScale).xyz * 2.0) - vec3(1.0));\n        float currentPixelDepth = linearDepthFromTexture(depthMap, uv, nearFar);\n\n        if (-currentPixelDepth>nearFar.y || -currentPixelDepth<nearFar.x) {\n          gl_FragColor = vec4(0.0);\n          return;\n        }\n\n        vec3 currentPixelPos = reconstructPosition(gl_FragCoord.xy,currentPixelDepth);\n\n        // get the normal of current fragment\n        vec4 norm4 = texture2D(normalMap, uv);\n        vec3 norm = vec3(-1.0) + 2.0 * norm4.xyz;\n        bool isTerrain = norm4.w<0.5;\n\n        float sum = .0;\n\n        vec4 occluderFragment;\n        vec3 ray;\n\n        vec3 tapPixelPos;\n\n        // note: the factor 2.0 should not be necessary, but makes ssao much nicer.\n        // bug or deviation from CE somewhere else?\n        float ps = projScale/(2.0*currentPixelPos.z*zScale.x+zScale.y);\n\n        for(int i = 0; i < ","; ++i) {\n          // get a vector (randomized inside of a sphere with radius 1.0) from a texture and reflect it\n          //float ssR;\n          //vec2 unitOffset = tapLocation(i, randomPatternRotationAngle, ssR);\n          // get the depth of the occluder fragment\n          //vec2 offset = vec2(-unitOffset*radius*ssR*ps);\n\n          vec2 unitOffset = reflect(pSphere[i], fres).xy;\n          vec2 offset = vec2(-unitOffset*radius*ps);\n\n          //don't use current or very nearby samples\n          if ( abs(offset.x)<2.0 || abs(offset.y)<2.0) continue;\n\n          vec2 tc = vec2(gl_FragCoord.xy + offset);\n          if (tc.x < 0.0 || tc.y < 0.0 || tc.x > screenDimensions.x || tc.y > screenDimensions.y) continue;\n          vec2 tcTap = tc/screenDimensions;\n          float occluderFragmentDepth = linearDepthFromTexture(depthMap, tcTap, nearFar);\n\n          if (isTerrain) {\n            bool isTerrainTap = texture2D(normalMap, tcTap).w<0.5;\n            if (isTerrainTap) {\n              continue;\n            }\n          }\n\n          tapPixelPos = reconstructPosition(tc, occluderFragmentDepth);\n\n          sum+= aoValueFromPositionsAndNormal(currentPixelPos, norm, tapPixelPos);\n        }\n\n        // output the result\n\n        float A = max(1.0-sum*intensity/float(","),0.0);\n\n        // Anti-tone map to reduce contrast and drag dark region farther\n        // (x^0.2 + 1.2 * x^4)/2.2\n        A = (pow(A, 0.2) + 1.2 * A*A*A*A) / 2.2;\n\n        //gl_FragColor = vec4(norm/2.0+0.5, 1.0);\n        //gl_FragColor = vec4(-currentPixelDepth/1000.0);\n        //gl_FragColor = vec4(tapPixelPos.x/100.0);\n        gl_FragColor = vec4(A);\n      }\n    "])),d.a.int(e.samples),d.a.int(e.samples)))),t}var p=Object.freeze({__proto__:null,build:f})},function(e,t,r){"use strict";r.d(t,"a",(function(){return _})),r.d(t,"b",(function(){return j}));var n,i,a,o,s=r(12),c=r(76),l=r(120),u=r(112),d=r(11),h=r(87),f=r(676),p=r(668),b=r(669),v=r(670),m=r(326),y=r(671),g=r(672),O=r(391);function j(e){var t=new h.a,r=t.vertex,j=t.fragment;return e.legacy&&r.uniforms.add("uModel","mat4"),e.antialiasing&&(r.code.add(Object(d.a)(n||(n=Object(s.a)(["#define ANTIALIASING 1"])))),j.code.add(Object(d.a)(i||(i=Object(s.a)(["#define ANTIALIASING 1"]))))),t.include(f.a,e),t.include(y.a,e),t.include(m.a,e),t.include(O.a,e),t.include(g.a,e),t.include(c.a,e),t.include(b.a,e),t.include(p.a,e),t.include(v.a,e),t.varyings.add("vColor","vec4"),t.varyings.add("vRadius","float"),t.varyings.add("vPosition","vec3"),t.varyings.add("vWorldPosition","vec3"),t.varyings.add("vViewPos","vec3"),t.varyings.add("vLineLengthPixels","float"),t.varyings.add("vSizeFalloffFactor","float"),r.uniforms.add("uPixelToNDC","vec2"),r.uniforms.add("uNDCToPixel","vec2"),r.uniforms.add("uPixelRatio","float"),t.attributes.add("position0","vec3"),t.attributes.add("position1","vec3"),t.attributes.add("variantOffset","float"),t.attributes.add("variantStroke","float"),t.attributes.add("variantExtension","float"),r.code.add(Object(d.a)(a||(a=Object(s.a)(["const float opaqueCutoff = 1.0 / 255.0;\nvoid calculateGeometricOutputs(vec3 viewPosV0, vec3 viewPosV1, vec3 worldPosV0, vec3 worldPosV1, vec3 worldNormal, UnpackedAttributes unpackedAttributes) {\nvec2 sideness = unpackedAttributes.sideness;\nvec2 sidenessNorm = unpackedAttributes.sidenessNorm;\nvWorldPosition = mix(worldPosV0, worldPosV1, sidenessNorm.y).xyz;\nvec3 viewPos = mix(viewPosV0, viewPosV1, sidenessNorm.y);\nvViewPos = viewPos;\nvec4 projPosV0 = projFromViewPosition(viewPosV0);\nvec4 projPosV1 = projFromViewPosition(viewPosV1);\nvec4 projPos = projFromViewPosition(viewPos);\nvec3 screenSpaceLineNDC = (projPosV1.xyz / projPosV1.w - projPosV0.xyz / projPosV0.w);\nvec2 screenSpaceLinePixels = screenSpaceLineNDC.xy * uNDCToPixel;\nfloat lineLengthPixels = length(screenSpaceLinePixels);\nfloat dzPerPixel = screenSpaceLineNDC.z / lineLengthPixels;\nvec2 screenSpaceDirection = screenSpaceLinePixels / lineLengthPixels;\nvec2 perpendicularScreenSpaceDirection = vec2(screenSpaceDirection.y, -screenSpaceDirection.x) * sideness.x;\nfloat falloffFactor = distanceBasedPerspectiveFactor(-viewPos.z) * uPixelRatio;\nfloat lineWidthPixels = unpackedAttributes.lineWidthPixels * falloffFactor;\nfloat extensionLengthPixels = calculateExtensionLength(unpackedAttributes.extensionLengthPixels, lineLengthPixels) * falloffFactor;\nfloat lineAmplitudePixels = calculateLineAmplitude(unpackedAttributes) * uPixelRatio;\nvSizeFalloffFactor = falloffFactor;\nfloat lineWidthAndAmplitudePixels = lineWidthPixels + lineAmplitudePixels + lineAmplitudePixels;\nfloat extendedLineLengthPixels = lineLengthPixels + extensionLengthPixels + extensionLengthPixels;\n#ifdef ANTIALIASING\nconst float aaPaddingPixels = 1.0;\nfloat halfAAPaddedLineWidthAndAmplitudePixels = lineWidthAndAmplitudePixels * 0.5 + aaPaddingPixels;\nfloat aaPaddedRoundedCapSizePixels = lineWidthPixels * 0.5 + aaPaddingPixels;\n#else\nfloat halfAAPaddedLineWidthAndAmplitudePixels = max(lineWidthAndAmplitudePixels, 1.0) * 0.5;\nfloat aaPaddedRoundedCapSizePixels = max(lineWidthPixels, 1.0) * 0.5;\n#endif\nvec2 halfAAPaddedLineWidthAndAmplitudeNDC = halfAAPaddedLineWidthAndAmplitudePixels * uPixelToNDC;\nvec2 aaPaddedRoundedCapSizeNDC = aaPaddedRoundedCapSizePixels * uPixelToNDC;\nvec2 extensionLengthNDC = extensionLengthPixels * uPixelToNDC;\nvec2 ndcOffset = (\nscreenSpaceDirection * sideness.y * (aaPaddedRoundedCapSizeNDC + extensionLengthNDC)\n+ perpendicularScreenSpaceDirection * halfAAPaddedLineWidthAndAmplitudeNDC\n);\nprojPos.xy += ndcOffset * projPos.w;\nprojPos.z += (dzPerPixel * (aaPaddedRoundedCapSizePixels + extensionLengthPixels)) * sideness.y * projPos.w;\nprojPos = adjustProjectedPosition(projPos, worldNormal, 1.0 + max((lineWidthAndAmplitudePixels - 1.0) * 0.5, 0.0));\nfloat aaPaddedLineWithCapsLengthPixels = extendedLineLengthPixels + aaPaddedRoundedCapSizePixels + aaPaddedRoundedCapSizePixels;\nfloat pixelPositionAlongLine = aaPaddedLineWithCapsLengthPixels * sidenessNorm.y - aaPaddedRoundedCapSizePixels;\nvPosition = vec3(\nhalfAAPaddedLineWidthAndAmplitudePixels * sideness.x,\npixelPositionAlongLine,\npixelPositionAlongLine / extendedLineLengthPixels\n);\nvRadius = lineWidthPixels * 0.5;\nvLineLengthPixels = extendedLineLengthPixels;\ndiscardShortEdges(unpackedAttributes, lineLengthPixels);\ngl_Position = projPos;\n}\nvoid main() {\nComponentData component = readComponentData();\nUnpackedAttributes unpackedAttributes = unpackAttributes(component);\nvec3 worldPosV0 = worldFromModelPosition(position0);\nvec3 worldPosV1 = worldFromModelPosition(position1);\nvec3 viewPosV0 = viewFromModelPosition(position0);\nvec3 viewPosV1 = viewFromModelPosition(position1);\nvColor = component.color;\nif (vColor.a < opaqueCutoff) {\ngl_Position = vec4(10.0, 10.0, 10.0, 1.0);\nreturn;\n}\nif (discardNonSilhouetteEdges(viewPosV0, worldPosV0)) {\nreturn;\n}\ncalculateGeometricOutputs(viewPosV0, viewPosV1, worldPosV0, worldPosV1, worldNormal(), unpackedAttributes);\ncalculateStyleOutputs(unpackedAttributes);\n}"])))),e.multipassTerrainEnabled&&(t.fragment.include(l.a),t.include(u.b,e)),t.fragment.code.add(Object(d.a)(o||(o=Object(s.a)(["\n    vec2 lineWithCapsDistance(float radius, vec2 position, float lineLength) {\n      float lineOffset = calculateLineOffset();\n      float positionX = position.x - lineOffset;\n\n      if (radius < 1.0) {\n        // Handle this specifically for subpixel sizes:\n        // 1. Compute correct coverage (note coverage is computed by\n        //    0.5 - dist, so we make sure that that will lead to correct\n        //    subpixel coverage\n        // 2. Ignore rounded caps\n        float coverageX = clamp(min(radius, positionX + 0.5) - max(-radius, positionX - 0.5), 0.0, 1.0);\n        float coverageY = clamp(min(lineLength, position.y + 0.5) - max(0.0, position.y - 0.5), 0.0, 1.0);\n\n        float coverage = min(coverageX, coverageY);\n\n        return vec2(0.5 - coverage, 0.0);\n      }\n      else {\n        // Between -radius -> 0 for start cap, 0 for line, 0 -> radius\n        float positionOnCap = position.y - clamp(position.y, 0.0, lineLength);\n\n        vec2 lineToPosition = vec2(positionX, positionOnCap);\n        return vec2(length(lineToPosition) - radius, positionOnCap / radius);\n      }\n    }\n\n    void main() {\n      ","\n      float radius = vRadius * calculateLinePressure();\n\n      vec2 distance = lineWithCapsDistance(radius, vPosition.xy, vLineLengthPixels);\n      float coverage = clamp(0.5 - distance.x, 0.0, 1.0);\n\n      discardByCoverage(radius, coverage);\n      discardBySlice(vWorldPosition);\n\n      float alpha = vColor.a * coverage;\n\n      gl_FragColor = vec4(vColor.rgb, alpha);\n\n    }\n  "])),e.multipassTerrainEnabled?"terrainDepthTest(gl_FragCoord, vViewPos.z);":"")),t}var _=Object.freeze({__proto__:null,build:j})},function(e,t,r){"use strict";var n,i=r(411);t.a=function(){return n||(n=function(){var e={available:!1,version:0,majorPerformanceCaveat:!1,maxTextureSize:0,supportsHighPrecisionFragment:!1,supportsVertexShaderSamplers:!1,supportsElementIndexUint:!1,supportsStandardDerivatives:!1,supportsInstancedArrays:!1,supportsTextureFloat:!1,supportsColorBufferFloat:!1};if(void 0===typeof WebGLRenderingContext)return e;var t=document.createElement("canvas");if(!t)return e;var r=Object(i.a)(t,{failIfMajorPerformanceCaveat:!0},"webgl");if(r||(r=Object(i.a)(t,{},"webgl"))&&(e.majorPerformanceCaveat=!0),!r)return e;var n=r.getParameter(r.VERSION);if(!n)return e;var a=n.match(/^WebGL\s+([\d.]*)/);if(a){var o=parseFloat(a[1]);e.available=o>=.94;var s=r.getShaderPrecisionFormat(r.FRAGMENT_SHADER,r.HIGH_FLOAT);s&&(e.supportsHighPrecisionFragment=s.precision>0),e.supportsVertexShaderSamplers=r.getParameter(r.MAX_VERTEX_TEXTURE_IMAGE_UNITS)>0,e.supportsElementIndexUint=null!==r.getExtension("OES_element_index_uint"),e.supportsStandardDerivatives=null!==r.getExtension("OES_standard_derivatives"),e.supportsInstancedArrays=null!==r.getExtension("ANGLE_instanced_arrays"),e.supportsTextureFloat=null!==r.getExtension("OES_texture_float"),e.supportsColorBufferFloat=null!==r.getExtension("WEBGL_color_buffer_float")&&null!==r.getExtension("EXT_float_blend")}return e.maxTextureSize=r.getParameter(r.MAX_TEXTURE_SIZE),e.version=function(){if(void 0===typeof WebGL2RenderingContext)return!1;var e=document.createElement("canvas");return!!e&&!!Object(i.a)(e,{},"webgl2")}()?2:1,e}()),n}},function(e,t,r){"use strict";var n=r(13),i=r(50),a=r(8),o=r.n(a),s=r(16),c=r(2),l=r(5),u=r(6),d=r(7),h=r(128),f=r(3),p=r(23),b=r(653),v=r(167),m=r(15),y=r(14),g=r(45),O=r(42),j=r(22),_=r(282),w=r(67),x=r(96),k=r(26),S=r(31),T=r(4),C=r(9),M=r(51),P=r(34),A=r(32),E=r(178),R=r(457),I=r(65),D=r(154),F=r(140),L=r(105),z=(r(126),r(397)),V=r(266),N=r(115),U=r(66),B=r(158);function G(e){var t=[["position",e.indices]],r=[["position",{size:3,data:e.attributeData.position,exclusive:!0}]];return Object(f.j)(e.attributeData.color)&&(r.push(["color",{size:4,data:e.attributeData.color,exclusive:!0}]),t.push(["color",new Uint32Array(e.indices.length)])),Object(f.j)(e.attributeData.uvMapSpace)&&(r.push(["uvMapSpace",{size:4,data:e.attributeData.uvMapSpace,exclusive:!0}]),t.push(["uvMapSpace",e.indices])),Object(f.j)(e.attributeData.boundingRect)&&(r.push(["boundingRect",{size:9,data:e.attributeData.boundingRect,exclusive:!0}]),t.push(["boundingRect",e.indices])),Object(f.j)(e.attributeData.mapPosition)&&(r.push(["mapPos",{size:3,data:e.attributeData.mapPosition,exclusive:!0}]),t.push(["mapPos",e.indices])),new N.a(r,t)}function q(e){var t=[["position",e.indices],["uv0",e.indices]],r=[["position",{size:3,data:e.attributeData.position,exclusive:!0}],["uv0",{size:2,data:e.attributeData.uv0,exclusive:!0}]];return Object(f.j)(e.attributeData.mapPosition)&&(r.push(["mapPos",{size:3,data:e.attributeData.mapPosition,exclusive:!0}]),t.push(["mapPos",e.indices])),new N.a(r,t)}function H(e){switch(e.type){case"extent":if(e instanceof U.a)return B.a.fromExtent(e);break;case"polygon":return e}return null}function W(e,t,r,n){var i=Object(z.a)(e.rings,e.hasZ,1),a=new Float64Array(i.position.length),o=Object(I.c)(i.position,e.spatialReference,0,a,0,i.position,0,i.position.length/3,t,r,n),s=null!=o;return{position:i.position,mapPosition:a,polygons:X(i.polygons,i.position,a),outlines:Z(i.outlines,i.position,a),projectionSuccess:s,sampledElevation:o}}function Q(e,t){for(var r=Object(z.a)(e.rings,!1,1),n=Object(M.q)(r.position,e.spatialReference,0,r.position,t,0,r.position.length/3),i=2;i<r.position.length;i+=3)r.position[i]=V.a;return{position:r.position,polygons:X(r.polygons,r.position),outlines:Z(r.outlines,r.position),projectionSuccess:n}}function Z(e,t,r){var i,a=new Array,o=Object(n.a)(e);try{for(o.s();!(i=o.n()).done;){var s=i.value,c=s.index,l=s.count;if(!(l<=1)){var u=3*c,d=u+3*l;a.push({index:c,count:l,position:t.subarray(u,d),mapPosition:r?r.subarray(u,d):void 0})}}}catch(h){o.e(h)}finally{o.f()}return a}function X(e,t,r){var i,a=new Array,o=Object(n.a)(e);try{var s=function(){var e=i.value,n=e.index,o=e.count,s=e.holeIndices,c=e.pathLengths;if(o<=1)return"continue";var l=3*n,u=l+3*o,d=s.map((function(e){return e-n}));a.push({index:n,count:o,holeIndices:d,pathLengths:c,position:t.subarray(l,u),mapPosition:r?r.subarray(l,u):void 0})};for(o.s();!(i=o.n()).done;)s()}catch(c){o.e(c)}finally{o.f()}return a}var Y=r(380),$=r(84),J=r(162),K=r(163),ee=r(211),te=["polygon","extent"],re=function(e){Object(u.a)(r,e);var t=Object(d.a)(r);function r(e,n,i,a){var o;return Object(c.a)(this,r),(o=t.call(this,e,n,i,a)).ensureDrapedStatus(!1),o}return Object(l.a)(r,[{key:"doLoad",value:function(){var e=Object(s.a)(o.a.mark((function e(){var t,r,n,i,a,s,c;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._drivenProperties.size){e.next=4;break}if(!(t=Object(L.k)(this._getSymbolSize()))){e.next=4;break}throw new j.a("graphics3dextrudesymbollayer:invalid-size",t);case 4:r=Object(f.h)(this.symbolLayer,"material","color"),n=this._getCombinedOpacityAndColor(r),i=Object(C.f)(n),a=n[3],s=a<1||this.needsDrivenTransparentPass,c={usePBR:this._context.physicalBasedRenderingEnabled,isSchematic:!0,diffuse:i,ambient:i,opacity:a,transparent:s,cullFace:s?0:2,vertexColors:!0,slicePlaneEnabled:this._context.slicePlaneEnabled,castShadows:this.symbolLayer.castShadows,offsetTransparentBackfaces:!0},this._material=new ee.a(c),this._bottomMaterial=new ee.a(Object(y.a)(Object(y.a)({},c),{},{cullFace:2})),this._context.stage.add(this._material),this._context.stage.add(this._bottomMaterial);case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"destroy",value:function(){Object(g.a)(Object(O.a)(r.prototype),"destroy",this).call(this),this._material&&(this._context.stage.remove(this._material),this._context.stage.remove(this._bottomMaterial))}},{key:"createGraphics3DGraphic",value:function(e){var t=e.graphic;if(!this._validateGeometry(t.geometry,te,this.symbolLayer.type))return null;var r=this._getVertexOpacityAndColor(e.renderingInfo,255),n=this.setGraphicElevationContext(t,new D.a);return this._createAs3DShape(t,e.renderingInfo,r,n,t.uid)}},{key:"layerOpacityChanged",value:function(e,t){var r=this,n=Object(f.h)(this.symbolLayer,"material","color"),i=this._getCombinedOpacity(n),a=i<1||this.needsDrivenTransparentPass;this._material.setParameterValues({opacity:i,transparent:a}),this._bottomMaterial.setParameterValues({opacity:i,transparent:a});var o=this._getLayerOpacity();return e.forEach((function(e){var n=t(e);Object(f.j)(n)&&n.layerOpacityChanged(o,r._context.isAsync)})),!0}},{key:"layerElevationInfoChanged",value:function(e,t){return this.updateGraphics3DGraphicElevationInfo(e,t,I.g)}},{key:"slicePlaneEnabledChanged",value:function(e,t){var r=this;return this._material.setParameterValues({slicePlaneEnabled:this._context.slicePlaneEnabled}),this._bottomMaterial.setParameterValues({slicePlaneEnabled:this._context.slicePlaneEnabled}),e.forEach((function(e){var n=t(e);Object(f.j)(n)&&n.slicePlaneEnabledChanged(r._context.slicePlaneEnabled,r._context.isAsync)})),!0}},{key:"physicalBasedRenderingChanged",value:function(){return this._material.setParameterValues({usePBR:this._context.physicalBasedRenderingEnabled,isSchematic:!0}),this._bottomMaterial.setParameterValues({usePBR:this._context.physicalBasedRenderingEnabled,isSchematic:!0}),!0}},{key:"pixelRatioChanged",value:function(){return!0}},{key:"_getExtrusionSize",value:function(e){var t,r;return t=e.size&&this._drivenProperties.size?null!=(r=Object(R.a)(e.size,2))?r:0:this._getSymbolSize(),t/=this._context.renderCoordsHelper.unitInMeters}},{key:"_getSymbolSize",value:function(){var e;return null!=(e=this.symbolLayer.size)?e:1}},{key:"_createAs3DShape",value:function(e,t,r,n,i){var a=H(e.geometry);if(Object(f.i)(a))return null;var o=W(a,this._context.elevationProvider,this._context.renderCoordsHelper,n);if(this._logGeometryCreationWarnings(o,a.rings,"rings","ExtrudeSymbol3DLayer"),0===a.rings.length||!a.rings.some((function(e){return e.length>0})))return null;var s=Object(L.a)(a);if(Object(f.i)(s))return null;var c=new Array,l=new Array,u=new Array,d=Object(P.h)(),h=Object(S.d)(),p=Object(C.e)(),b=1===this._context.renderCoordsHelper.viewingMode;b||this._context.renderCoordsHelper.worldUpAtPosition(null,p),Object(M.d)(a.spatialReference,[s.x,s.y,0],h,this._context.renderCoordsHelper.spatialReference);var m=Object(S.d)();Object(k.a)(m,h);var y=Object(x.b)();Object(w.a)(y,m);for(var g=o.polygons,O=o.mapPosition,j=o.position,T=j.length/3,R=new Float64Array(3*T*6),D=new Float64Array(3*T*6),F=new Float64Array(3*T*6),z=new Float64Array(1*T*6),V=0,N=0;N<g.length;++N){var U=g[N],B=U.count;if(!this._context.clippingExtent||(Object(P.k)(d),Object(P.n)(d,U.mapPosition),Object(P.w)(d,this._context.clippingExtent))){var G=Object(_.a)(U.mapPosition,U.holeIndices,3);if(0!==G.length){var q=3*B*2+G.length,Q=new Uint32Array(q),Z=new Uint32Array(G.length),X=6*B,$=3*R.BYTES_PER_ELEMENT,J=new A.v(R.buffer,V*$,$,(V+X)*$),ee=3*D.BYTES_PER_ELEMENT,te=new A.v(D.buffer,V*ee,ee,(V+X)*ee),re=new Float64Array(F.buffer,3*V*F.BYTES_PER_ELEMENT,3*X),ie=new Float64Array(z.buffer,1*V*z.BYTES_PER_ELEMENT,1*X),ae=this._getExtrusionSize(t);ne(j,O,G,U,J.typedBuffer,re,te.typedBuffer,ie,0,Q,Z,ae,p,b),Object(E.e)(J,J,m),Object(E.a)(te,te,y),V+=6*B;var oe=this._createExtrudeGeometry(Q,Q.length-Z.length,{positions:J.typedBuffer,elevation:re,normals:te.typedBuffer,heights:ie},r);c.push(oe),l.push(this._material),u.push(S.a);var se=this._createExtrudeGeometry(Z,0,{positions:J.typedBuffer,elevation:re,normals:te.typedBuffer,heights:ie},r);c.push(se),l.push(this._bottomMaterial),u.push(S.a)}}}if(0===c.length)return null;var ce=new K.a({geometries:c,materials:l,transformations:u,metadata:{layerUid:this._context.layer.uid,graphicUid:i,isElevationSource:!0}});ce.transformation=h;var le=pe,ue=Object(Y.a)(this.symbolLayer,{opacity:this._getLayerOpacity()}),de=Object(f.j)(ue)?{baseMaterial:this._material,edgeMaterials:[ue],properties:{mergeGeometries:!0,slicePlaneEnabled:this._context.slicePlaneEnabled}}:null,he=new v.a(this,ce,c,null,null,le,n,de);return he.alignedSampledElevation=o.sampledElevation,he.needsElevationUpdates=Object(I.g)(n.mode),he}},{key:"_createExtrudeGeometry",value:function(e,t,r,n){var i=new Uint32Array(e.length),a=[["position",{size:3,data:r.positions,exclusive:!0}],["normal",{size:3,data:r.normals,exclusive:!0}],["color",{size:4,data:n,exclusive:!0}],["size",{size:1,data:r.heights,exclusive:!0}]],o=[["position",e],["normal",e],["color",i]];return r.elevation&&(a.push(["mapPos",{size:3,data:r.elevation}]),o.push(["mapPos",e])),new N.a(a,o,0,t)}}]),r}(F.a);function ne(e,t,r,n,i,a,o,s,c,l,u,d,h,f){var p=r.length/3,b=0,v=2*n.count;(function(e,t,r,n,i,a,o,s,c,l,u,d,h,f,p,b,v,m){Object(T.m)(ve,v);for(var y=b>0?1:-1,g=3*r,O=d,j=3*O,_=d+n,w=3*_,x=0;x<n;++x)m&&(ve[0]=e[g+0],ve[1]=e[g+1],ve[2]=e[g+2],Object(T.t)(ve,ve)),s[j+0]=e[g+0],s[j+1]=e[g+1],s[j+2]=e[g+2],c[j+0]=t[g+0],c[j+1]=t[g+1],c[j+2]=t[g+2],l[j+0]=-y*ve[0],l[j+1]=-y*ve[1],l[j+2]=-y*ve[2],u[O]=0,s[w+0]=e[g+0]+b*ve[0],s[w+1]=e[g+1]+b*ve[1],s[w+2]=e[g+2]+b*ve[2],c[w+0]=t[g+0],c[w+1]=t[g+1],c[w+2]=t[g+2],l[w+0]=y*ve[0],l[w+1]=y*ve[1],l[w+2]=y*ve[2],u[_]=b,j+=3,w+=3,g+=3,O+=1,_+=1;g=3*a,j=0,w=3*p;for(var k=b<0?ye:me,S=b<0?me:ye,C=0;C<o;++C)f[j+0]=i[g+k[0]],f[j+1]=i[g+k[1]],f[j+2]=i[g+k[2]],h[w+0]=i[g+S[0]]+n,h[w+1]=i[g+S[1]]+n,h[w+2]=i[g+S[2]]+n,j+=3,w+=3,g+=3})(e,t,n.index,n.count,r,0,p,i,a,o,s,c,l,u,v,d,h,f),c+=2*n.count,v=0,oe(i,a,s,o,b,n.pathLengths[0],n.count,c,l,v,d),c+=4*n.pathLengths[0],v+=2*n.pathLengths[0],b+=n.pathLengths[0];for(var m=1;m<n.pathLengths.length;++m)oe(i,a,s,o,b,n.pathLengths[m],n.count,c,l,v,d),c+=4*n.pathLengths[m],v+=2*n.pathLengths[m],b+=n.pathLengths[m]}function ie(e,t,r,n,i,a,o){n[a]=n[o],o*=3,e[0+(a*=3)]=e[o+0],e[a+1]=e[o+1],e[a+2]=e[o+2],t[a+0]=t[o+0],t[a+1]=t[o+1],t[a+2]=t[o+2],r[a+0]=i[0],r[a+1]=i[1],r[a+2]=i[2]}var ae=Object(C.e)();function oe(e,t,r,n,i,a,o,s,c,l,u){var d=i,h=i+1,f=i+o,p=i+o+1,b=s,v=s+1,m=s+2*a,y=s+2*a+1;u<0&&(d=i+o+1,p=i),l*=3;for(var g=0;g<a;++g)g===a-1&&(u>0?(h=i,p=i+o):(h=i,d=i+o)),he(e,d,h,f,ae),ie(e,t,n,r,ae,b,d),ie(e,t,n,r,ae,v,h),ie(e,t,n,r,ae,m,f),ie(e,t,n,r,ae,y,p),c[l++]=b,c[l++]=m,c[l++]=y,c[l++]=b,c[l++]=y,c[l++]=v,d++,h++,f++,p++,b+=2,v+=2,m+=2,y+=2}var se=Object(C.e)(),ce=Object(C.e)(),le=Object(C.e)(),ue=Object(C.e)(),de=Object(C.e)();function he(e,t,r,n,i){t*=3,r*=3,n*=3,Object(T.y)(se,e[t++],e[t++],e[t++]),Object(T.y)(ce,e[r++],e[r++],e[r++]),Object(T.y)(le,e[n++],e[n++],e[n++]),Object(T.l)(ue,ce,se),Object(T.l)(de,le,se),Object(T.i)(i,de,ue),Object(T.t)(i,i)}var fe=Object(C.e)();function pe(e,t,r,n){for(var i=e.stageObject,a=i.geometryRecords,o=a.length,s="absolute-height"!==t.mode,c=0,l=i.transformation,u=Object(k.a)(Object(S.d)(),l),d=0;d<o;d+=2){for(var h=a[d].geometry,f=h.getMutableAttribute("position").data,p=h.vertexAttributes.get("size").data,b=h.vertexAttributes.get("mapPos").data,v=new J.a(b),m=f.length/3,y=0,g=!1,O=0,j=r.spatialReference,_=0;_<m;_++){fe[0]=f[y],fe[1]=f[y+1],fe[2]=f[y+2];var w=Object(I.e)(v,r,t,n,s?Oe:null);s&&(O+=Oe.sampledElevation),$.a.DISABLE_ELEVATION_ALIGNERS_ITERATIVE_UPDATES?(Object(T.y)(be,v.array[v.offset+0],v.array[v.offset+1],w+p[y/3]),n.toRenderCoords(be,j,be),Object(T.s)(be,be,u)):(Object(T.y)(be,f[y+0],f[y+1],f[y+2]),Object(T.s)(be,be,l),n.setAltitude(be,w+p[y/3]),Object(T.s)(be,be,u)),f[y]=be[0],f[y+1]=be[1],f[y+2]=be[2];var x=ge/n.unitInMeters;(Math.abs(fe[0]-f[y])>=x||Math.abs(fe[1]-f[y+1])>=x||Math.abs(fe[2]-f[y+2])>=x)&&(g=!0),v.offset+=3,y+=3}g&&(h.invalidateBoundingInfo(),i.geometryVertexAttrsUpdated(d),a[d+1].geometry.invalidateBoundingInfo(),i.geometryVertexAttrsUpdated(d+1)),c+=O/m}return c/o}var be=Object(C.e)(),ve=Object(C.e)(),me=[0,2,1],ye=[0,1,2],ge=.01,Oe={verticalDistanceToGround:0,sampledElevation:0},je=r(49),_e=(r(98),r(17)),we=r(28),xe=r(39),ke=r(38),Se=r(54),Te=r(43),Ce=r(153),Me=r(484),Pe=r(267),Ae=r(618),Ee=r(477),Re=r(199),Ie=r(40),De=function(){function e(t,r,n){Object(c.a)(this,e),this.graphics3DSymbolLayer=t,this.renderGeometries=r,this.boundingBox=n,this.type="draped",this.stage=null,this._visible=!1,this._addedToStage=!1,this._layerView=null,this.isElevationSource=!1}return Object(l.a)(e,[{key:"initialize",value:function(e,t,r){this.stage=e,this._layerView=r,this._overlayRenderer=this._layerView.view.basemapTerrain.overlayManager.renderer}},{key:"setVisibility",value:function(e){if(null!=this.stage&&this._visible!==e){if(this._visible=e,e&&!this._addedToStage)return this._addedToStage=!0,void this._overlayRenderer.addGeometries(this.renderGeometries,this._layerView,1);if(e||this._addedToStage){var t,r=Object(n.a)(this.renderGeometries);try{for(r.s();!(t=r.n()).done;){t.value.instanceParameters.visible=this._visible}}catch(i){r.e(i)}finally{r.f()}this._overlayRenderer.updateGeometries(this.renderGeometries,this._layerView,1)}}}},{key:"destroy",value:function(){this.stage&&this._addedToStage&&this._overlayRenderer.removeGeometries(this.renderGeometries,this._layerView,4),this._addedToStage=!1,this._visible=!1,this.stage=null}},{key:"getCenterObjectSpace",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Object(C.e)();return Object(T.y)(e,0,0,0)}},{key:"getBoundingBoxObjectSpace",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Object(P.h)();return Object(P.k)(e)}},{key:"addObjectState",value:function(e,t){var r=this;0===e&&(this.renderGeometries.forEach((function(e){var n=e.addHighlight();t.addRenderGeometry(e,n,r)})),this._addedToStage&&this._overlayRenderer.updateHighlights(this.renderGeometries,this._layerView))}},{key:"removeObjectState",value:function(e){this.renderGeometries.forEach((function(t){e.removeRenderGeometry(t)}))}},{key:"removeRenderGeometryObjectState",value:function(e,t){e.removeHighlight(t),this._addedToStage&&this._overlayRenderer.updateHighlights(this.renderGeometries,this._layerView)}},{key:"computeAttachmentOrigin",value:function(e){var t,r=Object(n.a)(this.renderGeometries);try{for(r.s();!(t=r.n()).done;){t.value.computeAttachmentOrigin(ze)&&(e.draped.origin[0]+=ze[0],e.draped.origin[1]+=ze[1],e.draped.num++)}}catch(i){r.e(i)}finally{r.f()}}},{key:"getProjectedBoundingBox",value:function(){var e=Object(s.a)(o.a.mark((function e(t,r,n,i,a){var s,c,l,u;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(Object(P.k)(a),s=0;s<this.renderGeometries.length;s++)c=this.renderGeometries[s],this._getRenderGeometryProjectedBoundingRect(c,t,Fe,n),Object(P.q)(a,Fe);if(!r){e.next=14;break}return Object(P.e)(a,ze),u=Object(L.d)(a,r),e.prev=5,e.next=8,r.service.queryElevation(ze[0],ze[1],i,u,"ground");case 8:l=e.sent,e.next=13;break;case 11:e.prev=11,e.t0=e.catch(5);case 13:Object(f.j)(l)&&(a[2]=Math.min(a[2],l),a[5]=Math.max(a[5],l));case 14:return e.abrupt("return",a);case 15:case"end":return e.stop()}}),e,this,[[5,11]])})));return function(t,r,n,i,a){return e.apply(this,arguments)}}()},{key:"_getRenderGeometryProjectedBoundingRect",value:function(e,t,r,n){if(this.boundingBox)Object(P.B)(Le,this.boundingBox);else{var i=e.boundingSphere,a=i[3];Le[0]=i[0]-a,Le[1]=i[1]-a,Le[2]=i[2]-a,Le[3]=i[0]+a,Le[4]=i[1]+a,Le[5]=i[2]+a}return t(Le,0,2),this.calculateRelativeScreenBounds&&n.push({location:Object(P.e)(Le),screenSpaceBoundingRect:this.calculateRelativeScreenBounds()}),Object(P.F)(Le,r)}}]),e}(),Fe=Object(Ie.k)(),Le=Object(P.h)(),ze=Object(C.e)(),Ve=De,Ne=r(186),Ue=r(46);function Be(e,t){for(var r=e,n=new Uint8Array(4*r*r),i=r/2-.5,a=t/2,o=0;o<r;o++)for(var s=0;s<r;s++){var c=s+r*o,l=s-i,u=o-i,d=Math.sqrt(l*l+u*u)-a;d=d/e+.5,Object(Ue.i)(d,n,4*c)}return n}function Ge(e,t){return Ze(e,t,!1)}function qe(e,t){return Ze(e,t,!0)}function He(e,t){return Xe(e,t,!1)}function We(e,t){return Xe(e,t,!0)}function Qe(e,t){for(var r=new Uint8Array(4*e*e),n=-.5,i=Math.sqrt(1.25),a=(e-t)/2,o=0;o<e;o++)for(var s=0;s<e;s++){var c=o*e+s,l=(s-a)/t,u=(o-a+.75)/t,d=-(1*l+n*u)/i,h=(1*(l-1)+n*-u)/i,f=-u,p=Math.max(d,h,f);Object(Ue.i)(p*t/e+.5,r,4*c)}return r}function Ze(e,t,r){r&&(t/=Math.SQRT2);for(var n=new Uint8Array(4*e*e),i=0;i<e;i++)for(var a=0;a<e;a++){var o=a-.5*e+.25,s=.5*e-i-.75,c=i*e+a;if(r){var l=(o+s)/Math.SQRT2;s=(s-o)/Math.SQRT2,o=l}var u=Math.max(Math.abs(o),Math.abs(s))-.5*t;u=u/e+.5,Object(Ue.i)(u,n,4*c)}return n}function Xe(e,t,r){r&&(t*=Math.SQRT2);for(var n=.5*t,i=new Uint8Array(4*e*e),a=0;a<e;a++)for(var o=0;o<e;o++){var s=o-.5*e,c=.5*e-a-1,l=a*e+o;if(r){var u=(s+c)/Math.SQRT2;c=(c-s)/Math.SQRT2,s=u}var d=void 0;d=(d=(s=Math.abs(s))>(c=Math.abs(c))?s>n?Math.sqrt((s-n)*(s-n)+c*c):c:c>n?Math.sqrt(s*s+(c-n)*(c-n)):s)/e+.5,Object(Ue.i)(d,i,4*l)}return i}var Ye,$e=r(20),Je=r(313);function Ke(e){return null!=e}function et(e){return"number"==typeof e}function tt(e){return"string"==typeof e}function rt(e,t){e&&e.push(t)}function nt(e,t,r,n,i){var a=e.minSize,o=e.maxSize;if(e.expression)return rt(i,"Could not convert size info: expression not supported"),!1;if(e.useSymbolValue){var s=n.symbolSize[r];return t.minSize[r]=s,t.maxSize[r]=s,t.offset[r]=t.minSize[r],t.factor[r]=0,t.type[r]=1,!0}if(Ke(e.field))return Ke(e.stops)?2===e.stops.length&&et(e.stops[0].size)&&et(e.stops[1].size)?(it(e.stops[0].size,e.stops[1].size,e.stops[0].value,e.stops[1].value,t,r),t.type[r]=1,!0):(rt(i,"Could not convert size info: stops only supported with 2 elements"),!1):et(a)&&et(o)&&Ke(e.minDataValue)&&Ke(e.maxDataValue)?(it(a,o,e.minDataValue,e.maxDataValue,t,r),t.type[r]=1,!0):null!=Je.a[e.valueUnit]?(t.minSize[r]=-1/0,t.maxSize[r]=1/0,t.offset[r]=0,t.factor[r]=1/Je.a[e.valueUnit],t.type[r]=1,!0):"unknown"===e.valueUnit?(rt(i,"Could not convert size info: proportional size not supported"),!1):(rt(i,"Could not convert size info: scale-dependent size not supported"),!1);if(!Ke(e.field)){if(e.stops&&e.stops[0]&&et(e.stops[0].size))return t.minSize[r]=e.stops[0].size,t.maxSize[r]=e.stops[0].size,t.offset[r]=t.minSize[r],t.factor[r]=0,t.type[r]=1,!0;if(et(a))return t.minSize[r]=a,t.maxSize[r]=a,t.offset[r]=a,t.factor[r]=0,t.type[r]=1,!0}return rt(i,"Could not convert size info: unsupported variant of sizeInfo"),!1}function it(e,t,r,n,i,a){var o=Math.abs(n-r)>0?(t-e)/(n-r):0;i.minSize[a]=o>0?e:t,i.maxSize[a]=o>0?t:e,i.offset[a]=e-r*o,i.factor[a]=o}function at(e,t,r,n){if(e.normalizationField||e.valueRepresentation)return rt(n,"Could not convert size info: unsupported property"),null;if(!function(e){return null==e||tt(e)}(e.field))return rt(n,"Could not convert size info: field is not a string"),null;if(t.size){if(e.field)if(t.size.field){if(e.field!==t.size.field)return rt(n,"Could not convert size info: multiple fields in use"),null}else t.size.field=e.field}else t.size={field:e.field,minSize:[0,0,0],maxSize:[0,0,0],offset:[0,0,0],factor:[0,0,0],type:[0,0,0]};var i;switch(e.axis){case"width":return(i=nt(e,t.size,0,r,n))?t:null;case"height":return(i=nt(e,t.size,2,r,n))?t:null;case"depth":return(i=nt(e,t.size,1,r,n))?t:null;case"width-and-depth":return(i=nt(e,t.size,0,r,n))&&nt(e,t.size,1,r,n),i?t:null;case null:case void 0:case"all":return(i=(i=(i=nt(e,t.size,0,r,n))&&nt(e,t.size,1,r,n))&&nt(e,t.size,2,r,n))?t:null;default:return rt(n,'Could not convert size info: unknown axis "'.concat(e.axis,'""')),null}}function ot(e,t,r){e[4*t+0]=r.r/255,e[4*t+1]=r.g/255,e[4*t+2]=r.b/255,e[4*t+3]=r.a}function st(e,t,r){var n=2===r&&"arithmetic"===e.rotationType;t.offset[r]=n?90:0,t.factor[r]=n?-1:1,t.type[r]=1}function ct(e,t,r){if(!e)return null;var n=!t.supportedTypes||!!t.supportedTypes.size,i=!t.supportedTypes||!!t.supportedTypes.color,a=!t.supportedTypes||!!t.supportedTypes.rotation,o=!!t.supportedTypes&&!!t.supportedTypes.opacity,s=e.reduce((function(e,s){if(!e)return e;if(s.valueExpression)return rt(r,"Could not convert visual variables: arcade expressions not supported"),null;switch(s.type){case"size":return n?at(s,e,t,r):e;case"color":return i?function(e,t,r){if(e.normalizationField)return rt(r,"Could not convert color info: unsupported property"),null;if(tt(e.field)){if(!e.stops)return rt(r,"Could not convert color info: missing stops or colors"),null;if(e.stops.length>8)return rt(r,"Could not convert color info: too many color stops"),null;t.color={field:e.field,values:[0,0,0,0,0,0,0,0],colors:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]};for(var n=e.stops,i=0;i<8;++i){var a=n[Math.min(i,n.length-1)];t.color.values[i]=a.value,ot(t.color.colors,i,a.color)}}else{if(!(e.stops&&e.stops.length>=0))return rt(r,"Could not convert color info: no field and no colors/stops"),null;var o=e.stops&&e.stops.length>=0&&e.stops[0].color;t.color={field:null,values:[0,0,0,0,0,0,0,0],colors:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]};for(var s=0;s<8;s++)t.color.values[s]=1/0,ot(t.color.colors,s,o)}return t}(s,e,r):e;case"opacity":return o?function(e,t,r){if(e.normalizationField)return rt(r,"Could not convert opacity info: unsupported property"),null;if(tt(e.field)){if(!e.stops)return rt(r,"Could not convert opacity info: missing stops or opacities"),null;if(e.stops.length>8)return rt(r,"Could not convert opacity info: too many opacity stops"),null;t.opacity={field:e.field,values:[0,0,0,0,0,0,0,0],opacityValues:[0,0,0,0,0,0,0,0]};for(var n=e.stops,i=0;i<8;++i){var a=n[Math.min(i,n.length-1)];t.opacity.values[i]=a.value,t.opacity.opacityValues[i]=a.opacity}}else{if(!(e.stops&&e.stops.length>=0))return rt(r,"Could not convert opacity info: no field and no opacities/stops"),null;var o=e.stops&&e.stops.length>=0&&e.stops[0].opacity;t.opacity={field:null,values:[0,0,0,0,0,0,0,0],opacityValues:[0,0,0,0,0,0,0,0]};for(var s=0;s<8;s++)t.opacity.values[s]=1/0,t.opacity.opacityValues[s]=o}return t}(s,e,r):null;case"rotation":return a?function(e,t,r){if(!tt(e.field))return rt(r,"Could not convert rotation info: field is not a string"),null;if(t.rotation){if(e.field)if(t.rotation.field){if(e.field!==t.rotation.field)return rt(r,"Could not convert rotation info: multiple fields in use"),null}else t.rotation.field=e.field}else t.rotation={field:e.field,offset:[0,0,0],factor:[1,1,1],type:[0,0,0]};switch(e.axis){case"tilt":return st(e,t.rotation,0),t;case"roll":return st(e,t.rotation,1),t;case null:case void 0:case"heading":return st(e,t.rotation,2),t;default:return rt(r,'Could not convert rotation info: unknown axis "'.concat(e.axis,'""')),null}}(s,e,r):e;default:return null}}),{size:null,color:null,opacity:null,rotation:null});return!(e.length>0&&s)||s.size||s.color||s.opacity||s.rotation?s&&s.size&&!function(e,t,r){for(var n=0;n<3;++n){var i=t.unitInMeters;1===e.type[n]&&(i*=t.modelSize[n],e.type[n]=2),e.minSize[n]=e.minSize[n]/i,e.maxSize[n]=e.maxSize[n]/i,e.offset[n]=e.offset[n]/i,e.factor[n]=e.factor[n]/i}var a;if(0!==e.type[0])a=0;else if(0!==e.type[1])a=1;else{if(0===e.type[2])return rt(r,"No size axis contains a valid size or scale"),!1;a=2}for(var o=0;o<3;++o)0===e.type[o]&&(e.minSize[o]=e.minSize[a],e.maxSize[o]=e.maxSize[a],e.offset[o]=e.offset[a],e.factor[o]=e.factor[a],e.type[o]=e.type[a]);return!0}(s.size,t,r)?null:s:null}function lt(e){return e&&null!=e.size}function ut(e,t){if(!e)return{enabled:!1};if($.a.DISABLE_FAST_UPDATES)return{enabled:!1};var r=ct(e.visualVariables,t);return r?{enabled:!0,visualVariables:r,materialParameters:ft(r,t),requiresShaderTransformation:lt(r)}:{enabled:!1}}function dt(e,t,r){if(!t||!e.enabled)return!1;var n=e.visualVariables,i=ct(t.visualVariables,r);return!!i&&!!(ht(n.size,i.size,"size")&&ht(n.color,i.color,"color")&&ht(n.rotation,i.rotation,"rotation")&&ht(n.opacity,i.opacity,"opacity"))&&(e.visualVariables=i,e.materialParameters=ft(i,r),e.requiresShaderTransformation=lt(i),!0)}function ht(e,t,r){if(!!e!=!!t)return!1;if(e&&e.field!==t.field)return!1;if(e&&"rotation"===r)for(var n=e,i=t,a=0;a<3;a++)if(n.type[a]!==i.type[a]||n.offset[a]!==i.offset[a]||n.factor[a]!==i.factor[a])return!1;return!0}function ft(e,t){var r={vvSizeEnabled:!1,vvSizeMinSize:null,vvSizeMaxSize:null,vvSizeOffset:null,vvSizeFactor:null,vvSizeValue:null,vvColorEnabled:!1,vvColorValues:null,vvColorColors:null,vvOpacityEnabled:!1,vvOpacityValues:null,vvOpacityOpacities:null,vvSymbolAnchor:null,vvSymbolRotationMatrix:null},n=lt(e);return e&&e.size?(r.vvSizeEnabled=!0,r.vvSizeMinSize=e.size.minSize,r.vvSizeMaxSize=e.size.maxSize,r.vvSizeOffset=e.size.offset,r.vvSizeFactor=e.size.factor):e&&n&&(r.vvSizeValue=t.transformation.scale),e&&n&&(r.vvSymbolAnchor=t.transformation.anchor,r.vvSymbolRotationMatrix=Object(x.b)(),Object(k.i)(pt),function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Object(S.d)(),i=e||0,a=t||0,o=r||0;0!==i&&Object(k.r)(n,n,-i/180*Math.PI),0!==a&&Object(k.b)(n,n,a/180*Math.PI),0!==o&&Object(k.j)(n,n,o/180*Math.PI)}(t.transformation.rotation[2],t.transformation.rotation[0],t.transformation.rotation[1],pt),Object(w.f)(r.vvSymbolRotationMatrix,pt)),e&&e.color&&(r.vvColorEnabled=!0,r.vvColorValues=e.color.values,r.vvColorColors=e.color.colors),e&&e.opacity&&(r.vvOpacityEnabled=!0,r.vvOpacityValues=e.opacity.values,r.vvOpacityOpacities=e.opacity.opacityValues),r}!function(e){var t=Object(S.d)(),r=Object(C.e)();e.evaluateModelTransform=function(e,n,i){if(!e.vvSizeEnabled)return i;Object(k.d)(t,i);var a=e.vvSymbolRotationMatrix;Object(k.h)(pt,a[0],a[1],a[2],0,a[3],a[4],a[5],0,a[6],a[7],a[8],0,0,0,0,1),Object(k.m)(t,t,pt);for(var o=0;o<3;++o){var s=e.vvSizeOffset[o]+n[0]*e.vvSizeFactor[o];r[o]=Object($e.e)(s,e.vvSizeMinSize[o],e.vvSizeMaxSize[o])}return Object(k.s)(t,t,r),Object(k.t)(t,t,e.vvSymbolAnchor),t},e.evaluateModelTransformScale=function(e,t,r){if(!t.vvSizeEnabled)return Object(T.y)(e,1,1,1);for(var n=0;n<3;++n){var i=t.vvSizeOffset[n]+r[0]*t.vvSizeFactor[n];e[n]=Object($e.e)(i,t.vvSizeMinSize[n],t.vvSizeMaxSize[n])}return e}}(Ye||(Ye={}));var pt=Object(S.d)(),bt=Ye.evaluateModelTransform,vt=Ye.evaluateModelTransformScale,mt=r(171),yt=r(262),gt=r(206),Ot=r(295),jt=r(290),_t=Object(S.d)(),wt=Object(C.g)(0,0,1),xt=128,kt=.5,St=[.25,.25,.75,.75],Tt=[64,64],Ct=function(e){Object(u.a)(i,e);var t=Object(d.a)(i);function i(e,r,n,a){var o;return Object(c.a)(this,i),(o=t.call(this,e,r,n,a))._cimLayers=null,o._cimSymbolMaterials=new Map,o._cimSymbolTextures=new Map,o._cimMaterialParametersInfo=null,o._cimRequiredFields=null,o._cimScaleFactorOrFunction=null,o._size=null,o._symbolTextureRatio=1,o._outlineSize=0,o._texture=null,o._releaseTexture=null,o._elevationOptions={supportsOffsetAdjustment:!0,supportsOnTheGround:!0},o}return Object(l.a)(i,[{key:"getCachedSize",value:function(){return{size:this._getIconSize()}}},{key:"doLoad",value:function(){var e=Object(s.a)(o.a.mark((function e(t){var r,n,i,a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._validateOrThrow(),r=this._prepareMaterialParameters(),n=this._getPrimitive(),!Object(f.j)(n)){e.next=6;break}this._prepareResourcesPrimitive(r,n),e.next=14;break;case 6:if(i=Object(Pe.f)(this.symbol,this.symbolLayer),!(a=Object(xe.i)(i))||"application/json"!==a.mediaType){e.next=12;break}return e.next=10,this._prepareResourcesCIM(r,JSON.parse(a.data),t);case 10:e.next=14;break;case 12:return e.next=14,this._prepareResourcesHref(r,i,t);case 14:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_validateOrThrow",value:function(){if(!this._drivenProperties.size){var e=Object(L.k)(this._getIconSize());if(e)throw new j.a("graphics3diconsymbollayer:invalid-size",e)}}},{key:"_getIconSize",value:function(){var e=this.symbolLayer,t=Math.round(null!=e.size?Object(we.g)(e.size):16);return this._drivenProperties.size?Math.max(t,64):t}},{key:"_generateTextureCIM",value:function(e){var t=this._getGraphicHash(e),r=""===t?null:this._cimSymbolTextures.get(t);if(!r){var n={scaleFactor:this._cimScaleFactorOrFunction},i=this._context.sharedResources.cimSymbolRasterizer.rasterizeCIMSymbol(this._cimLayers,e,"esriGeometryPoint",n,null,null);this._cimMaterialParametersInfo.anchorPos=this._getAnchorPos("relative",i.anchorPosition);var a={width:i.imageData.width,height:i.imageData.height,powerOfTwoResizeMode:2};r=new gt.a(i.imageData,a),this._cimSymbolTextures.set(t,r),this._context.stage.add(r)}return r}},{key:"_computeSize",value:function(e,t){var r=e.width/e.height;return r>1?[t,Math.round(t/r)]:[Math.round(t*r),t]}},{key:"_prepareMaterialParameters",value:function(){var e={anchorPos:this._getAnchorPos(this.symbolLayer.anchor,this.symbolLayer.anchorPosition)},t=this.symbol;if(function(e){return e&&"point-3d"===e.type&&e.hasVisibleVerticalOffset()}(t)){var r=t.verticalOffset,n=r.screenLength,i=r.minWorldLength,a=r.maxWorldLength;e.verticalOffset={screenLength:Object(we.g)(n),minWorldLength:i||0,maxWorldLength:null!=a?a:1/0}}return this._context.screenSizePerspectiveEnabled&&(e.screenSizePerspective=this._context.sharedResources.screenSizePerspectiveSettings),e.occlusionTest=!0,e.slicePlaneEnabled=this._context.slicePlaneEnabled,e}},{key:"_prepareResourcesPrimitive",value:function(e,t){var r=this,n=this._getOutlineSize();if(Mt(t)&&0===n)throw new Error("Nothing to render");this._outlineSize=n,e.color=this._getFillColor(),e.outlineColor=this._getOutlineColor(),e.outlineSize=this._outlineSize;var i=this._context.sharedResources.textures.fromData(t,(function(){return function(e){var t,r=xt,n=r*kt;switch(e){case"circle":t=Be(r,n);break;case"square":t=Ge(r,n);break;case"kite":t=qe(r,n);break;case"cross":t=He(r,n);break;case"x":t=We(r,n);break;case"triangle":t=Qe(r,n)}return new gt.a(t,{mipmap:!1,wrap:{s:33071,t:33071},width:xt,height:xt,components:4,noUnpackFlip:!0})}(t)}));this._texture=i.texture,this._releaseTexture=function(){return r._context.sharedResources.textures.release(i.uid)},e.textureIsSignedDistanceField=!0,e.distanceFieldBoundingBox=St,e.textureId=this._texture.id;var a=this._getIconSize();this._size=[a,a],this._symbolTextureRatio=2,this._createMaterialAndAddToStage(e,this._context.stage)}},{key:"_prepareResourcesHref",value:function(){var e=Object(s.a)(o.a.mark((function e(t,r,n){var i,a,s,c,l,u,d,f=this;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Object(_e.a)("esri-canvas-svg-support")||!Object(xe.x)(r)){e.next=2;break}throw new j.a("graphics3diconsymbollayer:unsupported-image-format","IconSymbol3DLayer failed to load (SVG symbols are not supported in IE11)");case 2:return this._outlineSize=this._getOutlineSize(),t.color=this._getFillColor(),t.outlineColor=this._getOutlineColor(),t.outlineSize=this._outlineSize,t.textureIsSignedDistanceField=!1,i=this._getIconSize(),a=i*this._context.layerView.view.pixelRatio,e.next=7,Object(h.d)(this._context.sharedResources.textures.fromUrl(r,a,{signal:n}));case 7:if(!1!==(s=e.sent).ok){e.next=11;break}throw Object(p.w)(s.error),new j.a("graphics3diconsymbollayer:request-failed","Failed to load (Request for icon resource failed: ".concat(r,")"));case 11:c=s.value,l=c.uid,u=c.texture,this._releaseTexture=function(){return f._context.sharedResources.textures.release(l)},d=u.params,this._size=this._computeSize(d,i),t.textureId=u.id,this._createMaterialAndAddToStage(t,this._context.stage);case 15:case"end":return e.stop()}}),e,this)})));return function(t,r,n){return e.apply(this,arguments)}}()},{key:"_prepareResourcesCIM",value:function(){var e=Object(s.a)(o.a.mark((function e(t,n,i){var a,s,c,l,u,d,h,f,b,v;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=new jt.a({data:n}),this._context.sharedResources.cimSymbolRasterizer){e.next=6;break}return e.next=4,Promise.all([r.e(7),r.e(19),r.e(42)]).then(r.bind(null,987));case 4:s=e.sent.CIMSymbolRasterizer,Object(p.x)(i),this._context.sharedResources.cimSymbolRasterizer||(this._context.sharedResources.cimSymbolRasterizer=new s(this._context.renderCoordsHelper.spatialReference,!0));case 6:return c=this._context.layer.fields?this._context.layer.fields.map((function(e){return e.toJSON()})):null,e.next=9,this._context.sharedResources.cimSymbolRasterizer.analyzeCIMSymbol(a,c,this._context.renderer&&"dictionary"===this._context.renderer.type?this._context.renderer.fieldMap:null,"esriGeometryPoint",{signal:i});case 9:if(this._cimLayers=e.sent,!this._context.renderer||"dictionary"!==this._context.renderer.type||!this._context.renderer.scaleExpression){e.next=21;break}if(d=this._context.renderer,!isNaN(d.scaleExpression)){e.next=20;break}return h=d.scaleExpression,e.next=16,Object(Ce.d)(h,this._context.layer.spatialReference,c);case 16:f=e.sent,u=function(e,t,r){var n=Object(Ae.a)(f,e,{$view:r},"esriGeometryPoint",t);return null!==n?n:1},e.next=21;break;case 20:l=Number(d.scaleExpression);case 21:if(this._cimScaleFactorOrFunction=l||u||1,!this._context.renderer){e.next=28;break}return e.next=25,this._context.renderer.getRequiredFields(this._context.layer.fieldsIndex);case 25:e.t0=e.sent,e.next=29;break;case 28:e.t0=[];case 29:b=e.t0,Object(p.x)(i),v=this._context.layer.fieldsIndex,this._cimRequiredFields=b.map((function(e){return v.get(e).name})),this._cimMaterialParametersInfo=t,this._cimMaterialParametersInfo.color=this._getFillColor(),this._cimMaterialParametersInfo.outlineColor=[0,0,0,0],this._cimMaterialParametersInfo.outlineSize=0,this._cimMaterialParametersInfo.textureIsSignedDistanceField=!1;case 33:case"end":return e.stop()}}),e,this)})));return function(t,r,n){return e.apply(this,arguments)}}()},{key:"_getPrimitive",value:function(){return this.symbolLayer.resource&&this.symbolLayer.resource.href?null:this.symbolLayer.resource&&this.symbolLayer.resource.primitive||Me.b}},{key:"_getOutlineSize",value:function(){var e,t=this.symbolLayer;return Object(f.j)(t.outline)&&null!=t.outline.size?Math.max(Object(we.g)(t.outline.size),0):(e=Mt(this._getPrimitive())?1.5:0,Math.max(e,0))}},{key:"_getOutlineColor",value:function(){var e=this._getLayerOpacity(),t=this.symbolLayer,r=Object(f.h)(t,"outline","color");if(Object(f.j)(r)){var n=je.a.toUnitRGB(r),i=r.a*e;return[n[0],n[1],n[2],i]}return[0,0,0,0]}},{key:"_getFillColor",value:function(){if(Mt(this._getPrimitive()))return Ee.b;var e=Object(f.i)(this._getPrimitive()),t=Object(f.h)(this.symbolLayer,"material","color");return this._getCombinedOpacityAndColor(t,{hasIntrinsicColor:e})}},{key:"_getAnchorPos",value:function(e,t){return"relative"===e?Object(ke.f)((t.x||0)+.5,.5-(t.y||0)):e in L.h?L.h[e]:L.h.center}},{key:"_createMaterialAndAddToStage",value:function(e,t){if(this._cimLayers?this._fastUpdates={enabled:!1}:this._fastUpdates=ut(this._context.renderer,this._fastVisualVariableConvertOptions()),this._fastUpdates.enabled&&Object.assign(e,this._fastUpdates.materialParameters),this._cimLayers){var r=this._cimSymbolMaterials.get(e.textureId);return r||(r=new Ot.a(e),this._cimSymbolMaterials.set(e.textureId,r),t.add(r)),r}return this._material=new Ot.a(e),t.add(this._material),this._material}},{key:"_setDrapingDependentMaterialParameters",value:function(){var e=this;this.draped&&(this._forEachMaterial((function(t){t.setParameterValues({verticalOffset:null,screenSizePerspective:null,occlusionTest:!1,slicePlaneEnabled:!1,shaderPolygonOffset:0,isDraped:e.draped})})),this.layerOpacityChanged())}},{key:"destroy",value:function(){var e=this;Object(g.a)(Object(O.a)(i.prototype),"destroy",this).call(this),this._forEachMaterial((function(t){return e._context.stage.remove(t)})),this._material=null,this._cimSymbolMaterials.clear(),this._cimSymbolTextures.forEach((function(t){return e._context.stage.remove(t)})),this._cimSymbolTextures.clear(),this._releaseTexture&&(this._releaseTexture(),this._releaseTexture=null)}},{key:"_getScaleFactor",value:function(e,t){if(this._drivenProperties.size&&e.size){for(var r=0;r<3;r++){var n=e.size[r];n&&"symbol-value"!==n&&"proportional"!==n&&(e.size[r]=Object(we.g)(n))}if("symbol-value"===e.size[0])return 1;if(isFinite(+e.size[0]))return+e.size[0]/t;if(isFinite(+e.size[2]))return+e.size[2]/t}return 1}},{key:"createGraphics3DGraphic",value:function(e){var t,r,n=e.graphic;if(!this._validateGeometry(n.geometry))return null;if(this._cimLayers){if(!this._cimLayers.length)return null;var i=this._generateTextureCIM(n),a=Object(y.a)({textureId:i.id},this._cimMaterialParametersInfo);r=this._createMaterialAndAddToStage(a,this._context.stage),t=[i.params.width,i.params.height]}else t=this._size,r=Object(f.s)(this._material);var o=Object(Ne.c)(n.geometry);if(Object(f.i)(o))return this.logger.warn("unsupported geometry type for icon symbol: ".concat(n.geometry.type)),null;var s=e.renderingInfo,c=this._getVertexOpacityAndColor(s),l=1;if(!this._fastUpdates.enabled||!this._fastUpdates.visualVariables.size){var u=t[0]>t[1]?t[0]:t[1];l=this._getScaleFactor(s,u)}l*=this._symbolTextureRatio;var d=[t[0]*l,t[1]*l],h=this.setGraphicElevationContext(n,new D.a);return this.ensureDrapedStatus("on-the-ground"===h.mode)&&this._setDrapingDependentMaterialParameters(),this.draped?this._createAsOverlay(n,o,r,c,d,e.layer.uid):this._createAs3DShape(n,o,r,c,d,h,n.uid)}},{key:"layerOpacityChanged",value:function(){var e=this._getFillColor(),t=this._getOutlineColor();return this._forEachMaterial((function(r){r.setParameterValues({color:e}),r.setParameterValues({outlineColor:t})})),!0}},{key:"layerElevationInfoChanged",value:function(e,t,r){var n=this._elevationContext.mode,a=Object(I.d)(i.elevationModeChangeTypes,r,n);if(a!==I.a.UPDATE)return a;var o=Object(I.f)(n)||"absolute-height"===n;return this.updateGraphics3DGraphicElevationInfo(e,t,(function(){return o}))}},{key:"slicePlaneEnabledChanged",value:function(){var e=this;return this.draped||this._forEachMaterial((function(t){t.setParameterValues({slicePlaneEnabled:e._context.slicePlaneEnabled})})),!0}},{key:"physicalBasedRenderingChanged",value:function(){return!0}},{key:"pixelRatioChanged",value:function(){return!!this._getPrimitive()}},{key:"applyRendererDiff",value:function(e,t){for(var r in e.diff)switch(r){case"visualVariables":if(!dt(this._fastUpdates,t,this._fastVisualVariableConvertOptions()))return!1;Object(f.j)(this._material)&&this._material.setParameterValues(this._fastUpdates.materialParameters);break;default:return!1}return!0}},{key:"_defaultElevationInfoNoZ",value:function(){return Pt}},{key:"_createAs3DShape",value:function(e,t,r,n,i,a,o){var s=this,c=this.getFastUpdateAttrValues(e),l=c?function(e){return bt(s._fastUpdates.materialParameters,c,e)}:null,u=[mt.a.createPointGeometry(wt,null,n,i,At,null,c)],d=Object(Ne.a)(this._context,t,u,[r],null,null,a,this._context.layer.uid,o,l);if(null===d)return null;var h=Re.b,f=new v.a(this,d.object,u,null,null,h,a);return f.alignedSampledElevation=d.sampledElevation,f.needsElevationUpdates=Object(I.f)(a.mode)||"absolute-height"===a.mode,f.getScreenSize=this._createScreenSizeGetter(i,l),f.calculateRelativeScreenBounds=function(e){return r.calculateRelativeScreenBounds(f.getScreenSize(),1,e)},Object(Ne.b)(f,t,this._context.elevationProvider),f}},{key:"_createAsOverlay",value:function(e,t,r,n,i,a){var o=this;r.renderPriority=this._renderPriority;var s=Object(Te.e)();Object(M.u)(t,s,this._context.overlaySR),s[2]=V.a;var c=this._context.clippingExtent;if(Object(f.j)(c)&&!Object(P.g)(c,s))return null;var l=this.getFastUpdateAttrValues(e),u=l?function(e){return bt(o._fastUpdates.materialParameters,l,e)}:null,d=mt.a.createPointGeometry(wt,s,n,i,null,null,l),h=new yt.a(d,r,a,e.uid);s[3]=0,Object(Se.c)(h.boundingSphere,s),h.calculateShaderTransformation=u;var p=new Ve(this,[h],null);return p.getScreenSize=this._createScreenSizeGetter(i,u),p.calculateRelativeScreenBounds=function(e){return r.calculateRelativeScreenBounds(p.getScreenSize(),1,e)},p}},{key:"_createScreenSizeGetter",value:function(e,t){var r=this._outlineSize+2;if(this._fastUpdates.enabled){var n=e[0]/this._symbolTextureRatio,i=e[1]/this._symbolTextureRatio;return function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Object(ke.b)(),a=t(_t);return e[0]=a[0]*n+r,e[1]=a[5]*i+r,e}}var a=e[0]/this._symbolTextureRatio+r,o=e[1]/this._symbolTextureRatio+r;return function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Object(ke.b)();return e[0]=a,e[1]=o,e}}},{key:"_fastVisualVariableConvertOptions",value:function(){var e=this._size[0]>this._size[1]?this._size[0]:this._size[1],t=Object(C.g)(e,e,e),r=Object(we.h)(1),n=e*r;return{modelSize:t,symbolSize:Object(C.g)(n,n,n),unitInMeters:r,transformation:{anchor:C.b,scale:C.a,rotation:C.b}}}},{key:"_getGraphicHash",value:function(e){var t,r="",i=Object(n.a)(this._cimRequiredFields);try{for(i.s();!(t=i.n()).done;){var a=t.value;r+=a+e.attributes[a]}}catch(o){i.e(o)}finally{i.f()}return r}},{key:"_forEachMaterial",value:function(e){Object(f.j)(this._material)&&e(this._material),this._cimSymbolMaterials.forEach(e)}}]),i}(F.a);function Mt(e){return!!Object(f.j)(e)&&("cross"===e||"x"===e)}Ct.PRIMITIVE_SIZE=Tt,Ct.elevationModeChangeTypes={definedChanged:I.a.UPDATE,staysOnTheGround:I.a.NONE,onTheGroundChanged:I.a.RECREATE};var Pt={mode:"relative-to-ground",offset:0},At=Object(Te.g)(0,0,0,1),Et=r(347),Rt=r(464),It=r(344),Dt=["polyline","polygon","extent"],Ft=function(e){Object(u.a)(r,e);var t=Object(d.a)(r);function r(e,n,i,a){var o;return Object(c.a)(this,r),(o=t.call(this,e,n,i,a))._uniformSize=1,o}return Object(l.a)(r,[{key:"doLoad",value:function(){var e=Object(s.a)(o.a.mark((function e(){var t;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._vvConvertOptions={modelSize:[1,1,1],symbolSize:[1,1,1],unitInMeters:1,transformation:{anchor:[0,0,0],scale:[1,1,1],rotation:[0,0,0]},supportedTypes:{size:!0,color:!0,opacity:!0,rotation:!1}},this._context.renderer&&this._context.renderer.visualVariables&&this._context.renderer.visualVariables.length>0?this._fastUpdates=ut(this._context.renderer,this._vvConvertOptions):this._fastUpdates={enabled:!1},this._drivenProperties.size){e.next=5;break}if(!((t=null!=this.symbolLayer.size?this.symbolLayer.size:Object(we.h)(1))<0)){e.next=4;break}throw new j.a("graphics3dlinesymbollayer:invalid-size","Symbol sizes may not be negative values");case 4:this._uniformSize=t;case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getMaterialParameters",value:function(e){var t=Object(f.h)(this.symbolLayer,"material","color"),r=this._getCombinedOpacityAndColor(t),n=r[3],i={width:1,color:r,polygonOffset:!0,join:this.symbolLayer.join||"miter",cap:this.symbolLayer.cap||"butt",transparent:n<1||this.needsDrivenTransparentPass,slicePlaneEnabled:this._context.slicePlaneEnabled,isClosed:e,stipplePattern:this.symbolLayer.stipplePattern?Object(Rt.a)(this.symbolLayer.stipplePattern.map(we.g)):null,stippleOffColor:this.symbolLayer.stippleOffColor?je.a.toUnitRGBA(this.symbolLayer.stippleOffColor):null,stippleIntegerRepeats:!0};if(this._drivenProperties.size)this._fastUpdates.enabled&&this._fastUpdates.visualVariables.size&&(i.width=Object(we.g)(1));else{var a=null!=this.symbolLayer.size?this.symbolLayer.size:Object(we.h)(1);i.width=Object(we.g)(a)}return this._fastUpdates&&this._fastUpdates.visualVariables?Object(y.a)(Object(y.a)({},i),this._fastUpdates.materialParameters):i}},{key:"lineMaterial",get:function(){return Object(f.i)(this._lineMaterial)&&(this._lineMaterial=new It.a(this.getMaterialParameters(!1)),this._context.stage.add(this._lineMaterial)),this._lineMaterial}},{key:"ringMaterial",get:function(){return Object(f.i)(this._ringMaterial)&&(this._ringMaterial=new It.a(this.getMaterialParameters(!0)),this._context.stage.add(this._ringMaterial)),this._ringMaterial}},{key:"destroy",value:function(){Object(g.a)(Object(O.a)(r.prototype),"destroy",this).call(this),this._context.stage.remove(this._lineMaterial),this._lineMaterial=null,this._context.stage.remove(this._ringMaterial),this._ringMaterial=null}},{key:"getDrivenSize",value:function(e){return this._drivenProperties.size&&e.size?Object(we.g)(Object(R.b)(e.size)):1}},{key:"getSizeFeatureAttributeData",value:function(e){return this._fastUpdates.enabled&&this._fastUpdates.visualVariables.size?Object(F.b)(this._fastUpdates.visualVariables.size.field,e):null}},{key:"getDrivenColor",value:function(e){var t=Object(Te.g)(1,1,1,1);return this._drivenProperties.color&&e.color&&(t[0]=e.color[0],t[1]=e.color[1],t[2]=e.color[2],e.color.length>0&&(t[3]=e.color[3])),this._drivenProperties.opacity&&e.opacity&&(t[3]=e.opacity),t}},{key:"getColorFeatureAttributeData",value:function(e){return this._fastUpdates.enabled&&this._fastUpdates.visualVariables.color?Object(F.b)(this._fastUpdates.visualVariables.color.field,e):null}},{key:"getOpacityFeatureAttributeData",value:function(e){return this._fastUpdates.enabled&&this._fastUpdates.visualVariables.opacity?Object(F.b)(this._fastUpdates.visualVariables.opacity.field,e):null}},{key:"createGraphics3DGraphic",value:function(e){var t=e.graphic;if(!this._validateGeometry(t.geometry,Dt,this.symbolLayer.type))return null;var r=this.setGraphicElevationContext(t,new D.a);return this.ensureDrapedStatus("on-the-ground"===r.mode),this.draped?this._createAsOverlay(e,this._context.layer.uid):this._createAs3DShape(e,r,t.uid)}},{key:"applyRendererDiff",value:function(e,t){for(var r in e.diff)switch(r){case"visualVariables":if(!dt(this._fastUpdates,t,this._vvConvertOptions))return!1;Object(f.j)(this._lineMaterial)&&this._lineMaterial.setParameterValues(this._fastUpdates.materialParameters),Object(f.j)(this._ringMaterial)&&this._ringMaterial.setParameterValues(this._fastUpdates.materialParameters);break;default:return!1}return!0}},{key:"layerOpacityChanged",value:function(){return Object(f.j)(this._lineMaterial)&&this.updateMaterialLayerOpacity(this._lineMaterial),Object(f.j)(this._ringMaterial)&&this.updateMaterialLayerOpacity(this._ringMaterial),!0}},{key:"updateMaterialLayerOpacity",value:function(e){var t=e.params.color,r=Object(f.h)(this.symbolLayer,"material","color"),n=this._getCombinedOpacity(r),i=n<1||this.needsDrivenTransparentPass,a=[t[0],t[1],t[2],n];e.setParameterValues({color:a,transparent:i})}},{key:"layerElevationInfoChanged",value:function(e,t,n){var i=this._elevationContext.mode,a=Object(I.d)(r.elevationModeChangeTypes,n,i);if(a!==I.a.UPDATE)return a;var o=Object(I.f)(i);return this.updateGraphics3DGraphicElevationInfo(e,t,(function(){return o}))}},{key:"slicePlaneEnabledChanged",value:function(){return Object(f.j)(this._lineMaterial)&&this._lineMaterial.setParameterValues({slicePlaneEnabled:this._context.slicePlaneEnabled}),Object(f.j)(this._ringMaterial)&&this._ringMaterial.setParameterValues({slicePlaneEnabled:this._context.slicePlaneEnabled}),!0}},{key:"physicalBasedRenderingChanged",value:function(){return!0}},{key:"pixelRatioChanged",value:function(){return!0}},{key:"_getGeometryAsPolygonOrPolyline",value:function(e){switch(e.type){case"extent":if(e instanceof U.a)return B.a.fromExtent(e);break;case"polygon":case"polyline":return e}return null}},{key:"_createAs3DShape",value:function(e,t,r){var n=e.graphic,i=this._getGeometryAsPolygonOrPolyline(n.geometry),a="polygon"===i.type?i.rings:i.paths,o=new Array,s=new Array,c=new Array,l=Object(P.h)(),u=Object(Et.b)(i,this._context.elevationProvider,this._context.renderCoordsHelper,t),d="polygon"===i.type?"rings":"paths";this._logGeometryCreationWarnings(u,a,d,"LineSymbol3DLayer");for(var h=0;h<u.lines.length;h++){var p=u.lines[h],b=p.position,m=p.mapPosition;if(!Object(f.j)(this._context.clippingExtent)||(Object(P.k)(l),Object(P.n)(l,m),Object(P.w)(l,this._context.clippingExtent))){var y=this._createGeometry(e,b,m,i.type);o.push(y),s.push("polygon"===i.type?this.ringMaterial:this.lineMaterial),c.push(S.a)}}if(0===o.length)return null;var g=new K.a({geometries:o,materials:s,transformations:c,castShadow:!1,metadata:{layerUid:this._context.layer.uid,graphicUid:r}}),O=new v.a(this,g,o,null,null,Re.c,t);return O.alignedSampledElevation=u.sampledElevation,O.needsElevationUpdates=Object(I.f)(t.mode),O}},{key:"_createGeometry",value:function(e,t,r,n){var i="polygon"===n?1:0,a=this._fastUpdates.enabled&&this._fastUpdates.visualVariables.color,o=this._fastUpdates.enabled&&this._fastUpdates.visualVariables.size;return Object(Et.a)({removeDuplicateStartEnd:i,uniformSize:this._uniformSize,attributeData:{position:t,mapPosition:r,size:o?null:this.getDrivenSize(e.renderingInfo),color:a?null:this.getDrivenColor(e.renderingInfo),sizeFeature:this.getSizeFeatureAttributeData(e.graphic),colorFeature:this.getColorFeatureAttributeData(e.graphic),opacityFeature:this.getOpacityFeatureAttributeData(e.graphic)}})}},{key:"_createAsOverlay",value:function(e,t){var r=e.graphic,i=this._getGeometryAsPolygonOrPolyline(r.geometry),a="polygon"===i.type?i.rings:i.paths,o="polygon"===i.type?this.ringMaterial:this.lineMaterial;o.renderPriority=this._renderPriority;var s=new Array,c=Object(P.h)(),l=Object(P.k)(),u=Object(Et.c)(i,this._context.overlaySR),d="polygon"===i.type?"rings":"paths";this._logGeometryCreationWarnings(u,a,d,"LineSymbol3DLayer");var h,f=Object(n.a)(u.lines);try{for(f.s();!(h=f.n()).done;){var p=h.value;if(Object(P.k)(c),Object(P.n)(c,p.position),Object(P.w)(c,this._context.clippingExtent)){Object(P.m)(l,c);var b=this._createGeometry(e,p.position,null,i.type),v=new yt.a(b,o,t,r.uid);Object(Se.l)(v.boundingSphere,.5*(c[0]+c[3]),.5*(c[1]+c[4]),0,.5*Math.sqrt((c[3]-c[0])*(c[3]-c[0])+(c[4]-c[1])*(c[4]-c[1]))),s.push(v)}}}catch(m){f.e(m)}finally{f.f()}return new Ve(this,s,l)}}]),r}(F.a);Ft.elevationModeChangeTypes={definedChanged:I.a.RECREATE,staysOnTheGround:I.a.NONE,onTheGroundChanged:I.a.RECREATE};var Lt=r(599),zt=r(478),Vt=r(378),Nt=r(202),Ut=r(424),Bt=r(150),Gt=r(362),qt=["mesh"],Ht=function(e){Object(u.a)(r,e);var t=Object(d.a)(r);function r(e,n,i,a){var o;return Object(c.a)(this,r),(o=t.call(this,e,n,i,a))._materials=new Map,o._textures=new Map,o.ensureDrapedStatus(!1),o}return Object(l.a)(r,[{key:"doLoad",value:function(){var e=Object(s.a)(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:$.a.DRAW_MESH_GEOMETRY_NORMALS&&(this._debugVertexNormalMaterial=new Gt.a({color:[1,0,1,1]}),this._debugFaceNormalMaterial=new Gt.a({color:[0,1,1,1]}));case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"destroy",value:function(){Object(g.a)(Object(O.a)(r.prototype),"destroy",this).call(this),this._context.stage.removeMany(Array.from(this._materials.values(),(function(e){return e.material}))),this._context.stage.removeMany(Array.from(this._textures.values())),this._materials.clear(),this._textures.clear()}},{key:"createGraphics3DGraphic",value:function(e){var t=e.graphic;if(!this._validateGeometry(t.geometry,qt,"fill on mesh-3d"))return null;var r=this.setGraphicElevationContext(t,new D.a),n=e.renderingInfo;return this._createAs3DShape(t,n,r,t.uid)}},{key:"layerOpacityChanged",value:function(e,t){var r=this,n=this._getLayerOpacity();return this._materials.forEach((function(e){e.material.setParameterValues({layerOpacity:n});var t=e.material.params;r._setMaterialTransparentParameter(t,e),e.material.setParameterValues({transparent:t.transparent})})),e.forEach((function(e){var i=t(e);Object(f.j)(i)&&i.layerOpacityChanged(n,r._context.isAsync)})),!0}},{key:"layerElevationInfoChanged",value:function(e,t){return this.updateGraphics3DGraphicElevationInfo(e,t,I.g)}},{key:"slicePlaneEnabledChanged",value:function(e,t){var r=this;return this._materials.forEach((function(e){e.material.setParameterValues({slicePlaneEnabled:r._context.slicePlaneEnabled})})),e.forEach((function(e){var n=t(e);Object(f.j)(n)&&n.slicePlaneEnabledChanged(r._context.slicePlaneEnabled,r._context.isAsync)})),!0}},{key:"physicalBasedRenderingChanged",value:function(){var e=this._usePBR();return this._materials.forEach((function(t){return t.material.setParameterValues({usePBR:e})})),!0}},{key:"pixelRatioChanged",value:function(){return!0}},{key:"_requiresSymbolVertexColors",value:function(){return this._drivenProperties.color||this._drivenProperties.opacity}},{key:"_colorOrTextureUid",value:function(e){return Object(f.i)(e)?"-":e instanceof je.a?e.toHex():e.contentHash}},{key:"_materialPropertiesDefault",value:function(e,t){var r=this._requiresSymbolVertexColors(),n=!!e.vertexAttributes.color,i=!!e.vertexAttributes.tangent;return{hasSymbolVertexColors:r,hasVertexColors:n,hasVertexTangents:i,uid:"vc:".concat(n,",vt:").concat(i,",vct").concat(t,",svc:").concat(r)}}},{key:"_materialProperties",value:function(e,t,r){var n=this._materialPropertiesDefault(e,r);if(!t.material)return n;var i=t.material,a=i.color,o=i.colorTexture,s=i.normalTexture,c=i.doubleSided,l=i.alphaCutoff,u=i.alphaMode,d=this._colorOrTextureUid(a),h=this._colorOrTextureUid(o),f=this._colorOrTextureUid(s);if(n.color=a,n.colorTexture=o,n.normalTexture=s,n.uid="".concat(n.uid,",cmuid:").concat(d,",ctmuid:").concat(h,",ntmuid:").concat(f,",ds:").concat(c,",ac:").concat(l,",am:").concat(u),t.material instanceof zt.a){var p=t.material,b=p.metallic,v=p.roughness,m=p.metallicRoughnessTexture,y=p.emissiveColor,g=p.emissiveTexture,O=p.occlusionTexture,j=this._colorOrTextureUid(m),_=this._colorOrTextureUid(y),w=this._colorOrTextureUid(g),x=this._colorOrTextureUid(O);n.metallic=b,n.roughness=v,n.metallicRoughnessTexture=m,n.emissiveColor=y,n.emissiveTexture=g,n.occlusionTexture=O,n.uid="".concat(n.uid,",mrm:").concat(b,",mrr:").concat(v,",mrt:").concat(j,",emuid:").concat(_,",etmuid:").concat(w,",otmuid:").concat(x)}return n}},{key:"_setInternalColorValueParameters",value:function(e,t){t.diffuse=je.a.toUnitRGB(e),t.opacity=e.a}},{key:"_getLoadableTextureResource",value:function(e){return e.data?e.data:e.url}},{key:"_getInternalTextureId",value:function(e){var t=this._getLoadableTextureResource(e);if(t){var r=e.contentHash,n=this._textures.get(r);return n||(n=new gt.a(t,{mipmap:!0,wrap:this._castTextureWrap(e.wrap),noUnpackFlip:!0,preMultiplyAlpha:!0}),this._textures.set(r,n),this._context.stage.add(n)),n.id}}},{key:"_castTextureWrap",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"repeat";if("string"==typeof e){var t=this._castTextureWrapIndividual(e);return{s:t,t:t}}return{s:this._castTextureWrapIndividual(e.horizontal),t:this._castTextureWrapIndividual(e.vertical)}}},{key:"_castTextureWrapIndividual",value:function(e){switch(e){case"clamp":return 33071;case"mirror":return 33648;case"repeat":default:return 10497}}},{key:"_setInternalMaterialParameters",value:function(e,t){Object(f.j)(e.color)&&this._setInternalColorValueParameters(e.color,t),Object(f.j)(e.colorTexture)&&(t.textureId=this._getInternalTextureId(e.colorTexture)),Object(f.j)(e.normalTexture)&&(t.normalTextureId=this._getInternalTextureId(e.normalTexture)),Object(f.j)(e.emissiveColor)&&(t.emissiveFactor=je.a.toUnitRGB(e.emissiveColor)),Object(f.j)(e.emissiveTexture)&&(t.emissiveTextureId=this._getInternalTextureId(e.emissiveTexture)),Object(f.j)(e.occlusionTexture)&&(t.occlusionTextureId=this._getInternalTextureId(e.occlusionTexture)),Object(f.j)(e.metallicRoughnessTexture)&&(t.metallicRoughnessTextureId=this._getInternalTextureId(e.metallicRoughnessTexture))}},{key:"_setExternalMaterialParameters",value:function(e){var t=this._drivenProperties.color,r=Object(f.j)(this.symbolLayer.material)?this.symbolLayer.material.colorMixMode:null;if(t)e.externalColor=Te.a;else{var n=Object(f.j)(this.symbolLayer.material)?this.symbolLayer.material.color:null;Object(f.j)(n)?e.externalColor=je.a.toUnitRGBA(n):(r=null,e.externalColor=Te.a)}r&&(e.colorMixMode=r),e.castShadows=!!this.symbolLayer.castShadows}},{key:"_hasTransparentVertexColors",value:function(e){var t=e.vertexAttributes.color;if(Object(f.i)(t))return!1;for(var r=3;r<t.length;r+=4)if(255!==t[r])return!0;return!1}},{key:"_getOrCreateMaterial",value:function(e,t){var r=t.material&&t.material.color,n=t.material&&t.material.colorTexture,i=t.material&&"blend"===t.material.alphaMode,a=!(t.material&&"opaque"===t.material.alphaMode)&&(this._hasTransparentVertexColors(e)||Object(f.j)(r)&&r.a<1||Object(f.j)(n)&&n.transparent||i),o=this._materialProperties(e,t,a),s=this._materials.get(o.uid);if(s)return s.material;var c={material:null,isComponentTransparent:a,alphaMode:t.material?t.material.alphaMode:"opaque"},l=null==o.metallicRoughnessTexture&&null==o.metallic&&null==o.roughness,u={usePBR:this._usePBR(),isSchematic:l,vertexColors:o.hasVertexColors,symbolColors:o.hasSymbolVertexColors,vertexTangents:o.hasVertexTangents,ambient:C.b,diffuse:C.a,opacity:1,doubleSided:!0,doubleSidedType:"winding-order",cullFace:0,textureAlphaPremultiplied:!0,layerOpacity:this._getLayerOpacity(),slicePlaneEnabled:this._context.slicePlaneEnabled,initTextureTransparent:!0};l||(u.mrrFactors=[null!=o.metallic?o.metallic:1,null!=o.roughness?o.roughness:1,.5]),t.material&&(u.doubleSided=t.material.doubleSided,u.cullFace=t.material.doubleSided?0:2,u.textureAlphaCutoff=t.material.alphaCutoff),this._setInternalMaterialParameters(o,u),this._setExternalMaterialParameters(u),this._setMaterialTransparentParameter(u,c);var d=new ee.a(u);return c.material=d,this._materials.set(o.uid,c),this._context.stage.add(d),d}},{key:"_usePBR",value:function(){return this._context.physicalBasedRenderingEnabled}},{key:"_setMaterialTransparentParameter",value:function(e,t){e.transparent=this.needsDrivenTransparentPass||t.isComponentTransparent||e.layerOpacity<1||e.opacity<1||e.externalColor&&e.externalColor[3]<1,"auto"===t.alphaMode?e.textureAlphaMode=e.transparent?3:1:e.textureAlphaMode="opaque"===t.alphaMode?1:"mask"===t.alphaMode?2:0}},{key:"_addDebugNormals",value:function(e,t,r,n){for(var i=t.length,a=e.spatialReference.isGeographic?20015077/180:1,o=.1*Math.max(e.extent.width*a,e.extent.height*a,e.extent.zmax-e.extent.zmin),s=[],c=[],l=[],u=[],d=0;d<i;d++)for(var h=t[d],f=h.vertexAttributes.get("position"),p=h.vertexAttributes.get("normal"),b=h.indices.get("position"),v=h.indices.get("normal"),m=f.data,y=p.data,g=0;g<b.length;g++){for(var O=3*b[g],j=3*v[g],_=0;_<3;_++)s.push(m[O+_]);for(var w=0;w<3;w++)s.push(m[O+w]+y[j+w]*o);if(c.push(c.length),c.push(c.length),g%3==0){this._calculateFaceNormal(m,b,g,Yt),this._getFaceVertices(m,b,g,Qt,Zt,Xt),Object(T.h)(Qt,Qt,Zt),Object(T.h)(Qt,Qt,Xt),Object(T.g)(Qt,Qt,1/3);for(var x=0;x<3;x++)l.push(Qt[x]);for(var k=0;k<3;k++)l.push(Qt[k]+Yt[k]*o);u.push(u.length),u.push(u.length)}}var C=new N.a([["position",{data:s,size:3,exclusive:!0}]],[["position",new Uint32Array(c)]],2);t.push(C),r.push(this._debugVertexNormalMaterial),n.push(Object(S.c)(n[0]));var M=new N.a([["position",{data:l,size:3,exclusive:!0}]],[["position",new Uint32Array(u)]],2);t.push(M),r.push(this._debugFaceNormalMaterial),n.push(Object(S.c)(n[0]))}},{key:"_createAs3DShape",value:function(e,t,r,n){var i=e.geometry;if("mesh"!==i.type)return null;var a=this._createGeometryInfo(i,t);if(!a)return null;var o=a.geometries,s=a.materials,c=a.transformations,l=a.objectTransformation;$.a.DRAW_MESH_GEOMETRY_NORMALS&&this._addDebugNormals(i,o,s,c);var u=new K.a({geometries:o,materials:s,transformations:c,metadata:{layerUid:this._context.layer.uid,graphicUid:n}});u.transformation=l;var d=Re.b,h=this._createEdgeMaterial(),p=Object(f.j)(h)?{baseMaterial:s[0],edgeMaterials:[h],properties:{mergeGeometries:!0,slicePlaneEnabled:this._context.slicePlaneEnabled}}:null,b=new v.a(this,u,o,null,null,d,r,p);return b.needsElevationUpdates=Object(I.g)(r.mode),b.useObjectOriginAsAttachmentOrigin=!0,b.elevationContext.centerPointInElevationSR=this.getCenterPointInElevationSR(u),b.alignedSampledElevation=d(b,b.elevationContext,this._context.elevationProvider,this._context.renderCoordsHelper),b}},{key:"getCenterPointInElevationSR",value:function(e){var t=Object(Nt.j)(0,0,0,this._context.elevationProvider.spatialReference);return Object(M.x)([e.transformation[12],e.transformation[13],e.transformation[14]],this._context.renderCoordsHelper.spatialReference,t),t}},{key:"_createComponentNormals",value:function(e,t,r,n){switch(r.shading||"flat"){case"source":return this._createComponentNormalsSource(e,t,r,n);case"flat":return this._createComponentNormalsFlat(e,n);case"smooth":return this._createComponentNormalsSmooth(e,n);default:return}}},{key:"_createComponentNormalsSource",value:function(e,t,r,n){if(Object(f.i)(t))return this._createComponentNormalsFlat(e,n);var i=!1;if(!r.trustSourceNormals)for(var a=0;a<n.length;a+=3){this._calculateFaceNormal(e,n,a,Yt);for(var o=0;o<3;o++){var s=3*n[a+o];Qt[0]=t[s+0],Qt[1]=t[s+1],Qt[2]=t[s+2],Object(T.j)(Yt,Qt)<0&&(t[s+0]=-t[s+0],t[s+1]=-t[s+1],t[s+2]=-t[s+2],i=!0)}}return{normals:t,indices:n,didFlipNormals:i}}},{key:"_createComponentNormalsFlat",value:function(e,t){for(var r=new Float32Array(t.length),n=new Uint32Array(3*t.length),i=0;i<t.length;i+=3)for(var a=this._calculateFaceNormal(e,t,i,Yt),o=0;o<3;o++)r[i+o]=a[o],n[i+o]=i/3;return{normals:r,indices:n,didFlipNormals:!1}}},{key:"_createComponentNormalsSmooth",value:function(e,t){for(var r={},n=0;n<t.length;n+=3)for(var i=this._calculateFaceNormal(e,t,n,Yt),a=0;a<3;a++){var o=t[n+a],s=r[o];s||(s={normal:Object(C.e)(),count:0},r[o]=s),Object(T.h)(s.normal,s.normal,i),s.count++}for(var c=new Float32Array(3*t.length),l=new Uint32Array(3*t.length),u=0;u<t.length;u++){var d=r[t[u]];1!==d.count&&(Object(T.t)(d.normal,d.normal),d.count=1);for(var h=0;h<3;h++)c[3*u+h]=d.normal[h];l[u]=u}return{normals:c,indices:l,didFlipNormals:!1}}},{key:"_getFaceVertices",value:function(e,t,r,n,i,a){var o=3*t[r+0],s=3*t[r+1],c=3*t[r+2];n[0]=e[o+0],n[1]=e[o+1],n[2]=e[o+2],i[0]=e[s+0],i[1]=e[s+1],i[2]=e[s+2],a[0]=e[c+0],a[1]=e[c+1],a[2]=e[c+2]}},{key:"_calculateFaceNormal",value:function(e,t,r,n){return this._getFaceVertices(e,t,r,Qt,Zt,Xt),Object(T.l)(Zt,Zt,Qt),Object(T.l)(Xt,Xt,Qt),Object(T.i)(Qt,Zt,Xt),Object(T.t)(n,Qt),n}},{key:"_getOrCreateComponents",value:function(e){return e.components?e.components:er}},{key:"_createPositionBuffer",value:function(e,t){var r=e.vertexAttributes.position,n=1===t.reprojection?t.transformBeforeProject:null;if(Object(f.j)(n)&&(r=Object(Vt.h)(r,new Float64Array(r.length),n)),0===t.reprojection)return t.needsBufferCopy?new Float64Array(r):r;var i=Object(f.j)(n)?r:new Float64Array(r.length);return Object(M.q)(r,e.spatialReference,0,i,this._context.renderCoordsHelper.spatialReference,0,r.length/3),i}},{key:"_createNormalBuffer",value:function(e,t,r){var n=e.vertexAttributes.normal;if(Object(f.i)(n))return null;var i=1===r.reprojection?r.transformBeforeProject:null;if(Object(f.j)(i)&&(n=Object(Vt.g)(n,new Float32Array(n.length),i)),"local"===this._context.layerView.view.viewingMode||0===r.reprojection)return r.needsBufferCopy&&e.vertexAttributes.normal===n?new Float32Array(n):n;var a=e.vertexAttributes.position,o=Object(f.j)(i)?n:new Float32Array(n.length);return Object(Vt.c)(n,a,t,e.spatialReference,o)}},{key:"_createTangentBuffer",value:function(e,t,r){var n=e.vertexAttributes.tangent;if(Object(f.i)(n))return null;var i=1===r.reprojection?r.transformBeforeProject:null;if(Object(f.j)(i)&&(n=Object(Vt.i)(n,new Float32Array(n.length),i)),"local"===this._context.layerView.view.viewingMode||0===r.reprojection)return r.needsBufferCopy&&e.vertexAttributes.normal===n?new Float32Array(n):n;var a=e.vertexAttributes.position,o=Object(f.j)(i)?n:new Float32Array(n.length);return Object(Vt.e)(n,a,t,e.spatialReference,o)}},{key:"_createColorBuffer",value:function(e){return e.vertexAttributes.color}},{key:"_createSymbolColorBuffer",value:function(e){if(this._requiresSymbolVertexColors()){var t=this._getVertexOpacityAndColor(e),r=Object(Ut.b)(Object(f.h)(this.symbolLayer,"material","colorMixMode")),n=new Uint8Array(4);return Object(Ut.a)(t,r,n),n}return null}},{key:"_createBuffers",value:function(e,t){var r=e.vertexAttributes&&e.vertexAttributes.position;if(!r)return this.logger.warn("Mesh geometry must contain position vertex attributes"),null;var n=e.vertexAttributes.normal,i=e.vertexAttributes.uv,a=e.vertexAttributes.tangent;if(Object(f.j)(n)&&n.length!==r.length)return this.logger.warn("Mesh normal vertex buffer must contain the same number of elements as the position buffer"),null;if(Object(f.j)(a)&&a.length/4!=r.length/3)return this.logger.warn("Mesh tangent vertex buffer must contain the same number of elements as the position buffer"),null;if(Object(f.j)(i)&&i.length/2!=r.length/3)return this.logger.warn("Mesh uv vertex buffer must contain the same number of elements as the position buffer"),null;var o=this._computeReprojectionInfo(e),s=this._createPositionBuffer(e,o),c=this._createColorBuffer(e),l=this._createSymbolColorBuffer(t),u=this._createNormalBuffer(e,s,o),d=this._createTangentBuffer(e,s,o);return{positionBuffer:s,normalBuffer:u,tangentBuffer:d,uvBuffer:i,colorBuffer:c,symbolColorBuffer:l,objectTransformation:0===o.reprojection&&Object(f.j)(o.objectTransformation)?o.objectTransformation:this._transformOriginLocal(e,s,u,d),geometryTransformation:0===o.reprojection&&Object(f.j)(o.geometryTransformation)?o.geometryTransformation:Object(S.d)()}}},{key:"_computeReprojectionInfo",value:function(e){var t=Object(f.j)(e.transform)&&e.transform.geographic||2===this._context.renderCoordsHelper.viewingMode?0:1,r=null;if(Object(f.j)(e.transform)){if(0===t){var n=Object(S.d)();return Object(M.d)(e.spatialReference,e.transform.origin,n,this._context.renderCoordsHelper.spatialReference),{reprojection:t,objectTransformation:n,geometryTransformation:Object(S.c)(e.transform.localMatrix),needsBufferCopy:!1}}return r=Object(k.q)(Object(S.d)(),e.transform.origin),Object(k.m)(r,r,e.transform.localMatrix),{reprojection:t,transformBeforeProject:r,needsBufferCopy:!0}}return{reprojection:t,needsBufferCopy:!0}}},{key:"_transformOriginLocal",value:function(e,t,r,n){var i=this._context.renderCoordsHelper.spatialReference,a=e.anchor;Wt[0]=a.x,Wt[1]=a.y,Wt[2]=a.z;var o=Object(S.d)();Object(M.d)(e.spatialReference,Wt,o,i);var s=A.v.fromTypedArray(t);if(Object(k.a)($t,o),Object(E.e)(s,s,$t),Object(f.j)(r)||Object(f.j)(n)){if(Object(w.f)(Jt,o),Object(w.n)(Jt,Jt),Object(f.j)(r)){var c=A.u.fromTypedArray(r);Object(E.a)(c,c,Jt)}if(Object(f.j)(n)){var l=A.u.fromTypedArray(n,4*n.BYTES_PER_ELEMENT);Object(E.a)(l,l,Jt)}}return o}},{key:"_validateFaces",value:function(e,t){var r=e.vertexAttributes.position.length/3,n=t.faces;if(n){for(var i=-1,a=0;a<n.length;a++){var o=n[a];o>i&&(i=o)}if(r<=i)return this.logger.warn("Vertex index ".concat(i," is out of bounds of the mesh position buffer")),!1}else if(r%3!=0)return this.logger.warn("Mesh position buffer length must be a multiple of 9 if no component faces are defined (3 values per vertex * 3 vertices per triangle)"),!1;return!0}},{key:"_getOrCreateFaces",value:function(e,t){return t.faces?t.faces:Object(Bt.d)(e.vertexAttributes.position.length/3)}},{key:"_isOutsideClippingArea",value:function(e){if(!this._context.clippingExtent)return!1;var t=e.vertexAttributes&&e.vertexAttributes.position;if(!t)return!1;var r,n=this._context.elevationProvider.spatialReference,i=t.length/3;return e.spatialReference.equals(n)?r=t:(r=new Float64Array(t.length),Object(M.q)(e.vertexAttributes.position,e.spatialReference,0,r,n,0,i)),Object(P.k)(Kt),Object(P.n)(Kt,r,0,i),!Object(P.w)(Kt,this._context.clippingExtent)}},{key:"_createGeometryInfo",value:function(e,t){if(!Object(M.b)(e.spatialReference,this._context.layerView.view.spatialReference))return this.logger.warn("Geometry spatial reference is not compatible with the view"),null;if(this._isOutsideClippingArea(e))return null;var r=this._createBuffers(e,t);if(Object(f.i)(r))return null;var i,a=r.positionBuffer,o=r.uvBuffer,s=r.colorBuffer,c=r.symbolColorBuffer,l=r.normalBuffer,u=r.tangentBuffer,d=r.objectTransformation,h=r.geometryTransformation,p=this._getOrCreateComponents(e),b=[],v=[],m=[],y=!1,g=Object(n.a)(p);try{for(g.s();!(i=g.n()).done;){var O=i.value;if(!this._validateFaces(e,O))return null;var j=this._getOrCreateFaces(e,O);if(0!==j.length){var _=this._createComponentNormals(a,l,O,j);_.didFlipNormals&&(y=!0);var w=[["position",{size:3,data:a,exclusive:!0}],["normal",{size:3,data:_.normals,exclusive:!0}]],x=[["position",j],["normal",_.indices]];Object(f.j)(s)&&(w.push(["color",{size:4,data:s,exclusive:!0}]),x.push(["color",j])),Object(f.j)(c)&&(w.push(["symbolColor",{size:4,data:c,exclusive:!0}]),x.push(["symbolColor",new Uint16Array(j.length)])),Object(f.j)(o)&&(w.push(["uv0",{size:2,data:o,exclusive:!0}]),x.push(["uv0",j])),Object(f.j)(u)&&(w.push(["tangent",{size:4,data:u,exclusive:!0}]),x.push(["tangent",j]));var k=new N.a(w,x);b.push(k),v.push(h),m.push(this._getOrCreateMaterial(e,O))}}}catch(S){g.e(S)}finally{g.f()}return y&&this.logger.warn("Normals have been automatically flipped to be consistent with the counter clock wise face winding order. It is better to generate mesh geometries that have consistent normals."),{geometries:b,transformations:v,materials:m,objectTransformation:d}}},{key:"_createEdgeMaterial",value:function(){var e={opacity:this._getLayerOpacity()};return Object(Y.a)(this.symbolLayer,e)}}]),r}(F.a),Wt=Object(C.e)(),Qt=Object(C.e)(),Zt=Object(C.e)(),Xt=Object(C.e)(),Yt=Object(C.e)(),$t=Object(S.d)(),Jt=Object(x.b)(),Kt=Object(P.h)(),er=[new Lt.a],tr=r(33),rr=r(387),nr=r(443),ir=r(233),ar=r(354),or=function(){function e(t,r,n,i){Object(c.a)(this,e),this.graphics3DSymbolLayer=t,this.instanceIndex=r,this.elevationAligner=n,this.elevationContext=i,this.type="lod-instance",this.alignedSampledElevation=0,this.isElevationSource=!1,this.needsElevationUpdates=!1}return Object(l.a)(e,[{key:"initialize",value:function(){}},{key:"setVisibility",value:function(e){var t=this.lodRenderer.instanceData;e!==t.getVisible(this.instanceIndex)&&t.setVisible(this.instanceIndex,e)}},{key:"destroy",value:function(){null!=this.instanceIndex&&(this.lodRenderer.instanceData.removeInstance(this.instanceIndex),this.graphics3DSymbolLayer.notifyDestroyGraphicLayer(this))}},{key:"alignWithElevation",value:function(e,t,r){if(this.elevationAligner){Object(ir.g)(this.elevationContext.featureExpressionInfoContext,r);var n=this.elevationAligner(this,this.elevationContext,e,t);null!=n&&(this.alignedSampledElevation=n)}}},{key:"getCenterObjectSpace",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Object(C.e)();return this.lodRenderer.instanceData.getCombinedLocalTransform(this.instanceIndex,dr),Object(T.s)(e,this.lodRenderer.baseBoundingSphere.center,dr)}},{key:"getBoundingBoxObjectSpace",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Object(P.h)();this.lodRenderer.instanceData.getCombinedLocalTransform(this.instanceIndex,dr);var t=this.lodRenderer.baseBoundingBox;Object(P.k)(e);for(var r=0;r<8;++r)Object(T.y)(cr,0==(1&r)?t[0]:t[3],0==(2&r)?t[1]:t[4],0==(4&r)?t[2]:t[5]),Object(T.s)(cr,cr,dr),Object(P.r)(e,cr);return e}},{key:"computeAttachmentOrigin",value:function(e){this.lodRenderer.instanceData.getGlobalTransform(this.instanceIndex,dr),e.render.origin[0]+=dr[12],e.render.origin[1]+=dr[13],e.render.origin[2]+=dr[14],e.render.num++}},{key:"getProjectedBoundingBox",value:function(){var e=Object(s.a)(o.a.mark((function e(t,r,n,i,a){var s,c,l,u,d,h,p,b,v,m;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(s=this.getBoundingBoxObjectSpace(a),c=ur,l=Object(P.x)(s)?1:c.length,this.lodRenderer.instanceData.getGlobalTransform(this.instanceIndex,dr),u=0;u<l;u++)d=c[u],cr[0]=s[d[0]],cr[1]=s[d[1]],cr[2]=s[d[2]],Object(T.s)(cr,cr,dr),sr[3*u+0]=cr[0],sr[3*u+1]=cr[1],sr[3*u+2]=cr[2];if(t(sr,0,l)){e.next=5;break}return e.abrupt("return",null);case 5:for(Object(P.k)(s),h=null,this.calculateRelativeScreenBounds&&(h=this.calculateRelativeScreenBounds()),p=0;p<3*l;p+=3){for(b=0;b<3;b++)s[b]=Math.min(s[b],sr[p+b]),s[b+3]=Math.max(s[b+3],sr[p+b]);h&&n.push({location:sr.slice(p,p+3),screenSpaceBoundingRect:h})}if(!r||(Object(P.e)(s,lr),"absolute-height"===this.elevationContext.mode)){e.next=20;break}return m=Object(L.d)(s,r),e.prev=11,e.next=14,r.service.queryElevation(lr[0],lr[1],i,m,"ground");case 14:v=e.sent,e.next=19;break;case 17:e.prev=17,e.t0=e.catch(11);case 19:Object(f.j)(v)&&Object(P.z)(s,0,0,-this.alignedSampledElevation+v);case 20:return e.abrupt("return",s);case 21:case"end":return e.stop()}}),e,this,[[11,17]])})));return function(t,r,n,i,a){return e.apply(this,arguments)}}()},{key:"addObjectState",value:function(e,t){var r=this;if(0===e){var n=new ar.a(e);this.addHighlightId(n),t.addExternal((function(e){r.removeHighlightId(e)}),n)}}},{key:"removeObjectState",value:function(e){this.highlights&&this.highlights.forEach((function(t){return e.remove(t)}))}},{key:"addHighlightId",value:function(e){this.highlights=this.highlights||new Set,this.highlights.add(e),this.lodRenderer.instanceData.setHighlight(this.instanceIndex,!0)}},{key:"removeHighlightId",value:function(e){this.highlights&&(this.highlights.delete(e),this.lodRenderer.instanceData.setHighlight(this.instanceIndex,this.highlights.size>0),0===this.highlights.size&&(this.highlights=null))}},{key:"lodRenderer",get:function(){return this.graphics3DSymbolLayer.lodRenderer}}]),e}(),sr=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],cr=Object(C.e)(),lr=Object(C.e)(),ur=[[0,1,2],[3,1,2],[0,4,2],[3,4,2],[0,1,5],[3,1,5],[0,4,5],[3,4,5]],dr=Object(S.d)(),hr=or,fr=r(252);function pr(e){return{levels:e.map((function(e){return function(e){var t=[];return e.stageResources.geometries.forEach((function(r,n){var i=e.stageResources.materials[n],a=e.stageResources.textures;t.push({material:i,geometry:r,textures:a})})),{components:t,minScreenSpaceRadius:e.lodThreshold,pivotOffset:e.pivotOffset}}(e)}))}}function br(e){e.levels.forEach((function(e){e.minScreenSpaceRadius||(e.minScreenSpaceRadius=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:yr,r=Object(fr.a)(e);return Math.sqrt(r/(t*Math.PI))}(e))}))}var vr,mr,yr=.05,gr=r(655),Or=r(438),jr=r(285),_r=r(142),wr=r(109),xr=r(86),kr=r(77),Sr=r(82),Tr=r(85),Cr=r(108);(mr=vr||(vr={}))[mr.ALLOCATED=1]="ALLOCATED",mr[mr.DEFAULT_ACTIVE=2]="DEFAULT_ACTIVE",mr[mr.VISIBLE=4]="VISIBLE",mr[mr.HIGHLIGHT=8]="HIGHLIGHT",mr[mr.HIGHLIGHT_ACTIVE=16]="HIGHLIGHT_ACTIVE",mr[mr.REMOVE=32]="REMOVE",mr[mr.TRANSFORM_CHANGED=64]="TRANSFORM_CHANGED",mr[mr.ACTIVE=18]="ACTIVE";var Mr=function e(t){Object(c.a)(this,e),this.localTransform=t.getField("localTransform",A.i),this.globalTransform=t.getField("globalTransform",A.i),this.modelOrigin=t.getField("modelOrigin",A.v),this.model=t.getField("model",A.f),this.modelNormal=t.getField("modelNormal",A.f),this.modelScaleFactors=t.getField("modelScaleFactors",A.m),this.boundingSphere=t.getField("boundingSphere",A.D),this.color=t.getField("color",A.C),this.featureAttribute=t.getField("featureAttribute",A.C),this.state=t.getField("state",A.l),this.lodLevel=t.getField("lodLevel",A.l)},Pr=function(e){Object(u.a)(r,e);var t=Object(d.a)(r);function r(e,n){var i;return Object(c.a)(this,r),(i=t.call(this))._capacity=0,i._size=0,i._next=0,i._layout=function(e){var t=Object(Cr.a)().mat4f64("localTransform").mat4f64("globalTransform").vec4f64("boundingSphere").vec3f64("modelOrigin").mat3f("model").mat3f("modelNormal").vec2f("modelScaleFactors");return e.indexOf("color")>=0&&(t=t.vec4f("color")),e.indexOf("featureAttribute")>=0&&(t=t.vec4f("featureAttribute")),t.u8("state").u8("lodLevel").alignTo(8)}(e),i._shaderTransformation=n,i}return Object(l.a)(r,[{key:"capacity",get:function(){return this._capacity}},{key:"size",get:function(){return this._size}},{key:"buffer",get:function(){return this._buffer.buffer}},{key:"view",get:function(){return this._view}},{key:"addInstance",value:function(){this._size+1>this._capacity&&this.grow();var e=this.findSlot();return this._view.state.set(e,vr.ALLOCATED),this._size++,this.emit("instance-added",{index:e}),e}},{key:"removeInstance",value:function(e){var t=this._view.state;Object(Ue.a)(e>=0&&e<this._capacity&&t.get(e)&vr.ALLOCATED,"invalid instance handle"),this.getStateFlag(e,vr.ACTIVE)?this.setStateFlags(e,vr.REMOVE):this.freeInstance(e),this.emit("instance-removed",{index:e})}},{key:"freeInstance",value:function(e){var t=this._view.state;Object(Ue.a)(e>=0&&e<this._capacity&&t.get(e)&vr.ALLOCATED,"invalid instance handle"),t.set(e,0),this._size--}},{key:"setLocalTransform",value:function(e,t){var r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];this._view.localTransform.setMat(e,t),r&&this.updateModelTransform(e)}},{key:"getLocalTransform",value:function(e,t){this._view.localTransform.getMat(e,t)}},{key:"setGlobalTransform",value:function(e,t){var r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];this._view.globalTransform.setMat(e,t),r&&this.updateModelTransform(e)}},{key:"getGlobalTransform",value:function(e,t){this._view.globalTransform.getMat(e,t)}},{key:"updateModelTransform",value:function(e){var t=this._view,r=Rr,n=Ir;t.localTransform.getMat(e,Dr),t.globalTransform.getMat(e,Fr);var i=Object(k.m)(Fr,Fr,Dr);Object(T.y)(r,i[12],i[13],i[14]),t.modelOrigin.setVec(e,r),Object(w.f)(n,i),t.model.setMat(e,n);var a=Object(Tr.k)(Rr,i);a.sort(),t.modelScaleFactors.set(e,0,a[1]),t.modelScaleFactors.set(e,1,a[2]),Object(w.e)(n,n),Object(w.n)(n,n),t.modelNormal.setMat(e,n),this.setStateFlags(e,vr.TRANSFORM_CHANGED),this.emit("instance-transform-changed",{index:e})}},{key:"getModelTransform",value:function(e,t){var r=this._view;r.model.getMat(e,Ir),r.modelOrigin.getVec(e,Rr),t[0]=Ir[0],t[1]=Ir[1],t[2]=Ir[2],t[3]=0,t[4]=Ir[3],t[5]=Ir[4],t[6]=Ir[5],t[7]=0,t[8]=Ir[6],t[9]=Ir[7],t[10]=Ir[8],t[11]=0,t[12]=Rr[0],t[13]=Rr[1],t[14]=Rr[2],t[15]=1}},{key:"applyShaderTransformation",value:function(e,t){this._shaderTransformation&&this._shaderTransformation.applyTransform(this,e,t)}},{key:"getCombinedModelTransform",value:function(e,t){return this.getModelTransform(e,t),this._shaderTransformation&&this._shaderTransformation.applyTransform(this,e,t),t}},{key:"getCombinedLocalTransform",value:function(e,t){return this._view.localTransform.getMat(e,t),this._shaderTransformation&&this._shaderTransformation.applyTransform(this,e,t),t}},{key:"getCombinedMaxScaleFactor",value:function(e){var t=this._view.modelScaleFactors.get(e,1);if(this._shaderTransformation){var r=this._shaderTransformation.scaleFactor(Rr,this,e);t*=Math.max(r[0],r[1],r[2])}return t}},{key:"getCombinedMedianScaleFactor",value:function(e){var t=this._view.modelScaleFactors.get(e,0);if(this._shaderTransformation){var r=this._shaderTransformation.scaleFactor(Rr,this,e);r.sort(),t*=r[1]}return t}},{key:"getModel",value:function(e,t){this._view.model.getMat(e,t)}},{key:"setFeatureAttribute",value:function(e,t){this._view.featureAttribute.setVec(e,t)}},{key:"getFeatureAttribute",value:function(e,t){this._view.featureAttribute.getVec(e,t)}},{key:"setColor",value:function(e,t){this._view.color.setVec(e,t)}},{key:"getColor",value:function(e,t){this._view.color.getVec(e,t)}},{key:"setVisible",value:function(e,t){t!==this.getVisible(e)&&(this.setStateFlag(e,vr.VISIBLE,t),this.emit("instance-visibility-changed",{index:e}))}},{key:"getVisible",value:function(e){return this.getStateFlag(e,vr.VISIBLE)}},{key:"setHighlight",value:function(e,t){t!==this.getHighlight(e)&&(this.setStateFlag(e,vr.HIGHLIGHT,t),this.emit("instance-highlight-changed",{index:e}))}},{key:"getHighlight",value:function(e){return this.getStateFlag(e,vr.HIGHLIGHT)}},{key:"getState",value:function(e){return this._view.state.get(e)}},{key:"getLodLevel",value:function(e){return this._view.lodLevel.get(e)}},{key:"countFlags",value:function(e){for(var t=0,r=0;r<this._capacity;++r)this.getState(r)&e&&++t;return t}},{key:"setStateFlags",value:function(e,t){var r=this._view.state;t=r.get(e)|t,r.set(e,t)}},{key:"clearStateFlags",value:function(e,t){var r=this._view.state;t=r.get(e)&~t,r.set(e,t)}},{key:"setStateFlag",value:function(e,t,r){r?this.setStateFlags(e,t):this.clearStateFlags(e,t)}},{key:"getStateFlag",value:function(e,t){return!!(this._view.state.get(e)&t)}},{key:"grow",value:function(){var e=Math.max(Ar,Math.floor(this._capacity*Er)),t=this._layout.createBuffer(e);if(this._buffer){var r=new Uint8Array(this._buffer.buffer);new Uint8Array(t.buffer).set(r)}this._capacity=e,this._buffer=t,this._view=new Mr(this._buffer)}},{key:"findSlot",value:function(){for(var e=this._view.state,t=this._next;e.get(t)&vr.ALLOCATED;)t=(t+1)%this._capacity;return this._next=(t+1)%this._capacity,t}}]),r}(Sr.a),Ar=1024,Er=2,Rr=Object(C.e)(),Ir=Object(x.b)(),Dr=Object(S.d)(),Fr=Object(S.d)(),Lr=r(70),zr=function(e){Object(u.a)(r,e);var t=Object(d.a)(r);function r(e,n){var i;return Object(c.a)(this,r),(i=t.call(this,(function(e){return Object(Lr.m)(i._instanceData.view.boundingSphere.getVec(e,i._tmpSphere))}),{maximumDepth:25}))._tmpSphere=Object(Lr.c)(),i._tmpMat4=Object(S.d)(),i._instanceData=e,i._boundingSphere=n,i}return Object(l.a)(r,[{key:"addInstance",value:function(e){var t=this._instanceData.view.boundingSphere,r=this._instanceData.getCombinedModelTransform(e,this._tmpMat4);Object(T.s)(this._tmpSphere,this._boundingSphere.center,r),this._tmpSphere[3]=this._boundingSphere.radius*Object(Tr.i)(r),t.setVec(e,this._tmpSphere),this.add([e])}},{key:"removeInstance",value:function(e){this.remove([e])}}]),r}(r(524).a),Vr=function(){function e(t,r){Object(c.a)(this,e),this.thresholdScale=1,this._camera=new xr.a,this._worldSpaceRadius=t,this._thresholds=r.map((function(e){return e}))}return Object(l.a)(e,[{key:"updateCamera",value:function(e){this._camera.copyFrom(e)}},{key:"selectLevel",value:function(e,t){for(var r=this._camera.computeScreenPixelSizeAt(e),n=this._worldSpaceRadius*t/r,i=this._thresholds,a=-1,o=0;o<i.length;++o)n>=i[o]*this.thresholdScale&&(a=o);return a}}]),e}(),Nr=r(243),Ur=r(136),Br=r(81),Gr=r(104),qr=function(){function e(t,r){Object(c.a)(this,e);var n=t.renderContext.rctx,i=r.geometry,a=r.material;this.materialRep=t.materialRep,a.setParameterValues({instancedDoublePrecision:!0});var o=a.createBufferWriter(),s=o.vertexBufferLayout,l=o.elementCount(i),u=o.allocate(l);o.write({},i,u,0),this.geometry=i,this.material=a,this.glMaterials=Object(Ur.a)(a,this.materialRep),this.vertexBufferLayout=s,this.vbo=Br.a.createVertex(n,35044,u.buffer),this.vao=new Gr.a(n,kr.a,{geometry:Object(_r.a)(s)},{geometry:this.vbo}),this.vertexCount=l}return Object(l.a)(e,[{key:"destroy",value:function(){Object(Ur.f)(this.material,this.materialRep),this.vbo.dispose(),this.vao.dispose()}},{key:"boundingInfo",get:function(){return this.geometry.boundingInfo}},{key:"triangleCount",get:function(){return this.vertexCount/3}},{key:"intersect",value:function(e,t,r,n,i,a){var o=this.geometry.id,s=i.toString();this.material.intersect(this.geometry,null,e.transform.transform,e,r,n,(function(r,n,c,l){if(r>=0){if(null!=t&&!t(e.rayBeginPoint,e.rayEndPoint,r))return;var u={type:"external",metadata:{layerUid:a.layerUid,graphicUid:a.graphicUid(i)}};if((null==e.results.min.drapedLayerOrder||l>=e.results.min.drapedLayerOrder)&&(null==e.results.min.dist||r<e.results.min.dist)&&(e.results.min.set(u,s,r,n,e.transform.transform,l,null,o,c),e.results.min.intersector="LodRenderer"),0!==e.options.store&&(null==e.results.max.drapedLayerOrder||l>=e.results.max.drapedLayerOrder)&&(null==e.results.max.dist||r>e.results.max.dist)&&(e.results.max.set(u,s,r,n,e.transform.transform,l,null,o,c),e.results.min.intersector="LodRenderer"),2===e.options.store){var d=new Nr.a(e.results.min.ray);d.set(u,s,r,n,e.transform.transform,l,null,o,c),d.intersector="LodRenderer",e.results.all.push(d)}}}))}}]),e}(),Hr=function(){function e(t,r){Object(c.a)(this,e),this.minScreenSpaceRadius=t,this.components=r}return Object(l.a)(e,[{key:"destroy",value:function(){this.components.forEach((function(e){e.destroy()}))}},{key:"intersect",value:function(e,t,r,n,i,a){this.components.forEach((function(o){o.intersect(e,t,r,n,i,a)}))}},{key:"boundingBox",get:function(){if(!this._boundingBox){var e=Object(P.k)();this.components.forEach((function(t){Object(f.j)(t.boundingInfo)&&(Object(P.r)(e,t.boundingInfo.bbMin),Object(P.r)(e,t.boundingInfo.bbMax))})),this._boundingBox=e}return this._boundingBox}},{key:"boundingSphere",get:function(){if(!this._boundingSphere){var e=this.boundingBox,t=Object(C.e)();Object(P.e)(e,t),this._boundingSphere={center:t,radius:.5*Object(P.j)(e)}}return this._boundingSphere}},{key:"triangleCount",get:function(){return this.components.reduce((function(e,t){return e+t.triangleCount}),0)}}],[{key:"create",value:function(){var t=Object(s.a)(o.a.mark((function t(r,n,i){var a;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Promise.all(n.components.map((function(e){return r.schedule((function(){return new qr(r,e)}),i)})));case 2:return a=t.sent,t.abrupt("return",new e(n.minScreenSpaceRadius,a));case 4:case"end":return t.stop()}}),t)})));return function(e,r,n){return t.apply(this,arguments)}}()}]),e}(),Wr=function(){function e(t,r,n){Object(c.a)(this,e),this._elementSize=r,this._buffer=Br.a.createVertex(t,35044),this.resize(n)}return Object(l.a)(e,[{key:"destroy",value:function(){this._buffer.dispose()}},{key:"elementSize",get:function(){return this._elementSize}},{key:"capacity",get:function(){return this._capacity}},{key:"array",get:function(){return this._array}},{key:"buffer",get:function(){return this._buffer}},{key:"memoryUsage",get:function(){return{cpu:this._capacity*this._elementSize,gpu:this._capacity*this._elementSize}}},{key:"copyRange",value:function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=new Uint8Array(this.array,e*this.elementSize,(t-e)*this.elementSize);new Uint8Array(r.array,n*this.elementSize).set(i)}},{key:"transferAll",value:function(){this._buffer.setData(this._array)}},{key:"transferRange",value:function(e,t){var r=e*this._elementSize,n=t*this._elementSize;this._buffer.setSubData(this._array,r,r,n)}},{key:"resize",value:function(e){var t=e*this._elementSize,r=new ArrayBuffer(t);this._array&&(e>=this._capacity?new Uint8Array(r).set(new Uint8Array(this._array)):new Uint8Array(r).set(new Uint8Array(this._array).subarray(0,e*this._elementSize))),this._array=r,this._buffer.setData(t),this._capacity=e}}]),e}(),Qr=function e(t){Object(c.a)(this,e),this.modelOriginHi=t.getField("modelOriginHi",A.u),this.modelOriginLo=t.getField("modelOriginLo",A.u),this.model=t.getField("model",A.f),this.modelNormal=t.getField("modelNormal",A.f),this.color=t.getField("instanceColor",A.C),this.featureAttribute=t.getField("instanceFeatureAttribute",A.C)},Zr=function(){function e(t,r){Object(c.a)(this,e),this._headIndex=0,this._tailIndex=0,this._captureFirstIndex=!0,this._updating=!1,this._prevHeadIndex=0,this._resized=!1,this._rctx=t,this._instanceBufferLayout=r,this._elementSize=r.stride,this._capacity=1}return Object(l.a)(e,[{key:"destroy",value:function(){this._buffer&&this._buffer.destroy()}},{key:"buffer",get:function(){return this._buffer.buffer}},{key:"view",get:function(){return this._view}},{key:"capacity",get:function(){return this._capacity}},{key:"size",get:function(){var e=this._headIndex,t=this._tailIndex;return e>=t?e-t:e+this._capacity-t}},{key:"isEmpty",get:function(){return this._headIndex===this._tailIndex}},{key:"isFull",get:function(){return this._tailIndex===(this._headIndex+1)%this._capacity}},{key:"headIndex",get:function(){return this._headIndex}},{key:"tailIndex",get:function(){return this._tailIndex}},{key:"firstIndex",get:function(){return this._firstIndex}},{key:"memoryUsage",get:function(){return this._buffer?this._buffer.memoryUsage:{cpu:0,gpu:0}}},{key:"reset",value:function(){this._headIndex=0,this._tailIndex=0,this._firstIndex=null}},{key:"startUpdateCylce",value:function(){this._captureFirstIndex=!0}},{key:"beginUpdate",value:function(){Object(Ue.a)(!this._updating,"already updating"),this._updating=!0,this._prevHeadIndex=this._headIndex}},{key:"endUpdate",value:function(){Object(Ue.a)(this._updating,"not updating"),this.size<$r*this.capacity&&this.shrink(),this._resized?(this._buffer.transferAll(),this._resized=!1):this.transferRange(this._prevHeadIndex,this._headIndex),this._updating=!1}},{key:"allocateHead",value:function(){Object(Ue.a)(this._updating,"not updating"),this.isFull&&this.grow();var e=this.headIndex;return this._captureFirstIndex&&(this._firstIndex=e,this._captureFirstIndex=!1),this.incrementHead(),Object(Ue.a)(this._headIndex!==this._tailIndex,"invalid pointers"),e}},{key:"freeTail",value:function(){Object(Ue.a)(this._updating,"not updating"),Object(Ue.a)(this.size>0,"invalid size");var e=this._tailIndex===this._firstIndex;this.incrementTail(),e&&(this._firstIndex=this._tailIndex)}},{key:"grow",value:function(){var e=Math.max(Xr,Math.floor(this._capacity*Yr));this.resize(e)}},{key:"shrink",value:function(){var e=Math.max(Xr,Math.floor(this._capacity*Jr));this.resize(e)}},{key:"resize",value:function(e){if(Object(Ue.a)(this._updating,"not updating"),e!==this._capacity){var t=new Wr(this._rctx,this._elementSize,e);if(this._buffer){this._firstIndex&&(this._firstIndex=(this._firstIndex+this._capacity-this._tailIndex)%this._capacity);var r=this.size,n=this.compactInstances(t);Object(Ue.a)(n===r,"invalid compaction"),this._buffer.destroy(),this._tailIndex=0,this._headIndex=n,this._prevHeadIndex=0}this._resized=!0,this._capacity=e,this._buffer=t,this._view=new Qr(this._instanceBufferLayout.createView(this._buffer.array))}}},{key:"compactInstances",value:function(e){var t=this._headIndex,r=this._tailIndex;return r<t?(this._buffer.copyRange(r,t,e),t-r):r>t?(this._buffer.copyRange(r,this._capacity,e),t>0&&this._buffer.copyRange(0,t,e,this._capacity-r),t+(this._capacity-r)):0}},{key:"incrementHead",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;this._headIndex=(this._headIndex+e)%this._capacity}},{key:"incrementTail",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;this._tailIndex=(this._tailIndex+e)%this._capacity}},{key:"transferRange",value:function(e,t){e<t?this._buffer.transferRange(e,t):e>t&&(t>0&&this._buffer.transferRange(0,t),this._buffer.transferRange(e,this._capacity))}}]),e}(),Xr=1024,Yr=2,$r=.3,Jr=.5,Kr=r(102),en=r(92),tn=function(e){var t=e.baseBoundingSphere.radius,r=e.levels.map((function(e){return e.minScreenSpaceRadius}));return new Vr(t,r)};var rn=function(){function e(t,r,n,i){var a=this;Object(c.a)(this,e),this.type="Lod",this.isGround=!1,this._inverseViewport=Object(ke.b)(),this._levels=[],this._defaultRenderInstanceData=[],this._highlightRenderInstanceData=[],this._instanceIndex=0,this._slicePlane=!1,this._enableLevelSelection=!0,this._lastCamera=new xr.a,this._updateCyclesWithStaticCamera=-1,this._needFullCycle=!1,this.canRender=!0,this._symbol=t,this._optionalFields=r,this._metadata=n,this._instanceBufferLayout=ee.a.getInstanceBufferLayout({instancedDoublePrecision:!0,instanced:r}),this._glInstanceBufferLayout=Object(_r.a)(this._instanceBufferLayout,1),this._instanceData=new Pr(this._optionalFields,i),this._instanceData.on("instance-added",(function(){a.requestUpdateCycle()})),this._instanceData.on("instance-removed",(function(){a.requestUpdateCycle()})),this._instanceData.on("instance-transform-changed",(function(e){a.requestUpdateCycle(),a._metadata.notifyGraphicGeometryChanged(e.index)})),this._instanceData.on("instance-visibility-changed",(function(e){a.requestUpdateCycle(!0),a._metadata.notifyGraphicVisibilityChanged(e.index)})),this._instanceData.on("instance-highlight-changed",(function(){a.requestUpdateCycle(!0)})),this._enableLevelSelection=this._symbol.levels.length>1}return Object(l.a)(e,[{key:"levels",get:function(){return this._levels}},{key:"baseBoundingBox",get:function(){return this._levels[this._levels.length-1].boundingBox}},{key:"baseBoundingSphere",get:function(){return this._levels[this._levels.length-1].boundingSphere}},{key:"baseMaterial",get:function(){return this._levels[this._levels.length-1].components[0].material}},{key:"slicePlane",get:function(){return this._slicePlane},set:function(e){this._slicePlane=e}},{key:"intersectionHandlerId",get:function(){return this._metadata.layerUid}},{key:"instanceData",get:function(){return this._instanceData}},{key:"memoryUsage",get:function(){var e={cpu:0,gpu:0};return this._defaultRenderInstanceData.forEach((function(t){var r=t.memoryUsage;e.cpu+=r.cpu,e.gpu+=r.gpu})),this._highlightRenderInstanceData.forEach((function(t){var r=t.memoryUsage;e.cpu+=r.cpu,e.gpu+=r.gpu})),e}},{key:"renderStats",get:function(){var e=this,t=this._instanceData.size,r=[];return this._levels.forEach((function(t,n){var i=e._defaultRenderInstanceData[n],a=e._highlightRenderInstanceData[n],o=i.size+a.size,s=t.triangleCount;r.push({renderedInstances:o,renderedTriangles:o*s,trianglesPerInstance:s})})),{totalInstances:t,renderedInstances:r.reduce((function(e,t){return e+t.renderedInstances}),0),renderedTriangles:r.reduce((function(e,t){return e+t.renderedTriangles}),0),levels:r}}},{key:"initializeRenderContext",value:function(){var e=Object(s.a)(o.a.mark((function e(t,r){var n,i=this;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this._context=t,n=t.renderContext.rctx,e.next=4,Object(p.b)(this._symbol.levels.map((function(e){return i._defaultRenderInstanceData.push(new Zr(n,i._instanceBufferLayout)),i._highlightRenderInstanceData.push(new Zr(n,i._instanceBufferLayout)),Hr.create(t,e,r)})));case 4:this._levels=e.sent,this._levelSelector=tn(this);case 6:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"uninitializeRenderContext",value:function(){this.invalidateOctree(),this._levels.forEach((function(e){return e.destroy()})),this._defaultRenderInstanceData.forEach((function(e){return e.destroy()})),this._highlightRenderInstanceData.forEach((function(e){return e.destroy()}))}},{key:"slots",get:function(){return[4,6]}},{key:"needsHighlight",get:function(){return this._highlightRenderInstanceData.reduce((function(e,t){return e+t.size}),0)>0}},{key:"prepareRender",value:function(e,t){if(!$.a.LOD_INSTANCE_RENDERER_DISABLE_UPDATES){if(this._enableLevelSelection){var r=t.equals(this._lastCamera);this._lastCamera.copyFrom(t),r||this.requestUpdateCycle()}var n=this._needFullCycle?this._instanceData.size:2e3;this._needFullCycle=!1,this.updateInstances(t,n),this.needsUpdates&&this._context.requestRender()}}},{key:"render",value:function(e){var t=e.rctx,r=4===e.slot?3:6===e.slot?5:null;if(r){if(!this.baseMaterial.isVisible()||!this.baseMaterial.isVisibleInPass(e.pass))return!1;var n=e.camera;this._inverseViewport[0]=1/n.fullViewport[2],this._inverseViewport[1]=1/n.fullViewport[3];var i={slot:r,origin:[0,0,0],camera:n,inverseViewport:this._inverseViewport,shadowMap:e.shadowMap,shadowMappingEnabled:e.shadowMap.enabled,ssaoHelper:e.ssaoHelper,ssaoEnabled:e.ssaoHelper.enabled,screenToWorldRatio:null,screenToWorldRatioGlobalWM:null,slicePlane:e.sliceHelper&&e.sliceHelper.plane,hudVisibilityTexture:e.offscreenRenderingHelper?e.offscreenRenderingHelper.hudVisibilityTexture:null,highlightDepthTexture:e.offscreenRenderingHelper?e.offscreenRenderingHelper.depthTexture:null,hasOccludees:!1,linearDepthTexture:null,lastFrameColorTexture:null,reprojectionMat:null,ssrEnabled:!1,lighting:e.scenelightingData,transparencyPassType:e.transparencyPassType,terrainLinearDepthTexture:e.multipassTerrainParams.terrainLinearDepthTexture,geometryLinearDepthTexture:e.multipassGeometryParams.geometryLinearDepthTexture,multipassTerrainEnabled:e.multipassTerrainParams.multipassTerrainEnabled,cullAboveGround:e.multipassTerrainParams.cullAboveGround,multipassGeometryEnabled:e.multipassGeometryParams.multipassGeometryEnabled,highlightColorTexture:null};t.bindVAO();var a=5!==e.pass&&7!==e.pass,o=6!==e.pass;return a&&this._renderComponents(e,r,i,this._defaultRenderInstanceData),o&&this._renderComponents(e,r,i,this._highlightRenderInstanceData),!0}}},{key:"intersect",value:function(e,t,r,n){var i=this;if(this.baseMaterial.isVisible()){var a=Object(C.e)();Object(T.l)(a,n,r);var o=function(a){i._instanceData.getCombinedModelTransform(a,sn),e.transform.set(sn),Object(T.s)(cn,r,e.transform.inverse),Object(T.s)(ln,n,e.transform.inverse);var o=i._instanceData.getState(a),s=i._instanceData.getLodLevel(a);Object(Ue.a)(o&vr.ACTIVE,"invalid instance state"),Object(Ue.a)(s>=0&&s<i._levels.length,"invaid lod level"),i._levels[s].intersect(e,t,cn,ln,a,i._metadata)};this.baseMaterial.params.verticalOffset?this.octree.forEach(o):this.octree.forEachAlongRay(r,a,o)}}},{key:"queryDepthRange",value:function(e){return this.queryDepthRangeOctree(e)}},{key:"notifyShaderTransformationChanged",value:function(){this.invalidateOctree()}},{key:"requestUpdateCycle",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this._updateCyclesWithStaticCamera=-1,e&&(this._needFullCycle=!0),this.needsUpdates&&this._context.requestRender()}},{key:"needsUpdates",get:function(){return this._instanceData.size>0&&this._updateCyclesWithStaticCamera<1}},{key:"octree",get:function(){return this._octree||(this._octree=this.buildOctree()),this._octree}},{key:"invalidateOctree",value:function(){this._octree&&(this._octree.destroy(),this._octree=null)}},{key:"buildOctree",value:function(){for(var e=new zr(this._instanceData,this.baseBoundingSphere),t=this._instanceData,r=t.view?t.view.state:null,n=0;n<this._instanceData.capacity;++n)r.get(n)&vr.ACTIVE&&e.addInstance(n);return e}},{key:"queryDepthRangeOctree",value:function(e){var t=e.eye,r=e.viewForward,n=this.octree.findClosest(r,1,e.frustum),i=this.octree.findClosest(r,-1,e.frustum);if(null!=n&&null!=i){this._instanceData.view.boundingSphere.getVec(n,on),Object(T.l)(on,on,t);var a=Object(T.j)(on,r)-on[3];this._instanceData.view.boundingSphere.getVec(i,on),Object(T.l)(on,on,t);var o=Object(T.j)(on,r)+on[3];return{near:Math.max(e.near,a),far:Math.min(e.far,o)}}return{near:1/0,far:-1/0}}},{key:"startUpdateCycle",value:function(){this._updateCyclesWithStaticCamera++,this._defaultRenderInstanceData.forEach((function(e){e.startUpdateCylce()})),this._highlightRenderInstanceData.forEach((function(e){e.startUpdateCylce()})),this.needsUpdates&&this._context.requestRender()}},{key:"updateInstances",value:function(e,t){var r=this._enableLevelSelection,n=this._levelSelector;n.updateCamera(e),this._defaultRenderInstanceData.forEach((function(e){e.beginUpdate()})),this._highlightRenderInstanceData.forEach((function(e){e.beginUpdate()}));var i=this._instanceData,a=this._instanceData.view,o=i.size,s=i.capacity,c=this._instanceIndex;t=Math.min(o,t);for(var l=0;l<t;++l){0===c&&this.startUpdateCycle();var u=a.state.get(c),d=0;if(u&vr.ALLOCATED){var h=a.lodLevel.get(c);if(u&vr.DEFAULT_ACTIVE&&this._defaultRenderInstanceData[h].freeTail(),u&vr.HIGHLIGHT_ACTIVE&&this._highlightRenderInstanceData[h].freeTail(),u&vr.REMOVE)i.freeInstance(c);else if(u&vr.VISIBLE){var f=0;r&&(a.modelOrigin.getVec(c,an),f=n.selectLevel(an,i.getCombinedMedianScaleFactor(c))),d=u&~(vr.ACTIVE|vr.TRANSFORM_CHANGED),f>=0&&(u&vr.HIGHLIGHT?(nn(this._highlightRenderInstanceData[f],a,c),d|=vr.HIGHLIGHT_ACTIVE):(nn(this._defaultRenderInstanceData[f],a,c),d|=vr.DEFAULT_ACTIVE)),a.state.set(c,d),a.lodLevel.set(c,f)}else d=u&~(vr.ACTIVE|vr.TRANSFORM_CHANGED),a.state.set(c,d);if(this._octree){var p=!!(u&vr.ACTIVE),b=!!(d&vr.ACTIVE);!p&&b?this._octree.addInstance(c):p&&!b?this._octree.removeInstance(c):p&&b&&u&vr.TRANSFORM_CHANGED&&(this._octree.removeInstance(c),this._octree.addInstance(c))}c=(c+1)%s}else c=(c+1)%s,t++}this._instanceIndex=c,this._defaultRenderInstanceData.forEach((function(e){e.endUpdate()})),this._highlightRenderInstanceData.forEach((function(e){e.endUpdate()}))}},{key:"_renderComponents",value:function(e,t,r,n){var i=this;this.levels.forEach((function(a,o){a.components.forEach((function(a){i._renderComponent(e,t,r,n[o],a,o)}))}))}},{key:"_renderComponent",value:function(e,t,r,n,i,a){var o=i.glMaterials.get(e.pass);if(o&&o.beginSlot(t)&&0!==n.size){var s=e.rctx,c=s.capabilities.instancing;o.ensureParameters(r);var l=o.technique,u=l.program,d=o.getPipelineState(t);s.setPipelineState(d),s.useProgram(u),o.bind(r),s.bindVAO(i.vao),l.ensureAttributeLocations(i.vao),e.isHighlightPass&&Object(wr.b)(u,r),l.bindDraw(r,{},{}),$.a.LOD_INSTANCE_RENDERER_COLORIZE_BY_LEVEL&&0===e.pass&&(u.setUniform4fv("externalColor",un[Math.min(a,un.length-1)]),u.setUniform1i("colorMixMode",Kr.b.replace));var h=n.capacity,f=n.headIndex,p=n.tailIndex,b=n.firstIndex,v=this._glInstanceBufferLayout,m=function(e,t){Object(en.a)(s,kr.a,n.buffer,v,e),c.drawArraysInstanced(l.primitiveType,0,i.vertexCount,t-e),Object(en.e)(s,kr.a,n.buffer,v)};i.material.params.transparent&&null!=b?f>p?(Object(Ue.a)(b>=p&&b<=f,"invalid firstIndex"),m(b,f),m(p,b)):f<p&&(b<=f?(Object(Ue.a)(b>=0&&b<=f,"invalid firstIndex"),m(b,f),m(p,h),m(0,b)):(Object(Ue.a)(b>=p&&b<=h,"invalid firstIndex"),m(b,h),m(0,f),m(p,b))):f>p?m(p,f):f<p&&(m(0,f),m(p,h)),s.bindVAO(null)}}}]),e}();function nn(e,t,r){var n=e.allocateHead();!function(e,t,r,n){Object(Ur.d)(e.modelOrigin,t,r.modelOriginHi,r.modelOriginLo,n),r.model.copyFrom(n,e.model,t),r.modelNormal.copyFrom(n,e.modelNormal,t),e.color&&r.color&&r.color.copyFrom(n,e.color,t),e.featureAttribute&&r.featureAttribute&&r.featureAttribute.copyFrom(n,e.featureAttribute,t)}(t,r,e.view,n)}var an=Object(C.e)(),on=Object(Te.e)(),sn=Object(S.d)(),cn=Object(C.e)(),ln=Object(C.e)(),un=[[1,0,1,1],[0,0,1,1],[0,1,0,1],[1,1,0,1],[1,0,0,1]],dn=function(e){Object(u.a)(r,e);var t=Object(d.a)(r);function r(e,n,i,a){var o;return Object(c.a)(this,r),(o=t.call(this,e,n,i,a))._resources=null,o._optionalFields=new Array,o._instanceIndexToGraphicUid=new Map,o.hasLoadedPBRTextures=!1,o.ensureDrapedStatus(!1),o.hasLoadedPBRTextures=i.physicalBasedRenderingEnabled,o}return Object(l.a)(r,[{key:"getCachedSize",value:function(){var e=Object(f.j)(this._resources)?this._resources.symbolSize:[1,1,1],t=Object(tr.a)(e,3);return{width:t[0],depth:t[1],height:t[2]}}},{key:"doLoad",value:function(){var e=Object(s.a)(o.a.mark((function e(t){var r,n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._drivenProperties.size){e.next=3;break}if(!Object(L.k)(this.symbolLayer)){e.next=3;break}throw new Error;case 3:if(r=this.symbolLayer,!this.isPrimitive){e.next=11;break}return n=r.resource?r.resource.primitive:rr.b,e.next=8,this._createResourcesForPrimitive(n,t);case 8:this._resources=e.sent,e.next=14;break;case 11:return e.next=13,this._createResourcesForUrl(r.resource.href,t);case 13:this._resources=e.sent;case 14:this.layerOpacityChanged(),this.slicePlaneEnabledChanged(),this.physicalBasedRenderingChanged(),this.complexity=this.computeComplexity();case 15:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"extentPadding",get:function(){return Object(f.j)(this._resources)?this._resources.extentPadding:0}},{key:"isPrimitive",get:function(){return!(this.symbolLayer.resource&&this.symbolLayer.resource.href)}},{key:"lodRenderer",get:function(){return Object(f.h)(this._resources,"lodRenderer")}},{key:"setMaterialTransparencyParams",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Object(f.h)(this.symbolLayer,"material","color"),r=this._getCombinedOpacity(t),n=r<1||this.needsDrivenTransparentPass;return e.transparent=n,e.opacity=r,e.cullFace=n?0:2,e}},{key:"_createResourcesForPrimitive",value:function(){var e=Object(s.a)(o.a.mark((function e(t,r){var n,i,a,s,c,l,u,d,h,p,b,v,m,y,g,O,j,_,w,x;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Object(Or.a)(t)){e.next=2;break}throw new Error("Unknown object symbol primitive: ".concat(t));case 2:if(n=this.symbolLayer,i=Object(P.h)(Object(nr.a)(t)),a=Object(C.f)(Object(P.E)(i)),s=Object(C.f)(Object(nr.b)(a,n)),c=Object(T.r)(s),l=!1,u=!1,d={usePBR:this._context.physicalBasedRenderingEnabled,isSchematic:!0,instanced:["transformation"],ambient:C.a,diffuse:C.a,slicePlaneEnabled:this._context.slicePlaneEnabled,sliceHighlightDisabled:!0,castShadows:this.symbolLayer.castShadows,offsetTransparentBackfaces:!this.symbolLayer.isPrimitive},h=d.usePBR,this.setMaterialTransparencyParams(d),"point-3d"===(p=this.symbol).type&&p.verticalOffset&&(b=p.verticalOffset,v=b.screenLength,m=b.minWorldLength,y=b.maxWorldLength,d.verticalOffset={screenLength:Object(we.g)(v),minWorldLength:m||0,maxWorldLength:null!=y?y:1/0},d.castShadows=!1),this._context.screenSizePerspectiveEnabled&&(d.screenSizePerspective=this._context.sharedResources.screenSizePerspectiveSettings),this._drivenProperties.color?d.externalColor=Te.a:(g=Object(f.j)(n.material)&&n.material.color,O=Object(f.j)(g)?je.a.toUnitRGBA(g):Te.a,d.externalColor=O),this._fastUpdates=ut(this._context.renderer,this._fastVisualVariableConvertOptions(i,s,a,f.o)),this._fastUpdates.enabled?(Object.assign(d,this._fastUpdates.materialParameters),d.instanced.push("featureAttribute"),this._optionalFields.push("featureAttribute")):this._hasPerInstanceColor()&&(d.instanced.push("color"),this._optionalFields.push("color")),j=new ee.a(d),_=Object(Or.b)(t,j)){e.next=11;break}throw new Error("Unknown object symbol primitive: ".concat(t));case 11:return w=Object(fr.d)(_).map((function(e){return{opacity:1,transparent:e.params.transparent}})),x=this._createStageResources(_,h),e.t0=_,e.next=15,this._createLodRenderer(_,r);case 15:return e.t1=e.sent,e.t2=x,e.t3=s,e.t4=c,e.t5=l,e.t6=u,e.t7=w,e.t8=h,e.t9=i,e.t10=a,e.t11=f.o,e.t12=f.o,e.abrupt("return",{lodResources:e.t0,lodRenderer:e.t1,stageResources:e.t2,symbolSize:e.t3,extentPadding:e.t4,isEsriSymbolResource:e.t5,isWosr:e.t6,originalMaterialParameters:e.t7,physicalBasedRenderingEnabled:e.t8,resourceBoundingBox:e.t9,resourceSize:e.t10,dispose:e.t11,pivotOffset:e.t12});case 28:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"_createResourcesForUrl",value:function(){var e=Object(s.a)(o.a.mark((function e(t,r){var n,i,a,s,c,l,u,d,h,p,b,v,m,y,g,O,j,_,w,x,k,S,M,A,E,R,I,D=this;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i={materialParamsMixin:{instanced:n=["transformation"],slicePlaneEnabled:this._context.slicePlaneEnabled,castShadows:this.symbolLayer.castShadows},streamDataRequester:this._context.streamDataRequester,cache:this._context.sharedResources.objectResourceCache},this._fastUpdates=ut(this._context.renderer,this._fastVisualVariableConvertOptions(f.o,f.o,f.o,f.o)),this._fastUpdates.enabled?(Object.assign(i.materialParamsMixin,this._fastUpdates.materialParameters),n.push("featureAttribute"),this._optionalFields.push("featureAttribute")):this._hasPerInstanceColor()&&(n.push("color"),this._optionalFields.push("color")),"point-3d"===(a=this.symbol).type&&a.verticalOffset&&(s=a.verticalOffset,c=s.screenLength,l=s.minWorldLength,u=s.maxWorldLength,i.materialParamsMixin.verticalOffset={screenLength:Object(we.g)(c),minWorldLength:l||0,maxWorldLength:null!=u?u:1/0},i.materialParamsMixin.castShadows=!1),i.signal=r,i.usePBR=this._context.physicalBasedRenderingEnabled,d=i.usePBR,e.next=8,Object(gr.fetch)(t,i);case 8:return h=e.sent,p=h.isEsriSymbolResource,b=h.isWosr,v=h.remove,br(m=pr(h.lods)),m.levels.sort((function(e,t){return e.minScreenSpaceRadius-t.minScreenSpaceRadius})),m.levels[0].minScreenSpaceRadius=Math.min(2,m.levels[0].minScreenSpaceRadius),y=this._context,g=this.symbolLayer.material,O=this._getExternalColorParameters(g),j=Object(f.h)(this.symbolLayer,"material","color"),_=this._getCombinedOpacity(j,{hasIntrinsicColor:!0}),w=this.needsDrivenTransparentPass,x=Object(fr.d)(m),k=Object(fr.d)(m).map((function(e){return{opacity:e.params.opacity||1,transparent:e.params.transparent}})),x.forEach((function(e){var t=e.params;e.setParameterValues(O);var r=t.opacity*_,n=r<1||w||t.transparent;e.setParameterValues({opacity:r,transparent:n}),y.screenSizePerspectiveEnabled&&e.setParameterValues({screenSizePerspective:y.sharedResources.screenSizePerspectiveSettings})})),S=h.referenceBoundingBox,M=Object(C.f)(Object(P.E)(S)),A=Object(C.f)(m.levels[0].pivotOffset),E=Object(C.f)(Object(nr.b)(M,this.symbolLayer)),R=Object(T.r)(E),dt(this._fastUpdates,this._context.renderer,this._fastVisualVariableConvertOptions(S,E,M,A))&&x.forEach((function(e){return e.setParameterValues(D._fastUpdates.materialParameters)})),I=this._createStageResources(m,d),e.t0=m,e.next=22,this._createLodRenderer(m,r);case 22:return e.t1=e.sent,e.t2=I,e.t3=E,e.t4=R,e.t5=p,e.t6=b,e.t7=k,e.t8=d,e.t9=S,e.t10=M,e.t11=v,e.t12=A,e.abrupt("return",{lodResources:e.t0,lodRenderer:e.t1,stageResources:e.t2,symbolSize:e.t3,extentPadding:e.t4,isEsriSymbolResource:e.t5,isWosr:e.t6,originalMaterialParameters:e.t7,physicalBasedRenderingEnabled:e.t8,resourceBoundingBox:e.t9,resourceSize:e.t10,dispose:e.t11,pivotOffset:e.t12});case 35:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"_createStageResources",value:function(e,t){var r=this._context.stage,n=Object(fr.d)(e);t!==this._context.physicalBasedRenderingEnabled&&this.physicalBasedRenderingChanged(),r.addMany(n);var i=Object(fr.e)(e);r.addMany(i);var a=Object(fr.c)(e);return r.addMany(a),{materials:n,textures:i,geometries:a}}},{key:"_createLodRenderer",value:function(){var e=Object(s.a)(o.a.mark((function e(t,r){var n,i,a,s,c=this;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this._context.stage,i={layerUid:this._context.layer.uid,graphicUid:function(e){return c._instanceIndexToGraphicUid.get(e)},notifyGraphicGeometryChanged:function(e){return c._context.notifyGraphicGeometryChanged(c._instanceIndexToGraphicUid.get(e))},notifyGraphicVisibilityChanged:function(e){return c._context.notifyGraphicVisibilityChanged(c._instanceIndexToGraphicUid.get(e))}},a=this._fastUpdates.enabled?{applyTransform:function(e,t,r){e.getFeatureAttribute(t,bn),Object(k.d)(r,bt(c._fastUpdates.materialParameters,bn,r))},scaleFactor:function(e,t,r){return t.getFeatureAttribute(r,bn),vt(e,c._fastUpdates.materialParameters,bn)}}:null,(s=new rn(t,this._optionalFields,i,a)).slicePlane=this._context.slicePlaneEnabled,e.next=4,n.addRenderPlugin(s.slots,s,r);case 4:return e.abrupt("return",s);case 5:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"_getExternalColorParameters",value:function(e){var t={};return this._drivenProperties.color?t.externalColor=Te.a:Object(f.j)(e)&&Object(f.j)(e.color)?t.externalColor=je.a.toUnitRGBA(e.color):(t.externalColor=Te.a,t.colorMixMode="ignore"),t}},{key:"destroy",value:function(){Object(g.a)(Object(O.a)(r.prototype),"destroy",this).call(this);var e=this._context.stage;if(Object(f.j)(this._resources)){e.removeRenderPlugin(this._resources.lodRenderer);var t=this._resources.stageResources;e.removeMany(t.materials),e.removeMany(t.textures),e.removeMany(t.geometries),Object(f.j)(this._resources.dispose)&&this._resources.dispose()}this._resources=null}},{key:"createGraphics3DGraphic",value:function(e){var t=e.graphic;if(!this._validateGeometry(t.geometry))return null;var r=Object(Ne.c)(t.geometry);if(Object(f.i)(r))return this.logger.warn("unsupported geometry type for icon symbol: ".concat(t.geometry.type)),null;var n=this.setGraphicElevationContext(t,new D.a),i=e.renderingInfo;return this._createAs3DShape(t,r,i,n,t.uid)}},{key:"notifyDestroyGraphicLayer",value:function(e){this._instanceIndexToGraphicUid.delete(e.instanceIndex)}},{key:"graphicLayerToGraphicId",value:function(){return 0}},{key:"layerOpacityChanged",value:function(){if(Object(f.i)(this._resources))return!0;for(var e=this._drivenProperties.opacity,t=!this.isPrimitive,r=this._resources.stageResources.materials,n=this._resources.originalMaterialParameters,i=0;i<r.length;i++){var a=r[i],o=Object(f.h)(this.symbolLayer,"material","color"),s=n[i],c=this._getCombinedOpacity(o,{hasIntrinsicColor:t})*s.opacity,l=c<1||e||s.transparent;a.setParameterValues({opacity:c,transparent:l}),this.isPrimitive&&a.setParameterValues({cullFace:l?0:2})}return!0}},{key:"layerElevationInfoChanged",value:function(e,t){return this.updateGraphics3DGraphicElevationInfo(e,t,I.g)}},{key:"slicePlaneEnabledChanged",value:function(){if(Object(f.i)(this._resources))return!0;this._resources.lodRenderer.slicePlane=this._context.slicePlaneEnabled;var e,t=Object(n.a)(this._resources.stageResources.materials);try{for(t.s();!(e=t.n()).done;){e.value.setParameterValues({slicePlaneEnabled:this._context.slicePlaneEnabled})}}catch(r){t.e(r)}finally{t.f()}return!0}},{key:"physicalBasedRenderingChanged",value:function(){if(Object(f.i)(this._resources))return!0;var e,t=this._resources,r=t.stageResources,i=t.isWosr,a=Object(n.a)(r.materials);try{for(a.s();!(e=a.n()).done;){var o=e.value;this.isPrimitive?o.setParameterValues({usePBR:this._context.physicalBasedRenderingEnabled,isSchematic:!0}):i||o.setParameterValues({usePBR:this._context.physicalBasedRenderingEnabled,isSchematic:!1})}}catch(s){a.e(s)}finally{a.f()}return!1!==this.hasLoadedPBRTextures||!0!==this._context.physicalBasedRenderingEnabled||(this.hasLoadedPBRTextures=!0,!1)}},{key:"pixelRatioChanged",value:function(){return!0}},{key:"applyRendererDiff",value:function(e,t){if(Object(f.i)(this._resources))return!0;var r=this._resources,i=r.stageResources.materials,a=r.lodRenderer,o=r.resourceBoundingBox,s=r.symbolSize,c=r.resourceSize,l=r.pivotOffset;for(var u in e.diff)switch(u){case"visualVariables":if(!dt(this._fastUpdates,t,this._fastVisualVariableConvertOptions(o,s,c,l)))return!1;var d,h=Object(n.a)(i);try{for(h.s();!(d=h.n()).done;){d.value.setParameterValues(this._fastUpdates.materialParameters)}}catch(p){h.e(p)}finally{h.f()}a.notifyShaderTransformationChanged();break;default:return!1}return!0}},{key:"computeComplexity",value:function(){return Object(f.i)(this._resources)?Object(g.a)(Object(O.a)(r.prototype),"computeComplexity",this).call(this):{primitivesPerFeature:Object(fr.b)(this._resources.lodResources.levels[0]).reduce((function(e,t){return e+t.indices.get("position").length}),0)/3,primitivesPerCoordinate:0,drawCallsPerFeature:0,estimated:!1,memory:Object(jr.d)(this.symbol,this.symbolLayer)}}},{key:"hasLodRenderer",value:function(){return Object(f.j)(this._resources)}},{key:"_createAs3DShape",value:function(e,t,r,n,i){if(!this.hasLodRenderer()||Object(f.i)(this._resources))return null;var a=this.getFastUpdateAttrValues(e),o=!this._fastUpdates.enabled&&this._hasPerInstanceColor()?Object(L.g)(r.color,r.opacity):null,s=this._context.clippingExtent;if(Object(M.u)(t,hn,this._context.elevationProvider.spatialReference),Object(f.j)(s)&&!Object(P.g)(s,hn))return null;var c=this._requiresTerrainElevation(n),l=this._computeGlobalTransform(t,n,pn,c?vn:null),u=this._computeLocalTransform(this._resources,this.symbolLayer,r,fn),d=this._resources.lodRenderer.instanceData,h=d.addInstance();this._instanceIndexToGraphicUid.set(h,i),d.setLocalTransform(h,u,!1),d.setGlobalTransform(h,l),a&&d.setFeatureAttribute(h,a),o&&d.setColor(h,o);var p=new hr(this,h,Re.a,n);return c&&(p.alignedSampledElevation=vn.sampledElevation),p.needsElevationUpdates=Object(I.g)(n.mode),Object(Ne.b)(p,t,this._context.elevationProvider),p}},{key:"_computeGlobalTransform",value:function(e,t,r,n){var i=Object(I.e)(e,this._context.elevationProvider,t,this._context.renderCoordsHelper,n);return hn[0]=e.x,hn[1]=e.y,hn[2]=i,Object(M.d)(e.spatialReference,hn,r,this._context.renderCoordsHelper.spatialReference),r}},{key:"_computeLocalTransform",value:function(e,t,r,n){return Object(k.i)(n),this._applyObjectRotation(r,!1,n),this._applyObjectRotation(t,!0,n),this._applyObjectScale(e,r,n),this._applyAnchor(e,t,n),n}},{key:"_applyObjectScale",value:function(e,t,r){if(!this._fastUpdates.enabled||!this._fastUpdates.requiresShaderTransformation){var n=this._drivenProperties.size&&t.size?t.size:e.symbolSize,i=Object(L.c)(n,e.symbolSize,e.resourceSize,this._context.renderCoordsHelper.unitInMeters);1===i[0]&&1===i[1]&&1===i[2]||Object(k.s)(r,r,i)}}},{key:"prepareSymbolLayerPatch",value:function(e){if("partial"===e.diff.type){var t=e.diff.diff;this._preparePatchTransform(e,t),this._preparePatchColor(e,t)}}},{key:"updateGeometry",value:function(e,t){if(Object(f.i)(this._resources))return!0;var r=t&&Object(Ne.c)(t);if(Object(f.i)(r))return!1;var n=this.getGeometryElevationMode(t);if(e.elevationContext.mode!==n)return!1;var i=this._requiresTerrainElevation(e.elevationContext);return this._computeGlobalTransform(r,e.elevationContext,pn,i?vn:null),i&&(e.alignedSampledElevation=vn.sampledElevation),this._resources.lodRenderer.instanceData.setGlobalTransform(e.instanceIndex,pn,!0),Object(Ne.b)(e,r,this._context.elevationProvider),!0}},{key:"_preparePatchTransform",value:function(e,t){var r=this;if((t.heading||t.tilt||t.roll||t.width||t.height||t.depth||t.anchor||t.anchorPosition)&&!Object(f.i)(this._resources)){var n=function(e,t,r){return Object(f.t)(null!=e&&"complete"===e.type?e.newValue:t,r)},i=n(t.heading,this.symbolLayer.heading,0),a=n(t.tilt,this.symbolLayer.tilt,0),o=n(t.roll,this.symbolLayer.roll,0),s=n(t.width,this.symbolLayer.width,void 0),c=n(t.height,this.symbolLayer.height,void 0),l=n(t.depth,this.symbolLayer.depth,void 0),u=n(t.anchor,this.symbolLayer.anchor,void 0),d=n(t.anchorPosition,this.symbolLayer.anchorPosition,void 0);delete t.heading,delete t.tilt,delete t.roll,delete t.width,delete t.height,delete t.depth,delete t.anchor,delete t.anchorPosition;var h={heading:i,tilt:a,roll:o,anchor:u,anchorPosition:d},p=this._resources;1===this.loadStatus&&e.symbolLayerStatePatches.push((function(){p.symbolSize=Object(C.f)(Object(nr.b)(p.resourceSize,{width:s,height:c,depth:l,isPrimitive:r.symbolLayer.isPrimitive}))})),e.graphics3DGraphicPatches.push((function(e,t){var n=r._computeLocalTransform(p,h,t,fn),i=e.instanceIndex;p.lodRenderer.instanceData.setLocalTransform(i,n,!0)}))}}},{key:"_preparePatchColor",value:function(e,t){var r=this;if(t.material&&"partial"===t.material.type){var i=t.material.diff;if(i.color&&"complete"===i.color.type&&null!=i.color.newValue&&null!=i.color.oldValue){var a=i.color.newValue,o=Object(f.j)(a)?je.a.toUnitRGBA(a):Te.a;delete i.color;var s=this._resources;Object(f.i)(s)||e.graphics3DGraphicPatches.push((function(e){var t;r._hasPerInstanceColor()?(s.lodRenderer.instanceData.setColor(e.instanceIndex,o),t=r.setMaterialTransparencyParams({},a)):t=r.setMaterialTransparencyParams({externalColor:o},a);var i,c=Object(n.a)(s.stageResources.materials);try{for(c.s();!(i=c.n()).done;){i.value.setParameterValues(t)}}catch(l){c.e(l)}finally{c.f()}}))}}}},{key:"_requiresTerrainElevation",value:function(e){return"absolute-height"!==e.mode}},{key:"_applyObjectRotation",value:function(e,t,r){if(!(this._fastUpdates.enabled&&this._fastUpdates.requiresShaderTransformation&&t))return Object(L.b)(e.heading,e.tilt,e.roll,r)}},{key:"_computeAnchor",value:function(e,t,r){var n=Object(C.e)();switch(r.anchor){case"center":Object(T.m)(n,Object(P.e)(e)),Object(T.u)(n,n);break;case"top":var i=Object(P.e)(e);Object(T.y)(n,-i[0],-i[1],-e[5]);break;case"bottom":var a=Object(P.e)(e);Object(T.y)(n,-a[0],-a[1],-e[2]);break;case"relative":var o=Object(P.e)(e),s=Object(P.E)(e),c=r.anchorPosition,l=c?Object(C.g)(c.x,c.y,c.z):C.b;Object(T.d)(n,s,l),Object(T.h)(n,n,o),Object(T.u)(n,n);break;case"origin":default:Object(f.j)(t)?Object(T.u)(n,t):Object(T.m)(n,C.b)}return n}},{key:"_applyAnchor",value:function(e,t,r){if(!this._fastUpdates.enabled||!this._fastUpdates.requiresShaderTransformation){var n=this._computeAnchor(e.resourceBoundingBox,e.pivotOffset,t);n&&Object(k.t)(r,r,n)}}},{key:"_hasPerInstanceColor",value:function(){return this._drivenProperties.color||this._drivenProperties.opacity}},{key:"_fastVisualVariableConvertOptions",value:function(e,t,r,n){var i=Object(f.j)(e)?Object(C.f)(Object(P.E)(e)):C.a,a=Object(f.j)(e)?this._computeAnchor(e,n,this.symbolLayer):C.b,o=this._context.renderCoordsHelper.unitInMeters,s=Object(L.c)(Object(f.j)(t)?t:void 0,t,r,o),c=Object(C.g)(this.symbolLayer.tilt||0,this.symbolLayer.roll||0,this.symbolLayer.heading||0);return{modelSize:i,symbolSize:Object(f.j)(t)?t:C.a,unitInMeters:o,transformation:{anchor:a,scale:s,rotation:c}}}}]),r}(F.a),hn=Object(C.e)(),fn=Object(S.d)(),pn=Object(S.d)(),bn=Object(Te.e)(),vn={verticalDistanceToGround:0,sampledElevation:0},mn=r(63);function yn(e,t,r,n,i){return e[0]=t,e[1]=r,e[2]=n,e[3]=i,e}function gn(e,t,r){var n=t[0],i=t[1],a=t[2],o=t[3],s=r[0],c=r[1],l=r[2],u=r[3];return e[0]=n*s+a*c,e[1]=i*s+o*c,e[2]=n*l+a*u,e[3]=i*l+o*u,e}function On(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e[2]=t[2]-r[2],e[3]=t[3]-r[3],e}var jn=gn,_n=On,wn=(Object.freeze({__proto__:null,copy:function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e},identity:function(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e},set:yn,transpose:function(e,t){if(e===t){var r=t[1];e[1]=t[2],e[2]=r}else e[0]=t[0],e[1]=t[2],e[2]=t[1],e[3]=t[3];return e},invert:function(e,t){var r=t[0],n=t[1],i=t[2],a=t[3],o=r*a-i*n;return o?(o=1/o,e[0]=a*o,e[1]=-n*o,e[2]=-i*o,e[3]=r*o,e):null},adjoint:function(e,t){var r=t[0];return e[0]=t[3],e[1]=-t[1],e[2]=-t[2],e[3]=r,e},determinant:function(e){return e[0]*e[3]-e[2]*e[1]},multiply:gn,rotate:function(e,t,r){var n=t[0],i=t[1],a=t[2],o=t[3],s=Math.sin(r),c=Math.cos(r);return e[0]=n*c+a*s,e[1]=i*c+o*s,e[2]=n*-s+a*c,e[3]=i*-s+o*c,e},scale:function(e,t,r){var n=t[0],i=t[1],a=t[2],o=t[3],s=r[0],c=r[1];return e[0]=n*s,e[1]=i*s,e[2]=a*c,e[3]=o*c,e},fromRotation:function(e,t){var r=Math.sin(t),n=Math.cos(t);return e[0]=n,e[1]=r,e[2]=-r,e[3]=n,e},fromScaling:function(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=t[1],e},str:function(e){return"mat2("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+")"},frob:function(e){return Math.sqrt(Math.pow(e[0],2)+Math.pow(e[1],2)+Math.pow(e[2],2)+Math.pow(e[3],2))},LDU:function(e,t,r,n){return e[2]=n[2]/n[0],r[0]=n[0],r[1]=n[1],r[3]=n[3]-e[2]*r[1],[e,t,r]},add:function(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e[3]=t[3]+r[3],e},subtract:On,exactEquals:function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]},equals:function(e,t){var r=e[0],n=e[1],i=e[2],a=e[3],o=t[0],s=t[1],c=t[2],l=t[3];return Math.abs(r-o)<=mn.a*Math.max(1,Math.abs(r),Math.abs(o))&&Math.abs(n-s)<=mn.a*Math.max(1,Math.abs(n),Math.abs(s))&&Math.abs(i-c)<=mn.a*Math.max(1,Math.abs(i),Math.abs(c))&&Math.abs(a-l)<=mn.a*Math.max(1,Math.abs(a),Math.abs(l))},multiplyScalar:function(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e},multiplyScalarAndAdd:function(e,t,r,n){return e[0]=t[0]+r[0]*n,e[1]=t[1]+r[1]*n,e[2]=t[2]+r[2]*n,e[3]=t[3]+r[3]*n,e},mul:jn,sub:_n}),r(29)),xn=r(73),kn=function(e){Object(u.a)(r,e);var t=Object(d.a)(r);function r(e,n,i,a,o,s){var l;return Object(c.a)(this,r),(l=t.call(this,e,n)).path=i,l.geometrySR=a,l.upVectorAlignment=o,l.stencilWidth=s,l}return r}(N.a);function Sn(e){return"upVectorAlignment"in e}function Tn(){return[1,0,0,1]}Object.freeze({__proto__:null,create:Tn,clone:function(e){return[e[0],e[1],e[2],e[3]]},fromValues:function(e,t,r,n){return[e,t,r,n]},createView:function(e,t){return new Float64Array(e,t,4)}});var Cn=r(37),Mn=r(79);function Pn(){return{up:Object(C.e)(),right:Object(C.e)()}}function An(e,t,r){Object(T.s)(e.up,t.up,r),Object(T.s)(e.right,t.right,r)}function En(e,t,r){Object(wn.r)(e,Object(T.j)(r,t.right),Object(T.j)(r,t.up))}var Rn=function(){function e(){Object(c.a)(this,e),this.pos=Object(C.e)(),this.posES=Object(C.e)(),this.posGS=Object(C.e)(),this.vRight=Object(C.e)(),this.vLeft=Object(C.e)(),this.frame=Pn(),this.rotationFrame=Pn(),this.rotationRight=Object(ke.b)(),this.rotationAngle=0,this.miterStretch=[1,0,0,1]}return Object(l.a)(e,[{key:"setFrameFromUpVector",value:function(e){Object(T.m)(this.frame.up,e),Object(T.h)(Jn,this.vLeft,this.vRight),Object(T.t)(Jn,Jn),Object(T.g)($n,this.frame.up,Object(T.j)(Jn,this.frame.up)),Object(T.l)(ti,Jn,$n),Object(T.t)(ti,ti),Object(T.i)(this.frame.right,ti,this.frame.up)}},{key:"computeRotationAxisAndAngleFromUpVector",value:function(){Object(T.m)(this.rotationFrame.up,this.frame.up),Object(T.m)(this.rotationFrame.right,this.frame.right),Object(wn.r)(this.rotationRight,1,0),Object(T.g)($n,this.frame.up,Object(T.j)(this.frame.up,this.vLeft)),Object(T.l)($n,this.vLeft,$n),Object(T.u)($n,$n),Object(T.t)($n,$n),Object(T.g)(Jn,this.frame.up,Object(T.j)(this.frame.up,this.vRight)),Object(T.l)(Jn,this.vRight,Jn),Object(T.t)(Jn,Jn),Object(T.i)(Kn,this.rotationFrame.up,this.vLeft);var e=Object($e.t)(Object(T.j)(Kn,this.vRight));if(this.rotationAngle=e*(Math.PI-Object($e.b)(Object(T.j)($n,Jn))),Math.abs(this.rotationAngle)>0){var t=Object($e.s)(Math.cos(.5*this.rotationAngle));yn(this.miterStretch,t-1+1,0,0,1)}var r=Math.PI-this.rotationAngle;this.maxStretchDistance=Math.abs(Math.min(this.vLeftLength,this.vRightLength)/Math.cos(.5*r))}}]),e}(),In=function(){function e(){Object(c.a)(this,e),this.vertices=[],this.vertexIndices=[],this.vertexNormals=[],this.poles=[],this.poleIndices=[],this.uvs=null,this.uvIndices=null}return Object(l.a)(e,[{key:"addVertex",value:function(e,t){return this.vertices.push(Object(ke.c)(e)),this.vertexNormals.push(Object(ke.c)(t)),this.vertices.length-1}},{key:"addUV",value:function(e){return this.uvs||(this.uvs=[],this.uvIndices=[]),this.uvs.push(e),this.uvs.length-1}},{key:"addPole",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return this.poles.push({position:Object(ke.c)(e),normal:t?Object(ke.c)(t):null}),this.poles.length-1}},{key:"addSegment",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;this.vertexIndices.push(e.v0),this.vertexIndices.push(e.v1),t&&(this.uvIndices.push(t.v0),this.uvIndices.push(t.v1)),r&&(this.poleIndices.push(r.v0),this.poleIndices.push(r.v1))}},{key:"numSegments",get:function(){return this.vertexIndices.length/2}},{key:"hasUV",value:function(){return null!=this.uvs}},{key:"translate",value:function(e,t){var r,i=Object(n.a)(this.vertices);try{for(i.s();!(r=i.n()).done;){var a=r.value;a[0]+=e,a[1]+=t}}catch(l){i.e(l)}finally{i.f()}var o,s=Object(n.a)(this.poles);try{for(s.s();!(o=s.n()).done;){var c=o.value;c.position[0]+=e,c.position[1]+=t}}catch(l){s.e(l)}finally{s.f()}}}],[{key:"circle",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:20,r=.5,n=new e,i={v0:0,v1:0};n.addPole(Object(ke.f)(0,0));for(var a=0;a<t;++a){var o=2*a*Math.PI/t,s=Math.cos(o),c=Math.sin(o),l=Object(ke.f)(s*r,c*r),u=Object(ke.f)(s,c);n.addVertex(l,u),n.addUV(a/t)}n.addUV(1);for(var d=0;d<t-1;++d){var h={v0:d,v1:d+1},f=h;n.addSegment(h,f,i)}var p={v0:t-1,v1:0},b={v0:t-1,v1:t};return n.addSegment(p,b,i),n}},{key:"rect",value:function(){var t=new e,r=Object(ke.f)(-.5,-.5),n=Object(ke.f)(.5,-.5),i=Object(ke.f)(.5,.5),a=Object(ke.f)(-.5,.5),o=Object(ke.f)(0,-1),s=Object(ke.f)(1,0),c=Object(ke.f)(0,1),l=Object(ke.f)(-1,0);t.addUV(0),t.addUV(1),t.addPole(Object(ke.f)(0,.5),c),t.addPole(Object(ke.f)(0,.5)),t.addPole(Object(ke.f)(0,-.5)),t.addPole(Object(ke.f)(0,-.5),o);var u={v0:0,v1:1};return t.addVertex(r,o),t.addVertex(n,o),t.addSegment({v0:0,v1:1},u,{v0:3,v1:3}),t.addVertex(n,s),t.addVertex(i,s),t.addSegment({v0:2,v1:3},u,{v0:2,v1:1}),t.addVertex(i,c),t.addVertex(a,c),t.addSegment({v0:4,v1:5},u,{v0:0,v1:0}),t.addVertex(a,l),t.addVertex(r,l),t.addSegment({v0:6,v1:7},u,{v0:1,v1:2}),t}}]),e}(),Dn=function(){function e(t){Object(c.a)(this,e),this.vertices=[],this.offset=Object(C.e)(),this.xform=Object(S.d)(),this.vertices=t;var r=Math.floor((t.length-1)/2);Object(T.m)(this.offset,this.vertices[r].pos);var i,a=Object(n.a)(this.vertices);try{for(a.s();!(i=a.n()).done;){var o=i.value;Object(T.l)(o.pos,o.pos,this.offset)}}catch(s){a.e(s)}finally{a.f()}Object(k.t)(this.xform,this.xform,this.offset),this.updatePathVertexInformation()}return Object(l.a)(e,[{key:"updatePathVertexInformation",value:function(){var e=this.vertices.length,t=this.vertices[0];t.index=0,Object(T.y)(t.vLeft,0,0,0),t.vLeftLength=0,Object(T.l)(t.vRight,this.vertices[1].pos,t.pos),t.vRightLength=Object(T.r)(t.vRight),Object(T.t)(t.vRight,t.vRight);for(var r=t,n=1;n<e;++n)(t=this.vertices[n]).index=n,Object(T.m)(t.vLeft,r.vRight),t.vLeftLength=r.vRightLength,n<e-1?(Object(T.l)(t.vRight,this.vertices[n+1].pos,t.pos),t.vRightLength=Object(T.r)(t.vRight),Object(T.t)(t.vRight,t.vRight)):(Object(T.m)(t.vRight,t.vLeft),t.vRightLength=t.vLeftLength),r=t}}]),e}();var Fn=function(){function e(){Object(c.a)(this,e)}return Object(l.a)(e,[{key:"numProfilesPerJoin",value:function(){return 1}},{key:"extrude",value:function(e,t,r){for(var n=0;n<t.vertices.length;++n)r(e.index,e.frame,t.vertices[n],t.vertexNormals[n],!1)}}]),e}(),Ln=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.8*Math.PI,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;Object(c.a)(this,e),this.cutoffAngle=t,this.numBendSubdivisions=r}return Object(l.a)(e,[{key:"numProfilesPerJoin",value:function(){return this.numBendSubdivisions+1}},{key:"extrude",value:function(e,t,r){var n=ri;if(Math.abs(e.rotationAngle)>=this.cutoffAngle)for(var i=0;i<this.numBendSubdivisions+1;++i){Object(k.i)(ni),Object(k.c)(ni,ni,.5*-e.rotationAngle+i*e.rotationAngle/this.numBendSubdivisions,e.rotationFrame.up),An(n,e.frame,ni);for(var a=0;a<t.vertices.length;++a)Object(wn.h)(t.vertices[a],e.rotationRight)*e.rotationAngle>=0?r(e.index,n,t.vertices[a],t.vertexNormals[a],!1):(Object(wn.o)(Zn,t.vertices[a],e.miterStretch),r(e.index,e.frame,Zn,t.vertexNormals[a],!0))}else for(var o=0;o<this.numBendSubdivisions+1;++o)for(var s=0;s<t.vertices.length;++s){var c=Object(wn.h)(t.vertices[s],e.rotationRight)*e.rotationAngle>=0;Object(wn.o)(Zn,t.vertices[s],e.miterStretch),r(e.index,e.frame,Zn,t.vertexNormals[s],!c)}}}]),e}(),zn={generateUV:!1},Vn=function(){function e(){Object(c.a)(this,e)}return Object(l.a)(e,[{key:"rebuildConnectingProfileGeometry",value:function(e,t,r){for(var n=0;n<t.vertices.length;++n)r(e.index,e.frame,t.vertices[n],t.vertexNormals[n],0,0)}}]),e}(),Nn=function(e){Object(u.a)(r,e);var t=Object(d.a)(r);function r(){return Object(c.a)(this,r),t.call(this)}return Object(l.a)(r,[{key:"getNumVertices",value:function(){return 0}},{key:"getNumIndices",value:function(){return 0}},{key:"rebuildCapGeometry",value:function(){}},{key:"buildTopology",value:function(){}}]),r}(Vn),Un=function(e){Object(u.a)(r,e);var t=Object(d.a)(r);function r(e){var n,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,a=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return Object(c.a)(this,r),(n=t.call(this)).profile=e,n.profilePlaneOffset=i,n.flip=a,n}return Object(l.a)(r,[{key:"getNumVertices",value:function(){return this.profile.vertices.length}},{key:"getNumIndices",value:function(){return 3*this.profile.numSegments}},{key:"rebuildConnectingProfileGeometry",value:function(e,t,r){for(var n=0;n<t.vertices.length;++n)r(e.index,e.frame,t.vertices[n],t.vertexNormals[n],this.profilePlaneOffset,0)}},{key:"rebuildCapGeometry",value:function(e,t){var r=Xn;Object(wn.r)(r,0,0);for(var n=this.flip?1:-1,i=0;i<this.profile.vertices.length;++i)t(e.index,e.frame,this.profile.vertices[i],r,this.profilePlaneOffset,n)}},{key:"buildTopology",value:function(e,t){for(var r=this.vertexBufferStart+this.profile.vertexIndices[0],n=1;n<this.profile.numSegments;++n){var i=this.profile.vertexIndices[2*n+0],a=this.profile.vertexIndices[2*n+1],o=this.vertexBufferStart+i,s=this.vertexBufferStart+a;this.flip?t(s,o,r):t(r,o,s)}}}]),r}(Vn),Bn=function(e){Object(u.a)(r,e);var t=Object(d.a)(r);function r(e){var n;return Object(c.a)(this,r),(n=t.call(this)).flip=!1,n.sign=0,n.breakNormals=!1,n.numSegments=3,n.profile=e.profile,n.flip=e.flip,n.sign=n.flip?1:-1,n.breakNormals=e.breakNormals,n.numSegments=e.subdivisions,n}return Object(l.a)(r,[{key:"getNumVertices",value:function(){var e=0;return e=this.profile.vertices.length*(this.numSegments-1),this.breakNormals&&(e+=this.profile.vertices.length),e+=this.profile.poles.length}},{key:"getNumIndices",value:function(){var e=0;e+=2*this.profile.numSegments*(this.numSegments-1);for(var t=0;t<this.profile.numSegments;++t){var r=this.profile.vertexIndices[2*t+0],n=this.profile.vertexIndices[2*t+1];this.profile.poleIndices[r]===this.profile.poleIndices[n]?e+=1:e+=2}return 3*e}},{key:"rebuildCapGeometry",value:function(e,t){var r=e.frame,n=.5*this.sign,i=Zn,a=Xn;Object(wn.r)(a,0,0);for(var o=0;o<this.profile.poles.length;++o){var s=this.profile.poles[o];s.normal?t(e.index,r,s.position,s.normal,n,0):t(e.index,r,s.position,a,n,this.sign)}if(this.breakNormals)for(var c=0;c<this.profile.vertices.length;++c)t(e.index,r,this.profile.vertices[c],this.profile.vertexNormals[c],0,0);for(var l=0;l<this.numSegments-1;++l)for(var u=(1-(l+1)/this.numSegments)*Math.PI*.5,d=Math.sin(u),h=Math.cos(u),f=0;f<this.profile.vertices.length;++f){var p=this.profile.poles[this.profile.poleIndices[f]];Object(wn.a)(i,this.profile.vertices[f],p.position),Object(wn.b)(i,i,d),p.normal?(Object(wn.i)(i,i,p.position),t(e.index,r,i,p.normal,n*h,0)):(Object(wn.f)(a,i),Object(wn.b)(a,a,d),Object(wn.i)(i,i,p.position),t(e.index,r,i,a,n*h,this.sign*h))}}},{key:"buildTopology",value:function(e,t){for(var r=this.breakNormals?this.vertexBufferStart+this.profile.poles.length:this.firstProfileVertexIndex,n=this.breakNormals?this.vertexBufferStart+this.profile.poles.length+this.profile.vertices.length:this.vertexBufferStart+this.profile.poles.length,i=0;i<this.profile.numSegments;++i){for(var a=this.profile.vertexIndices[2*i+0],o=this.profile.vertexIndices[2*i+1],s=this.vertexBufferStart+this.profile.poleIndices[a],c=this.vertexBufferStart+this.profile.poleIndices[o],l=r+a,u=r+o,d=0;d<this.numSegments-1;++d){var h=n+d*this.profile.vertices.length+a,f=n+d*this.profile.vertices.length+o;this.flip?(t(h,u,l),t(u,h,f)):(t(l,u,h),t(f,h,u)),l=h,u=f}this.flip?(t(s,u,l),s!==c&&t(s,c,u)):(t(l,u,s),s!==c&&t(u,c,s))}}}]),r}(Vn),Gn=function(){function e(t,r,n,i,a){var o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:zn;Object(c.a)(this,e),this.options=o,this._extrusionVertexCount=0,this._triangleCount=0,this.numExtrusionProfiles=0,this.numVerticesTotal=0,this.numNormalsTotal=0,this.numUVTotal=0,this.profile=r,this.path=t,this.extruder=n,this.startCap=i,this.endCap=a;var s=this.path.vertices.length-2;this.numExtrusionProfiles=n.numProfilesPerJoin()*s+2,this.numVerticesTotal=r.vertices.length*this.numExtrusionProfiles,this.numNormalsTotal=this.numVerticesTotal,this.startCap.vertexBufferStart=this.numVerticesTotal;var l=this.startCap.getNumVertices();this.numVerticesTotal+=l,this.numNormalsTotal+=l,this.endCap.vertexBufferStart=this.numVerticesTotal;var u=this.endCap.getNumVertices();this.numVerticesTotal+=u,this.numNormalsTotal+=u,this.pathVertexData=new Float32Array(1*this.numVerticesTotal),this.profileRightAxisData=new Float32Array(4*this.numVerticesTotal),this.profileUpAxisData=new Float32Array(4*this.numVerticesTotal),this.profileVertexAndNormalData=new Float32Array(4*this.numVerticesTotal),this.profile.hasUV()&&this.options.generateUV&&(this.numUVTotal=this.profile.uvs.length,this.uvData=new Float32Array(2*this.numUVTotal)),this.originData=new Float32Array(3*this.path.vertices.length),this.rebuildGeometry(),this.buildTopology()}return Object(l.a)(e,[{key:"emitVertex",value:function(e,t,r,n,i){if(this.profileRightAxisData[4*this._extrusionVertexCount+0]=t.right[0],this.profileRightAxisData[4*this._extrusionVertexCount+1]=t.right[1],this.profileRightAxisData[4*this._extrusionVertexCount+2]=t.right[2],this.profileUpAxisData[4*this._extrusionVertexCount+0]=t.up[0],this.profileUpAxisData[4*this._extrusionVertexCount+1]=t.up[1],this.profileUpAxisData[4*this._extrusionVertexCount+2]=t.up[2],this.profileVertexAndNormalData[4*this._extrusionVertexCount+0]=r[0],this.profileVertexAndNormalData[4*this._extrusionVertexCount+1]=r[1],this.profileVertexAndNormalData[4*this._extrusionVertexCount+2]=n[0],this.profileVertexAndNormalData[4*this._extrusionVertexCount+3]=n[1],this.pathVertexData[this._extrusionVertexCount]=e,i){var a=this.path.vertices[e];this.profileRightAxisData[4*this._extrusionVertexCount+3]=a.rotationRight[0]*a.maxStretchDistance,this.profileUpAxisData[4*this._extrusionVertexCount+3]=a.rotationRight[1]*a.maxStretchDistance}else this.profileRightAxisData[4*this._extrusionVertexCount+3]=0,this.profileUpAxisData[4*this._extrusionVertexCount+3]=0;++this._extrusionVertexCount}},{key:"emitCapVertex",value:function(e,t,r,n,i,a){this.profileRightAxisData[4*this._extrusionVertexCount+0]=t.right[0],this.profileRightAxisData[4*this._extrusionVertexCount+1]=t.right[1],this.profileRightAxisData[4*this._extrusionVertexCount+2]=t.right[2],this.profileUpAxisData[4*this._extrusionVertexCount+0]=t.up[0],this.profileUpAxisData[4*this._extrusionVertexCount+1]=t.up[1],this.profileUpAxisData[4*this._extrusionVertexCount+2]=t.up[2],this.profileVertexAndNormalData[4*this._extrusionVertexCount+0]=r[0],this.profileVertexAndNormalData[4*this._extrusionVertexCount+1]=r[1],this.profileVertexAndNormalData[4*this._extrusionVertexCount+2]=n[0],this.profileVertexAndNormalData[4*this._extrusionVertexCount+3]=n[1],this.pathVertexData[this._extrusionVertexCount]=e,this.profileRightAxisData[4*this._extrusionVertexCount+3]=i,this.profileUpAxisData[4*this._extrusionVertexCount+3]=a,++this._extrusionVertexCount}},{key:"emitTriangle",value:function(e,t,r){this.vertexIndices[3*this._triangleCount+0]=e,this.vertexIndices[3*this._triangleCount+1]=t,this.vertexIndices[3*this._triangleCount+2]=r,this.pathVertexIndices[3*this._triangleCount+0]=this.pathVertexData[e],this.pathVertexIndices[3*this._triangleCount+1]=this.pathVertexData[t],this.pathVertexIndices[3*this._triangleCount+2]=this.pathVertexData[r],this.normalIndices[3*this._triangleCount+0]=e,this.normalIndices[3*this._triangleCount+1]=t,this.normalIndices[3*this._triangleCount+2]=r,++this._triangleCount}},{key:"rebuildGeometry",value:function(){var e=this,t=function(t,r,n,i,a){return e.emitVertex(t,r,n,i,a)},r=function(t,r,n,i,a,o){return e.emitCapVertex(t,r,n,i,a,o)};this._extrusionVertexCount=0;var i,a=Object(n.a)(this.path.vertices);try{for(a.s();!(i=a.n()).done;){var o=i.value;this.originData[3*o.index+0]=o.pos[0],this.originData[3*o.index+1]=o.pos[1],this.originData[3*o.index+2]=o.pos[2]}}catch(l){a.e(l)}finally{a.f()}this.startCap.rebuildConnectingProfileGeometry(this.path.vertices[0],this.profile,r);for(var s=1;s<this.path.vertices.length-1;++s)this.extruder.extrude(this.path.vertices[s],this.profile,t);if(this.endCap.rebuildConnectingProfileGeometry(this.path.vertices[this.path.vertices.length-1],this.profile,r),this.startCap.rebuildCapGeometry(this.path.vertices[0],r),this.endCap.rebuildCapGeometry(this.path.vertices[this.path.vertices.length-1],r),this.profile.hasUV()&&this.options.generateUV)for(var c=0;c<this.profile.uvs.length;++c)this.uvData[2*c+0]=this.profile.uvs[c],this.uvData[2*c+1]=0}},{key:"buildTopology",value:function(){var e=this,t=function(t,r,n){return e.emitTriangle(t,r,n)};this._triangleCount=0;var r=this.profile.vertices.length,n=this.profile.numSegments,i=this.numExtrusionProfiles-1,a=n*i*2*3;this.startCap.indexBufferStart=a,this.startCap.firstProfileVertexIndex=0,a+=this.startCap.getNumIndices(),this.endCap.indexBufferStart=a,this.endCap.firstProfileVertexIndex=r*(this.numExtrusionProfiles-1),a+=this.endCap.getNumIndices(),this.vertexIndices=new Uint32Array(a),this.normalIndices=new Uint32Array(a),this.pathVertexIndices=new Uint32Array(a),this.profile.hasUV()&&this.options.generateUV&&(this.uvIndices=new Uint32Array(a));for(var o=0;o<n;++o)for(var s=this.profile.vertexIndices[2*o],c=this.profile.vertexIndices[2*o+1],l=0;l<i;++l){var u=l*r+s,d=(l+1)*r+c,h=l*r+c;t(u,(l+1)*r+s,d),t(u,d,h)}this.startCap.buildTopology(this.path.vertices[0],t),this.endCap.buildTopology(this.path.vertices[this.path.vertices.length-1],t)}},{key:"onPathChanged",value:function(){this.rebuildGeometry()}}]),e}(),qn=function(){function e(t){Object(c.a)(this,e),this.builder=t}return Object(l.a)(e,[{key:"xform",get:function(){return this.builder.path.xform}},{key:"onPathChanged",value:function(){this.builder.onPathChanged()}}]),e}(),Hn=function(e){Object(u.a)(r,e);var t=Object(d.a)(r);function r(e){var n;return Object(c.a)(this,r),(n=t.call(this,e)).vertexAttributePosition=null,n.vertexAttributeNormal=null,n.vertexAttributeColor=null,n.vertexAttributePosition=new Float32Array(3*n.builder.numVerticesTotal),n.vertexAttributeNormal=new Float32Array(3*n.builder.numNormalsTotal),n.vertexAttributeColor=new Uint8Array(4),n.vertexAttributeColor[0]=255,n.vertexAttributeColor[1]=255,n.vertexAttributeColor[2]=255,n.vertexAttributeColor[3]=255,n}return Object(l.a)(r,[{key:"bakeVertexColors",value:function(e){this.vertexAttributeColor[0]=255*e[0],this.vertexAttributeColor[1]=255*e[1],this.vertexAttributeColor[2]=255*e[2],this.vertexAttributeColor[3]=255*(e.length>3?e[3]:1)}},{key:"bake",value:function(e){this.size=e;for(var t=0;t<this.builder.numVerticesTotal;++t){var r=this.builder.pathVertexData[t],n=0===r||r===this.builder.path.vertices.length-1;r*=3;var i=Qn;Object(T.y)(i,this.builder.originData[r++],this.builder.originData[r++],this.builder.originData[r]);var a=4*t,o=$n,s=Zn,c=Jn,l=Kn,u=ei,d=0,h=0;if(Object(T.y)(l,this.builder.profileRightAxisData[a],this.builder.profileRightAxisData[a+1],this.builder.profileRightAxisData[a+2]),Object(T.y)(u,this.builder.profileUpAxisData[a],this.builder.profileUpAxisData[a+1],this.builder.profileUpAxisData[a+2]),Object(wn.r)(s,this.builder.profileVertexAndNormalData[a]*e[0],this.builder.profileVertexAndNormalData[a+1]*e[1]),n)Object(T.i)(c,u,l),d=this.builder.profileRightAxisData[a+3]*e[0],h=this.builder.profileUpAxisData[a+3];else{var f=Xn,p=Yn;Object(wn.r)(f,this.builder.profileRightAxisData[a+3],this.builder.profileUpAxisData[a+3]);var b=Object(wn.l)(f);Object(wn.f)(f,f);var v=Object(wn.h)(s,f);if(Math.abs(v)>b){Object(wn.r)(p,-f[1],f[0]);var m=Object(wn.h)(s,p);Object(wn.b)(f,f,b*Object($e.t)(v)),Object(wn.b)(p,p,m),Object(wn.i)(s,f,p)}Object(T.y)(c,0,0,0)}Object(T.y)(o,l[0]*s[0]+u[0]*s[1],l[1]*s[0]+u[1]*s[1],l[2]*s[0]+u[2]*s[1]),this.vertexAttributePosition[3*t+0]=i[0]+o[0]+c[0]*d,this.vertexAttributePosition[3*t+1]=i[1]+o[1]+c[1]*d,this.vertexAttributePosition[3*t+2]=i[2]+o[2]+c[2]*d;var y=Zn;Object(wn.r)(y,this.builder.profileVertexAndNormalData[a+2],this.builder.profileVertexAndNormalData[a+3]),this.vertexAttributeNormal[3*t+0]=l[0]*y[0]+u[0]*y[1]+c[0]*h,this.vertexAttributeNormal[3*t+1]=l[1]*y[0]+u[1]*y[1]+c[1]*h,this.vertexAttributeNormal[3*t+2]=l[2]*y[0]+u[2]*y[1]+c[2]*h}}},{key:"createGeometryData",value:function(){var e=[["position",this.builder.vertexIndices],["normal",this.builder.normalIndices]],t=[["position",{size:3,data:this.vertexAttributePosition,exclusive:!0}],["normal",{size:3,data:this.vertexAttributeNormal,exclusive:!0}]];if(this.vertexAttributeColor){var r=this.builder.vertexIndices.length;e.push(["color",new Uint32Array(r)]),t.push(["color",{size:4,data:this.vertexAttributeColor}])}return{vertexAttributes:t,indices:e}}},{key:"onPathChanged",value:function(){Object(g.a)(Object(O.a)(r.prototype),"onPathChanged",this).call(this),this.bake(this.size)}},{key:"intersect",value:function(e,t,r){var n=this.builder.vertexIndices,i={size:3,data:this.vertexAttributePosition},a=n.length/3;Object(Kr.j)(e,t,0,a,n,i,void 0,void 0,r)}}]),r}(qn),Wn=function(e){Object(u.a)(r,e);var t=Object(d.a)(r);function r(e,n,i,a){var o;Object(c.a)(this,r),(o=t.call(this,e)).sizeAttributeValue=n,o.colorAttributeValue=i,o.opacityAttributeValue=a,o.vvData=null,o.baked=new Hn(e),o.vvData=new Float32Array(4*o.builder.path.vertices.length);for(var s=0;s<o.builder.path.vertices.length;++s){o.vvData[4*s+0]=n,o.vvData[4*s+1]=i,o.vvData[4*s+2]=a;var l=0===s||s===o.builder.path.vertices.length-1;o.vvData[4*s+3]=l?1:0}return o}return Object(l.a)(r,[{key:"createGeometryData",value:function(){return{vertexAttributes:[["position",{size:3,data:this.builder.originData,exclusive:!0}],["profileRight",{size:4,data:this.builder.profileRightAxisData,exclusive:!0}],["profileUp",{size:4,data:this.builder.profileUpAxisData,exclusive:!0}],["profileVertexAndNormal",{size:4,data:this.builder.profileVertexAndNormalData,exclusive:!0}],["featureValue",{size:4,data:this.vvData,exclusive:!0}]],indices:[["position",this.builder.pathVertexIndices],["profileRight",this.builder.vertexIndices],["profileUp",this.builder.vertexIndices],["profileVertexAndNormal",this.builder.vertexIndices],["featureValue",this.builder.pathVertexIndices]]}}}]),r}(qn),Qn=Object(C.e)(),Zn=Object(ke.b)(),Xn=Object(ke.b)(),Yn=Object(ke.b)(),$n=Object(C.e)(),Jn=Object(C.e)(),Kn=Object(C.e)(),ei=Object(C.e)(),ti=Object(C.e)(),ri=Pn(),ni=Object(S.d)(),ii=r(195),ai=r(116),oi=r(0),si=r(76),ci=r(492),li=r(283),ui=r(112),di=r(148),hi=r(106),fi=r(91),pi=r(95),bi=r(24),vi=r(89),mi=r(88),yi=r(111),gi=r(620),Oi=r(41),ji=new Map([["position",0],["profileRight",1],["profileUp",2],["profileVertexAndNormal",3],["featureValue",4]]),_i=function(e){Object(u.a)(r,e);var t=Object(d.a)(r);function r(){return Object(c.a)(this,r),t.apply(this,arguments)}return Object(l.a)(r,[{key:"initializeProgram",value:function(e){var t=r.shader.get(),n=this.configuration,i=t.build({OITEnabled:0===n.transparencyPassType,output:n.output,viewingMode:e.viewingMode,slicePlaneEnabled:n.slicePlaneEnabled,sliceHighlightDisabled:!1,sliceEnabledForVertexPrograms:!1,receiveShadows:n.receiveShadows,vvSize:n.vvSize,vvColor:n.vvColor,vvInstancingEnabled:!0,vvOpacity:n.vvOpacity,pbrMode:0,useCustomDTRExponentForWater:!1,receiveAmbientOcclusion:n.receiveSSAO,doubleSidedMode:n.doubleSidedMode,multipassTerrainEnabled:n.multipassTerrainEnabled,cullAboveGround:n.cullAboveGround});return new mi.a(e.rctx,i,ji)}},{key:"bindPass",value:function(e,t){var r,n;Object(hi.c)(this.program,t.camera.projectionMatrix),this.program.setUniform3fv("size",e.size),t.multipassTerrainEnabled&&(this.program.setUniform2fv("cameraNearFar",t.camera.nearFar),this.program.setUniform2fv("inverseViewport",t.inverseViewport),Object(ui.a)(this.program,t)),0!==this.configuration.output&&7!==this.configuration.output||this.program.setUniform1f("opacity",e.opacity),0===this.configuration.output?(t.lighting.setUniforms(this.program,!1),this.program.setUniform3fv("ambient",e.ambient),this.program.setUniform3fv("diffuse",e.diffuse),this.program.setUniform3fv("specular",e.specular),this.program.setUniform1f("opacity",e.opacity)):1!==this.configuration.output&&3!==this.configuration.output||Object(hi.b)(this.program,t.camera.nearFar),Object(ci.b)(this.program,e),null==(r=t.shadowMap)||r.bind(this.program),null==(n=t.ssaoHelper)||n.bind(this.program)}},{key:"bindDraw",value:function(e){Object(hi.d)(this.program,e),Object(si.c)(this.program,this.configuration,e),this.program.rebindTextures(),0!==this.configuration.output&&7!==this.configuration.output||Object(hi.a)(this.program,e.origin,e.camera.viewInverseTransposeMatrix),0===this.configuration.output&&Object(di.c)(this.program,e),2===this.configuration.output&&li.a.bindUniforms(this.program,e.camera.viewInverseTransposeMatrix)}},{key:"setPipelineState",value:function(e){var t=this.configuration,r=3===e,n=2===e;return Object(Oi.g)({blending:0!==t.output&&7!==t.output||!t.transparent?null:r?vi.f:Object(vi.a)(e),culling:function(e){return!e.slicePlaneEnabled&&!(e.transparent||0===e.doubleSidedMode)}(t)&&Oi.f,depthTest:{func:Object(vi.b)(e)},depthWrite:r||n?Oi.e:null,colorWrite:Oi.d,stencilWrite:t.sceneHasOcludees?yi.j:null,stencilTest:t.sceneHasOcludees?yi.e:null,polygonOffset:r||n?null:vi.d})}},{key:"initializePipeline",value:function(){return this.setPipelineState(this.configuration.transparencyPassType)}}]),r}(pi.a);_i.shader=new fi.a(gi.a,(function(){return r.e(204).then(r.bind(null,1067))}));var wi=function(e){Object(u.a)(r,e);var t=Object(d.a)(r);function r(){var e;return Object(c.a)(this,r),(e=t.apply(this,arguments)).output=0,e.doubleSidedMode=0,e.receiveShadows=!1,e.receiveSSAO=!1,e.vvSize=!1,e.vvColor=!1,e.vvOpacity=!1,e.slicePlaneEnabled=!1,e.transparent=!1,e.sceneHasOcludees=!1,e.transparencyPassType=3,e.multipassTerrainEnabled=!1,e.cullAboveGround=!1,e}return r}(bi.a);Object(oi.a)([Object(bi.b)({count:8})],wi.prototype,"output",void 0),Object(oi.a)([Object(bi.b)({count:3})],wi.prototype,"doubleSidedMode",void 0),Object(oi.a)([Object(bi.b)()],wi.prototype,"receiveShadows",void 0),Object(oi.a)([Object(bi.b)()],wi.prototype,"receiveSSAO",void 0),Object(oi.a)([Object(bi.b)()],wi.prototype,"vvSize",void 0),Object(oi.a)([Object(bi.b)()],wi.prototype,"vvColor",void 0),Object(oi.a)([Object(bi.b)()],wi.prototype,"vvOpacity",void 0),Object(oi.a)([Object(bi.b)()],wi.prototype,"slicePlaneEnabled",void 0),Object(oi.a)([Object(bi.b)()],wi.prototype,"transparent",void 0),Object(oi.a)([Object(bi.b)()],wi.prototype,"sceneHasOcludees",void 0),Object(oi.a)([Object(bi.b)({count:4})],wi.prototype,"transparencyPassType",void 0),Object(oi.a)([Object(bi.b)()],wi.prototype,"multipassTerrainEnabled",void 0),Object(oi.a)([Object(bi.b)()],wi.prototype,"cullAboveGround",void 0);var xi=r(525),ki=r(151),Si=Ue.a,Ti=function(e){Object(u.a)(r,e);var t=Object(d.a)(r);function r(e){var n;return Object(c.a)(this,r),(n=t.call(this,e,Mi)).supportsEdges=!0,n._vertexAttributeLocations=ji,n.techniqueConfig=new wi,n.vertexBufferLayout=r.getVertexBufferLayout(n.params),n}return Object(l.a)(r,[{key:"getTechniqueConfig",value:function(e,t){return this.techniqueConfig.output=e,this.techniqueConfig.vvSize=this.params.vvSizeEnabled,this.techniqueConfig.vvColor=this.params.vvColorEnabled,this.techniqueConfig.vvOpacity=this.params.vvOpacityEnabled,this.techniqueConfig.slicePlaneEnabled=this.params.slicePlaneEnabled,this.techniqueConfig.transparent=this.params.transparent,this.techniqueConfig.sceneHasOcludees=this.params.sceneHasOcludees,0!==e&&7!==e||(this.techniqueConfig.doubleSidedMode=this.params.doubleSided&&"normal"===this.params.doubleSidedType?1:this.params.doubleSided&&"winding-order"===this.params.doubleSidedType?2:0,this.techniqueConfig.receiveShadows=this.params.receiveShadows,this.techniqueConfig.receiveSSAO=!(!t||!t.ssaoEnabled)&&this.params.receiveSSAO),this.techniqueConfig.transparencyPassType=t?t.transparencyPassType:3,this.techniqueConfig.multipassTerrainEnabled=!!t&&t.multipassTerrainEnabled,this.techniqueConfig.cullAboveGround=!!t&&t.cullAboveGround,this.techniqueConfig}},{key:"getPassParameters",value:function(){return this.params}},{key:"isVisibleInPass",value:function(e){return 4!==e&&6!==e&&7!==e||this.params.castShadows}},{key:"isVisible",value:function(){var e=this.params;return!!Object(g.a)(Object(O.a)(r.prototype),"isVisible",this).call(this)&&e.opacity>0}},{key:"intersect",value:function(e,t,r,n,i,a,o){var s=e;if(Sn(s)){var c=s.path,l=[this.params.size[0],this.params.size[1]];if(this.params.vvSizeEnabled){var u=this.params.vvSizeOffset,d=this.params.vvSizeFactor,h=this.params.vvSizeMinSize,p=this.params.vvSizeMaxSize,b=c.sizeAttributeValue;l[0]*=Object($e.e)(u[0]+b*d[0],h[0],p[0]),l[1]*=Object($e.e)(u[2]+b*d[2],h[2],p[2])}var v=Math.max(l[0],l[1]),m=e.boundingInfo;if(Object(f.i)(m))this._intersectTriangles(c,l,i,a,o);else{var y=Object(P.t)(m.bbMin[0]-v,m.bbMin[1]-v,m.bbMin[2]-v,m.bbMax[0]+v,m.bbMax[1]+v,m.bbMax[2]+v),g=[a[0]-i[0],a[1]-i[1],a[2]-i[2]],O=Math.sqrt(g[0]*g[0]+g[1]*g[1]+g[2]*g[2]),j=[O/g[0],O/g[1],O/g[2]];Object(Kr.f)(y,i,j,n.tolerance)&&this._intersectTriangles(c,l,i,a,o)}}}},{key:"_intersectTriangles",value:function(e,t,r,n,i){e.baked.size&&e.baked.size[0]===t[0]&&e.baked.size[1]===t[1]||e.baked.bake(t),e.baked.intersect(r,n,i)}},{key:"computeAttachmentOrigin",value:function(e,t){var r=e.vertexAttributes;if(!r)return null;var n=r.get("position");return Object(Bt.a)(n,null,!1,t)}},{key:"createBufferWriter",value:function(){return new Pi(this.vertexBufferLayout)}},{key:"getGLMaterial",value:function(e){if(0===e.output||7===e.output||1===e.output||2===e.output||4===e.output||3===e.output&&this.params.castShadows)return new Ci(e)}}],[{key:"getVertexBufferLayout",value:function(e){var t=Object(Cr.a)().vec3f("position").vec4f("profileRight").vec4f("profileUp").vec4f("profileVertexAndNormal");return(e.vvColorEnabled||e.vvSizeEnabled||e.vvOpacityEnabled)&&(t=t.vec4f("featureValue")),t}}]),r}(ai.a),Ci=function(e){Object(u.a)(r,e);var t=Object(d.a)(r);function r(e){var n;return Object(c.a)(this,r),(n=t.call(this,e)).updateParameters(),n}return Object(l.a)(r,[{key:"updateParameters",value:function(e){this._technique=this._techniqueRep.releaseAndAcquire(_i,this._material.getTechniqueConfig(this._output,e),this._technique)}},{key:"beginSlot",value:function(e){return e===(this._technique.configuration.transparent?5:3)}},{key:"_updateOccludeeState",value:function(e){e.hasOccludees!==this._material.params.sceneHasOcludees&&this._material.setParameterValues({sceneHasOcludees:e.hasOccludees})}},{key:"_updateShadowState",value:function(e){e.shadowMappingEnabled!==this._technique.configuration.receiveShadows&&this._material.setParameterValues({receiveShadows:e.shadowMappingEnabled})}},{key:"ensureParameters",value:function(e){0!==this._output&&7!==this._output||(this._updateShadowState(e),this._updateOccludeeState(e)),this.updateParameters(e)}},{key:"bind",value:function(e){this._technique.bindPass(this._material.getPassParameters(),e)}}]),r}(ii.a),Mi=Object(y.a)(Object(y.a)({size:[1,1,1],ambient:[.2,.2,.2],diffuse:[.8,.8,.8],specular:[0,0,0],opacity:1,doubleSided:!1,doubleSidedType:"normal",receiveSSAO:!0,receiveShadows:!1,castShadows:!0,slicePlaneEnabled:!1,transparent:!1,sceneHasOcludees:!1},xi.a.Default),ai.b),Pi=function(){function e(t){Object(c.a)(this,e),this.vertexBufferLayout=t}return Object(l.a)(e,[{key:"allocate",value:function(e){return this.vertexBufferLayout.createBuffer(e)}},{key:"elementCount",value:function(e){return e.indices.get("position").length}},{key:"write",value:function(e,t,r,n){var i=function(e){if(t.vertexAttributes.has(e)){var i=t.vertexAttributes.get(e),a=t.indices.get(e);Si(4===i.size);var o=r.getField(e,A.C);if(!o)throw new Error("unable to acquire view for "+e);Object(ki.a)(a,i.data,o,n)}};i("profileRight"),i("profileUp"),i("profileVertexAndNormal"),this.vertexBufferLayout.hasField("featureValue")&&i("featureValue"),Object(ki.c)(t,this.vertexBufferLayout,e.transformation,e.invTranspTransformation,r,n)}}]),e}(),Ai=["polyline"],Ei=function(e){Object(u.a)(r,e);var t=Object(d.a)(r);function r(e,n,i,a){var o;return Object(c.a)(this,r),(o=t.call(this,e,n,i,a))._intrinsicSize=Object(ke.f)(1,1),o.upVectorAlignment="path",o.stencilWidth=.1,o.ensureDrapedStatus(!1),o}return Object(l.a)(r,[{key:"doLoad",value:function(){var e=Object(s.a)(o.a.mark((function e(){var t,r,n,i,a,s,c,l,u,d,h,p,b;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=Object(f.j)(this.symbolLayer.width)?this.symbolLayer.width:Object(f.j)(this.symbolLayer.height)?this.symbolLayer.height:this.symbolLayer.size,r=Object(f.j)(this.symbolLayer.height)?this.symbolLayer.height:t,this._vvConvertOptions={modelSize:[1,1,1],symbolSize:[t,1,r],unitInMeters:this._context.renderCoordsHelper.unitInMeters,transformation:{anchor:[0,0,0],scale:[1,1,1],rotation:[0,0,0]},supportedTypes:{size:!0,color:!0,opacity:!0,rotation:!1}},this._context.renderer&&this._context.renderer.visualVariables&&this._context.renderer.visualVariables.length>0?this._fastUpdates=ut(this._context.renderer,this._vvConvertOptions):this._fastUpdates={enabled:!1},n=this.symbolLayer.anchor||"center",this.upVectorAlignment="path","heading"===this.symbolLayer.profileRotation&&(this.upVectorAlignment="world"),i=this.symbolLayer.profile||"circle",e.t0=i,e.next="circle"===e.t0?8:"quad"===e.t0?10:8;break;case 8:return this._profile=In.circle(Bi),e.abrupt("break",11);case 10:this._profile=In.rect();case 11:a=[0,0],"center"!==n&&(a={left:[.5,0],right:[-.5,0],top:[0,-.5],bottom:[0,.5]}[n],this._profile.translate(a[0],a[1])),e.t1=this.symbolLayer.join||"simple",e.next="round"===e.t1?16:"bevel"===e.t1?18:"miter"===e.t1?20:(e.t1,22);break;case 16:return this._extruder=new Ln(0,Ni),e.abrupt("break",23);case 18:return this._extruder=new Ln(0,1),e.abrupt("break",23);case 20:return this._extruder=new Ln(.8*Math.PI,1),e.abrupt("break",23);case 22:this._extruder=new Fn;case 23:s=this.symbolLayer.cap||"butt",e.t2=s,e.next="none"===e.t2?27:"butt"===e.t2?29:"square"===e.t2?31:"round"===e.t2?33:29;break;case 27:return this._startCap=new Nn,this._endCap=new Nn,e.abrupt("break",36);case 29:return this._startCap=new Un(this._profile,0),this._endCap=new Un(this._profile,0,!0),e.abrupt("break",36);case 31:return this._startCap=new Un(this._profile,-.5),this._endCap=new Un(this._profile,.5,!0),e.abrupt("break",36);case 33:return c="quad"===i,this._startCap=new Bn({profile:this._profile,flip:!1,breakNormals:c,subdivisions:Ui}),this._endCap=new Bn({profile:this._profile,flip:!0,breakNormals:c,subdivisions:Ui}),e.abrupt("break",36);case 36:if(l=Object(f.h)(this.symbolLayer,"material","color"),u=this._getCombinedOpacityAndColor(l),d=Object(C.f)(u),h=u[3],p=h<1||this.needsDrivenTransparentPass,b={diffuse:d,ambient:d,opacity:h,transparent:p,vertexColors:!1,slicePlaneEnabled:this._context.slicePlaneEnabled,castShadows:this.symbolLayer.castShadows,cullFace:p||"none"===s?0:2,offsetTransparentBackfaces:!0},this._drivenProperties.size||(Object(wn.r)(this._intrinsicSize,t,r),Object(L.f)(this._intrinsicSize[0])&&Object(L.f)(this._intrinsicSize[1]))){e.next=39;break}throw new j.a("graphics3dpathsymbollayer:invalid-size","Symbol sizes may not be negative values");case 39:this._fastUpdates.enabled&&this._fastUpdates.visualVariables.size||Object(wn.b)(this._intrinsicSize,this._intrinsicSize,1/this._context.renderCoordsHelper.unitInMeters),this._fastUpdates.enabled?(Object.assign(b,this._fastUpdates.materialParameters,{size:[this._intrinsicSize[0],this._intrinsicSize[1],0]}),this._material=new Ti(b)):(b.vertexColors=this._drivenProperties.color||this._drivenProperties.opacity,this._material=new ee.a(b)),this._material.setParameterValues({usePBR:this._context.physicalBasedRenderingEnabled,isSchematic:!0}),this._context.stage.add(this._material);case 40:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"destroy",value:function(){Object(g.a)(Object(O.a)(r.prototype),"destroy",this).call(this),this._context.stage.remove(this._material),this._material=null}},{key:"createGraphics3DGraphic",value:function(e){var t=e.graphic;if(!this._validateGeometry(t.geometry,Ai,this.symbolLayer.type))return null;var r=this.setGraphicElevationContext(t,new D.a),n=e.renderingInfo;return this._createAs3DShape(t,n,r,t.uid)}},{key:"layerOpacityChanged",value:function(){var e=Object(f.h)(this.symbolLayer,"material","color"),t=this._getCombinedOpacity(e),r=t<1||this.needsDrivenTransparentPass;return this._material.setParameterValues({opacity:t,transparent:r}),!0}},{key:"layerElevationInfoChanged",value:function(e,t){return this.updateGraphics3DGraphicElevationInfo(e,t,I.g)}},{key:"slicePlaneEnabledChanged",value:function(){return this._material.setParameterValues({slicePlaneEnabled:this._context.slicePlaneEnabled}),!0}},{key:"physicalBasedRenderingChanged",value:function(){return this._material.setParameterValues({usePBR:this._context.physicalBasedRenderingEnabled,isSchematic:!0}),!0}},{key:"pixelRatioChanged",value:function(){return!0}},{key:"applyRendererDiff",value:function(e,t){for(var r in e.diff)switch(r){case"visualVariables":if(!dt(this._fastUpdates,t,this._vvConvertOptions))return!1;this._material.setParameterValues(this._fastUpdates.materialParameters);break;default:return!1}return!0}},{key:"getVertexData",value:function(e){var t,r=0,i=e.paths,a=[],o=e.spatialReference,s=this._context.elevationProvider.spatialReference,c=this._context.renderCoordsHelper.spatialReference,l=Object(n.a)(i);try{for(l.s();!(t=l.n()).done;){r+=t.value.length}}catch(j){l.e(j)}finally{l.f()}var u,d=new Float64Array(3*r),h=new Float64Array(3*r),f=new Float64Array(3*r),p=0,b=Object(n.a)(i);try{for(b.s();!(u=b.n()).done;){var v=u.value;a.push({index:p,numVertices:v.length});var m,y=Object(n.a)(v);try{for(y.s();!(m=y.n()).done;){var g=m.value;d[p++]=g[0],d[p++]=g[1],d[p++]=e.hasZ?g[2]:0}}catch(j){y.e(j)}finally{y.f()}}}catch(j){b.e(j)}finally{b.f()}var O=!0;return o.equals(s)?this._copyVertices(d,0,h,0,r):O=Object(M.q)(d,o,0,h,s,0,r),s.equals(c)?this._copyVertices(h,0,f,0,r):Object(M.q)(h,s,0,f,c,0,r),{pathVertexDataInfos:a,vertexDataGS:d,vertexDataES:h,vertexDataRS:f,projectionSuccess:O,terrainElevation:0}}},{key:"_copyVertices",value:function(e,t,r,n,i){t*=3,n*=3;for(var a=0;a<i;++a)r[n++]=e[t++],r[n++]=e[t++],r[n++]=e[t++]}},{key:"_createAs3DShape",value:function(e,t,r,n){var i=e.geometry,a=new Array,o=new Array,s=new Array,c=i.spatialReference,l=Object(P.h)(),u=this._context.renderCoordsHelper,d=this.getVertexData(i);if(!d.projectionSuccess)return this.logger.warn("PathSymbol3DLayer geometry failed to be created (failed to project geometry to view spatial reference)"),null;if(d.pathVertexDataInfos.length>0){for(var h=0;h<d.pathVertexDataInfos.length;++h){var p=d.pathVertexDataInfos[h],b=p.index,m=p.numVertices;if(!(m<2)&&(!Object(f.j)(this._context.clippingExtent)||(Object(P.k)(l),Object(P.n)(l,d.vertexDataES,3*b,m),Object(P.w)(l,this._context.clippingExtent)))){for(var y=[],g=b;g<b+3*m;){var O=g++,j=g++,_=g++,w=new Rn;Object(T.y)(w.posGS,d.vertexDataGS[O],d.vertexDataGS[j],d.vertexDataGS[_]),Object(T.y)(w.posES,d.vertexDataES[O],d.vertexDataES[j],d.vertexDataES[_]);var x=Object(I.e)(w.posES,this._context.elevationProvider,r,u,null);Object(T.y)(Li,d.vertexDataRS[O],d.vertexDataRS[j],d.vertexDataRS[_]),u.setAltitude(Li,x),Object(T.y)(w.pos,Li[0],Li[1],Li[2]),y.push(w)}var k=new Dn(y);Ri(k,this.upVectorAlignment,this._context.renderCoordsHelper);var S=new Gn(k,this._profile,this._extruder,this._startCap,this._endCap),C=null;if(this._fastUpdates.enabled){var M=this._fastUpdates.visualVariables,A=M.size?Object(F.b)(M.size.field,e):0,E=M.color?Object(F.b)(M.color.field,e):0,R=M.opacity?Object(F.b)(M.opacity.field,e):0;C=new Wn(S,A,E,R)}else{var D=[this._intrinsicSize[0],this._intrinsicSize[1]];this._drivenProperties.size&&(D[0]*=Ii(t.size[0],"symbol-value"===t.size[2]?this.symbolLayer.height||0:t.size[2],this.symbolLayer.width||0),D[1]*=Ii(t.size[2],"symbol-value"===t.size[0]?this.symbolLayer.width||0:t.size[0],this.symbolLayer.height||0));var L=null;this._drivenProperties.color&&(L=t.color),this._drivenProperties.opacity&&null!=t.opacity&&(L=L?[L[0],L[1],L[2],t.opacity]:[1,1,1,t.opacity]);var z=new Hn(S);z.bake(D),L&&z.bakeVertexColors(L),C=z}var V=C.createGeometryData(),N=V.vertexAttributes,U=V.indices,B=new kn(N,U,C,c,this.upVectorAlignment,this.stencilWidth);a.push(B),o.push(this._material),s.push(C.xform)}}if(a.length>0){var G={layerUid:this._context.layer.uid,graphicUid:n},q=new K.a({geometries:a,materials:o,transformations:s,metadata:G}),H=new v.a(this,q,a,null,null,Fi,r);return H.alignedSampledElevation=d.terrainElevation,H.needsElevationUpdates=Object(I.g)(r.mode),H}}else 0!==i.paths.length&&i.paths.some((function(e){return e.length>0}))||this.logger.warn("PathSymbol3DLayer geometry failed to be created (no paths were defined)");return null}}]),r}(F.a);function Ri(e,t,r){switch(t){case"world":var i,a=Object(n.a)(e.vertices);try{for(a.s();!(i=a.n()).done;){var o=i.value;Object(T.h)(zi,o.pos,e.offset),r.worldUpAtPosition(zi,Li),o.setFrameFromUpVector(Li),o.computeRotationAxisAndAngleFromUpVector()}}catch(b){a.e(b)}finally{a.f()}break;case"path":Object(T.h)(zi,e.vertices[0].pos,e.offset),r.worldUpAtPosition(zi,Li),function(e,t){var r=null,n=e.vertices.length,i=.99619469809,a=Object(C.e)(),o=Object(C.e)(),s=Object(C.e)(),c=Object(C.e)(),l=Object(C.e)(),u=Object(C.e)(),d=Object(Cn.d)(),h=e.vertices[0];Object(T.m)(o,t),Object(T.y)(a,0,1,0),mt.a.makeOrthoBasisDirUpFallback(h.vRight,o,a,a,s,o,i),Object(T.m)(h.frame.up,o),Object(T.m)(h.frame.right,s),r=h;for(var f=1;f<n;++f){h=e.vertices[f],Object(T.h)(l,h.vLeft,h.vRight);var p=Object(T.r)(l);p>0?(p=1/Math.sqrt(p),l[0]=l[0]*p,l[1]=l[1]*p,l[2]=l[2]*p):(l[0]=h.vRight[0],l[1]=h.vRight[1],l[2]=h.vRight[2]),Object(T.h)(u,r.pos,r.frame.up),Object(Cn.h)(h.pos,l,d),Object(Cn.m)(d,Object(Mn.g)(u,h.vLeft),c)?(Object(T.l)(c,c,h.pos),Object(T.t)(o,c),Object(T.i)(s,l,o),Object(T.t)(s,s)):mt.a.makeOrthoBasisDirUpFallback(l,r.frame.up,r.frame.right,a,s,o,i),Object(T.m)(h.frame.up,o),Object(T.m)(h.frame.right,s),r=h}}(e,Li);var s,c=Object(n.a)(e.vertices);try{for(c.s();!(s=c.n()).done;){var l=s.value,u=Object($e.t)(Object(T.j)(l.frame.right,l.vRight));Object(T.i)(l.rotationFrame.up,l.vRight,l.vLeft),Object(T.g)(l.rotationFrame.up,l.rotationFrame.up,u),Object(T.t)(l.rotationFrame.up,l.rotationFrame.up);var d=Object(T.j)(l.rotationFrame.up,l.frame.up),h=Object(T.j)(l.rotationFrame.up,l.frame.right);if(Object(T.g)(zi,l.frame.up,-h),Object(T.g)(Vi,l.frame.right,d),Object(T.h)(zi,zi,Vi),Object(T.t)(l.rotationFrame.right,zi),En(l.rotationRight,l.frame,l.rotationFrame.right),Object(T.u)(zi,l.vLeft),l.rotationAngle=-u*(Math.PI-Object($e.b)(Object(T.j)(zi,l.vRight))),Math.abs(l.rotationAngle)>0){var f=Object($e.s)(Math.cos(.5*l.rotationAngle));yn(l.miterStretch,1+(f-1)*l.rotationRight[0]*l.rotationRight[0],(f-1)*l.rotationRight[0]*l.rotationRight[1],(f-1)*l.rotationRight[0]*l.rotationRight[1],1+(f-1)*l.rotationRight[1]*l.rotationRight[1])}var p=Math.PI-l.rotationAngle;l.maxStretchDistance=Math.abs(Math.min(l.vLeftLength,l.vRightLength)*Object($e.s)(Math.cos(.5*p)))}}catch(b){c.e(b)}finally{c.f()}}}function Ii(e,t,r){switch(e){case"symbol-value":return r;case"proportional":return t;default:return e}}function Di(e,t,r,i){var a,o=0,s=Object(n.a)(e.vertices);try{for(s.s();!(a=s.n()).done;){var c=a.value,l=Object(I.e)(c.posES,r,t,i,Gi);o+=Gi.sampledElevation,Object(T.h)(Li,c.pos,e.offset),i.setAltitude(Li,l),Object(T.l)(c.pos,Li,e.offset)}}catch(u){s.e(u)}finally{s.f()}return e.updatePathVertexInformation(),o/e.vertices.length}function Fi(e,t,r,n){var i=e.stageObject,a=i.geometryRecords,o=a.length,s=0;n.spatialReference;for(var c=0;c<o;c++){var l=a[c].geometry;if(Sn(l)){var u=l.path,d=u.builder.path;l.geometrySR,s+=Di(d,t,r,n),"world"!==l.upVectorAlignment&&Ri(d,l.upVectorAlignment,n),u.onPathChanged(),l.invalidateBoundingInfo(),i.geometryVertexAttrsUpdated(c)}}return s/o}var Li=Object(C.e)(),zi=Object(xn.c)(),Vi=Object(xn.c)(),Ni=3,Ui=3,Bi=10,Gi={verticalDistanceToGround:0,sampledElevation:0},qi=r(68);function Hi(e,t,r,n){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1;Object(T.y)(Xi,1,0,0),Object(T.y)(Yi,0,1,0),Object(T.y)($i,0,0,1),ua(Wi,t),ia(t,Zi)&&aa(Zi,Xi,Yi,$i,r,Wi),Object(wn.r)(Ji,Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY),Object(wn.r)(Ki,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY);for(var a=0;a<t.count;a++){t.getVec(a,Qi);var o=Object(T.j)(Xi,Qi),s=Object(T.j)(Yi,Qi);Ji[0]=Math.min(Ji[0],o),Ji[1]=Math.min(Ji[1],s),Ki[0]=Math.max(Ki[0],o),Ki[1]=Math.max(Ki[1],s)}var c=Object(T.j)($i,Wi);ha(ta,Ji[0],Ji[1],c,Xi,Yi,$i),ha(ra,Ki[0],Ji[1],c,Xi,Yi,$i),ha(na,Ji[0],Ki[1],c,Xi,Yi,$i),Object(T.l)(ra,ra,ta),Object(T.g)(ra,ra,.5),Object(T.l)(na,na,ta),Object(T.g)(na,na,.5),Object(T.h)(ta,ta,ra),Object(T.h)(ta,ta,na);var l=Ji[0]%i,u=Ji[1]%i;ea[0]=Ji[0]-l,ea[1]=Ji[1]-u;for(var d=0;d<t.count;d++){t.getVec(d,Qi),e.setValues(d,(Object(T.j)(Xi,Qi)-ea[0])/i,(Object(T.j)(Yi,Qi)-ea[1])/i,ea[0]/i,ea[1]/i);for(var h=0;h<3;h++)n.set(d,h,ta[h]),n.set(d,h+3,ra[h]),n.set(d,h+6,na[h])}}var Wi=Object(C.e)(),Qi=Object(C.e)(),Zi=Object(Cn.d)(),Xi=Object(C.e)(),Yi=Object(C.e)(),$i=Object(C.e)(),Ji=Object(ke.b)(),Ki=Object(ke.b)(),ea=Object(ke.b)(),ta=Object(C.e)(),ra=Object(C.e)(),na=Object(C.e)();function ia(e,t){var r=e.count-1;return Object(Cn.e)(e,t,0,Math.floor(r/3),Math.floor(r*(2/3)))}function aa(e,t,r,n,i,a){Object(f.j)(i)?(i.basisMatrixAtPosition(a,oa),Object(T.y)(sa,oa[0],oa[1],oa[2]),Object(T.y)(ca,oa[4],oa[5],oa[6]),Object(T.y)(la,oa[8],oa[9],oa[10])):(Object(T.y)(sa,1,0,0),Object(T.y)(ca,0,1,0),Object(T.y)(la,0,0,1));var o=Object(Cn.s)(e);Object(T.j)(o,la)<0&&Object(T.g)(o,o,-1),Object(T.m)(n,o);var s=Object(T.j)(o,ca),c=Object(T.j)(o,sa);Math.abs(s)<Math.abs(c)?(Object(T.f)(t,sa,o,-c),Object(T.t)(t,t),Object(T.i)(r,t,o),Object(T.t)(r,r),Object(T.g)(r,r,-1)):(Object(T.f)(r,ca,o,-s),Object(T.t)(r,r),Object(T.i)(t,r,o),Object(T.t)(t,t))}var oa=Object(S.d)(),sa=Object(C.e)(),ca=Object(C.e)(),la=Object(C.e)();function ua(e,t){Object(T.y)(da,0,0,0);for(var r=0;r<t.count-1;r++)t.getVec(r,Qi),Object(T.h)(da,da,Qi);Object(T.g)(e,da,1/(t.count-1))}var da=Object(C.e)();function ha(e,t,r,n,i,a,o){Object(T.y)(e,t*i[0]+r*a[0]+n*o[0],t*i[1]+r*a[1]+n*o[1],t*i[2]+r*a[2]+n*o[2])}var fa=r(555),pa=r(246),ba=r(622),va=function(e){Object(u.a)(r,e);var t=Object(d.a)(r);function r(){return Object(c.a)(this,r),t.apply(this,arguments)}return Object(l.a)(r,[{key:"initializeProgram",value:function(e){var t=r.shader.get(),n=this.configuration,i=t.build({output:n.output,attributeColor:n.vertexColors,slicePlaneEnabled:n.slicePlaneEnabled,sliceHighlightDisabled:!1,sliceEnabledForVertexPrograms:!1,style:n.style,patternSpacing:n.patternSpacing,lineWidth:n.lineWidth,draped:n.draped,OITEnabled:0===n.transparencyPassType,multipassTerrainEnabled:n.multipassTerrainEnabled,cullAboveGround:n.cullAboveGround});return new mi.a(e.rctx,i,ga)}},{key:"bindPass",value:function(e,t){Object(hi.c)(this.program,t.camera.projectionMatrix),this.program.setUniform4fv("matColor",e.color),this.configuration.draped?(this.program.setUniform1f("worldToScreenRatio",1/t.screenToWorldRatioGlobalWM),this.program.setUniform1f("texelSize",1/t.camera.pixelRatio)):this.program.setUniform1f("worldToScreenPerDistanceRatio",1/t.camera.perScreenPixelRatio),4===this.configuration.output&&Object(wr.b)(this.program,t),(1===this.configuration.output||t.multipassTerrainEnabled)&&this.program.setUniform2fv("cameraNearFar",t.camera.nearFar),t.multipassTerrainEnabled&&(this.program.setUniform2fv("inverseViewport",t.inverseViewport),Object(ui.a)(this.program,t))}},{key:"bindDraw",value:function(e){Object(hi.d)(this.program,e),Object(hi.a)(this.program,e.origin,e.camera.viewInverseTransposeMatrix),Object(si.c)(this.program,this.configuration,e),this.program.rebindTextures()}},{key:"setPipelineState",value:function(e,t){var r=this.configuration,n=3===e,i=2===e;return Object(Oi.g)({blending:0===r.output||7===r.output?r.transparent&&n?vi.f:Object(vi.a)(e):null,culling:Object(Oi.c)(r.cullFace),depthTest:{func:Object(vi.b)(e)},depthWrite:n?r.writeDepth&&Oi.e:Object(vi.c)(e),colorWrite:Oi.d,stencilWrite:r.sceneHasOcludees?yi.j:null,stencilTest:r.sceneHasOcludees?t?yi.f:yi.e:null,polygonOffset:n||i?r.polygonOffset&&ma:Object(vi.g)(r.enableOffset)})}},{key:"initializePipeline",value:function(){return this._occludeePipelineState=this.setPipelineState(this.configuration.transparencyPassType,!0),this.setPipelineState(this.configuration.transparencyPassType,!1)}},{key:"getPipelineState",value:function(e){return e?this._occludeePipelineState:this.pipeline}}]),r}(pi.a);va.shader=new fi.a(ba.a,(function(){return r.e(205).then(r.bind(null,1069))}));var ma={factor:1,units:1},ya=function(e){Object(u.a)(r,e);var t=Object(d.a)(r);function r(){var e;return Object(c.a)(this,r),(e=t.apply(this,arguments)).output=0,e.cullFace=0,e.slicePlaneEnabled=!1,e.vertexColors=!1,e.transparent=!0,e.polygonOffset=!1,e.writeDepth=!0,e.sceneHasOcludees=!1,e.enableOffset=!0,e.transparencyPassType=3,e.multipassTerrainEnabled=!1,e.cullAboveGround=!1,e}return r}(bi.a);Object(oi.a)([Object(bi.b)({count:8})],ya.prototype,"output",void 0),Object(oi.a)([Object(bi.b)({count:3})],ya.prototype,"cullFace",void 0),Object(oi.a)([Object(bi.b)()],ya.prototype,"slicePlaneEnabled",void 0),Object(oi.a)([Object(bi.b)()],ya.prototype,"vertexColors",void 0),Object(oi.a)([Object(bi.b)()],ya.prototype,"transparent",void 0),Object(oi.a)([Object(bi.b)()],ya.prototype,"polygonOffset",void 0),Object(oi.a)([Object(bi.b)()],ya.prototype,"writeDepth",void 0),Object(oi.a)([Object(bi.b)()],ya.prototype,"sceneHasOcludees",void 0),Object(oi.a)([Object(bi.b)({count:6})],ya.prototype,"style",void 0),Object(oi.a)([Object(bi.b)()],ya.prototype,"patternSpacing",void 0),Object(oi.a)([Object(bi.b)()],ya.prototype,"lineWidth",void 0),Object(oi.a)([Object(bi.b)()],ya.prototype,"enableOffset",void 0),Object(oi.a)([Object(bi.b)()],ya.prototype,"draped",void 0),Object(oi.a)([Object(bi.b)({count:4})],ya.prototype,"transparencyPassType",void 0),Object(oi.a)([Object(bi.b)()],ya.prototype,"multipassTerrainEnabled",void 0),Object(oi.a)([Object(bi.b)()],ya.prototype,"cullAboveGround",void 0);var ga=new Map([["position",0],["color",3],["uvMapSpace",4],["boundingRect",5]]),Oa=function(e){Object(u.a)(r,e);var t=Object(d.a)(r);function r(e){var n;return Object(c.a)(this,r),(n=t.call(this,e,wa)).supportsEdges=!0,n._vertexAttributeLocations=ga,n.techniqueConfig=new ya,n}return Object(l.a)(r,[{key:"getTechniqueConfig",value:function(e,t){return this.techniqueConfig.output=e,this.techniqueConfig.cullFace=this.params.cullFace,this.techniqueConfig.vertexColors=this.params.vertexColors,this.techniqueConfig.slicePlaneEnabled=this.params.slicePlaneEnabled,this.techniqueConfig.polygonOffset=this.params.polygonOffset,this.techniqueConfig.writeDepth=this.params.writeDepth,this.techniqueConfig.style=this.params.style,this.techniqueConfig.patternSpacing=this.params.patternSpacing,this.techniqueConfig.lineWidth=this.params.lineWidth,this.techniqueConfig.draped=this.params.draped,this.techniqueConfig.transparencyPassType=t?t.transparencyPassType:3,this.techniqueConfig.enableOffset=!t||t.camera.relativeElevation<vi.e,this.techniqueConfig.multipassTerrainEnabled=!!t&&t.multipassTerrainEnabled,this.techniqueConfig.cullAboveGround=!!t&&t.cullAboveGround,this.techniqueConfig}},{key:"getPassParameters",value:function(){return this.params}},{key:"intersect",value:function(e,t,r,n,i,a,o){Object(Kr.i)(e,t,n,i,a,void 0,o)}},{key:"getGLMaterial",value:function(e){return 0===e.output||7===e.output||4===e.output||1===e.output&&this.params.writeLinearDepth?new ja(e):void 0}},{key:"createBufferWriter",value:function(){var e=Object(Cr.a)().vec3f("position").vec4u8("color").vec4f("uvMapSpace");return this.params.draped||e.mat3f("boundingRect"),new _a(e)}}]),r}(ai.a),ja=function(e){Object(u.a)(r,e);var t=Object(d.a)(r);function r(e){var n;return Object(c.a)(this,r),(n=t.call(this,e)).updateParameters(),n}return Object(l.a)(r,[{key:"updateParameters",value:function(e){this._technique=this._techniqueRep.releaseAndAcquire(va,this._material.getTechniqueConfig(this._output,e),this._technique)}},{key:"beginSlot",value:function(e){return 4===this._output?3===e:e===(this._technique.configuration.transparent?this._technique.configuration.writeDepth?5:8:3)}},{key:"_updateOccludeeState",value:function(e){e.hasOccludees!==this._material.params.sceneHasOcludees&&this._material.setParameterValues({sceneHasOcludees:e.hasOccludees})}},{key:"ensureParameters",value:function(e){0!==this._output&&7!==this._output||this._updateOccludeeState(e),this.updateParameters(e)}},{key:"bind",value:function(e){this._technique.bindPass(this._material.getPassParameters(),e)}},{key:"getPipelineState",value:function(e,t){return this._technique.getPipelineState(t)}}]),r}(ii.a),_a=function(e){Object(u.a)(r,e);var t=Object(d.a)(r);function r(){return Object(c.a)(this,r),t.apply(this,arguments)}return Object(l.a)(r,[{key:"write",value:function(e,t,r,i){var a,o=Object(n.a)(this.vertexBufferLayout.fieldNames);try{for(o.s();!(a=o.n()).done;){var s=a.value,c=t.vertexAttributes.get(s),l=t.indices.get(s);if(c&&l)switch(s){case"position":Object(Ue.a)(3===c.size);var u=r.getField(s,A.u);u&&Object(ki.e)(l,c.data,e.transformation,u,i);break;case"color":Object(Ue.a)(3===c.size||4===c.size);var d=r.getField(s,A.J);d&&Object(ki.b)(l,c.data,c.size,d,i);break;case"uvMapSpace":Object(Ue.a)(4===c.size);var h=r.getField(s,A.C);h&&Object(ki.a)(l,c.data,h,i);break;case"boundingRect":Object(Ue.a)(9===c.size);var f=r.getField(s,A.f);f&&this.writeBoundingRect(l,c.data,e.transformation,f,i)}}}catch(p){o.e(p)}finally{o.f()}}},{key:"writeBoundingRect",value:function(e,t,r,n,i){var a=r,o=n.typedBuffer,s=n.typedBufferStride,c=e.length;i*=s;for(var l=0;l<c;++l){var u=9*e[l],d=t[u],h=t[u+1],f=t[u+2];o[i]=a[0]*d+a[4]*h+a[8]*f+a[12],o[i+1]=a[1]*d+a[5]*h+a[9]*f+a[13],o[i+2]=a[2]*d+a[6]*h+a[10]*f+a[14];for(var p=3;p<9;++p)o[i+p]=t[u+p];i+=s}}}]),r}(pa.a),wa=Object(y.a)({color:[1,1,1,1],writeDepth:!0,writeLinearDepth:!1,vertexColors:!1,polygonOffset:!1,slicePlaneEnabled:!1,cullFace:0,sceneHasOcludees:!1,style:2,patternSpacing:10,lineWidth:1,draped:!0},ai.b);function xa(e,t,r){return function(e,t,r){return Object(f.j)(e)?"none"===e.style||"solid"===e.style?("none"===e.style&&(t.color=Object(Te.g)(0,0,0,0),t.transparent=!0),new fa.a(t)):(t.style=function(e){switch(e){case"horizontal":return 0;case"vertical":return 1;case"cross":return 2;case"forward-diagonal":return 3;case"backward-diagonal":return 4;case"diagonal-cross":return 5;default:return}}(e.style),t.draped=r.isDraped,new Oa(t)):new fa.a(t)}(function(e){return e&&e.pattern||null}(e),t,r)}function ka(e,t){if(function(e){return e.material instanceof Oa&&!e.material.params.draped}(e)){var r=e.geometry.vertexAttributes,n=r.get("position").data,i=r.get("uvMapSpace").data,a=r.get("boundingRect").data;Hi(A.C.fromTypedArray(i),A.v.fromTypedArray(n),t,A.g.fromTypedArray(a))}}function Sa(e,t,r,n){for(var i=Object(Re.c)(e,t,r,n),a=e.stageObject.geometryRecords,o=0;o<a.length;o++)ka(a[o],n);return i}var Ta=["polyline","polygon","extent"],Ca=function(e){Object(u.a)(r,e);var t=Object(d.a)(r);function r(e,n,i,a){var o;return Object(c.a)(this,r),(o=t.call(this,e,n,i,a))._needsUV=!1,o._hasOutline=!1,o}return Object(l.a)(r,[{key:"doLoad",value:function(){var e=Object(s.a)(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"ensureMaterials",value:function(){this.ensureFillMaterial(),this.ensureOutlineMaterial()}},{key:"ensureFillMaterial",value:function(){if(!Object(f.j)(this._material)){var e=Object(f.h)(this.symbolLayer,"material","color"),t=this._getCombinedOpacityAndColor(e);this._material=xa(this.symbolLayer,{color:t,transparent:t[3]<1||this.needsDrivenTransparentPass,polygonOffset:!1,vertexColors:!0,writeLinearDepth:!0,slicePlaneEnabled:this._context.slicePlaneEnabled},{isDraped:this.draped}),this._needsUV=this._material instanceof Oa,this._context.stage.add(this._material)}}},{key:"ensureOutlineMaterial",value:function(){var e=this,t=this.symbolLayer.outline;if(!Object(f.j)(this._outlineMaterial)&&this._isValidOutline(t)){this._hasOutline=!0;this._outlineMaterial=function(r){var n=t.stipplePattern?Object(Rt.a)(t.stipplePattern.map(we.g)):null,i=t.stippleOffColor?je.a.toUnitRGBA(t.stippleOffColor):null;return r>1.5?new It.a({width:r,color:e._getOutlineColor(),polygonOffset:!0,slicePlaneEnabled:e._context.slicePlaneEnabled,isClosed:!0,stipplePattern:n,stippleIntegerRepeats:!0,stippleOffColor:i}):new Gt.a({color:e._getOutlineColor(),slicePlaneEnabled:e._context.slicePlaneEnabled,width:r,stipplePattern:n,stippleIntegerRepeats:!0,stippleOffColor:i})}(Object(we.g)(t.size)),this._context.stage.add(this._outlineMaterial)}}},{key:"_isValidOutline",value:function(e){return Object(f.j)(e)&&e.size&&e.size>0&&Object(f.j)(e.color)}},{key:"destroy",value:function(){Object(g.a)(Object(O.a)(r.prototype),"destroy",this).call(this),this._context.stage.remove(this._material),this._material=null,this._context.stage.remove(this._outlineMaterial),this._outlineMaterial=null}},{key:"createGraphics3DGraphic",value:function(e){var t=e.graphic;if(!this._validateGeometry(t.geometry,Ta,this.symbolLayer.type))return null;var r=this._getVertexOpacityAndColor(e.renderingInfo,255),n=this.setGraphicElevationContext(t,new D.a);return this.ensureDrapedStatus("on-the-ground"===n.mode),this.ensureMaterials(),this.draped?this._createAsOverlay(t,r):this._createAs3DShape(t,r,n)}},{key:"layerOpacityChanged",value:function(){if(Object(f.j)(this._material)){var e=this._material.params.color,t=Object(f.h)(this.symbolLayer,"material","color"),r=this._getCombinedOpacity(t);this._material.setParameterValues({color:[e[0],e[1],e[2],r],transparent:r<1||this.needsDrivenTransparentPass})}if(Object(f.j)(this._outlineMaterial)){var n=this._outlineMaterial.params.color;this._outlineMaterial.setParameterValues({color:[n[0],n[1],n[2],this._getOutlineOpacity()]})}return!0}},{key:"layerElevationInfoChanged",value:function(e,t,n){var i=this._elevationContext.mode,a=Object(I.d)(r.elevationModeChangeTypes,n,i);if(a!==I.a.UPDATE)return a;var o=Object(I.f)(i);return this.updateGraphics3DGraphicElevationInfo(e,t,(function(){return o}))}},{key:"slicePlaneEnabledChanged",value:function(){if(Object(f.j)(this._material)&&this._material.setParameterValues({slicePlaneEnabled:this._context.slicePlaneEnabled}),Object(f.j)(this._outlineMaterial)){var e={slicePlaneEnabled:this._context.slicePlaneEnabled};this._outlineMaterial.setParameterValues(e)}return!0}},{key:"physicalBasedRenderingChanged",value:function(){return!0}},{key:"pixelRatioChanged",value:function(){return!0}},{key:"_createAs3DShape",value:function(e,t,r){var n=H(e.geometry);if(Object(f.i)(n))return null;Pa.renderData=W(n,this._context.elevationProvider,this._context.renderCoordsHelper,r),Pa.color=t;var i=Pa.renderData.position.length/3;if(this._needsUV&&(Pa.uvMapSpace=new Float32Array(4*i),Pa.boundingRect=new Float64Array(9*i)),Pa.outNum=0,Pa.outGeometries=[],Pa.outTransforms=[],Pa.outMaterials=[],this._createAs3DShapeFill(Pa),this._hasOutline&&this._createAs3DShapeOutline(Pa),this._logGeometryCreationWarnings(Pa.renderData,n.rings,"rings","FillSymbol3DLayer"),0===Pa.outNum)return null;this._needsUV&&Hi(A.C.fromTypedArray(Pa.uvMapSpace),A.v.fromTypedArray(Pa.renderData.position),this._context.renderCoordsHelper,A.g.fromTypedArray(Pa.boundingRect));var a=new K.a({geometries:Pa.outGeometries,materials:Pa.outMaterials,transformations:Pa.outTransforms,castShadow:!1,metadata:{layerUid:this._context.layer.uid,graphicUid:e.uid}}),o=Sa,s=new v.a(this,a,Pa.outGeometries,null,null,o,r);return s.alignedSampledElevation=Pa.renderData.sampledElevation,s.needsElevationUpdates=Object(I.f)(r.mode),s}},{key:"_createAs3DShapeFill",value:function(e){var t,r=e.renderData.polygons,i=Object(n.a)(r);try{for(i.s();!(t=i.n()).done;){var a=t.value,o=a.position,s=a.mapPosition,c=a.holeIndices,l=a.index,u=a.count;if(!Object(f.j)(this._context.clippingExtent)||(Object(P.k)(Ma),Object(P.n)(Ma,s),Object(P.w)(Ma,this._context.clippingExtent))){var d=Object(_.a)(s,c,3);if(0!==d.length){var h=G({indices:new Uint32Array(d),attributeData:{position:o,color:e.color,mapPosition:s,uvMapSpace:this._needsUV?new Float32Array(e.uvMapSpace.buffer,4*l*e.uvMapSpace.BYTES_PER_ELEMENT,4*u):null,boundingRect:this._needsUV?new Float64Array(e.boundingRect.buffer,9*l*e.boundingRect.BYTES_PER_ELEMENT,9*u):null}});e.outGeometries.push(h),e.outMaterials.push(Object(f.s)(this._material)),e.outTransforms.push(S.a),e.outNum++}}}}catch(p){i.e(p)}finally{i.f()}}},{key:"_createAs3DShapeOutline",value:function(e){if(this._hasOutline)for(var t=e.renderData.outlines,r=this._outlineMaterial instanceof Gt.a,n=0;n<t.length;++n){var i=t[n],a=i.mapPosition,o=i.position;if(!Object(f.j)(this._context.clippingExtent)||(Object(P.k)(Ma),Object(P.n)(Ma,a),Object(P.w)(Ma,this._context.clippingExtent))){var s=Object(Et.a)({removeDuplicateStartEnd:r?0:1,attributeData:{position:o,mapPosition:a}}),c=s.vertexAttributes.get("position");c.data===o&&(c.data=new Float64Array(o)),e.outGeometries.push(s),e.outMaterials.push(Object(f.s)(this._outlineMaterial)),e.outTransforms.push(S.a),e.outNum++}}}},{key:"_createAsOverlay",value:function(e,t){var r=H(e.geometry);if(Object(f.i)(r))return null;Object(f.s)(this._material).renderPriority=this._renderPriority+this._renderPriorityStep/2,Object(f.j)(this._outlineMaterial)&&(this._outlineMaterial.renderPriority=this._renderPriority),Aa.renderData=Q(r,this._context.overlaySR),Aa.color=t;var n=Aa.renderData.position.length/3;return this._needsUV&&(Aa.uvMapSpace=new Float32Array(4*n)),Aa.outNum=0,Aa.outGeometries=[],Aa.outBoundingBox=Object(P.k)(),Aa.layerUid=this._context.layer.uid,Aa.graphicsUid=e.uid,this._createAsOverlayFill(Aa),this._hasOutline&&this._createAsOverlayOutline(Aa),this._logGeometryCreationWarnings(Aa.renderData,r.rings,"rings","FillSymbol3DLayer"),0===Aa.outNum?null:(this._needsUV&&function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;if(r.isGeographic){for(var i=new Float64Array(t.typedBuffer.length),a=3*t.count,o=0;o<a;o+=3)Object(M.m)(t.typedBuffer,o,i,o,Object(qi.e)(r));t=A.v.fromTypedArray(i)}Object(wn.r)(Ji,Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY);for(var s=0;s<t.count;s++)t.getVec(s,Qi),Ji[0]=Math.min(Ji[0],Qi[0]),Ji[1]=Math.min(Ji[1],Qi[1]);var c=Ji[0]%n,l=Ji[1]%n;ea[0]=Ji[0]-c,ea[1]=Ji[1]-l;for(var u=0;u<t.count;u++)t.getVec(u,Qi),e.setValues(u,(Qi[0]-ea[0])/n,(Qi[1]-ea[1])/n,ea[0]/n,ea[1]/n)}(A.C.fromTypedArray(Aa.uvMapSpace),A.v.fromTypedArray(Aa.renderData.position),this._context.overlaySR),Aa.outNum>0?new Ve(this,Aa.outGeometries,Aa.outBoundingBox):null)}},{key:"_createAsOverlayFill",value:function(e){var t,r=e.renderData.polygons,i=Object(n.a)(r);try{for(i.s();!(t=i.n()).done;){var a=t.value,o=a.position,s=a.holeIndices,c=a.index,l=a.count;if(Object(P.k)(Ma),Object(P.n)(Ma,o),Object(P.w)(Ma,this._context.clippingExtent)){var u=Object(_.a)(o,s,3);if(0!==u.length){Object(P.m)(e.outBoundingBox,Ma);var d=G({indices:new Uint32Array(u),attributeData:{position:o,color:e.color,uvMapSpace:this._needsUV?new Float32Array(e.uvMapSpace.buffer,4*c*e.uvMapSpace.BYTES_PER_ELEMENT,4*l):null}}),h=new yt.a(d,Object(f.s)(this._material),e.layerUid,e.graphicsUid),p=Ma;Object(Se.l)(h.boundingSphere,.5*(p[0]+p[3]),.5*(p[1]+p[4]),0,.5*Math.sqrt((p[3]-p[0])*(p[3]-p[0])+(p[4]-p[1])*(p[4]-p[1]))),e.outGeometries.push(h),e.outNum++}}}}catch(b){i.e(b)}finally{i.f()}}},{key:"_createAsOverlayOutline",value:function(e){if(this._hasOutline)for(var t=e.renderData.outlines,r=0;r<t.length;++r){var n=t[r].position;if(Object(P.k)(Ma),Object(P.n)(Ma,n),Object(P.w)(Ma,this._context.clippingExtent)){Object(P.m)(e.outBoundingBox,Ma);var i=this._outlineMaterial instanceof Gt.a,a=Object(Et.a)({removeDuplicateStartEnd:i?0:1,attributeData:{position:n}}),o=new yt.a(a,Object(f.s)(this._outlineMaterial),e.layerUid,e.graphicsUid),s=Ma;Object(Se.l)(o.boundingSphere,.5*(s[0]+s[3]),.5*(s[1]+s[4]),0,.5*Math.sqrt((s[3]-s[0])*(s[3]-s[0])+(s[4]-s[1])*(s[4]-s[1]))),e.outGeometries.push(o),e.outNum++}}}},{key:"_getOutlineOpacity",value:function(){var e=Object(f.h)(this.symbolLayer,"outline","color");return(this.draped?1:this._getLayerOpacity())*(Object(f.j)(e)?e.a:0)}},{key:"_getOutlineColor",value:function(){var e=Object(f.h)(this.symbolLayer,"outline","color"),t=this._getOutlineOpacity();return Object(L.g)(Object(f.j)(e)?je.a.toUnitRGB(e):null,t)}},{key:"test",get:function(){var e=this;return{createAsOverlay:function(t,r){return e._createAsOverlay(t,r)},createAs3DShape:function(t,r,n){return e._createAs3DShape(t,r,n)}}}}]),r}(F.a);Ca.elevationModeChangeTypes={definedChanged:I.a.RECREATE,staysOnTheGround:I.a.NONE,onTheGroundChanged:I.a.RECREATE};var Ma=Object(P.h)(),Pa={renderData:null,color:null,uvMapSpace:null,boundingRect:null,outNum:0,outBoundingBox:null,outGeometries:null,outMaterials:null,outTransforms:null},Aa={renderData:null,color:null,uvMapSpace:null,outNum:0,outBoundingBox:null,outGeometries:null,outMaterials:null,outTransforms:null},Ea=r(229),Ra=r(537),Ia=r(247),Da=r(445),Fa=r(60),La=r(157),za=function(e){Object(u.a)(r,e);var t=Object(d.a)(r);function r(e,n,i){var a;return Object(c.a)(this,r),(a=t.call(this)).type=4,a._glTexture=null,a.events=new Sr.a,a._requiresPowerOfTwo=!Object(La.a)(e.gl),a._renderer=new Da.a(n,i),a}return Object(l.a)(r,[{key:"width",get:function(){return this._renderer.renderedWidth}},{key:"height",get:function(){return this._renderer.renderedHeight}},{key:"textureWidth",get:function(){var e=this.width;return this._requiresPowerOfTwo?Object($e.p)(e):e}},{key:"textureHeight",get:function(){var e=this.height;return this._requiresPowerOfTwo?Object($e.p)(e):e}},{key:"displayWidth",get:function(){return this._renderer.displayWidth}},{key:"displayHeight",get:function(){return this._renderer.displayHeight}},{key:"texcoordScale",get:function(){return[this._renderer.renderedWidth/this.textureWidth,this._renderer.renderedHeight/this.textureHeight]}},{key:"requiresFrameUpdates",get:function(){return!1}},{key:"createDescriptor",value:function(e){return{target:3553,pixelFormat:6408,dataType:5121,wrapMode:33071,flipped:!0,samplingMode:9987,hasMipmap:!0,preMultiplyAlpha:!0,maxAnisotropy:e.parameters.maxMaxAnisotropy}}},{key:"load",value:function(e){if(Object(f.j)(this._glTexture))return this._glTexture;var t=Object(Da.b)(Va,this.textureWidth,this.textureHeight),r=t.getContext("2d");return r.save(),this._renderer.render(r,0,this.textureHeight-this._renderer.renderedHeight),this._glTexture=new Fa.a(e,this.createDescriptor(e),t),r.restore(),this._glTexture}},{key:"unload",value:function(){Object(f.j)(this._glTexture)&&(this._glTexture.dispose(),this._glTexture=null),this.events.emit("unloaded")}}]),r}(Ia.a),Va={canvas:null},Na=za,Ua=[0,0,1],Ba=function(e){Object(u.a)(r,e);var t=Object(d.a)(r);function r(e,n,i,a){var o;return Object(c.a)(this,r),(o=t.call(this,e,n,i,a))._elevationOptions={supportsOffsetAdjustment:!0,supportsOnTheGround:!1},o.ensureDrapedStatus(!1),o}return Object(l.a)(r,[{key:"doLoad",value:function(){var e=Object(s.a)(o.a.mark((function e(){var t;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._drivenProperties.size){e.next=4;break}if(!(t=Object(L.k)(this.symbolLayer.size))){e.next=4;break}throw new j.a("graphics3dtextsymbollayer:invalid-size",t);case 4:this._createTextRenderParameters();case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"_createTextRenderParameters",value:function(){var e=this._context.layerView.view.pixelRatio;this._textRenderParameters=Ra.a.fromSymbol(this.symbolLayer,e)}},{key:"destroy",value:function(){Object(g.a)(Object(O.a)(r.prototype),"destroy",this).call(this)}},{key:"createGraphics3DGraphic",value:function(e){var t=e.graphic,r=Object(Ne.c)(t.geometry);if(Object(f.i)(r))return this.logger.warn("unsupported geometry type for text symbol: ".concat(t.geometry.type)),null;var n=this.symbolLayer.text;if(!n)return null;var i=Object(Ea.d)(this.symbol)&&this.symbol.hasVisibleVerticalOffset()?this.symbol:null;return this._createAs3DShape(t,r,n,i)}},{key:"createLabel",value:function(e,t,r,n){var i=e.graphic,a=Object(Ne.c)(i.geometry);if(Object(f.i)(a))return this.logger.warn("unsupported geometry type for label: ".concat(i.geometry.type)),null;var o=t.text;return!o||/^\s+$/.test(o)?null:this._createAs3DShape(i,a,o,t,t,r,n)}},{key:"setGraphicElevationContext",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=Object(g.a)(Object(O.a)(r.prototype),"setGraphicElevationContext",this).call(this,e,t);return i.addOffsetRenderUnits(n),i}},{key:"layerOpacityChanged",value:function(){return this.logger.warn("layer opacity change not yet implemented in Graphics3DTextSymbolLayer"),!1}},{key:"layerElevationInfoChanged",value:function(e,t){var r=this;return Ga(e,t,(function(e,t){r.updateGraphicElevationContext(t,e)})),I.a.UPDATE}},{key:"slicePlaneEnabledChanged",value:function(e,t){var r=this;return Ga(e,t,(function(e){var t,i=Object(n.a)(e.stageObject.geometryRecords);try{for(i.s();!(t=i.n()).done;){t.value.material.setParameterValues({slicePlaneEnabled:r._context.slicePlaneEnabled})}}catch(a){i.e(a)}finally{i.f()}})),!0}},{key:"physicalBasedRenderingChanged",value:function(){return!0}},{key:"pixelRatioChanged",value:function(){return!1}},{key:"updateGraphicElevationContext",value:function(e,t){this.setGraphicElevationContext(e,t.elevationContext,t.metadata.elevationOffset),t.needsElevationUpdates=Object(I.f)(t.elevationContext.mode)||"absolute-height"===t.elevationContext.mode}},{key:"_defaultElevationInfoNoZ",value:function(){return qa}},{key:"_createAs3DShape",value:function(e,t,r,n){var i,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Ha,o=arguments.length>5?arguments[5]:void 0,s=arguments.length>6?arguments[6]:void 0,c=this.setGraphicElevationContext(e,new D.a,a.elevationOffset),l="polyline"===Object(f.h)(e.geometry,"type"),u=e.uid,d=this._context.stage.renderView.renderingContext,h=a.anchor in L.h?a.anchor:"center",p=L.h[h],b=Object(f.i)(s)?new Na(d,r,this._textRenderParameters):null,m={occlusionTest:!0,screenOffset:a.screenOffset,anchorPos:p,polygonOffset:!0,color:[1,1,1,1],centerOffsetUnits:a.centerOffsetUnits,debugDrawBorder:a.debugDrawBorder,drawInSecondSlot:!0};if(Object(f.j)(b)&&(m.textureId=b.id,m.texCoordScale=b.texcoordScale),Object(f.j)(s)&&(m.textureId=s.id),Object(f.j)(n)&&Object(f.j)(n.verticalOffset)){var y=n.verticalOffset,g=y.screenLength,O=y.minWorldLength,j=y.maxWorldLength;m.verticalOffset={screenLength:Object(we.g)(g),minWorldLength:O||0,maxWorldLength:null!=j?j:1/0}}if(this._context.screenSizePerspectiveEnabled){var _=this._context.sharedResources,w=_.screenSizePerspectiveSettings,x=_.screenSizePerspectiveSettingsLabels;m.screenSizePerspective=x.overridePadding(this._textRenderParameters.haloSize),m.screenSizePerspectiveAlignment=w}if(l&&(m.shaderPolygonOffset=1e-4),m.slicePlaneEnabled=this._context.slicePlaneEnabled,Object(f.j)(o)){var k=JSON.stringify(m);i=o.get(k),Object(f.i)(i)&&(i=new Ot.a(m),o.add(k,i))}else i=new Ot.a(m);var S=[i],T=a.translation,C=Object(f.j)(b)?[b.displayWidth,b.displayHeight]:[0,0],M=a.centerOffset,P=Ua,A=[0,0],E=[mt.a.createPointGeometry(P,T,null,C,M,A,null)],R=this._context.layer.uid,F=Object(Ne.a)(this._context,t,E,S,null,null,c,R,u);if(null===F)return null;var z=Re.b,V=new v.a(this,F.object,E,Object(f.i)(o)?S:null,Object(f.j)(b)?[b]:null,z,c);V.alignedSampledElevation=F.sampledElevation,V.needsElevationUpdates=Object(I.f)(c.mode)||"absolute-height"===c.mode;var N=Object(f.j)(b)?b:a,U=N.displayWidth,B=N.displayHeight;V.getScreenSize=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Object(ke.b)();return e[0]=U,e[1]=B,e};var G={labelText:r,elevationOffset:a.elevationOffset};return V.metadata=G,Object(Ne.b)(V,t,this._context.elevationProvider),V}}]),r}(F.a);function Ga(e,t,r){e&&e.forEach((function(e){var n=t(e);Object(f.j)(n)&&r(n,e.graphic)}))}var qa={mode:"relative-to-ground",offset:0},Ha={text:null,translation:[0,0,0],elevationOffset:0,centerOffset:[0,0,0,1],screenOffset:[0,0],anchor:"center",verticalOffset:null,centerOffsetUnits:null,debugDrawBorder:!1,displayWidth:0,displayHeight:0},Wa=r(69),Qa=r(75),Za=function(){function e(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];Object(c.a)(this,e),this.enabled=t,this._time=0}return Object(l.a)(e,[{key:"time",get:function(){return Object(f.j)(this._forcedTime)?this._forcedTime:Object(Qa.a)(this._time)}},{key:"advance",value:function(e){return this.enabled&&(this._time+=e),Object(f.i)(this._forcedTime)&&this.enabled&&0!==e}},{key:"stopAtTime",value:function(e){this._forcedTime=e}}]),e}(),Xa=r(440),Ya=r(528),$a=Object(y.a)({waveStrength:.06,waveTextureRepeat:32,waveDirection:Object(ke.f)(1,0),waveVelocity:.05,flowStrength:.015,flowOffset:-.5,animationSpeed:.35,color:[0,0,0,0],transparent:!0,writeDepth:!0,slicePlaneEnabled:!1,isDraped:!1,receiveShadows:!0,ssrEnabled:!1},ai.b),Ja={"calm-small":{waveStrength:.005,perturbationStrength:.02,textureRepeat:12,waveVelocity:.01},"rippled-small":{waveStrength:.02,perturbationStrength:.09,textureRepeat:32,waveVelocity:.07},"slight-small":{waveStrength:.05,perturbationStrength:.07,textureRepeat:28,waveVelocity:.1},"moderate-small":{waveStrength:.075,perturbationStrength:.07,textureRepeat:24,waveVelocity:.1},"calm-medium":{waveStrength:.003125,perturbationStrength:.01,textureRepeat:8,waveVelocity:.02},"rippled-medium":{waveStrength:.035,perturbationStrength:.015,textureRepeat:12,waveVelocity:.07},"slight-medium":{waveStrength:.06,perturbationStrength:.015,textureRepeat:8,waveVelocity:.12},"moderate-medium":{waveStrength:.09,perturbationStrength:.03,textureRepeat:4,waveVelocity:.12},"calm-large":{waveStrength:.01,perturbationStrength:0,textureRepeat:4,waveVelocity:.05},"rippled-large":{waveStrength:.025,perturbationStrength:.01,textureRepeat:8,waveVelocity:.11},"slight-large":{waveStrength:.06,perturbationStrength:.02,textureRepeat:3,waveVelocity:.13},"moderate-large":{waveStrength:.14,perturbationStrength:.03,textureRepeat:2,waveVelocity:.15}},Ka=function(e){Object(u.a)(r,e);var t=Object(d.a)(r);function r(e){var n;return Object(c.a)(this,r),(n=t.call(this,e,$a)).animation=new Za,n.techniqueConfig=new Ya.b,n}return Object(l.a)(r,[{key:"getTechniqueConfig",value:function(e,t){return this.techniqueConfig.output=e,this.techniqueConfig.writeDepth=this.params.writeDepth,this.techniqueConfig.receiveShadows=this.params.receiveShadows,this.techniqueConfig.slicePlaneEnabled=this.params.slicePlaneEnabled,this.techniqueConfig.transparent=this.params.transparent,this.techniqueConfig.useSSR=this.params.ssrEnabled,this.techniqueConfig.isDraped=this.params.isDraped,this.techniqueConfig.transparencyPassType=t?t.transparencyPassType:3,this.techniqueConfig.enableOffset=!t||t.camera.relativeElevation<vi.e,this.techniqueConfig.multipassTerrainEnabled=!!t&&t.multipassTerrainEnabled,this.techniqueConfig.cullAboveGround=!!t&&t.cullAboveGround,this.techniqueConfig}},{key:"update",value:function(e){var t=Math.min(e.camera.relativeElevation,e.camera.distance);this.animation.enabled=Math.sqrt(this.params.waveTextureRepeat/this.params.waveStrength)*t<eo;var r=this.animation.advance(e.dt);return this.animation.enabled&&r}},{key:"intersect",value:function(e,t,r,n,i,a,o){Object(Kr.i)(e,t,n,i,a,void 0,o)}},{key:"getGLMaterial",value:function(e){if(0===e.output&&this.params.isDraped){var t=e;return t.output=5,new Xa.a(t)}switch(e.output){case 0:case 2:case 4:case 7:return new Xa.a(e)}}},{key:"createBufferWriter",value:function(){return new pa.a(pa.d)}}]),r}(ai.a),eo=35e3,to=["polyline","polygon","extent"],ro=function(e){Object(u.a)(r,e);var t=Object(d.a)(r);function r(e,n,i,a){return Object(c.a)(this,r),t.call(this,e,n,i,a)}return Object(l.a)(r,[{key:"doLoad",value:function(){var e=Object(s.a)(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"destroy",value:function(){Object(g.a)(Object(O.a)(r.prototype),"destroy",this).call(this),this._context.stage.remove(this._material),this._material=null}},{key:"createGraphics3DGraphic",value:function(e){var t=e.graphic;if(!this._validateGeometry(t.geometry,to,this.symbolLayer.type))return null;var r=this.setGraphicElevationContext(t,new D.a);return this.ensureDrapedStatus("on-the-ground"===r.mode),this.ensureMaterial(),this.draped?this._createAsOverlay(t):this._createAs3DShape(t,r,t.uid)}},{key:"ensureMaterial",value:function(){if(!Object(f.j)(this._material)){var e=Object(y.a)({},$a),t=this.symbolLayer.color;Object(f.j)(t)&&(e.color=je.a.toUnitRGBA(t));var n=this._getCombinedOpacity(t,{hasIntrinsicColor:!0});e.color=[e.color[0],e.color[1],e.color[2],n],e.transparent=n<1||this.needsDrivenTransparentPass,e.waveDirection=Object(f.j)(this.symbolLayer.waveDirection)?r.headingVectorFromAngle(this.symbolLayer.waveDirection):Object(ke.f)(0,0);var i=this.symbolLayer.waveStrength+"-"+this.symbolLayer.waterbodySize,a=Ja[i];e.waveStrength=a.waveStrength,e.waveTextureRepeat=a.textureRepeat,e.waveVelocity=a.waveVelocity,e.flowStrength=a.perturbationStrength,e.slicePlaneEnabled=this._context.slicePlaneEnabled,e.isDraped=this.draped,this._material=new Ka(e),this._context.stage.add(this._material)}}},{key:"layerOpacityChanged",value:function(){if(Object(f.i)(this._material))return!0;var e=this._material.params.color,t=this._getCombinedOpacity(this.symbolLayer.color,{hasIntrinsicColor:!0}),r=t<1||this.needsDrivenTransparentPass;return this._material.setParameterValues({color:[e[0],e[1],e[2],t],transparent:r}),!0}},{key:"layerElevationInfoChanged",value:function(e,t,n){var i=this._elevationContext.mode,a=Object(I.d)(r.elevationModeChangeTypes,n,i);if(a!==I.a.UPDATE)return a;var o=Object(I.f)(i);return this.updateGraphics3DGraphicElevationInfo(e,t,(function(){return o}))}},{key:"slicePlaneEnabledChanged",value:function(){return Object(f.j)(this._material)&&this._material.setParameterValues({slicePlaneEnabled:this._context.slicePlaneEnabled}),!0}},{key:"physicalBasedRenderingChanged",value:function(){return!0}},{key:"pixelRatioChanged",value:function(){return!0}},{key:"_createAs3DShape",value:function(e,t,r){var n=H(e.geometry);if(Object(f.i)(n))return null;so.renderData=W(n,this._context.elevationProvider,this._context.renderCoordsHelper,t);var i=so.renderData.position.length/3;if(so.uvCoords=new Float64Array(2*i),so.outNum=0,so.outGeometries=[],so.outTransforms=[],so.outMaterials=[],this._create3DShapeGeometries(so),this._logGeometryCreationWarnings(so.renderData,n.rings,"rings","WaterSymbol3DLayer"),0===so.outNum)return null;this._createUVCoordsFromVertices(so.uvCoords,so.renderData.mapPosition,i,this._context.elevationProvider.spatialReference);var a=new K.a({geometries:so.outGeometries,materials:so.outMaterials,transformations:so.outTransforms,castShadow:!1,metadata:{layerUid:this._context.layer.uid,graphicUid:r}}),o=Re.c,s=new v.a(this,a,so.outGeometries,null,null,o,t);return s.alignedSampledElevation=so.renderData.sampledElevation,s.needsElevationUpdates=Object(I.f)(t.mode),s}},{key:"_createUVCoordsFromVertices",value:function(e,t,n,i){var a=Object(Wa.f)(i);Object(Ie.m)(io);for(var o=0;o<n;o++)Object(wn.r)(ao,t[3*o+0],t[3*o+1]),Object(Ie.p)(io,ao);Object(Se.b)(io,io,a);var s=io[0]%r.unitSizeOfTexture,c=io[1]%r.unitSizeOfTexture;no[0]=io[0]-s,no[1]=io[1]-c;for(var l=0;l<n;l++)e[2*l+0]=(t[3*l+0]*a-no[0])/r.unitSizeOfTexture,e[2*l+1]=(t[3*l+1]*a-no[1])/r.unitSizeOfTexture}},{key:"_create3DShapeGeometries",value:function(e){var t,r=e.renderData.polygons,i=e.uvCoords,a=Object(n.a)(r);try{for(a.s();!(t=a.n()).done;){var o=t.value,s=o.count,c=o.index,l=o.position,u=o.mapPosition,d=o.holeIndices;if(!Object(f.j)(this._context.clippingExtent)||(Object(P.k)(oo),Object(P.n)(oo,u),Object(P.w)(oo,this._context.clippingExtent))){var h=Object(_.a)(u,d,3);if(0!==h.length){var p=q({indices:new Uint32Array(h),attributeData:{position:l,uv0:new Float64Array(i.buffer,2*c*i.BYTES_PER_ELEMENT,2*s),mapPosition:u}});e.outGeometries.push(p),e.outMaterials.push(Object(f.s)(this._material)),e.outTransforms.push(S.a),e.outNum++}}}}catch(b){a.e(b)}finally{a.f()}}},{key:"_createAsOverlay",value:function(e){var t=H(e.geometry);if(Object(f.i)(t))return null;Object(f.s)(this._material).renderPriority=this._renderPriority,co.renderData=Q(t,this._context.overlaySR);var r=co.renderData.position.length/3;return co.uvCoords=new Float64Array(2*r),co.outNum=0,co.outGeometries=[],co.outBoundingBox=Object(P.k)(),co.layerUid=this._context.layer.uid,co.graphicsUid=e.uid,this._createAsOverlayWater(co),this._logGeometryCreationWarnings(co.renderData,t.rings,"rings","WaterSymbol3DLayer"),0===co.outNum?null:(this._createUVCoordsFromVertices(co.uvCoords,co.renderData.position,r,this._context.overlaySR),co.outNum>0?new Ve(this,co.outGeometries,co.outBoundingBox):null)}},{key:"_createAsOverlayWater",value:function(e){var t,r=e.uvCoords,i=e.renderData.polygons,a=Object(n.a)(i);try{for(a.s();!(t=a.n()).done;){var o=t.value,s=o.position,c=o.holeIndices,l=o.index,u=o.count;if(Object(P.k)(oo),Object(P.n)(oo,s),Object(P.w)(oo,this._context.clippingExtent)){Object(P.m)(e.outBoundingBox,oo);var d=Object(_.a)(s,c,3);if(0!==d.length){var h=q({indices:new Uint32Array(d),attributeData:{position:s,uv0:new Float64Array(r.buffer,2*l*r.BYTES_PER_ELEMENT,2*u)}}),p=new yt.a(h,Object(f.s)(this._material),e.layerUid,e.graphicsUid),b=oo;Object(Se.l)(p.boundingSphere,.5*(b[0]+b[3]),.5*(b[1]+b[4]),0,.5*Math.sqrt((b[3]-b[0])*(b[3]-b[0])+(b[4]-b[1])*(b[4]-b[1]))),e.outGeometries.push(p),e.outNum++}}}}catch(v){a.e(v)}finally{a.f()}}},{key:"test",get:function(){var e=this;return{create3DShape:function(t){return e._createAs3DShape(t.graphic,t.elevationContext,t.graphicUid)},ensureMaterial:function(){return e.ensureMaterial()}}}}],[{key:"headingVectorFromAngle",value:function(e){var t=Object(ke.b)(),r=Object(mn.d)(e);return t[0]=Math.sin(r),t[1]=Math.cos(r),t}}]),r}(F.a);ro.unitSizeOfTexture=100,ro.elevationModeChangeTypes={definedChanged:I.a.RECREATE,staysOnTheGround:I.a.NONE,onTheGroundChanged:I.a.RECREATE};var no=Object(ke.b)(),io=Object(Ie.k)(),ao=Object(ke.b)(),oo=Object(P.h)(),so={renderData:null,uvCoords:null,outNum:0,outBoundingBox:null,outGeometries:null,outMaterials:null,outTransforms:null},co={renderData:null,uvCoords:null,outNum:0,outBoundingBox:null,outGeometries:null,outMaterials:null,outTransforms:null},lo=m.a.getLogger("esri.views.3d.layers.graphics.Graphics3DSymbolLayerFactory");function uo(e,t,r,n){var i=fo[e.type]&&fo[e.type][t.type]||ho[t.type];return i?new i(e,t,r,n):(lo.error("GraphicsLayerFactory#make","unknown symbol type ".concat(t.type)),null)}var ho={icon:Ct,object:dn,line:Ft,path:Ei,fill:Ca,extrude:re,text:Ba,water:ro};var fo={"mesh-3d":{fill:Ht}},po=function(e){Object(u.a)(r,e);var t=Object(d.a)(r);function r(e,n,i){var a;return Object(c.a)(this,r),(a=t.call(this,n.schedule))._symbol=e,a._context=n,a._backgroundLayers=i,a._destroyed=!1,a.symbolLayers=[],a.referenced=0,a._extentPadding=0,a}return Object(l.a)(r,[{key:"symbol",get:function(){return this._symbol},set:function(e){if(this._symbol=e,this.symbolLayers)for(var t=0;t<e.symbolLayers.length;t++){var r=this.symbolLayers[t];Object(f.i)(r)||(r.symbol=e,r.symbolLayer=e.symbolLayers.items[t])}}},{key:"doLoad",value:function(){var e=Object(s.a)(o.a.mark((function e(t){var r,n,i,a,c,l,u,d,b=this;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(r=this._symbol.symbolLayers,this._extentPadding=0,this._backgroundLayers&&(r=this._backgroundLayers.concat(r)),n=r.length;this.symbolLayers.length<r.length;)this.symbolLayers.push(null);this.symbolLayers.length=r.length,i=[],a=function(e){var a=r.getItemAt(e);if(!1===a.enabled)return"continue";bo.renderPriority=1-(1+e)/n,bo.renderPriorityStep=1/n,bo.ignoreDrivers=a._ignoreDrivers;var o=uo(b.symbol,a,b._context,bo);i.push(Object(p.t)(t,(function(){b.symbolLayers[e]=null,o.destroy()}))),b.symbolLayers[e]=o},c=0;case 8:if(!(c<n)){e.next=15;break}if("continue"!==a(c)){e.next=12;break}return e.abrupt("continue",12);case 12:c++,e.next=8;break;case 15:return e.next=17,Object(h.b)(this.symbolLayers,function(){var e=Object(s.a)(o.a.mark((function e(t,r){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!Object(f.j)(t)){e.next=10;break}return e.prev=1,e.next=4,t.load();case 4:b._extentPadding+=Math.max(b._extentPadding,t.extentPadding),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(1),b.symbolLayers[r]=null;case 10:case"end":return e.stop()}}),e,null,[[1,7]])})));return function(t,r){return e.apply(this,arguments)}}());case 17:for(l=0,u=i;l<u.length;l++)null==(d=u[l])||d.remove();if(i.length=0,Object(p.x)(t),!this.symbolLayers.length||this.symbolLayers.some((function(e){return!!e}))){e.next=20;break}throw new Error;case 20:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getSymbolLayerSize",value:function(e){var t=this.symbolLayers[e];return Object(f.j)(t)?t.getCachedSize():null}},{key:"extentPadding",get:function(){return this._extentPadding}},{key:"createGraphics3DGraphic",value:function(e,t){for(var r=e.graphic,n=new Array(this.symbolLayers.length),i=0;i<this.symbolLayers.length;i++){var a=this.symbolLayers[i];n[i]=Object(f.j)(a)?a.createGraphics3DGraphic(e):null}var o=this._context.arcade||this._context.featureExpressionInfoContext&&this._context.featureExpressionInfoContext.arcade&&this._context.featureExpressionInfoContext.arcade.modules||null;return new b.a(r,t||this,n,e.layer,o)}},{key:"complexity",get:function(){return Object(jr.f)(this.symbolLayers.map((function(e){return Object(f.h)(e,"complexity")})))}},{key:"globalPropertyChanged",value:function(e,t){for(var r=this,n=this.symbolLayers.length,i=function(n){var i=r.symbolLayers[n];if(Object(f.j)(i)&&!i.globalPropertyChanged(e,t,(function(e){var t=e._graphics[n];return t instanceof v.a?t:null})))return{v:!1}},a=0;a<n;a++){var o=i(a);if("object"===typeof o)return o.v}return!0}},{key:"applyRendererDiff",value:function(e,t){return 1===this.loadStatus&&this.symbolLayers.reduce((function(r,n){return r&&(Object(f.i)(n)||n.applyRendererDiff(e,t))}),!0)}},{key:"prepareSymbolPatch",value:function(e){if(2!==this.loadStatus&&"partial"===e.diff.type){var t=e.diff.diff;if(t.symbolLayers&&"partial"===t.symbolLayers.type){var r=t.symbolLayers.diff;this.symbolLayers.forEach((function(t,n){if(!Object(f.i)(t)){var a=r[n];if(a){var o,s={diff:a,graphics3DGraphicPatches:[],symbolLayerStatePatches:[]};t.prepareSymbolLayerPatch(s),(o=e.symbolStatePatches).push.apply(o,Object(i.a)(s.symbolLayerStatePatches)),s.graphics3DGraphicPatches.length&&e.graphics3DGraphicPatches.push((function(e,t){var r=e._graphics[n];Object(f.j)(r)&&s.graphics3DGraphicPatches.forEach((function(e){return e(r,t)}))}))}}}))}}}},{key:"updateGeometry",value:function(e,t){for(var r=0;r<this.symbolLayers.length;r++){var n=this.symbolLayers[r];if(!Object(f.i)(n)){var i=e._graphics[r];if(Object(f.i)(i)||!n.updateGeometry(i,t))return!1}}return!0}},{key:"onRemoveGraphic",value:function(e){for(var t=0;t<this.symbolLayers.length;t++){var r=this.symbolLayers[t];if(!Object(f.i)(r)){var n=e._graphics[t];Object(f.j)(n)&&r.onRemoveGraphic(n)}}}},{key:"getFastUpdateStatus",value:function(){var e=0,t=0,r=0;return this.symbolLayers.forEach((function(n){Object(f.i)(n)||(0===n.loadStatus?e++:n.isFastUpdatesEnabled()?r++:t++)})),{loading:e,slow:t,fast:r}}},{key:"destroy",value:function(){if(this.destroyed)console.error("Graphics3DSymbol.destroy called when already destroyed!");else{this.abortLoad();var e,t=Object(n.a)(this.symbolLayers);try{for(t.s();!(e=t.n()).done;){var r=e.value;Object(f.j)(r)&&r.destroy()}}catch(i){t.e(i)}finally{t.f()}this.symbolLayers.length=0,this._destroyed=!0}}},{key:"destroyed",get:function(){return this._destroyed}}]),r}(r(396).a),bo={renderPriority:0,renderPriorityStep:1,ignoreDrivers:!1};t.a=po},function(e,t,r){"use strict";function n(e){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}r.d(t,"a",(function(){return n}))},function(e,t,r){"use strict";function n(e){if(Array.isArray(e))return e}r.d(t,"a",(function(){return n}))},function(e,t,r){"use strict";function n(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}r.d(t,"a",(function(){return n}))},function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var n=r(39),i=["elevation3d.arcgis.com","js.arcgis.com","jsdev.arcgis.com","jsqa.arcgis.com","static.arcgis.com"];function a(e){var t=Object(n.m)(e,!0);return t&&t.endsWith(".arcgis.com")&&!i.includes(t)&&!e.endsWith("/sharing/rest/generateToken")}},function(e,t,r){"use strict";r.d(t,"a",(function(){return O}));var n=r(13),i=r(2),a=r(5),o=r(19),s=r(6),c=r(7),l=r(0),u=r(53),d=r(207),h=r(15),f=r(23),p=r(1),b=(r(17),r(18),r(10)),v=r(368);function m(e){return e&&"group"===e.type}function y(e,t,r){var n,i;if(e)for(var a=0,o=e.length;a<o;a++){if((n=e.getItemAt(a))[t]===r)return n;if(m(n)&&(i=y(n.layers,t,r)))return i}}var g=h.a.getLogger("esri.support.LayersMixin"),O=function(e){var t=function(e){Object(s.a)(r,e);var t=Object(c.a)(r);function r(){var e;Object(i.a)(this,r);for(var n=arguments.length,a=new Array(n),s=0;s<n;s++)a[s]=arguments[s];(e=t.call.apply(t,[this].concat(a))).layers=new u.a;var c=function(e){e.parent&&"remove"in e.parent&&e.parent.remove(e)},l=function(t){t.parent=Object(o.a)(e),e.layerAdded(t),"elevation"!==t.type&&"base-elevation"!==t.type||g.error("Layer 'title:".concat(t.title,", id:").concat(t.id,"' of type '").concat(t.type,"' is not supported as an operational layer and will therefore be ignored."))},d=function(t){t.parent=null,e.layerRemoved(t)};return e.layers.on("before-add",(function(e){return c(e.item)})),e.layers.on("after-add",(function(e){return l(e.item)})),e.layers.on("after-remove",(function(e){return d(e.item)})),e}return Object(a.a)(r,[{key:"destroy",value:function(){var e,t=this.layers.removeAll(),r=Object(n.a)(t);try{for(r.s();!(e=r.n()).done;){var i=e.value;this.layerRemoved(i),i.destroy()}}catch(a){r.e(a)}finally{r.f()}this.layers.destroy()}},{key:"layers",set:function(e){this._set("layers",Object(d.b)(e,this._get("layers")))}},{key:"add",value:function(e,t){var r=this,n=this.layers;if(t=n.getNextIndex(t),e instanceof v.a){var i=e;i.parent===this?this.reorder(i,t):n.add(i,t)}else Object(f.q)(e)?e.then((function(e){r.destroyed||r.add(e,t)})):g.error("#add()","The item being added is not a Layer or a Promise that resolves to a Layer.")}},{key:"addMany",value:function(e,t){var r=this,n=this.layers;t=n.getNextIndex(t),e.slice().forEach((function(e){e.parent!==r?(n.add(e,t),t+=1):r.reorder(e,t)}))}},{key:"findLayerById",value:function(e){return y(this.layers,"id",e)}},{key:"findLayerByUid",value:function(e){return y(this.layers,"uid",e)}},{key:"remove",value:function(e){return this.layers.remove(e)}},{key:"removeMany",value:function(e){return this.layers.removeMany(e)}},{key:"removeAll",value:function(){return this.layers.removeAll()}},{key:"reorder",value:function(e,t){return this.layers.reorder(e,t)}},{key:"layerAdded",value:function(e){}},{key:"layerRemoved",value:function(e){}}]),r}(e);return Object(l.a)([Object(p.b)()],t.prototype,"layers",null),t=Object(l.a)([Object(b.a)("esri.support.LayersMixin")],t)}},function(e,t,r){"use strict";r.d(t,"a",(function(){return g}));var n=r(13),i=r(2),a=r(5),o=r(19),s=r(6),c=r(7),l=r(0),u=r(53),d=r(207),h=r(15),f=r(1),p=(r(17),r(18),r(10)),b="esri.support.TablesMixin",v=h.a.getLogger(b);function m(e){return e&&"group"===e.type}function y(e,t,r){if(e)for(var n=0,i=e.length;n<i;n++){var a=e.getItemAt(n);if(a[t]===r)return a;if(m(a)){var o=y(a.tables,t,r);if(o)return o}}}var g=function(e){var t=function(e){Object(s.a)(r,e);var t=Object(c.a)(r);function r(){var e;Object(i.a)(this,r);for(var n=arguments.length,a=new Array(n),s=0;s<n;s++)a[s]=arguments[s];return(e=t.call.apply(t,[this].concat(a))).tables=new u.a,e.tables.on("after-add",(function(t){var r=t.item;r.parent&&r.parent!==Object(o.a)(e)&&"tables"in r.parent&&r.parent.tables.remove(r),r.parent=Object(o.a)(e),"feature"!==r.type&&v.error("Layer 'title:".concat(r.title,", id:").concat(r.id,"' of type '").concat(r.type,"' is not supported as a table and will therefore be ignored."))})),e.tables.on("after-remove",(function(e){e.item.parent=null})),e}return Object(a.a)(r,[{key:"destroy",value:function(){var e,t=this.tables.removeAll(),r=Object(n.a)(t);try{for(r.s();!(e=r.n()).done;){e.value.destroy()}}catch(i){r.e(i)}finally{r.f()}this.tables.destroy()}},{key:"tables",set:function(e){this._set("tables",Object(d.b)(e,this._get("tables")))}},{key:"findTableById",value:function(e){return y(this.tables,"id",e)}},{key:"findTableByUid",value:function(e){return y(this.tables,"uid",e)}}]),r}(e);return Object(l.a)([Object(f.b)()],t.prototype,"tables",null),t=Object(l.a)([Object(p.a)(b)],t)}},function(e,t,r){"use strict";var n,i=r(2),a=r(5),o=r(6),s=r(7),c=r(0),l=r(27),u=r(1),d=(r(17),r(18),r(15),r(10)),h=n=function(e){Object(o.a)(r,e);var t=Object(s.a)(r);function r(e){var n;return Object(i.a)(this,r),(n=t.call(this,e)).name=null,n.code=null,n}return Object(a.a)(r,[{key:"clone",value:function(){return new n({name:this.name,code:this.code})}}]),r}(l.a);Object(c.a)([Object(u.b)({type:String,json:{write:!0}})],h.prototype,"name",void 0),Object(c.a)([Object(u.b)({type:[String,Number],json:{write:!0}})],h.prototype,"code",void 0);var f=h=n=Object(c.a)([Object(d.a)("esri.layers.support.CodedValue")],h);t.a=f},function(e,t,r){"use strict";r.d(t,"a",(function(){return a})),r.d(t,"b",(function(){return c})),r.d(t,"c",(function(){return l})),r.d(t,"d",(function(){return i}));var n=r(72),i=Math.PI/180,a=/SPHEROID\[([^\]]+)]/i,o=n.a.radius,s=n.a.eccentricitySquared,c={a1:o*s,a2:o*s*o*s,a3:o*s*s/2,a4:o*s*o*s*2.5,a5:o*s+o*s*s/2,a6:1-s},l={4267:{a:6378206.4,f:1/294.9786982},4269:{a:6378137,f:1/298.257222101},4326:{a:n.a.radius,f:n.a.flattening},104900:{a:2439700,f:0},104901:{a:6051e3,f:0},104902:{a:6051800,f:0},104903:{a:n.c.radius,f:n.c.flattening},104904:{a:3393400,f:1/192.0430107526882},104905:{a:n.b.radius,f:n.b.flattening},104906:{a:6200,f:0},104907:{a:11100,f:0},104908:{a:71492e3,f:.06487439154031222},104909:{a:8200,f:0},104910:{a:83500,f:0},104911:{a:1e4,f:0},104912:{a:2409300,f:0},104913:{a:15e3,f:0},104914:{a:4e4,f:0},104915:{a:1562090,f:0},104916:{a:2632345,f:0},104917:{a:85e3,f:0},104918:{a:1821460,f:0},104919:{a:5e3,f:0},104920:{a:12e3,f:0},104921:{a:3e4,f:3},104922:{a:18e3,f:0},104923:{a:14e3,f:0},104924:{a:49300,f:0},104925:{a:60268e3,f:1/10.2079945799458},104926:{a:16e3,f:0},104927:{a:9500,f:0},104928:{a:56e4,f:0},104929:{a:249400,f:0},104930:{a:59500,f:0},104931:{a:16e3,f:0},104932:{a:133e3,f:0},104933:{a:718e3,f:0},104934:{a:888e3,f:0},104935:{a:1986300,f:0},104936:{a:1e4,f:0},104937:{a:41900,f:0},104938:{a:11e4,f:0},104939:{a:50100,f:0},104940:{a:764e3,f:0},104941:{a:11e3,f:0},104942:{a:529800,f:0},104943:{a:2575e3,f:0},104944:{a:25559e3,f:1/43.61604095563141},104945:{a:578900,f:0},104946:{a:33e3,f:0},104947:{a:21e3,f:0},104948:{a:13e3,f:0},104949:{a:31e3,f:0},104950:{a:27e3,f:0},104951:{a:42e3,f:0},104952:{a:235800,f:0},104953:{a:761400,f:0},104954:{a:15e3,f:0},104955:{a:54e3,f:0},104956:{a:77e3,f:0},104957:{a:27e3,f:0},104958:{a:788900,f:0},104959:{a:584700,f:0},104960:{a:24764e3,f:.01708124697141011},104961:{a:74e3,f:0},104962:{a:79e3,f:0},104963:{a:104e3,f:.14423076923076922},104964:{a:29e3,f:0},104965:{a:17e4,f:0},104966:{a:208e3,f:0},104967:{a:4e4,f:0},104968:{a:1352600,f:0},104969:{a:1195e3,f:0},104970:{a:593e3,f:0},104971:{a:n.b.radius,f:0},104972:{a:47e4,f:0},104973:{a:255e3,f:0},104974:{a:2439400,f:0}}},function(e,t,r){"use strict";r.d(t,"a",(function(){return b})),r.d(t,"b",(function(){return c})),r.d(t,"c",(function(){return m})),r.d(t,"d",(function(){return p})),r.d(t,"e",(function(){return d})),r.d(t,"f",(function(){return h})),r.d(t,"g",(function(){return f})),r.d(t,"h",(function(){return l})),r.d(t,"i",(function(){return u}));var n=r(20),i=r(147),a=r(69),o=r(165);function s(e,t,r){return e.units[t][r]}function c(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"abbr";return"".concat(Object(o.b)(t,{minimumFractionDigits:n,maximumFractionDigits:n})," ").concat(s(e,r,i))}function l(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"abbr",o=Object(a.s)(t,r);return c(e,Object(a.c)(t,r,o),o,n,i)}function u(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"abbr",o=Object(a.t)(t,r);return c(e,Object(a.c)(t,r,o),o,n,i)}function d(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"abbr",o=Object(a.p)(t,r);return c(e,Object(a.c)(t,r,o),o,n,i)}function h(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"abbr",o=Object(a.q)(t,r);return c(e,Object(a.c)(t,r,o),o,n,i)}function f(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"abbr",o=Object(a.r)(t,r);return c(e,Object(a.c)(t,r,o),o,n,i)}function p(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"abbr",o=Object(a.o)(t,r);return c(e,Object(a.c)(t,r,o),o,n,i)}function b(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2,n=Object(a.c)(e,t,"degrees"),i=n-Math.floor(n);n-=i;var o=(i*=60)-Math.floor(i);return i-=o,o*=60,"".concat(n.toFixed(),"\xb0 ").concat(i.toFixed(),"' ").concat(o.toFixed(r),'"')}var v=["B","kB","MB","GB","TB"];function m(e,t){var r=0===t?0:Math.floor(Math.log(t)/Math.log(1024));r=Object(n.e)(r,0,v.length-1);var a=Object(o.b)(t/Math.pow(1024,r),{maximumFractionDigits:2});return Object(i.c)(e.units.bytes[v[r]],{fileSize:a})}},function(e,t,r){"use strict";r.d(t,"a",(function(){return p}));var n,i=r(2),a=r(5),o=r(6),s=r(7),c=r(0),l=r(27),u=r(1),d=(r(17),r(18)),h=(r(15),r(52)),f=r(10),p=n=function(e){Object(o.a)(r,e);var t=Object(s.a)(r);function r(e){var n;return Object(i.a)(this,r),(n=t.call(this,e)).type="map-layer",n}return Object(a.a)(r,[{key:"clone",value:function(){var e=this.mapLayerId,t=this.gdbVersion;return new n({mapLayerId:e,gdbVersion:t})}}]),r}(l.a);Object(c.a)([Object(h.a)({mapLayer:"map-layer"})],p.prototype,"type",void 0),Object(c.a)([Object(u.b)({type:d.a,json:{write:!0}})],p.prototype,"mapLayerId",void 0),Object(c.a)([Object(u.b)({type:String,json:{write:!0}})],p.prototype,"gdbVersion",void 0),p=n=Object(c.a)([Object(f.a)("esri.layers.support.source.MapLayerSource")],p)},function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var n=r(13),i=r(646);function a(e,t){var r=Object(i.a)(e,t),a=r.queryResult.featureResult,o=r.queryResult.queryGeometry,s=r.queryResult.queryGeometryType;if(a&&a.features&&a.features.length&&a.objectIdFieldName){var c,l=a.objectIdFieldName,u=Object(n.a)(a.features);try{for(u.s();!(c=u.n()).done;){var d=c.value;d.attributes&&(d.objectId=d.attributes[l])}}catch(h){u.e(h)}finally{u.f()}}return a&&(a.queryGeometry=o,a.queryGeometryType=s),a}},function(e,t,r){"use strict";r.d(t,"a",(function(){return M})),r.d(t,"b",(function(){return d})),r.d(t,"c",(function(){return x}));var n=r(22),i=r(3),a=r(597),o=r(217),s=r(604),c=["esriFieldTypeSmallInteger","esriFieldTypeInteger","esriFieldTypeSingle","esriFieldTypeDouble","esriFieldTypeString","esriFieldTypeDate","esriFieldTypeOID","esriFieldTypeGeometry","esriFieldTypeBlob","esriFieldTypeRaster","esriFieldTypeGUID","esriFieldTypeGlobalID","esriFieldTypeXML"],l=["sqlTypeBigInt","sqlTypeBinary","sqlTypeBit","sqlTypeChar","sqlTypeDate","sqlTypeDecimal","sqlTypeDouble","sqlTypeFloat","sqlTypeGeometry","sqlTypeGUID","sqlTypeInteger","sqlTypeLongNVarchar","sqlTypeLongVarbinary","sqlTypeLongVarchar","sqlTypeNChar","sqlTypeNVarchar","sqlTypeOther","sqlTypeReal","sqlTypeSmallInt","sqlTypeSqlXml","sqlTypeTime","sqlTypeTimestamp","sqlTypeTimestamp2","sqlTypeTinyInt","sqlTypeVarbinary","sqlTypeVarchar"],u=["upperLeft","lowerLeft"];function d(e){return e>=c.length?null:c[e]}function h(e){return e>=l.length?null:l[e]}function f(e){return e>=u.length?null:u[e]}function p(e,t){return t>=e.geometryTypes.length?null:e.geometryTypes[t]}function b(e,t,r){for(var n=t.createPointGeometry(r);e.next();)switch(e.tag()){case 3:for(var i=e.getUInt32(),a=e.pos()+i,o=0;e.pos()<a;)t.addCoordinatePoint(n,e.getSInt64(),o++);break;case 1:case 2:default:e.skip()}return n}function v(e,t,r){for(var n=t.createGeometry(r),i=2+(r.hasZ?1:0)+(r.hasM?1:0);e.next();)switch(e.tag()){case 2:for(var a=e.getUInt32(),o=e.pos()+a,s=0;e.pos()<o;)t.addLength(n,e.getUInt32(),s++);break;case 3:var c=e.getUInt32(),l=e.pos()+c,u=0;for(t.allocateCoordinates(n);e.pos()<l;)t.addCoordinate(n,e.getSInt64(),u),++u===i&&(u=0);break;case 1:default:e.skip()}return n}function m(e){for(var t=new o.a,r="esriGeometryPoint";e.next();)switch(e.tag()){case 2:for(var n=e.getUInt32(),i=e.pos()+n;e.pos()<i;)t.lengths.push(e.getUInt32());break;case 3:for(var a=e.getUInt32(),c=e.pos()+a;e.pos()<c;)t.coords.push(e.getSInt64());break;case 1:r=s.a[e.getEnum()];break;default:e.skip()}return{queryGeometry:t,queryGeometryType:r}}function y(e){for(;e.next();)switch(e.tag()){case 1:return e.getString();case 2:return e.getFloat();case 3:return e.getDouble();case 4:return e.getSInt32();case 5:return e.getUInt32();case 6:return e.getInt64();case 7:return e.getUInt64();case 8:return e.getSInt64();case 9:return e.getBool();default:return e.skip(),null}return null}function g(e){for(var t={type:d(0)};e.next();)switch(e.tag()){case 1:t.name=e.getString();break;case 2:t.type=d(e.getEnum());break;case 3:t.alias=e.getString();break;case 4:t.sqlType=h(e.getEnum());break;case 5:e.skip();break;case 6:t.defaultValue=e.getString();break;default:e.skip()}return t}function O(e){for(var t={};e.next();)switch(e.tag()){case 1:t.name=e.getString();break;case 2:t.isSystemMaintained=e.getBool();break;default:e.skip()}return t}function j(e,t,r,n){for(var i=t.createFeature(r),a=0;e.next();)switch(e.tag()){case 1:var o=n[a++].name;i.attributes[o]=e.processMessage(y);break;case 2:i.geometry=e.processMessageWithArgs(v,t,r);break;case 4:i.centroid=e.processMessageWithArgs(b,t,r);break;default:e.skip()}return i}function _(e){for(var t=[1,1,1,1];e.next();)switch(e.tag()){case 1:t[0]=e.getDouble();break;case 2:t[1]=e.getDouble();break;case 4:t[2]=e.getDouble();break;case 3:t[3]=e.getDouble();break;default:e.skip()}return t}function w(e){for(var t=[0,0,0,0];e.next();)switch(e.tag()){case 1:t[0]=e.getDouble();break;case 2:t[1]=e.getDouble();break;case 4:t[2]=e.getDouble();break;case 3:t[3]=e.getDouble();break;default:e.skip()}return t}function x(e){for(var t={originPosition:f(0)};e.next();)switch(e.tag()){case 1:t.originPosition=f(e.getEnum());break;case 2:t.scale=e.processMessage(_);break;case 3:t.translate=e.processMessage(w);break;default:e.skip()}return t}function k(e){for(var t={};e.next();)switch(e.tag()){case 1:t.shapeAreaFieldName=e.getString();break;case 2:t.shapeLengthFieldName=e.getString();break;case 3:t.units=e.getString();break;default:e.skip()}return t}function S(e,t){for(var r=t.createSpatialReference();e.next();)switch(e.tag()){case 1:r.wkid=e.getUInt32();break;case 5:r.wkt=e.getString();break;case 2:r.latestWkid=e.getUInt32();break;case 3:r.vcsWkid=e.getUInt32();break;case 4:r.latestVcsWkid=e.getUInt32();break;default:e.skip()}return r}function T(e,t){var r=t.createFeatureResult();r.geometryType=p(t,0);for(var n=!1;e.next();)switch(e.tag()){case 1:r.objectIdFieldName=e.getString();break;case 3:r.globalIdFieldName=e.getString();break;case 4:r.geohashFieldName=e.getString();break;case 5:r.geometryProperties=e.processMessage(k);break;case 7:r.geometryType=p(t,e.getEnum());break;case 8:r.spatialReference=e.processMessageWithArgs(S,t);break;case 10:r.hasZ=e.getBool();break;case 11:r.hasM=e.getBool();break;case 12:r.transform=e.processMessage(x);break;case 9:var i=e.getBool();r.exceededTransferLimit=i;break;case 13:t.addField(r,e.processMessage(g));break;case 15:n||(t.prepareFeatures(r),n=!0),t.addFeature(r,e.processMessageWithArgs(j,t,r,r.fields));break;case 2:r.uniqueIdField=e.processMessage(O);break;case 6:default:e.skip()}return t.finishFeatureResult(r),r}function C(e,t){for(var r={},n=null;e.next();)switch(e.tag()){case 4:n=e.processMessageWithArgs(m);break;case 1:r.featureResult=e.processMessageWithArgs(T,t);break;case 2:case 3:default:e.skip()}return Object(i.j)(n)&&r.featureResult&&t.addQueryGeometry(r,n),r}function M(e,t){try{for(var r=new a.a(new Uint8Array(e),new DataView(e)),i={};r.next();)switch(r.tag()){case 2:i.queryResult=r.processMessageWithArgs(C,t);break;default:r.skip()}return i}catch(o){throw new n.a("query:parsing-pbf","Error while parsing FeatureSet PBF payload",{error:o})}}},function(e,t,r){"use strict";var n,i=r(2),a=r(5),o=r(6),s=r(7),c=r(0),l=r(27),u=r(28),d=r(1),h=(r(17),r(18),r(15),r(10)),f=n=function(e){Object(o.a)(r,e);var t=Object(s.a)(r);function r(e){var n;return Object(i.a)(this,r),(n=t.call(this,e)).label=null,n.size=null,n.value=null,n}return Object(a.a)(r,[{key:"clone",value:function(){return new n({label:this.label,size:this.size,value:this.value})}}]),r}(l.a);Object(c.a)([Object(d.b)({type:String,json:{write:!0}})],f.prototype,"label",void 0),Object(c.a)([Object(d.b)({type:Number,cast:u.j,json:{write:!0}})],f.prototype,"size",void 0),Object(c.a)([Object(d.b)({type:Number,json:{write:!0}})],f.prototype,"value",void 0);var p=f=n=Object(c.a)([Object(h.a)("esri.renderers.visualVariables.support.SizeStop")],f);t.a=p},function(e,t,r){"use strict";var n=r(2),i=r(6),a=r(7),o=r(0),s=r(53),c=r(27),l=r(1),u=(r(17),r(18),r(15),r(10)),d=function(e){Object(i.a)(r,e);var t=Object(a.a)(r);function r(e){var i;return Object(n.a)(this,r),(i=t.call(this,e)).floorField=null,i.viewAllMode=!1,i.viewAllLevelIds=new s.a,i}return r}(c.a);Object(o.a)([Object(l.b)({type:String,json:{write:!0}})],d.prototype,"floorField",void 0),Object(o.a)([Object(l.b)({json:{read:!1,write:!1}})],d.prototype,"viewAllMode",void 0),Object(o.a)([Object(l.b)({json:{read:!1,write:!1}})],d.prototype,"viewAllLevelIds",void 0);var h=d=Object(o.a)([Object(u.a)("esri.layers.support.LayerFloorInfo")],d);t.a=h},function(e,t,r){"use strict";r.d(t,"a",(function(){return y})),r.d(t,"b",(function(){return g}));var n=r(13),i=r(6),a=r(7),o=r(2),s=r(5),c=(r(126),r(17),r(15)),l=r(3),u=r(69),d=r(40),h=r(169),f=r(61),p=r(56),b=c.a.getLogger("esri.layers.support.ElevationSampler"),v=function(){function e(){Object(o.a)(this,e)}return Object(s.a)(e,[{key:"queryElevation",value:function(e){return g(e.clone(),this)}},{key:"on",value:function(){return _}},{key:"projectIfRequired",value:function(e,t){return O(e,t)}}]),e}(),m=function(e){Object(i.a)(r,e);var t=Object(a.a)(r);function r(e,n,i){var a;Object(o.a)(this,r),(a=t.call(this)).tile=e,a.noDataValue=i,a.extent=Object(d.z)(e.tile.extent,n.spatialReference);var s=Object(u.f)(n.spatialReference),c=n.lodAt(e.tile.level).resolution*s;return a.demResolution={min:c,max:c},a}return Object(s.a)(r,[{key:"spatialReference",get:function(){return this.extent.spatialReference}},{key:"contains",value:function(e){var t=this.projectIfRequired(e,this.spatialReference);return Object(h.e)(this.extent,t)}},{key:"elevationAt",value:function(e){var t=this.projectIfRequired(e,this.spatialReference);if(!t)return null;if(!this.contains(e)){var r=this.extent,n="".concat(r.xmin,", ").concat(r.ymin,", ").concat(r.xmax,", ").concat(r.ymax);b.warn("#elevationAt()","Point used to sample elevation (".concat(e.x,", ").concat(e.y,") is outside of the sampler extent (").concat(n,")"))}return this.tile.sample(t.x,t.y)}}]),r}(v),y=function(e){Object(i.a)(r,e);var t=Object(a.a)(r);function r(e,n,i){var a,s;Object(o.a)(this,r),a=t.call(this),"number"==typeof n?(a.noDataValue=n,s=null):(s=n,a.noDataValue=i),a.samplers=s?e.map((function(e){return new m(e,s,a.noDataValue)})):e;var c=a.samplers[0];if(c){a.extent=c.extent.clone();var l=c.demResolution,u=l.min,h=l.max;a.demResolution={min:u,max:h};for(var f=1;f<a.samplers.length;f++){var p=a.samplers[f];a.extent.union(p.extent),a.demResolution.min=Math.min(a.demResolution.min,p.demResolution.min),a.demResolution.max=Math.max(a.demResolution.max,p.demResolution.max)}}else a.extent=Object(d.z)(Object(d.k)(),s.spatialReference),a.demResolution={min:0,max:0};return a}return Object(s.a)(r,[{key:"spatialReference",get:function(){return this.extent.spatialReference}},{key:"elevationAt",value:function(e){var t=this.projectIfRequired(e,this.spatialReference);if(!t)return null;var r,i=Object(n.a)(this.samplers);try{for(i.s();!(r=i.n()).done;){var a=r.value;if(a.contains(t))return a.elevationAt(t)}}catch(o){i.e(o)}finally{i.f()}return b.warn("#elevationAt()","Point used to sample elevation (".concat(e.x,", ").concat(e.y,") is outside of the sampler")),null}}]),r}(v);function g(e,t){var r=O(e,t.spatialReference);if(!r)return null;switch(e.type){case"point":!function(e,t,r){e.z=Object(l.t)(r.elevationAt(t),0)}(e,r,t);break;case"polyline":!function(e,t,r){j.spatialReference=t.spatialReference;for(var n=e.hasM&&!e.hasZ,i=0;i<e.paths.length;i++)for(var a=e.paths[i],o=t.paths[i],s=0;s<a.length;s++){var c=a[s],u=o[s];j.x=u[0],j.y=u[1],n&&(c[3]=c[2]),c[2]=Object(l.t)(r.elevationAt(j),0)}e.hasZ=!0}(e,r,t);break;case"multipoint":!function(e,t,r){j.spatialReference=t.spatialReference;for(var n=e.hasM&&!e.hasZ,i=0;i<e.points.length;i++){var a=e.points[i],o=t.points[i];j.x=o[0],j.y=o[1],n&&(a[3]=a[2]),a[2]=Object(l.t)(r.elevationAt(j),0)}e.hasZ=!0}(e,r,t)}return e}function O(e,t){var r=e.spatialReference;return r.equals(t)?e:Object(f.a)(r,t)?Object(f.d)(e,t):(b.error("Cannot project geometry spatial reference (wkid:".concat(r.wkid,") to elevation sampler spatial reference (wkid:").concat(t.wkid,")")),null)}var j=new p.a,_={remove:function(){}}},function(e,t,r){"use strict";function n(){var e=new Float32Array(16);return e[0]=1,e[5]=1,e[10]=1,e[15]=1,e}r.d(t,"a",(function(){return n}));var i=n();Object.freeze({__proto__:null,create:n,clone:function(e){var t=new Float32Array(16);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},fromValues:function(e,t,r,n,i,a,o,s,c,l,u,d,h,f,p,b){var v=new Float32Array(16);return v[0]=e,v[1]=t,v[2]=r,v[3]=n,v[4]=i,v[5]=a,v[6]=o,v[7]=s,v[8]=c,v[9]=l,v[10]=u,v[11]=d,v[12]=h,v[13]=f,v[14]=p,v[15]=b,v},createView:function(e,t){return new Float32Array(e,t,16)},IDENTITY:i})},function(e,t,r){"use strict";r.d(t,"a",(function(){return h}));var n,i,a,o,s=r(12),c=r(120),l=r(324),u=r(194),d=r(11);function h(e,t){t.multipassGeometryEnabled&&e.vertex.include(l.b),t.multipassTerrainEnabled&&e.varyings.add("depth","float"),e.vertex.code.add(Object(d.a)(n||(n=Object(s.a)(["\n  void main(void) {\n    vec4 posProjCenter;\n    if (dot(position, position) > 0.0) {\n      // Render single point to center of the pixel to avoid subpixel\n      // filtering to affect the marker color\n      ProjectHUDAux projectAux;\n      vec4 posProj = projectPositionHUD(projectAux);\n      posProjCenter = alignToPixelCenter(posProj, viewport.zw);\n\n      ","\n\n      ","\n      vec3 vpos = projectAux.posModel;\n      if (rejectBySlice(vpos)) {\n        // Project out of clip space\n        posProjCenter = vec4(1e038, 1e038, 1e038, 1.0);\n      }\n\n    } else {\n      // Project out of clip space\n      posProjCenter = vec4(1e038, 1e038, 1e038, 1.0);\n    }\n\n    gl_Position = posProjCenter;\n    gl_PointSize = 1.0;\n  }\n  "])),t.multipassGeometryEnabled?Object(d.a)(i||(i=Object(s.a)(["\n        // Don't draw vertices behind geometry\n        if(geometryDepthTest(.5 + .5 * posProjCenter.xy / posProjCenter.w, projectAux.posView.z)){\n          posProjCenter = vec4(1e038, 1e038, 1e038, 1.0);\n        }"]))):"",t.multipassTerrainEnabled?"depth = projectAux.posView.z;":"")),t.multipassTerrainEnabled&&e.fragment.include(c.a),e.fragment.uniforms.add("terrainDepthTexture","sampler2D"),e.fragment.uniforms.add("cameraNearFar","vec2"),e.fragment.uniforms.add("inverseViewport","vec2"),e.fragment.include(u.a),e.fragment.code.add(Object(d.a)(a||(a=Object(s.a)(["\n  void main() {\n    gl_FragColor = vec4(1, 1, 1, 1);\n    ","\n  }\n  "])),t.multipassTerrainEnabled?Object(d.a)(o||(o=Object(s.a)(["\n\n          vec2 uv = gl_FragCoord.xy * inverseViewport;\n\n          //Read the rgba data from the texture linear depth\n          vec4 terrainDepthData = texture2D(terrainDepthTexture, uv);\n\n          float terrainDepth = linearDepthFromFloat(rgba2float(terrainDepthData), cameraNearFar);\n\n          //If HUD vertex is behind terrain and the terrain depth is not the initialize value (e.g. we are not looking at the sky)\n          //Mark the HUD vertex as occluded by transparent terrain\n          if(depth < terrainDepth && terrainDepthData != vec4(0,0,0,1)){\n            gl_FragColor.g = 0.5;\n          }"]))):""))}},function(e,t,r){"use strict";var n=r(2);t.a=function e(t,r,i){Object(n.a)(this,e),this.graphic=t,this.renderingInfo=r,this.layer=i}},function(e,t,r){"use strict";var n=r(8),i=r.n(n),a=r(16),o=r(13),s=r(2),c=r(5),l=r(128),u=r(461),d=r(3),h=r(117),f=r(29),p=r(38),b=r(4),v=r(9),m=r(158),y=r(51),g=r(34),O=r(40),j=r(202),_=r(412),w=r(233),x=new h.a(Array,(function(e){return Object(g.B)(e,g.c)}),null,10,5),k=Object(O.k)(),S=function(){function e(t,r,n,i,a){Object(s.a)(this,e),this._labelGraphics=new Array,this._auxiliaryGraphics=new Array,this._visibilityFlags=function(e,t){for(var r=new Array(e),n=0;n<r.length;n++)r[n]=new Array(t);return r}(2,4),this._featureExpressionFeature=null,this._optimizedGeometry={geometry:null,hasZ:!1,hasM:!1},this._extent=null,this.isElevationSource=!1,++r.referenced,this.graphics3DSymbol=r,this.graphic=t,this._graphics=n,this._featureExpressionFeature=a?Object(w.d)(a,t,i):null;var c,l=Object(o.a)(this._graphics);try{for(l.s();!(c=l.n()).done;){var u=c.value;Object(d.j)(u)&&(this.isElevationSource=this.isElevationSource||u.isElevationSource)}}catch(h){l.e(h)}finally{l.f()}}return Object(c.a)(e,[{key:"labelGraphics",get:function(){return this._labelGraphics}},{key:"extent",get:function(){return this._extent}},{key:"initialize",value:function(e,t,r){var n=this;this._layer=t,this._stage=e,this.forEachSymbolLayerGraphic((function(i){i.initialize(e,t,r),i.setVisibility(n.isVisible())}))}},{key:"destroy",value:function(){this.forEachSymbolLayerGraphic((function(e){return e.destroy()})),this._graphics=null,this._auxiliaryGraphics=null,--this.graphics3DSymbol.referenced,this.graphics3DSymbol=null}},{key:"destroyed",get:function(){return null==this._graphics}},{key:"clearLabelGraphics",value:function(){this.forEachLabelGraphic((function(e){return e.destroy()})),this._labelGraphics.length=0}},{key:"addLabelGraphic",value:function(e,t,r){this._labelGraphics.push(e),e.initialize(t,r),e.setVisibility(this.isVisible(1))}},{key:"addAuxiliaryGraphic",value:function(e){this._auxiliaryGraphics.push(e),this._layer&&(e.initialize(this._stage,this._layer),e.setVisibility(this.isVisible()))}},{key:"isDraped",get:function(){var e=!1;return this.forEachSymbolLayerGraphic((function(t){"draped"===t.type&&(e=!0)})),e}},{key:"isVisible",value:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1?arguments[1]:void 0,r=0;r<=e;r++)for(var n=this._visibilityFlags[r],i=0;i<n.length;++i)if(!1===n[i]&&i!==t)return!1;return!0}},{key:"hasVisibilityFlag",value:function(e,t){return null!=this._visibilityFlags[t][e]}},{key:"setVisibilityFlag",value:function(e,t,r){var n=this.isVisible(r);this._visibilityFlags[r][e]=t;var i=this.isVisible(r);if(n===i)return!1;if(1===r)this.forEachLabelGraphic((function(e){return e.setVisibility(i)}));else{this.forEachSymbolLayerGraphic((function(e){return e.setVisibility(i)}));var a=this.isVisible(1);this.forEachLabelGraphic((function(e){return e.setVisibility(a)}))}return!0}},{key:"clearVisibilityFlag",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.setVisibilityFlag(e,void 0,t)}},{key:"computeExtent",value:function(e){if(!this._extent){var t=this.graphic.geometry;if(Object(d.i)(t))return!1;this._extent=Object(O.k)(),Object(j.d)(t,this._extent);var r=t.spatialReference;if(!r.equals(e)&&!Object(y.o)(this._extent,r,this._extent,e))return this._extent=null,!1}return!0}},{key:"getAsOptimizedGeometry",value:function(e,t){return this._optimizedGeometry.geometry&&this._optimizedGeometry.hasZ===e&&this._optimizedGeometry.hasM===t||(this._optimizedGeometry.geometry=this._convertGraphicToOptimizedGeometry(this.graphic,e,t),this._optimizedGeometry.hasZ=e,this._optimizedGeometry.hasM=t),this._optimizedGeometry.geometry}},{key:"_convertGraphicToOptimizedGeometry",value:function(e,t,r){var n=e.geometry;return"mesh"!==n.type&&"extent"!==n.type||(n=m.a.fromExtent("mesh"===n.type?n.extent:n)),Object(_.d)(n,t,r)}},{key:"usedMemory",get:function(){var e=this,t=Object(u.a)(this.graphic.attributes);return this.forEachSymbolLayerGraphic((function(r){var n=r.graphics3DSymbolLayer.complexity;if(!Object(d.i)(n)){var i="draped"===r.type?n.memory.draped:n.memory;t+=i.bytesPerFeature,i.bytesPerCoordinate&&(t+=Object(j.k)(e.graphic.geometry)*i.bytesPerCoordinate)}})),t}},{key:"computeAttachmentOrigin",value:function(){var e,t={render:{origin:Object(v.e)(),num:0},draped:{origin:Object(p.b)(),num:0}},r=Object(o.a)(this._graphics);try{for(r.s();!(e=r.n()).done;){var n=e.value;Object(d.i)(n)||n.computeAttachmentOrigin(t)}}catch(i){r.e(i)}finally{r.f()}return t.render.num&&Object(b.g)(t.render.origin,t.render.origin,1/t.render.num),t.draped.num&&Object(f.b)(t.draped.origin,t.draped.origin,1/t.draped.num),t}},{key:"getProjectedBoundingBox",value:function(){var e=Object(a.a)(i.a.mark((function e(t,r,n,o,s){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s||(s={boundingBox:null,requiresDrapedElevation:!1,screenSpaceObjects:[]}),s.boundingBox?Object(g.k)(s.boundingBox):s.boundingBox=Object(g.k)(),s.requiresDrapedElevation=!1,e.next=5,Object(l.b)(this._graphics,function(){var e=Object(a.a)(i.a.mark((function e(a){var c,l,u;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!Object(d.i)(a)){e.next=2;break}return e.abrupt("return");case 2:return c="draped"===a.type?r:t,l=x.acquire(),e.next=6,a.getProjectedBoundingBox(c,n,s.screenSpaceObjects,o,l);case 6:u=e.sent,isFinite(u[2])&&isFinite(u[5])||(s.requiresDrapedElevation=!0),u&&Object(g.m)(s.boundingBox,l),x.release(l);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 5:return e.abrupt("return",Object(g.d)(s.boundingBox)||Object(O.c)(Object(g.F)(s.boundingBox,k))?s:null);case 6:case"end":return e.stop()}}),e,this)})));return function(t,r,n,i,a){return e.apply(this,arguments)}}()},{key:"needsElevationUpdates",value:function(){var e,t=Object(o.a)(this._graphics);try{for(t.s();!(e=t.n()).done;){var r=e.value;if(Object(d.j)(r)&&("object3d"===r.type||"lod-instance"===r.type)&&r.needsElevationUpdates)return!0}}catch(s){t.e(s)}finally{t.f()}var n,i=Object(o.a)(this._labelGraphics);try{for(i.s();!(n=i.n()).done;){var a=n.value;if(a&&a.needsElevationUpdates)return!0}}catch(s){i.e(s)}finally{i.f()}return!1}},{key:"alignWithElevation",value:function(e,t,r){var n=this;this.forEachRenderedGraphic((function(i){"object3d"!==i.type&&"lod-instance"!==i.type||i.alignWithElevation(e,t,n._featureExpressionFeature,r)}))}},{key:"addObjectStateSet",value:function(e,t){this.forEachSymbolLayerGraphic((function(r){return r.addObjectState(e,t)}))}},{key:"removeObjectState",value:function(e){this.forEachSymbolLayerGraphic((function(t){return t.removeObjectState(e)}))}},{key:"forEachGraphicList",value:function(e,t){e.forEach((function(e){return e&&t(e)}))}},{key:"forEachSymbolLayerGraphic",value:function(e){this.forEachGraphicList(this._graphics,e),this.forEachGraphicList(this._auxiliaryGraphics,e)}},{key:"forEachLabelGraphic",value:function(e){this.forEachGraphicList(this._labelGraphics,e)}},{key:"forEachRenderedGraphic",value:function(e){this.forEachSymbolLayerGraphic(e),this.forEachLabelGraphic(e)}}]),e}();t.a=S},function(e,t,r){"use strict";r.d(t,"a",(function(){return d}));var n,i,a,o,s,c,l=r(12),u=r(11);function d(e,t){e.vertex.uniforms.add("intrinsicWidth","float"),t.vvSize?(e.attributes.add("sizeFeatureAttribute","float"),e.vertex.uniforms.add("vvSizeMinSize","vec3"),e.vertex.uniforms.add("vvSizeMaxSize","vec3"),e.vertex.uniforms.add("vvSizeOffset","vec3"),e.vertex.uniforms.add("vvSizeFactor","vec3"),e.vertex.code.add(Object(u.a)(n||(n=Object(l.a)(["float getSize() {\nreturn intrinsicWidth * clamp(vvSizeOffset + sizeFeatureAttribute * vvSizeFactor, vvSizeMinSize, vvSizeMaxSize).x;\n}"]))))):(e.attributes.add("size","float"),e.vertex.code.add(Object(u.a)(i||(i=Object(l.a)(["float getSize(){\nreturn intrinsicWidth * size;\n}"]))))),t.vvOpacity?(e.attributes.add("opacityFeatureAttribute","float"),e.vertex.constants.add("vvOpacityNumber","int",8),e.vertex.code.add(Object(u.a)(a||(a=Object(l.a)(["uniform float vvOpacityValues[vvOpacityNumber];\nuniform float vvOpacityOpacities[vvOpacityNumber];\nfloat interpolateOpacity( float value ){\nif (value <= vvOpacityValues[0]) {\nreturn vvOpacityOpacities[0];\n}\nfor (int i = 1; i < vvOpacityNumber; ++i) {\nif (vvOpacityValues[i] >= value) {\nfloat f = (value - vvOpacityValues[i-1]) / (vvOpacityValues[i] - vvOpacityValues[i-1]);\nreturn mix(vvOpacityOpacities[i-1], vvOpacityOpacities[i], f);\n}\n}\nreturn vvOpacityOpacities[vvOpacityNumber - 1];\n}\nvec4 applyOpacity( vec4 color ){\nreturn vec4(color.xyz, interpolateOpacity(opacityFeatureAttribute));\n}"]))))):e.vertex.code.add(Object(u.a)(o||(o=Object(l.a)(["vec4 applyOpacity( vec4 color ){\nreturn color;\n}"])))),t.vvColor?(e.attributes.add("colorFeatureAttribute","float"),e.vertex.constants.add("vvColorNumber","int",8),e.vertex.code.add(Object(u.a)(s||(s=Object(l.a)(["uniform float vvColorValues[vvColorNumber];\nuniform vec4 vvColorColors[vvColorNumber];\nvec4 interpolateColor( float value ) {\nif (value <= vvColorValues[0]) {\nreturn vvColorColors[0];\n}\nfor (int i = 1; i < vvColorNumber; ++i) {\nif (vvColorValues[i] >= value) {\nfloat f = (value - vvColorValues[i-1]) / (vvColorValues[i] - vvColorValues[i-1]);\nreturn mix(vvColorColors[i-1], vvColorColors[i], f);\n}\n}\nreturn vvColorColors[vvColorNumber - 1];\n}\nvec4 getColor(){\nreturn applyOpacity(interpolateColor(colorFeatureAttribute));\n}"]))))):(e.attributes.add("color","vec4"),e.vertex.code.add(Object(u.a)(c||(c=Object(l.a)(["vec4 getColor(){\nreturn applyOpacity(color);\n}"])))))}},function(e,t,r){"use strict";r.r(t),r.d(t,"fetch",(function(){return E})),r.d(t,"gltfToEngineResources",(function(){return D})),r.d(t,"parseUrl",(function(){return I}));var n=r(8),i=r.n(n),a=r(13),o=r(14),s=r(16),c=r(405),l=r(3),u=r(67),d=r(96),h=r(26),f=r(31),p=r(4),b=r(9),v=r(34),m=r(32),y=r(178),g=r(535),O=r(341),j=r(491),_=r(494),w=r(536),x=r(444),k=r(115),S=r(206),T=r(211),C=r(367),M=r(479),P=r(425),A=r(374);function E(e,t){return R.apply(this,arguments)}function R(){return(R=Object(s.a)(i.a.mark((function e(t,r){var n,a,s,u,d,h,f,p,b,v;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("wosr"!==(n=I(Object(c.a)(t))).fileType){e.next=7;break}return e.next=4,r.cache?r.cache.loadWOSR(n.url,r):Object(x.a)(n.url,r);case 4:return a=e.sent,s=Object(x.b)(a,r),e.abrupt("return",{lods:[s],referenceBoundingBox:s.boundingBox,isEsriSymbolResource:!1,isWosr:!0,remove:a.remove});case 7:return e.next=9,r.cache?r.cache.loadGLTF(n.url,r,r.usePBR):Object(_.a)(new j.a(r.streamDataRequester),n.url,r,r.usePBR);case 9:if(u=e.sent,d=Object(l.h)(u.model.meta,"ESRI_proxyEllipsoid"),u.meta.isEsriSymbolResource&&Object(l.j)(d)&&-1!==u.meta.uri.indexOf("/RealisticTrees/")&&L(u,d),h=u.meta.isEsriSymbolResource?{usePBR:r.usePBR,isSchematic:!1,treeRendering:u.customMeta.esriTreeRendering,mrrFactors:[0,1,.2]}:{usePBR:r.usePBR,isSchematic:!1,mrrFactors:[0,1,.5]},f=Object(o.a)(Object(o.a)({},r.materialParamsMixin),{},{treeRendering:u.customMeta.esriTreeRendering}),null==n.specifiedLodIndex){e.next=18;break}return p=D(u,h,f,n.specifiedLodIndex),b=p[0].boundingBox,0!==n.specifiedLodIndex&&(b=D(u,h,f,0)[0].boundingBox),e.abrupt("return",{lods:p,referenceBoundingBox:b,isEsriSymbolResource:u.meta.isEsriSymbolResource,isWosr:!1,remove:u.remove});case 18:return v=D(u,h,f),e.abrupt("return",{lods:v,referenceBoundingBox:v[0].boundingBox,isEsriSymbolResource:u.meta.isEsriSymbolResource,isWosr:!1,remove:u.remove});case 20:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function I(e){var t=e.match(/(.*\.(gltf|glb))(\?lod=([0-9]+))?$/);return t?{fileType:"gltf",url:t[1],specifiedLodIndex:null!=t[4]?Number(t[4]):null}:e.match(/(.*\.(json|json\.gz))$/)?{fileType:"wosr",url:e,specifiedLodIndex:null}:{fileType:"unknown",url:e,specifiedLodIndex:null}}function D(e,t,r,n){var i=e.model,a=Object(d.b)(),s=new Array,c=new Map,h=new Map;return i.lods.forEach((function(e,d){if(void 0===n||d===n){var f={name:e.name,stageResources:{textures:new Array,materials:new Array,geometries:new Array},lodThreshold:Object(l.j)(e.lodThreshold)?e.lodThreshold:null,pivotOffset:[0,0,0],numberOfVertices:0,boundingBox:Object(v.k)()};s.push(f),e.parts.forEach((function(e){var n=e.material+(e.attributes.normal?"_normal":"")+(e.attributes.color?"_color":"")+(e.attributes.texCoord0?"_texCoord0":"")+(e.attributes.tangent?"_tangent":""),s=i.materials.get(e.material),d=Object(l.j)(e.attributes.texCoord0),p=Object(l.j)(e.attributes.normal);if(!c.has(n)){if(d){if(Object(l.j)(s.textureColor)&&!h.has(s.textureColor)){var b=i.textures.get(s.textureColor),j=Object(o.a)(Object(o.a)({},b.parameters),{},{preMultiplyAlpha:!0});h.set(s.textureColor,new S.a(b.data,j))}if(Object(l.j)(s.textureNormal)&&!h.has(s.textureNormal)){var _=i.textures.get(s.textureNormal),x=Object(o.a)(Object(o.a)({},_.parameters),{},{preMultiplyAlpha:!0});h.set(s.textureNormal,new S.a(_.data,x))}if(Object(l.j)(s.textureOcclusion)&&!h.has(s.textureOcclusion)){var E=i.textures.get(s.textureOcclusion),R=Object(o.a)(Object(o.a)({},E.parameters),{},{preMultiplyAlpha:!0});h.set(s.textureOcclusion,new S.a(E.data,R))}if(Object(l.j)(s.textureEmissive)&&!h.has(s.textureEmissive)){var I=i.textures.get(s.textureEmissive),D=Object(o.a)(Object(o.a)({},I.parameters),{},{preMultiplyAlpha:!0});h.set(s.textureEmissive,new S.a(I.data,D))}if(Object(l.j)(s.textureMetallicRoughness)&&!h.has(s.textureMetallicRoughness)){var L=i.textures.get(s.textureMetallicRoughness),z=Object(o.a)(Object(o.a)({},L.parameters),{},{preMultiplyAlpha:!0});h.set(s.textureMetallicRoughness,new S.a(L.data,z))}}var V=Math.pow(s.color[0],1/C.a),N=Math.pow(s.color[1],1/C.a),U=Math.pow(s.color[2],1/C.a),B=Math.pow(s.emissiveFactor[0],1/C.a),G=Math.pow(s.emissiveFactor[1],1/C.a),q=Math.pow(s.emissiveFactor[2],1/C.a);c.set(n,new T.a(Object(o.a)(Object(o.a)({},t),{},{transparent:"BLEND"===s.alphaMode,textureAlphaMode:F(s.alphaMode),textureAlphaCutoff:s.alphaCutoff,diffuse:[V,N,U],ambient:[V,N,U],opacity:s.opacity,doubleSided:s.doubleSided,doubleSidedType:"winding-order",cullFace:s.doubleSided?0:2,vertexColors:!!e.attributes.color,vertexTangents:!!e.attributes.tangent,normals:p?"default":"screenDerivative",castShadows:!0,receiveSSAO:!0,textureId:Object(l.j)(s.textureColor)&&d?h.get(s.textureColor).id:void 0,colorMixMode:s.colorMixMode,normalTextureId:Object(l.j)(s.textureNormal)&&d?h.get(s.textureNormal).id:void 0,textureAlphaPremultiplied:!0,occlusionTextureId:Object(l.j)(s.textureOcclusion)&&d?h.get(s.textureOcclusion).id:void 0,emissiveTextureId:Object(l.j)(s.textureEmissive)&&d?h.get(s.textureEmissive).id:void 0,metallicRoughnessTextureId:Object(l.j)(s.textureMetallicRoughness)&&d?h.get(s.textureMetallicRoughness).id:void 0,emissiveFactor:[B,G,q],mrrFactors:[s.metallicFactor,s.roughnessFactor,t.mrrFactors[2]],isSchematic:!1},r)))}var H=function(e,t){switch(t){case 4:return Object(w.c)(e);case 5:return Object(w.b)(e);case 6:return Object(w.a)(e)}}(e.indices||e.attributes.position.count,e.primitiveType),W=e.attributes.position.count,Q=Object(O.a)(m.u,W);Object(y.e)(Q,e.attributes.position,e.transform);var Z=[["position",{data:Q.typedBuffer,size:Q.elementCount,exclusive:!0}]],X=[["position",H]];if(Object(l.j)(e.attributes.normal)){var Y=Object(O.a)(m.u,W);Object(u.a)(a,e.transform),Object(y.a)(Y,e.attributes.normal,a),Z.push(["normal",{data:Y.typedBuffer,size:Y.elementCount,exclusive:!0}]),X.push(["normal",H])}if(Object(l.j)(e.attributes.tangent)){var $=Object(O.a)(m.C,W);Object(u.a)(a,e.transform),Object(g.c)($,e.attributes.tangent,a),Z.push(["tangent",{data:$.typedBuffer,size:$.elementCount,exclusive:!0}]),X.push(["tangent",H])}if(Object(l.j)(e.attributes.texCoord0)){var J=Object(O.a)(m.m,W);Object(M.b)(J,e.attributes.texCoord0),Z.push(["uv0",{data:J.typedBuffer,size:J.elementCount,exclusive:!0}]),X.push(["uv0",H])}if(Object(l.j)(e.attributes.color)){var K=Object(O.a)(m.J,W);if(4===e.attributes.color.elementCount)e.attributes.color instanceof m.C?Object(g.b)(K,e.attributes.color,255):e.attributes.color instanceof m.J?Object(P.a)(K,e.attributes.color):e.attributes.color instanceof m.H&&Object(g.b)(K,e.attributes.color,1/256);else{Object(P.b)(K,255,255,255,255);var ee=new m.B(K.buffer,0,4);e.attributes.color instanceof m.u?Object(y.d)(ee,e.attributes.color,255):e.attributes.color instanceof m.B?Object(A.a)(ee,e.attributes.color):e.attributes.color instanceof m.z&&Object(y.d)(ee,e.attributes.color,1/256)}Z.push(["color",{data:K.typedBuffer,size:K.elementCount,exclusive:!0}]),X.push(["color",H])}var te=new k.a(Z,X);f.stageResources.geometries.push(te),f.stageResources.materials.push(c.get(n)),d&&(Object(l.j)(s.textureColor)&&f.stageResources.textures.push(h.get(s.textureColor)),Object(l.j)(s.textureNormal)&&f.stageResources.textures.push(h.get(s.textureNormal)),Object(l.j)(s.textureOcclusion)&&f.stageResources.textures.push(h.get(s.textureOcclusion)),Object(l.j)(s.textureEmissive)&&f.stageResources.textures.push(h.get(s.textureEmissive)),Object(l.j)(s.textureMetallicRoughness)&&f.stageResources.textures.push(h.get(s.textureMetallicRoughness))),f.numberOfVertices+=W;var re=te.boundingInfo;Object(l.j)(re)&&(Object(v.r)(f.boundingBox,re.getBBMin()),Object(v.r)(f.boundingBox,re.getBBMax()))}))}})),s}function F(e){switch(e){case"BLEND":return 0;case"MASK":return 2;case"OPAQUE":return 1;default:return 0}}function L(e,t){for(var r=0;r<e.model.lods.length;++r){var n=e.model.lods[r];e.customMeta.esriTreeRendering=!0;var i,o=Object(a.a)(n.parts);try{for(o.s();!(i=o.n()).done;){var s=i.value,c=s.attributes.normal;if(Object(l.i)(c))return;for(var u=s.attributes.position,d=u.count,v=Object(b.e)(),y=Object(b.e)(),g=Object(b.e)(),j=Object(O.a)(m.J,d),_=Object(O.a)(m.u,d),w=Object(h.a)(Object(f.d)(),s.transform),x=0;x<d;x++){u.getVec(x,y),c.getVec(x,v),Object(p.s)(y,y,s.transform),Object(p.l)(g,y,t.center),Object(p.e)(g,g,t.radius);var k=g[2],S=Object(p.r)(g),T=Math.min(.45+.55*S*S,1);Object(p.e)(g,g,t.radius),Object(p.s)(g,g,w),Object(p.t)(g,g),r+1!==e.model.lods.length&&e.model.lods.length>1&&Object(p.k)(g,g,v,k>-1?.2:Math.min(-4*k-3.8,1)),_.setVec(x,g),j.set(x,0,255*T),j.set(x,1,255*T),j.set(x,2,255*T),j.set(x,3,255)}s.attributes.normal=_,s.attributes.color=j}}catch(C){o.e(C)}finally{o.f()}}}},function(e,t,r){"use strict";var n=r(8),i=r.n(n),a=r(16),o=r(2),s=r(5),c=r(6),l=r(7),u=r(3),d=r(396),h=r(285),f=function(e){Object(c.a)(r,e);var t=Object(l.a)(r);function r(e,n,i){var a;return Object(o.a)(this,r),(a=t.call(this,n)).symbol=e,a.convert=i,a.graphics3DSymbol=null,a.referenced=0,a}return Object(s.a)(r,[{key:"getSymbolLayerSize",value:function(e){return Object(u.j)(this.graphics3DSymbol)?this.graphics3DSymbol.getSymbolLayerSize(e):null}},{key:"extentPadding",get:function(){return Object(u.j)(this.graphics3DSymbol)?this.graphics3DSymbol.extentPadding:0}},{key:"doLoad",value:function(){var e=Object(a.a)(i.a.mark((function e(t){var r;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.symbol.fetchSymbol({signal:t});case 2:return(r=e.sent).id=this.symbol.id,this.graphics3DSymbol=this.convert(r),e.next=7,this.graphics3DSymbol.load();case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"createGraphics3DGraphic",value:function(e){return Object(u.j)(this.graphics3DSymbol)?this.graphics3DSymbol.createGraphics3DGraphic(e,this):null}},{key:"complexity",get:function(){return Object(u.j)(this.graphics3DSymbol)?this.graphics3DSymbol.complexity:h.e}},{key:"globalPropertyChanged",value:function(e,t){return!!Object(u.j)(this.graphics3DSymbol)&&this.graphics3DSymbol.globalPropertyChanged(e,t)}},{key:"applyRendererDiff",value:function(e,t){return!!Object(u.j)(this.graphics3DSymbol)&&this.graphics3DSymbol.applyRendererDiff(e,t)}},{key:"prepareSymbolPatch",value:function(e){Object(u.j)(this.graphics3DSymbol)&&this.graphics3DSymbol.prepareSymbolPatch(e)}},{key:"updateGeometry",value:function(e,t){return!!Object(u.j)(this.graphics3DSymbol)&&this.graphics3DSymbol.updateGeometry(e,t)}},{key:"onRemoveGraphic",value:function(){}},{key:"getFastUpdateStatus",value:function(){return Object(u.j)(this.graphics3DSymbol)?this.graphics3DSymbol.getFastUpdateStatus():{loading:1,fast:0,slow:0}}},{key:"destroy",value:function(){Object(u.j)(this.graphics3DSymbol)&&this.graphics3DSymbol.destroy(),this.graphics3DSymbol=void 0,this.abortLoad()}},{key:"destroyed",get:function(){return void 0===this.graphics3DSymbol}}]),r}(d.a);t.a=f},function(e,t,r){"use strict";r.d(t,"a",(function(){return b})),r.d(t,"b",(function(){return p}));var n=r(14),i=r(8),a=r.n(i),o=r(16),s=r(2),c=r(5),l=(r(126),r(101)),u=r(3),d=r(23),h=r(97),f=r(254),p=function(){function e(t,r){Object(s.a)(this,e),this.spatialReference=t,this.view=r}return Object(c.a)(e,[{key:"getElevation",value:function(e,t,r){return this.view.elevationProvider.getElevation(e,t,0,this.spatialReference,r)}},{key:"queryElevation",value:function(){var e=Object(o.a)(a.a.mark((function e(t,r,n,i,o){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.view.elevationProvider.queryElevation(t,r,0,this.spatialReference,o,n,i));case 1:case"end":return e.stop()}}),e,this)})));return function(t,r,n,i,a){return e.apply(this,arguments)}}()}]),e}(),b=function(){function e(t,r,i,a){Object(s.a)(this,e),this.spatialReference=r,this._getElevationQueryProvider=i,this._queries=new Array,this._queryOptions=Object(n.a)(Object(n.a)({},a),{},{ignoreInvisibleLayers:!0}),this._frameTask=t.registerTask(h.b.ELEVATION_QUERY,this)}return Object(c.a)(e,[{key:"destroy",value:function(){this._frameTask.remove()}},{key:"queryElevation",value:function(e,t,r){var n=this,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;return new Promise((function(a,o){var s={x:e,y:t,minDemResolution:i,result:{resolve:a,reject:o},signal:r};n._queries.push(s),Object(d.s)(r,(function(){Object(l.j)(n._queries,s),o(Object(d.f)())}))}))}},{key:"running",get:function(){return this._queries.length>0}},{key:"runTask",value:function(){var e=this._queries;this._queries=[];var t=this._getElevationQueryProvider();if(t){var r=e.map((function(e){return[e.x,e.y]})),i=e.reduce((function(e,t){return Math.min(e,t.minDemResolution)}),1/0),a=new f.a({points:r,spatialReference:this.spatialReference}),o=e.length>1&&e.some((function(e){return!!e.signal}))?Object(d.e)():null,s=Object(u.j)(o)?o.signal:e[0].signal;if(Object(u.j)(o)){var c=0;e.forEach((function(t){return Object(d.s)(t.signal,(function(){c++,t.result.reject(Object(d.f)()),c===e.length&&o.abort()}))}))}var l=Object(n.a)(Object(n.a)({},this._queryOptions),{},{minDemResolution:i,signal:s});t.queryElevation(a,l).then((function(t){e.forEach((function(e,r){Object(u.j)(e.signal)&&e.signal.aborted?e.result.reject(Object(d.f)()):e.result.resolve(t.geometry.points[r][2])}))})).catch((function(t){e.forEach((function(e){return e.result.reject(t)}))}))}else e.forEach((function(e){return e.result.reject()}))}},{key:"test",get:function(){var e=this;return{update:function(){return e._queries.length>0&&e.runTask()}}}}]),e}()},function(e,t,r){"use strict";r.d(t,"a",(function(){return i})),r.d(t,"b",(function(){return a}));var n=r(2),i=function e(t){Object(n.a)(this,e),this.xTile=0,this.yTile=0,this.hash=0,this.priority=1,this.colliders=[],this.textVertexRanges=[],this.iconVertexRanges=[],this.tile=t},a=function e(){Object(n.a)(this,e),this.tileSymbols=[],this.parts=[{startTime:0,startOpacity:0,targetOpacity:0,show:!1},{startTime:0,startOpacity:0,targetOpacity:0,show:!1}],this.show=!1}},function(e,t,r){"use strict";r.d(t,"a",(function(){return u}));var n=r(2),i=r(5),a=r(6),o=r(7),s=r(3),c=function(e){Object(a.a)(r,e);var t=Object(o.a)(r);function r(){var e,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return Object(n.a)(this,r),(e=t.call(this,"LercWorker","_decode",i,{strategy:"dedicated"})).schedule=i,e.ref=0,e}return Object(i.a)(r,[{key:"decode",value:function(e,t,r){return e&&0!==e.byteLength?this.invoke({buffer:e,options:t},r):Promise.resolve(null)}},{key:"getTransferList",value:function(e){return[e.buffer]}},{key:"release",value:function(){var e=this;--this.ref<=0&&(l.forEach((function(t,r){t===e&&l.delete(r)})),this.destroy())}}]),r}(r(452).a),l=new Map;function u(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=l.get(Object(s.s)(e));return t||(Object(s.j)(e)?(t=new c((function(t){return e.schedule(t)})),l.set(e,t)):(t=new c,l.set(null,t))),++t.ref,t}},function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n,i=r(12),a=r(11);function o(e){e.attributes.add("position","vec2"),e.attributes.add("uv0","vec2"),e.vertex.uniforms.add("u_scale","float"),e.vertex.uniforms.add("u_offset","vec2"),e.varyings.add("v_texcoord","vec2"),e.vertex.code.add(Object(a.a)(n||(n=Object(i.a)(["void main(void) {\nv_texcoord = uv0 * u_scale + u_offset;\ngl_Position = vec4(position, 0.0, 1.0);\n}"]))))}},function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n,i=r(12),a=r(11);function o(e){e.fragment.uniforms.add("u_colormap","sampler2D"),e.fragment.uniforms.add("u_colormapOffset","float"),e.fragment.uniforms.add("u_colormapMaxIndex","float"),e.fragment.code.add(Object(a.a)(n||(n=Object(i.a)(["vec4 colormap(vec4 currentPixel, bool isFloat) {\nfloat clrIndex = isFloat ? currentPixel.r - u_colormapOffset : currentPixel.r * 255.0 - u_colormapOffset;\nvec4 result;\nif (currentPixel.a == 0.0 || clrIndex > u_colormapMaxIndex) {\nresult = vec4(0.0, 0.0, 0.0, 0.0);\n} else {\nvec2 clrPosition = vec2((clrIndex + 0.5) / (u_colormapMaxIndex + 1.0), 0.0);\nvec4 color = texture2D(u_colormap, clrPosition);\nresult = vec4(color.rgb, 1.0) * color.a * u_opacity;\n}\nreturn result;\n}"]))))}},function(e,t,r){"use strict";r.d(t,"a",(function(){return c}));var n,i,a,o=r(12),s=r(11);function c(e,t){e.varyings.add("tbnTangent","vec3"),e.varyings.add("tbnBiTangent","vec3"),1===t.viewingMode?e.vertex.code.add(Object(s.a)(n||(n=Object(o.a)(["void forwardVertexTangent(vec3 n) {\ntbnTangent = normalize(cross(vec3(0.0, 0.0, 1.0), n));\ntbnBiTangent = normalize(cross(n, tbnTangent));\n}"])))):e.vertex.code.add(Object(s.a)(i||(i=Object(o.a)(["void forwardVertexTangent(vec3 n) {\ntbnTangent = vec3(1.0, 0.0, 0.0);\ntbnBiTangent = normalize(cross(n, tbnTangent));\n}"])))),e.fragment.code.add(Object(s.a)(a||(a=Object(o.a)(["mat3 getTBNMatrix(vec3 n) {\nreturn mat3(tbnTangent, tbnBiTangent, n);\n}"]))))}},function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n,i=r(12),a=r(11);function o(e){e.vertex.code.add(Object(a.a)(n||(n=Object(i.a)(["vec3 applySkirts(inout vec2 uv, vec3 vpos, vec3 vnormal, float skirtScale) {\nfloat skirtLength = 0.0;\nif (uv.x >= 2.0) {\nskirtLength = uv.y * skirtScale;\nvec2 x = vec2(uv.x) - vec2(3.5, 4.5);\nuv = clamp(vec2(1.5) - abs(x), vec2(0.0), vec2(1.0));\n}\nreturn vpos - vnormal * skirtLength;\n}"]))))}},function(e,t,r){"use strict";r.d(t,"a",(function(){return y}));var n,i,a,o,s,c,l,u,d,h,f,p,b,v=r(12),m=r(11);function y(e,t){e.varyings.add("vtc","vec2"),e.vertex.uniforms.add("texOffsetAndScale","vec4"),e.fragment.uniforms.add("tex","sampler2D"),e.fragment.uniforms.add("compositeBackground","bool"),e.fragment.uniforms.add("textureOpacity","float"),e.fragment.uniforms.add("baseOpacity","float"),t.textureFadingEnabled&&(e.vertex.uniforms.add("nextTexOffsetAndScale","vec4"),e.varyings.add("nvtc","vec2"),e.fragment.uniforms.add("texNext","sampler2D"),e.fragment.uniforms.add("textureFadeFactor","float")),e.vertex.code.add(Object(m.a)(n||(n=Object(v.a)(["\n  void forwardTextureCoordinates(in vec2 uv) {\n    vtc = uv * texOffsetAndScale.zw + texOffsetAndScale.xy;\n    ","\n  }\n  "])),t.textureFadingEnabled?Object(m.a)(i||(i=Object(v.a)(["nvtc = uv * nextTexOffsetAndScale.zw + nextTexOffsetAndScale.xy;"]))):Object(m.a)(a||(a=Object(v.a)([""]))))),t.useGrid?(e.fragment.code.add(Object(m.a)(o||(o=Object(v.a)(["float lineFactorAtPosition(float value) {\nfloat pos = value * 129.0;\nif(pos < 0.5 || pos > 128.5) {\nreturn 1.0;\n}\npos = pos + 0.5;\nfloat modulo = mod(pos, 16.0);\nreturn modulo <= 2.0 ?  1.0 - abs(modulo - 1.0) : 0.0;\n}\nfloat lineFactorAtUV(vec2 uv) {\nreturn max(lineFactorAtPosition(uv.x), lineFactorAtPosition(uv.y));\n}\nfloat lineFactor(vec2 uv) {\nvec2 offset = fwidth(uv) * 0.25;\nreturn (lineFactorAtUV(vec2(uv.x + offset.x, uv.y + offset.y)) +\nlineFactorAtUV(vec2(uv.x - offset.x, uv.y + offset.y)) +\nlineFactorAtUV(vec2(uv.x + offset.x, uv.y - offset.y)) +\nlineFactorAtUV(vec2(uv.x - offset.x, uv.y - offset.y))) / 4.0;\n}"])))),e.fragment.code.add(Object(m.a)(s||(s=Object(v.a)(["\n    vec4 getTileColor() {\n      vec4 color = ",";\n      if(!compositeBackground) {\n        return color;\n      }\n\n      float line = lineFactor(vtc) * 0.1 + 0.9;\n      vec4 gridColor = vec4(1.0, 0.972, 0.918, 1.0) * line * baseOpacity;\n      float alpha = textureOpacity * color.a;\n      return mix(gridColor, color, alpha);\n    }"])),t.textureFadingEnabled?Object(m.a)(c||(c=Object(v.a)(["textureFadeFactor < 1.0 ? mix(texture2D(texNext, nvtc), texture2D(tex, vtc), textureFadeFactor) : texture2D(tex, vtc);"]))):Object(m.a)(l||(l=Object(v.a)(["texture2D(tex, vtc);"])))))):t.hasBackgroundColor?(e.fragment.uniforms.add("backgroundColor","vec4"),e.fragment.code.add(Object(m.a)(u||(u=Object(v.a)(["\n    vec4 getTileColor() {\n      vec4 color = ",";\n      float alpha = textureOpacity * color.a;\n      return compositeBackground ? mix(backgroundColor * baseOpacity, color, alpha) : color;\n    }"])),t.textureFadingEnabled?Object(m.a)(d||(d=Object(v.a)(["textureFadeFactor < 1.0 ? mix(texture2D(texNext, nvtc), texture2D(tex, vtc), textureFadeFactor) : texture2D(tex, vtc);"]))):Object(m.a)(h||(h=Object(v.a)(["texture2D(tex, vtc);"])))))):e.fragment.code.add(Object(m.a)(f||(f=Object(v.a)(["\n    vec4 getTileColor() {\n      return ","\n  }\n  "])),t.textureFadingEnabled?Object(m.a)(p||(p=Object(v.a)(["textureFadeFactor < 1.0 ? mix(texture2D(texNext, nvtc), texture2D(tex, vtc), textureFadeFactor) : texture2D(tex, vtc);"]))):Object(m.a)(b||(b=Object(v.a)(["texture2D(tex, vtc);"])))))}},function(e,t,r){"use strict";r.d(t,"a",(function(){return u}));var n,i,a,o,s=r(12),c=r(533),l=r(11);function u(e,t){1===t.componentData&&(e.vertex.uniforms.add("uComponentColorTex","sampler2D"),e.vertex.uniforms.add("uComponentColorTexInvDim","vec2"),e.attributes.add("componentIndex","float"),e.varyings.add("vExternalColorMixMode","mediump float"),e.varyings.add("vExternalColor","vec4"),e.include(c.a),e.vertex.code.add(Object(l.a)(n||(n=Object(s.a)(["vec4 _readComponentColor() {\nfloat normalizedIndex = (componentIndex + 0.5) * uComponentColorTexInvDim.x;\nvec2 indexCoord = vec2(\nmod(normalizedIndex, 1.0),\n(floor(normalizedIndex) + 0.5) * uComponentColorTexInvDim.y\n);\nreturn texture2D(uComponentColorTex, indexCoord);\n}\nvec4 forwardExternalColor(out bool castShadows) {\nvec4 componentColor = _readComponentColor() * 255.0;\nfloat shadowFlag = mod(componentColor.b * 255.0, 2.0);\ncomponentColor.b -= shadowFlag;\ncastShadows = shadowFlag >= 1.0;\nint decodedColorMixMode;\nvExternalColor = decodeSymbolColor(componentColor, decodedColorMixMode) * 0.003921568627451;\nvExternalColorMixMode = float(decodedColorMixMode) + 0.5;\nreturn vExternalColor;\n}"])))),e.fragment.code.add(Object(l.a)(i||(i=Object(s.a)(["void readExternalColor(out vec4 externalColor, out int externalColorMixMode) {\nexternalColor = vExternalColor;\nexternalColorMixMode = int(vExternalColorMixMode);\n}"]))))),0===t.componentData&&(e.vertex.uniforms.add("uExternalColor","vec4"),e.fragment.uniforms.add("uExternalColorMixMode","int"),e.varyings.add("vExternalColor","vec4"),e.vertex.code.add(Object(l.a)(a||(a=Object(s.a)(["vec4 forwardExternalColor(out bool castShadows) {\nvExternalColor = uExternalColor;\ncastShadows = true;\nreturn uExternalColor;\n}"])))),e.fragment.code.add(Object(l.a)(o||(o=Object(s.a)(["void readExternalColor(out vec4 externalColor, out int externalColorMixMode) {\nexternalColor = vExternalColor;\nexternalColorMixMode = uExternalColorMixMode;\n}"])))))}},function(e,t,r){"use strict";r.d(t,"a",(function(){return l}));var n,i,a,o,s=r(12),c=r(11);function l(e,t){var r=e.vertex;switch(r.code.add(Object(c.a)(n||(n=Object(s.a)(["#define VERTEX_DISCARD_CUTOFF (1.0 - 1.0 / 255.0)"])))),t.vertexDiscardMode){case 0:r.code.add(Object(c.a)(i||(i=Object(s.a)(["#define vertexDiscardByOpacity(_opacity_) {}"]))));break;case 2:r.code.add(Object(c.a)(a||(a=Object(s.a)(["#define vertexDiscardByOpacity(_opacity_) { if (_opacity_ >  VERTEX_DISCARD_CUTOFF) {  gl_Position = vec4(1e38, 1e38, 1e38, 1.0); return; } }"]))));break;case 1:r.code.add(Object(c.a)(o||(o=Object(s.a)(["#define vertexDiscardByOpacity(_opacity_) { if (_opacity_ <= VERTEX_DISCARD_CUTOFF) {  gl_Position = vec4(1e38, 1e38, 1e38, 1.0); return; } }"]))))}}},function(e,t,r){"use strict";r.d(t,"a",(function(){return u}));var n,i,a,o=r(12),s=r(399),c=r(532),l=r(11);function u(e,t){var r=e.fragment;t.baseColorTexture?(e.include(s.a,t),r.uniforms.add("uBaseColorTexture","sampler2D"),r.uniforms.add("uBaseColorTextureSize","vec2"),2===t.attributeTextureCoordinates?(e.include(c.a),r.code.add(Object(l.a)(n||(n=Object(o.a)(["vec4 readBaseColorTexture() {\nreturn textureAtlasLookup(\nuBaseColorTexture,\nuBaseColorTextureSize,\nvuv0,\nvuvRegion\n);\n}"]))))):r.code.add(Object(l.a)(i||(i=Object(o.a)(["vec4 readBaseColorTexture() {\nreturn texture2D(uBaseColorTexture, vuv0);\n}"]))))):r.code.add(Object(l.a)(a||(a=Object(o.a)(["vec4 readBaseColorTexture() { return vec4(1.0); }"]))))}},function(e,t,r){"use strict";r.d(t,"a",(function(){return s}));var n,i,a=r(12),o=r(11);function s(e,t){var r=e.fragment;r.constants.add("coverageTestThreshold","float",.01),t.antialiasing?r.code.add(Object(o.a)(n||(n=Object(a.a)(["#define discardByCoverage(radius, coverage) { if (coverage < coverageTestThreshold) discard; }"])))):r.code.add(Object(o.a)(i||(i=Object(a.a)(["#define discardByCoverage(radius, coverage) { float coverageLimit = radius <= 0.5 ? coverageTestThreshold : 0.75; if (coverage < coverageLimit) discard; }"]))))}},function(e,t,r){"use strict";r.d(t,"a",(function(){return l}));var n,i,a,o,s=r(12),c=r(11);function l(e,t){var r=e.vertex;t.silhouette?(r.code.add(Object(c.a)(n||(n=Object(s.a)(["bool isSilhouetteEdge(vec3 viewDir, vec3 normalA, vec3 normalB) {\nfloat faceAVisible = dot(viewDir, normalA);\nfloat faceBVisible = dot(viewDir, normalB);\nreturn faceAVisible * faceBVisible < 0.0;\n}"])))),t.legacy?r.code.add(Object(c.a)(i||(i=Object(s.a)(["bool discardNonSilhouetteEdges(vec3 viewPos, vec3 worldPos) {\nvec3 viewNormalA = _modelToViewNormal(normalA);\nvec3 viewNormalB = _modelToViewNormal(normalB);\nvec3 viewDir = -viewPos;\nif (isSilhouetteEdge(viewDir, viewNormalA, viewNormalB)) {\nreturn false;\n}\ngl_Position = vec4(10.0, 10.0, 10.0, 1.0);\nreturn true;\n}"])))):r.code.add(Object(c.a)(a||(a=Object(s.a)(["bool discardNonSilhouetteEdges(vec3 viewPos, vec3 worldPos) {\nvec3 worldNormalA = _modelToWorldNormal(normalA);\nvec3 worldNormalB = _modelToWorldNormal(normalB);\nvec3 viewDir = -worldPos;\nif (isSilhouetteEdge(viewDir, worldNormalA, worldNormalB)) {\nreturn false;\n}\ngl_Position = vec4(10.0, 10.0, 10.0, 1.0);\nreturn true;\n}"]))))):r.code.add(Object(c.a)(o||(o=Object(s.a)(["bool discardNonSilhouetteEdges(vec3 viewPos, vec3 worldPos) {\nreturn false;\n}"]))))}},function(e,t,r){"use strict";r.d(t,"a",(function(){return c}));var n,i,a,o=r(12),s=r(11);function c(e,t){var r=e.vertex;switch(t.mode){case 1:r.code.add(Object(s.a)(n||(n=Object(o.a)(["#define discardShortEdges(unpackedAttributes, lineLengthPixels) { if (lineLengthPixels <= 3.0) { gl_Position = vec4(10.0, 10.0, 10.0, 1.0); return; }}"]))));break;case 2:r.code.add(Object(s.a)(i||(i=Object(o.a)(["#define discardShortEdges(unpackedAttributes, lineLengthPixels) { if (unpackedAttributes.type <= 0.0 && lineLengthPixels <= 3.0) { gl_Position = vec4(10.0, 10.0, 10.0, 1.0); return; }}"]))));break;case 0:r.code.add(Object(s.a)(a||(a=Object(o.a)(["#define discardShortEdges(unpackedAttributes, lineLengthPixels) {}"]))))}}},function(e,t,r){"use strict";r.d(t,"a",(function(){return u}));var n,i,a,o=r(12),s=r(11),c=r(326),l=r(391);function u(e,t){var r=e.vertex;switch(e.include(l.a,t),c.a.usesSketchLogic(t)&&r.uniforms.add("uStrokesAmplitude","float"),t.mode){case 0:r.code.add(Object(s.a)(n||(n=Object(o.a)(["float calculateLineAmplitude(UnpackedAttributes unpackedAttributes) {\nreturn 0.0;\n}"]))));break;case 1:r.code.add(Object(s.a)(i||(i=Object(o.a)(["float calculateLineAmplitude(UnpackedAttributes unpackedAttributes) {\nreturn uStrokesAmplitude;\n}"]))));break;case 2:r.code.add(Object(s.a)(a||(a=Object(o.a)(["float calculateLineAmplitude(UnpackedAttributes unpackedAttributes) {\nfloat type = unpackedAttributes.type;\nif (type <= 0.0) {\nreturn uStrokesAmplitude;\n}\nelse {\nreturn 0.0;\n}\n}"]))))}}},function(e,t,r){"use strict";r.d(t,"a",(function(){return v}));var n,i,a,o,s,c,l,u,d=r(12),h=r(194),f=r(11),p=r(326),b=r(391);function v(e,t){var r=e.vertex;e.include(b.a,t);var v=e.fragment;switch(p.a.usesSketchLogic(t)&&(r.uniforms.add("uStrokesTextureScale","vec2"),r.uniforms.add("uStrokesLog2Resolution","float"),r.uniforms.add("uStrokeVariants","float"),e.varyings.add("vStrokeUV","vec2"),v.uniforms.add("uStrokesTexture","sampler2D"),v.uniforms.add("uStrokesNormalizationScale","float"),r.code.add(Object(f.a)(n||(n=Object(d.a)(["void calculateStyleOutputsSketch(float lineLength, UnpackedAttributes unpackedAttributes) {\nvec2 sidenessNorm = unpackedAttributes.sidenessNorm;\nfloat lineIndex = clamp(ceil(log2(lineLength)), 0.0, uStrokesLog2Resolution);\nvStrokeUV = vec2(exp2(lineIndex) * sidenessNorm.y, lineIndex * uStrokeVariants + variantStroke + 0.5) * uStrokesTextureScale;\nvStrokeUV.x += variantOffset;\n}"])))),e.fragment.include(h.a),v.code.add(Object(f.a)(i||(i=Object(d.a)(["float calculateLineOffsetSketch() {\nfloat offsetNorm = rgba2float(texture2D(uStrokesTexture, vStrokeUV));\nreturn (offsetNorm - 0.5) * uStrokesNormalizationScale;\n}\nfloat calculateLinePressureSketch() {\nreturn rgba2float(texture2D(uStrokesTexture, vStrokeUV + vec2(0.0, 0.5)));\n}"]))))),t.mode){case 0:r.code.add(Object(f.a)(a||(a=Object(d.a)(["void calculateStyleOutputs(UnpackedAttributes unpackedAttributes) {}"])))),v.code.add(Object(f.a)(o||(o=Object(d.a)(["float calculateLineOffset() {\nreturn 0.0;\n}\nfloat calculateLinePressure() {\nreturn 1.0;\n}"]))));break;case 1:r.code.add(Object(f.a)(s||(s=Object(d.a)(["void calculateStyleOutputs(UnpackedAttributes unpackedAttributes)\n{\ncalculateStyleOutputsSketch(vLineLengthPixels, unpackedAttributes);\n}"])))),v.code.add(Object(f.a)(c||(c=Object(d.a)(["float calculateLineOffset() {\nreturn calculateLineOffsetSketch();\n}\nfloat calculateLinePressure() {\nreturn calculateLinePressureSketch();\n}"]))));break;case 2:e.varyings.add("vType","float"),r.code.add(Object(f.a)(l||(l=Object(d.a)(["void calculateStyleOutputs(UnpackedAttributes unpackedAttributes)\n{\nvType = unpackedAttributes.type;\nif (unpackedAttributes.type <= 0.0) {\ncalculateStyleOutputsSketch(vLineLengthPixels, unpackedAttributes);\n}\n}"])))),v.code.add(Object(f.a)(u||(u=Object(d.a)(["float calculateLineOffset() {\nif (vType <= 0.0) {\nreturn calculateLineOffsetSketch();\n}\nelse {\nreturn 0.0;\n}\n}\nfloat calculateLinePressure() {\nif (vType <= 0.0) {\nreturn calculateLinePressureSketch();\n}\nelse {\nreturn 1.0;\n}\n}"]))))}}},function(e,t,r){"use strict";var n,i=r(2),a=r(5),o=r(6),s=r(7),c=r(0),l=r(58),u=r(27),d=r(25),h=r(1),f=r(18),p=(r(17),r(15),r(48)),b=r(10),v=n=function(e){Object(o.a)(r,e);var t=Object(s.a)(r);function r(e){var n;return Object(i.a)(this,r),(n=t.call(this,e)).minValue=0,n.maxValue=0,n}return Object(a.a)(r,[{key:"clone",value:function(){return new n({minValue:this.minValue,maxValue:this.maxValue})}}]),r}(u.a);Object(c.a)([Object(h.b)({type:Number,json:{write:!0}})],v.prototype,"minValue",void 0),Object(c.a)([Object(h.b)({type:Number,json:{write:!0}})],v.prototype,"maxValue",void 0);var m,y=v=n=Object(c.a)([Object(b.a)("esri.renderer.support.AuthoringInfoClassBreakInfo")],v),g=m=function(e){Object(o.a)(r,e);var t=Object(s.a)(r);function r(e){var n;return Object(i.a)(this,r),(n=t.call(this,e)).field="",n.normalizationField="",n.label="",n.classBreakInfos=[],n}return Object(a.a)(r,[{key:"clone",value:function(){return new m({field:this.field,normalizationField:this.normalizationField,label:this.label,classBreakInfos:Object(d.a)(this.classBreakInfos)})}}]),r}(u.a);Object(c.a)([Object(h.b)({type:String,json:{write:!0}})],g.prototype,"field",void 0),Object(c.a)([Object(h.b)({type:String,json:{write:!0}})],g.prototype,"normalizationField",void 0),Object(c.a)([Object(h.b)({type:String,json:{write:!0}})],g.prototype,"label",void 0),Object(c.a)([Object(h.b)({type:[y],json:{write:!0}})],g.prototype,"classBreakInfos",void 0);var O,j=g=m=Object(c.a)([Object(b.a)("esri.renderers.support.AuthoringInfoFieldInfo")],g),_=r(50),w=r(64),x=new l.a({percentTotal:"percent-of-total",ratio:"ratio",percent:"percent"}),k=new l.a({sizeInfo:"size",colorInfo:"color",transparencyInfo:"opacity",rotationInfo:"rotation"}),S={key:function(e){return"number"==typeof e?"number":"string"},typeMap:{number:Number,string:String},base:null},T=["high-to-low","above-and-below","centered-on","extremes"],C=Object(_.a)(new Set(["high-to-low","above-and-below","centered-on","extremes","90-10","above","below"].concat(["high-to-low","above-and-below","90-10","above","below"]))),M=["seconds","minutes","hours","days","months","years"],P=O=function(e){Object(o.a)(r,e);var t=Object(s.a)(r);function r(e){var n;return Object(i.a)(this,r),(n=t.call(this,e)).endTime=null,n.field=null,n.maxSliderValue=null,n.minSliderValue=null,n.startTime=null,n.type=null,n.units=null,n}return Object(a.a)(r,[{key:"castEndTime",value:function(e){return"string"==typeof e||"number"==typeof e?e:null}},{key:"castStartTime",value:function(e){return"string"==typeof e||"number"==typeof e?e:null}},{key:"style",get:function(){return"color"===this.type?this._get("style"):null},set:function(e){this._set("style",e)}},{key:"theme",get:function(){return"color"===this.type||"size"===this.type?this._get("theme")||"high-to-low":null},set:function(e){this._set("theme",e)}},{key:"clone",value:function(){return new O({endTime:this.endTime,field:this.field,maxSliderValue:this.maxSliderValue,minSliderValue:this.minSliderValue,startTime:this.startTime,style:this.style,theme:this.theme,type:this.type,units:this.units})}}]),r}(u.a);Object(c.a)([Object(h.b)({types:S,json:{write:!0}})],P.prototype,"endTime",void 0),Object(c.a)([Object(w.a)("endTime")],P.prototype,"castEndTime",null),Object(c.a)([Object(h.b)({type:String,json:{write:!0}})],P.prototype,"field",void 0),Object(c.a)([Object(h.b)({type:Number,json:{write:!0}})],P.prototype,"maxSliderValue",void 0),Object(c.a)([Object(h.b)({type:Number,json:{write:!0}})],P.prototype,"minSliderValue",void 0),Object(c.a)([Object(h.b)({types:S,json:{write:!0}})],P.prototype,"startTime",void 0),Object(c.a)([Object(w.a)("startTime")],P.prototype,"castStartTime",null),Object(c.a)([Object(h.b)({type:x.apiValues,value:null,json:{type:x.jsonValues,read:x.read,write:x.write}})],P.prototype,"style",null),Object(c.a)([Object(h.b)({type:C,value:null,json:{type:C,origins:{"web-scene":{type:T,write:{writer:function(e,t){T.indexOf(e)>-1&&(t.theme=e)}}}},write:!0}})],P.prototype,"theme",null),Object(c.a)([Object(h.b)({type:k.apiValues,json:{type:k.jsonValues,read:k.read,write:k.write}})],P.prototype,"type",void 0),Object(c.a)([Object(h.b)({type:M,json:{type:M,write:!0}})],P.prototype,"units",void 0);var A,E=P=O=Object(c.a)([Object(b.a)("esri.renderers.support.AuthoringInfoVisualVariable")],P),R=r(551),I=new l.a({esriClassifyDefinedInterval:"defined-interval",esriClassifyEqualInterval:"equal-interval",esriClassifyManual:"manual",esriClassifyNaturalBreaks:"natural-breaks",esriClassifyQuantile:"quantile",esriClassifyStandardDeviation:"standard-deviation"}),D=new l.a({classedSize:"class-breaks-size",classedColor:"class-breaks-color",univariateColorSize:"univariate-color-size",relationship:"relationship",predominance:"predominance",dotDensity:"dot-density"}),F=["inches","feet","yards","miles","nautical-miles","millimeters","centimeters","decimeters","meters","kilometers","decimal-degrees"],L=A=function(e){Object(o.a)(r,e);var t=Object(s.a)(r);function r(e){var n;return Object(i.a)(this,r),(n=t.call(this,e)).colorRamp=null,n.lengthUnit=null,n.maxSliderValue=null,n.minSliderValue=null,n.visualVariables=null,n}return Object(a.a)(r,[{key:"classificationMethod",get:function(){var e=this._get("classificationMethod"),t=this.type;return t&&"relationship"!==t?"class-breaks-size"===t||"class-breaks-color"===t?e||"manual":null:e},set:function(e){this._set("classificationMethod",e)}},{key:"readColorRamp",value:function(e){if(e)return Object(R.a)(e)}},{key:"fields",get:function(){return this.type&&"predominance"!==this.type?null:this._get("fields")},set:function(e){this._set("fields",e)}},{key:"field1",get:function(){return this.type&&"relationship"!==this.type?null:this._get("field1")},set:function(e){this._set("field1",e)}},{key:"field2",get:function(){return this.type&&"relationship"!==this.type?null:this._get("field2")},set:function(e){this._set("field2",e)}},{key:"focus",get:function(){return this.type&&"relationship"!==this.type?null:this._get("focus")},set:function(e){this._set("focus",e)}},{key:"numClasses",get:function(){return this.type&&"relationship"!==this.type?null:this._get("numClasses")},set:function(e){this._set("numClasses",e)}},{key:"statistics",get:function(){return"univariate-color-size"===this.type&&"above-and-below"===this.univariateTheme?this._get("statistics"):null},set:function(e){this._set("statistics",e)}},{key:"standardDeviationInterval",get:function(){var e=this.type;return e&&"relationship"!==e&&"class-breaks-size"!==e&&"class-breaks-color"!==e||this.classificationMethod&&"standard-deviation"!==this.classificationMethod?null:this._get("standardDeviationInterval")},set:function(e){this._set("standardDeviationInterval",e)}},{key:"type",get:function(){return this._get("type")},set:function(e){var t=e;"classed-size"===e?t="class-breaks-size":"classed-color"===e&&(t="class-breaks-color"),this._set("type",t)}},{key:"univariateSymbolStyle",get:function(){return"univariate-color-size"===this.type&&"above-and-below"===this.univariateTheme?this._get("univariateSymbolStyle"):null},set:function(e){this._set("univariateSymbolStyle",e)}},{key:"univariateTheme",get:function(){return"univariate-color-size"===this.type?this._get("univariateTheme"):null},set:function(e){this._set("univariateTheme",e)}},{key:"clone",value:function(){return new A({classificationMethod:this.classificationMethod,colorRamp:Object(d.a)(this.colorRamp),fields:this.fields&&this.fields.slice(0),field1:Object(d.a)(this.field1),field2:Object(d.a)(this.field2),focus:this.focus,numClasses:this.numClasses,maxSliderValue:this.maxSliderValue,minSliderValue:this.minSliderValue,lengthUnit:this.lengthUnit,statistics:this.statistics,standardDeviationInterval:this.standardDeviationInterval,type:this.type,visualVariables:this.visualVariables&&this.visualVariables.map((function(e){return e.clone()})),univariateSymbolStyle:this.univariateSymbolStyle,univariateTheme:this.univariateTheme})}}]),r}(u.a);Object(c.a)([Object(h.b)({type:I.apiValues,value:null,json:{type:I.jsonValues,read:I.read,write:I.write,origins:{"web-document":{default:"manual",type:I.jsonValues,read:I.read,write:I.write}}}})],L.prototype,"classificationMethod",null),Object(c.a)([Object(h.b)({types:R.b,json:{write:!0}})],L.prototype,"colorRamp",void 0),Object(c.a)([Object(p.a)("colorRamp")],L.prototype,"readColorRamp",null),Object(c.a)([Object(h.b)({type:[String],value:null,json:{write:!0}})],L.prototype,"fields",null),Object(c.a)([Object(h.b)({type:j,value:null,json:{write:!0}})],L.prototype,"field1",null),Object(c.a)([Object(h.b)({type:j,value:null,json:{write:!0}})],L.prototype,"field2",null),Object(c.a)([Object(h.b)({type:["HH","HL","LH","LL"],value:null,json:{write:!0}})],L.prototype,"focus",null),Object(c.a)([Object(h.b)({type:Number,value:null,json:{type:f.a,write:!0}})],L.prototype,"numClasses",null),Object(c.a)([Object(h.b)({type:F,json:{type:F,read:!1,write:!1,origins:{"web-scene":{read:!0,write:!0}}}})],L.prototype,"lengthUnit",void 0),Object(c.a)([Object(h.b)({type:Number,json:{write:!0,origins:{"web-scene":{write:!1,read:!1}}}})],L.prototype,"maxSliderValue",void 0),Object(c.a)([Object(h.b)({type:Number,json:{write:!0,origins:{"web-scene":{write:!1,read:!1}}}})],L.prototype,"minSliderValue",void 0),Object(c.a)([Object(h.b)({type:Object,value:null,json:{write:!0,origins:{"web-scene":{write:!1,read:!1}}}})],L.prototype,"statistics",null),Object(c.a)([Object(h.b)({type:[.25,.33,.5,1],value:null,json:{type:[.25,.33,.5,1],write:!0}})],L.prototype,"standardDeviationInterval",null),Object(c.a)([Object(h.b)({type:D.apiValues,value:null,json:{type:D.jsonValues,read:D.read,write:D.write}})],L.prototype,"type",null),Object(c.a)([Object(h.b)({type:[E],json:{write:!0}})],L.prototype,"visualVariables",void 0),Object(c.a)([Object(h.b)({type:["caret","circle-caret","arrow","circle-arrow","plus-minus","circle-plus-minus","square","circle","triangle","happy-sad","thumb","custom"],value:null,json:{write:!0,origins:{"web-scene":{write:!1}}}})],L.prototype,"univariateSymbolStyle",null),Object(c.a)([Object(h.b)({type:["high-to-low","above-and-below","above","below","90-10"],value:null,json:{write:!0,origins:{"web-scene":{write:!1}}}})],L.prototype,"univariateTheme",null);var z=L=A=Object(c.a)([Object(b.a)("esri.renderers.support.AuthoringInfo")],L);t.a=z},function(e,t,r){"use strict";r.d(t,"a",(function(){return oe}));var n=r(15),i=r(229),a=r(8),o=r.n(a),s=r(16),c=r(2),l=r(5),u=r(45),d=r(42),h=r(6),f=r(7),p=r(49),b=r(3),v=r(28),m=r(199),y=r(65),g=r(154),O=r(167),j=r(140),_=r(105),w=r(186),x=r(285),k=r(115),S=r(116),T=r(14),C=r(244),M=r(108),P=r(195),A=r(151),E=r(0),R=r(76),I=r(281),D=r(318),F=r(324),L=r(106),z=r(91),V=r(95),N=r(24),U=r(77),B=r(88),G=r(102),q=r(553),H=r(41),W=function(e){Object(h.a)(r,e);var t=Object(f.a)(r);function r(){return Object(c.a)(this,r),t.apply(this,arguments)}return Object(l.a)(r,[{key:"initializeProgram",value:function(e){var t=r.shader.get(),n=this.configuration,i=t.build({occlusionTestEnabled:n.occlusionTestEnabled,verticalOffsetEnabled:n.verticalOffset,screenSizePerspectiveEnabled:n.screenSizePerspective,depthHudEnabled:n.depthHudEnabled,depthHudAlignStartEnabled:n.depthHudAlignStartEnabled,screenCenterOffsetUnitsEnabled:n.screenCenterOffsetUnitsEnabled,slicePlaneEnabled:n.slicePlaneEnabled,sliceHighlightDisabled:!1,sliceEnabledForVertexPrograms:!0,viewingMode:e.viewingMode,isDraped:!1,multipassGeometryEnabled:n.multipassGeometryEnabled});return new B.a(e.rctx,i,U.a)}},{key:"bindPass",value:function(e,t){Object(L.c)(this.program,t.camera.projectionMatrix),q.a.bindUniforms(this.program,e,t.camera.pixelRatio||1),Object(I.b)(this.program,e,t),Object(D.b)(this.program,t),this.program.setUniform2fv("cameraNearFar",t.camera.nearFar),this.program.setUniform2fv("inverseViewport",t.inverseViewport),Object(F.a)(this.program,t),this.program.bindTexture(t.hudVisibilityTexture,"hudVisibilityTexture"),this.program.setUniform1f("cameraGroundRelative",t.camera.aboveGround?1:-1),this.program.setUniform1f("polygonOffset",e.shaderPolygonOffset),Object(L.f)(this.program,t),this.program.setUniform1f("perDistancePixelRatio",Math.tan(t.camera.fovY/2)/(t.camera.fullViewport[2]/2)),this.program.setUniformMatrix4fv("viewNormal",t.camera.viewInverseTransposeMatrix),this.program.setUniform2f("pixelToNDC",2/t.camera.fullViewport[2],2/t.camera.fullViewport[3]);var r=t.camera.pixelRatio||1;this.program.setUniform1f("lineSize",Math.ceil(e.size)*r),Object(G.a)(e.screenSizePerspective,this.program,"screenSizePerspectiveAlignment")}},{key:"bindDraw",value:function(e){Object(L.d)(this.program,e),Object(L.a)(this.program,e.origin,e.camera.viewInverseTransposeMatrix),Object(R.c)(this.program,this.configuration,e),this.program.rebindTextures()}},{key:"setPipelineState",value:function(e){var t=e?519:513;return this.configuration.depthHudEnabled?Object(H.g)({depthTest:{func:t},depthWrite:H.e}):Object(H.g)({blending:Object(H.h)(1,770,771,771),depthTest:{func:t},colorWrite:H.d})}},{key:"initializePipeline",value:function(){return this.setPipelineState(this.configuration.multipassGeometryEnabled)}}]),r}(V.a);W.shader=new z.a(q.b,(function(){return r.e(201).then(r.bind(null,1061))}));var Q=function(e){Object(h.a)(r,e);var t=Object(f.a)(r);function r(){var e;return Object(c.a)(this,r),(e=t.apply(this,arguments)).occlusionTestEnabled=!0,e.verticalOffset=!1,e.screenSizePerspective=!1,e.depthHudEnabled=!1,e.depthHudAlignStartEnabled=!1,e.screenCenterOffsetUnitsEnabled=0,e.slicePlaneEnabled=!1,e.multipassGeometryEnabled=!1,e}return r}(N.a);Object(E.a)([Object(N.b)()],Q.prototype,"occlusionTestEnabled",void 0),Object(E.a)([Object(N.b)()],Q.prototype,"verticalOffset",void 0),Object(E.a)([Object(N.b)()],Q.prototype,"screenSizePerspective",void 0),Object(E.a)([Object(N.b)()],Q.prototype,"depthHudEnabled",void 0),Object(E.a)([Object(N.b)()],Q.prototype,"depthHudAlignStartEnabled",void 0),Object(E.a)([Object(N.b)({count:2})],Q.prototype,"screenCenterOffsetUnitsEnabled",void 0),Object(E.a)([Object(N.b)()],Q.prototype,"slicePlaneEnabled",void 0),Object(E.a)([Object(N.b)()],Q.prototype,"multipassGeometryEnabled",void 0);var Z=function(e){Object(h.a)(r,e);var t=Object(f.a)(r);function r(e){var n;return Object(c.a)(this,r),(n=t.call(this,e,Y)).techniqueConfig=new Q,n._uniqueMaterialIdentifier=r.uniqueMaterialIdentifier(n.params),n}return Object(l.a)(r,[{key:"uniqueMaterialIdentifier",get:function(){return this._uniqueMaterialIdentifier}},{key:"dispose",value:function(){}},{key:"getGLMaterial",value:function(e){return 0===e.output?new X(e):void 0}},{key:"getPassParameters",value:function(){return this.params}},{key:"getTechniqueConfig",value:function(e,t){return this.techniqueConfig.occlusionTestEnabled=this.params.occlusionTest,this.techniqueConfig.verticalOffset=!!this.params.verticalOffset,this.techniqueConfig.screenSizePerspective=!!this.params.screenSizePerspective,this.techniqueConfig.depthHudEnabled=e,this.techniqueConfig.depthHudAlignStartEnabled=!!this.params.depthHUDAlignStart,this.techniqueConfig.screenCenterOffsetUnitsEnabled="screen"===this.params.centerOffsetUnits?1:0,this.techniqueConfig.slicePlaneEnabled=this.params.slicePlaneEnabled,this.techniqueConfig.multipassGeometryEnabled=!!t&&t.multipassGeometryEnabled,this.techniqueConfig}},{key:"intersect",value:function(){}},{key:"createBufferWriter",value:function(){return new K}},{key:"validateParameterValues",value:function(e){var t=r.uniqueMaterialIdentifier(e);t!==this._uniqueMaterialIdentifier&&(this._uniqueMaterialIdentifier=t)}}],[{key:"uniqueMaterialIdentifier",value:function(e){return JSON.stringify({screenOffset:e.screenOffset||[0,0],centerOffsetUnits:e.centerOffsetUnits||"world"})}}]),r}(S.a),X=function(e){Object(h.a)(r,e);var t=Object(f.a)(r);function r(e){var n;return Object(c.a)(this,r),(n=t.call(this,e))._isRenderSlot=!0,n.updateParameters(),n}return Object(l.a)(r,[{key:"updateParameters",value:function(e){this._technique=this._techniqueRep.releaseAndAcquire(W,this._material.getTechniqueConfig(!1,e),this._technique),this._depthTechnique=this._techniqueRep.releaseAndAcquire(W,this._material.getTechniqueConfig(!0,e),this._depthTechnique)}},{key:"beginSlot",value:function(e){switch(e){case 20:return this._isRenderSlot=!0,!0;case 21:return this._isRenderSlot=!1,!0}return!1}},{key:"technique",get:function(){return this._isRenderSlot?this._technique:this._depthTechnique}},{key:"ensureParameters",value:function(e){this.updateParameters(e)}},{key:"bind",value:function(e){this.technique.bindPass(this._material.getPassParameters(),e)}}]),r}(P.a),Y=Object(T.a)({verticalOffset:null,screenSizePerspective:null,screenOffset:[0,0],color:[0,0,0,1],size:1,borderColor:null,occlusionTest:!1,shaderPolygonOffset:1e-5,depthHUDAlignStart:!1,centerOffsetUnits:"world",slicePlaneEnabled:!1},S.b),$=Object(M.a)().vec3f("position").vec3f("normal").vec2f("uv0").vec4f("auxpos1"),J=[Object(C.b)(0,0),Object(C.b)(1,0),Object(C.b)(0,1),Object(C.b)(1,0),Object(C.b)(1,1),Object(C.b)(0,1)],K=function(){function e(){Object(c.a)(this,e),this.vertexBufferLayout=$}return Object(l.a)(e,[{key:"allocate",value:function(e){return this.vertexBufferLayout.createBuffer(e)}},{key:"elementCount",value:function(e){return 6*e.indices.get("position").length}},{key:"write",value:function(e,t,r,n){Object(A.e)(t.indices.get("position"),t.vertexAttributes.get("position").data,e.transformation,r.position,n,6),Object(A.d)(t.indices.get("normal"),t.vertexAttributes.get("normal").data,e.invTranspTransformation,r.normal,n,6),Object(A.a)(t.indices.get("auxpos1"),t.vertexAttributes.get("auxpos1").data,r.auxpos1,n,6);for(var i=0;i<J.length;++i)r.uv0.setVec(n+i,J[i])}}]),e}(),ee=function(e){Object(h.a)(r,e);var t=Object(f.a)(r);function r(e,n){var i;return Object(c.a)(this,r),(i=t.call(this,e,null,n,ie))._elevationOptions={supportsOffsetAdjustment:!0,supportsOnTheGround:!1},i.ensureDrapedStatus(!1),i}return Object(l.a)(r,[{key:"doLoad",value:function(){var e=Object(s.a)(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this._material=new Z(this.materialParameters),this._context.stage.add(this._material);case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"destroy",value:function(){Object(u.a)(Object(d.a)(r.prototype),"destroy",this).call(this),this._context.stage.remove(this._material),this._material=null}},{key:"perInstanceMaterialParameters",value:function(e){var t=this.materialParameters;return t.screenOffset=e.screenOffset||[0,0],t.centerOffsetUnits=e.centerOffsetUnits||"world",t}},{key:"materialParameters",get:function(){var e=this.symbol,t=e.callout,r=Object(b.j)(t.color)?p.a.toUnitRGBA(t.color):[0,0,0,0];r[3]*=this._getLayerOpacity();var n=Object(v.g)(t.size||0),i=null;if(e.verticalOffset){var a=e.verticalOffset,o=a.screenLength,s=a.minWorldLength,c=a.maxWorldLength;i={screenLength:Object(v.g)(o),minWorldLength:s||0,maxWorldLength:null!=c?c:1/0}}var l=Object(b.j)(t.border)&&Object(b.j)(t.border.color)?p.a.toUnitRGBA(t.border.color):null,u="object"===e.symbolLayers.getItemAt(0).type,d=!u,h=u?0:void 0,f="label-3d"===e.type;return{color:r,size:n,verticalOffset:i,screenSizePerspective:this._context.screenSizePerspectiveEnabled?this._context.sharedResources.screenSizePerspectiveSettings:null,screenOffset:[0,0],centerOffsetUnits:"world",borderColor:l,occlusionTest:d,shaderPolygonOffset:h,depthHUDAlignStart:f,slicePlaneEnabled:this._context.slicePlaneEnabled,renderOccluded:S.b.renderOccluded}}},{key:"_defaultElevationInfoNoZ",value:function(){return ne}},{key:"createGraphics3DGraphic",value:function(e){var t=e.renderingInfo,r=e.graphic,n=this.setGraphicElevationContext(r,new g.a,t.elevationOffset||0),i=t.symbol,a="on-the-ground"===this._elevationContext.mode&&("cim"===i.type||!i.symbolLayers.some((function(e){return"object"===e.type||"text"===e.type})));if("label-3d"!==i.type&&a)return null;var o=Object(_.a)(r.geometry);return Object(b.i)(o)?null:this._createAs3DShape(o,n,t,r.uid)}},{key:"layerOpacityChanged",value:function(){return Object(b.i)(this._material)||this._material.setParameterValues(this.materialParameters),!0}},{key:"layerElevationInfoChanged",value:function(e,t,n){var i=this,a=this._elevationContext.mode,o=Object(y.d)(r.elevationModeChangeTypes,n,a);return o!==y.a.UPDATE||e.forEach((function(e){var r=t(e);Object(b.j)(r)&&i.updateGraphicElevationContext(e.graphic,r)})),o}},{key:"slicePlaneEnabledChanged",value:function(){return Object(b.i)(this._material)||this._material.setParameterValues({slicePlaneEnabled:this._context.slicePlaneEnabled}),!0}},{key:"physicalBasedRenderingChanged",value:function(){return!0}},{key:"pixelRatioChanged",value:function(){return!0}},{key:"setGraphicElevationContext",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=Object(u.a)(Object(d.a)(r.prototype),"setGraphicElevationContext",this).call(this,e,t);return i.addOffsetRenderUnits(n),i}},{key:"updateGraphicElevationContext",value:function(e,t){this.setGraphicElevationContext(e,t.elevationContext,t.metadata.elevationOffset),t.needsElevationUpdates=Object(y.f)(t.elevationContext.mode)}},{key:"updateGeometry",value:function(e,t){return!1}},{key:"computeComplexity",value:function(){return{primitivesPerFeature:2,primitivesPerCoordinate:0,drawCallsPerFeature:0,estimated:!1,memory:x.e.memory}}},{key:"createVertexData",value:function(e){var t=e.translation,r=e.centerOffset;return[["position",t?{size:3,data:[t[0],t[1],t[2]],exclusive:!0}:{size:3,data:[0,0,0],exclusive:!0}],["normal",{size:3,data:[0,0,1],exclusive:!0}],["auxpos1",r?{size:4,data:[r[0],r[1],r[2],r[3]],exclusive:!0}:{size:4,data:[0,0,0,1],exclusive:!0}]]}},{key:"_getOrCreateMaterial",value:function(e){var t=this.perInstanceMaterialParameters(e),r=Z.uniqueMaterialIdentifier(t);if(Object(b.j)(this._material)&&r===this._material.uniqueMaterialIdentifier)return{material:this._material,isUnique:!1};if(e.materialCollection){var n=e.materialCollection.get(r);return Object(b.i)(n)&&(n=new Z(t),e.materialCollection.add(r,n)),{material:n,isUnique:!1}}return{material:new Z(t),isUnique:!0}}},{key:"_createAs3DShape",value:function(e,t,r,n){var i=[new k.a(this.createVertexData(r),re,1)],a=this._getOrCreateMaterial(r),o=Object(w.a)(this._context,e,i,[a.material],null,null,t,this._context.layer.uid,n);if(null===o)return null;var s=m.b,c=new O.a(this,o.object,i,a.isUnique?[a.material]:null,null,s,t);return c.metadata={elevationOffset:r.elevationOffset||0},c.alignedSampledElevation=o.sampledElevation,c.needsElevationUpdates=Object(y.f)(t.mode),Object(w.b)(c,e,this._context.elevationProvider),c}}]),r}(j.a);ee.elevationModeChangeTypes={definedChanged:y.a.UPDATE,staysOnTheGround:y.a.UPDATE,onTheGroundChanged:y.a.RECREATE};var te=new Uint16Array([0]),re=[["position",te],["normal",te],["auxpos1",te]],ne={mode:"relative-to-ground",offset:0},ie={ignoreDrivers:!0,renderPriority:0,renderPriorityStep:1},ae=n.a.getLogger("esri.views.3d.layers.graphics.Graphics3DCalloutSymbolLayerFactory");function oe(e,t){if(!Object(i.d)(e))return ae.error("Graphics3DCalloutSymbolLayerFactory#make","symbol of type '".concat(e.type,"' does not support callouts")),null;if(!e.callout)return null;var r=se[e.callout.type];return r?new r(e,t):(ae.error("Graphics3DCalloutSymbolLayerFactory#make","unknown or unsupported callout type ".concat(e.callout.type)),null)}var se={line:ee}},function(e,t,r){"use strict";r.d(t,"a",(function(){return c}));var n,i,a=r(12),o=r(11);function s(e){e.fragment.uniforms.add("u_transformGrid","sampler2D"),e.fragment.uniforms.add("u_transformSpacing","vec2"),e.fragment.uniforms.add("u_transformGridSize","vec2"),e.fragment.uniforms.add("u_targetImageSize","vec2"),e.fragment.code.add(Object(o.a)(n||(n=Object(a.a)(["vec2 projectPixelLocation(vec2 coords) {\nvec2 index_image = floor(coords * u_targetImageSize);\nvec2 oneTransformPixel = vec2(0.25 / u_transformGridSize.s, 1.0 / u_transformGridSize.t);\nvec2 index_transform = floor(index_image / u_transformSpacing) / u_transformGridSize;\nvec2 pos = fract((index_image + vec2(0.5, 0.5)) / u_transformSpacing);\nvec2 srcLocation;\nvec2 transform_location = index_transform + oneTransformPixel * 0.5;\nif (pos.s <= pos.t) {\nvec4 ll_abc = texture2D(u_transformGrid, vec2(transform_location.s, transform_location.t));\nvec4 ll_def = texture2D(u_transformGrid, vec2(transform_location.s + oneTransformPixel.s, transform_location.t));\nsrcLocation.s = dot(ll_abc.rgb, vec3(pos, 1.0));\nsrcLocation.t = dot(ll_def.rgb, vec3(pos, 1.0));\n} else {\nvec4 ur_abc = texture2D(u_transformGrid, vec2(transform_location.s + 2.0 * oneTransformPixel.s, transform_location.t));\nvec4 ur_def = texture2D(u_transformGrid, vec2(transform_location.s + 3.0 * oneTransformPixel.s, transform_location.t));\nsrcLocation.s = dot(ur_abc.rgb, vec3(pos, 1.0));\nsrcLocation.t = dot(ur_def.rgb, vec3(pos, 1.0));\n}\nreturn srcLocation;;\n}"]))))}function c(e){e.include(s),e.fragment.uniforms.add("u_image","sampler2D"),e.fragment.uniforms.add("u_isFloatTexture","bool"),e.fragment.uniforms.add("u_flipY","bool"),e.fragment.uniforms.add("u_applyTransform","bool"),e.fragment.uniforms.add("u_opacity","float"),e.fragment.code.add(Object(o.a)(i||(i=Object(a.a)(["vec2 getPixelLocation(vec2 coords) {\nvec2 targetLocation = u_flipY ? vec2(coords.s, 1.0 - coords.t) : coords;\nif (!u_applyTransform) {\nreturn targetLocation;\n}\nreturn projectPixelLocation(targetLocation);\n}\nbool isOutside(vec2 coords){\nif (coords.t>1.00001 ||coords.t<-0.00001 || coords.s>1.00001 ||coords.s<-0.00001) {\nreturn true;\n} else {\nreturn false;\n}\n}\nvec4 getPixel(vec2 pixelLocation) {\nreturn texture2D(u_image, pixelLocation);\n}"]))))}},function(e,t,r){"use strict";r.d(t,"a",(function(){return d}));var n,i,a,o,s=r(12),c=r(145),l=r(11);function u(e){var t=Object(l.a)(n||(n=Object(s.a)(["bool isNaN( float val )\n{\nreturn ( val < 0.0 || 0.0 < val || val == 0.0 ) ? false : true;\n}"])));e.code.add(t)}function d(e,t){e.vertex.include(u),e.include(c.a,t);var r=e.vertex;r.uniforms.add("uDepthBias","vec2"),r.uniforms.add("uViewportDimInv","vec2"),t.legacy?(r.uniforms.add("uView","mat4"),r.uniforms.add("uProj","mat4")):r.uniforms.add("uTransformNormal_ViewFromGlobal","mat3"),t.legacy?r.code.add(Object(l.a)(i||(i=Object(s.a)(["vec2 calculateProjectedBiasXY(vec4 projPos, vec3 globalNormal) {\nfloat offsetXY = uDepthBias.x;\nfloat offsetZ  = uDepthBias.y;\nvec4 projNormal = uProj * uView * vec4(globalNormal, 0.0);\nreturn offsetXY * projPos.w * 2.0 * uViewportDimInv * normalize(projNormal.xyz).xy;\n}"])))):r.code.add(Object(l.a)(a||(a=Object(s.a)(["vec2 calculateProjectedBiasXY(vec4 projPos, vec3 globalNormal) {\nfloat offsetXY = uDepthBias.x;\nfloat offsetZ  = uDepthBias.y;\nvec4 projNormal = uTransform_ProjFromView * vec4(uTransformNormal_ViewFromGlobal * globalNormal, 0.0);\nreturn offsetXY * projPos.w * 2.0 * uViewportDimInv * normalize(projNormal.xyz).xy;\n}"])))),r.code.add(Object(l.a)(o||(o=Object(s.a)(["float _calculateProjectedBiasZ(vec4 projPos) {\nfloat offsetZ = uDepthBias.y;\nreturn sqrt(projPos.z) * offsetZ;\n}\nvec4 adjustProjectedPosition(vec4 projPos, vec3 worldNormal, float lineWidth) {\nvec2 offsetXY = calculateProjectedBiasXY(projPos, worldNormal);\nif (!isNaN(offsetXY.x) && !isNaN(offsetXY.y)) {\nprojPos.xy += offsetXY;\n}\nprojPos.z += _calculateProjectedBiasZ(projPos);\nreturn projPos;\n}"]))))}},function(e,t,r){"use strict";!function e(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),e.exports=r(686)},function(e,t,r){"use strict";r.r(t),r.d(t,"createLabelFunction",(function(){return m})),r.d(t,"formatField",(function(){return g}));var n=r(8),i=r.n(n),a=r(13),o=r(16),s=r(22),c=r(15),l=r(172),u=r(165),d=r(103),h=r(251),f=r(153),p=c.a.getLogger("esri.layers.support.labelFormatUtils"),b={type:"simple",evaluate:function(){return null}},v={getAttribute:function(e,t){return e.field(t)}};function m(e,t,r){return y.apply(this,arguments)}function y(){return(y=Object(o.a)(i.a.mark((function e(t,n,a){var o,c,l,u,d,m,y;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t&&t.symbol){e.next=2;break}return e.abrupt("return",b);case 2:if(o=t.where,c=Object(h.b)(t),!o){e.next=10;break}return e.next=7,r.e(1).then(r.bind(null,683));case 7:e.t0=e.sent,e.next=11;break;case 10:e.t0=null;case 11:if(l=e.t0,"arcade"!==c.type){e.next=19;break}return e.next=15,Object(f.c)(c.expression,a,n);case 15:d=e.sent,u={type:"arcade",evaluate:function(e){try{var t=d.evaluate({$feature:"attributes"in e?d.repurposeFeature(e):d.repurposeAdapter(e)});if(null!=t)return t.toString()}catch(a){p.error(new s.a("bad-arcade-expression","Encountered an error when evaluating label expression for feature",{feature:e,expression:c}))}return null},needsHydrationToEvaluate:function(){return null==Object(h.e)(c.expression)}},e.next=20;break;case 19:u={type:"simple",evaluate:function(e){return c.expression.replace(/{[^}]*}/g,(function(t){var r=t.slice(1,-1),i=n.get(r);if(!i)return t;var a=null;return"attributes"in e?e&&e.attributes&&(a=e.attributes[i.name]):a=e.field(i.name),null==a?"":g(a,i)}))}};case 20:if(!o){e.next=30;break}e.prev=21,m=l.WhereClause.create(o,n),e.next=28;break;case 25:return e.prev=25,e.t1=e.catch(21),e.abrupt("return",b);case 28:y=u.evaluate,u.evaluate=function(e){var t="attributes"in e?void 0:v;return m.testFeature(e,t)?y(e):null};case 30:return e.abrupt("return",u);case 31:case"end":return e.stop()}}),e,null,[[21,25]])})))).apply(this,arguments)}function g(e,t){if(null==e)return"";var r=t.domain;if(r)if("codedValue"===r.type||"coded-value"===r.type){var n,i=e,o=Object(a.a)(r.codedValues);try{for(o.s();!(n=o.n()).done;){var s=n.value;if(s.code===i)return s.name}}catch(b){o.e(b)}finally{o.f()}}else if("range"===r.type){var c=+e,h="range"in r?r.range[0]:r.minValue,f="range"in r?r.range[1]:r.maxValue;if(h<=c&&c<=f)return r.name}var p=e;return"date"===t.type||"esriFieldTypeDate"===t.type?p=Object(l.b)(p,Object(l.a)("short-date")):Object(d.o)(t)&&(p=Object(u.b)(+p)),p||""}},function(e,t,r){"use strict";r.r(t);var n=r(2),i=r(5),a=r(6),o=r(7),s=r(0),c=r(22),l=r(1),u=(r(17),r(18),r(15),r(10)),d=r(572),h=r(595),f=r(571),p=function(e){Object(a.a)(r,e);var t=Object(o.a)(r);function r(){var e;return Object(n.a)(this,r),(e=t.apply(this,arguments)).type="elevation-3d",e}return Object(i.a)(r,[{key:"initialize",value:function(){var e=this.get("view.map.allLayers"),t=e&&e.includes(this.layer),r=this.get("view.map.ground.layers"),n=r&&r.includes(this.layer);if(t&&!n){var i=new c.a("layerview:elevation-layer-only","3D elevation layer '"+this.layer.id+"' can only be added in the map ground");this.addResolvingPromise(Promise.reject(i))}this._addTilingSchemeMatchPromise()}}]),r}(Object(h.a)(Object(d.a)(f.a)));Object(s.a)([Object(l.b)({readOnly:!0,aliasOf:"layer.fullExtent"})],p.prototype,"fullExtent",void 0),Object(s.a)([Object(l.b)()],p.prototype,"layer",void 0),Object(s.a)([Object(l.b)({readOnly:!0,aliasOf:"layer.tileInfo"})],p.prototype,"tileInfo",void 0);var b=p=Object(s.a)([Object(u.a)("esri.views.3d.layers.ElevationLayerView3D")],p);t.default=b},function(e,t,r){"use strict";var n,i=r(13),a=r(8),o=r.n(a),s=r(16),c=r(2),l=r(5),u=r(19),d=r(45),h=r(42),f=r(6),p=r(7),b=r(0),v=r(27),m=r(20),y=r(1),g=r(17),O=r(64),j=r(15),_=r(48),w=r(10),x=r(44),k=r(18),S=r(56),T=r(85),C=n=function(e){Object(f.a)(r,e);var t=Object(p.a)(r);function r(){var e;Object(c.a)(this,r);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return(e=t.call.apply(t,[this].concat(i))).position=new S.a([0,0,0]),e.heading=0,e.tilt=0,e.fov=55,e}return Object(l.a)(r,[{key:"normalizeCtorArgs",value:function(e,t,r,n){if(e&&"object"==typeof e&&("x"in e||Array.isArray(e))){var i={position:e};return null!=t&&(i.heading=t),null!=r&&(i.tilt=r),null!=n&&(i.fov=n),i}return e}},{key:"writePosition",value:function(e,t,r,n){var i=e.clone();i.x=Object(k.i)(e.x||0),i.y=Object(k.i)(e.y||0),i.z=e.hasZ?Object(k.i)(e.z||0):e.z,t[r]=i.write(null,n)}},{key:"readPosition",value:function(e,t){var r=new S.a;return r.read(e,t),r.x=Object(k.i)(r.x||0),r.y=Object(k.i)(r.y||0),r.z=r.hasZ?Object(k.i)(r.z||0):r.z,r}},{key:"equals",value:function(e){return!!e&&this.tilt===e.tilt&&this.heading===e.heading&&this.fov===e.fov&&this.position.equals(e.position)}},{key:"clone",value:function(){return new n({position:this.position.clone(),heading:this.heading,tilt:this.tilt,fov:this.fov})}}]),r}(v.a);Object(b.a)([Object(y.b)({type:S.a,json:{write:{isRequired:!0}}})],C.prototype,"position",void 0),Object(b.a)([Object(x.a)("position")],C.prototype,"writePosition",null),Object(b.a)([Object(_.a)("position")],C.prototype,"readPosition",null),Object(b.a)([Object(y.b)({type:Number,nonNullable:!0,json:{write:{isRequired:!0}}}),Object(O.a)((function(e){return T.e.normalize(Object(k.i)(e))}))],C.prototype,"heading",void 0),Object(b.a)([Object(y.b)({type:Number,nonNullable:!0,json:{write:{isRequired:!0}}}),Object(O.a)((function(e){return Object(m.e)(Object(k.i)(e),-180,180)}))],C.prototype,"tilt",void 0),Object(b.a)([Object(y.b)({type:Number,nonNullable:!0,json:{read:!1,write:!1}})],C.prototype,"fov",void 0);var M,P=C=n=Object(b.a)([Object(w.a)("esri.Camera")],C),A=r(126),E=r(137),R=r(337),I=r(3),D=r(100),F=M=function(e){Object(f.a)(r,e);var t=Object(p.a)(r);function r(e){var n;return Object(c.a)(this,r),(n=t.call(this,e)).rotation=0,n.scale=0,n.targetGeometry=null,n.camera=null,n}return Object(l.a)(r,[{key:"castRotation",value:function(e){return(e%=360)<0&&(e+=360),e}},{key:"clone",value:function(){return new M({rotation:this.rotation,scale:this.scale,targetGeometry:Object(I.j)(this.targetGeometry)?this.targetGeometry.clone():null,camera:Object(I.j)(this.camera)?this.camera.clone():null})}}]),r}(v.a);function L(){return{enabled:!this.camera}}Object(b.a)([Object(y.b)({type:Number,json:{write:!0,origins:{"web-map":{default:0,write:!0},"web-scene":{write:{overridePolicy:L}}}}})],F.prototype,"rotation",void 0),Object(b.a)([Object(O.a)("rotation")],F.prototype,"castRotation",null),Object(b.a)([Object(y.b)({type:Number,json:{write:!0,origins:{"web-map":{default:0,write:!0},"web-scene":{write:{overridePolicy:L}}}}})],F.prototype,"scale",void 0),Object(b.a)([Object(y.b)({types:A.a,json:{read:D.a,write:!0,origins:{"web-scene":{read:D.a,write:{overridePolicy:L}}}}})],F.prototype,"targetGeometry",void 0),Object(b.a)([Object(y.b)({type:P,json:{write:!0}})],F.prototype,"camera",void 0);var z=F=M=Object(b.a)([Object(w.a)("esri.Viewpoint")],F),V=r(53),N=r(214),U=r(22),B=r(168),G=r(191),q=r(23),H=r(141),W=r(35),Q=r(369),Z=r(28),X=r(9),Y=r(260),$=r(51),J=r(68),K=r(40),ee=r(155),te=r(468),re=r(61),ne=r(226),ie=r(14),ae=r(184),oe=r(57),se={widthBreakpoint:{getValue:function(e){var t=e.viewSize[0],r=e.breakpoints,n=this.values;return t<=r.xsmall?n.xsmall:t<=r.small?n.small:t<=r.medium?n.medium:t<=r.large?n.large:n.xlarge},values:{xsmall:"xsmall",small:"small",medium:"medium",large:"large",xlarge:"xlarge"},valueToClassName:{xsmall:"esri-view-width-xsmall esri-view-width-less-than-small esri-view-width-less-than-medium esri-view-width-less-than-large esri-view-width-less-than-xlarge",small:"esri-view-width-small esri-view-width-greater-than-xsmall esri-view-width-less-than-medium esri-view-width-less-than-large esri-view-width-less-than-xlarge",medium:"esri-view-width-medium esri-view-width-greater-than-xsmall esri-view-width-greater-than-small esri-view-width-less-than-large esri-view-width-less-than-xlarge",large:"esri-view-width-large esri-view-width-greater-than-xsmall esri-view-width-greater-than-small esri-view-width-greater-than-medium esri-view-width-less-than-xlarge",xlarge:"esri-view-width-xlarge esri-view-width-greater-than-xsmall esri-view-width-greater-than-small esri-view-width-greater-than-medium esri-view-width-greater-than-large"}},heightBreakpoint:{getValue:function(e){var t=e.viewSize[1],r=e.breakpoints,n=this.values;return t<=r.xsmall?n.xsmall:t<=r.small?n.small:t<=r.medium?n.medium:t<=r.large?n.large:n.xlarge},values:{xsmall:"xsmall",small:"small",medium:"medium",large:"large",xlarge:"xlarge"},valueToClassName:{xsmall:"esri-view-height-xsmall esri-view-height-less-than-small esri-view-height-less-than-medium esri-view-height-less-than-large esri-view-height-less-than-xlarge",small:"esri-view-height-small esri-view-height-greater-than-xsmall esri-view-height-less-than-medium esri-view-height-less-than-large esri-view-height-less-than-xlarge",medium:"esri-view-height-medium esri-view-height-greater-than-xsmall esri-view-height-greater-than-small esri-view-height-less-than-large esri-view-height-less-than-xlarge",large:"esri-view-height-large esri-view-height-greater-than-xsmall esri-view-height-greater-than-small esri-view-height-greater-than-medium esri-view-height-less-than-xlarge",xlarge:"esri-view-height-xlarge esri-view-height-greater-than-xsmall esri-view-height-greater-than-small esri-view-height-greater-than-medium esri-view-height-greater-than-large"}},orientation:{getValue:function(e){var t=e.viewSize,r=t[0],n=t[1],i=this.values;return n>=r?i.portrait:i.landscape},values:{portrait:"portrait",landscape:"landscape"},valueToClassName:{portrait:"esri-view-orientation-portrait",landscape:"esri-view-orientation-landscape"}}},ce={xsmall:544,small:768,medium:992,large:1200};function le(e,t){return t?se[e].valueToClassName[t].split(" "):[]}var ue=r(33),de=r(30),he=(r(237),r(463)),fe=r(240),pe=function(e){Object(f.a)(r,e);var t=Object(p.a)(r);function r(){var e;return Object(c.a)(this,r),(e=t.apply(this,arguments)).items=new V.a,e._watchUpdatingTracking=new fe.a,e._callbacks=new Map,e._projector=Object(he.a)(),e._hiddenProjector=Object(he.a)(),e}return Object(l.a)(r,[{key:"needsRender",get:function(){return this.items.length>0}},{key:"initialize",value:function(){var e=this,t=document.createElement("div");t.className="esri-overlay-surface",this._set("surface",t),this._hiddenSurface=document.createElement("div"),this._hiddenSurface.setAttribute("style","visibility: hidden;"),t.appendChild(this._hiddenSurface),this._watchUpdatingTracking.addOnCollectionChange(this.items,(function(t){t.added.map((function(t){var r=function(){return t.render()};e._callbacks.set(t,r),e._projector.append(e.surface,r)})),t.removed.map((function(t){var r=e._projector.detach(e._callbacks.get(t));e.surface.removeChild(r.domNode),e._callbacks.delete(t)}))}))}},{key:"addItem",value:function(e){this.items.add(e)}},{key:"removeItem",value:function(e){this.items.remove(e)}},{key:"destroy",value:function(){var e=this;this.items.removeAll(),this._callbacks.forEach((function(t){return e._projector.detach(t)})),this._callbacks=null,this._projector=null,this._watchUpdatingTracking.destroy()}},{key:"render",value:function(){this._projector.renderNow()}},{key:"computeBoundingRect",value:function(e){var t=this._hiddenSurface,r=this._hiddenProjector,n=null,i=function(){return n=e.render()};r.append(t,i),r.renderNow();var a={left:0,top:0,right:0,bottom:0};if(n&&n.domNode){var o=n.domNode.getBoundingClientRect();a.left=o.left,a.top=o.top,a.right=o.right,a.bottom=o.bottom}for(r.detach(i);t.firstChild;)t.removeChild(t.firstChild);return a}},{key:"overlaps",value:function(e,t){var r=this.computeBoundingRect(e),n=this.computeBoundingRect(t);return Math.max(r.left,n.left)<=Math.min(r.right,n.right)&&Math.max(r.top,n.top)<=Math.min(r.bottom,n.bottom)}},{key:"hasVisibleItems",get:function(){return this.items.some((function(e){return e.visible}))}},{key:"renderCanvas",value:function(e){if(this.items.some((function(e){return e.visible}))){var t=e.getContext("2d");t.save(),t.font="10px ".concat(getComputedStyle(this.surface).fontFamily),this.items.forEach((function(e){t.save(),e.renderCanvas(t),t.restore()})),t.restore()}}}]),r}(de.a);Object(b.a)([Object(y.b)({readOnly:!0})],pe.prototype,"surface",void 0),Object(b.a)([Object(y.b)({readOnly:!0})],pe.prototype,"items",void 0),Object(b.a)([Object(y.b)({readOnly:!0})],pe.prototype,"needsRender",null),Object(b.a)([Object(y.b)({readOnly:!0})],pe.prototype,"_watchUpdatingTracking",void 0),Object(b.a)([Object(y.b)({readOnly:!0,aliasOf:"_watchUpdatingTracking.updating"})],pe.prototype,"updating",void 0);var be=pe=Object(b.a)([Object(w.a)("esri.views.overlay.ViewOverlay")],pe),ve=r(21);r(343);function me(e,t,r,n){var i=null,a=1e3;"number"==typeof t?(a=t,n=r):(i=null!=t?t:null,a=r);var o,s=0,c=function(){s=0,e.apply(n,o)},l=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];i&&i.apply(n,t),o=t,a?s||(s=setTimeout(c,a)):c()};return l.remove=function(){s&&(clearTimeout(s),s=0)},l.forceUpdate=function(){s&&(clearTimeout(s),c())},l.hasPendingUpdates=function(){return!!s},l}var ye=r(62),ge=r(133),Oe=r(643),je=r(189),_e=r(543),we=r(357),xe=r(50),ke=r(147),Se=r(172),Te=r(165),Ce=r(103),Me=r(338),Pe=r(153),Ae=j.a.getLogger("esri.widgets.Feature.support.featureUtils"),Ee=/href=(""|'')/gi,Re=/(\{([^\{\r\n]+)\})/g,Ie=/\'/g,De=/^\s*expression\//i,Fe=/(\n)/gi,Le=/[\u00A0-\u9999<>\&]/gim,ze=/href\s*=\s*(?:\"([^\"]+)\"|\'([^\']+)\')/gi,Ve=/^(?:mailto:|tel:)/,Ne="relationships/",Ue=Object(Se.a)("short-date-short-time");function Be(e){if(!Object(I.i)(e))return e.get("sourceLayer")||e.get("layer")}function Ge(e,t){return qe.apply(this,arguments)}function qe(){return(qe=Object(s.a)(o.a.mark((function e(t,r){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return","function"==typeof t?t.call(null,r):t);case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function He(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";if(e)return!Ve.test(e.trim().toLowerCase())}function We(e,t){if(!function(e){return De.test(e)}(t)||!e)return null;var r,n=t.replace(De,"").toLowerCase();return e.some((function(e){return e.name.toLowerCase()===n&&(r=e,!0)})),r}function Qe(e,t){var r=We(t,null==e?void 0:e.fieldName);return r?r.title||null:e?e.label||e.fieldName:null}function Ze(e,t){var r=Xe(t,e);return r?r.name:e}function Xe(e,t){return e&&"function"==typeof e.getField?e.getField(t):null}function Ye(e){return"".concat(e).trim()}function $e(e){var t=e.attributes,r=e.globalAttributes,n=e.layer,i=e.text,a=e.expressionAttributes,o=e.fieldInfoMap;return i?Je({formattedAttributes:r,template:rt(i,Object(ie.a)(Object(ie.a)(Object(ie.a)({},r),a),t),n),fieldInfoMap:o}):""}function Je(e){var t=e.formattedAttributes,r=e.template,n=e.fieldInfoMap;return Ye(function(e){return e.replace(Ee,"")}(Object(ke.c)(Object(ke.c)(r,(function(e){return function(e,t){var r=t.get(e.toLowerCase());return"{".concat(r&&r.fieldName||e,"}")}(e,n)})),t)))}function Ke(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=t[e];if("string"==typeof n){var i="%27",a=(r?encodeURIComponent(n):n).replace(Ie,i);t[e]=a}}function et(e,t,r){var n=(t=Ye(t))&&"{"!==t[0];return Object(ke.c)(e,function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=Object(ie.a)({},e);return Object.keys(r).forEach((function(e){return Ke(e,r,t)})),r}(r,n))}function tt(e,t){return e.replace(Re,(function(e,r,n){var i=Xe(t,n);return i?"{".concat(i.name,"}"):r}))}function rt(e,t,r){var n=tt(e,r);return n?n.replace(ze,(function(e,r,n){return et(e,r||n,t)})):n}function nt(e,t){var r=t.fieldInfos,n=t.fieldName,i=it(r,n),a=null==i?void 0:i.clone(),o=t.preventPlacesFormatting,s=Xe(t.layer,n);if(a&&s&&"date"===s.type){var c=a.format||new Me.a;c.dateFormat=c.dateFormat||"short-date-short-time",a.format=c}var l=a&&a.format;return"string"==typeof(e=function(e,t){if("string"==typeof e&&t&&null==t.dateFormat&&(null!=t.places||null!=t.digitSeparator)){var r=Number(e);if(!isNaN(r))return r}return e}(e,l))||null==e||null==l?e:o?Object(Te.b)(e,Object(ie.a)(Object(ie.a)({},Object(Te.a)(l)),{},{minimumFractionDigits:0,maximumFractionDigits:20})):l.format(e)}function it(e,t){if(e&&e.length&&t){var r,n=t.toLowerCase();return e.some((function(e){return!(!e.fieldName||e.fieldName.toLowerCase()!==n)&&(r=e,!0)})),r}}function at(e){var t=[];if(!e)return t;var r=e.fieldInfos,n=e.content;return r&&t.push.apply(t,Object(xe.a)(r)),n&&Array.isArray(n)?(n.forEach((function(e){if("fields"===e.type){var r=e&&e.fieldInfos;r&&t.push.apply(t,Object(xe.a)(r))}})),t):t}function ot(e){return e.replace(Le,(function(e){return"&#".concat(e.charCodeAt(0),";")}))}function st(e){return"string"==typeof e?e.replace(Fe,'<br class="esri-text-new-line" />'):e}function ct(e){var t=e.value,r=e.fieldName,n=e.fieldInfos,i=e.fieldInfoMap,a=e.layer,o=e.graphic;if(null==t)return"";var s=function(e){var t=e.fieldName,r=e.value,n=e.graphic,i=e.layer;if(vt(t))return null;if(!i||"function"!=typeof i.getFieldDomain)return null;var a=i.getFieldDomain(t,{feature:n});return a&&"coded-value"===a.type?a.getName(r):null}({fieldName:r,value:t,graphic:o,layer:a});if(s)return s;var c=function(e){var t=e.fieldName,r=e.graphic,n=e.layer;if(vt(t))return null;if(!n||"function"!=typeof n.getFeatureType)return null;var i=n.typeIdField;if(!i||t!==i)return null;var a=n.getFeatureType(r);return a?a.name:null}({fieldName:r,graphic:o,layer:a});if(c)return c;if(i.get(r.toLowerCase()))return nt(t,{fieldInfos:n,fieldName:r,layer:a});var l=a&&a.fieldsIndex;return l&&l.isDateField(r)?Object(Se.b)(t,Ue):st(t)}function lt(e){var t=e.fieldInfos,r=e.attributes,n=e.layer,i=e.graphic,a=e.fieldInfoMap,o=e.relatedInfos,s=Object(ie.a)({},r);return null==o||o.forEach((function(e){return function(e,t){e&&t&&(t.relatedFeatures&&t.relatedFeatures&&t.relatedFeatures.forEach((function(r){return mt({attributes:e,graphic:r,relatedInfo:t})})),t.relatedStatsFeatures&&t.relatedStatsFeatures&&t.relatedStatsFeatures.forEach((function(r){return mt({attributes:e,graphic:r,relatedInfo:t})})))}(s,e)})),Object.keys(s).forEach((function(e){var r=s[e];s[e]=ct({fieldName:e,fieldInfos:t,fieldInfoMap:a,layer:n,value:r,graphic:i})})),s}function ut(e,t){return dt.apply(this,arguments)}function dt(){return(dt=Object(s.a)(o.a.mark((function e(t,r){var n,i,a,s,c,l,u,d,h,f,p,b;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=t.layer,s=t.graphic,c=t.outFields,l=t.objectIds,u=t.returnGeometry,d=t.spatialReference,"number"==typeof(h=l[0])||"string"==typeof h){e.next=4;break}return"Could not query required fields for the specified feature. The feature's ID is invalid.",f={layer:a,graphic:s,objectId:h,requiredFields:c},e.abrupt("return",(Ae.warn("Could not query required fields for the specified feature. The feature's ID is invalid.",f),null));case 4:if(null!=(n=a.capabilities)&&null!=(i=n.operations)&&i.supportsQuery){e.next=7;break}return"The specified layer cannot be queried. The following fields will not be available.",p={layer:a,graphic:s,requiredFields:c,returnGeometry:u},e.abrupt("return",(Ae.warn("The specified layer cannot be queried. The following fields will not be available.",p),null));case 7:return(b=a.createQuery()).objectIds=l,b.outFields=null!=c&&c.length?c:[a.objectIdField],b.returnGeometry=!!u,b.outSpatialReference=d,e.next=11,a.queryFeatures(b,r);case 11:return e.abrupt("return",e.sent.features[0]);case 12:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ht(e){return ft.apply(this,arguments)}function ft(){return(ft=Object(s.a)(o.a.mark((function e(t){var r,n,i;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=(r=t.expressionInfos)&&r.length){e.next=2;break}return e.abrupt("return",!1);case 2:return e.next=4,Object(Pe.e)();case 4:return n=e.sent,i=n.arcadeUtils.hasGeometryFunctions,e.abrupt("return",i(t));case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function pt(e,t){return bt.apply(this,arguments)}function bt(){return(bt=Object(s.a)(o.a.mark((function e(t,r){var n,i,a,s,c,l,u,d,h,f,p;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.graphic,i=t.popupTemplate,a=t.layer,s=t.spatialReference,a&&i){e.next=3;break}return e.abrupt("return");case 3:if(e.t0="function"==typeof a.load,!e.t0){e.next=7;break}return e.next=7,a.load(r);case 7:if(n.attributes){e.next=9;break}return e.abrupt("return");case 9:if(null!=(c=n.attributes[a.objectIdField])){e.next=12;break}return e.abrupt("return");case 12:return l=[c],e.next=15,i.getRequiredFields(a.fieldsIndex);case 15:if(u=e.sent,d=Object(Ce.h)(u,n),h=d?[]:u,e.t1=i.returnGeometry,e.t1){e.next=23;break}return e.next=22,ht(i);case 22:e.t1=e.sent;case 23:if(f=e.t1,!d||f){e.next=26;break}return e.abrupt("return");case 26:return e.next=28,ut({layer:a,graphic:n,outFields:h,objectIds:l,returnGeometry:f,spatialReference:s},r);case 28:(p=e.sent)&&(p.geometry&&(n.geometry=p.geometry),p.attributes&&(n.attributes=Object(ie.a)(Object(ie.a)({},n.attributes),p.attributes)));case 30:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function vt(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return!!e&&-1!==e.indexOf(Ne)}function mt(e){var t=e.attributes,r=e.graphic,n=e.relatedInfo;t&&r&&n&&Object.keys(r.attributes).forEach((function(e){var i=function(e){return e?"".concat(Ne).concat(e.layerId,"/").concat(e.fieldName):""}({layerId:n.relation.id.toString(),fieldName:e});t[i]=r.attributes[e]}))}var yt={editing:!1,operations:{add:!0,update:!0,delete:!0}},gt=V.a.ofType(_e.a),Ot=function(e){Object(f.a)(r,e);var t=Object(p.a)(r);function r(e){var n;return Object(c.a)(this,r),(n=t.call(this,e))._getAttachmentsPromise=null,n._attachmentLayer=null,n.abilities=Object(ie.a)({},yt),n.activeAttachmentInfo=null,n.attachmentInfos=new gt,n.graphic=null,n.mode="view",n.handles.add([Object(W.a)(Object(u.a)(n),"graphic",(function(){return n._graphicChanged()}))]),n}return Object(l.a)(r,[{key:"destroy",value:function(){this._attachmentLayer=null,this.graphic=null}},{key:"castAbilities",value:function(e){return Object(ie.a)(Object(ie.a)({},yt),e)}},{key:"state",get:function(){return this._getAttachmentsPromise?"loading":this.graphic?"ready":"disabled"}},{key:"supportsResizeAttachments",get:function(){return this.get("graphic.layer.capabilities.operations.supportsResizeAttachments")||!1}},{key:"getAttachments",value:function(){var e=Object(s.a)(o.a.mark((function e(){var t,r,n,i,a,s,c;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this._attachmentLayer,r=this.attachmentInfos,t&&"function"==typeof t.queryAttachments){e.next=3;break}throw new U.a("invalid-layer","getAttachments(): A valid layer is required.");case 3:return n=this._getFeatureId(),i=new we.a({objectIds:[n],returnMetadata:!0}),a=[],s=t.queryAttachments(i).then((function(e){return e[n]||a})).catch((function(){return a})),this._getAttachmentsPromise=s,this.notifyChange("state"),e.next=7,s;case 7:return c=e.sent,e.abrupt("return",(r.removeAll(),c.length&&r.addMany(c),this._getAttachmentsPromise=null,this.notifyChange("state"),c));case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"addAttachment",value:function(){var e=Object(s.a)(o.a.mark((function e(t){var r,n,i,a,s,c,l=this;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=this._attachmentLayer,n=this.attachmentInfos,i=this.graphic,a=this.abilities,t){e.next=3;break}throw new U.a("invalid-attachment","addAttachment(): An attachment is required.",{attachment:t});case 3:if(a.operations.add){e.next=5;break}throw new U.a("invalid-abilities","addAttachment(): add abilities are required.");case 5:if(r&&"function"==typeof r.addAttachment){e.next=7;break}throw new U.a("invalid-layer","addAttachment(): A valid layer is required.");case 7:return s=r.addAttachment(i,t).then((function(e){return l._queryAttachment(e.objectId)})),e.next=10,s;case 10:return c=e.sent,e.abrupt("return",(n.add(c),c));case 12:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"deleteAttachment",value:function(){var e=Object(s.a)(o.a.mark((function e(t){var r,n,i,a,s,c;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=this._attachmentLayer,n=this.attachmentInfos,i=this.graphic,a=this.abilities,t){e.next=3;break}throw new U.a("invalid-attachment-info","deleteAttachment(): An attachmentInfo is required.",{attachmentInfo:t});case 3:if(a.operations.delete){e.next=5;break}throw new U.a("invalid-abilities","deleteAttachment(): delete abilities are required.");case 5:if(r&&"function"==typeof r.deleteAttachments){e.next=7;break}throw new U.a("invalid-layer","deleteAttachment(): A valid layer is required.");case 7:return s=r.deleteAttachments(i,[t.id]).then((function(){return t})),e.next=10,s;case 10:return c=e.sent,e.abrupt("return",(n.remove(c),c));case 12:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"updateAttachment",value:function(){var e=Object(s.a)(o.a.mark((function e(t){var r,n,i,a,s,c,l,u,d=this,h=arguments;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=h.length>1&&void 0!==h[1]?h[1]:this.activeAttachmentInfo,n=this._attachmentLayer,i=this.attachmentInfos,a=this.graphic,s=this.abilities,t){e.next=4;break}throw new U.a("invalid-attachment","updateAttachment(): An attachment is required.",{attachment:t});case 4:if(r){e.next=6;break}throw new U.a("invalid-attachment-info","updateAttachment(): An attachmentInfo is required.",{attachmentInfo:r});case 6:if(s.operations.update){e.next=8;break}throw new U.a("invalid-abilities","updateAttachment(): Update abilities are required.");case 8:if(c=i.findIndex((function(e){return e===r})),n&&"function"==typeof n.updateAttachment){e.next=11;break}throw new U.a("invalid-layer","updateAttachment(): A valid layer is required.");case 11:return l=n.updateAttachment(a,r.id,t).then((function(e){return d._queryAttachment(e.objectId)})),e.next=14,l;case 14:return u=e.sent,e.abrupt("return",(i.splice(c,1,u),u));case 16:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_queryAttachment",value:function(){var e=Object(s.a)(o.a.mark((function e(t){var r,n,i;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}throw new U.a("invalid-attachment-id","Could not query attachment.");case 2:return r=this._attachmentLayer,n=this._getFeatureId(),i=new we.a({objectIds:[n],attachmentsWhere:"AttachmentId=".concat(t),returnMetadata:!0}),e.abrupt("return",r.queryAttachments(i).then((function(e){return e[n][0]})));case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_getFeatureId",value:function(){var e=this._attachmentLayer,t=this.graphic;if(!e||!t)return null;var r=e.objectIdField,n=t.attributes;return n&&n[r]}},{key:"_graphicChanged",value:function(){this.graphic&&(this._setAttachmentLayer(),this.getAttachments().catch((function(){})))}},{key:"_setAttachmentLayer",value:function(){var e=Be(this.graphic);this._attachmentLayer=e?"scene"===e.type&&Object(I.j)(e.associatedLayer)?e.associatedLayer:e:null}}]),r}(je.a);Object(b.a)([Object(y.b)()],Ot.prototype,"abilities",void 0),Object(b.a)([Object(O.a)("abilities")],Ot.prototype,"castAbilities",null),Object(b.a)([Object(y.b)()],Ot.prototype,"activeAttachmentInfo",void 0),Object(b.a)([Object(y.b)({readOnly:!0,type:gt})],Ot.prototype,"attachmentInfos",void 0),Object(b.a)([Object(y.b)({type:E.a})],Ot.prototype,"graphic",void 0),Object(b.a)([Object(y.b)()],Ot.prototype,"mode",void 0),Object(b.a)([Object(y.b)({readOnly:!0})],Ot.prototype,"state",null),Object(b.a)([Object(y.b)({readOnly:!0})],Ot.prototype,"supportsResizeAttachments",null);var jt=Ot=Object(b.a)([Object(w.a)("esri.widgets.Attachments.AttachmentsViewModel")],Ot),_t=r(93);var wt=r(83),xt=r(143),kt=r(36),St={addButton:!0,addSubmitButton:!0,cancelAddButton:!0,cancelUpdateButton:!0,deleteButton:!0,errorMessage:!0,progressBar:!0,updateButton:!0},Tt="esri-attachments",Ct="esri-attachments__loader-container",Mt="esri-attachments__loader",Pt="esri-attachments__container",At="esri-attachments__container--list",Et="esri-attachments__container--preview",Rt="esri-attachments__actions",It="esri-attachments__delete-button",Dt="esri-attachments__add-attachment-button",Ft="esri-attachments__error-message",Lt="esri-attachments__items",zt="esri-attachments__item",Vt="esri-attachments__item-button",Nt="esri-attachments__item-mask",Ut="esri-attachments__item-mask--icon",Bt="esri-attachments__image",Gt="esri-attachments__image--resizable",qt="esri-attachments__label",Ht="esri-attachments__filename",Wt="esri-attachments__item-chevron-icon",Qt="esri-attachments__item-link",Zt="esri-attachments__item-link-overlay",Xt="esri-attachments__item-link-overlay-icon",Yt="esri-attachments__item-add-icon",$t="esri-attachments__form-node",Jt="esri-attachments__file-fieldset",Kt="esri-attachments__file-label",er="esri-attachments__file-name",tr="esri-attachments__file-input",rr="esri-attachments__metadata",nr="esri-attachments__metadata-fieldset",ir="esri-attachments__progress-bar",ar="esri-widget",or="esri-button",sr="esri-button--disabled",cr="esri-button--secondary",lr="esri-button--tertiary",ur="esri-button--third",dr="esri-button--small",hr="esri-button--half",fr="esri-widget__content--empty",pr="esri-icon-right",br="esri-icon-left",vr="esri-icon-plus",mr=window.CSS,yr=function(e){Object(f.a)(r,e);var t=Object(p.a)(r);function r(e,n){var i;return Object(c.a)(this,r),(i=t.call(this,e,n)).abilities=null,i.displayType="list",i.graphic=null,i.label=void 0,i.messages=null,i.messagesUnits=null,i.selectedFile=null,i.submitting=!1,i.viewModel=new jt,i.visibleElements=Object(ie.a)({},St),i._supportsImageOrientation=mr&&mr.supports&&mr.supports("image-orientation","from-image"),i._addAttachmentForm=null,i._updateAttachmentForm=null,i}return Object(l.a)(r,[{key:"initialize",value:function(){var e=this;this.own(Object(W.b)(this,"viewModel.attachmentInfos","change",(function(){return e.scheduleRender()})),Object(W.a)(this,"viewModel.mode",(function(){return e._modeChanged()})))}},{key:"castVisibleElements",value:function(e){return Object(ie.a)(Object(ie.a)({},St),e)}},{key:"addAttachment",value:function(){var e=this,t=this._addAttachmentForm,r=this.viewModel;return this._set("submitting",!0),this._set("error",null),r.addAttachment(t).then((function(t){return e._set("submitting",!1),e._set("error",null),r.mode="view",t})).catch((function(t){throw e._set("submitting",!1),e._set("error",new U.a("attachments:add-attachment",e.messages.addErrorMessage,t)),t}))}},{key:"deleteAttachment",value:function(e){var t=this,r=this.viewModel;return this._set("submitting",!0),this._set("error",null),r.deleteAttachment(e).then((function(e){return t._set("submitting",!1),t._set("error",null),r.mode="view",e})).catch((function(e){throw t._set("submitting",!1),t._set("error",new U.a("attachments:delete-attachment",t.messages.deleteErrorMessage,e)),e}))}},{key:"updateAttachment",value:function(){var e=this,t=this.viewModel,r=this._updateAttachmentForm;return this._set("submitting",!0),this._set("error",null),t.updateAttachment(r).then((function(r){return e._set("submitting",!1),e._set("error",null),t.mode="view",r})).catch((function(t){throw e._set("submitting",!1),e._set("error",new U.a("attachments:update-attachment",e.messages.updateErrorMessage,t)),t}))}},{key:"render",value:function(){var e=this.submitting,t=this.viewModel.state;return Object(kt.a)("div",{class:this.classes(Tt,ar)},e?this.renderProgressBar():null,"loading"===t?this.renderLoading():this.renderAttachments(),this.renderErrorMessage())}},{key:"renderErrorMessage",value:function(){var e=this.error,t=this.visibleElements;return e&&t.errorMessage?Object(kt.a)("div",{key:"error-message",class:Ft},e.message):null}},{key:"renderAttachments",value:function(){var e=this.viewModel,t=e.mode,r=e.activeAttachmentInfo;return"add"===t?this.renderAddForm():"edit"===t?this.renderDetailsForm(r):this.renderAttachmentContainer()}},{key:"renderLoading",value:function(){return Object(kt.a)("div",{class:Ct,key:"loader"},Object(kt.a)("div",{class:Mt}))}},{key:"renderProgressBar",value:function(){return this.visibleElements.progressBar?Object(kt.a)("div",{class:ir,key:"progress-bar"}):null}},{key:"renderAddForm",value:function(){var e=this.submitting,t=this.selectedFile,r=e||!t,n=this.visibleElements.cancelAddButton?Object(kt.a)("button",{type:"button",bind:this,disabled:e,onclick:this._cancelForm,class:this.classes(or,lr,dr,hr,e&&sr)},this.messages.cancel):null,i=this.visibleElements.addSubmitButton?Object(kt.a)("button",{type:"submit",disabled:r,class:this.classes(or,cr,dr,hr,Object(ve.a)({},sr,r))},this.messages.add):null,a=t?Object(kt.a)("span",{key:"file-name",class:er},t.name):null,o=Object(kt.a)("form",{bind:this,afterCreate:wt.j,afterRemoved:wt.c,"data-node-ref":"_addAttachmentForm",onsubmit:this._submitAddAttachment},Object(kt.a)("fieldset",{class:Jt},a,Object(kt.a)("label",{class:this.classes(Kt,or,cr)},t?this.messages.changeFile:this.messages.selectFile,Object(kt.a)("input",{class:tr,type:"file",name:"attachment",bind:this,onchange:this._handleFileInputChange}))),i,n);return Object(kt.a)("div",{key:"add-form-container",class:$t},o)}},{key:"renderDetailsForm",value:function(e){var t=this,r=this.visibleElements,n=this.viewModel,i=this.selectedFile,a=this.submitting,o=e.contentType,s=e.size,c=e.url,l=n.abilities,u=a||!i,d=l.editing&&l.operations.delete&&r.deleteButton?Object(kt.a)("button",{key:"delete-button",type:"button",disabled:a,bind:this,onclick:function(r){return t._submitDeleteAttachment(r,e)},class:this.classes(or,dr,lr,It,Object(ve.a)({},sr,a))},this.messages.delete):null,h=l.editing&&l.operations.update&&r.updateButton?Object(kt.a)("button",{disabled:u,key:"update-button",type:"submit",class:this.classes(or,dr,ur,Object(ve.a)({},sr,u))},this.messages.update):null,f=this.visibleElements.cancelUpdateButton?Object(kt.a)("button",{disabled:a,key:"cancel-button",type:"button",bind:this,onclick:this._cancelForm,class:this.classes(or,dr,lr,ur,Object(ve.a)({},sr,a))},this.messages.cancel):null,p=i?Object(kt.a)("span",{key:"file-name",class:er},i.name):null,b=l.editing&&l.operations.update?Object(kt.a)("fieldset",{key:"file",class:Jt},p,Object(kt.a)("label",{class:this.classes(Kt,or,cr)},this.messages.changeFile,Object(kt.a)("input",{class:tr,type:"file",name:"attachment",bind:this,onchange:this._handleFileInputChange}))):null,v=Object(kt.a)("fieldset",{key:"size",class:nr},Object(kt.a)("label",null,Object(Oe.c)(this.messagesUnits,s))),m=Object(kt.a)("fieldset",{key:"content-type",class:nr},Object(kt.a)("label",null,o)),y=Object(kt.a)("form",{bind:this,afterCreate:wt.j,afterRemoved:wt.c,"data-node-ref":"_updateAttachmentForm",onsubmit:this._submitUpdateAttachment},Object(kt.a)("div",{class:rr},v,m),b,Object(kt.a)("div",{class:Rt},d,f,h));return Object(kt.a)("div",{key:"edit-form-container",class:$t},Object(kt.a)("a",{class:Qt,href:c,rel:"noreferrer",target:"_blank"},this.renderImageMask({attachmentInfo:e,size:400}),Object(kt.a)("div",{class:Zt},Object(kt.a)("span",{class:Xt},Object(kt.a)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"32",height:"32",viewBox:"0 0 32 32"},Object(kt.a)("path",{d:"M28 13h1v16H3V3h16v1H4v24h24zm-5-9h4.293L15.646 15.638l.707.707L28 4.707V9h1V3h-6z"}),Object(kt.a)("path",{fill:"none",d:"M0 0h32v32H0z"}))))),y)}},{key:"renderImageMask",value:function(e){var t=e.attachmentInfo,r=e.size,n=this.viewModel.supportsResizeAttachments,i=t.contentType,a=t.name,o=t.url,s=n&&function(e){var t=e.toLowerCase();return"image/bmp"===t||"image/emf"===t||"image/exif"===t||"image/gif"===t||"image/x-icon"===t||"image/jpeg"===t||"image/png"===t||"image/tiff"===t||"image/x-wmf"===t}(i),c=this._getCSSTransform(t,s),l=c?{transform:c,"image-orientation":"none"}:{},u=-1===o.indexOf("?")?"?":"&",d=s?"".concat(o).concat(u,"w=").concat(r):function(e){var t=Object(_t.b)("esri/themes/base/images/files/");return e?"text/plain"===e?"".concat(t,"text-32.svg"):"application/pdf"===e?"".concat(t,"pdf-32.svg"):"text/csv"===e?"".concat(t,"csv-32.svg"):"application/gpx+xml"===e?"".concat(t,"gpx-32.svg"):"application/x-dwf"===e?"".concat(t,"cad-32.svg"):"application/postscript"===e||"application/json"===e||"text/xml"===e||"model/vrml"===e?"".concat(t,"code-32.svg"):"application/x-zip-compressed"===e||"application/x-7z-compressed"===e||"application/x-gzip"===e||"application/x-tar"===e||"application/x-gtar"===e||"application/x-bzip2"===e||"application/gzip"===e||"application/x-compress"===e||"application/x-apple-diskimage"===e||"application/x-rar-compressed"===e||"application/zip"===e?"".concat(t,"zip-32.svg"):-1!==e.indexOf("image/")?"".concat(t,"image-32.svg"):-1!==e.indexOf("audio/")?"".concat(t,"sound-32.svg"):-1!==e.indexOf("video/")?"".concat(t,"video-32.svg"):-1!==e.indexOf("msexcel")||-1!==e.indexOf("ms-excel")||-1!==e.indexOf("spreadsheetml")?"".concat(t,"excel-32.svg"):-1!==e.indexOf("msword")||-1!==e.indexOf("ms-word")||-1!==e.indexOf("wordprocessingml")?"".concat(t,"word-32.svg"):-1!==e.indexOf("powerpoint")||-1!==e.indexOf("presentationml")?"".concat(t,"report-32.svg"):"".concat(t,"generic-32.svg"):"".concat(t,"generic-32.svg")}(i),h=Object(ve.a)({},Ut,!s),f=Object(ve.a)({},Gt,n);return Object(kt.a)("div",{class:this.classes(h,Nt)},Object(kt.a)("img",{styles:l,alt:a,src:d,class:this.classes(f,Bt)}))}},{key:"renderAttachmentInfo",value:function(e){var t=this,r=e.attachmentInfo,n=e.displayType,i=this.viewModel.abilities,a=r.name,o=r.url,s=this.renderImageMask({attachmentInfo:r,size:"list"===n?48:400}),c=i.editing?Object(kt.a)("span",{"aria-hidden":"true",class:this.classes(Wt,Object(wt.h)()?br:pr)}):null,l=[s,Object(kt.a)("label",{class:qt},Object(kt.a)("span",{class:Ht},a||this.messages.noTitle),c)],u=i.editing?Object(kt.a)("button",{key:"details-button",bind:this,class:Vt,title:this.messages.attachmentDetails,"aria-label":this.messages.attachmentDetails,"data-attachment-info-id":r.id,onclick:function(){return t._startEditAttachment(r)},type:"button"},l):Object(kt.a)("a",{key:"details-link",class:Vt,href:o,target:"_blank"},l);return Object(kt.a)("li",{class:zt,key:r},u)}},{key:"renderAttachmentContainer",value:function(){var e,t=this,r=this.displayType,n=this.viewModel,i=this.visibleElements,a=n.attachmentInfos,o=n.abilities,s=a&&a.length,c=(e={},Object(ve.a)(e,At,"preview"!==r),Object(ve.a)(e,Et,"preview"===r),e),l=o.editing&&o.operations.add&&i.addButton?Object(kt.a)("button",{bind:this,onclick:function(){return t._startAddAttachment()},class:this.classes(or,lr,Dt),type:"button"},Object(kt.a)("span",{"aria-hidden":"true",class:this.classes(Yt,vr)}),this.messages.add):null,u=s?Object(kt.a)("ul",{class:Lt},a.toArray().map((function(e){return t.renderAttachmentInfo({attachmentInfo:e,displayType:r})}))):Object(kt.a)("div",{class:fr},this.messages.noAttachments);return Object(kt.a)("div",{key:"attachments-container",class:this.classes(Pt,c)},u,l)}},{key:"_modeChanged",value:function(){this._set("error",null),this._set("selectedFile",null)}},{key:"_handleFileInputChange",value:function(e){var t=e.target,r=t&&t.files&&t.files.item(0);this._set("selectedFile",r)}},{key:"_submitDeleteAttachment",value:function(e,t){e.preventDefault(),this.deleteAttachment(t)}},{key:"_submitAddAttachment",value:function(e){e.preventDefault(),this.addAttachment()}},{key:"_submitUpdateAttachment",value:function(e){e.preventDefault(),this.updateAttachment()}},{key:"_startEditAttachment",value:function(e){var t=this.viewModel;t.activeAttachmentInfo=e,t.mode="edit"}},{key:"_startAddAttachment",value:function(){this.viewModel.mode="add"}},{key:"_cancelForm",value:function(e){e.preventDefault(),this.viewModel.mode="view"}},{key:"_getCSSTransform",value:function(e,t){var r=e.orientationInfo;return!this._supportsImageOrientation&&t&&r?[r.rotation?"rotate(".concat(r.rotation,"deg)"):"",r.mirrored?"scaleX(-1)":""].join(" "):""}}]),r}(ge.a);Object(b.a)([Object(ye.a)("viewModel.abilities")],yr.prototype,"abilities",void 0),Object(b.a)([Object(y.b)()],yr.prototype,"displayType",void 0),Object(b.a)([Object(ye.a)("viewModel.graphic")],yr.prototype,"graphic",void 0),Object(b.a)([Object(y.b)({aliasOf:{source:"messages.widgetLabel",overridable:!0}})],yr.prototype,"label",void 0),Object(b.a)([Object(y.b)(),Object(xt.a)("esri/widgets/Attachments/t9n/Attachments")],yr.prototype,"messages",void 0),Object(b.a)([Object(y.b)(),Object(xt.a)("esri/core/t9n/Units")],yr.prototype,"messagesUnits",void 0),Object(b.a)([Object(y.b)({readOnly:!0})],yr.prototype,"selectedFile",void 0),Object(b.a)([Object(y.b)({readOnly:!0})],yr.prototype,"submitting",void 0),Object(b.a)([Object(y.b)({readOnly:!0})],yr.prototype,"error",void 0),Object(b.a)([Object(y.b)({type:jt})],yr.prototype,"viewModel",void 0),Object(b.a)([Object(y.b)()],yr.prototype,"visibleElements",void 0),Object(b.a)([Object(O.a)("visibleElements")],yr.prototype,"castVisibleElements",null);var gr=yr=Object(b.a)([Object(w.a)("esri.widgets.Attachments")],yr),Or=function(e){Object(f.a)(r,e);var t=Object(p.a)(r);function r(e){var n;return Object(c.a)(this,r),(n=t.call(this,e)).description=null,n.title=null,n}return r}(jt);Object(b.a)([Object(y.b)()],Or.prototype,"description",void 0),Object(b.a)([Object(y.b)()],Or.prototype,"title",void 0);var jr=Or=Object(b.a)([Object(w.a)("esri.widgets.Feature.FeatureAttachments.FeatureAttachmentsViewModel")],Or),_r="esri-widget__heading";function wr(e,t){var r="h".concat(Object(m.e)(Math.ceil(e.level),1,6));return delete e.level,Object(kt.a)(r,Object(ie.a)(Object(ie.a)({},e),{},{class:Object(wt.a)(_r,e.class)}),t)}var xr="esri-feature-element-info",kr="esri-feature-element-info__title",Sr="esri-feature-element-info__description",Tr=function(e){Object(f.a)(r,e);var t=Object(p.a)(r);function r(e,n){var i;return Object(c.a)(this,r),(i=t.call(this,e,n)).description=null,i.headingLevel=2,i.title=null,i}return Object(l.a)(r,[{key:"render",value:function(){return Object(kt.a)("div",{class:xr},this.renderTitle(),this.renderDescription())}},{key:"renderTitle",value:function(){var e=this.title;return e?Object(kt.a)(wr,{level:this.headingLevel,class:kr},e):null}},{key:"renderDescription",value:function(){var e=this.description;return e?Object(kt.a)("div",{key:"description",class:Sr},e):null}}]),r}(ge.a);Object(b.a)([Object(y.b)()],Tr.prototype,"description",void 0),Object(b.a)([Object(y.b)()],Tr.prototype,"headingLevel",void 0),Object(b.a)([Object(y.b)()],Tr.prototype,"title",void 0);var Cr=Tr=Object(b.a)([Object(w.a)("esri.widgets.Feature.support.FeatureElementInfo")],Tr),Mr="esri-feature-attachments",Pr=function(e){Object(f.a)(r,e);var t=Object(p.a)(r);function r(e,n){var i;return Object(c.a)(this,r),(i=t.call(this,e,n))._featureElementInfo=null,i.attachmentsWidget=new gr,i.description=null,i.displayType=null,i.graphic=null,i.headingLevel=2,i.title=null,i.viewModel=new jr,i}return Object(l.a)(r,[{key:"initialize",value:function(){var e=this;this._featureElementInfo=new Cr,Object(W.a)(this,["viewModel.description","viewModel.title","headingLevel"],(function(){return e._setupFeatureElementInfo()})),Object(W.a)(this,"viewModel.graphic",(function(t){return e.attachmentsWidget.graphic=t}))}},{key:"destroy",value:function(){this.attachmentsWidget.destroy(),this._featureElementInfo.destroy()}},{key:"render",value:function(){var e,t=this.attachmentsWidget;return Object(kt.a)("div",{class:Mr},null==(e=this._featureElementInfo)?void 0:e.render(),null==t?void 0:t.render())}},{key:"_setupFeatureElementInfo",value:function(){var e=this.description,t=this.title,r=this.headingLevel;this._featureElementInfo.set({description:e,title:t,headingLevel:r})}}]),r}(ge.a);Object(b.a)([Object(y.b)({readOnly:!0})],Pr.prototype,"attachmentsWidget",void 0),Object(b.a)([Object(ye.a)("viewModel.description")],Pr.prototype,"description",void 0),Object(b.a)([Object(ye.a)("attachmentsWidget.displayType")],Pr.prototype,"displayType",void 0),Object(b.a)([Object(ye.a)("viewModel.graphic")],Pr.prototype,"graphic",void 0),Object(b.a)([Object(y.b)()],Pr.prototype,"headingLevel",void 0),Object(b.a)([Object(ye.a)("viewModel.title")],Pr.prototype,"title",void 0),Object(b.a)([Object(y.b)({type:jr})],Pr.prototype,"viewModel",void 0);var Ar=Pr=Object(b.a)([Object(w.a)("esri.widgets.Feature.FeatureAttachments")],Pr),Er=function(e){Object(f.a)(r,e);var t=Object(p.a)(r);function r(e){var n;return Object(c.a)(this,r),(n=t.call(this,e))._loadingPromise=null,n.created=null,n.creator=null,n.destroyer=null,n.graphic=null,n.handles.add(Object(W.a)(Object(u.a)(n),"creator",(function(e){n._destroyContent(),n._createContent(e)}))),n}return Object(l.a)(r,[{key:"destroy",value:function(){this._destroyContent()}},{key:"state",get:function(){return this._loadingPromise?"loading":"ready"}},{key:"_destroyContent",value:function(){var e=this.created,t=this.graphic,r=this.destroyer;e&&(Ge(r,{graphic:t}).catch((function(){return null})),this._set("created",null))}},{key:"_createContent",value:function(){var e=Object(s.a)(o.a.mark((function e(t){var r,n,i;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=this.graphic,n=Ge(t,{graphic:r}).catch((function(){return null})),this._loadingPromise=n,this.notifyChange("state"),e.next=4,n;case 4:i=e.sent,n===this._loadingPromise&&(this._loadingPromise=null,this.notifyChange("state"),this._set("created",i));case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),r}(Object(je.b)(de.a));Object(b.a)([Object(y.b)({readOnly:!0})],Er.prototype,"created",void 0),Object(b.a)([Object(y.b)()],Er.prototype,"creator",void 0),Object(b.a)([Object(y.b)()],Er.prototype,"destroyer",void 0),Object(b.a)([Object(y.b)({type:E.a})],Er.prototype,"graphic",void 0),Object(b.a)([Object(y.b)({readOnly:!0})],Er.prototype,"state",null);var Rr=Er=Object(b.a)([Object(w.a)("esri.widgets.Feature.FeatureContent.FeatureContentViewModel")],Er),Ir=r(432),Dr="esri-feature-content",Fr="esri-feature-content__loader-container",Lr="esri-feature-content__loader",zr=function(e){Object(f.a)(r,e);var t=Object(p.a)(r);function r(e,n){var i;return Object(c.a)(this,r),(i=t.call(this,e,n)).creator=null,i.graphic=null,i.viewModel=null,i._addTargetToAnchors=function(e){Array.from(e.querySelectorAll("a")).forEach((function(e){He(e.href)&&!e.hasAttribute("target")&&e.setAttribute("target","_blank")}))},i}return Object(l.a)(r,[{key:"renderLoading",value:function(){return Object(kt.a)("div",{class:Fr,key:"loader"},Object(kt.a)("div",{class:Lr}))}},{key:"renderCreated",value:function(){var e,t=null==(e=this.viewModel)?void 0:e.created;return t?t instanceof HTMLElement?Object(kt.a)("div",{key:t,bind:t,afterCreate:this._attachToNode}):Object(Ir.b)(t)?Object(kt.a)("div",{key:t},!t.destroyed&&t.render()):Object(kt.a)("div",{key:t,innerHTML:t,afterCreate:this._addTargetToAnchors}):null}},{key:"render",value:function(){var e,t=null==(e=this.viewModel)?void 0:e.state;return Object(kt.a)("div",{class:Dr},"loading"===t?this.renderLoading():this.renderCreated())}},{key:"_attachToNode",value:function(e){e.appendChild(this)}}]),r}(ge.a);Object(b.a)([Object(ye.a)("viewModel.creator")],zr.prototype,"creator",void 0),Object(b.a)([Object(ye.a)("viewModel.graphic")],zr.prototype,"graphic",void 0),Object(b.a)([Object(y.b)({type:Rr})],zr.prototype,"viewModel",void 0);var Vr=zr=Object(b.a)([Object(w.a)("esri.widgets.Feature.FeatureContent")],zr),Nr=r(483),Ur=r(289),Br=function(e){Object(f.a)(r,e);var t=Object(p.a)(r);function r(e){var n;return Object(c.a)(this,r),(n=t.call(this,e)).attributes=null,n.expressionInfos=null,n.description=null,n.fieldInfos=null,n.title=null,n}return Object(l.a)(r,[{key:"formattedFieldInfos",get:function(){var e=this.expressionInfos,t=this.fieldInfos,r=[];return null==t||t.forEach((function(t){if(!t.hasOwnProperty("visible")||t.visible){var n=t.clone();n.label=Qe(n,e),r.push(n)}})),r}}]),r}(de.a);Object(b.a)([Object(y.b)()],Br.prototype,"attributes",void 0),Object(b.a)([Object(y.b)({type:[Nr.a]})],Br.prototype,"expressionInfos",void 0),Object(b.a)([Object(y.b)()],Br.prototype,"description",void 0),Object(b.a)([Object(y.b)({type:[Ur.a]})],Br.prototype,"fieldInfos",void 0),Object(b.a)([Object(y.b)({readOnly:!0})],Br.prototype,"formattedFieldInfos",null),Object(b.a)([Object(y.b)()],Br.prototype,"title",void 0);var Gr=Br=Object(b.a)([Object(w.a)("esri.widgets.Feature.FeatureFields.FeatureFieldsViewModel")],Br),qr=[{pattern:/^\s*(https?:\/\/([^\s]+))\s*$/i,target:"_blank",label:"{messages.view}"},{pattern:/^\s*(tel:([^\s]+))\s*$/i,label:"{hierPart}"},{pattern:/^\s*(mailto:([^\s]+))\s*$/i,label:"{hierPart}"},{pattern:/^\s*(arcgis-appstudio-player:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"App Studio Player"},{pattern:/^\s*(arcgis-collector:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Collector"},{pattern:/^\s*(arcgis-explorer:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Explorer"},{pattern:/^\s*(arcgis-navigator:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Navigator"},{pattern:/^\s*(arcgis-survey123:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Survey123"},{pattern:/^\s*(arcgis-trek2there:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Trek2There"},{pattern:/^\s*(arcgis-workforce:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Workforce"},{pattern:/^\s*(iform:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"iForm"},{pattern:/^\s*(flow:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"FlowFinity"},{pattern:/^\s*(lfmobile:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Laserfische"},{pattern:/^\s*(mspbi:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Microsoft Power Bi"}];function Hr(e,t){if("string"!=typeof t||!t)return t;var r=function(e){var t=null;return qr.some((function(r){return r.pattern.test(e)&&(t=r),!!t})),t}(t);if(!r)return t;var n=t.match(r.pattern),i=n&&n[2],a=Object(ke.c)(Object(ke.c)(r.label,{messages:e,hierPart:i}),{appName:r.appName}),o=r.target?' target="'.concat(r.target,'"'):"",s="_blank"===r.target?' rel="noreferrer"':"";return t.replace(r.pattern,"<a".concat(o,' href="$1"').concat(s,">").concat(a,"</a>"))}var Wr="esri-feature-fields",Qr="esri-feature-fields__field-header",Zr="esri-feature-fields__field-data",Xr="esri-feature-fields__field-data--date",Yr="esri-widget__table",$r=function(e){Object(f.a)(r,e);var t=Object(p.a)(r);function r(e,n){var i;return Object(c.a)(this,r),(i=t.call(this,e,n))._featureElementInfo=null,i.attributes=null,i.description=null,i.expressionInfos=null,i.fieldInfos=null,i.title=null,i.viewModel=new Gr,i.messages=null,i.messagesURIUtils=null,i}return Object(l.a)(r,[{key:"initialize",value:function(){var e=this;this._featureElementInfo=new Cr,Object(W.a)(this,["viewModel.description","viewModel.title"],(function(){return e._setupFeatureElementInfo()}))}},{key:"destroy",value:function(){this._featureElementInfo.destroy()}},{key:"renderFieldInfo",value:function(e,t){var r=this.viewModel.attributes,n=e.fieldName,i=e.label||n,a=r?null==r[n]?"":r[n]:"",o=!(!e.format||!e.format.dateFormat),s="number"!=typeof a||o?Hr(this.messagesURIUtils,a):this._forceLTR(a),c=Object(ve.a)({},Xr,o);return Object(kt.a)("tr",{key:"fields-element-info-row-".concat(n,"-").concat(t)},Object(kt.a)("th",{key:"fields-element-info-row-header-".concat(n,"-").concat(t),class:Qr,innerHTML:i}),Object(kt.a)("td",{key:"fields-element-info-row-data-".concat(n,"-").concat(t),class:this.classes(Zr,c),innerHTML:s}))}},{key:"renderFields",value:function(){var e=this,t=this.viewModel.formattedFieldInfos;return t.length?Object(kt.a)("table",{class:Yr,summary:this.messages.fieldsSummary},Object(kt.a)("tbody",null,t.map((function(t,r){return e.renderFieldInfo(t,r)})))):null}},{key:"render",value:function(){var e;return Object(kt.a)("div",{class:Wr},null==(e=this._featureElementInfo)?void 0:e.render(),this.renderFields())}},{key:"_setupFeatureElementInfo",value:function(){var e=this.description,t=this.title;this._featureElementInfo.set({description:e,title:t})}},{key:"_forceLTR",value:function(e){return"&lrm;".concat(e)}}]),r}(ge.a);Object(b.a)([Object(ye.a)("viewModel.attributes")],$r.prototype,"attributes",void 0),Object(b.a)([Object(ye.a)("viewModel.description")],$r.prototype,"description",void 0),Object(b.a)([Object(ye.a)("viewModel.expressionInfos")],$r.prototype,"expressionInfos",void 0),Object(b.a)([Object(ye.a)("viewModel.fieldInfos")],$r.prototype,"fieldInfos",void 0),Object(b.a)([Object(ye.a)("viewModel.title")],$r.prototype,"title",void 0),Object(b.a)([Object(y.b)({type:Gr})],$r.prototype,"viewModel",void 0),Object(b.a)([Object(y.b)(),Object(xt.a)("esri/widgets/Feature/t9n/Feature")],$r.prototype,"messages",void 0),Object(b.a)([Object(y.b)(),Object(xt.a)("esri/widgets/support/t9n/uriUtils")],$r.prototype,"messagesURIUtils",void 0);var Jr=$r=Object(b.a)([Object(w.a)("esri.widgets.Feature.FeatureFields")],$r),Kr=r(509),en=r(99),tn=r(152),rn=r(265),nn=r(456),an=r(603),on=j.a.getLogger("esri.widgets.Feature.support.relatedFeatureUtils"),sn=new Map;function cn(e){if(!vt(e))return null;var t=e.split("/").slice(1),r=Object(ue.a)(t,2);return{layerId:r[0],fieldName:r[1]}}function ln(e){var t,r=e.originRelationship,n=e.relationships,i=e.layerId;return n&&n.some((function(e){return"".concat(e.relatedTableId)===i&&e.id===r.id&&(t=e),!!t})),t}function un(e,t){var r=t.toLowerCase();for(var n in e)if(n.toLowerCase()===r)return e[n];return null}function dn(e,t){var r=function(e,t){if(!t.relationships)return null;var r=null;return t.relationships.some((function(t){return t.id===parseInt(e,10)&&(r=t,!0)})),r}(e,t);if(r){var n="".concat(t.url,"/").concat(r.relatedTableId);return{url:n,queryTask:new an.a({url:n,sourceSpatialReference:t.spatialReference}),relation:r,relatedFields:[],outStatistics:[]}}}function hn(e,t){if(t&&e){var r=e.features,n=e.statsFeatures,i=r&&r.value;t.relatedFeatures=i?i.features:[];var a=n&&n.value;t.relatedStatsFeatures=a?a.features:[]}}function fn(e,t,r,n){var i=new rn.a;return i.outFields=["*"],i.relationshipId="number"==typeof t.id?t.id:parseInt(t.id,10),i.objectIds=[e.attributes[r.objectIdField]],r.queryRelatedFeatures(i,n)}function pn(e,t,r){for(var n=0,i=[];n<t.length;)i.push("".concat(e," IN (").concat(t.slice(n,r+n),")")),n+=r;return i.join(" OR ")}function bn(){return(bn=Object(s.a)(o.a.mark((function e(t,r,n,i){var a,s,c,l,u,d,h,f,p,b,v,m,y,g,O,j,_,w;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=n.layerId.toString(),s=r.layerInfo,c=r.queryTask,l=r.relation,u=r.relatedFields,d=r.outStatistics,!(h=ln({originRelationship:l,relationships:s.relationships,layerId:a})).relationshipTableId||!h.keyFieldInRelationshipTable){e.next=14;break}return e.next=4,fn(t,h,n,i);case 4:if(e.t0=t.attributes[n.objectIdField],f=e.sent[e.t0]){e.next=8;break}return e.abrupt("return",null);case 8:if(p=f.features.map((function(e){return e.attributes[s.objectIdField]})),!((null==d?void 0:d.length)>0&&s.supportsStatistics)){e.next=14;break}return(b=new tn.a).where=pn(s.objectIdField,p,1e3),b.outFields=u,b.outStatistics=d,v={features:Promise.resolve(f),statsFeatures:c.execute(b)},e.abrupt("return",Object(q.k)(v));case 14:if(!(m=null==h?void 0:h.keyField)){e.next=18;break}return y=Object(Ce.o)(yn(s.fields,m)),g=un(t.attributes,l.keyField),O=y?"".concat(m,"=").concat(g):"".concat(m,"='").concat(g,"'"),j=c.execute(new tn.a({where:O,outFields:r.relatedFields}),i),_=r.outStatistics&&r.outStatistics.length>0&&s.supportsStatistics?c.execute(new tn.a({where:O,outFields:r.relatedFields,outStatistics:r.outStatistics}),i):null,w={features:j},e.abrupt("return",(_&&(w.statsFeatures=_),Object(q.k)(w)));case 18:return e.abrupt("return",null);case 19:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function vn(e,t){var r=e.relatedInfos,n=e.layer,i={};return r.forEach((function(e,r){var a=e.relation;if(!a){var o=new U.a("relation-required","A relation is required on a layer to retrieve related records.");throw on.error(o),o}var s=a.relatedTableId;if("number"!=typeof s){var c=new U.a("A related table ID is required on a layer to retrieve related records.");throw on.error(c),c}var l="".concat(n.url,"/").concat(s),u=sn.get(l),d=u||function(e,t){return Object(en.default)(e,{query:{f:"json"},signal:t&&t.signal})}(l,t);u||sn.set(l,d),i[r]=d})),Object(q.k)(i)}function mn(e,t){var r=e.graphic,n=e.relatedInfos,i=e.layer,a={};return n.forEach((function(e,n){e.layerInfo&&(a[n]=function(e,t,r,n){return bn.apply(this,arguments)}(r,e,i,t))})),Object(q.k)(a)}function yn(e,t){if(null!=e){t=t.toLowerCase();var r,n=Object(i.a)(e);try{for(n.s();!(r=n.n()).done;){var a=r.value;if(a&&a.name.toLowerCase()===t)return a}}catch(o){n.e(o)}finally{n.f()}}return null}var gn=function(e){Object(f.a)(r,e);var t=Object(p.a)(r);function r(e){var n;return Object(c.a)(this,r),(n=t.call(this,e)).activeMediaInfoIndex=0,n.attributes=null,n.description=null,n.fieldInfoMap=null,n.formattedAttributes=null,n.expressionAttributes=null,n.layer=null,n.mediaInfos=null,n.popupTemplate=null,n.relatedInfos=null,n.title=null,n}return Object(l.a)(r,[{key:"activeMediaInfo",get:function(){return this.formattedMediaInfos[this.activeMediaInfoIndex]||null}},{key:"formattedMediaInfos",get:function(){return this._formatMediaInfos()||[]}},{key:"formattedMediaInfoCount",get:function(){return this.formattedMediaInfos.length}},{key:"setActiveMedia",value:function(e){this._setContentElementMedia(e)}},{key:"next",value:function(){this._pageContentElementMedia(1)}},{key:"previous",value:function(){this._pageContentElementMedia(-1)}},{key:"_setContentElementMedia",value:function(e){var t=this.formattedMediaInfoCount,r=(e+t)%t;this.activeMediaInfoIndex=r}},{key:"_pageContentElementMedia",value:function(e){var t=this.activeMediaInfoIndex+e;this._setContentElementMedia(t)}},{key:"_formatMediaInfos",value:function(){var e=this,t=this.attributes,r=this.mediaInfos,n=this.formattedAttributes,i=this.expressionAttributes,a=this.fieldInfoMap,o=this.layer;return null==r?void 0:r.map((function(r){if(!r)return null;if(r.title=$e({attributes:t,fieldInfoMap:a,globalAttributes:n,expressionAttributes:i,layer:o,text:r.title}),r.caption=$e({attributes:t,fieldInfoMap:a,globalAttributes:n,expressionAttributes:i,layer:o,text:r.caption}),r.altText=$e({attributes:t,fieldInfoMap:a,globalAttributes:n,expressionAttributes:i,layer:o,text:r.altText}),"image"===r.type){var s=r.value;return e._setImageValue({value:s,formattedAttributes:n,layer:o}),r.value.sourceURL?r:void 0}if("pie-chart"===r.type||"line-chart"===r.type||"column-chart"===r.type||"bar-chart"===r.type){var c=r.value;return e._setChartValue({value:c,chartType:r.type,attributes:t,formattedAttributes:n,layer:o}),r}return null})).filter(Boolean)}},{key:"_setImageValue",value:function(e){var t=this.fieldInfoMap,r=e.value,n=e.formattedAttributes,i=e.layer,a=r.linkURL,o=r.sourceURL;if(o){var s=tt(o,i);r.sourceURL=Je({formattedAttributes:n,template:s,fieldInfoMap:t})}if(a){var c=tt(a,i);r.linkURL=Je({formattedAttributes:n,template:c,fieldInfoMap:t})}}},{key:"_setChartValue",value:function(e){var t=this,r=e.value,n=e.attributes,i=e.formattedAttributes,a=e.chartType,o=e.layer,s=this.popupTemplate,c=this.relatedInfos,l=r.fields,u=r.normalizeField;if(r.fields=function(e,t){return e&&e.map((function(e){return Ze(e,t)}))}(l,o),u&&(r.normalizeField=Ze(u,o)),l.some((function(e){return!!(null!=i[e]||vt(e)&&c.size)}))){var d=null==s?void 0:s.fieldInfos;l.forEach((function(e){if(vt(e))r.series=[].concat(Object(xe.a)(r.series),Object(xe.a)(t._getRelatedChartInfos({fieldInfos:d,fieldName:e,formattedAttributes:i,chartType:a,value:r})));else{var o=t._getChartOption({value:r,attributes:n,chartType:a,formattedAttributes:i,fieldName:e,fieldInfos:d});r.series.push(o)}}))}}},{key:"_getRelatedChartInfos",value:function(e){var t,r=this,n=e.fieldInfos,i=e.fieldName,a=e.formattedAttributes,o=e.chartType,s=e.value,c=[],l=cn(i),u=l.layerId,d=l.fieldName,h=null==(t=this.relatedInfos)?void 0:t.get(u.toString());if(!h)return c;var f=h.relatedFeatures,p=h.relation;if(!p||!f)return c;var b=p.cardinality;return f.forEach((function(e){var t=e.attributes;t&&Object.keys(t).forEach((function(e){e===d&&c.push(r._getChartOption({value:s,attributes:t,formattedAttributes:a,fieldName:i,chartType:o,relatedFieldName:e,fieldInfos:n}))}))})),"one-to-many"===b||"many-to-many"===b?c:[c[0]]}},{key:"_getTooltip",value:function(e){var t=e.label,r=e.value;return"pie-chart"===e.chartType?t:"".concat(t,": ").concat(r)}},{key:"_getChartOption",value:function(e){var t,r=e.value,n=e.attributes,i=e.formattedAttributes,a=e.fieldName,o=e.relatedFieldName,s=e.fieldInfos,c=e.chartType,l=this.layer,u=r.normalizeField,d=r.tooltipField,h=u?vt(u)?n[cn(u).fieldName]:n[u]:null,f=o&&void 0!==n[o]?n[o]:void 0!==n[a]?n[a]:i[a],p=void 0===f?null:f&&h?f/h:f,b=new Kr.a({value:p});if(vt(a)){var v=cn(a),m=cn(d),y=m?m.fieldName:null,g=nt(p,{fieldInfos:s,fieldName:o,layer:l,preventPlacesFormatting:!!h}),O=v?v.label||v.fieldName:o,j=y&&void 0!==n[y]?n[y]:O;return b.tooltip=this._getTooltip({label:j,value:g,chartType:c}),b}var _=it(s,a),w=Ze(a,l),x=d&&void 0!==i[d]?i[d]:Qe(_||new Ur.a({fieldName:w}),null==(t=this.popupTemplate)?void 0:t.expressionInfos),k=i[w];return b.tooltip=this._getTooltip({label:x,value:k,chartType:c}),b}}]),r}(de.a);Object(b.a)([Object(y.b)()],gn.prototype,"activeMediaInfoIndex",void 0),Object(b.a)([Object(y.b)({readOnly:!0})],gn.prototype,"activeMediaInfo",null),Object(b.a)([Object(y.b)()],gn.prototype,"attributes",void 0),Object(b.a)([Object(y.b)()],gn.prototype,"description",void 0),Object(b.a)([Object(y.b)()],gn.prototype,"fieldInfoMap",void 0),Object(b.a)([Object(y.b)()],gn.prototype,"formattedAttributes",void 0),Object(b.a)([Object(y.b)()],gn.prototype,"expressionAttributes",void 0),Object(b.a)([Object(y.b)({readOnly:!0})],gn.prototype,"formattedMediaInfos",null),Object(b.a)([Object(y.b)()],gn.prototype,"layer",void 0),Object(b.a)([Object(y.b)({readOnly:!0})],gn.prototype,"formattedMediaInfoCount",null),Object(b.a)([Object(y.b)()],gn.prototype,"mediaInfos",void 0),Object(b.a)([Object(y.b)()],gn.prototype,"popupTemplate",void 0),Object(b.a)([Object(y.b)()],gn.prototype,"relatedInfos",void 0),Object(b.a)([Object(y.b)()],gn.prototype,"title",void 0);var On,jn,_n=gn=Object(b.a)([Object(w.a)("esri.widgets.Feature.FeatureMedia.FeatureMediaViewModel")],gn),wn=_n,xn=["#ffffff","#858585","#ffbebe","#ffebbe","#ffebaf","#ffffbe","#e9ffbe","#d3ffbe","#beffe8","#bee8ff","#bed2ff","#e8beff","#ffbee8","#ebebeb","#707070","#ff7f7f","#ffa77f","#ffd37f","#ffff73","#d1ff73","#a3ff73","#73ffdf","#73dfff","#73b2ff","#df73ff","#ff73df","#d6d6d6","#5c5c5c","#ff0000","#ff5500","#ffaa00","#ffff00","#aaff00","#55ff00","#00ffc5","#00c5ff","#0070ff","#c500ff","#ff00c5","#c2c2c2","#474747","#e60000","#e64c00","#e69800","#e6e600","#98e600","#4ce600","#00e6a9","#00a9e6","#005ce6","#a900e6","#e600a9","#adadad","#242424","#a80000","#a83800","#a87000","#a8a800","#70a800","#38a800","#00a884","#0084a8","#004da8","#8400a8","#a80084","#999999","#1a1a1a","#730000","#732600","#734c00","#737300","#4c7300","#267300","#00734c","#004c73","#002673","#4c0073","#73004"],kn=[].concat(xn.slice(30,39),xn.slice(28,30).reverse()),Sn=[{name:"default",colors:kn},{name:"cat-dark",colors:["#ed5151","#149ece","#a7c636","#9e559c","#fc921f","#ffde3e","#f789d8","#b7814a","#3caf99","#6b6bd6","#b54779","#7f7f7f"]},{name:"tropical-bliss",colors:["#fce138","#ff9399","#fcd27e","#f1983c","#a553b7","#b1a9d0","#6ecffc","#4c81cd","#fc6f84","#fc3e5a","#6af689","#48885c"]},{name:"desert-blooms",colors:["#102432","#144d59","#ffc730","#ed9310","#a64f1b","#661510","#d9351a","#b31515","#4a0932","#8c213f","#18382e","#2c6954"]},{name:"under-the-sea",colors:["#bf9727","#607100","#00734c","#704489","#01acca","#024e76","#f09100","#ea311f","#c6004b","#7570b3","#666666","#333333"]},{name:"vibrant-rainbow",colors:["#fffb00","#f5cb11","#9fd40c","#46e39c","#32b8a6","#7ff2fa","#ac08cc","#dd33ff","#eb7200","#e8a784","#bf2e2e","#6c7000"]},{name:"ocean-bay",colors:["#191921","#11495c","#78b1c2","#454f4b","#8f8f82","#9be0c0","#87b051","#f7ec88","#ebdcc1","#dbb658","#c43541","#75351e"]},{name:"prairie-summer",colors:["#332424","#751555","#d47013","#d68989","#211173","#82aad6","#7bfaeb","#6ec9a8","#6b6408","#eada40","#ccc54a","#1fc235"]},{name:"pastel-chalk",colors:["#fffd99","#f5e6a4","#c1d48c","#b8e3d0","#a0b8b5","#cbf7fa","#d791f2","#dfc1eb","#f2b983","#e8c4b2","#bf8e8e","#94995c"]},{name:"seq-yellow-orange-red-bright",colors:["#910000","#b1260b","#c0370f","#e05919","#ef6a1d","#ff7b22","#ffa143","#ffb454","#ffda74","#ffed85"]},{name:"seq-reds-bright",colors:["#57453b","#7b4238","#9f4036","#c23d33","#d7483c","#ec5244","#f3696c","#f9816c","#ffc4ae","#fff0dc"]},{name:"seq-purples-bright",colors:["#4e465c","#5a4a78","#695291","#775baa","#8663c3","#946bdc","#aa89e8","#c1a6f3","#d7c4ff","#e6e1ff"]},{name:"seq-blues-bright",colors:["#404d54","#435c6c","#48799d","#4b88b6","#4d96ce","#50a5e7","#74bbed","#98d0f3","#bce6f9","#e6faff"]},{name:"seq-greens-bright",colors:["#39544c","#386757","#368165","#359b73","#33b581","#4bc392","#64d2a2","#7ce0b3","#cbf6d9","#f4ffea"]},{name:"seq-browns-bright",colors:["#524834","#715b38","#8f6e3c","#ae8140","#cc9444","#eba748","#eeb664","#f0c47f","#f9e0b7","#fff8eb"]}],Tn=r(138),Cn="en-us",Mn=new Map([["ar",function(){return r.e(91).then(r.bind(null,1e3)).then((function(e){return e.a}))}],["bs-ba",function(){return r.e(92).then(r.bind(null,1001)).then((function(e){return e.b}))}],["ca-es",function(){return r.e(93).then(r.bind(null,1002)).then((function(e){return e.c}))}],["cs-cz",function(){return r.e(94).then(r.bind(null,1003)).then((function(e){return e.c}))}],["da-dk",function(){return r.e(95).then(r.bind(null,1004)).then((function(e){return e.d}))}],["de-de",function(){return r.e(97).then(r.bind(null,1005)).then((function(e){return e.d}))}],["de-ch",function(){return r.e(96).then(r.bind(null,1006)).then((function(e){return e.d}))}],["el-gr",function(){return r.e(98).then(r.bind(null,1007)).then((function(e){return e.e}))}],["en-us",function(){return r.e(100).then(r.bind(null,1008)).then((function(e){return e.e}))}],["en-ca",function(){return r.e(99).then(r.bind(null,1009)).then((function(e){return e.e}))}],["es-es",function(){return r.e(101).then(r.bind(null,1010)).then((function(e){return e.e}))}],["et-ee",function(){return r.e(102).then(r.bind(null,1011)).then((function(e){return e.e}))}],["fi-fi",function(){return r.e(103).then(r.bind(null,1012)).then((function(e){return e.f}))}],["fr-fr",function(){return r.e(104).then(r.bind(null,1013)).then((function(e){return e.f}))}],["he-il",function(){return r.e(105).then(r.bind(null,1014)).then((function(e){return e.h}))}],["hr-hr",function(){return r.e(106).then(r.bind(null,1015)).then((function(e){return e.h}))}],["hu-hu",function(){return r.e(107).then(r.bind(null,1016)).then((function(e){return e.h}))}],["id-id",function(){return r.e(108).then(r.bind(null,1017)).then((function(e){return e.i}))}],["it-it",function(){return r.e(110).then(r.bind(null,1018)).then((function(e){return e.i}))}],["ja-jp",function(){return r.e(111).then(r.bind(null,1019)).then((function(e){return e.j}))}],["ko-kr",function(){return r.e(112).then(r.bind(null,1020)).then((function(e){return e.k}))}],["lt-lt",function(){return r.e(113).then(r.bind(null,1021)).then((function(e){return e.l}))}],["lv-lv",function(){return r.e(114).then(r.bind(null,1022)).then((function(e){return e.l}))}],["nb-no",function(){return r.e(115).then(r.bind(null,1023)).then((function(e){return e.n}))}],["nl-nl",function(){return r.e(116).then(r.bind(null,1024)).then((function(e){return e.n}))}],["pl-pl",function(){return r.e(117).then(r.bind(null,1025)).then((function(e){return e.p}))}],["pt-br",function(){return r.e(118).then(r.bind(null,1026)).then((function(e){return e.p}))}],["pt-pt",function(){return r.e(119).then(r.bind(null,1027)).then((function(e){return e.p}))}],["ro-ro",function(){return r.e(120).then(r.bind(null,1028)).then((function(e){return e.r}))}],["ru-ru",function(){return r.e(121).then(r.bind(null,1029)).then((function(e){return e.r}))}],["sk-sk",function(){return r.e(122).then(r.bind(null,1030)).then((function(e){return e.s}))}],["sl-sl",function(){return r.e(123).then(r.bind(null,1031)).then((function(e){return e.s}))}],["sr-rs",function(){return r.e(124).then(r.bind(null,1032)).then((function(e){return e.s}))}],["sv-se",function(){return r.e(125).then(r.bind(null,1033)).then((function(e){return e.s}))}],["th-th",function(){return r.e(126).then(r.bind(null,1034)).then((function(e){return e.t}))}],["tr-tr",function(){return r.e(127).then(r.bind(null,1035)).then((function(e){return e.t}))}],["uk-ua",function(){return r.e(128).then(r.bind(null,1036)).then((function(e){return e.u}))}],["vi-vn",function(){return r.e(129).then(r.bind(null,1037)).then((function(e){return e.v}))}],["zh-cn",function(){return r.e(130).then(r.bind(null,1038)).then((function(e){return e.z}))}],["zh-hk",function(){return r.e(35).then(r.bind(null,1039)).then((function(e){return e.z}))}],["zh-tw",function(){return r.e(35).then(r.bind(null,1039)).then((function(e){return e.z}))}]]);function Pn(e){return e?Mn.has(e.toLowerCase())?e.toLowerCase():function(e){var t,r=e.split("-")[0].toLowerCase(),n=null,a=Object(i.a)(Mn.keys());try{for(a.s();!(t=a.n()).done;){var o=t.value;if(o.startsWith(r)){n=o;break}}}catch(s){a.e(s)}finally{a.f()}return n}(e)||Cn:Cn}function An(){return En.apply(this,arguments)}function En(){return(En=Object(s.a)(o.a.mark((function e(){var t,n,i,a,s,c=arguments;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=Pn(t=c.length>0&&void 0!==c[0]?c[0]:Object(Tn.b)()),!On||t!==jn){e.next=3;break}return e.abrupt("return",On);case 3:return On=r.e(109).then(r.bind(null,1040)).then((function(e){return e.i})),jn=t,e.prev=4,e.next=7,Promise.all([On,Mn.get(jn)()]);case 7:n=e.sent,i=Object(ue.a)(n,2),a=i[0],s=i[1],jn===t&&(a.am4core.options.defaultLocale=s.default),a.am4core.options.suppressWarnings=!0,a.am4core.options.autoDispose=!0,e.next=17;break;case 14:return e.prev=14,e.t0=e.catch(4),e.abrupt("return",(On=null,jn=null,null));case 17:return e.abrupt("return",On);case 18:case"end":return e.stop()}}),e,null,[[4,14]])})))).apply(this,arguments)}var Rn="esri-feature-media",In="esri-feature-media__container",Dn="esri-feature-media__item-container",Fn="esri-feature-media__item",Ln="esri-feature-media__item-title",zn="esri-feature-media__item-caption",Vn="esri-feature-media__previous",Nn="esri-feature-media__previous-icon",Un="esri-feature-media__previous-icon--rtl",Bn="esri-feature-media__next",Gn="esri-feature-media__next-icon",qn="esri-feature-media__next-icon--rtl",Hn="esri-feature-media__chart",Wn="esri-feature-media__button",Qn="esri-feature-media__icon",Zn="esri-icon-left-triangle-arrow",Xn="esri-icon-right-triangle-arrow",Yn=.05,$n=.95,Jn=function(e){Object(f.a)(r,e);var t=Object(p.a)(r);function r(e,n){var i;return Object(c.a)(this,r),(i=t.call(this,e,n))._refreshTimer=null,i._refreshIntervalInfo=null,i._featureElementInfo=null,i.attributes=null,i.activeMediaInfoIndex=null,i.description=null,i.fieldInfoMap=null,i.layer=null,i.mediaInfos=null,i.popupTemplate=null,i.relatedInfos=null,i.title=null,i.viewModel=new wn,i.messages=null,i}return Object(l.a)(r,[{key:"initialize",value:function(){var e=this;this._featureElementInfo=new Cr,this.own(Object(W.a)(this,["viewModel.activeMediaInfo","viewModel.activeMediaInfoIndex"],(function(){return e._setupMediaRefreshTimer()})),Object(W.a)(this,["viewModel.description","viewModel.title"],(function(){return e._setupFeatureElementInfo()})))}},{key:"destroy",value:function(){this._clearMediaRefreshTimer(),this._featureElementInfo.destroy()}},{key:"render",value:function(){var e;return Object(kt.a)("div",{bind:this,class:Rn,onkeyup:this._handleMediaKeyup},null==(e=this._featureElementInfo)?void 0:e.render(),this.renderMedia())}},{key:"renderMedia",value:function(){return this.viewModel.formattedMediaInfoCount?Object(kt.a)("div",{key:"media-element-container",class:In},this.renderMediaPageButton("previous"),this.renderMediaInfo(),this.renderMediaPageButton("next")):null}},{key:"renderImageMediaInfo",value:function(e){var t=this._refreshIntervalInfo,r=this.viewModel,n=r.activeMediaInfoIndex,i=r.formattedMediaInfoCount,a=e.value,o=e.refreshInterval,s=e.altText,c=e.title,l=e.type,u=a.sourceURL,d=a.linkURL,h=He(d)?"_blank":"_self",f="_blank"===h?"noreferrer":"",p=o?t:null,b=p?p.timestamp:0,v=p?p.sourceURL:u,m=Object(kt.a)("img",{alt:s||c,key:"media-".concat(l,"-").concat(n,"-").concat(i,"-").concat(b),src:v});return(d?Object(kt.a)("a",{title:c,href:d,rel:f,target:h},m):null)||m}},{key:"renderChartMediaInfo",value:function(e){var t=this.viewModel,r=t.activeMediaInfoIndex,n=t.formattedMediaInfoCount;return Object(kt.a)("div",{key:"media-".concat(e.type,"-").concat(r,"-").concat(n),bind:this,class:Hn,afterCreate:this._getChartDependencies})}},{key:"renderMediaInfoType",value:function(){var e=this.viewModel.activeMediaInfo;return e?"image"===e.type?this.renderImageMediaInfo(e):-1!==e.type.indexOf("chart")?this.renderChartMediaInfo(e):null:null}},{key:"renderMediaInfo",value:function(){var e=this.viewModel.activeMediaInfo;if(!e)return null;var t=e.title?Object(kt.a)("div",{key:"media-title",class:Ln,innerHTML:e.title}):null,r=e.caption?Object(kt.a)("div",{key:"media-caption",class:zn,innerHTML:e.caption}):null;return Object(kt.a)("div",{key:"media-container",class:Dn},Object(kt.a)("div",{key:"media-item-container",class:Fn},this.renderMediaInfoType()),t,r)}},{key:"renderMediaPageButton",value:function(e){if(this.viewModel.formattedMediaInfoCount<2)return null;var t="previous"===e,r=t?this.messages.previous:this.messages.next,n=t?this.classes(Wn,Vn):this.classes(Wn,Bn),i=t?this.classes(Qn,Nn,Zn):this.classes(Qn,Gn,Xn),a=t?this.classes(Qn,Un,Xn):this.classes(Qn,qn,Zn),o=t?"media-previous":"media-next",s=t?this._previous:this._next;return Object(kt.a)("button",{type:"button",key:o,title:r,"aria-label":r,tabIndex:0,class:n,bind:this,onclick:s},Object(kt.a)("span",{"aria-hidden":"true",class:i}),Object(kt.a)("span",{"aria-hidden":"true",class:a}))}},{key:"_setupFeatureElementInfo",value:function(){var e=this.description,t=this.title;this._featureElementInfo.set({description:e,title:t})}},{key:"_next",value:function(){this.viewModel.next()}},{key:"_previous",value:function(){this.viewModel.previous()}},{key:"_getChartDependencies",value:function(){var e=Object(s.a)(o.a.mark((function e(t){var r,n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,An();case 2:r=e.sent,n=this.viewModel.activeMediaInfo,this._renderChart({chartDiv:t,mediaInfo:n,chartsModule:r});case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_handleMediaKeyup",value:function(e){var t=Object(B.a)(e);"ArrowLeft"===t&&(e.stopPropagation(),this.viewModel.previous()),"ArrowRight"===t&&(e.stopPropagation(),this.viewModel.next())}},{key:"_renderChart",value:function(e){var t=e.chartsModule,r=e.chartDiv,n=e.mediaInfo,i=n.value,a=n.type,o=t.am4core,s=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"default",r=Sn.find((function(e){return e.name===t}));return r?r.colors.map((function(t){return e.color(t)})):null}(o);Object(wt.g)()&&o.useTheme(t.am4themes_dark),o.useTheme(t.am4themes_animated),o.useTheme((function(e){e instanceof o.ColorSet&&s&&(e.list=s)}));var c="pie-chart"===a?this._createPieChart(e):this._createXYChart(e);r.setAttribute("aria-label",n.altText||n.title),c.data=i.series.map((function(e){return{tooltip:e.tooltip,value:e.value}})).filter((function(e){return"pie-chart"!==a||e.value>0}))}},{key:"_customizeChartTooltip",value:function(e,t){e.label.wrap=!0,e.label.maxWidth=200,e.autoTextColor=!1,e.getFillFromObject=!1,e.label.fill=t.color("#ffffff"),e.background.fill=t.color({r:0,g:0,b:0,a:.7})}},{key:"_createPieChart",value:function(e){var t=e.chartDiv,r=e.chartsModule,n=r.am4core,i=r.am4charts,a=n.create(t,i.PieChart);a.rtl=Object(wt.h)();var o=a.series.push(new i.PieSeries);return o.labels.template.disabled=!0,o.ticks.template.disabled=!0,o.dataFields.value="value",o.dataFields.category="tooltip",this._customizeChartTooltip(o.tooltip,n),a}},{key:"_getMinSeriesValue",value:function(e){var t=0;return e.forEach((function(e){return t=Math.min(e.value,t)})),t}},{key:"_createColumnChart",value:function(e,t){var r=t.chartsModule,n=t.mediaInfo.value,i=r.am4core,a=r.am4charts,o=e.xAxes.push(new a.CategoryAxis);o.dataFields.category="tooltip",o.renderer.labels.template.disabled=!0,this._customizeChartTooltip(o.tooltip,i),o.tooltip.events.on("sizechanged",(function(){o.tooltip.dy=-o.tooltip.contentHeight}));var s=e.yAxes.push(new a.ValueAxis),c=s.renderer.labels.template;s.renderer.minLabelPosition=Yn,s.renderer.maxLabelPosition=$n,s.min=this._getMinSeriesValue(n.series),this._customizeChartTooltip(s.tooltip,i),c.wrap=!0;var l=e.series.push(new a.ColumnSeries);l.dataFields.valueY="value",l.dataFields.categoryX="tooltip",e.cursor=new a.XYCursor,n.series.length>15&&(e.scrollbarX=new i.Scrollbar)}},{key:"_createBarChart",value:function(e,t){var r=t.chartsModule,n=t.mediaInfo.value,i=r.am4core,a=r.am4charts,o=e.yAxes.push(new a.CategoryAxis);o.dataFields.category="tooltip",o.renderer.inversed=!0,o.renderer.labels.template.disabled=!0,this._customizeChartTooltip(o.tooltip,i),o.tooltip.events.on("sizechanged",(function(){o.tooltip.dx=o.tooltip.contentWidth}));var s=e.xAxes.push(new a.ValueAxis),c=s.renderer.labels.template;s.renderer.minLabelPosition=Yn,s.renderer.maxLabelPosition=$n,s.min=this._getMinSeriesValue(n.series),this._customizeChartTooltip(s.tooltip,i),c.wrap=!0;var l=e.series.push(new a.ColumnSeries);l.dataFields.valueX="value",l.dataFields.categoryY="tooltip",e.cursor=new a.XYCursor,n.series.length>15&&(e.scrollbarY=new i.Scrollbar)}},{key:"_createLineChart",value:function(e,t){var r=t.chartsModule,n=t.mediaInfo.value,i=r.am4core,a=r.am4charts,o=e.xAxes.push(new a.CategoryAxis);o.dataFields.category="tooltip",o.renderer.labels.template.disabled=!0,this._customizeChartTooltip(o.tooltip,i),o.tooltip.events.on("sizechanged",(function(){o.tooltip.dy=-o.tooltip.contentHeight}));var s=e.yAxes.push(new a.ValueAxis),c=s.renderer.labels.template;s.renderer.minLabelPosition=Yn,s.renderer.maxLabelPosition=$n,s.min=this._getMinSeriesValue(n.series),this._customizeChartTooltip(s.tooltip,i),c.wrap=!0;var l=e.series.push(new a.LineSeries);l.dataFields.categoryX="tooltip",l.dataFields.valueY="value",e.cursor=new a.XYCursor,n.series.length>15&&(e.scrollbarX=new i.Scrollbar)}},{key:"_createXYChart",value:function(e){var t=e.chartDiv,r=e.chartsModule,n=e.mediaInfo.type,i=r.am4core,a=r.am4charts,o=i.create(t,a.XYChart);return o.rtl=Object(wt.h)(),"column-chart"===n&&this._createColumnChart(o,e),"bar-chart"===n&&this._createBarChart(o,e),"line-chart"===n&&this._createLineChart(o,e),o}},{key:"_clearMediaRefreshTimer",value:function(){var e=this._refreshTimer;e&&(clearTimeout(e),this._refreshTimer=null)}},{key:"_updateMediaInfoTimestamp",value:function(e){var t=Date.now();this._refreshIntervalInfo={timestamp:t,sourceURL:this._getImageSource(e,t)},this.scheduleRender()}},{key:"_setupMediaRefreshTimer",value:function(){this._clearMediaRefreshTimer();var e=this.viewModel.activeMediaInfo;e&&"image"===e.type&&e.refreshInterval&&this._setRefreshTimeout(e)}},{key:"_setRefreshTimeout",value:function(e){var t=this,r=e.refreshInterval,n=e.value;if(r){var i=6e4*r;this._updateMediaInfoTimestamp(n.sourceURL);var a=setInterval((function(){t._updateMediaInfoTimestamp(n.sourceURL)}),i);this._refreshTimer=a}}},{key:"_getImageSource",value:function(e,t){var r=-1!==e.indexOf("?")?"&":"?",n=e.split("#"),i=Object(ue.a)(n,2),a=i[0],o=i[1],s=void 0===o?"":o;return"".concat(a).concat(r,"timestamp=").concat(t).concat(s?"#":"").concat(s)}}]),r}(ge.a);Object(b.a)([Object(ye.a)("viewModel.attributes")],Jn.prototype,"attributes",void 0),Object(b.a)([Object(ye.a)("viewModel.activeMediaInfoIndex")],Jn.prototype,"activeMediaInfoIndex",void 0),Object(b.a)([Object(ye.a)("viewModel.description")],Jn.prototype,"description",void 0),Object(b.a)([Object(ye.a)("viewModel.fieldInfoMap")],Jn.prototype,"fieldInfoMap",void 0),Object(b.a)([Object(ye.a)("viewModel.layer")],Jn.prototype,"layer",void 0),Object(b.a)([Object(ye.a)("viewModel.mediaInfos")],Jn.prototype,"mediaInfos",void 0),Object(b.a)([Object(ye.a)("viewModel.popupTemplate")],Jn.prototype,"popupTemplate",void 0),Object(b.a)([Object(ye.a)("viewModel.relatedInfos")],Jn.prototype,"relatedInfos",void 0),Object(b.a)([Object(ye.a)("viewModel.title")],Jn.prototype,"title",void 0),Object(b.a)([Object(y.b)({type:wn})],Jn.prototype,"viewModel",void 0),Object(b.a)([Object(y.b)(),Object(xt.a)("esri/widgets/Feature/t9n/Feature")],Jn.prototype,"messages",void 0);var Kn=Jn=Object(b.a)([Object(w.a)("esri.widgets.Feature.FeatureMedia")],Jn),ei=r(259),ti=r(448),ri=["$datastore","$map","$layer","$aggregatedfeatures"],ni=j.a.getLogger("esri.widgets.Feature.support.arcadeFeatureUtils");function ii(e){return'<ul class="esri-widget__list">'.concat(e.map((function(e){return"<li>".concat("string"==typeof e?st(ot(e)):e,"</li>")})).join(""),"</ul>")}function ai(e){return'<table class="esri-widget__table">'.concat(e.keys().map((function(t){var r=e.field(t);return"<tr><th>".concat(t,"</th><td>").concat("string"==typeof r?st(ot(r)):r,"</td></tr>")})).join(""),"</table>")}function oi(e){var t=e.aggregatedFeatures,r=e.arcadeUtils,n=e.featureSetVars,i=e.context,a=e.viewInfo,o=e.map,s=e.graphic;n.forEach((function(e){var n=e.toLowerCase(),c={map:o,spatialReference:a.sr};if("$map"===n&&(i.vars[n]=r.convertMapToFeatureSetCollection(c)),"$layer"===n&&(i.vars[n]=r.convertFeatureLayerToFeatureSet(s.sourceLayer,a.sr)),"$datastore"===n&&(i.vars[n]=r.convertServiceUrlToWorkspace(s.sourceLayer.url,a.sr)),"$aggregatedfeatures"===n){var l=s.layer,u=l.fields,d=l.objectIdField,h=l.geometryType,f=l.spatialReference,p=l.displayField,b=new ti.default(Object(ie.a)(Object(ie.a)({fields:u,objectIdField:d,geometryType:h,spatialReference:f,displayField:p},"feature"===l.type?{templates:l.templates,typeIdField:l.typeIdField,types:l.types}:null),{},{source:t}));i.vars[n]=r.convertFeatureLayerToFeatureSet(b,a.sr)}}))}function si(){return r.e(21).then(r.bind(null,708))}function ci(e){return li.apply(this,arguments)}function li(){return(li=Object(s.a)(o.a.mark((function e(t){var r,n,i,a,s,c,l,u;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.graphic,n=t.view,i=r.isAggregate,a=r.layer,i&&a&&"2d"===(null==n?void 0:n.type)){e.next=4;break}return e.abrupt("return",[]);case 4:return e.next=6,n.whenLayerView(a);case 6:if((s=e.sent).createQuery&&s.queryFeatures){e.next=9;break}return e.abrupt("return",[]);case 9:return(c=s.createQuery()).aggregateIds=[r.getObjectId()],e.next=13,s.queryFeatures(c);case 13:return l=e.sent,u=l.features,e.abrupt("return",u);case 16:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ui(e){return di.apply(this,arguments)}function di(){return(di=Object(s.a)(o.a.mark((function e(t){var r,n,i,a,s,c,l,u,d,h,f,p,b,v;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.expressionAttributes,n=t.info,i=t.arcadeUtils,a=t.spatialReference,s=t.map,c=t.graphic,l=t.view,u="expression/".concat(n.name),d=i.createSyntaxTree(n.expression),h=ri.filter((function(e){return i.hasVariable(d,e)})),e.next=4,i.loadScriptDependencies(d,!0,h);case 4:return f=i.getViewInfo({spatialReference:a}),(p=i.createExecContext(c,f)).useAsync=!0,e.t0=oi,e.next=9,ci({graphic:c,view:l});case 9:return e.t1=e.sent,e.t2=i,e.t3=h,e.t4=p,e.t5=f,e.t6=s,e.t7=c,e.t8={aggregatedFeatures:e.t1,arcadeUtils:e.t2,featureSetVars:e.t3,context:e.t4,viewInfo:e.t5,map:e.t6,graphic:e.t7},(0,e.t0)(e.t8),b=i.createFunction(d,p),e.next=21,i.executeAsyncFunction(b,p).catch((function(e){return ni.error("arcade-execution-error",{error:e,graphic:c,expressionInfo:n})}));case 21:v=e.sent,r[u]="string"==typeof v?st(ot(v)):Array.isArray(v)?ii(v):v&&"esri.arcade.Dictionary"===v.declaredClass?ai(v):v;case 23:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function hi(e){return fi.apply(this,arguments)}function fi(){return(fi=Object(s.a)(o.a.mark((function e(t){var r,n,a,s,c,l,u,d,h,f,p,b;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.popupTemplate,n=t.spatialReference,a=t.graphic,s=t.map,c=t.view,l=r.expressionInfos,u=[],d={},l&&l.length){e.next=4;break}return e.abrupt("return",d);case 4:return e.next=6,si();case 6:h=e.sent,f=Object(i.a)(l);try{for(f.s();!(p=f.n()).done;)b=p.value,u.push(ui({expressionAttributes:d,info:b,arcadeUtils:h,spatialReference:n,map:s,graphic:a,view:c}))}catch(o){f.e(o)}finally{f.f()}return e.next=11,Object(q.k)(u);case 11:return e.abrupt("return",d);case 12:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var pi="esri.widgets.FeatureViewModel",bi=j.a.getLogger(pi),vi=function(e){Object(f.a)(r,e);var t=Object(p.a)(r);function r(e){var n;return Object(c.a)(this,r),(n=t.call(this,e))._handles=new oe.a,n._featureAbortController=null,n.graphicChangedThrottled=me(n.graphicChanged,1,Object(u.a)(n)),n._expressionAttributes=null,n.content=null,n.contentViewModels=[],n.defaultPopupTemplateEnabled=!1,n.formattedAttributes=null,n.lastEditInfo=null,n.relatedInfos=new Map,n.title="",n.view=null,n._handles.add(Object(W.a)(Object(u.a)(n),["graphic","_effectivePopupTemplate"],(function(){return n.graphicChangedThrottled()}))),n}return Object(l.a)(r,[{key:"destroy",value:function(){this._clear(),this._cancelFeatureQuery(),this._handles.destroy(),this._handles=null,this.graphic=null,this._destroyContentViewModels(),this.relatedInfos.clear()}},{key:"_effectivePopupTemplate",get:function(){return Object(I.j)(this.graphic)?this.graphic.getEffectivePopupTemplate(this.defaultPopupTemplateEnabled):null}},{key:"_fieldInfoMap",get:function(){return function(e,t){var r=new Map;return e&&e.forEach((function(e){var n=Ze(e.fieldName,t);e.fieldName=n,r.set(n.toLowerCase(),e)})),r}(at(this._effectivePopupTemplate),this._sourceLayer)}},{key:"_sourceLayer",get:function(){return Be(this.graphic)}},{key:"graphic",set:function(e){this._set("graphic",e?e.clone():null)}},{key:"spatialReference",get:function(){return this.get("view.spatialReference")||null},set:function(e){void 0!==e?this._override("spatialReference",e):this._clearOverride("spatialReference")}},{key:"map",get:function(){return this.get("view.map")||null},set:function(e){void 0!==e?this._override("map",e):this._clearOverride("map")}},{key:"waitingForContent",get:function(){return!!this._featureAbortController}},{key:"setActiveMedia",value:function(e,t){var r=this.contentViewModels[e];r instanceof wn&&r.setActiveMedia(t)}},{key:"nextMedia",value:function(e){var t=this.contentViewModels[e];t instanceof wn&&t.next()}},{key:"previousMedia",value:function(e){var t=this.contentViewModels[e];t instanceof wn&&t.previous()}},{key:"_clear",value:function(){this._set("title",""),this._set("content",null),this._set("formattedAttributes",null)}},{key:"graphicChanged",value:function(){var e=Object(s.a)(o.a.mark((function e(){var t,r;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._cancelFeatureQuery(),this._clear(),t=this.graphic){e.next=4;break}return e.abrupt("return");case 4:return r=Object(q.e)(),this._featureAbortController=r,e.prev=6,e.next=9,this._queryFeature({signal:r.signal});case 9:e.next=14;break;case 11:e.prev=11,e.t0=e.catch(6),bi.error("error","error loading popupTemplate for graphic",{error:e.t0,graphic:t});case 14:this._featureAbortController===r&&(this._featureAbortController=null);case 15:case"end":return e.stop()}}),e,this,[[6,11]])})));return function(){return e.apply(this,arguments)}}()},{key:"_cancelFeatureQuery",value:function(){var e=this._featureAbortController;e&&e.abort(),this._featureAbortController=null}},{key:"_compileContent",value:function(e){var t=this;if(this._destroyContentViewModels(),this.graphic)return Array.isArray(e)?e.map((function(e,r){return"attachments"===e.type?t._compileAttachments(e,r):"custom"===e.type?t._compileCustom(e,r):"fields"===e.type?t._compileFields(e,r):"media"===e.type?t._compileMedia(e,r):"text"===e.type?t._compileText(e,r):void 0})):"string"==typeof e?this._compileText(new ei.a({text:e}),0).text:e}},{key:"_destroyContentViewModels",value:function(){this.contentViewModels.forEach((function(e){return e&&!e.destroyed&&e.destroy()})),this._set("contentViewModels",[])}},{key:"_compileAttachments",value:function(e,t){var r=this.graphic,n=e.description,i=e.title;return this.contentViewModels[t]=new jr(Object(ie.a)({graphic:r},this._compileTitleAndDesc({title:i,description:n}))),e}},{key:"_compileCustom",value:function(e,t){var r=this.graphic,n=e.creator,i=e.destroyer;return this.contentViewModels[t]=new Rr({graphic:r,creator:n,destroyer:i}),e}},{key:"_compileTitleAndDesc",value:function(e){var t=e.title,r=e.description,n=this._fieldInfoMap,i=this._sourceLayer,a=this.graphic,o=this.formattedAttributes,s=this._expressionAttributes,c=a.attributes,l=o.global;return{title:$e({attributes:c,fieldInfoMap:n,globalAttributes:l,expressionAttributes:s,layer:i,text:t}),description:$e({attributes:c,fieldInfoMap:n,globalAttributes:l,expressionAttributes:s,layer:i,text:r})}}},{key:"_compileFields",value:function(e,t){var r=this._effectivePopupTemplate,n=this.formattedAttributes,i=e.clone(),a=(null==e?void 0:e.fieldInfos)||(null==r?void 0:r.fieldInfos),o=null==r?void 0:r.expressionInfos,s=Object(ie.a)(Object(ie.a)({},n.global),n.content[t]),c=i.description,l=i.title,u=new Gr(Object(ie.a)({attributes:s,expressionInfos:o,fieldInfos:a},this._compileTitleAndDesc({title:l,description:c})));return this.contentViewModels[t]=u,i.fieldInfos=u.formattedFieldInfos.slice(0),i}},{key:"_compileMedia",value:function(e,t){var r=this.graphic,n=this._fieldInfoMap,i=this._effectivePopupTemplate,a=this.relatedInfos,o=this._sourceLayer,s=this._expressionAttributes,c=r.attributes,l=this.formattedAttributes.global,u=e.clone(),d=u.description,h=u.mediaInfos,f=u.title,p=new wn(Object(ie.a)({activeMediaInfoIndex:u.activeMediaInfoIndex||0,attributes:c,layer:o,fieldInfoMap:n,formattedAttributes:l,expressionAttributes:s,mediaInfos:h,popupTemplate:i,relatedInfos:a},this._compileTitleAndDesc({title:f,description:d})));return u.mediaInfos=p.formattedMediaInfos.slice(0),this.contentViewModels[t]=p,u}},{key:"_compileText",value:function(e,t){var r=e.clone(),n=this.graphic,i=this._fieldInfoMap,a=this._sourceLayer,o=this._expressionAttributes;if(r&&r.text){var s=n.attributes,c=this.formattedAttributes.global;r.text=$e({attributes:s,fieldInfoMap:i,globalAttributes:c,expressionAttributes:o,layer:a,text:r.text})}return this.contentViewModels[t]=new Rr({graphic:n,creator:r.text}),r}},{key:"_compileLastEditInfo",value:function(){var e=this._effectivePopupTemplate,t=this._sourceLayer,r=this.graphic;if(e){var n=e.lastEditInfoEnabled,i=null==t?void 0:t.editFieldsInfo;return n&&i?function(e,t){var r=e.creatorField,n=e.creationDateField,i=e.editorField,a=e.editDateField;if(t){var o=t[a];if("number"==typeof o){var s=t[i];return{type:"edit",date:Object(Se.b)(o,Ue),user:s}}var c=t[n];if("number"==typeof c){var l=t[r];return{type:"create",date:Object(Se.b)(c,Ue),user:l}}return null}}(i,r.attributes):void 0}}},{key:"_compileTitle",value:function(e){var t=this._fieldInfoMap,r=this._sourceLayer,n=this.graphic,i=this._expressionAttributes;return $e({attributes:n.attributes,fieldInfoMap:t,globalAttributes:this.formattedAttributes.global,expressionAttributes:i,layer:r,text:e})}},{key:"_getTitle",value:function(){var e=Object(s.a)(o.a.mark((function e(){var t,r,n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this._effectivePopupTemplate,r=this.graphic,n=null==t?void 0:t.title,e.abrupt("return",Ge(n,{graphic:r}));case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"_getContent",value:function(){var e=Object(s.a)(o.a.mark((function e(){var t,r,n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this._effectivePopupTemplate,r=this.graphic,n=null==t?void 0:t.content,e.abrupt("return",Ge(n,{graphic:r}));case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"_queryFeature",value:function(){var e=Object(s.a)(o.a.mark((function e(t){var r,n,i,a,s,c,l,u,d,h,f,p;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=this._featureAbortController,n=this._sourceLayer,i=this.graphic,a=this._effectivePopupTemplate,s=this.spatialReference,c=this.map,l=this.view,e.next=9,Object(q.k)({content:this._getContent(),title:this._getTitle()});case 9:if(u=e.sent,d=u.content.value,h=u.title.value,r===this._featureAbortController&&i){e.next=14;break}return e.abrupt("return");case 14:return e.next=16,pt({graphic:i,popupTemplate:a,layer:n,spatialReference:s},t);case 16:return e.next=18,Object(q.k)({checkForRelatedFeatures:this._checkForRelatedFeatures(t),expressionAttributes:hi({popupTemplate:this._effectivePopupTemplate,spatialReference:s,graphic:i,map:c,view:l})});case 18:f=e.sent,p=f.expressionAttributes.value,r===this._featureAbortController&&i&&(this._expressionAttributes=p,this._set("formattedAttributes",this._createFormattedAttributes(d,p)),this._set("title",this._compileTitle(h)),this._set("lastEditInfo",this._compileLastEditInfo()||null),this._set("content",this._compileContent(d)||null));case 21:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_createFormattedAttributes",value:function(e,t){var r=this._effectivePopupTemplate,n=this.graphic,i=this.relatedInfos,a=this._sourceLayer,o=this._fieldInfoMap,s=null==r?void 0:r.fieldInfos,c=Object(ie.a)(Object(ie.a)({},n.attributes),t),l={global:lt({fieldInfos:s,graphic:n,attributes:c,layer:a,fieldInfoMap:o,relatedInfos:i}),content:[]};return Array.isArray(e)&&e.forEach((function(e,t){"fields"===e.type&&e.fieldInfos&&(l.content[t]=lt({fieldInfos:e.fieldInfos,graphic:n,attributes:c,layer:a,fieldInfoMap:o,relatedInfos:i}))})),l}},{key:"_checkForRelatedFeatures",value:function(e){var t=this.graphic,r=this._effectivePopupTemplate;return this._queryRelatedInfos(t,at(r),e)}},{key:"_queryRelatedInfos",value:function(){var e=Object(s.a)(o.a.mark((function e(t,r,n){var i,a,s,c,l,u,d=this;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=this.relatedInfos,a=this._sourceLayer,i.clear(),!Object(I.j)(a.associatedLayer)){e.next=8;break}return e.next=5,a.associatedLayer.load(n);case 5:e.t0=e.sent,e.next=9;break;case 8:e.t0=a;case 9:if(s=e.t0){e.next=12;break}return e.abrupt("return");case 12:if((c=r.filter((function(e){return e&&vt(e.fieldName)})))&&c.length){e.next=15;break}return e.abrupt("return");case 15:return r.forEach((function(e){return d._configureRelatedInfo(e,s)})),e.next=18,vn({relatedInfos:i,layer:s},n);case 18:return l=e.sent,Object.keys(l).forEach((function(e){var t,r=i.get(e.toString()),n=null==(t=l[e])?void 0:t.value;r&&n&&(r.layerInfo=n.data)})),e.next=22,mn({graphic:t,relatedInfos:i,layer:s},n);case 22:u=e.sent,Object.keys(u).forEach((function(e){var t;hn(null==(t=u[e])?void 0:t.value,i.get(e.toString()))}));case 24:case"end":return e.stop()}}),e,this)})));return function(t,r,n){return e.apply(this,arguments)}}()},{key:"_configureRelatedInfo",value:function(e,t){var r=this.relatedInfos,n=cn(e.fieldName);if(n){var i=n.layerId,a=n.fieldName;if(i){var o=r.get(i.toString())||dn(i,t);o&&(function(e){var t=e.relatedInfo,r=e.fieldName,n=e.fieldInfo;if(t.relatedFields.push(r),n.statisticType){var i=new nn.a({statisticType:n.statisticType,onStatisticField:r,outStatisticFieldName:r});t.outStatistics.push(i)}}({relatedInfo:o,fieldName:a,fieldInfo:e}),this.relatedInfos.set(i,o))}}}}]),r}(de.a);Object(b.a)([Object(y.b)()],vi.prototype,"_featureAbortController",void 0),Object(b.a)([Object(y.b)({readOnly:!0})],vi.prototype,"_effectivePopupTemplate",null),Object(b.a)([Object(y.b)({readOnly:!0})],vi.prototype,"_fieldInfoMap",null),Object(b.a)([Object(y.b)({readOnly:!0})],vi.prototype,"_sourceLayer",null),Object(b.a)([Object(y.b)({readOnly:!0})],vi.prototype,"content",void 0),Object(b.a)([Object(y.b)({readOnly:!0})],vi.prototype,"contentViewModels",void 0),Object(b.a)([Object(y.b)({type:Boolean})],vi.prototype,"defaultPopupTemplateEnabled",void 0),Object(b.a)([Object(y.b)({readOnly:!0})],vi.prototype,"formattedAttributes",void 0),Object(b.a)([Object(y.b)({type:E.a,value:null})],vi.prototype,"graphic",null),Object(b.a)([Object(y.b)({readOnly:!0})],vi.prototype,"lastEditInfo",void 0),Object(b.a)([Object(y.b)()],vi.prototype,"relatedInfos",void 0),Object(b.a)([Object(y.b)()],vi.prototype,"spatialReference",null),Object(b.a)([Object(y.b)({readOnly:!0})],vi.prototype,"title",void 0),Object(b.a)([Object(y.b)()],vi.prototype,"map",null),Object(b.a)([Object(y.b)({readOnly:!0})],vi.prototype,"waitingForContent",null),Object(b.a)([Object(y.b)()],vi.prototype,"view",void 0);var mi=vi=Object(b.a)([Object(w.a)(pi)],vi),yi=function(e){var t=function(e){Object(f.a)(r,e);var t=Object(p.a)(r);function r(){var e;return Object(c.a)(this,r),(e=t.apply(this,arguments)).renderNodeContent=function(t){return Object(Ir.b)(t)&&!t.destroyed?Object(kt.a)("div",{key:t},t.render()):t instanceof HTMLElement?Object(kt.a)("div",{key:t,bind:t,afterCreate:e._attachToNode}):Object(Ir.a)(t)?Object(kt.a)("div",{key:t,bind:t.domNode,afterCreate:e._attachToNode}):null},e}return Object(l.a)(r,[{key:"_attachToNode",value:function(e){e.appendChild(this)}}]),r}(e);return t=Object(b.a)([Object(w.a)("esri.widgets.Feature.ContentMixin")],t)},gi=r(236),Oi="esri-icon-loading-indicator esri-rotating",ji="esri-widget",_i="esri-feature",wi="esri-feature__size-container",xi="esri-feature__title",ki="esri-feature__main-container",Si="esri-feature__content-element",Ti="esri-feature__text",Ci="esri-feature__last-edited-info",Mi="esri-feature__loading-container",Pi="esri-feature__loading-spinner",Ai={title:!0,content:!0,lastEditedInfo:!0},Ei=function(e){Object(f.a)(r,e);var t=Object(p.a)(r);function r(e,n){var i;return Object(c.a)(this,r),(i=t.call(this,e,n))._contentWidgets=[],i.graphic=null,i.defaultPopupTemplateEnabled=!1,i.headingLevel=2,i.label=void 0,i.messages=null,i.messagesURIUtils=null,i.spatialReference=null,i.title=null,i.visibleElements=Object(ie.a)({},Ai),i.map=null,i.view=null,i.viewModel=new mi,i}return Object(l.a)(r,[{key:"initialize",value:function(){var e=this;this.own(Object(W.a)(this,"viewModel.contentViewModels",(function(){return e._setupContentWidgets()})))}},{key:"destroy",value:function(){this._destroyContentWidgets()}},{key:"castVisibleElements",value:function(e){return Object(ie.a)(Object(ie.a)({},Ai),e)}},{key:"render",value:function(){var e=this.viewModel.waitingForContent;return Object(kt.a)("div",{class:this.classes(_i,ji)},Object(kt.a)("div",{class:wi},this.renderTitle(),e?this.renderLoading():this.renderContentContainer()))}},{key:"setActiveMedia",value:function(e,t){this.viewModel.setActiveMedia(e,t)}},{key:"nextMedia",value:function(e){this.viewModel.nextMedia(e)}},{key:"previousMedia",value:function(e){this.viewModel.previousMedia(e)}},{key:"renderLoading",value:function(){return Object(kt.a)("div",{key:"loading-container",class:Mi},Object(kt.a)("span",{class:this.classes(Oi,Pi)}))}},{key:"renderContentContainer",value:function(){return this.visibleElements.content?Object(kt.a)("div",{class:ki},[this.renderContent(),this.renderLastEditInfo()]):null}},{key:"renderTitle",value:function(){var e=this.visibleElements,t=this.title;return e.title?Object(kt.a)(wr,{level:this.headingLevel,class:xi,innerHTML:t}):null}},{key:"renderContent",value:function(){var e=this.viewModel.content,t="content";if(!e)return null;if(Array.isArray(e))return e.length?Object(kt.a)("div",{key:"".concat(t,"-content-elements")},e.map(this.renderContentElement,this)):null;if("string"==typeof e){var r=this._contentWidgets[0];return!r||r.destroyed?null:Object(kt.a)("div",{key:"".concat(t,"-content")},r.render())}return this.renderNodeContent(e)}},{key:"renderContentElement",value:function(e,t){var r=this.visibleElements;if("boolean"!=typeof r.content&&!r.content[e.type])return null;switch(e.type){case"attachments":return this.renderAttachments(t);case"custom":return this.renderCustom(e,t);case"fields":return this.renderFields(t);case"media":return this.renderMedia(t);case"text":return this.renderText(e,t);default:return null}}},{key:"renderAttachments",value:function(e){var t=this._contentWidgets[e];if(!t||t.destroyed)return null;var r=t.viewModel,n=r.state,i=r.attachmentInfos;return"loading"===n||i.length>0?Object(kt.a)("div",{key:this._buildKey("attachments-element",e),class:this.classes(Si)},t.render()):null}},{key:"renderCustom",value:function(e,t){var r=e.creator,n=this._contentWidgets[t];return!n||n.destroyed?null:r?Object(kt.a)("div",{key:this._buildKey("custom-element",t),class:Si},n.render()):null}},{key:"renderFields",value:function(e){var t=this._contentWidgets[e];return!t||t.destroyed?null:Object(kt.a)("div",{key:this._buildKey("fields-element",e),class:Si},t.render())}},{key:"renderMedia",value:function(e){var t=this._contentWidgets[e];return!t||t.destroyed?null:Object(kt.a)("div",{key:this._buildKey("media-element",e),class:Si},t.render())}},{key:"renderLastEditInfo",value:function(){var e=this.visibleElements,t=this.messages,r=this.viewModel.lastEditInfo;if(!r||!e.lastEditedInfo)return null;var n=r.date,i=r.user,a="edit"===r.type?i?t.lastEditedByUser:t.lastEdited:i?t.lastCreatedByUser:t.lastCreated,o=Object(gi.a)(a,{date:n,user:i});return Object(kt.a)("div",{key:"edit-info-element",class:this.classes(Ci,Si)},o)}},{key:"renderText",value:function(e,t){var r=e.text,n=this._contentWidgets[t];return!n||n.destroyed?null:r?Object(kt.a)("div",{key:this._buildKey("text-element",t),class:this.classes(Si,Ti)},n.render()):null}},{key:"_buildKey",value:function(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return"".concat(e,"__").concat(this.get("viewModel.graphic.uid")||"0","-").concat(r.join("-"))}},{key:"_destroyContentWidgets",value:function(){this._contentWidgets.forEach((function(e){e.viewModel=null,e&&!e.destroyed&&e.destroy()})),this._contentWidgets=[]}},{key:"_setupContentWidgets",value:function(){var e=this;this._destroyContentWidgets();var t=this.headingLevel,r=this.visibleElements,n=this.get("viewModel.content"),i=this.viewModel.contentViewModels;if(Array.isArray(n))n.forEach((function(n,a){"attachments"===n.type&&(e._contentWidgets[a]=new Ar({displayType:n.displayType,headingLevel:r.title?t+1:t,viewModel:i[a]})),"fields"===n.type&&(e._contentWidgets[a]=new Jr({viewModel:i[a]})),"media"===n.type&&(e._contentWidgets[a]=new Kn({viewModel:i[a]})),"text"===n.type&&(e._contentWidgets[a]=new Vr({viewModel:i[a]})),"custom"===n.type&&(e._contentWidgets[a]=new Vr({viewModel:i[a]}))}),this);else{var a=i[0];a&&!a.destroyed&&(this._contentWidgets[0]=new Vr({viewModel:a}))}this.scheduleRender()}}]),r}(yi(ge.a));Object(b.a)([Object(ye.a)("viewModel.graphic")],Ei.prototype,"graphic",void 0),Object(b.a)([Object(ye.a)("viewModel.defaultPopupTemplateEnabled")],Ei.prototype,"defaultPopupTemplateEnabled",void 0),Object(b.a)([Object(y.b)()],Ei.prototype,"headingLevel",void 0),Object(b.a)([Object(y.b)({aliasOf:{source:"messages.widgetLabel",overridable:!0}})],Ei.prototype,"label",void 0),Object(b.a)([Object(y.b)(),Object(xt.a)("esri/widgets/Feature/t9n/Feature")],Ei.prototype,"messages",void 0),Object(b.a)([Object(y.b)(),Object(xt.a)("esri/widgets/support/t9n/uriUtils")],Ei.prototype,"messagesURIUtils",void 0),Object(b.a)([Object(ye.a)("viewModel.spatialReference")],Ei.prototype,"spatialReference",void 0),Object(b.a)([Object(ye.a)("viewModel.title")],Ei.prototype,"title",void 0),Object(b.a)([Object(y.b)()],Ei.prototype,"visibleElements",void 0),Object(b.a)([Object(O.a)("visibleElements")],Ei.prototype,"castVisibleElements",null),Object(b.a)([Object(ye.a)("viewModel.map")],Ei.prototype,"map",void 0),Object(b.a)([Object(ye.a)("viewModel.view")],Ei.prototype,"view",void 0),Object(b.a)([Object(y.b)({type:mi})],Ei.prototype,"viewModel",void 0);var Ri=Ei=Object(b.a)([Object(w.a)("esri.widgets.Feature")],Ei),Ii=r(82),Di=function(e){Object(f.a)(r,e);var t=Object(p.a)(r);function r(e){var n;return Object(c.a)(this,r),(n=t.call(this,e))._anchorHandles=new oe.a,n.location=null,n.screenLocation=null,n.screenLocationEnabled=!1,n.view=null,n._anchorHandles.add([Object(W.e)(Object(u.a)(n),["screenLocationEnabled","location","view.size","view.stationary"],(function(){return n._updateScreenPointAndHandle()})),Object(W.e)(Object(u.a)(n),["view","view.ready"],(function(){return n._wireUpView()}))]),n}return Object(l.a)(r,[{key:"destroy",value:function(){this.view=null,this._anchorHandles&&this._anchorHandles.destroy(),this._anchorHandles=null,this._viewpointHandle=null}},{key:"_wireUpView",value:function(){var e=this,t="view";if(this._anchorHandles.remove(t),this._viewpointHandle=null,this.get("view.ready")){this._setScreenLocation();var r=this.view,n="3d"===r.type?"camera":"viewpoint",i=Object(W.d)(r,n,(function(){return e._viewpointChange()}));this._anchorHandles.add(i,t),this._viewpointHandle=i,this._toggleWatchingViewpoint()}}},{key:"_viewpointChange",value:function(){this._setScreenLocation(),this.emit("view-change")}},{key:"_updateScreenPointAndHandle",value:function(){this._setScreenLocation(),this._toggleWatchingViewpoint()}},{key:"_toggleWatchingViewpoint",value:function(){var e=this._viewpointHandle,t=this.location,r=this.screenLocationEnabled;e&&(t&&r?e.resume():e.pause())}},{key:"_setScreenLocation",value:function(){var e=this.location,t=this.view,r=this.screenLocationEnabled,n=this.get("view.ready"),i=r&&n&&Object(I.j)(e)?t.toScreen(e):null;this._set("screenLocation",i)}}]),r}(Ii.a.EventedAccessor);Object(b.a)([Object(y.b)()],Di.prototype,"location",void 0),Object(b.a)([Object(y.b)({readOnly:!0})],Di.prototype,"screenLocation",void 0),Object(b.a)([Object(y.b)()],Di.prototype,"screenLocationEnabled",void 0),Object(b.a)([Object(y.b)()],Di.prototype,"view",void 0);var Fi=Di=Object(b.a)([Object(w.a)("esri.widgets.support.AnchorElementViewModel")],Di),Li=function(e){Object(f.a)(r,e);var t=Object(p.a)(r);function r(e){var n;return Object(c.a)(this,r),(n=t.call(this,e)).visible=!1,n}return r}(Fi);Object(b.a)([Object(y.b)()],Li.prototype,"visible",void 0);var zi=Li=Object(b.a)([Object(w.a)("esri.widgets.CompassViewModel")],Li),Vi="esri-spinner",Ni="esri-spinner--start",Ui="esri-spinner--finish",Bi=function(e){Object(f.a)(r,e);var t=Object(p.a)(r);function r(e,n){var i;return Object(c.a)(this,r),(i=t.call(this,e,n))._animationDelay=500,i._animationPromise=null,i.location=null,i.view=null,i.viewModel=new zi,i.visible=!1,i}return Object(l.a)(r,[{key:"initialize",value:function(){var e=this;this.own([Object(W.e)(this,"visible",(function(t){return e._visibleChange(t)}))])}},{key:"destroy",value:function(){this._animationPromise=null}},{key:"show",value:function(e){var t=this,r=e.location,n=e.promise;r&&(this.viewModel.location=r),this.visible=!0;n&&n.catch((function(){})).then((function(){return t.hide()}))}},{key:"hide",value:function(){this.visible=!1}},{key:"render",value:function(){var e,t=this.visible,r=!!this.viewModel.screenLocation,n=t&&r,i=!t&&r,a=(e={},Object(ve.a)(e,Ni,n),Object(ve.a)(e,Ui,i),e),o=this._getPositionStyles();return Object(kt.a)("div",{class:this.classes(Vi,a),styles:o})}},{key:"_visibleChange",value:function(e){var t=this;if(e)this.viewModel.screenLocationEnabled=!0;else{var r=Object(q.a)(this._animationDelay);this._animationPromise=r,r.catch((function(){})).then((function(){t._animationPromise===r&&(t.viewModel.screenLocationEnabled=!1,t._animationPromise=null)}))}}},{key:"_getPositionStyles",value:function(){var e=this.viewModel,t=e.screenLocation,r=e.view;if(!r||Object(I.i)(t))return{};var n=r.padding;return{left:t.x-n.left+"px",top:t.y-n.top+"px"}}}]),r}(ge.a);Object(b.a)([Object(ye.a)("viewModel.location")],Bi.prototype,"location",void 0),Object(b.a)([Object(ye.a)("viewModel.view")],Bi.prototype,"view",void 0),Object(b.a)([Object(y.b)({type:zi})],Bi.prototype,"viewModel",void 0),Object(b.a)([Object(ye.a)("viewModel.visible")],Bi.prototype,"visible",void 0);var Gi=Bi=Object(b.a)([Object(w.a)("esri.widgets.Spinner")],Bi),qi=(r(98),r(368)),Hi=r(329),Wi=r(312),Qi=r(515),Zi=r(267);function Xi(e){return e&&"opacity"in e?e.opacity*Xi(e.parent):1}function Yi(e,t){return $i.apply(this,arguments)}function $i(){return($i=Object(s.a)(o.a.mark((function e(t,n){var a,s,c,l,u,d,h,f,p,b,v,m,y,g,O,j,_,w,x,k,S,T,C,M,P;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return");case 2:if(c=t.sourceLayer,l=null!=(a=Object(I.j)(n)&&null!=(s=n.useSourceLayer)&&s?c:t.layer)?a:c,u=Xi(l),!Object(I.j)(t.symbol)||Object(I.j)(n)&&!0===n.ignoreGraphicSymbol){e.next=13;break}if("web-style"!==t.symbol.type){e.next=10;break}return e.next=7,t.symbol.fetchSymbol(Object(I.j)(n)?n.abortOptions:null);case 7:e.t0=e.sent,e.next=11;break;case 10:e.t0=t.symbol.clone();case 11:return d=e.t0,e.abrupt("return",(Object(Zi.a)(d,null,u),d));case 13:if(!(h=Object(I.j)(n)&&n.renderer||l&&"renderer"in l&&l.renderer)||!("getSymbolAsync"in h)){e.next=20;break}return e.next=17,h.getSymbolAsync(t,n);case 17:e.t1=e.sent,e.next=21;break;case 20:e.t1=null;case 21:if(f=e.t1){e.next=24;break}return e.abrupt("return");case 24:if("web-style"!==f.type){e.next=30;break}return e.next=27,f.fetchSymbol(Object(I.j)(n)?n.abortOptions:null);case 27:e.t2=e.sent,e.next=31;break;case 30:e.t2=f.clone();case 31:if(f=e.t2,"visualVariables"in h&&h.visualVariables&&h.visualVariables.length){e.next=34;break}return e.abrupt("return",(Object(Zi.a)(f,null,u),f));case 34:if(!("arcadeRequiredForVisualVariables"in h)||!h.arcadeRequiredForVisualVariables||!Object(I.i)(n)&&!Object(I.i)(n.arcade)){e.next=40;break}return p=Object(ie.a)({},Object(I.s)(n)),e.next=38,Object(Pe.e)();case 38:p.arcade=e.sent,n=p;case 40:return e.next=42,Promise.resolve().then(r.bind(null,420));case 42:b=e.sent,v=[],m=[],y=[],g=[],O=Object(i.a)(h.visualVariables),e.prev=48,O.s();case 50:if((j=O.n()).done){e.next=64;break}_=j.value,e.t3=_.type,e.next="color"===e.t3?55:"opacity"===e.t3?57:"rotation"===e.t3?59:"size"===e.t3?61:62;break;case 55:return v.push(_),e.abrupt("break",62);case 57:return m.push(_),e.abrupt("break",62);case 59:return g.push(_),e.abrupt("break",62);case 61:_.target||y.push(_);case 62:e.next=50;break;case 64:e.next=69;break;case 66:e.prev=66,e.t4=e.catch(48),O.e(e.t4);case 69:return e.prev=69,O.f(),e.finish(69);case 72:if(w=!!v.length&&v[v.length-1],x=w?b.getColor(w,t,n):null,k=!!m.length&&m[m.length-1],S=k?b.getOpacity(k,t,n):null,null!=u&&(S=null!=S?S*u:u),Object(Zi.a)(f,x,S),!y.length){e.next=78;break}return T=b.getAllSizes(y,t,n),e.next=78,Object(Zi.d)(f,T);case 78:for(C=0,M=g;C<M.length;C++)P=M[C],Object(Zi.c)(f,b.getRotationAngle(P,t,n),P.axis);return e.abrupt("return",f);case 80:case"end":return e.stop()}}),e,null,[[48,66,69,72]])})))).apply(this,arguments)}for(var Ji=r(562),Ki=Object(g.a)("mac")?"Meta":"Ctrl",ea={8:"Backspace",9:"Tab",13:"Enter",27:"Escape",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete"},ta=48;ta<58;ta++)ea[ta]=String.fromCharCode(ta);for(var ra=1;ra<25;ra++)ea[111+ra]="F".concat(ra);for(var na=65;na<91;na++)ea[na]=[String.fromCharCode(na+32),String.fromCharCode(na)];function ia(e){switch(e){case"Ctrl":case"Alt":case"Shift":case"Meta":case"Primary":return!0}return!1}var aa=function(){function e(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];Object(c.a)(this,e),this.eventType=t,this.keyModifiers=r}return Object(l.a)(e,[{key:"matches",value:function(e){if(e.type!==this.eventType)return!1;if(0===this.keyModifiers.length)return!0;var t,r=e.modifiers,n=Object(i.a)(this.keyModifiers);try{for(n.s();!(t=n.n()).done;){var a=t.value;if(!r.has(a))return!1}}catch(o){n.e(o)}finally{n.f()}return!0}}]),e}(),oa=j.a.getLogger("esri.views.input.InputHandler"),sa=function(){function e(t){Object(c.a)(this,e),this._manager=null,this._incoming={},this._outgoing={},this._incomingEventMatches=null,this._incomingEventTypes=null,this._outgoingEventTypes=null,this._hasSideEffects=t}return Object(l.a)(e,[{key:"incomingEventMatches",get:function(){if(!this._incomingEventMatches)for(var e in this._incomingEventMatches=[],this._incoming){var t,r=this._incoming[e],n=Object(i.a)(r);try{for(n.s();!(t=n.n()).done;){var a=t.value;this._incomingEventMatches.push(a.match)}}catch(o){n.e(o)}finally{n.f()}}return this._incomingEventMatches}},{key:"incomingEventTypes",get:function(){return this._incomingEventTypes||(this._incomingEventTypes=this.incomingEventMatches.map((function(e){return e.eventType}))),this._incomingEventTypes}},{key:"outgoingEventTypes",get:function(){return this._outgoingEventTypes||(this._outgoingEventTypes=Object.keys(this._outgoing)),this._outgoingEventTypes}},{key:"hasSideEffects",get:function(){return this._hasSideEffects}},{key:"hasPendingInputs",get:function(){return!1}},{key:"onInstall",value:function(e){var t=this;this._manager?oa.error("This InputHandler has already been registered with an InputManager"):(e.setEventCallback((function(e){return t._handleEvent(e)})),e.setUninstallCallback((function(){return t._onUninstall()})),this._manager=e)}},{key:"onUninstall",value:function(){}},{key:"registerIncoming",value:function(e,t,r){var n,i=this;"function"==typeof t?(r=t,n=[]):n=t||[];var a="string"==typeof e?new aa(e,n):e,o=function(){i._incomingEventTypes=null,i._incomingEventMatches=null},s=function(e){var t=i._incoming[e.match.eventType];if(t){var r=t.indexOf(e);t.splice(r,1),o(),i._manager&&i._manager.updateDependencies()}},c=new ca(a,r,{onPause:s,onRemove:s,onResume:function(e){var t=i._incoming[e.match.eventType];t&&-1===t.indexOf(e)&&(t.push(e),o(),i._manager&&i._manager.updateDependencies())}}),l=this._incoming[a.eventType];return l||(l=[],this._incoming[a.eventType]=l),l.push(c),o(),this._manager&&this._manager.updateDependencies(),c}},{key:"registerOutgoing",value:function(e){var t=this;if(this._outgoing[e])throw Error("There is already a callback registered for this outgoing InputEvent: "+e);var r=new la(e,{onEmit:function(e,r,n,i){t._manager.emit(e.eventType,r,n,i)},onRemove:function(e){delete t._outgoing[e.eventType],t._manager.updateDependencies()}});return this._outgoing[e]=r,this._outgoingEventTypes=null,this._manager&&this._manager.updateDependencies(),r}},{key:"startCapturingPointer",value:function(e){this._manager.setPointerCapture(e,!0)}},{key:"stopCapturingPointer",value:function(e){this._manager.setPointerCapture(e,!1)}},{key:"refreshHasPendingInputs",value:function(){this._manager.refreshHasPendingInputs()}},{key:"_onUninstall",value:function(){this._manager?(this.onUninstall(),this._manager=null):oa.error("This InputHandler is not registered with an InputManager")}},{key:"_handleEvent",value:function(e){var t=this._incoming[e.type];if(t){var r,n=Object(i.a)(t);try{for(n.s();!(r=n.n()).done;){var a=r.value;if(a.match.matches(e)&&(a.callback(e),e.shouldStopPropagation()))break}}catch(o){n.e(o)}finally{n.f()}}}}]),e}(),ca=function(){function e(t,r,n){Object(c.a)(this,e),this.match=t,this._callback=r,this._handler=n}return Object(l.a)(e,[{key:"pause",value:function(){this._handler.onPause(this)}},{key:"resume",value:function(){this._handler.onResume(this)}},{key:"remove",value:function(){this._handler.onRemove(this)}},{key:"callback",get:function(){return this._callback}}]),e}(),la=function(){function e(t,r){Object(c.a)(this,e),this.eventType=t,this._removed=!1,this._handler=r}return Object(l.a)(e,[{key:"emit",value:function(e,t,r){this._removed||this._handler.onEmit(this,e,t,r)}},{key:"remove",value:function(){this._removed=!0,this._handler.onRemove(this)}}]),e}(),ua=function(e){Object(f.a)(r,e);var t=Object(p.a)(r);function r(e){var n;return Object(c.a)(this,r),(n=t.call(this,!0))._onChange=e,n._value="mouse",n.registerIncoming("pointer-down",(function(e){var t="touch"===e.data.native.pointerType;n._setValue(t?"touch":"mouse")})),n._moveHandler=n.registerIncoming("pointer-move",(function(e){var t="touch"===e.data.native.pointerType;n._setValue(t?"touch":"mouse")})),n._moveHandler.pause(),n}return Object(l.a)(r,[{key:"_setValue",value:function(e){e!==this._value&&("touch"===e?this._moveHandler.resume():this._moveHandler.pause(),this._value=e,this._onChange(e))}}]),r}(sa),da=j.a.getLogger("esri.views.input.InputManager"),ha=function(e){Object(f.a)(r,e);var t=Object(p.a)(r);function r(e){var n;return Object(c.a)(this,r),(n=t.call(this,e))._pointerCaptures=new Map,n._nameToGroup={},n._handlers=[],n._currentPropagation=null,n._updateDependenciesAfterPropagation=!1,n._sourceEvents=new Set,n._keyModifiers=new Set,n._activeKeyModifiers=new Set,n._stoppedPropagationEventIds=new Set,n.primaryKey=Ki,n.latestPointerType="mouse",n.test={timestamp:void 0,hasCurrentPropagation:function(){return!!n._currentPropagation}},n}return Object(l.a)(r,[{key:"initialize",value:function(){this.eventSource.onEventReceived=this._onEventReceived.bind(this),this._installRecognizers()}},{key:"destroy",value:function(){for(var e=0,t=Object.keys(this._nameToGroup);e<t.length;e++){var r=t[e];this.uninstallHandlers(r)}this.eventSource=null,this._currentPropagation=null}},{key:"hasPendingInputs",get:function(){return this._handlers.some((function(e){return e.handler.hasPendingInputs}))}},{key:"installHandlers",value:function(e,t){var r=this,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:pa.INTERNAL;if(this._nameToGroup[e])da.error("There is already an InputHandler group registered under the name `"+e+"`");else if(0!==t.length){var i={name:e,handlers:t.map((function(e){return{handler:e,active:!0,removed:!1,priorityIndex:0,groupPriority:n,eventCallback:null,uninstallCallback:null}}))};this._nameToGroup[e]=i;for(var a=function(e){var t=i.handlers[e];r._handlers.push(t),t.handler.onInstall({updateDependencies:function(){r.updateDependencies()},emit:function(e,n,i,a,o){r._emitInputEvent(t.priorityIndex+1,e,n,i,o,a)},setPointerCapture:function(e,n){r._setPointerCapture(i,t,e,n)},setEventCallback:function(e){t.eventCallback=e},setUninstallCallback:function(e){t.uninstallCallback=e},refreshHasPendingInputs:function(){r.notifyChange("hasPendingInputs")}})},o=i.handlers.length-1;o>=0;o--)a(o);this.updateDependencies()}else da.error("Can't register a group of zero handlers")}},{key:"uninstallHandlers",value:function(e){var t=this._nameToGroup[e];t?(t.handlers.forEach((function(e){e.removed=!0,e.uninstallCallback()})),delete this._nameToGroup[e],this._currentPropagation?this._currentPropagation.needsHandlerGarbageCollect=!0:this._garbageCollectRemovedHandlers()):da.error("There is no InputHandler group registered under the name `"+e+"`")}},{key:"hasHandlers",value:function(e){return void 0!==this._nameToGroup[e]}},{key:"updateDependencies",value:function(){if(this._currentPropagation)this._updateDependenciesAfterPropagation=!0;else{this._updateDependenciesAfterPropagation=!1;var e=new Set,t=new Set;this._handlersPriority=[];for(var r=this._handlers.length-1;r>=0;r--){var n=this._handlers[r];n.priorityIndex=r,this._handlersPriority.push(n)}this._handlersPriority=this._sortHandlersPriority(this._handlersPriority);for(var a=this._handlersPriority.length-1;a>=0;a--){var o=this._handlersPriority[a];o.priorityIndex=a;var s=o.handler.hasSideEffects;if(!s){var c,l=Object(i.a)(o.handler.outgoingEventTypes);try{for(l.s();!(c=l.n()).done;){var u=c.value;if(e.has(u)){s=!0;break}}}catch(m){l.e(m)}finally{l.f()}}if(s){var d,h=Object(i.a)(o.handler.incomingEventMatches);try{for(h.s();!(d=h.n()).done;){var f=d.value;e.add(f.eventType);var p,b=Object(i.a)(f.keyModifiers);try{for(b.s();!(p=b.n()).done;){var v=p.value;ia(v)||t.add(v)}}catch(m){b.e(m)}finally{b.f()}}}catch(m){h.e(m)}finally{h.f()}}o.active=s}this._sourceEvents=e,this._keyModifiers=t,this._pointerCaptures.size>0&&this._sourceEvents.add("pointer-capture-lost"),this._keyModifiers.size>0&&(this._sourceEvents.add("key-down"),this._sourceEvents.add("key-up")),this.eventSource&&(this.eventSource.activeEvents=this._sourceEvents)}}},{key:"_setLatestPointerType",value:function(e){this._set("latestPointerType",e)}},{key:"_onEventReceived",value:function(e,t){if("pointer-capture-lost"===e){var r=t;this._pointerCaptures.delete(r.native.pointerId)}this._updateKeyModifiers(e,t);var n=null!=this.test.timestamp?this.test.timestamp:t.native?t.native.timestamp:void 0,i=t.native?t.native.cancelable:void 0;this._emitInputEventFromSource(e,t,n,i)}},{key:"_updateKeyModifiers",value:function(e,t){var r=this;if(t){var n=!1,i=function(){if(!n){var e=new Set;r._activeKeyModifiers.forEach((function(t){e.add(t)})),r._activeKeyModifiers=e,n=!0}},a=function(e,t){t&&!r._activeKeyModifiers.has(e)?(i(),r._activeKeyModifiers.add(e)):!t&&r._activeKeyModifiers.has(e)&&(i(),r._activeKeyModifiers.delete(e))};if("key-down"===e||"key-up"===e){var o=t.key;this._keyModifiers.has(o)&&a(o,"key-down"===e)}var s=t.native;a("Alt",!(!s||!s.altKey)),a("Ctrl",!(!s||!s.ctrlKey)),a("Shift",!(!s||!s.shiftKey)),a("Meta",!(!s||!s.metaKey)),a("Primary",this._activeKeyModifiers.has(this.primaryKey))}}},{key:"_installRecognizers",value:function(){var e=this;this._latestPointerTypeHandler=new ua((function(t){return e._setLatestPointerType(t)})),this.recognizers.length>0&&this.installHandlers("default",this.recognizers,pa.INTERNAL),this.installHandlers("input-manager-logic",[this._latestPointerTypeHandler],pa.INTERNAL)}},{key:"_setPointerCapture",value:function(e,t,r,n){var i=e.name+"-"+t.priorityIndex,a=this._pointerCaptures.get(r.pointerId)||new Set;this._pointerCaptures.set(r.pointerId,a),n?(a.add(i),1===a.size&&this.eventSource&&this.eventSource.setPointerCapture(r,!0)):a.has(i)&&(a.delete(i),0===a.size&&(this._pointerCaptures.delete(r.pointerId),this.eventSource&&this.eventSource.setPointerCapture(r,!1)))}},{key:"_garbageCollectRemovedHandlers",value:function(){this._handlers=this._handlers.filter((function(e){return!e.removed})),this.updateDependencies()}},{key:"_emitInputEventFromSource",value:function(e,t,r,n){this._emitInputEvent(0,e,t,r,n)}},{key:"_emitInputEvent",value:function(e,t,r,n,i,a){var o=void 0!==n?n:this._currentPropagation?this._currentPropagation.timestamp:performance.now(),s=void 0!==i&&i,c={event:new fa(t,r,o,a||this._activeKeyModifiers,s),priorityIndex:e};this._currentPropagation?this._currentPropagation.events.push(c):this._doNewPropagation(c)}},{key:"_doNewPropagation",value:function(e){this._currentPropagation={events:new Ji.a,currentHandler:null,needsHandlerGarbageCollect:!1,timestamp:e.event.timestamp},this._currentPropagation.events.push(e),this._continuePropagation()}},{key:"_continuePropagation",value:function(){var e=this,t=this._currentPropagation;if(t){for(;this._currentPropagation.events.length>0;){var r=this._currentPropagation.events.pop(),n=r.event,i=r.priorityIndex,a=n.data&&n.data.eventId;if(null==a||!this._stoppedPropagationEventIds.has(a))for(t.currentHandler=this._handlersPriority[i];t.currentHandler;){if(t.currentHandler.removed)t.needsHandlerGarbageCollect=!0;else{if(t.currentHandler.active&&!n.shouldStopPropagation()&&t.currentHandler.eventCallback(n),n.shouldStopPropagation()){null!=a&&this._stoppedPropagationEventIds.add(a);break}if(n.shouldPausePropagation((function(){return e._continuePropagation()})))return void this._pausePropagation({event:n,priorityIndex:t.currentHandler.priorityIndex+1})}t.currentHandler=this._handlersPriority[t.currentHandler.priorityIndex+1]}}t.needsHandlerGarbageCollect&&this._garbageCollectRemovedHandlers(),this.hasPendingInputs||this._stoppedPropagationEventIds.clear(),this._currentPropagation=null,this._updateDependenciesAfterPropagation&&this.updateDependencies()}}},{key:"_pausePropagation",value:function(e){var t=new Ji.a;for(t.push(e);this._currentPropagation.events.length;)t.push(this._currentPropagation.events.pop());this._currentPropagation.events=t,this._currentPropagation.currentHandler=null}},{key:"_compareHandlerPriority",value:function(e,t){if(e.handler.hasSideEffects!==t.handler.hasSideEffects)return e.handler.hasSideEffects?1:-1;if(e.groupPriority!==t.groupPriority)return e.groupPriority>t.groupPriority?-1:1;var r,n=Object(i.a)(e.handler.incomingEventMatches);try{for(n.s();!(r=n.n()).done;){var a,o=r.value,s=Object(i.a)(t.handler.incomingEventMatches);try{var c=function(){var e=a.value;if(o.eventType!==e.eventType)return"continue";var t=o.keyModifiers.filter((function(t){return-1!==e.keyModifiers.indexOf(t)}));return t.length===o.keyModifiers.length!==(t.length===e.keyModifiers.length)?{v:o.keyModifiers.length>e.keyModifiers.length?-1:1}:void 0};for(s.s();!(a=s.n()).done;){var l=c();if("continue"!==l&&"object"===typeof l)return l.v}}catch(u){s.e(u)}finally{s.f()}}}catch(u){n.e(u)}finally{n.f()}return e.priorityIndex>t.priorityIndex?-1:1}},{key:"_sortHandlersPriority",value:function(e){var t,r=[],n=Object(i.a)(e);try{for(n.s();!(t=n.n()).done;){for(var a=t.value,o=0;o<r.length&&this._compareHandlerPriority(a,r[o])>=0;)o++;r.splice(o,0,a)}}catch(s){n.e(s)}finally{n.f()}return r}},{key:"debug",get:function(){var e=this,t=function(t){var r=e._setPointerCapture;e._setPointerCapture=function(){},t(),e._setPointerCapture=r};return{injectEvent:function(r,n){t((function(){e._onEventReceived(r,n)}))},disablePointerCapture:t}}}]),r}(de.a);Object(b.a)([Object(y.b)({readOnly:!0})],ha.prototype,"hasPendingInputs",null),Object(b.a)([Object(y.b)()],ha.prototype,"eventSource",void 0),Object(b.a)([Object(y.b)()],ha.prototype,"recognizers",void 0),Object(b.a)([Object(y.b)({readOnly:!0})],ha.prototype,"latestPointerType",void 0),ha=Object(b.a)([Object(w.a)("esri.views.input.InputManager")],ha);var fa=function(){function e(t,r,n,i,a){Object(c.a)(this,e),this.type=t,this.data=r,this.timestamp=n,this.modifiers=i,this.cancelable=a,this._propagationState=0,this._resumeCallback=null}return Object(l.a)(e,[{key:"stopPropagation",value:function(){this._propagationState|=1}},{key:"shouldStopPropagation",value:function(){return 0!=(1&this._propagationState)}},{key:"async",value:function(e){var t=this;this._propagationState|=2;var r=function(e,r){t._propagationState&=-3;var n=t._resumeCallback;if(t._resumeCallback=null,n&&n(),r)throw e;return e};return("function"==typeof e?e():e).then((function(e){return r(e,!1)}),(function(e){return r(e,!0)}))}},{key:"shouldPausePropagation",value:function(e){return!!(2&this._propagationState)&&(this._resumeCallback=e,!0)}},{key:"preventDefault",value:function(){this.data.native.preventDefault()}}]),e}(),pa={DEFAULT:0,TOOL:-1,WIDGET:-2,INTERNAL:-3},ba=r(459),va="esri-icon-zoom-in-magnifying-glass",ma="esri-icon-trash",ya="esri-icon-table",ga=new Wi.a({id:"zoom-to-feature",title:"{messages.zoom}",className:va}),Oa=new Wi.a({id:"remove-selected-feature",title:"{messages.remove}",className:ma}),ja=new Wi.a({id:"zoom-to-clustered-features",title:"{messages.zoom}",className:va}),_a=new Wi.a({id:"browse-clustered-features",title:"{messages.browseClusteredFeatures}",className:ya}),wa=j.a.getLogger("esri.widgets.Popup.PopupViewModel"),xa=function(e){var t=e.event,r=e.view,n=t.action,i=r&&r.popup;if(!n)return Promise.reject(new U.a("trigger-action:missing-arguments","Event has no action"));if(!i)return Promise.reject(new U.a("trigger-action:missing-arguments","view.popup is missing"));var a=n.disabled,o=n.id;if(!o)return Promise.reject(new U.a("trigger-action:invalid-action","action.id is missing"));if(a)return Promise.reject(new U.a("trigger-action:invalid-action","Action is disabled"));if(o===ga.id)return function(e){return Ta.apply(this,arguments)}(i.viewModel);if(o===ja.id)return function(e){return Ca.apply(this,arguments)}(i.viewModel);if(o===_a.id)return i.featureMenuOpen=!i.featureMenuOpen,i.viewModel.browseClusterEnabled=!i.viewModel.browseClusterEnabled,Promise.resolve();if(i.viewModel.browseClusterEnabled=!1,o===Oa.id){i.close();var s=i.selectedFeature;if(!s)return Promise.reject(new U.a("trigger-action:".concat(Oa.id),"selectedFeature is required",{selectedFeature:s}));var c=s.sourceLayer;return c?c.remove(s):r.graphics.remove(s),Promise.resolve()}return Promise.resolve()};function ka(e){var t=e.selectedFeature,r=e.location,n=e.view;return n?"3d"===n.type?t||r:e.get("selectedFeature.geometry")||r:null}function Sa(e,t){if("3d"!==(null==t?void 0:t.type)||!e||"esri.Graphic"!==e.declaredClass)return!0;var r=t.getViewForGraphic(e);if(r&&"whenGraphicBounds"in r){var n=!1;return r.whenGraphicBounds(e,{useViewElevation:!0}).then((function(e){n=!e||!e.boundingBox||e.boundingBox[0]===e.boundingBox[3]&&e.boundingBox[1]===e.boundingBox[4]&&e.boundingBox[2]===e.boundingBox[5]})).catch((function(){var t=new U.a("zoom-to:invalid-graphic","Could not zoom to the location of the graphic.",{graphic:e});wa.error(t)})),n}return!0}function Ta(){return(Ta=Object(s.a)(o.a.mark((function e(t){var r,n,i,a,s,c,l,u,d;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.location,n=t.selectedFeature,i=t.view,a=t.zoomFactor,s=ka(t)){e.next=4;break}return c=new U.a("zoom-to:invalid-target-or-view","Cannot zoom to location without a target and view.",{target:s,view:i}),e.abrupt("return",(wa.error(c),Promise.reject(c)));case 4:return l=i.scale/a,u=t.get("selectedFeature.geometry")||r,d=u&&"point"===u.type&&Sa(n,i),ga.active=!0,ga.disabled=!0,e.next=9,t.view.goTo({target:s,scale:d?l:void 0});case 9:ga.active=!1,ga.disabled=!1,t.zoomToLocation=null,d&&(t.location=u);case 13:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Ca(){return(Ca=Object(s.a)(o.a.mark((function e(t){var r,n,i,a,s,c,l,u,d;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.selectedFeature,"2d"===(null==(n=t.view)?void 0:n.type)){e.next=4;break}throw i=new U.a("zoomToCluster:invalid-view","View must be 2d MapView.",{view:n}),wa.error(i),i;case 4:if(r.isAggregate){e.next=7;break}throw a=new U.a("zoomToCluster:invalid-selectedFeature","Selected feature must represent an aggregate/cluster graphic.",{selectedFeature:r}),wa.error(a),a;case 7:return s=r.sourceLayer,e.next=10,n.whenLayerView(s);case 10:return c=e.sent,(l=c.createQuery()).aggregateIds=[r.getObjectId()],ja.active=!0,ja.disabled=!0,e.next=15,c.queryExtent(l);case 15:return u=e.sent,d=u.extent,e.next=19,n.goTo({target:d});case 19:ja.active=!1,ja.disabled=!1;case 21:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Ma(e){return Pa.apply(this,arguments)}function Pa(){return(Pa=Object(s.a)(o.a.mark((function e(t){var r,n,i,a,s,c,l,u,d;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.selectedFeature,"2d"===(null==(n=t.view)?void 0:n.type)){e.next=4;break}throw i=new U.a("displayClusterExtent:invalid-view","View must be 2d MapView.",{view:n}),wa.error(i),i;case 4:if(r.isAggregate){e.next=7;break}throw a=new U.a("zoomToCluster:invalid-selectedFeature","Selected feature must represent an aggregate/cluster graphic.",{selectedFeature:r}),wa.error(a),a;case 7:return s=r.sourceLayer,e.next=10,n.whenLayerView(s);case 10:return c=e.sent,(l=c.createQuery()).aggregateIds=[r.getObjectId()],e.next=15,c.queryExtent(l);case 15:u=e.sent,d=u.extent,t.selectedClusterBoundaryFeature.geometry=d,n.graphics.add(t.selectedClusterBoundaryFeature);case 18:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Aa(e){return Ea.apply(this,arguments)}function Ea(){return(Ea=Object(s.a)(o.a.mark((function e(t){var r,n,i,a,s,c,l,u,d;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.selectedFeature,"2d"===(null==(n=t.view)?void 0:n.type)){e.next=4;break}throw i=new U.a("browseAggregateFeatures:invalid-view","View must be 2d MapView.",{view:n}),wa.error(i),i;case 4:if(r.isAggregate){e.next=7;break}throw a=new U.a("browseAggregateFeatures:invalid-selectedFeature","Selected feature must represent an aggregate/cluster graphic.",{selectedFeature:r}),wa.error(a),a;case 7:return s=r.sourceLayer,e.next=10,n.whenLayerView(s);case 10:return c=e.sent,(l=c.createQuery()).aggregateIds=[r.getObjectId()],_a.active=!0,_a.disabled=!0,e.next=15,c.queryFeatures(l);case 15:u=e.sent,d=u.features,_a.active=!1,_a.disabled=!1,n.popup.open({features:[r].concat(d),featureMenuOpen:!0});case 18:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var Ra=function(e){var t=function(e){Object(f.a)(r,e);var t=Object(p.a)(r);function r(){var e;Object(c.a)(this,r);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return(e=t.call.apply(t,[this].concat(i))).goToOverride=null,e.view=null,e}return Object(l.a)(r,[{key:"callGoTo",value:function(e){var t=this.view;return this.goToOverride?this.goToOverride(t,e):t.goTo(e.target,e.options)}}]),r}(e);return Object(b.a)([Object(y.b)()],t.prototype,"goToOverride",void 0),Object(b.a)([Object(y.b)()],t.prototype,"view",void 0),t=Object(b.a)([Object(w.a)("esri.widgets.support.GoTo")],t)},Ia=r(222),Da=V.a.ofType({key:"type",defaultKeyValue:"button",base:Hi.a,typeMap:{button:Wi.a,toggle:Qi.a}}),Fa="esri.widgets.Popup.PopupViewModel",La=j.a.getLogger(Fa),za=function(e){Object(f.a)(r,e);var t=Object(p.a)(r);function r(e){var n;return Object(c.a)(this,r),(n=t.call(this,e))._handles=new oe.a,n._pendingPromises=new Set,n._fetchFeaturesController=null,n._selectedClusterFeature=null,n.featurePage=null,n.actions=new Da,n.defaultPopupTemplateEnabled=!1,n.autoCloseEnabled=!1,n.autoOpenEnabled=!0,n.browseClusterEnabled=!1,n.content=null,n.featuresPerPage=20,n.featureViewModels=[],n.highlightEnabled=!0,n.includeDefaultActions=!0,n.selectedClusterBoundaryFeature=new E.a({symbol:new Ia.a({outline:{width:1.5,color:"cyan"},style:"none"})}),n.title=null,n.updateLocationEnabled=!1,n.view=null,n.visible=!1,n.zoomFactor=4,n.zoomToLocation=null,n}return Object(l.a)(r,[{key:"isLoadingFeature",get:function(){return this.featureViewModels.some((function(e){return e.waitingForContent}))}},{key:"initialize",value:function(){var e=this;this._handles.add([Object(W.a)(this,["autoOpenEnabled","view"],(function(){return e._autoOpenEnabledChange()})),this.on("view-change",(function(){return e._autoClose()})),Object(W.e)(this,["highlightEnabled","selectedFeature","visible","view"],(function(){return e._highlightFeature()})),Object(W.e)(this,"view.animation.state",(function(t){return e._animationStateChange(t)})),Object(W.e)(this,"location",(function(t){return e._locationChange(t)})),Object(W.e)(this,"selectedFeature",(function(t){return e._selectedFeatureChange(t)})),Object(W.e)(this,["selectedFeatureIndex","featureCount","featuresPerPage"],(function(){return e._selectedFeatureIndexChange()})),Object(W.e)(this,["featurePage","selectedFeatureIndex","featureCount","featuresPerPage, featureViewModels"],(function(){return e._setGraphicOnFeatureViewModels()})),Object(W.e)(this,"featureViewModels",(function(){return e._featureViewModelsChange()})),this.on("trigger-action",(function(t){return xa({event:t,view:e.view})})),Object(W.g)(this,"waitingForResult",(function(){return e._waitingForResultChange()}),!0),Object(W.e)(this,["features","view","view.map","view.spatialReference"],(function(){return e._updateFeatureVMs()})),Object(W.e)(this,["view.scale"],this._viewScaleChange),Object(W.g)(this,"visible",(function(){return e.browseClusterEnabled=!1})),Object(W.e)(this,"browseClusterEnabled",(function(t){return t?e.enableClusterBrowsing():e.disableClusterBrowsing()}))])}},{key:"destroy",value:function(){this._cancelFetchingFeatures(),this._handles.destroy(),this._handles=null,this._pendingPromises.clear(),this.browseClusterEnabled=!1,this.view=null}},{key:"active",get:function(){return!(!this.visible||this.waitingForResult)}},{key:"allActions",get:function(){var e=this._get("allActions")||new Da;e.removeAll();var t=this.actions,r=this.defaultActions,n=this.defaultPopupTemplateEnabled,i=this.includeDefaultActions,a=this.selectedFeature,o=i?r.concat(t):t,s=a&&("function"==typeof a.getEffectivePopupTemplate&&a.getEffectivePopupTemplate(n)||a.popupTemplate),c=s&&s.actions,l=s&&s.overwriteActions?c:c?c.concat(o):o;return l&&l.filter(Boolean).forEach((function(t){return e.add(t)})),e}},{key:"defaultActions",get:function(){var e,t=this._get("defaultActions")||new Da;return t.removeAll(),t.addMany(null!=(e=this.selectedFeature)&&e.isAggregate?[ja.clone(),_a.clone()]:[ga.clone()]),t}},{key:"featureCount",get:function(){return this.features.length}},{key:"features",get:function(){return this._get("features")||[]},set:function(e){var t=e||[];this._set("features",t);var r=this.pendingPromisesCount,n=this.promiseCount,i=this.selectedFeatureIndex,a=n&&t.length;a&&r&&-1===i?this.selectedFeatureIndex=0:a&&-1!==i||(this.selectedFeatureIndex=t.length?0:-1)}},{key:"location",get:function(){return this._get("location")||null},set:function(e){var t=this.get("view.spatialReference.isWebMercator");e&&e.get("spatialReference.isWGS84")&&t&&(e=Object(re.b)(e)),this._set("location",e)}},{key:"pendingPromisesCount",get:function(){return this._pendingPromises.size}},{key:"waitingForResult",get:function(){return!(!(this._fetchFeaturesController||this.pendingPromisesCount>0)||0!==this.featureCount)}},{key:"promiseCount",get:function(){return this.promises.length}},{key:"promises",get:function(){return this._get("promises")||[]},set:function(e){var t=this;if(this._pendingPromises.clear(),this.features=[],!Array.isArray(e)||!e.length)return this._set("promises",[]),void this.notifyChange("pendingPromisesCount");this._set("promises",e),(e=e.slice(0)).forEach((function(e){t._pendingPromises.add(e);e.then((function(r){t._pendingPromises.has(e)&&t._updateFeatures(r),t._updatePendingPromises(e)}),(function(){return t._updatePendingPromises(e)}))})),this.notifyChange("pendingPromisesCount")}},{key:"selectedFeature",get:function(){var e=this.features,t=this.selectedFeatureIndex;return-1===t?null:e[t]||null}},{key:"selectedFeatureIndex",get:function(){var e=this._get("selectedFeatureIndex");return"number"==typeof e?e:-1},set:function(e){var t=this.featureCount;e=isNaN(e)||e<-1||!t?-1:(e+t)%t,this._set("selectedFeatureIndex",e)}},{key:"selectedFeatureViewModel",get:function(){return this.featureViewModels[this.selectedFeatureIndex]||null}},{key:"state",get:function(){return this.get("view.ready")?"ready":"disabled"}},{key:"centerAtLocation",value:function(){var e=this.view,t=ka(this);if(!t){var r=new U.a("center-at-location:invalid-target-or-view","Cannot center at a location without a target and view.",{target:t,view:e});return La.error(r),Promise.reject(r)}return this.callGoTo({target:{target:t,scale:e.scale}})}},{key:"clear",value:function(){this.set({promises:[],features:[],content:null,title:null,location:null})}},{key:"fetchFeatures",value:function(e,t){var r=this.view;if(!r||!e){var n=new U.a("fetch-features:invalid-screenpoint-or-view","Cannot fetch features without a screenPoint and view.",{screenPoint:e,view:r});return La.error(n),Promise.reject(n)}return r.fetchPopupFeatures(e,{event:t&&t.event,defaultPopupTemplateEnabled:this.defaultPopupTemplateEnabled,signal:t&&t.signal})}},{key:"open",value:function(e){var t=Object(ie.a)(Object(ie.a)({updateLocationEnabled:!1,promises:[],fetchFeatures:!1},e),{},{visible:!0}),r=t.fetchFeatures;delete t.fetchFeatures,r&&this._setFetchFeaturesPromises(t.location),this.set(t)}},{key:"triggerAction",value:function(e){var t=this.allActions.getItemAt(e);t&&!t.disabled&&this.emit("trigger-action",{action:t})}},{key:"next",value:function(){return this.selectedFeatureIndex=this.selectedFeatureIndex+1,this}},{key:"previous",value:function(){return this.selectedFeatureIndex=this.selectedFeatureIndex-1,this}},{key:"disableClusterBrowsing",value:function(){var e;(e=this).features=e.features.filter((function(e){return e.isAggregate})),this._clearBrowsedClusterGraphics()}},{key:"enableClusterBrowsing",value:function(){var e=Object(s.a)(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ma(this);case 2:return e.next=4,Aa(this);case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"_animationStateChange",value:function(e){this.zoomToLocation||(ga.disabled="waiting-for-target"===e)}},{key:"_clearBrowsedClusterGraphics",value:function(){var e,t=null==(e=this.view)?void 0:e.graphics;t&&(t.remove(this.selectedClusterBoundaryFeature),t.remove(this._selectedClusterFeature)),this._selectedClusterFeature=null,this.selectedClusterBoundaryFeature.geometry=null}},{key:"_viewScaleChange",value:function(){var e;(null!=(e=this.selectedFeature)&&e.isAggregate||this.browseClusterEnabled)&&(this.browseClusterEnabled=!1,this.visible=!1)}},{key:"_locationChange",value:function(e){var t=this.selectedFeature;this.updateLocationEnabled&&e&&(!t||t.geometry)&&this.centerAtLocation()}},{key:"_selectedFeatureIndexChange",value:function(){this.featurePage=this.featureCount>1?Math.floor(this.selectedFeatureIndex/this.featuresPerPage)+1:null}},{key:"_featureViewModelsChange",value:function(){this.featurePage=this.featureCount>1?1:null}},{key:"_setGraphicOnFeatureViewModels",value:function(){var e=this.features,t=this.featureCount,r=this.featurePage,n=this.featuresPerPage,i=this.featureViewModels;if(null!==r){var a=((r-1)*n+t)%t,o=a+n;i.slice(a,o).forEach((function(t,r){t&&!t.graphic&&(t.graphic=e[a+r])}))}}},{key:"_selectedFeatureChange",value:function(){var e=Object(s.a)(o.a.mark((function e(t){var r,n,i,a=this;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return");case 2:if(r=this.location,n=this.updateLocationEnabled,i=this.view,!this.browseClusterEnabled){e.next=11;break}if(this._selectedClusterFeature&&(i.graphics.remove(this._selectedClusterFeature),this._selectedClusterFeature=null),!t.isAggregate){e.next=6;break}return e.abrupt("return");case 6:return e.next=8,Yi(t);case 8:return t.symbol=e.sent,this._selectedClusterFeature=t,e.abrupt("return",void i.graphics.add(this._selectedClusterFeature));case 11:!n&&r||!t.geometry?n&&!t.geometry&&this.centerAtLocation().then((function(){a.location=i.center.clone()})):this.location=Object(I.s)(this._getPointFromGeometry(t.geometry));case 12:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_waitingForResultChange",value:function(){!this.featureCount&&this.promises&&(this.visible=!1)}},{key:"_setFetchFeaturesPromises",value:function(e){var t=this;return this._fetchFeaturesWithController(this._getScreenPoint(e||this.location)).then((function(e){var r=e.clientOnlyGraphics,n=e.promisesPerLayerView,i=Promise.resolve(r),a=n.map((function(e){return e.promise}));t.promises=[i].concat(Object(xe.a)(a))}))}},{key:"_destroyFeatureVMs",value:function(){this.featureViewModels.forEach((function(e){return e&&!e.destroyed&&e.destroy()})),this._set("featureViewModels",[])}},{key:"_updateFeatureVMs",value:function(){var e=this,t=this.selectedFeature,r=this.features,n=this.featureViewModels;if(null!=t&&t.isAggregate||(this.browseClusterEnabled=!1),this._destroyFeatureVMs(),r&&r.length){var i=n.slice(0),a=[];r.forEach((function(r,n){if(r){var o=null;if(i.some((function(e,t){return e&&e.graphic===r&&(o=e,i.splice(t,1)),!!o})),o)a[n]=o;else{var s,c,l=new mi({defaultPopupTemplateEnabled:e.defaultPopupTemplateEnabled,spatialReference:null==(s=e.view)?void 0:s.spatialReference,graphic:r===t?r:null,map:null==(c=e.view)?void 0:c.map,view:e.view});a[n]=l}}})),i.forEach((function(e){return e&&!e.destroyed&&e.destroy()})),this._set("featureViewModels",a)}}},{key:"_getScreenPoint",value:function(e){var t=this.view;return t&&e&&"function"==typeof t.toScreen?t.toScreen(e):null}},{key:"_autoOpenEnabledChange",value:function(){var e=this,t="auto-fetch-features",r=this._handles,n=this.autoOpenEnabled;if(r.remove(t),n&&this.view){var i=this.view.on("click",(function(t){"mouse"===t.pointerType&&0!==t.button||e._fetchFeaturesAndOpen(t)}),pa.WIDGET);r.add(i,t)}}},{key:"_cancelFetchingFeatures",value:function(){var e=this._fetchFeaturesController;e&&e.abort(),this._fetchFeaturesController=null,this.notifyChange("waitingForResult")}},{key:"_fetchFeaturesWithController",value:function(e,t){var r=this;this._cancelFetchingFeatures();var n=Object(q.e)(),i=n.signal;this._fetchFeaturesController=n,this.notifyChange("waitingForResult");var a=this.fetchFeatures(e,{signal:i,event:t});return a.catch((function(){})).then((function(){r._fetchFeaturesController=null,r.notifyChange("waitingForResult")})),a}},{key:"_fetchFeaturesAndOpen",value:function(e){var t=e.screenPoint,r=e.mapPoint,n=this.view;this._fetchFeaturesWithController(t,e).then((function(e){var t=e.clientOnlyGraphics,i=e.promisesPerLayerView,a=e.location,o=[Promise.resolve(t)].concat(Object(xe.a)(i.map((function(e){return e.promise}))));return n.popup.open({location:a||r,promises:o}),e}))}},{key:"_updatePendingPromises",value:function(e){e&&this._pendingPromises.has(e)&&(this._pendingPromises.delete(e),this.notifyChange("pendingPromisesCount"))}},{key:"_autoClose",value:function(){this.autoCloseEnabled&&(this.visible=!1)}},{key:"_getPointFromGeometry",value:function(e){return Object(I.i)(e)?null:"point"===e.type?e:"extent"===e.type?e.center:"polygon"===e.type?e.centroid:"multipoint"===e.type||"polyline"===e.type?e.extent.center:null}},{key:"_getLayerView",value:function(){var e=Object(s.a)(o.a.mark((function e(t,r){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.when();case 2:return e.abrupt("return",t.whenLayerView(r));case 3:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"_highlightFeature",value:function(){var e=Object(s.a)(o.a.mark((function e(){var t,r,n,i,a,s,c,l,u,d,h,f,p;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t="highlight",this._handles.remove(t),r=this.selectedFeature,n=this.highlightEnabled,i=this.view,a=this.visible,r&&i&&n&&a){e.next=5;break}return e.abrupt("return");case 5:if(s=r.layer,"map-notes"!==(null==(c=r.sourceLayer)?void 0:c.type)&&"subtype-group"!==(null==c?void 0:c.type)||(s=c),s&&s instanceof qi.a){e.next=8;break}return e.abrupt("return");case 8:return l=this._getLayerView(i,s),this._highlightPromise=l,e.next=12,l;case 12:if((u=e.sent)&&Object(ba.b)(u)&&this._highlightPromise===l&&this.selectedFeature&&this.highlightEnabled&&this.visible){e.next=15;break}return e.abrupt("return");case 15:d="objectIdField"in s&&s.objectIdField,h=r.attributes,f=h&&d&&h[d],p=u.highlight(f||r),this._handles.add(p,t);case 17:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"_updateFeatures",value:function(e){var t=this.features;if(e&&e.length)if(t.length){var r=e.filter((function(e){return-1===t.indexOf(e)}));this.features=t.concat(r)}else this.features=e}}]),r}(Ra(Fi));Object(b.a)([Object(y.b)()],za.prototype,"featurePage",void 0),Object(b.a)([Object(y.b)()],za.prototype,"isLoadingFeature",null),Object(b.a)([Object(y.b)({type:Da})],za.prototype,"actions",void 0),Object(b.a)([Object(y.b)({readOnly:!0})],za.prototype,"active",null),Object(b.a)([Object(y.b)({readOnly:!0})],za.prototype,"allActions",null),Object(b.a)([Object(y.b)({type:Boolean})],za.prototype,"defaultPopupTemplateEnabled",void 0),Object(b.a)([Object(y.b)()],za.prototype,"autoCloseEnabled",void 0),Object(b.a)([Object(y.b)()],za.prototype,"autoOpenEnabled",void 0),Object(b.a)([Object(y.b)()],za.prototype,"browseClusterEnabled",void 0),Object(b.a)([Object(y.b)()],za.prototype,"content",void 0),Object(b.a)([Object(y.b)({type:Da,readOnly:!0})],za.prototype,"defaultActions",null),Object(b.a)([Object(y.b)({readOnly:!0})],za.prototype,"featureCount",null),Object(b.a)([Object(y.b)()],za.prototype,"features",null),Object(b.a)([Object(y.b)()],za.prototype,"featuresPerPage",void 0),Object(b.a)([Object(y.b)({readOnly:!0})],za.prototype,"featureViewModels",void 0),Object(b.a)([Object(y.b)()],za.prototype,"highlightEnabled",void 0),Object(b.a)([Object(y.b)()],za.prototype,"includeDefaultActions",void 0),Object(b.a)([Object(y.b)({type:S.a})],za.prototype,"location",null),Object(b.a)([Object(y.b)({readOnly:!0})],za.prototype,"pendingPromisesCount",null),Object(b.a)([Object(y.b)({readOnly:!0})],za.prototype,"selectedClusterBoundaryFeature",void 0),Object(b.a)([Object(y.b)({readOnly:!0})],za.prototype,"waitingForResult",null),Object(b.a)([Object(y.b)({readOnly:!0})],za.prototype,"promiseCount",null),Object(b.a)([Object(y.b)()],za.prototype,"promises",null),Object(b.a)([Object(y.b)({value:null,readOnly:!0})],za.prototype,"selectedFeature",null),Object(b.a)([Object(y.b)({value:-1})],za.prototype,"selectedFeatureIndex",null),Object(b.a)([Object(y.b)({readOnly:!0})],za.prototype,"selectedFeatureViewModel",null),Object(b.a)([Object(y.b)({readOnly:!0})],za.prototype,"state",null),Object(b.a)([Object(y.b)()],za.prototype,"title",void 0),Object(b.a)([Object(y.b)()],za.prototype,"updateLocationEnabled",void 0),Object(b.a)([Object(y.b)()],za.prototype,"view",void 0),Object(b.a)([Object(y.b)()],za.prototype,"visible",void 0),Object(b.a)([Object(y.b)()],za.prototype,"zoomFactor",void 0),Object(b.a)([Object(y.b)()],za.prototype,"zoomToLocation",void 0),Object(b.a)([Object(y.b)()],za.prototype,"centerAtLocation",null);var Va=za=Object(b.a)([Object(w.a)(Fa)],za),Na=r(173),Ua=r(497),Ba="selected-index",Ga="popup-spinner",qa="esri-icon-left-triangle-arrow",Ha="esri-icon-right-triangle-arrow",Wa="esri-icon-maximize",Qa="esri-icon-dock-bottom",Za="esri-icon-dock-left",Xa="esri-icon-dock-right",Ya="esri-icon-close",$a="esri-icon-minimize",Ja="esri-icon-check-mark",Ka="esri-icon-loading-indicator",eo="esri-icon-default-action",to="esri-icon-handle-horizontal",ro="esri-rotating",no="esri-popup",io="esri-widget",ao="esri-popup__main-container",oo="esri-popup__loading-container",so="esri-popup--is-collapsible",co="esri-popup--is-collapsed",lo="esri-popup--shadow",uo="esri-popup--is-docked",ho="esri-popup--is-docked-top-left",fo="esri-popup--is-docked-top-center",po="esri-popup--is-docked-top-right",bo="esri-popup--is-docked-bottom-left",vo="esri-popup--is-docked-bottom-center",mo="esri-popup--is-docked-bottom-right",yo="esri-popup--aligned-top-center",go="esri-popup--aligned-bottom-center",Oo="esri-popup--aligned-top-left",jo="esri-popup--aligned-bottom-left",_o="esri-popup--aligned-top-right",wo="esri-popup--aligned-bottom-right",xo="esri-popup--feature-menu-open",ko="esri-popup--actions-menu-open",So="esri-popup--feature-updated",To="esri-popup__header",Co="esri-popup__header-buttons",Mo="esri-popup__header-container",Po="esri-popup__header-container--button",Ao="esri-popup__header-title",Eo="esri-popup__content",Ro="esri-popup__footer",Io="esri-popup__footer--has-pagination",Do="esri-popup__footer--has-actions",Fo="esri-popup__footer--has-actions-menu",Lo="esri-popup__button",zo="esri-popup__button--disabled",Vo="esri-popup__button--dock",No="esri-popup__icon",Uo="esri-popup__icon--dock-icon",Bo="esri-popup__inline-actions-container",Go="esri-popup__actions-menu-button",qo="esri-popup__actions",Ho="esri-popup__action",Wo="esri-popup__action-image",Qo="esri-popup__action-text",Zo="esri-popup__action-toggle",Xo="esri-popup__action-toggle--on",Yo="esri-popup__pointer",$o="esri-popup__pointer-direction",Jo="esri-popup__navigation",Ko="esri-popup__pagination-previous",es="esri-popup__pagination-next",ts="esri-popup__pagination-previous-icon",rs="esri-popup__pagination-previous-icon--rtl",ns="esri-popup__pagination-next-icon",is="esri-popup__pagination-next-icon--rtl",as="esri-popup__feature-menu",os="esri-popup__feature-menu-list",ss="esri-popup__feature-menu-item",cs="esri-popup__feature-menu-viewport",ls="esri-popup__feature-menu-header",us="esri-popup__feature-menu-item--selected",ds="esri-popup__feature-menu-button",hs="esri-popup__feature-menu-title",fs="esri-popup__feature-menu-observer",ps="esri-popup__feature-menu-loader",bs={buttonEnabled:!0,position:"auto",breakpoint:{width:544}},vs="esri-popup";function ms(e,t){return void 0===t?"".concat(vs,"__").concat(e):"".concat(vs,"__").concat(e,"-").concat(t)}var ys="esri.widgets.Popup",gs=j.a.getLogger(ys),Os={closeButton:!0,featureNavigation:!0},js=function(e){Object(f.a)(r,e);var t=Object(p.a)(r);function r(e,n){var i;return Object(c.a)(this,r),(i=t.call(this,e,n))._blurClose=!1,i._blurContainer=!1,i._containerNode=null,i._mainContainerNode=null,i._featureMenuNode=null,i._actionsMenuNode=null,i._focusClose=!1,i._focusContainer=!1,i._focusDockButton=!1,i._focusFeatureMenuButton=!1,i._focusActionsMenuButton=!1,i._focusFirstFeature=!1,i._focusFirstAction=!1,i._handles=new oe.a,i._pointerOffsetInPx=16,i._spinner=null,i._feature=null,i._featureMenuIntersectionObserverCallback=function(e){var t=Object(ue.a)(e,1)[0];null!=t&&t.isIntersecting&&i.viewModel.featurePage++},i._featureMenuIntersectionObserver=new IntersectionObserver(i._featureMenuIntersectionObserverCallback),i._displaySpinnerThrottled=me((function(){return i._displaySpinner()}),0),i.actions=null,i.alignment="auto",i.autoCloseEnabled=null,i.autoOpenEnabled=null,i.defaultPopupTemplateEnabled=null,i.content=null,i.collapsed=!1,i.collapseEnabled=!0,i.dockEnabled=!1,i.featureCount=null,i.featureMenuOpen=!1,i.features=null,i.goToOverride=null,i.headingLevel=2,i.highlightEnabled=null,i.location=null,i.label=void 0,i.maxInlineActions=3,i.messages=null,i.messagesCommon=null,i.promises=null,i.selectedFeature=null,i.selectedFeatureIndex=null,i.spinnerEnabled=!0,i.title=null,i.updateLocationEnabled=null,i.view=null,i.viewModel=new Va,i.visible=null,i.visibleElements=Object(ie.a)({},Os),i._addSelectedFeatureIndexHandle(),i.own([Object(W.e)(Object(u.a)(i),"viewModel.screenLocation",(function(){return i._positionContainer()})),Object(W.e)(Object(u.a)(i),["viewModel.active","dockEnabled"],(function(){return i._toggleScreenLocationEnabled()})),Object(W.e)(Object(u.a)(i),"viewModel.screenLocation",(function(e,t){!!e!=!!t&&i.reposition()})),Object(W.e)(Object(u.a)(i),["viewModel.view.padding","viewModel.view.size","viewModel.active","viewModel.location","alignment"],(function(){return i.reposition()})),Object(W.e)(Object(u.a)(i),"spinnerEnabled",(function(e){return i._spinnerEnabledChange(e)})),Object(W.e)(Object(u.a)(i),"viewModel.view.size",(function(e,t){return i._updateDockEnabledForViewSize(e,t)})),Object(W.e)(Object(u.a)(i),"viewModel.view",(function(e,t){return i._viewChange(e,t)})),Object(W.e)(Object(u.a)(i),"viewModel.view.ready",(function(e,t){return i._viewReadyChange(e,t)})),Object(W.e)(Object(u.a)(i),["viewModel.waitingForResult","viewModel.location"],(function(){i._hideSpinner(),i._displaySpinnerThrottled()})),Object(W.e)(Object(u.a)(i),"selectedFeatureWidget.viewModel.title",(function(e){return i._setTitleFromFeatureWidget(e)})),Object(W.e)(Object(u.a)(i),["selectedFeatureWidget.viewModel.content","selectedFeatureWidget.viewModel.waitingForContent"],(function(){return i._setContentFromFeatureWidget()})),Object(W.g)(Object(u.a)(i),"collapsed",(function(){var e,t;"xsmall"===(null==(e=i.viewModel)||null==(t=e.view)?void 0:t.widthBreakpoint)&&i.viewModel.active&&i.collapseEnabled&&i.viewModel.centerAtLocation()})),Object(W.b)(Object(u.a)(i),"viewModel.allActions","change",(function(){return i._watchActions()})),Object(W.a)(Object(u.a)(i),"viewModel.allActions",(function(){return i._watchActions()})),Object(W.e)(Object(u.a)(i),"viewModel.featureViewModels",(function(){return i._featureMenuViewportScrollTop()}))]),i}return Object(l.a)(r,[{key:"destroy",value:function(){var e,t;this._destroySelectedFeatureWidget(),this._destroySpinner(),null==(e=this._handles)||e.destroy(),this._unobserveFeatureMenuObserver(),null==(t=this._featureMenuIntersectionObserver)||t.disconnect(),this._handles=null}},{key:"actionsMenuId",get:function(){return"".concat(this.id,"-actions-menu")}},{key:"actionsMenuButtonId",get:function(){return"".concat(this.id,"-actions-menu-button")}},{key:"featureMenuId",get:function(){return"".concat(this.id,"-feature-menu")}},{key:"titleId",get:function(){return"".concat(this.id,"-popup-title")}},{key:"contentId",get:function(){return"".concat(this.id,"-popup-content")}},{key:"hasContent",get:function(){var e,t,r,n,i;return!!(this.selectedFeatureWidget?(null==(e=this.selectedFeatureWidget)||null==(t=e.viewModel)?void 0:t.waitingForContent)||(null==(r=this.selectedFeatureWidget)||null==(n=r.viewModel)?void 0:n.content):null==(i=this.viewModel)?void 0:i.content)}},{key:"featureNavigationVisible",get:function(){return this.viewModel.active&&this.viewModel.featureCount>1&&this.visibleElements.featureNavigation}},{key:"collapsible",get:function(){return!!(this.collapseEnabled&&this.viewModel.title&&this.hasContent)}},{key:"featureMenuVisible",get:function(){return this.featureNavigationVisible&&this.featureMenuOpen}},{key:"contentCollapsed",get:function(){return this.collapsible&&!this.featureMenuVisible&&this.collapsed}},{key:"dividedActions",get:function(){return this._divideActions()}},{key:"actionsMenuOpen",get:function(){return!!this.viewModel.active&&this._get("actionsMenuOpen")},set:function(e){this._set("actionsMenuOpen",!!e)}},{key:"currentAlignment",get:function(){return this._getCurrentAlignment()}},{key:"currentDockPosition",get:function(){return this._getCurrentDockPosition()}},{key:"dockOptions",get:function(){return this._get("dockOptions")||bs},set:function(e){var t=Object(ie.a)({},bs),r=this.get("viewModel.view.breakpoints"),n={};r&&(n.width=r.xsmall,n.height=r.xsmall);var i=Object(ie.a)(Object(ie.a)({},t),e),a=Object(ie.a)(Object(ie.a)({},t.breakpoint),n),o=i.breakpoint;!0===o?i.breakpoint=a:"object"==typeof o&&(i.breakpoint=Object(ie.a)(Object(ie.a)({},a),o)),this._set("dockOptions",i),this._setCurrentDockPosition(),this.reposition()}},{key:"selectedFeatureWidget",get:function(){var e=this._feature,t=this.visibleElements,r=this.headingLevel,n=this.viewModel.selectedFeatureViewModel,i=Object(ie.a)(Object(ie.a)({},t),{},{title:!1});return n?(e?(e.viewModel=n,e.visibleElements=i):this._feature=new Ri({headingLevel:r+1,viewModel:n,visibleElements:i}),this._feature):null}},{key:"castVisibleElements",value:function(e){return Object(ie.a)(Object(ie.a)({},Os),e)}},{key:"blur",value:function(){this.viewModel.active||gs.warn("Popup can only be blurred when currently active."),this.visibleElements.closeButton?this._blurClose=!0:this._blurContainer=!0,this.scheduleRender()}},{key:"clear",value:function(){this.viewModel.clear()}},{key:"close",value:function(){this.visible=!1}},{key:"fetchFeatures",value:function(e,t){return this.viewModel.fetchFeatures(e,t)}},{key:"focus",value:function(){this.viewModel.active||gs.warn("Popup can only be focused when currently active."),this.visibleElements.closeButton?this._focusClose=!0:this._focusContainer=!0,this.scheduleRender()}},{key:"next",value:function(){return this.viewModel.next()}},{key:"open",value:function(e){var t,r;this._handles.remove(Ba);var n=!!e&&!!e.featureMenuOpen,i=!!e&&!!e.actionsMenuOpen,a={collapsed:!!e&&!!e.collapsed,actionsMenuOpen:i,featureMenuOpen:n};"xsmall"===(null==(t=this.viewModel)||null==(r=t.view)?void 0:r.widthBreakpoint)&&(a.collapsed=!0),this.set(a),this.viewModel.open(e),this._addSelectedFeatureIndexHandle()}},{key:"previous",value:function(){return this.viewModel.previous()}},{key:"reposition",value:function(){this.renderNow(),this._positionContainer(),this._setCurrentAlignment()}},{key:"triggerAction",value:function(e){this.viewModel.triggerAction(e)}},{key:"render",value:function(){var e,t,r,n,i,a=this.actionsMenuOpen,o=this.dockEnabled,s=this.featureMenuVisible,c=this.dividedActions,l=this.currentAlignment,u=this.currentDockPosition,d=this.viewModel.active,h=c.menuActions,f=d&&h.length>1&&a,p=d&&o,b=d&&!o,v=null==(t=this.selectedFeature)||null==(r=t.layer)?void 0:r.title,m=null==(n=this.selectedFeature)||null==(i=n.layer)?void 0:i.id,y=(e={},Object(ve.a)(e,yo,"top-center"===l),Object(ve.a)(e,go,"bottom-center"===l),Object(ve.a)(e,Oo,"top-left"===l),Object(ve.a)(e,jo,"bottom-left"===l),Object(ve.a)(e,_o,"top-right"===l),Object(ve.a)(e,wo,"bottom-right"===l),Object(ve.a)(e,uo,p),Object(ve.a)(e,lo,b),Object(ve.a)(e,ho,"top-left"===u),Object(ve.a)(e,fo,"top-center"===u),Object(ve.a)(e,po,"top-right"===u),Object(ve.a)(e,bo,"bottom-left"===u),Object(ve.a)(e,vo,"bottom-center"===u),Object(ve.a)(e,mo,"bottom-right"===u),Object(ve.a)(e,xo,s),Object(ve.a)(e,ko,f),e);return Object(kt.a)("div",{class:this.classes(no,y),role:"presentation","data-layer-title":v,"data-layer-id":m,bind:this,afterCreate:this._positionContainer,afterUpdate:this._positionContainer},d?[this.renderMainContainer(),this.renderPointer()]:null)}},{key:"renderLoadingIcon",value:function(){return Object(kt.a)("span",{"aria-hidden":"true",class:this.classes(No,Ka,ro)})}},{key:"renderNavigationLoading",value:function(){var e=this.messagesCommon;return this.viewModel.pendingPromisesCount?Object(kt.a)("div",{key:ms("loading-container"),role:"presentation",class:oo,"aria-label":e.loading,title:e.loading},this.renderLoadingIcon()):null}},{key:"renderPreviousIcon",value:function(){var e,t=Object(wt.h)(),r=(e={},Object(ve.a)(e,Ha,t),Object(ve.a)(e,rs,t),Object(ve.a)(e,qa,!t),Object(ve.a)(e,ts,!t),e);return Object(kt.a)("span",{"aria-hidden":"true",class:this.classes(No,r)})}},{key:"renderPreviousButton",value:function(){var e=this.messages;return Object(kt.a)("div",{role:"button",tabIndex:0,bind:this,onclick:this._previous,onkeydown:this._previous,class:this.classes(Lo,Ko),"aria-label":e.previous,title:e.previous},this.renderPreviousIcon())}},{key:"renderNextIcon",value:function(){var e,t=Object(wt.h)(),r=(e={},Object(ve.a)(e,qa,t),Object(ve.a)(e,is,t),Object(ve.a)(e,Ha,!t),Object(ve.a)(e,ns,!t),e);return Object(kt.a)("span",{"aria-hidden":"true",class:this.classes(No,r)})}},{key:"renderNextButton",value:function(){var e=this.messages;return Object(kt.a)("div",{role:"button",tabIndex:0,bind:this,onclick:this._next,onkeydown:this._next,class:this.classes(Lo,es),"aria-label":e.next,title:e.next},this.renderNextIcon())}},{key:"renderFeatureMenuButton",value:function(){var e=this.featureMenuOpen,t=this.featureMenuId,r=this.messagesCommon,n=this.viewModel,i=n.featureCount,a=n.selectedFeatureIndex;return Object(kt.a)("div",{role:"button",tabIndex:0,bind:this,onclick:this._toggleFeatureMenu,onkeydown:this._toggleFeatureMenu,afterCreate:this._focusFeatureMenuButtonNode,afterUpdate:this._focusFeatureMenuButtonNode,class:this.classes(Lo,ds),"aria-haspopup":"true","aria-controls":t,"aria-expanded":e.toString(),"aria-label":r.menu,title:r.menu},this._getPageText(i,a))}},{key:"renderNavigationButtons",value:function(){return this.featureNavigationVisible?[this.renderPreviousButton(),this.renderNavigationLoading()||this.renderFeatureMenuButton(),this.renderNextButton()]:null}},{key:"renderDockIcon",value:function(){var e,t=this.dockEnabled,r=this._wouldDockTo(),n=(e={},Object(ve.a)(e,$a,t),Object(ve.a)(e,Uo,!t),Object(ve.a)(e,Xa,!t&&("top-right"===r||"bottom-right"===r)),Object(ve.a)(e,Za,!t&&("top-left"===r||"bottom-left"===r)),Object(ve.a)(e,Wa,!t&&"top-center"===r),Object(ve.a)(e,Qa,!t&&"bottom-center"===r),e);return Object(kt.a)("span",{"aria-hidden":"true",class:this.classes(n,No)})}},{key:"renderDockButton",value:function(){var e,t,r,n=this.dockEnabled,i=this.messages,a=null==(e=this.viewModel)||null==(t=e.view)?void 0:t.widthBreakpoint,o=n?i.undock:i.dock;return"xsmall"!==a&&null!=(r=this.dockOptions)&&r.buttonEnabled?Object(kt.a)("div",{role:"button","aria-label":o,title:o,tabIndex:0,bind:this,onclick:this._toggleDockEnabled,onkeydown:this._toggleDockEnabled,afterCreate:this._focusDockButtonNode,afterUpdate:this._focusDockButtonNode,class:this.classes(Lo,Vo)},this.renderDockIcon()):null}},{key:"renderTitle",value:function(){var e=this.viewModel.title,t=this.titleId,r=this.collapsible,n=this.contentCollapsed,i=this.messagesCommon,a=Object(ve.a)({},Po,r),o=Object(kt.a)(wr,{level:this.headingLevel,class:Ao,innerHTML:e}),s=r?Object(kt.a)("button",{key:"".concat(e,"--collapsible"),id:t,title:n?i.expand:i.collapse,bind:this,enterAnimation:this._createFeatureUpdatedAnimation(),class:this.classes(Mo,a),"aria-expanded":n?"false":"true",onclick:this._toggleCollapsed},o):Object(kt.a)("div",{key:e,id:t,bind:this,enterAnimation:this._createFeatureUpdatedAnimation(),class:this.classes(Mo,a)},o);return e?s:null}},{key:"renderCloseIcon",value:function(){return Object(kt.a)("span",{"aria-hidden":"true",class:this.classes(No,Ya)})}},{key:"renderCloseButton",value:function(){var e=this.visibleElements,t=this.messagesCommon;return e.closeButton?Object(kt.a)("div",{role:"button",tabIndex:0,bind:this,onclick:this._close,onkeydown:this._close,class:Lo,"aria-label":t.close,title:t.close,afterCreate:this._closeButtonNodeUpdated,afterUpdate:this._closeButtonNodeUpdated},this.renderCloseIcon()):null}},{key:"renderHeader",value:function(){return Object(kt.a)("header",{class:To},this.renderTitle(),Object(kt.a)("div",{class:Co},this.renderDockButton(),this.renderCloseButton()))}},{key:"renderContentContainer",value:function(){var e=this.contentId,t=this.hasContent,r=this.contentCollapsed,n=this.viewModel.content;return t&&!r?Object(kt.a)("article",{key:n,enterAnimation:this._createFeatureUpdatedAnimation(),id:e,class:Eo},this.renderContent()):null}},{key:"renderActionsMenuButton",value:function(){var e=this.actionsMenuId,t=this.actionsMenuButtonId,r=this.actionsMenuOpen,n=this.dividedActions,i=this.messagesCommon,a=r?i.close:i.open;return n.menuActions.length?Object(kt.a)("div",{key:ms("actions-menu-button"),class:this.classes(Lo,Go),role:"button",id:t,"aria-haspopup":"true","aria-controls":r?e:null,tabIndex:0,bind:this,onclick:this._toggleActionsMenu,onkeydown:this._toggleActionsMenu,afterCreate:this._focusActionsMenuButtonNode,afterUpdate:this._focusActionsMenuButtonNode,"aria-label":a,title:a},Object(kt.a)("span",{"aria-hidden":"true",class:to})):null}},{key:"renderMenuActions",value:function(){var e=this,t=this.actionsMenuId,r=this.actionsMenuButtonId,n=this.actionsMenuOpen,i=this.dividedActions,a=i.menuActions,o=i.inlineActions;return a.length&&n?Object(kt.a)("ul",{id:t,role:"menu","aria-labelledby":r,key:ms("actions"),class:qo,bind:this,onkeyup:this._handleActionMenuKeyup,afterCreate:this._actionsMenuNodeUpdated,afterUpdate:this._actionsMenuNodeUpdated},a.toArray().map((function(t,r){return e.renderAction({action:t,index:r+o.length,type:"menu-item"})}))):null}},{key:"renderInlineActions",value:function(){var e=this,t=this.dividedActions.inlineActions;return!!t.length&&t.toArray().map((function(t,r){return e.renderAction({action:t,index:r,type:"inline"})}))}},{key:"renderInlineActionsContainer",value:function(){var e=this.dividedActions,t=e.inlineActions,r=e.menuActions,n=!!t.length,i=!!r.length;return n||i?Object(kt.a)("div",{key:"inline-actions-container","data-inline-actions":n.toString(),"data-menu-actions":i.toString(),class:Bo},this.renderInlineActions(),this.renderActionsMenuButton(),this.renderMenuActions()):null}},{key:"renderNavigation",value:function(){return this.featureNavigationVisible?Object(kt.a)("section",{key:ms("navigation"),class:this.classes(Jo)},this.renderNavigationButtons()):null}},{key:"renderFooter",value:function(){var e,t=this.featureNavigationVisible,r=this.dividedActions,n=r.inlineActions,i=r.menuActions,a=!!n.length,o=!!i.length,s=(e={},Object(ve.a)(e,Io,t),Object(ve.a)(e,Do,a),Object(ve.a)(e,Fo,o),e);return t||a?Object(kt.a)("div",{key:ms("feature-buttons"),class:this.classes(Ro,s)},this.renderInlineActionsContainer(),this.renderNavigation()):null}},{key:"renderFeatureMenuContainer",value:function(){var e=this.messages,t=this.viewModel,r=t.featureViewModels,n=t.isLoadingFeature,i=Object(gi.a)(e.selectedFeatures,{total:r.length});return Object(kt.a)("section",{key:ms("menu"),class:as},Object(kt.a)("strong",{class:ls},i),Object(kt.a)("nav",{bind:this,class:cs,"data-node-ref":"_featureMenuViewportNode",afterCreate:wt.j},this.renderFeatureMenu(),Object(kt.a)("div",{class:fs,bind:this,afterCreate:this._featureMenuIntersectionObserverCreated}),n?Object(kt.a)("div",{class:ps},this.renderLoadingIcon()):null))}},{key:"renderPointer",value:function(){return this.dockEnabled?null:Object(kt.a)("div",{key:ms("pointer"),class:Yo,role:"presentation"},Object(kt.a)("div",{class:this.classes($o,lo)}))}},{key:"renderMainContainer",value:function(){var e,t=this.dockEnabled,r=this.currentAlignment,n=this.currentDockPosition,i=this.titleId,a=this.contentId,o=this.collapsible,s=this.hasContent,c=this.contentCollapsed,l=this.visibleElements,u=this.viewModel.title,d="bottom-left"===r||"bottom-center"===r||"bottom-right"===r||"top-left"===n||"top-center"===n||"top-right"===n,h="top-left"===r||"top-center"===r||"top-right"===r||"bottom-left"===n||"bottom-center"===n||"bottom-right"===n,f=(e={},Object(ve.a)(e,lo,t),Object(ve.a)(e,so,o),Object(ve.a)(e,co,c),e);return Object(kt.a)("div",{class:this.classes(ao,io,f),tabIndex:l.closeButton?null:-1,role:"dialog","aria-labelledby":u?i:"","aria-describedby":s&&!c?a:"",bind:this,onkeyup:this._handleMainKeyup,afterCreate:this._mainContainerNodeUpdated,afterUpdate:this._mainContainerNodeUpdated},d?this.renderFooter():null,d?this.renderFeatureMenuContainer():null,this.renderHeader(),this.renderContentContainer(),h?this.renderFooter():null,h?this.renderFeatureMenuContainer():null)}},{key:"renderContent",value:function(){var e,t=null==(e=this.viewModel)?void 0:e.content;return t?"string"==typeof t?Object(kt.a)("div",{key:t,innerHTML:t}):this.renderNodeContent(t):null}},{key:"renderActionText",value:function(e){return Object(kt.a)("span",{key:"text",class:Qo},e)}},{key:"renderActionIcon",value:function(e){var t,r=this._getActionClass(e),n=this._getActionImage(e),i=(t={},Object(ve.a)(t,Ka,e.active),Object(ve.a)(t,ro,e.active),Object(ve.a)(t,No,!!r),Object(ve.a)(t,Wo,!e.active&&!!n),t);return r&&(i[r]=!e.active),Object(kt.a)("span",{key:"icon","aria-hidden":"true",class:this.classes(No,i),styles:this._getIconStyles(n)})}},{key:"renderAction",value:function(e){var t,r=e.action,n=e.index,i=e.type,a=this._getActionTitle(r),o=(t={},Object(ve.a)(t,Ho,"toggle"!==r.type),Object(ve.a)(t,Zo,"toggle"===r.type),Object(ve.a)(t,Xo,"toggle"===r.type&&r.value),Object(ve.a)(t,zo,r.disabled),t),s=[this.renderActionIcon(r),this.renderActionText(a)],c="menu-item"===i?Object(kt.a)("li",{key:r.uid,role:"menuitem",tabIndex:0,title:a,"aria-label":a,class:this.classes(Lo,o),onkeyup:this._handleActionMenuItemKeyup,bind:this,"data-action-index":n,onclick:this._triggerAction,onkeydown:this._triggerAction},s):Object(kt.a)("div",{key:r.uid,role:"button",tabIndex:0,title:a,"aria-label":a,class:this.classes(Lo,o),onkeyup:this._handleActionMenuItemKeyup,bind:this,"data-action-index":n,onclick:this._triggerAction,onkeydown:this._triggerAction},s);return r.visible?c:null}},{key:"renderFeatureMenuItem",value:function(e,t){var r=this.messages,n=this.messagesCommon,i=this.viewModel,a=i.selectedFeatureIndex,o=e===i.selectedFeatureViewModel,s=Object(ve.a)({},us,o),c=o?Object(kt.a)("span",{key:ms("feature-menu-selected-feature-".concat(a)),title:r.selectedFeature,"aria-label":r.selectedFeature,class:Ja}):null,l=Object(kt.a)("span",{innerHTML:e.title||n.untitled});return Object(kt.a)("li",{role:"menuitem",tabIndex:-1,key:ms("feature-menu-feature-".concat(a)),class:this.classes(s,ss),bind:this,"data-feature-index":t,onkeyup:this._handleFeatureMenuItemKeyup,onclick:this._selectFeature,onkeydown:this._selectFeature},Object(kt.a)("span",{class:hs},l,c))}},{key:"renderFeatureMenu",value:function(){var e=this,t=this.featureMenuId,r=this.viewModel.featureViewModels;return r.length>1?Object(kt.a)("ol",{class:os,id:t,bind:this,afterCreate:this._featureMenuNodeUpdated,afterUpdate:this._featureMenuNodeUpdated,onkeyup:this._handleFeatureMenuKeyup,role:"menu"},r.filter((function(e){return!!e.graphic})).map((function(t,r){return e.renderFeatureMenuItem(t,r)}))):null}},{key:"_getActionTitle",value:function(e){var t=this.messages,r=this.selectedFeature,n=this.messagesCommon,i=e.id,a=null==r?void 0:r.attributes,o="zoom-to-feature"===i?Object(gi.a)(e.title,{messages:t}):"remove-selected-feature"===i?Object(gi.a)(e.title,{messages:n}):"zoom-to-clustered-features"===i||"browse-clustered-features"===i?Object(gi.a)(e.title,{messages:t}):e.title;return o&&a?Object(gi.a)(o,a):o}},{key:"_getActionClass",value:function(e){var t=this.selectedFeature,r=null==t?void 0:t.attributes,n=e.className,i=e.image||n?n:eo;return i&&r?Object(gi.a)(i,r):i}},{key:"_getActionImage",value:function(e){var t=this.selectedFeature,r=null==t?void 0:t.attributes,n=e.image;return n&&r?Object(gi.a)(n,r):n}},{key:"_createFeatureUpdatedAnimation",value:function(){return Object(wt.b)("enter",So)}},{key:"_getInlineActionCount",value:function(){var e=this.maxInlineActions,t=this.featureNavigationVisible;if("number"!=typeof e)return null;var r=Math.round(e);return Math.max(t?r-1:r,0)}},{key:"_watchActions",value:function(){var e=this,t=this.viewModel.allActions;this.notifyChange("dividedActions");var r="actions";this._handles.remove(r),t&&t.forEach((function(t){e._handles.add(Object(W.e)(t,["active","className","disabled","id","title","image","visible"],(function(){return e.scheduleRender()})),r)}))}},{key:"_divideActions",value:function(){var e=this.viewModel.allActions,t=this._getInlineActionCount(),r=null===t,n=0===t;return{inlineActions:r?e.slice(0):n?new V.a:e.slice(0,t),menuActions:r?new V.a:n?e.slice(0):e.slice(t)}}},{key:"_featureMenuOpenChanged",value:function(e){e?this._focusFirstFeature=!0:this._focusFeatureMenuButton=!0}},{key:"_actionsMenuOpenChanged",value:function(e){e?this._focusFirstAction=!0:this._focusActionsMenuButton=!0}},{key:"_setTitleFromFeatureWidget",value:function(e){this.selectedFeatureWidget&&(this.viewModel.title=e||"")}},{key:"_setContentFromFeatureWidget",value:function(){var e=this.selectedFeatureWidget;e&&(this.viewModel.content=e)}},{key:"_unobserveFeatureMenuObserver",value:function(){this._featureMenuIntersectionObserverNode&&this._featureMenuIntersectionObserver.unobserve(this._featureMenuIntersectionObserverNode)}},{key:"_featureMenuIntersectionObserverCreated",value:function(e){this._unobserveFeatureMenuObserver(),this._featureMenuIntersectionObserver.observe(e),this._featureMenuIntersectionObserverNode=e}},{key:"_handleFeatureMenuKeyup",value:function(e){"Escape"===Object(B.a)(e)&&(e.stopPropagation(),this._focusFeatureMenuButton=!0,this.featureMenuOpen=!1,this.scheduleRender())}},{key:"_handleActionMenuKeyup",value:function(e){"Escape"===Object(B.a)(e)&&(e.stopPropagation(),this._focusActionsMenuButton=!0,this.actionsMenuOpen=!1,this.scheduleRender())}},{key:"_handleFeatureMenuItemKeyup",value:function(e){var t=Object(B.a)(e),r=this._featureMenuNode,n=e.currentTarget["data-feature-index"];if(r){var i=r.querySelectorAll("li"),a=i.length;"ArrowUp"!==t?"ArrowDown"!==t?"Home"!==t?"End"!==t||(e.stopPropagation(),i[i.length-1].focus()):(e.stopPropagation(),i[0].focus()):(e.stopPropagation(),i[(n+1+a)%a].focus()):(e.stopPropagation(),i[(n-1+a)%a].focus())}}},{key:"_handleActionMenuItemKeyup",value:function(e){var t=Object(B.a)(e),r=this._actionsMenuNode,n=e.currentTarget["data-action-index"];if(r){var i=r.querySelectorAll("li"),a=i.length;"ArrowUp"!==t?"ArrowDown"!==t?"Home"!==t?"End"!==t||(e.stopPropagation(),i[i.length-1].focus()):(e.stopPropagation(),i[0].focus()):(e.stopPropagation(),i[(n+1+a)%a].focus()):(e.stopPropagation(),i[(n-1+a)%a].focus())}}},{key:"_handleMainKeyup",value:function(e){var t=Object(B.a)(e);"ArrowLeft"===t&&(e.stopPropagation(),this.previous()),"ArrowRight"===t&&(e.stopPropagation(),this.next())}},{key:"_spinnerEnabledChange",value:function(e){if(this._destroySpinner(),e){var t=this.get("viewModel.view");this._createSpinner(t)}}},{key:"_hideSpinner",value:function(){var e=this._spinner;e&&(e.location=null,e.hide())}},{key:"_displaySpinner",value:function(){var e=this._spinner;if(e){var t=this.viewModel,r=t.location;t.waitingForResult?e.show({location:r}):e.hide()}}},{key:"_getIconStyles",value:function(e){return{"background-image":e?"url(".concat(e,")"):""}}},{key:"_addSelectedFeatureIndexHandle",value:function(){var e=this,t=Object(W.e)(this,"viewModel.selectedFeatureIndex",(function(t,r){return e._selectedFeatureIndexUpdated(t,r)}));this._handles.add(t,Ba)}},{key:"_selectedFeatureIndexUpdated",value:function(e,t){this.featureCount&&e!==t&&-1!==e&&(this.actionsMenuOpen=!1,this.featureMenuOpen=!1)}},{key:"_destroySelectedFeatureWidget",value:function(){var e=this._feature;e&&(e.viewModel=null,e&&!e.destroyed&&e.destroy()),this._feature=null}},{key:"_isScreenLocationWithinView",value:function(e,t){return e.x>-1&&e.y>-1&&e.x<=t.width&&e.y<=t.height}},{key:"_isOutsideView",value:function(e){var t=e.popupHeight,r=e.popupWidth,n=e.screenLocation,i=e.side,a=e.view;if(isNaN(r)||isNaN(t)||!a||!n)return!1;var o=a.padding;return"right"===i&&n.x+r/2>a.width-o.right||"left"===i&&n.x-r/2<o.left||"top"===i&&n.y-t<o.top||"bottom"===i&&n.y+t>a.height-o.bottom}},{key:"_calculateAutoAlignment",value:function(e){if("auto"!==e)return e;var t=this._pointerOffsetInPx,r=this._containerNode,n=this._mainContainerNode,i=this.viewModel,a=i.screenLocation,o=i.view;if(Object(I.i)(a)||!o||!r)return"top-center";if(!this._isScreenLocationWithinView(a,o))return this._get("currentAlignment")||"top-center";function s(e){return parseInt(e.replace(/[^-\d\.]/g,""),10)}var c=n?window.getComputedStyle(n,null):null,l=c?s(c.getPropertyValue("max-height")):0,u=c?s(c.getPropertyValue("height")):0,d=r.getBoundingClientRect(),h=d.height,f=d.width+t,p=Math.max(h,l,u)+t,b=this._isOutsideView({popupHeight:p,popupWidth:f,screenLocation:a,side:"right",view:o}),v=this._isOutsideView({popupHeight:p,popupWidth:f,screenLocation:a,side:"left",view:o}),m=this._isOutsideView({popupHeight:p,popupWidth:f,screenLocation:a,side:"top",view:o}),y=this._isOutsideView({popupHeight:p,popupWidth:f,screenLocation:a,side:"bottom",view:o});return v?m?"bottom-right":"top-right":b?m?"bottom-left":"top-left":m?y?"top-center":"bottom-center":"top-center"}},{key:"_callCurrentAlignment",value:function(e){return"function"==typeof e?e.call(this):e}},{key:"_getCurrentAlignment",value:function(){var e=this.alignment;return this.dockEnabled||!this.viewModel.active?null:this._calculatePositionResult(this._calculateAutoAlignment(this._callCurrentAlignment(e)))}},{key:"_setCurrentAlignment",value:function(){this._set("currentAlignment",this._getCurrentAlignment())}},{key:"_setCurrentDockPosition",value:function(){this._set("currentDockPosition",this._getCurrentDockPosition())}},{key:"_calculatePositionResult",value:function(e){var t=["left","right"];return Object(wt.h)()&&t.reverse(),e.replace(/leading/gi,t[0]).replace(/trailing/gi,t[1])}},{key:"_callDockPosition",value:function(e){return"function"==typeof e?e.call(this):e}},{key:"_getDockPosition",value:function(){var e;return this._calculatePositionResult(this._calculateAutoDockPosition(this._callDockPosition(null==(e=this.dockOptions)?void 0:e.position)))}},{key:"_getCurrentDockPosition",value:function(){return this.dockEnabled&&this.viewModel.active?this._getDockPosition():null}},{key:"_wouldDockTo",value:function(){return this.dockEnabled?null:this._getDockPosition()}},{key:"_calculateAutoDockPosition",value:function(e){var t;if("auto"!==e)return e;var r=null==(t=this.viewModel)?void 0:t.view,n=Object(wt.h)()?"top-left":"top-right";if(!r)return n;var i=r.padding||{left:0,right:0,top:0,bottom:0},a=r.width-i.left-i.right,o=r.breakpoints;return o&&a<=o.xsmall?"bottom-center":n}},{key:"_positionContainer",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this._containerNode;if(e&&(this._containerNode=e),e){var t=this.viewModel.screenLocation,r=e.getBoundingClientRect(),n=r.width,i=this._calculatePositionStyle(t,n);i&&(e.style.top=i.top,e.style.left=i.left,e.style.bottom=i.bottom,e.style.right=i.right)}}},{key:"_calculateFullWidth",value:function(e){var t=this.currentAlignment,r=this._pointerOffsetInPx;return"top-left"===t||"bottom-left"===t||"top-right"===t||"bottom-right"===t?e+r:e}},{key:"_calculateAlignmentPosition",value:function(e,t,r,n){var i=this.currentAlignment,a=this._pointerOffsetInPx,o=n/2,s=r.height-t,c=r.width-e,l=this.view.padding;return"bottom-center"===i?{top:t+a-l.top,left:e-o-l.left}:"top-left"===i?{bottom:s+a-l.bottom,right:c+a-l.right}:"bottom-left"===i?{top:t+a-l.top,right:c+a-l.right}:"top-right"===i?{bottom:s+a-l.bottom,left:e+a-l.left}:"bottom-right"===i?{top:t+a-l.top,left:e+a-l.left}:"top-center"===i?{bottom:s+a-l.bottom,left:e-o-l.left}:void 0}},{key:"_calculatePositionStyle",value:function(e,t){var r=this.dockEnabled,n=this.view;if(n){if(r)return{left:"",top:"",right:"",bottom:""};if(!Object(I.i)(e)&&t){var i=this._calculateFullWidth(t),a=this._calculateAlignmentPosition(e.x,e.y,n,i);return a?{top:void 0!==a.top?"".concat(a.top,"px"):"auto",left:void 0!==a.left?"".concat(a.left,"px"):"auto",bottom:void 0!==a.bottom?"".concat(a.bottom,"px"):"auto",right:void 0!==a.right?"".concat(a.right,"px"):"auto"}:void 0}}}},{key:"_viewChange",value:function(e,t){e&&t&&(this.close(),this.clear())}},{key:"_viewReadyChange",value:function(e,t){if(e){var r=this.get("viewModel.view");this._wireUpView(r)}else t&&(this.close(),this.clear())}},{key:"_wireUpView",value:function(e){(this._destroySpinner(),e)&&(this.spinnerEnabled&&this._createSpinner(e),this._setDockEnabledForViewSize(this.dockOptions))}},{key:"_dockingThresholdCrossed",value:function(e,t,r){var n=Object(ue.a)(e,2),i=n[0],a=n[1],o=Object(ue.a)(t,2),s=o[0],c=o[1],l=r.width,u=r.height;return i<=l&&s>l||i>l&&s<=l||a<=u&&c>u||a>u&&c<=u}},{key:"_updateDockEnabledForViewSize",value:function(e,t){if(e&&t){var r=this.get("viewModel.view.padding")||{left:0,right:0,top:0,bottom:0},n=r.left+r.right,i=r.top+r.bottom,a=[],o=[];a[0]=e[0]-n,a[1]=e[1]-i,o[0]=t[0]-n,o[1]=t[1]-i;var s=this.dockOptions,c=s.breakpoint;this._dockingThresholdCrossed(a,o,c)&&this._setDockEnabledForViewSize(s),this._setCurrentDockPosition()}}},{key:"_focusDockButtonNode",value:function(e){this._focusDockButton&&(this._focusDockButton=!1,e.focus())}},{key:"_closeButtonNodeUpdated",value:function(e){return this._focusClose?(this._focusClose=!1,void e.focus()):this._blurClose?(this._blurClose=!1,void e.blur()):void 0}},{key:"_mainContainerNodeUpdated",value:function(e){return this._mainContainerNode=e,this._focusContainer?(this._focusContainer=!1,void e.focus()):this._blurContainer?(this._blurContainer=!1,void e.blur()):void 0}},{key:"_featureMenuNodeUpdated",value:function(e){if(this._featureMenuNode=e,e&&this._focusFirstFeature){this._focusFirstFeature=!1;var t=e.querySelectorAll("li");t.length&&t[0].focus()}}},{key:"_actionsMenuNodeUpdated",value:function(e){if(this._actionsMenuNode=e,e&&this._focusFirstAction){this._focusFirstAction=!1;var t=e.querySelectorAll("li");t.length&&t[0].focus()}}},{key:"_focusFeatureMenuButtonNode",value:function(e){this._focusFeatureMenuButton&&(this._focusFeatureMenuButton=!1,e.focus())}},{key:"_focusActionsMenuButtonNode",value:function(e){this._focusActionsMenuButton&&(this._focusActionsMenuButton=!1,e.focus())}},{key:"_featureMenuViewportScrollTop",value:function(){this._featureMenuViewportNode&&(this._featureMenuViewportNode.scrollTop=0)}},{key:"_toggleScreenLocationEnabled",value:function(){var e=this.dockEnabled,t=this.viewModel;if(t){var r=t.active&&!e;t.screenLocationEnabled=r}}},{key:"_shouldDockAtCurrentViewSize",value:function(e){var t,r,n=e.breakpoint,i=null==(t=this.viewModel)||null==(r=t.view)?void 0:r.ui;if(!i)return!1;var a=i.width,o=i.height;if(isNaN(a)||isNaN(o))return!1;var s=n.hasOwnProperty("width")&&a<=n.width,c=n.hasOwnProperty("height")&&o<=n.height;return s||c}},{key:"_setDockEnabledForViewSize",value:function(e){e.breakpoint&&(this.dockEnabled=this._shouldDockAtCurrentViewSize(e))}},{key:"_getPageText",value:function(e,t){return this.featureNavigationVisible?Object(gi.a)(this.messages.pageText,{index:t+1,total:e}):null}},{key:"_destroySpinner",value:function(){var e=this._spinner,t=this.view;e&&(t&&t.ui&&t.ui.remove(this._spinner,Ga),e.destroy(),this._spinner=null)}},{key:"_createSpinner",value:function(e){e&&(this._spinner=new Gi({view:e}),e.ui.add(this._spinner,{key:Ga,position:"manual"}))}},{key:"_toggleCollapsed",value:function(){this.collapsed=!this.collapsed}},{key:"_close",value:function(){this.close(),this.view&&this.view.focus()}},{key:"_toggleDockEnabled",value:function(){this.dockEnabled=!this.dockEnabled,this._focusDockButton=!0,this.scheduleRender()}},{key:"_toggleFeatureMenu",value:function(){var e=!this.featureMenuOpen;this._featureMenuOpenChanged(e),this.actionsMenuOpen=!1,this.featureMenuOpen=e}},{key:"_toggleActionsMenu",value:function(){var e=!this.actionsMenuOpen;this._actionsMenuOpenChanged(e),this.featureMenuOpen=!1,this.actionsMenuOpen=e}},{key:"_triggerAction",value:function(e){var t=e.currentTarget["data-action-index"],r=this.viewModel.allActions.getItemAt(t);r&&"toggle"===r.type&&(r.value=!r.value),this.actionsMenuOpen=!1,this.viewModel.triggerAction(t)}},{key:"_selectFeature",value:function(e){var t=e.currentTarget["data-feature-index"];isNaN(t)||(this.viewModel.selectedFeatureIndex=t),this.featureMenuOpen=!1,this._focusFeatureMenuButton=!0,this.scheduleRender()}},{key:"_next",value:function(){this.next()}},{key:"_previous",value:function(){this.previous()}}]),r}(yi(ge.a));Object(b.a)([Object(y.b)({readOnly:!0})],js.prototype,"actionsMenuId",null),Object(b.a)([Object(y.b)({readOnly:!0})],js.prototype,"actionsMenuButtonId",null),Object(b.a)([Object(y.b)({readOnly:!0})],js.prototype,"featureMenuId",null),Object(b.a)([Object(y.b)({readOnly:!0})],js.prototype,"titleId",null),Object(b.a)([Object(y.b)({readOnly:!0})],js.prototype,"contentId",null),Object(b.a)([Object(y.b)({readOnly:!0})],js.prototype,"hasContent",null),Object(b.a)([Object(y.b)({readOnly:!0})],js.prototype,"featureNavigationVisible",null),Object(b.a)([Object(y.b)({readOnly:!0})],js.prototype,"collapsible",null),Object(b.a)([Object(y.b)({readOnly:!0})],js.prototype,"featureMenuVisible",null),Object(b.a)([Object(y.b)({readOnly:!0})],js.prototype,"contentCollapsed",null),Object(b.a)([Object(y.b)({readOnly:!0})],js.prototype,"dividedActions",null),Object(b.a)([Object(ye.a)("viewModel.actions")],js.prototype,"actions",void 0),Object(b.a)([Object(y.b)()],js.prototype,"actionsMenuOpen",null),Object(b.a)([Object(y.b)()],js.prototype,"alignment",void 0),Object(b.a)([Object(ye.a)("viewModel.autoCloseEnabled")],js.prototype,"autoCloseEnabled",void 0),Object(b.a)([Object(ye.a)("viewModel.autoOpenEnabled")],js.prototype,"autoOpenEnabled",void 0),Object(b.a)([Object(ye.a)("viewModel.defaultPopupTemplateEnabled")],js.prototype,"defaultPopupTemplateEnabled",void 0),Object(b.a)([Object(ye.a)("viewModel.content")],js.prototype,"content",void 0),Object(b.a)([Object(y.b)()],js.prototype,"collapsed",void 0),Object(b.a)([Object(y.b)()],js.prototype,"collapseEnabled",void 0),Object(b.a)([Object(y.b)({readOnly:!0})],js.prototype,"currentAlignment",null),Object(b.a)([Object(y.b)({readOnly:!0})],js.prototype,"currentDockPosition",null),Object(b.a)([Object(y.b)()],js.prototype,"dockOptions",null),Object(b.a)([Object(y.b)()],js.prototype,"dockEnabled",void 0),Object(b.a)([Object(ye.a)("viewModel.featureCount")],js.prototype,"featureCount",void 0),Object(b.a)([Object(y.b)()],js.prototype,"featureMenuOpen",void 0),Object(b.a)([Object(ye.a)("viewModel.features")],js.prototype,"features",void 0),Object(b.a)([Object(ye.a)("viewModel.goToOverride")],js.prototype,"goToOverride",void 0),Object(b.a)([Object(y.b)()],js.prototype,"headingLevel",void 0),Object(b.a)([Object(ye.a)("viewModel.highlightEnabled")],js.prototype,"highlightEnabled",void 0),Object(b.a)([Object(ye.a)("viewModel.location")],js.prototype,"location",void 0),Object(b.a)([Object(y.b)({aliasOf:{source:"messages.widgetLabel",overridable:!0}})],js.prototype,"label",void 0),Object(b.a)([Object(y.b)()],js.prototype,"maxInlineActions",void 0),Object(b.a)([Object(y.b)(),Object(xt.a)("esri/widgets/Popup/t9n/Popup")],js.prototype,"messages",void 0),Object(b.a)([Object(y.b)(),Object(xt.a)("esri/t9n/common")],js.prototype,"messagesCommon",void 0),Object(b.a)([Object(ye.a)("viewModel.promises")],js.prototype,"promises",void 0),Object(b.a)([Object(ye.a)("viewModel.selectedFeature")],js.prototype,"selectedFeature",void 0),Object(b.a)([Object(ye.a)("viewModel.selectedFeatureIndex")],js.prototype,"selectedFeatureIndex",void 0),Object(b.a)([Object(y.b)({readOnly:!0})],js.prototype,"selectedFeatureWidget",null),Object(b.a)([Object(y.b)()],js.prototype,"spinnerEnabled",void 0),Object(b.a)([Object(ye.a)("viewModel.title")],js.prototype,"title",void 0),Object(b.a)([Object(ye.a)("viewModel.updateLocationEnabled")],js.prototype,"updateLocationEnabled",void 0),Object(b.a)([Object(ye.a)("viewModel.view")],js.prototype,"view",void 0),Object(b.a)([Object(y.b)({type:Va}),Object(Ua.a)(["triggerAction","trigger-action"])],js.prototype,"viewModel",void 0),Object(b.a)([Object(ye.a)("viewModel.visible")],js.prototype,"visible",void 0),Object(b.a)([Object(y.b)()],js.prototype,"visibleElements",void 0),Object(b.a)([Object(O.a)("visibleElements")],js.prototype,"castVisibleElements",null),Object(b.a)([Object(Na.a)()],js.prototype,"_close",null),Object(b.a)([Object(Na.a)()],js.prototype,"_toggleDockEnabled",null),Object(b.a)([Object(Na.a)()],js.prototype,"_toggleFeatureMenu",null),Object(b.a)([Object(Na.a)()],js.prototype,"_toggleActionsMenu",null),Object(b.a)([Object(Na.a)()],js.prototype,"_triggerAction",null),Object(b.a)([Object(Na.a)()],js.prototype,"_selectFeature",null),Object(b.a)([Object(Na.a)()],js.prototype,"_next",null),Object(b.a)([Object(Na.a)()],js.prototype,"_previous",null);var _s=js=Object(b.a)([Object(w.a)(ys)],js),ws=[0,0];function xs(e){e&&(Object(N.b)(e),e.parentNode&&e.parentNode.removeChild(e))}var ks=16,Ss=750;var Ts=r(169),Cs=r(649),Ms=r(162),Ps=r(90),As=j.a.getLogger("esri.views.support.GroundViewElevationSampler"),Es=function(e){Object(f.a)(r,e);var t=Object(p.a)(r);function r(e){var n;return Object(c.a)(this,r),(n=t.call(this,e)).demResolution={min:-1,max:-1},n.noDataValue=Ps.c,n}return Object(l.a)(r,[{key:"initialize",value:function(){var e=this;this.view.basemapTerrain.on("elevation-change",(function(){return e.emit("changed",{})}))}},{key:"extent",get:function(){var e=this.view.basemapTerrain;return e.extent&&e.spatialReference?Object(K.z)(e.extent,e.spatialReference):null}},{key:"elevationAt",value:function(e){var t=e.spatialReference,r=this.spatialReference;if(!Object(re.a)(t,r)){var n=t?t.wkid:"unknown";return As.error("Cannot sample elevation at a location with spatial reference (".concat(n,") different from the view (").concat(r.wkid,")")),null}if(!Object(Ts.e)(this.extent,e)){var i=this.extent,a="".concat(i.xmin,", ").concat(i.ymin,", ").concat(i.xmax,", ").concat(i.ymax);As.warn("#elevationAt()","Point used to sample elevation (".concat(e.x,", ").concat(e.y,") is outside of the sampler extent (").concat(a,")"))}return Object(Ms.b)(this.view.elevationProvider,e)}},{key:"queryElevation",value:function(e){return Object(Cs.b)(e.clone(),this)}}]),r}(Ii.a.EventedAccessor);Object(b.a)([Object(y.b)({readOnly:!0})],Es.prototype,"demResolution",void 0),Object(b.a)([Object(y.b)({readOnly:!0})],Es.prototype,"extent",null),Object(b.a)([Object(y.b)({readOnly:!0})],Es.prototype,"noDataValue",void 0),Object(b.a)([Object(y.b)({readOnly:!0,aliasOf:"view.basemapTerrain.spatialReference"})],Es.prototype,"spatialReference",void 0),Object(b.a)([Object(y.b)({constructOnly:!0})],Es.prototype,"view",void 0);var Rs=Es=Object(b.a)([Object(w.a)("esri.views.support.GroundViewElevationSampler")],Es),Is=function(e){Object(f.a)(r,e);var t=Object(p.a)(r);function r(e){var n;return Object(c.a)(this,r),(n=t.call(this,e)).handles=new oe.a,n.view=null,n.layerViews=new V.a,n}return Object(l.a)(r,[{key:"initialize",value:function(){var e=this;this.handles.add(Object(W.f)(this,"view.map.ground",(function(e){return e.load()}))),this.handles.add(this.layerViews.on("after-changes",(function(){return e.layerViewsAfterChangesHandler()})))}},{key:"destroy",value:function(){this._set("view",null),this.handles&&(this.handles.destroy(),this.handles=null)}},{key:"elevationSampler",get:function(){return this.view?"2d"===this.view.type?null:this.view.ready&&this.view.basemapTerrain&&this.view.basemapTerrain.ready?new Rs({view:this.view}):null:null}},{key:"updating",get:function(){return!this.suspended&&this.layerViews.some((function(e){return e.updating}))}},{key:"suspended",get:function(){return!this.view||this.view.suspended}},{key:"layerViewsAfterChangesHandler",value:function(){var e=this;this.handles.remove("updating"),this.handles.add(this.layerViews.map((function(t){return t.watch("updating",(function(){return e.updateUpdating()}),!0)})).toArray(),"updating"),this.updateUpdating()}},{key:"updateUpdating",value:function(){this.notifyChange("updating")}}]),r}(de.a);Object(b.a)([Object(y.b)({readOnly:!0})],Is.prototype,"elevationSampler",null),Object(b.a)([Object(y.b)({type:Boolean,readOnly:!0})],Is.prototype,"updating",null),Object(b.a)([Object(y.b)({constructOnly:!0})],Is.prototype,"view",void 0),Object(b.a)([Object(y.b)({type:V.a,readOnly:!0})],Is.prototype,"layerViews",void 0),Object(b.a)([Object(y.b)({readOnly:!0})],Is.prototype,"suspended",null);var Ds=Is=Object(b.a)([Object(w.a)("esri.views.GroundView")],Is),Fs=r(101),Ls=r(538),zs=r(232),Vs=r(280),Ns=r(180),Us=r(238),Bs=r(66),Gs=r(55),qs=r(59),Hs=r(563),Ws=function(e){Object(f.a)(r,e);var t=Object(p.a)(r);function r(e){var n;return Object(c.a)(this,r),(n=t.call(this,e)).view=null,n.baseLayerViews=new V.a,n.referenceLayerViews=new V.a,n._loadingHandle=Object(W.a)(Object(u.a)(n),"view.map.basemap",(function(e){e&&e.load().catch((function(){}))})),n}return Object(l.a)(r,[{key:"destroy",value:function(){this._set("view",null),this._loadingHandle&&(this._loadingHandle.remove(),this._loadingHandle=null)}},{key:"suspended",get:function(){return!this.view||this.view.suspended}},{key:"updating",get:function(){return(!this.view||!this.view.suspended)&&!(!(this.view&&this.view.map&&this.view.map.basemap)||this.view.map.basemap.loaded)}}]),r}(de.a);Object(b.a)([Object(y.b)({constructOnly:!0})],Ws.prototype,"view",void 0),Object(b.a)([Object(y.b)({readOnly:!0})],Ws.prototype,"baseLayerViews",void 0),Object(b.a)([Object(y.b)({readOnly:!0})],Ws.prototype,"referenceLayerViews",void 0),Object(b.a)([Object(y.b)({readOnly:!0})],Ws.prototype,"suspended",null),Object(b.a)([Object(y.b)({type:Boolean,readOnly:!0})],Ws.prototype,"updating",null),Ws=Object(b.a)([Object(w.a)("esri.views.BasemapView")],Ws);var Qs=r(121),Zs=j.a.getLogger("esri.views.LayerViewManager"),Xs=function(){function e(t,r,n){var i=this;Object(c.a)(this,e),this.layer=t,this.view=r,this.layerViewImporter=n,this._controller=Object(q.e)(),this._deferred=Object(q.g)(),this._started=!1,this.done=!1,Object(q.s)(this._controller.signal,(function(){var e=new U.a("cancelled:layerview-create","layerview creation cancelled",{layer:t});i._deferred.reject(e)}))}return Object(l.a)(e,[{key:"promise",get:function(){return this._deferred.promise}},{key:"destroy",value:function(){this._controller.abort();var e=this.layerView;if(e){var t=this.layer,r=this.view;t.emit("layerview-destroy",{view:r,layerView:e}),r.emit("layerview-destroy",{layer:t,layerView:e}),this.done=!0,this.layer=null,this.layerView=null,this.view=null,this.layerViewImporter=null}}},{key:"start",value:function(){var e=Object(s.a)(o.a.mark((function e(){var t,r,n,i,a,s,c,l,u,d=this;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._started){e.next=2;break}return e.abrupt("return");case 2:return this._started=!0,t=this._controller.signal,r=this.layer,n=this.view,this._map=n.map,e.prev=5,e.next=8,r.load({signal:t});case 8:if(e.t0="prefetchResources"in r,!e.t0){e.next=12;break}return e.next=12,r.prefetchResources({signal:t});case 12:if(!r.createLayerView){e.next=18;break}return e.next=15,r.createLayerView(n,{signal:t});case 15:s=e.sent,e.next=24;break;case 18:if(this.layerViewImporter.hasLayerViewModule(r)){e.next=20;break}throw new U.a("layer:view-not-supported","No layerview implementation was found");case 20:return e.next=22,this.layerViewImporter.importLayerView(r);case 22:l=e.sent,Object(q.x)(t),s="default"in l?new l.default({layer:r,view:n}):new l({layer:r,view:n});case 24:return u=function(){c=Object(I.r)(c),s.destroyed||s.destroy(),s.layer=null,s.parent=null,s.view=null,d.done=!0},c=Object(q.s)(t,u),Object(q.x)(t),e.prev=26,e.next=29,s.when();case 29:e.next=34;break;case 31:throw e.prev=31,e.t1=e.catch(26),u(),e.t1;case 34:if(null==(i=this._map)||null==(a=i.allLayers)?void 0:a.includes(r)){e.next=36;break}return e.abrupt("return",(u(),void this._deferred.reject(new U.a("view:no-layerview-for-layer","The layer has been removed from the map",{layer:r}))));case 36:this.layerView=s,r.emit("layerview-create",{view:n,layerView:s}),n.emit("layerview-create",{layer:r,layerView:s}),this.done=!0,this._deferred.resolve(s),e.next=42;break;case 39:e.prev=39,e.t2=e.catch(5),r.emit("layerview-create-error",{view:n,error:e.t2}),n.emit("layerview-create-error",{layer:r,error:e.t2}),this.done=!0,this._deferred.reject(new U.a("layerview:create-error","layerview creation failed",{layer:r,error:e.t2}));case 42:case"end":return e.stop()}}),e,this,[[5,39],[26,31]])})));return function(){return e.apply(this,arguments)}}()}]),e}(),Ys=function(e){Object(f.a)(r,e);var t=Object(p.a)(r);function r(e){var n;return Object(c.a)(this,r),(n=t.call(this,e))._layerLayerViewInfoMap=new Map,n._watchUpdatingTracking=new fe.a,n.supportsGround=!0,n._preloadLayerViewModules=function(){var e,t=null==(e=n.view.map)?void 0:e.allLayers;if(t){var r,a=Object(i.a)(t);try{for(a.s();!(r=a.n()).done;){var o=r.value;n.layerViewImporter.hasLayerViewModule(o)&&n.layerViewImporter.importLayerView(o)}}catch(s){a.e(s)}finally{a.f()}}},n._reschedule=function(){return Object(I.i)(n._workPromise)&&(n._workPromise=Object(q.g)()),n.handles.remove("reschedule"),n.handles.add(Object(H.b)(n._doWork),"reschedule"),n._workPromise.promise},n._doWork=function(){var e,t,r,a=n.view.map;if(n._map!==a&&(n.clear(),n._map=a),Object(I.i)(n._workPromise))n.notifyChange("updating");else{n.handles.remove("reschedule"),n.handles.remove("collection-change");var o=new Vs.a({getCollections:function(){return n._rootCollectionNames.map((function(e){return n.get(e)}))},getChildrenFunction:function(e){return e&&"layers"in e?e.layers:null}});if(!o)return n._workPromise.resolve(),void(n._workPromise=null);var s,c=Object(i.a)(o);try{for(c.s();!(s=c.n()).done;){var l=s.value;n._createLayerView(l)}}catch(m){c.e(m)}finally{c.f()}n._refreshCollections();var u,d=Object(i.a)(n._layerLayerViewInfoMap);try{for(d.s();!(u=d.n()).done;){var h=Object(ue.a)(u.value,2),f=h[0],p=h[1];o.includes(f)||(n._layerLayerViewInfoMap.delete(p.layer),p.destroy())}}catch(m){d.e(m)}finally{d.f()}var b=o.filter((function(e){return"group"===e.type})).map((function(e){return e.layers})),v=[null==a||null==(e=a.ground)?void 0:e.layers,null==a||null==(t=a.basemap)?void 0:t.baseLayers,null==a||null==(r=a.basemap)?void 0:r.referenceLayers,null==a?void 0:a.layers].concat(Object(xe.a)(b)).filter((function(e){return!!e}));n.handles.add(v.map((function(e){return n._watchUpdatingTracking.addOnCollectionChange(e,n._reschedule)})),"collection-change"),n._workPromise.resolve(),n._workPromise=null}},n}return Object(l.a)(r,[{key:"initialize",value:function(){this.handles.add([Object(W.b)(this,"view.map.allLayers","change",this._preloadLayerViewModules,this._preloadLayerViewModules),Object(W.a)(this.view,["map.basemap","map.ground","map.layers","ready"],this._reschedule,!0)]),this._preloadLayerViewModules(),this._reschedule()}},{key:"destroy",value:function(){this.clear(),this._watchUpdatingTracking.destroy(),this._map=null}},{key:"_layersToLayerViews",get:function(){var e=[["view.map.basemap.baseLayers","view.basemapView.baseLayerViews"],["view.map.layers","view.layerViews"],["view.map.basemap.referenceLayers","view.basemapView.referenceLayerViews"]];return this.supportsGround&&e.push(["view.map.ground.layers","view.groundView.layerViews"]),new Map(e)}},{key:"_rootCollectionNames",get:function(){return Array.from(this._layersToLayerViews.keys())}},{key:"updating",get:function(){return Object(I.j)(this._workPromise)||this._watchUpdatingTracking.updating||Object(Qs.b)(this._layerLayerViewInfoMap,(function(e){return!e.done}))}},{key:"updatingRemaining",get:function(){var e,t=0,r=Object(i.a)(this._layerLayerViewInfoMap.values());try{for(r.s();!(e=r.n()).done;){e.value.done||++t}}catch(n){r.e(n)}finally{r.f()}return t}},{key:"clear",value:function(){if(!this.destroyed){var e,t=Object(i.a)(this._layerLayerViewInfoMap.values());try{for(t.s();!(e=t.n()).done;){e.value.destroy()}}catch(r){t.e(r)}finally{t.f()}this._layerLayerViewInfoMap.clear(),this._refreshCollections()}}},{key:"whenLayerView",value:function(){var e=Object(s.a)(o.a.mark((function e(t){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._reschedule();case 2:if(this._layerLayerViewInfoMap.has(t)){e.next=4;break}throw new U.a("view:no-layerview-for-layer","No layerview has been found for the layer",{layer:t});case 4:return e.abrupt("return",this._layerLayerViewInfoMap.get(t).promise);case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_refreshCollections",value:function(){var e,t=Object(i.a)(this._layersToLayerViews);try{for(t.s();!(e=t.n()).done;){var r=Object(ue.a)(e.value,2),n=r[0],a=r[1];this._populateLayerViewsOwners(this.get(n),this.get(a),this.view)}}catch(o){t.e(o)}finally{t.f()}this.notifyChange("updating"),this.notifyChange("updatingRemaining")}},{key:"_populateLayerViewsOwners",value:function(e,t,r){if(e&&t){var n,a=0,o=Object(i.a)(e);try{for(o.s();!(n=o.n()).done;){var s=n.value,c=this._layerLayerViewInfoMap.get(s);if(c&&c.layerView){var l=c.layerView;l.layer=s,l.parent=r,t.getItemAt(a)!==l&&t.splice(a,0,l),s.layers&&this._populateLayerViewsOwners(s.layers,l.layerViews,l),a+=1}}}catch(u){o.e(u)}finally{o.f()}a<t.length&&t.splice(a,t.length)}else t&&t.removeAll()}},{key:"_createLayerView",value:function(e){var t=this;if(this._layerLayerViewInfoMap.has(e))return this.view.ready&&this._layerLayerViewInfoMap.get(e).start(),this.notifyChange("updating"),void this.notifyChange("updatingRemaining");e.load().catch((function(){})),this.layerViewImporter.hasLayerViewModule(e)&&this.layerViewImporter.importLayerView(e);var r=new Xs(e,this.view,this.layerViewImporter);r.promise.then((function(){return t._refreshCollections()}),(function(r){var n,i;r&&(Object(q.n)(r)||"cancelled:layerview-create"===r.name)||Zs.error("Failed to create layerview for layer title:'".concat(null!=(n=e.title)?n:"no title","', id:'").concat(null!=(i=e.id)?i:"no id","' of type '").concat(e.type,"'."),{layer:e,error:r}),t._refreshCollections()})),this._layerLayerViewInfoMap.set(e,r),this.view.ready&&r.start(),this.notifyChange("updating"),this.notifyChange("updatingRemaining")}}]),r}(je.a);Object(b.a)([Object(y.b)()],Ys.prototype,"_workPromise",void 0),Object(b.a)([Object(y.b)({readOnly:!0})],Ys.prototype,"_watchUpdatingTracking",void 0),Object(b.a)([Object(y.b)({readOnly:!0})],Ys.prototype,"_layersToLayerViews",null),Object(b.a)([Object(y.b)({readOnly:!0})],Ys.prototype,"_rootCollectionNames",null),Object(b.a)([Object(y.b)()],Ys.prototype,"layerViewImporter",void 0),Object(b.a)([Object(y.b)()],Ys.prototype,"supportsGround",void 0),Object(b.a)([Object(y.b)({readOnly:!0})],Ys.prototype,"updating",null),Object(b.a)([Object(y.b)({readOnly:!0})],Ys.prototype,"updatingRemaining",null),Object(b.a)([Object(y.b)({constructOnly:!0})],Ys.prototype,"view",void 0);var $s=Ys=Object(b.a)([Object(w.a)("esri.views.LayerViewManager")],Ys),Js=function(e){Object(f.a)(r,e);var t=Object(p.a)(r);function r(e){var n;return Object(c.a)(this,r),(n=t.call(this,e)).factor=1.5,n.offset=Object(Z.e)(0,0),n.position=null,n.size=120,n.maskUrl=null,n.maskEnabled=!0,n.overlayUrl=null,n.overlayEnabled=!0,n.visible=!0,n}return Object(l.a)(r,[{key:"version",get:function(){return this.commitProperty("factor"),this.commitProperty("offset"),this.commitProperty("position"),this.commitProperty("visible"),this.commitProperty("size"),this.commitProperty("maskUrl"),this.commitProperty("maskEnabled"),this.commitProperty("overlayUrl"),this.commitProperty("overlayEnabled"),(this._get("version")||0)+1}}]),r}(de.a);Object(b.a)([Object(y.b)({type:Number})],Js.prototype,"factor",void 0),Object(b.a)([Object(y.b)({nonNullable:!0})],Js.prototype,"offset",void 0),Object(b.a)([Object(y.b)()],Js.prototype,"position",void 0),Object(b.a)([Object(y.b)({type:Number,range:{min:0}})],Js.prototype,"size",void 0),Object(b.a)([Object(y.b)()],Js.prototype,"maskUrl",void 0),Object(b.a)([Object(y.b)()],Js.prototype,"maskEnabled",void 0),Object(b.a)([Object(y.b)()],Js.prototype,"overlayUrl",void 0),Object(b.a)([Object(y.b)()],Js.prototype,"overlayEnabled",void 0),Object(b.a)([Object(y.b)({readOnly:!0})],Js.prototype,"version",null),Object(b.a)([Object(y.b)({type:Boolean})],Js.prototype,"visible",void 0);var Ks=Js=Object(b.a)([Object(w.a)("esri.views.Magnifier")],Js),ec=r(454),tc=function(e){Object(f.a)(r,e);var t=Object(p.a)(r);function r(){var e;return Object(c.a)(this,r),(e=t.apply(this,arguments))._handles=new oe.a,e._currentTick=0,e}return Object(l.a)(r,[{key:"initialize",value:function(){var e=this;this._handles.add([this.view.allLayerViews.on("after-changes",(function(){e.notifyChange("tickInterval"),e._handles.remove("layerViewsUpdating"),e._handles.add(e._getLayerViewHandles(),"layerViewsUpdating")})),this.watch("tickInterval",(function(){return e._restartTicking()})),this.watch("view.ready",(function(){return e._restartTicking()}))]),this._restartTicking()}},{key:"destroy",value:function(){this._handles&&(this._handles.destroy(),this._handles=null,this._intervalID&&clearInterval(this._intervalID),this._currentTick=0)}},{key:"tickInterval",get:function(){var e=this.view.allLayerViews.filter((function(e){return Object(ec.b)(e)}));return this._getCommonInterval(e)}},{key:"_restartTicking",value:function(){var e=this;this._currentTick=0,this._intervalID&&clearInterval(this._intervalID),this.get("view.ready")&&this.tickInterval&&(this._intervalID=setInterval((function(){var t=Date.now();e._currentTick+=e.tickInterval,e.view.allLayerViews.forEach((function(r){if(Object(ec.b)(r)){var n=Math.round(6e4*r.refreshInterval),i=e._currentTick%n==0,a=t-r.refreshTimestamp<5400;n&&i&&!a&&(r.refresh(t),e.emit("refresh",{layerView:r,timestamp:t,trigger:"interval"}))}}))}),this.tickInterval))}},{key:"_getLayerViewHandles",value:function(){var e=this,t=[],r=function(){return e.notifyChange("tickInterval")};return this.view.allLayerViews.forEach((function(n){Object(ec.b)(n)&&n.layer&&t.push(n.watch("refreshInterval",r),n.layer.on("refresh",(function(){var t=Date.now();n.refresh(t),e.emit("refresh",{layerView:n,timestamp:t,trigger:"layer-refresh"})})))})),t}},{key:"_getCommonInterval",value:function(e){var t=function e(t,r){return isNaN(t)||isNaN(r)?0:r<=0?t:e(r,t%r)};return e.toArray().reduce((function(e,r){return t(Math.round(6e4*r.refreshInterval),e)}),0)}}]),r}(Ii.a.EventedAccessor);Object(b.a)([Object(y.b)()],tc.prototype,"view",void 0),Object(b.a)([Object(y.b)({readOnly:!0})],tc.prototype,"tickInterval",null);var rc=tc=Object(b.a)([Object(w.a)("esri.views.RefreshManager")],tc),nc=["click","double-click","immediate-click","immediate-double-click","hold","drag","key-down","key-up","pointer-down","pointer-move","pointer-up","pointer-drag","mouse-wheel","pointer-enter","pointer-leave","gamepad","focus","blur"],ic={};function ac(e){return!!ic[e]}nc.forEach((function(e){ic[e]=!0}));var oc=function(){function e(t){Object(c.a)(this,e),this.handlers=new Map,this.counter=0,this.handlerCounts=new Map,this.view=t,this.inputManager=null}return Object(l.a)(e,[{key:"connect",value:function(e){var t=this;e&&this.disconnect(),this.inputManager=e,this.handlers.forEach((function(e,r){var n=e.handler,i=e.priority;return t.inputManager.installHandlers(r,[n],i)}))}},{key:"disconnect",value:function(){var e=this;this.inputManager&&this.handlers.forEach((function(t,r){return e.inputManager.uninstallHandlers(r)})),this.inputManager=null}},{key:"destroy",value:function(){this.disconnect(),this.handlers.clear(),this.view=null}},{key:"on",value:function(e,t,r,n){var a,o,s=this,c=Array.isArray(e)?e:e.split(",");if(!function(e){var t,r=Object(i.a)(e);try{for(r.s();!(t=r.n()).done;)if(!ac(t.value))return!1}catch(n){r.e(n)}finally{r.f()}return!0}(c))return c.some(ac)&&console.error("Error: registering input events and other events on the view at the same time is not supported."),null;Array.isArray(t)?o=t:(a=t,o=[]),"function"==typeof r?a=r:n=r,n=null!=n?n:pa.DEFAULT;var l=this.createUniqueGroupName(),u=new sc(this.view,c,o,a);this.handlers.set(l,{handler:u,priority:n});var d,h=Object(i.a)(c);try{for(h.s();!(d=h.n()).done;){var f=d.value,p=this.handlerCounts.get(f)||0;this.handlerCounts.set(f,p+1)}}catch(b){h.e(b)}finally{h.f()}return this.inputManager&&this.inputManager.installHandlers(l,[u],n),{remove:function(){return s.removeHandler(l,c)}}}},{key:"hasHandler",value:function(e){return!!this.handlerCounts.get(e)}},{key:"removeHandler",value:function(e,t){if(this.handlers.has(e)){this.handlers.delete(e);var r,n=Object(i.a)(t);try{for(n.s();!(r=n.n()).done;){var a=r.value,o=this.handlerCounts.get(a);void 0===o?console.error("Trying to remove handler for event that has no handlers registered: ",a):1===o?this.handlerCounts.delete(a):this.handlerCounts.set(a,o-1)}}catch(s){n.e(s)}finally{n.f()}}this.inputManager&&this.inputManager.uninstallHandlers(e)}},{key:"createUniqueGroupName",value:function(){return this.counter+=1,"viewEvents_".concat(this.counter)}}]),e}(),sc=function(e){Object(f.a)(r,e);var t=Object(p.a)(r);function r(e,n,a,o){var s;Object(c.a)(this,r),(s=t.call(this,!0)).view=e;var l,u=Object(i.a)(n);try{for(u.s();!(l=u.n()).done;){switch(l.value){case"click":s.registerIncoming("click",a,(function(e){return o(s.wrapClick(e))}));break;case"double-click":s.registerIncoming("double-click",a,(function(e){return o(s.wrapDoubleClick(e))}));break;case"immediate-click":s.registerIncoming("immediate-click",a,(function(e){return o(s.wrapImmediateClick(e))}));break;case"immediate-double-click":s.registerIncoming("immediate-double-click",a,(function(e){return o(s.wrapImmediateDoubleClick(e))}));break;case"hold":s.registerIncoming("hold",a,(function(e){return o(s.wrapHold(e))}));break;case"drag":s.registerIncoming("drag",a,(function(e){var t=s.wrapDrag(e);t&&o(t)}));break;case"key-down":s.registerIncoming("key-down",a,(function(e){return o(s.wrapKeyDown(e))}));break;case"key-up":s.registerIncoming("key-up",a,(function(e){return o(s.wrapKeyUp(e))}));break;case"pointer-down":s.registerIncoming("pointer-down",a,(function(e){return o(s.wrapPointer(e,"pointer-down"))}));break;case"pointer-move":s.registerIncoming("pointer-move",a,(function(e){return o(s.wrapPointer(e,"pointer-move"))}));break;case"pointer-up":s.registerIncoming("pointer-up",a,(function(e){return o(s.wrapPointer(e,"pointer-up"))}));break;case"pointer-drag":s.registerIncoming("pointer-drag",a,(function(e){return o(s.wrapPointerDrag(e))}));break;case"mouse-wheel":s.registerIncoming("mouse-wheel",a,(function(e){return o(s.wrapMouseWheel(e))}));break;case"pointer-enter":s.registerIncoming("pointer-enter",a,(function(e){return o(s.wrapPointer(e,"pointer-enter"))}));break;case"pointer-leave":s.registerIncoming("pointer-leave",a,(function(e){return o(s.wrapPointer(e,"pointer-leave"))}));break;case"gamepad":s.registerIncoming("gamepad",a,(function(e){o(s.wrapGamepad(e))}));break;case"focus":s.registerIncoming("focus",a,(function(e){o(s.wrapFocus(e))}));break;case"blur":s.registerIncoming("blur",a,(function(e){o(s.wrapBlur(e))}))}}}catch(d){u.e(d)}finally{u.f()}return s}return Object(l.a)(r,[{key:"wrapFocus",value:function(e){return{type:"focus",timestamp:e.timestamp,native:e.data.native,cancelable:e.cancelable,stopPropagation:function(){return e.stopPropagation()},async:function(t){return e.async(t)},preventDefault:function(){return e.preventDefault()}}}},{key:"wrapBlur",value:function(e){return{type:"blur",timestamp:e.timestamp,native:e.data.native,cancelable:e.cancelable,stopPropagation:function(){return e.stopPropagation()},async:function(t){return e.async(t)},preventDefault:function(){return e.preventDefault()}}}},{key:"wrapClick",value:function(e){var t=e.data,r=t.pointerType,n=t.button,i=t.buttons,a=t.x,o=t.y,s=t.native,c=t.eventId,l=e.cancelable;return{type:"click",pointerType:r,button:n,buttons:i,x:a,y:o,native:s,timestamp:e.timestamp,screenPoint:Object(Z.e)(a,o),mapPoint:this.getMapPoint(a,o),eventId:c,cancelable:l,stopPropagation:function(){return e.stopPropagation()},async:function(t){return e.async(t)},preventDefault:function(){return e.preventDefault()}}}},{key:"wrapDoubleClick",value:function(e){var t=e.data,r=t.pointerType,n=t.button,i=t.buttons,a=t.x,o=t.y,s=t.native,c=t.eventId,l=e.cancelable;return{type:"double-click",pointerType:r,button:n,buttons:i,x:a,y:o,native:s,timestamp:e.timestamp,mapPoint:this.getMapPoint(a,o),eventId:c,cancelable:l,stopPropagation:function(){return e.stopPropagation()},async:function(t){return e.async(t)},preventDefault:function(){return e.preventDefault()}}}},{key:"wrapImmediateClick",value:function(e){var t=e.data,r=t.pointerType,n=t.button,i=t.buttons,a=t.x,o=t.y,s=t.native,c=t.eventId,l=s.pointerId,u=e.cancelable;return{type:"immediate-click",pointerId:l,pointerType:r,button:n,buttons:i,x:a,y:o,native:s,timestamp:e.timestamp,mapPoint:this.getMapPoint(a,o),eventId:c,cancelable:u,stopPropagation:function(){return e.stopPropagation()},async:function(t){return e.async(t)},preventDefault:function(){return e.preventDefault()}}}},{key:"wrapImmediateDoubleClick",value:function(e){var t=e.data,r=t.pointerType,n=t.button,i=t.buttons,a=t.x,o=t.y,s=t.native,c=t.eventId,l=s.pointerId,u=e.cancelable;return{type:"immediate-double-click",pointerId:l,pointerType:r,button:n,buttons:i,x:a,y:o,native:s,timestamp:e.timestamp,mapPoint:this.getMapPoint(a,o),eventId:c,cancelable:u,stopPropagation:function(){return e.stopPropagation()},async:function(t){return e.async(t)},preventDefault:function(){return e.preventDefault()}}}},{key:"wrapHold",value:function(e){var t=e.data,r=t.pointerType,n=t.button,i=t.buttons,a=t.x,o=t.y,s=t.native,c=e.cancelable;return{type:"hold",pointerType:r,button:n,buttons:i,x:a,y:o,native:s,timestamp:e.timestamp,mapPoint:this.getMapPoint(a,o),cancelable:c,stopPropagation:function(){return e.stopPropagation()},async:function(t){return e.async(t)},preventDefault:function(){return e.preventDefault()}}}},{key:"getMapPoint",value:function(e,t){return this.view.toMap(Object(Z.e)(e,t),{exclude:[]})}},{key:"wrapDrag",value:function(e){var t=e.data,r=t.center,n=r.x,i=r.y,a=t.action,o=t.pointerType,s=t.button;if("start"===a&&(this.latestDragStart=t),this.latestDragStart){var c=t.pointer.native,l=t.buttons,u=e.cancelable,d=e.timestamp,h={x:this.latestDragStart.center.x,y:this.latestDragStart.center.y};return"end"===a&&(this.latestDragStart=void 0),{type:"drag",action:a,x:n,y:i,origin:h,pointerType:o,button:s,buttons:l,radius:t.radius,angle:Object(m.r)(t.angle),native:c,timestamp:d,cancelable:u,stopPropagation:function(){return e.stopPropagation()},async:function(t){return e.async(t)},preventDefault:function(){return e.preventDefault()}}}}},{key:"wrapKeyDown",value:function(e){var t=e.data,r=t.key,n=t.repeat,i=t.native,a=e.cancelable;return{type:"key-down",key:r,repeat:n,native:i,timestamp:e.timestamp,cancelable:a,stopPropagation:function(){return e.stopPropagation()},async:function(t){return e.async(t)},preventDefault:function(){return e.preventDefault()}}}},{key:"wrapKeyUp",value:function(e){var t=e.data,r=t.key,n=t.native,i=e.cancelable;return{type:"key-up",key:r,native:n,timestamp:e.timestamp,cancelable:i,stopPropagation:function(){return e.stopPropagation()},async:function(t){return e.async(t)},preventDefault:function(){return e.preventDefault()}}}},{key:"wrapPointer",value:function(e,t){var r=e.data,n=r.x,i=r.y,a=r.button,o=r.buttons,s=r.native,c=r.eventId,l=s.pointerId,u=s.pointerType,d=e.cancelable;return{type:t,x:n,y:i,pointerId:l,pointerType:u,button:a,buttons:o,native:s,timestamp:e.timestamp,eventId:c,cancelable:d,stopPropagation:function(){return e.stopPropagation()},async:function(t){return e.async(t)},preventDefault:function(){return e.preventDefault()}}}},{key:"wrapPointerDrag",value:function(e){var t=e.data.currentEvent,r=t.x,n=t.y,i=t.buttons,a=t.native,o=t.eventId,s=e.data.startEvent.button,c=e.data.startEvent.native.pointerId,l=e.data.startEvent.native.pointerType,u=e.data.action,d={x:e.data.startEvent.x,y:e.data.startEvent.y},h=e.cancelable;return{type:"pointer-drag",x:r,y:n,pointerId:c,pointerType:l,button:s,buttons:i,action:u,origin:d,native:a,timestamp:e.timestamp,eventId:o,cancelable:h,stopPropagation:function(){return e.stopPropagation()},async:function(t){return e.async(t)},preventDefault:function(){return e.preventDefault()}}}},{key:"wrapMouseWheel",value:function(e){var t=e.cancelable,r=e.data,n=e.timestamp;return{type:"mouse-wheel",x:r.x,y:r.y,deltaY:r.deltaY,native:r.native,timestamp:n,cancelable:t,stopPropagation:function(){return e.stopPropagation()},async:function(t){return e.async(t)},preventDefault:function(){return e.preventDefault()}}}},{key:"wrapGamepad",value:function(e){var t=e.data,r=t.action,n=t.state,i=t.device,a=e.cancelable;return{type:"gamepad",device:i,timestamp:e.timestamp,action:r,buttons:n.buttons,axes:n.axes,cancelable:a,stopPropagation:function(){return e.stopPropagation()},async:function(t){return e.async(t)},preventDefault:function(){return e.preventDefault()}}}}]),r}(sa);function cc(e,t){var r=e.view;r&&(t&&r.ready&&r.activeTool!==e?(r.activeTool=e,function(e){return e&&"focus"in e}(r)&&r.focus()):t||r.activeTool!==e||(r.activeTool=null))}function lc(e){return!1!==e.visible&&!1!==e.editable&&(null==e.hasEditableFlag||e.hasEditableFlag(1))}function uc(e){return Object(I.i)(e)?{}:"function"==typeof e?e():e}function dc(e){return Object(Z.e)(e.x,e.y)}function hc(e,t){var r=(e instanceof HTMLElement?e:e.surface).getBoundingClientRect();return Object(Z.e)(t.clientX-r.left,t.clientY-r.top)}function fc(e,t){return t instanceof Event?hc(e,t):dc(t)}function pc(e){if(e instanceof Event)return!0;if("object"==typeof e&&"type"in e)switch(e.type){case"click":case"double-click":case"pointer-down":case"pointer-drag":case"pointer-enter":case"pointer-leave":case"pointer-up":case"pointer-move":case"immediate-click":case"immediate-double-click":case"hold":case"drag":case"mouse-wheel":return!0;case"key-down":case"key-up":case"gamepad":case"focus":case"blur":default:return!1}return!1}var bc=function(){function e(){Object(c.a)(this,e),this._pointerLocations=new Map,this._hoveredManipulators=new Map,this._grabbedManipulators=new Map,this._draggedManipulators=new Map,this._stopDrag=!1,this._revertToActiveTool=null,this._cursor=null}return Object(l.a)(e,[{key:"cursor",get:function(){return this._cursor}},{key:"handleInputEvent",value:function(e,t){var r=function(){return e.stopPropagation()};switch(e.type){case"pointer-move":vc(e.pointerType)&&this._pointerLocations.set(e.pointerId,{x:e.x,y:e.y,pointerType:e.pointerType});break;case"drag":this._grabbedManipulators.size>0&&(this._stopDrag=!0),this._stopDrag&&(r(),"end"===e.action&&(this._stopDrag=!1));break;case"pointer-down":if(!mc(e))break;var n=dc(e),i=this._intersect(n,e.pointerType,t.forEachTool);if(Object(I.i)(i))break;var a=this._findToolAndManipulatorByKey(i,t.forEachTool,yc),o=Object(I.c)(a,(function(e){return e.manipulator})),s=Object(I.c)(a,(function(e){return e.tool}));!(Object(I.j)(o)&&Object(I.j)(s)&&o.interactive)||o.grabbable&&o.grabbableForEvent(e)||!o.grabbing||o.dragging||this._ungrabManipulatorBeforeDragging(o,s,e),Object(I.j)(o)&&o.interactive&&o.grabbable&&o.grabbableForEvent(e)&&!o.grabbing&&(this._grabbedManipulators.set(e.pointerId,{key:i,start:n}),1===this._grabbedManipulators.size&&(this._revertToActiveTool=t.activeTool,t.setActiveTool(i.tool)),o.grabbing=!0,o.events.emit("grab-changed",{action:"start",screenPoint:n}),r());break;case"pointer-up":this._handlePointerEnd(e,t);break;case"pointer-drag":if(!mc(e))break;var c=this._grabbedManipulators.get(e.pointerId),l=this._draggedManipulators.get(e.pointerId),u=Object(I.c)(c||l,(function(e){return e.key})),d=this._findManipulatorByKey(u,t.forEachTool);if(Object(I.i)(d))break;var h=dc(e);h.x=Object(m.e)(h.x,0,t.view.width),h.y=Object(m.e)(h.y,0,t.view.height);var f=Object(I.s)(c||l).start;switch(e.action){case"start":case"update":"update"!==e.action&&1!==this._grabbedManipulators.size||(d.dragging=!0,l?d.events.emit("drag",{action:"update",start:f,screenPoint:h}):d.events.emit("drag",{action:"start",start:f,screenPoint:h,pointerType:e.pointerType}),this._draggedManipulators.set(e.pointerId,{key:Object(I.s)(u),start:f}));break;case"end":d.dragging=!1,l&&d.events.emit("drag",{action:"end",start:f,screenPoint:h}),this._draggedManipulators.delete(e.pointerId),this._handlePointerEnd(e,t)}r();break;case"immediate-click":var p=dc(e),b=this._intersect(p,e.pointerType,t.forEachTool),v=this._findToolAndManipulatorByKey(b,t.forEachTool,yc);if(function(e){return!!e.native.shiftKey}(e)||t.forEachTool((function(e){if((!Object(I.j)(v)||v.tool!==e||!e.selectionManagementDisabled)&&e.manipulators){var t=!1;e.manipulators.forEach((function(e){var r=e.manipulator;r.selected&&(r.selected=!1,t=!0)})),t&&e.manipulatorSelectionChanged&&e.manipulatorSelectionChanged()}})),Object(I.i)(v))break;var y=v.manipulator,g=v.tool;if(!y.interactive)break;y.selectable&&!g.selectionManagementDisabled&&(y.selected=!y.selected,g.manipulatorSelectionChanged&&g.manipulatorSelectionChanged());var O=e.native.shiftKey;y.events.emit("immediate-click",{screenPoint:p,button:e.button,pointerType:e.pointerType,shiftKey:O,stopPropagation:r});break;case"click":var j=dc(e),_=this._intersect(j,e.pointerType,t.forEachTool),w=this._findManipulatorByKey(_,t.forEachTool);if(Object(I.i)(w)||!w.interactive)break;var x=e.native.shiftKey;w.events.emit(e.type,{screenPoint:j,button:e.button,pointerType:e.pointerType,shiftKey:x}),r();break;case"double-click":var k=dc(e),S=this._intersect(k,e.pointerType,t.forEachTool),T=this._findManipulatorByKey(S,t.forEachTool);if(Object(I.i)(T)||!T.interactive)break;var C=e.native.shiftKey;T.events.emit("double-click",{screenPoint:k,button:e.button,pointerType:e.pointerType,shiftKey:C,stopPropagation:r});break;case"immediate-double-click":var M=dc(e),P=this._intersect(M,e.pointerType,t.forEachTool),A=this._findManipulatorByKey(P,t.forEachTool);if(Object(I.i)(A)||!A.interactive)break;var E=e.native.shiftKey;A.events.emit("immediate-double-click",{screenPoint:M,button:e.button,pointerType:e.pointerType,shiftKey:E,stopPropagation:r})}this._updateCursor(t.forEachTool)}},{key:"_ungrabManipulatorBeforeDragging",value:function(e,t,r){var n=this;e.grabbing=!1,e.events.emit("grab-changed",{action:"end",screenPoint:dc(r)}),this._grabbedManipulators.forEach((function(r,i){var a=r.key;a.tool===t&&t.manipulators.findById(a.manipulatorId)===e&&n._grabbedManipulators.delete(i)}))}},{key:"_handlePointerEnd",value:function(e,t){var r=Object(I.c)(this._grabbedManipulators.get(e.pointerId),(function(e){return e.key})),n=this._findManipulatorByKey(r,t.forEachTool);if(Object(I.j)(n)&&!n.dragging){var i=Object(I.j)(t.creatingTool)&&t.creatingTool===Object(I.s)(r).tool;1!==this._grabbedManipulators.size||0!==this._draggedManipulators.size||i||(t.setActiveTool(this._revertToActiveTool),this._revertToActiveTool=null),n.grabbing&&(n.grabbing=!1,n.events.emit("grab-changed",{action:"end",screenPoint:dc(e)})),this._grabbedManipulators.delete(e.pointerId)}}},{key:"_cursorFromMap",value:function(e,t){var r=this,n=null;return Object(Qs.b)(e,(function(e){var i=e.key,a=r._findManipulatorByKey(i,t);return!!(Object(I.j)(a)&&a.interactive&&"cursor"in a&&a.cursor)&&(n=a.cursor,!0)})),n}},{key:"_updateCursor",value:function(e){this._grabbedManipulators.size>0?this._cursor=this._cursorFromMap(this._grabbedManipulators,e)||"grabbing":this._hoveredManipulators.size>0?this._cursor=this._cursorFromMap(this._hoveredManipulators,e)||"pointer":this._cursor=null}},{key:"clearPointers",value:function(e,t){var r=this,n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],i=arguments.length>3?arguments[3]:void 0,a=function(t){return t.tool===e&&(Object(I.i)(i)||t.manipulatorId===i)};this._grabbedManipulators.forEach((function(e,n){var i=e.key;if(a(i)){r._grabbedManipulators.delete(n);var o=r._findManipulatorByKey(i,t);Object(I.j)(o)&&(o.grabbing=!1,o.events.emit("grab-changed",{action:"end",screenPoint:null}))}})),this._draggedManipulators.forEach((function(e,n){var i=e.key;if(a(i)){r._draggedManipulators.delete(n);var o=r._findManipulatorByKey(i,t);Object(I.j)(o)&&(o.dragging=!1,o.events.emit("drag",{action:"cancel"}))}})),n&&this._hoveredManipulators.forEach((function(e,n){var i=e.key;if(a(i)){r._hoveredManipulators.delete(n);var o=r._findManipulatorByKey(i,t);Object(I.j)(o)&&(o.hovering=!1)}})),this._updateCursor(t)}},{key:"_intersect",value:function(e,t,r){var n=null;return r((function(r){if(null==r.manipulators||!lc(r))return!1;var i=r.manipulators.intersect(e,t);return!Object(I.i)(i)&&(n={manipulatorId:i.id,tool:r},!0)})),n}},{key:"updateHoveredStateFromKnownPointers",value:function(e){var t=this;this._pointerLocations.forEach((function(r,n){t._updateHoveredStateForPointerAtScreenPosition(Object(Z.e)(r.x,r.y),n,r.pointerType,e)}))}},{key:"handleHoverEvent",value:function(e,t){"pointer-up"!==e.type&&"immediate-click"!==e.type&&"pointer-move"!==e.type||!vc(e.pointerType)||this._updateHoveredStateForPointerAtScreenPosition(dc(e),e.pointerId,e.pointerType,t)}},{key:"_updateHoveredStateForPointerAtScreenPosition",value:function(e,t,r,n){var i=this._intersect(e,r,n),a=this._findManipulatorByKey(i,n),o=Object(I.c)(this._hoveredManipulators.get(t),(function(e){return e.key})),s=this._findManipulatorByKey(o,n);Object(I.j)(a)&&!a.interactive&&(a=null),s!==a&&(Object(I.j)(s)&&(s.hovering=!1),Object(I.j)(a)?(a.hovering=!0,this._hoveredManipulators.set(t,{key:Object(I.s)(i)})):this._hoveredManipulators.delete(t),this._updateCursor(n))}},{key:"_findManipulatorByKey",value:function(e,t){return this._findToolAndManipulatorByKey(e,t,yc)?yc.manipulator:null}},{key:"_findToolAndManipulatorByKey",value:function(e,t,r){return Object(I.i)(e)?null:(r.tool=null,r.manipulator=null,t((function(t){if(t!==e.tool||null==t.manipulators||!lc(t))return!1;var n=t.manipulators.findById(e.manipulatorId);return!!Object(I.j)(n)&&(r.manipulator=n,r.tool=t,!0)})),r.manipulator?r:null)}}]),e}();function vc(e){return"mouse"===e}function mc(e){return"mouse"!==e.pointerType||0===e.button}var yc={manipulator:null,tool:null},gc=bc,Oc=j.a.getLogger("esri.views.ToolViewManager"),jc="manipulators",_c="tools",wc=function(e){Object(f.a)(r,e);var t=Object(p.a)(r);function r(e){var n;return Object(c.a)(this,r),(n=t.call(this,e))._creatingTool=null,n._manipulatorState=new gc,n.tools=function(){var e=new V.a;return e.on("after-add",(function(e){var t=e.item;t.view&&t.view.ready&&t.attach()})),e.on("after-remove",(function(e){var t=e.item;cc(t,!1),t.destroyed||t.detach()})),e}(),n.cursor=null,n._forEachTool=function(e){if(!Object(I.j)(n._creatingTool)||!e(n._creatingTool)){var t,r=Object(i.a)(n.tools.items);try{for(r.s();!(t=r.n()).done;){if(e(t.value))return}}catch(a){r.e(a)}finally{r.f()}}},n}return Object(l.a)(r,[{key:"initialize",value:function(){var e=this;this.handles.add([this.view.on(nc,(function(t){e._handleInputEvent(t)}),pa.TOOL),this.tools.on("before-add",(function(t){var r=t.item;null==r||e.tools.includes(r)?t.preventDefault():null==r.created||r.created||(Oc.error("tools","Tool can not be added to view before it has been created"),t.preventDefault())})),this.tools.on("before-remove",(function(t){var r=t.item;e._manipulatorState.clearPointers(r,e._forEachTool)})),this.tools.on("change",(function(){e._refreshToolWatchers()}))])}},{key:"destroy",value:function(){this._forEachTool((function(e){return e.destroy()}))}},{key:"activeTool",set:function(e){var t=this;!Object(I.j)(e)||this.view.ready?(function(e,t,r){var n=e.activeTool;t!==n&&(Object(I.j)(n)&&n.deactivate&&n.deactivate(),r(t),Object(I.j)(t)&&t.activate&&t.activate())}(this,e,(function(r){t._set("activeTool",r),t._removeIncompleteTools(e),t._forEachTool((function(e){var r=Object(I.i)(t.activeTool)||e===t.activeTool;e.setEditableFlag&&e.setEditableFlag(1,r);var n=lc(e);!Object(I.i)(t.activeTool)&&n||t._manipulatorState.clearPointers(e,t._forEachTool,!n)})),t._updateCursor()})),this._creatingTool!==e&&this._rejectCreatingTool()):Oc.error("#activeTool=","cannot set active tool while view is not ready")}},{key:"updating",get:function(){return this.updatingHandles.updating||this.tools.some((function(e){return e.updating}))}},{key:"createTool",value:function(){var e=Object(s.a)(o.a.mark((function e(t,r,n){var i,a,c,l,u=this;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i="Tool creation was interrupted by another tool being created",e.next=3,this.updatingHandles.addPromise(Object(s.a)(o.a.mark((function e(){var a,s,c;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,u.view.whenReady();case 2:return Object(q.x)(n,i),a=Object(q.s)(n,(function(){return u.activeTool=null})),s=uc(r),c=new t(Object(ie.a)(Object(ie.a)({},s),{},{view:u.view})),e.next=6,c.whenCreationStarted();case 6:return Object(q.x)(n,i),e.abrupt("return",{abortHandle:a,tool:c});case 8:case"end":return e.stop()}}),e)})))());case 3:return a=e.sent,c=a.abortHandle,l=a.tool,this._rejectCreatingTool(i),this._creatingTool=l,l.attach(),this._refreshToolWatchers(),cc(l,!0),e.next=13,l.when();case 13:return Object(I.j)(c)&&c.remove(),this._creatingTool=null,Object(q.x)(n,i),this.tools.add(l),l instanceof de.a&&null!=l.completed&&Object(W.j)(l,"completed").then((function(){cc(l,!1)})),e.abrupt("return",l);case 19:case"end":return e.stop()}}),e,this)})));return function(t,r,n){return e.apply(this,arguments)}}()},{key:"attach",value:function(){var e=this;this._forEachTool((function(e){return e.attach()})),"3d"===this.view.type?this.handles.add([this.view.state.watch("camera",(function(){e.forEachManipulator((function(e){null!=e.onViewChange&&e.onViewChange()}))})),this.view.elevationProvider.on("elevation-change",(function(t){e.forEachManipulator((function(e){null!=e.onElevationChange&&e.onElevationChange(t)}))}))],jc):this.handles.add(this.view.watch("extent",(function(){e.forEachManipulator((function(e){null!=e.onViewChange&&e.onViewChange()}))})))}},{key:"detach",value:function(){this.activeTool=null,this._forEachTool((function(e){e.detach(),e.destroy()})),this.tools.removeAll(),this.handles.remove(jc)}},{key:"forEachManipulator",value:function(e){this._forEachTool((function(t){t.manipulators&&t.manipulators.forEach((function(r){var n=r.manipulator;return e(n,t)}))}))}},{key:"_handleInputEvent",value:function(e){var t=this,r=!1,n=Object(ie.a)(Object(ie.a)({},e),{},{stopPropagation:function(){r=!0,e.stopPropagation()}});Object(I.j)(this.activeTool)?this.activeTool.handleInputEvent&&this.activeTool.handleInputEvent(n):this._forEachTool((function(e){!r&&!1!==e.visible&&e.handleInputEvent&&e.handleInputEvent(n)})),!r&&"key-down"===e.type&&"Escape"===e.key&&this.activeTool&&(e.stopPropagation(),this.activeTool=null),this._manipulatorState.handleInputEvent(n,{forEachTool:this._forEachTool,activeTool:this.activeTool,setActiveTool:function(e){t.activeTool=e},creatingTool:this._creatingTool,view:this.view}),!r&&Object(I.j)(this.activeTool)&&this.activeTool.handleInputEventAfter&&this.activeTool.handleInputEventAfter(n),this._manipulatorState.handleHoverEvent(n,this._forEachTool),this._updateCursor()}},{key:"_refreshToolWatchers",value:function(){var e=this;this.handles.remove(_c),this._forEachTool((function(t){if(t instanceof de.a){var r=Object(W.e)(t,["cursor","visible","editable"],(function(){lc(t)||e._manipulatorState.clearPointers(t,e._forEachTool),e._updateCursor()}));e.handles.add(r,_c)}t.manipulators&&e.handles.add(t.manipulators.on("change",(function(r){r.removed.forEach((function(r){var n=r.id;e._manipulatorState.clearPointers(t,e._forEachTool,!0,n)})),e._manipulatorState.updateHoveredStateFromKnownPointers(e._forEachTool),e._updateCursor()})),_c)})),this._manipulatorState.updateHoveredStateFromKnownPointers(this._forEachTool),this._updateCursor()}},{key:"_updateCursor",value:function(){var e=null;this._forEachTool((function(t){return null!=t.cursor&&!1!==t.visible&&(e=t.cursor,!0)})),e||(e=this._manipulatorState.cursor),this._get("cursor")!==e&&this._set("cursor",e)}},{key:"_rejectCreatingTool",value:function(e){var t=this._creatingTool;Object(I.i)(t)||(this._manipulatorState.clearPointers(t,this._forEachTool),t.rejectCreation&&t.rejectCreation(Object(q.f)(e)),cc(t,!1),"destroyed"!==t.toolState&&t.destroy(),this._creatingTool=null,this._refreshToolWatchers())}},{key:"_removeIncompleteTools",value:function(e){var t=this;this.tools.filter((function(t){return(Object(I.i)(e)||t!==e)&&null!=t.completed&&!t.completed})).forEach((function(e){t.tools.remove(e)}))}}]),r}(je.a);Object(b.a)([Object(y.b)({constructOnly:!0,nonNullable:!0})],wc.prototype,"view",void 0),Object(b.a)([Object(y.b)({value:null})],wc.prototype,"activeTool",null),Object(b.a)([Object(y.b)({readOnly:!0,type:V.a})],wc.prototype,"tools",void 0),Object(b.a)([Object(y.b)({readOnly:!0})],wc.prototype,"cursor",void 0),Object(b.a)([Object(y.b)({readOnly:!0})],wc.prototype,"updating",null);var xc=wc=Object(b.a)([Object(w.a)("esri.views.ToolViewManager")],wc),kc=function(e){Object(f.a)(r,e);var t=Object(p.a)(r);function r(e){var n;return Object(c.a)(this,r),(n=t.call(this)).nativeIndex=null,n._detectedDeviceType="unknown","standard"===e.mapping?n._detectedDeviceType="standard":Sc.test(e.id)?n._detectedDeviceType="spacemouse":n._detectedDeviceType="unknown",n.nativeIndex=e.index,n}return Object(l.a)(r,[{key:"native",get:function(){return(navigator.getGamepads?navigator.getGamepads():[])[this.nativeIndex]}},{key:"deviceType",get:function(){return this._detectedDeviceType}},{key:"axisThreshold",get:function(){return Tc[this.deviceType]}}]),r}(de.a);Object(b.a)([Object(y.b)({nonNullable:!0,readOnly:!0})],kc.prototype,"nativeIndex",void 0),Object(b.a)([Object(y.b)({type:String,readOnly:!0})],kc.prototype,"deviceType",null),Object(b.a)([Object(y.b)({type:Number,readOnly:!0})],kc.prototype,"axisThreshold",null),kc=Object(b.a)([Object(w.a)("esri.views.input.gamepad.GamepadInputDevice")],kc);var Sc=new RegExp("^(3dconnexion|space(mouse|navigator|pilot|explorer))","i"),Tc={standard:.15,spacemouse:.025,unknown:0},Cc=kc,Mc=function(e){Object(f.a)(r,e);var t=Object(p.a)(r);function r(){var e;Object(c.a)(this,r);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return(e=t.call.apply(t,[this].concat(i))).devices=new V.a,e.enabledFocusMode="document",e}return r}(de.a);Object(b.a)([Object(y.b)({type:V.a.ofType(Cc),readOnly:!0})],Mc.prototype,"devices",void 0),Object(b.a)([Object(y.b)({type:["document","view","none"]})],Mc.prototype,"enabledFocusMode",void 0);var Pc=Mc=Object(b.a)([Object(w.a)("esri.views.input.gamepad.GamepadSettings")],Mc),Ac=function(e){Object(f.a)(r,e);var t=Object(p.a)(r);function r(){var e;return Object(c.a)(this,r),(e=t.apply(this,arguments)).gamepad=new Pc,e}return r}(de.a);Object(b.a)([Object(y.b)({readOnly:!0})],Ac.prototype,"gamepad",void 0);var Ec=Ac=Object(b.a)([Object(w.a)("esri.views.input.Input")],Ac),Rc=function(e){Object(f.a)(r,e);var t=Object(p.a)(r);function r(e){var n;return Object(c.a)(this,r),(n=t.call(this,e)).enabled=!0,n.device=null,n.mode="pan",n.tiltDirection="forward-down",n.velocityFactor=1,n}return r}(de.a);Object(b.a)([Object(y.b)({type:Boolean,nonNullable:!0})],Rc.prototype,"enabled",void 0),Object(b.a)([Object(y.b)({type:Cc})],Rc.prototype,"device",void 0),Object(b.a)([Object(y.b)({type:["pan","zoom"],nonNullable:!0})],Rc.prototype,"mode",void 0),Object(b.a)([Object(y.b)({type:["forward-down","forward-up"],nonNullable:!0})],Rc.prototype,"tiltDirection",void 0),Object(b.a)([Object(y.b)({type:Number,nonNullable:!0})],Rc.prototype,"velocityFactor",void 0);var Ic=Rc=Object(b.a)([Object(w.a)("esri.views.navigation.gamepad.GamepadSettings")],Rc),Dc=function(e){Object(f.a)(r,e);var t=Object(p.a)(r);function r(e){var n;return Object(c.a)(this,r),(n=t.call(this,e)).browserTouchPanEnabled=!0,n.gamepad=new Ic,n.momentumEnabled=!0,n.mouseWheelZoomEnabled=!0,n}return r}(de.a);Object(b.a)([Object(y.b)({type:Boolean})],Dc.prototype,"browserTouchPanEnabled",void 0),Object(b.a)([Object(y.b)({type:Ic,nonNullable:!0})],Dc.prototype,"gamepad",void 0),Object(b.a)([Object(y.b)({type:Boolean})],Dc.prototype,"momentumEnabled",void 0),Object(b.a)([Object(y.b)({type:Boolean})],Dc.prototype,"mouseWheelZoomEnabled",void 0);var Fc,Lc=Dc=Object(b.a)([Object(w.a)("esri.views.navigation.Navigation")],Dc),zc=r(406),Vc=j.a.getLogger("esri.views.support.DefaultsFromMap"),Nc=Fc=function(e){Object(f.a)(n,e);var t=Object(p.a)(n);function n(){var e;return Object(c.a)(this,n),(e=t.apply(this,arguments))._handles=new oe.a,e._waitTask=null,e._extentProjectController=null,e._spatialReferenceCandidates=null,e._extentCandidates=null,e.logDebugInformation=!1,e.isSpatialReferenceDone=!1,e.isTileInfoDone=!1,e.isHeightModelInfoSearching=!1,e.spatialReference=null,e.extent=null,e.heightModelInfo=null,e.vcsWkid=null,e.latestVcsWkid=null,e.mapCollectionPaths=Fc.DefaultMapCollectionPaths.slice(),e.tileInfo=null,e}return Object(l.a)(n,[{key:"initialize",value:function(){var e=this;this.watch("mapCollectionPaths",(function(){e._running&&(e.reset(),e.start())}))}},{key:"destroy",value:function(){this._set("view",null),this._handles&&(this._handles.destroy(),this._handles=null),this._cancelLoading()}},{key:"_running",get:function(){return!!(this._handles&&this._handles.size>0)}},{key:"reset",value:function(){this._handles.removeAll(),this._set("isSpatialReferenceDone",!1),this._set("isTileInfoDone",!1),this._set("isHeightModelInfoSearching",!1),this._set("spatialReference",null),this._set("extent",null),this._set("heightModelInfo",null),this._set("vcsWkid",null),this._set("latestVcsWkid",null),this._set("tileInfo",null),this._spatialReferenceCandidates=null,this._extentCandidates=null}},{key:"start",value:function(){var e=this;this._handles.removeAll();var t,r=this._updateLayerChange.bind(this),n=Object(i.a)(this.mapCollectionPaths);try{for(n.s();!(t=n.n()).done;){var a=t.value;this._handles.add(Object(W.b)(this.view,"map.".concat(a),"change",r,r,r,!0))}}catch(o){n.e(o)}finally{n.f()}this._handles.add(Object(W.f)(this,"isSpatialReferenceDone",(function(){return e._updateTileInfo()}),!0))}},{key:"_ownerNameFromCollectionName",value:function(e){var t=e.lastIndexOf(".");return-1===t?"view":"view."+e.slice(0,t)}},{key:"_ensureLoadedOwnersFromCollectionName",value:function(e){for(var t,r=this._ownerNameFromCollectionName(e).split("."),n=0;n<r.length&&(t=this.get(r.slice(0,n+1).join(".")));n++)if(t.load&&!t.isFulfilled())return{collectionName:e,owner:null,loading:t.load().catch((function(){}))};return{collectionName:e,owner:t}}},{key:"_cancelLoading",value:function(){this._waitTask=null,this._extentProjectController&&(this._extentProjectController.abort(),this._extentProjectController=null)}},{key:"_updateWhen",value:function(e){var t=this,r=!0,n=!1,i=e.catch((function(){})).then((function(){r?n=!0:i===t._waitTask&&t._update()}));return r=!1,n||(this._waitTask=i),n}},{key:"_updateLayerChange",value:function(){this.isSpatialReferenceDone&&!this.spatialReference&&this._set("isSpatialReferenceDone",!1),this._update()}},{key:"_update",value:function(){var e=this;if(this._cancelLoading(),this.view){if(!this.isSpatialReferenceDone){this._debugLog("Starting search for spatial reference...");var t=this._processMapCollections((function(t){return e._processSpatialReferenceSource(t)}));if(this._debugLog("Search ended with status '".concat(Bc(t),"'")),0!==t){var r=null,n=this._spatialReferenceCandidates;if(!n||n.length<1?(r=this.defaultSpatialReference,this._debugLog("No spatial reference found, locking to default (".concat(Uc(r),")"))):(this.defaultSpatialReference&&n.length>1&&n.findIndex((function(t){return t.equals(e.defaultSpatialReference)}))>-1&&(n=[this.defaultSpatialReference]),r=n[0],this._debugLog("Locking to ".concat(Uc(r)))),this._set("spatialReference",r),r)if(this.extent)this._set("isSpatialReferenceDone",!0);else{var i=this.logDebugInformation;this.logDebugInformation=!1,this._processMapCollections((function(t){return e._findExtent(t,r)})),this.logDebugInformation=i,this._projectExtentCandidate().catch((function(){})).then((function(){return e._set("isSpatialReferenceDone",!0)}))}else this._set("isSpatialReferenceDone",!0)}}if(null==this.heightModelInfo&&this.view.isHeightModelInfoRequired){this._debugLog("Starting search for height model info...");var a=this._processMapCollections((function(t){return e._processHeightModelInfoSource(t)}),(function(e){return Object(zc.b)(e)}));this._debugLog("Search ended with status ".concat(Bc(a))),this._set("isHeightModelInfoSearching",0===a)}this._updateTileInfo()}}},{key:"_processMapCollections",value:function(e,t){var r=this;this._preloadMapCollections(t);var n=2;return this._forAllMapCollectionSources((function(e){if(2!==n)return!1;var t=e.collectionName;return r._debugLog("Processing collection ".concat(t,"...")),!(e.loading&&!r._updateWhen(e.loading))||(r._debugLog("Collection ".concat(e.collectionName," owner is loading -> wait")),n=0,!1)}),(function(i){return 2===n&&(null==t||t(i)?!i.load||i.isFulfilled()||r._updateWhen(i.load())?!((!i.load||i.isResolved())&&e(i))||(n=1,!1):(r._debugLog("Source ".concat(i.id," is loading -> wait")),n=0,!1):(r._debugLog("Source ".concat(i.id," is skipped due to predicate")),!1))})),n}},{key:"_preloadMapCollections",value:function(e){var t=this,r=10,n=this.logDebugInformation;this.logDebugInformation=!1,this._forAllMapCollectionSources((function(){return!0}),(function(i){return 0!==r&&(!(null!=e&&!e(i))&&(i.load&&!i.isFulfilled()&&(t.logDebugInformation=n,t._debugLog("Pre-loading source ".concat(i.id)),t.logDebugInformation=!1,i.load().catch((function(){})),r--),!0))})),this.logDebugInformation=n}},{key:"_forAllMapCollectionSources",value:function(e,t){var r,n=Object(i.a)(this.mapCollectionPaths);try{for(n.s();!(r=n.n()).done;){var a=r.value,o="map.".concat(a),s=this._ensureLoadedOwnersFromCollectionName(o);if(!1!==e(s)){var c=s.owner;if(!c||c.isRejected&&c.isRejected())this._debugLog("Collection ".concat(o," owner is invalid or rejected -> skip"));else{var l=this.view.get(o);l?this._forEachSource(l,t):this._debugLog("Collection ".concat(o," does not exist -> skip"))}}}}catch(u){n.e(u)}finally{n.f()}}},{key:"_forEachSource",value:function(e,t){var r,n=Object(i.a)(e.items);try{for(n.s();!(r=n.n()).done;){var a=r.value;!1!==t(a)&&"layers"in a&&a.layers&&this._forEachSource(a.layers,t)}}catch(o){n.e(o)}finally{n.f()}}},{key:"_processSpatialReferenceSource",value:function(e){var t=this._getSupportedSpatialReferences(e);return 0!==t.length&&(this._spatialReferenceCandidates?(t=Object(Fs.h)(t,this._spatialReferenceCandidates,(function(e,t){return e.equals(t)}))).length>0?this._spatialReferenceCandidates=t:this._debugLog("Layer ".concat(e.id," is ignored because its supported spatial\n          references are not compatible with the previous candidates")):this._spatialReferenceCandidates=t,1===this._spatialReferenceCandidates.length)}},{key:"_findExtent",value:function(e,t){var r="fullExtents"in e&&e.fullExtents||(e.fullExtent?[e.fullExtent]:[]),n=r.find((function(e){return e.spatialReference.equals(t)}));if(n)return this._set("extent",n),!0;if(this._getSupportedSpatialReferences(e).length>0){var i=r.map((function(t){return{extent:t,layer:e}})),a=this._extentCandidates||[];this._extentCandidates=a.concat(i)}return!1}},{key:"_projectExtentCandidate",value:function(){var e=Object(s.a)(o.a.mark((function e(){var t,n,i,a,s;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._extentCandidates&&this._extentCandidates.length){e.next=2;break}return e.abrupt("return");case 2:if(t=this.spatialReference,!(n=this._extentCandidates.find((function(e){return Object(re.a)(e.extent.spatialReference,t)})))){e.next=7;break}this._set("extent",Object(re.d)(n.extent,t)),e.next=22;break;case 7:return i=this._extentCandidates[0],this._extentProjectController=Object(q.e)(),e.next=11,Promise.resolve().then(r.bind(null,576));case 11:return a=e.sent,e.prev=12,e.next=15,a.projectGeometry(i.extent,t,i.layer.portalItem,this._extentProjectController.signal);case 15:s=e.sent,this._set("extent",s),e.next=21;break;case 19:e.prev=19,e.t0=e.catch(12);case 21:this._extentProjectController=null;case 22:case"end":return e.stop()}}),e,this,[[12,19]])})));return function(){return e.apply(this,arguments)}}()},{key:"_getSupportedSpatialReferences",value:function(e){var t=this,r="supportedSpatialReferences"in e&&e.supportedSpatialReferences||(e.spatialReference?[e.spatialReference]:[]);if(0===r.length)return this._debugLog("Layer ".concat(e.id," is ignored because it does not have any spatial references")),[];var n=r.filter((function(r){return t.view.isSpatialReferenceSupported(r,e,(function(e){return t._debugLog(e)}))}));return 0===n.length?this._debugLog("Layer ".concat(e.id," has spatial references but none of them are supported (or layer doesn't require locking)")):this._debugLog("Layer ".concat(e.id," has spatial references. Resulting candidate set: ").concat(n.map(Uc).join(", "))),n}},{key:"_processHeightModelInfoSource",value:function(e){var t=Object(zc.a)(e);return!!t&&(this._set("heightModelInfo",t),this._set("isHeightModelInfoSearching",!1),e.spatialReference&&(this._set("vcsWkid",e.spatialReference.vcsWkid),this._set("latestVcsWkid",e.spatialReference.latestVcsWkid)),!0)}},{key:"_updateTileInfo",value:function(){if(null==this.tileInfo)if(this.view.isTileInfoRequired()){if(this.isSpatialReferenceDone){var e=this.get("view.map");if(e){var t=e.basemap,r=e.get("layers.0"),n=null;if(t&&"failed"!==t.loadStatus){if(!t.loaded)return this._updateWhen(t.load()),void this._debugLog("updateTileInfo: basemap still loading");var i=t&&t.get("baseLayers.0");if(i&&"failed"!==i.loadStatus){if(!i.loaded)return this._updateWhen(i.load()),void this._debugLog("updateTileInfo: first basemap layer still loading");n="tileInfo"in i&&i.tileInfo}else{if(!r||"failed"===r.loadStatus)return this._debugLog("updateTileInfo: no tileInfo"),void this._set("isTileInfoDone",!0);if(!r.loaded)return this._updateWhen(r.load()),void this._debugLog("updateTileInfo: first operational layer still loading");n="tileInfo"in r&&r.tileInfo}}else if(r&&"failed"!==r.loadStatus){if(!r.loaded)return this._updateWhen(r.load()),void this._debugLog("updateTileInfo: first operational layer still loading");n="tileInfo"in r&&r.tileInfo}n&&!n.spatialReference.equals(this.spatialReference)&&(n=null),this._debugLog("updateTileInfo: setting ".concat(n)),this._set("tileInfo",n),this._set("isTileInfoDone",!0)}else this._debugLog("updateTileInfo: no map")}}else this._set("isTileInfoDone",!0)}},{key:"_debugLog",value:function(e){this.logDebugInformation&&Vc.info(e)}}]),n}(de.a);function Uc(e){return e?JSON.stringify(e.toJSON()):"undefined"}function Bc(e){switch(e){case 0:return"Waiting";case 1:return"Found";case 2:return"Exhausted"}}Nc.DefaultMapCollectionPaths=["basemap.baseLayers","layers","ground.layers","basemap.referenceLayers"],Object(b.a)([Object(y.b)()],Nc.prototype,"logDebugInformation",void 0),Object(b.a)([Object(y.b)({readOnly:!0})],Nc.prototype,"isSpatialReferenceDone",void 0),Object(b.a)([Object(y.b)({readOnly:!0})],Nc.prototype,"isTileInfoDone",void 0),Object(b.a)([Object(y.b)({readOnly:!0})],Nc.prototype,"isHeightModelInfoSearching",void 0),Object(b.a)([Object(y.b)({constructOnly:!0})],Nc.prototype,"view",void 0),Object(b.a)([Object(y.b)({readOnly:!0})],Nc.prototype,"spatialReference",void 0),Object(b.a)([Object(y.b)({readOnly:!0})],Nc.prototype,"extent",void 0),Object(b.a)([Object(y.b)({readOnly:!0})],Nc.prototype,"heightModelInfo",void 0),Object(b.a)([Object(y.b)({readOnly:!0})],Nc.prototype,"vcsWkid",void 0),Object(b.a)([Object(y.b)({readOnly:!0})],Nc.prototype,"latestVcsWkid",void 0),Object(b.a)([Object(y.b)()],Nc.prototype,"mapCollectionPaths",void 0),Object(b.a)([Object(y.b)()],Nc.prototype,"defaultSpatialReference",void 0),Object(b.a)([Object(y.b)({readOnly:!0})],Nc.prototype,"tileInfo",void 0);var Gc,qc=Nc=Fc=Object(b.a)([Object(w.a)("esri.views.support.DefaultsFromMap")],Nc),Hc=j.a.getLogger("esri.views.View"),Wc=Gc=function(e){Object(f.a)(r,e);var t=Object(p.a)(r);function r(e){var n;return Object(c.a)(this,r),(n=t.call(this,e))._userSpatialReference=null,n._cursor=null,n.allLayerViews=new Vs.a({getCollections:function(){var e,t,r;return[null==(e=n.basemapView)?void 0:e.baseLayerViews,null==(t=n.groundView)?void 0:t.layerViews,n.layerViews,null==(r=n.basemapView)?void 0:r.referenceLayerViews]},getChildrenFunction:function(e){return e.layerViews}}),n.groundView=null,n.animation=null,n.basemapView=null,n.defaultsFromMap=new qc({view:Object(u.a)(n)}),n.fatalError=null,n.extent=null,n.graphics=new Hs.a,n.navigating=!1,n.layerViews=new V.a,n.magnifier=new Ks,n.padding={left:0,top:0,right:0,bottom:0},n.ready=!1,n.spatialReferenceWarningDelay=1e3,n.supportsGround=!0,n.timeExtent=null,n.type=null,n.scale=null,n.updating=!1,n.initialExtentRequired=!0,n.renderContext=null,n.input=new Ec,n.navigation=new Lc,n.layerViewManager=null,n.refreshManager=null,n.isHeightModelInfoRequired=!1,n.width=null,n.height=null,n.resizing=!1,n.suspended=!1,n.viewEvents=new oc(Object(u.a)(n)),n.persistableViewModels=new V.a,n._isValid=!1,n._readyCycleForced=!1,n.handles.add(n.watch("preconditionsReady",(function(e){e?(n._currentSpatialReference=n.spatialReference,Gc.views.add(Object(u.a)(n))):(n._currentSpatialReference=null,Gc.views.remove(Object(u.a)(n))),n.notifyChange("spatialReference"),!e&&n.ready?(n.layerViewManager.clear(),n.toolViewManager.detach(),n._teardown()):e&&!n.ready&&(n._startup(),n.toolViewManager.attach())}),!0)),n}return Object(l.a)(r,[{key:"initialize",value:function(){var e,t=this;this.addResolvingPromise(this.validate().then((function(){return t._isValid=!0,Object(W.j)(t,"ready")}))),this.basemapView=new Ws({view:this}),this.layerViewManager=new $s({view:this,layerViewImporter:{importLayerView:function(e){return t.importLayerView(e)},hasLayerViewModule:function(e){return t.hasLayerViewModule(e)}},supportsGround:this.supportsGround}),this.refreshManager=new rc({view:this}),this.toolViewManager=new xc({view:this}),this._resetInitialViewPropertiesFromContent(),Object(W.a)(this.defaultsFromMap,"isSpatialReferenceDone",(function(r){var n=!!(t.map&&t.map.allLayers.length>0);if(r&&!t.spatialReference&&n||!e){if(r&&!t.spatialReference&&n&&!e){var i=e=Object(q.a)(t.spatialReferenceWarningDelay);e.then((function(){i===e&&Hc.warn("#spatialReference","no spatial reference could be derived from the currently added map layers")})).catch((function(){}))}}else e=null}),!0)}},{key:"destroy",value:function(){if(!this.destroyed){this.viewEvents.destroy(),this.allLayerViews.destroy(),this.navigation&&(this.navigation.destroy(),this._set("navigation",null)),this.graphics.destroy(),this.graphics=null,this.handles.remove("defaultsFromMap"),this.defaultsFromMap.destroy(),this._set("defaultsFromMap",null),this.toolViewManager.destroy(),this.toolViewManager=null,this.refreshManager.destroy(),this.refreshManager=null,this.layerViewManager.destroy(),this.layerViewManager=null,this.basemapView.destroy(),this.basemapView=null,this.invalidate(),this._emitter.clear(),this.handles.removeAll();var e=this.map;this.map=null,null==e||e.destroy()}}},{key:"_startup",value:function(){this._set("ready",!0)}},{key:"_teardown",value:function(){this._set("ready",!1)}},{key:"whenReady",value:function(){return Promise.resolve(this)}},{key:"toMap",value:function(){return Hc.error("#toMap()","Not implemented on this instance of View"),null}},{key:"heightModelInfo",get:function(){return this.getDefaultHeightModelInfo()}},{key:"interacting",get:function(){return this.navigating}},{key:"preconditionsReady",get:function(){return!!(!this.fatalError&&this._isValid&&!this._readyCycleForced&&this.map&&(!Ns.a.isLoadable(this.map)||this.map.loaded)&&0!==this.width&&0!==this.height&&this.spatialReference&&this.isSpatialReferenceSupported(this.spatialReference)&&(this._currentSpatialReference||!this.initialExtentRequired||this.initialExtent||this.defaultsFromMap&&this.defaultsFromMap.isSpatialReferenceDone)&&this.defaultsFromMap&&this.defaultsFromMap.isTileInfoDone)}},{key:"map",set:function(e){var t;e!==this._get("map")&&(null!=(t=e)&&t.destroyed&&(Hc.warn("#map","The provided map is already destroyed",{map:e}),e=null),Ns.a.isLoadable(e)&&e.load().catch((function(){})),this.initialized&&(this.forceReadyCycle(),this._resetInitialViewPropertiesFromContent()),this._set("map",e))}},{key:"spatialReference",get:function(){var e=this._userSpatialReference||this._currentSpatialReference||this.getDefaultSpatialReference()||null;return e&&this.isHeightModelInfoRequired&&this.defaultsFromMap&&((e=e.clone()).vcsWkid=this.defaultsFromMap.vcsWkid,e.latestVcsWkid=this.defaultsFromMap.latestVcsWkid),e},set:function(e){this._userSpatialReference=e,this._set("spatialReference",e)}},{key:"stationary",get:function(){return!this.animation&&!this.navigating&&!this.resizing}},{key:"initialExtent",get:function(){return this.defaultsFromMap&&this.defaultsFromMap.extent}},{key:"cursor",get:function(){var e=this.toolViewManager?this.toolViewManager.cursor:null;return Object(I.j)(e)?e:this._cursor||"default"},set:function(e){this._cursor=e,this.notifyChange("cursor")}},{key:"size",get:function(){return[this.width,this.height]}},{key:"whenLayerView",value:function(e){return this.layerViewManager.whenLayerView(e)}},{key:"getDefaultSpatialReference",value:function(){return this.get("defaultsFromMap.spatialReference")}},{key:"getDefaultHeightModelInfo",value:function(){return this.get("map.supportsHeightModelInfo")&&this.get("map.heightModelInfo")||this.get("defaultsFromMap.heightModelInfo")||null}},{key:"importLayerView",value:function(e){throw new U.a("importLayerView() not implemented")}},{key:"hasLayerViewModule",value:function(e){return!1}},{key:"validate",value:function(){var e=Object(s.a)(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"invalidate",value:function(){this._isValid=!1}},{key:"isSpatialReferenceSupported",value:function(e,t,r){return!0}},{key:"isTileInfoRequired",value:function(){return!1}},{key:"when",value:function(e,t){return this.isResolved()&&!this.ready&&Hc.warn("#when()",'Calling view.when() while the view is no longer ready but was already resolved once will resolve immediately. Use watchUtils.whenOnce(view, "ready").then(...) instead.'),Object(d.a)(Object(h.a)(r.prototype),"when",this).call(this,e,t)}},{key:"forceReadyCycle",value:function(){var e=this;this.ready&&(this._readyCycleForced=!0,Object(W.h)(this,"preconditionsReady",(function(){return e._readyCycleForced=!1})))}},{key:"createTool",value:function(e,t,r){return this.toolViewManager.createTool(e,t,r)}},{key:"tryFatalErrorRecovery",value:function(){this.fatalError=null}},{key:"_resetInitialViewPropertiesFromContent",value:function(){var e=this;if(this.defaultsFromMap){var t=function(){return e.defaultsFromMap&&e.defaultsFromMap.start()};this.defaultsFromMap.reset(),this._currentSpatialReference=null,this.notifyChange("spatialReference"),this.handles.remove("defaultsFromMap"),this.handles.add([Object(W.e)(this,"spatialReference",(function(e,r){Object(qs.c)(e,r)||t()})),Object(W.e)(this,"initialExtentRequired",t),Object(H.b)(t)],"defaultsFromMap")}}}]),r}(Object(je.b)(Ii.a.EventedMixin(Object(Us.b)(de.a))));Wc.views=new V.a,Object(b.a)([Object(ye.a)("toolViewManager.activeTool")],Wc.prototype,"activeTool",void 0),Object(b.a)([Object(y.b)({readOnly:!0})],Wc.prototype,"allLayerViews",void 0),Object(b.a)([Object(y.b)()],Wc.prototype,"groundView",void 0),Object(b.a)([Object(y.b)()],Wc.prototype,"animation",void 0),Object(b.a)([Object(y.b)()],Wc.prototype,"basemapView",void 0),Object(b.a)([Object(y.b)()],Wc.prototype,"defaultsFromMap",void 0),Object(b.a)([Object(y.b)()],Wc.prototype,"fatalError",void 0),Object(b.a)([Object(y.b)({type:Bs.a})],Wc.prototype,"extent",void 0),Object(b.a)([Object(y.b)(Object(Hs.b)())],Wc.prototype,"graphics",void 0),Object(b.a)([Object(y.b)({readOnly:!0,type:Y.a,dependsOn:["map.heightModelInfo?","defaultsFromMap.heightModelInfo"]})],Wc.prototype,"heightModelInfo",null),Object(b.a)([Object(y.b)({readOnly:!0})],Wc.prototype,"interacting",null),Object(b.a)([Object(y.b)({readOnly:!0})],Wc.prototype,"navigating",void 0),Object(b.a)([Object(y.b)({readOnly:!0,dependsOn:["fatalError","_isValid","_readyCycleForced","map","map.loaded?","width","height","spatialReference","_currentSpatialReference","initialExtentRequired","initialExtent","defaultsFromMap.isSpatialReferenceDone","defaultsFromMap.isTileInfoDone"]})],Wc.prototype,"preconditionsReady",null),Object(b.a)([Object(y.b)({type:V.a,readOnly:!0})],Wc.prototype,"layerViews",void 0),Object(b.a)([Object(y.b)({type:Ks})],Wc.prototype,"magnifier",void 0),Object(b.a)([Object(y.b)({value:null,type:Ls.a})],Wc.prototype,"map",null),Object(b.a)([Object(y.b)()],Wc.prototype,"padding",void 0),Object(b.a)([Object(y.b)({readOnly:!0})],Wc.prototype,"ready",void 0),Object(b.a)([Object(y.b)({type:Gs.a})],Wc.prototype,"spatialReference",null),Object(b.a)([Object(y.b)()],Wc.prototype,"spatialReferenceWarningDelay",void 0),Object(b.a)([Object(y.b)()],Wc.prototype,"stationary",null),Object(b.a)([Object(y.b)({readOnly:!0})],Wc.prototype,"supportsGround",void 0),Object(b.a)([Object(y.b)({type:zs.a})],Wc.prototype,"timeExtent",void 0),Object(b.a)([Object(ye.a)("toolViewManager.tools")],Wc.prototype,"tools",void 0),Object(b.a)([Object(y.b)()],Wc.prototype,"toolViewManager",void 0),Object(b.a)([Object(y.b)({readOnly:!0})],Wc.prototype,"type",void 0),Object(b.a)([Object(y.b)({type:Number})],Wc.prototype,"scale",void 0),Object(b.a)([Object(y.b)({readOnly:!0})],Wc.prototype,"updating",void 0),Object(b.a)([Object(y.b)({readOnly:!0})],Wc.prototype,"initialExtentRequired",void 0),Object(b.a)([Object(y.b)({readOnly:!0,type:Bs.a})],Wc.prototype,"initialExtent",null),Object(b.a)([Object(y.b)()],Wc.prototype,"cursor",null),Object(b.a)([Object(y.b)()],Wc.prototype,"renderContext",void 0),Object(b.a)([Object(y.b)({readOnly:!0})],Wc.prototype,"input",void 0),Object(b.a)([Object(y.b)({type:Lc,nonNullable:!0})],Wc.prototype,"navigation",void 0),Object(b.a)([Object(y.b)()],Wc.prototype,"layerViewManager",void 0),Object(b.a)([Object(y.b)()],Wc.prototype,"width",void 0),Object(b.a)([Object(y.b)()],Wc.prototype,"height",void 0),Object(b.a)([Object(y.b)({readOnly:!0})],Wc.prototype,"resizing",void 0),Object(b.a)([Object(y.b)({value:null,readOnly:!0})],Wc.prototype,"size",null),Object(b.a)([Object(y.b)({readOnly:!0})],Wc.prototype,"suspended",void 0),Object(b.a)([Object(y.b)({readOnly:!0})],Wc.prototype,"viewEvents",void 0),Object(b.a)([Object(y.b)({readOnly:!0})],Wc.prototype,"persistableViewModels",void 0),Object(b.a)([Object(y.b)()],Wc.prototype,"_isValid",void 0),Object(b.a)([Object(y.b)()],Wc.prototype,"_readyCycleForced",void 0),Object(b.a)([Object(y.b)()],Wc.prototype,"_currentSpatialReference",void 0);var Qc=Wc=Gc=Object(b.a)([Object(w.a)("esri.views.View")],Wc),Zc=function(e){Object(f.a)(r,e);var t=Object(p.a)(r);function r(e){var n;return Object(c.a)(this,r),(n=t.call(this,e)).state="running",n.target=null,n}return Object(l.a)(r,[{key:"initialize",value:function(){var e=this;this.addResolvingPromise(new Promise((function(t,r){return e._dfd={resolve:t,reject:r}})))}},{key:"done",get:function(){return"finished"===this.state||"stopped"===this.state}},{key:"stop",value:function(){"stopped"!==this.state&&"finished"!==this.state&&(this._set("state","stopped"),this._dfd.reject(new U.a("ViewAnimation stopped")))}},{key:"finish",value:function(){"stopped"!==this.state&&"finished"!==this.state&&(this._set("state","finished"),this._dfd.resolve())}},{key:"update",value:function(e,t){t||(t=Object(q.q)(e)?"waiting-for-target":"running"),this._set("target",e),this._set("state",t)}}]),r}(Us.a);Object(b.a)([Object(y.b)({readOnly:!0})],Zc.prototype,"done",null),Object(b.a)([Object(y.b)({readOnly:!0,type:String})],Zc.prototype,"state",void 0),Object(b.a)([Object(y.b)()],Zc.prototype,"target",void 0),Zc=Object(b.a)([Object(w.a)("esri.views.ViewAnimation")],Zc),(Zc||(Zc={})).State={RUNNING:"running",STOPPED:"stopped",FINISHED:"finished",WAITING_FOR_TARGET:"waiting-for-target"};var Xc=Zc;function Yc(e){return"global"===e?1:2}var $c=function(){return r.e(84).then(r.bind(null,1184))},Jc=function(){return Promise.resolve().then(r.bind(null,679))},Kc={"base-dynamic":function(){return Promise.all([r.e(8),r.e(180)]).then(r.bind(null,1047))},"base-elevation":Jc,"base-tile":$c,"bing-maps":$c,"building-scene":function(){return Promise.all([r.e(1),r.e(2),r.e(3),r.e(11),r.e(46)]).then(r.bind(null,1177))},csv:function(){return Promise.all([r.e(1),r.e(2),r.e(3),r.e(5),r.e(56)]).then(r.bind(null,1048))},"direct-line-measurement":function(){return Promise.all([r.e(4),r.e(22),r.e(90)]).then(r.bind(null,1175))},"area-measurement":function(){return Promise.all([r.e(4),r.e(22),r.e(88)]).then(r.bind(null,1167))},elevation:Jc,feature:function(){return Promise.all([r.e(1),r.e(2),r.e(3),r.e(5),r.e(57)]).then(r.bind(null,1049))},geojson:function(){return Promise.all([r.e(1),r.e(2),r.e(3),r.e(5),r.e(58)]).then(r.bind(null,1050))},graphics:function(){return Promise.all([r.e(3),r.e(26),r.e(86)]).then(r.bind(null,1051))},group:function(){return r.e(216).then(r.bind(null,1052))},imagery:function(){return Promise.all([r.e(8),r.e(143)]).then(r.bind(null,1185))},"integrated-mesh":function(){return Promise.all([r.e(3),r.e(11),r.e(51)]).then(r.bind(null,1053))},"line-of-sight":function(){return r.e(76).then(r.bind(null,1176))},"map-image":function(){return Promise.all([r.e(8),r.e(67)]).then(r.bind(null,1186))},"ogc-feature":function(){return Promise.all([r.e(1),r.e(2),r.e(3),r.e(5),r.e(59)]).then(r.bind(null,1187))},"open-street-map":$c,"point-cloud":function(){return Promise.all([r.e(11),r.e(28),r.e(71)]).then(r.bind(null,1172))},voxel:function(){return r.e(183).then(r.bind(null,1179))},scene:function(e){return null==e.profile||"mesh-pyramids"===e.profile?Promise.all([r.e(1),r.e(2),r.e(3),r.e(11),r.e(47)]).then(r.bind(null,1054)):Promise.all([r.e(1),r.e(2),r.e(3),r.e(5),r.e(50)]).then(r.bind(null,1188))},stream:function(){return Promise.all([r.e(1),r.e(2),r.e(3),r.e(5),r.e(53)]).then(r.bind(null,1180))},tile:$c,"imagery-tile":function(){return r.e(27).then(r.bind(null,1189))},"vector-tile":function(){return Promise.all([r.e(7),r.e(15),r.e(52)]).then(r.bind(null,1165))},wcs:function(){return r.e(27).then(r.bind(null,1189))},"web-tile":$c,wfs:function(){return Promise.all([r.e(1),r.e(2),r.e(3),r.e(5),r.e(60)]).then(r.bind(null,1055))},wms:function(){return Promise.all([r.e(8),r.e(138)]).then(r.bind(null,1190))},wmts:function(){return r.e(184).then(r.bind(null,1056))},slice:function(){return r.e(49).then(r.bind(null,1170))},"geo-rss":null,kml:null,"map-notes":null,route:null,"subtype-group":null,unknown:null,unsupported:null};var el=function(e){return Object(I.j)(Kc[e.type])},tl=function(e){var t=Kc[e.type];if(!Object(I.j)(t))throw function(e){var t=e.declaredClass?e.declaredClass.slice(e.declaredClass.lastIndexOf(".")+1):"Unknown",r=t.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase();return new U.a("".concat(r,":view-not-supported"),"".concat(t," is not supported in 3D"))}(e);return t(e)},rl=r(306),nl=r(72),il=j.a.getLogger("esri.views.3d.state.Constraints"),al=function(e){Object(f.a)(r,e);var t=Object(p.a)(r);function r(e){var n;return Object(c.a)(this,r),(n=t.call(this,e)).collision=new ll,n.distance=1/0,n.minimumPoiDistance=4,n}return Object(l.a)(r,[{key:"altitude",get:function(){return 2===this.mode?null:this._get("altitude")||null},set:function(e){2!==this.mode?this._set("altitude",e):il.warn("Altitude constraint is ignored in local scenes")}},{key:"clampAltitude",value:function(e){return this.altitude?Object(m.e)(e,this.altitude.min,this.altitude.max):e}},{key:"clampTilt",value:function(e,t){if(!this.tilt)return t;var r=this.tilt(e);return Object(m.e)(t,r.min,r.max)}},{key:"clampDistance",value:function(e){return Math.min(e,this.distance)}},{key:"createDefaultTilt",value:function(){return 2===this.mode?this.createDefaultTiltLocal():this.createDefaultTiltGlobal()}},{key:"createConstantMaxTilt",value:function(e){return function(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:cl;return r.min=sl.min,r.max=e,r}}},{key:"createDefaultTiltLocal",value:function(){var e=this.collision.enabled?Object(T.h)([[4e3,sl.max],[1e4,Object(m.g)(88)],[6e6,Object(m.g)(88)]]):function(){return sl.max};return function(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:cl;return r.min=sl.min,r.max=e(t),r}}},{key:"createDefaultTiltGlobal",value:function(){var e=this.collision.enabled?Object(T.h)([[4e3,sl.max],[5e4,Object(m.g)(88)],[6e6,Object(m.g)(88)],[2e7,sl.min]]):Object(T.h)([[3e5,sl.max],[3e6,Object(m.g)(88)],[6e6,Object(m.g)(88)],[2e7,sl.min]]);return function(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:cl;return r.min=sl.min,r.max=e(t),r}}}]),r}(de.a);Object(b.a)([Object(y.b)()],al.prototype,"altitude",null),Object(b.a)([Object(y.b)({readOnly:!0})],al.prototype,"collision",void 0),Object(b.a)([Object(y.b)()],al.prototype,"distance",void 0),Object(b.a)([Object(y.b)({readOnly:!0})],al.prototype,"minimumPoiDistance",void 0),Object(b.a)([Object(y.b)()],al.prototype,"tilt",void 0),Object(b.a)([Object(y.b)({constructOnly:!0})],al.prototype,"mode",void 0),al=Object(b.a)([Object(w.a)("esri.views.3d.state.Constraints")],al);var ol=function(e){return{min:-2e5,max:4*e.radius}}(nl.a),sl={min:Object(m.g)(.5),max:Object(m.g)(179.5)},cl={min:0,max:0},ll=function(e){Object(f.a)(r,e);var t=Object(p.a)(r);function r(){var e;return Object(c.a)(this,r),(e=t.apply(this,arguments)).enabled=!0,e.elevationMargin=5,e}return r}(de.a);Object(b.a)([Object(y.b)({type:Boolean})],ll.prototype,"enabled",void 0),Object(b.a)([Object(y.b)({type:Number})],ll.prototype,"elevationMargin",void 0),ll=Object(b.a)([Object(w.a)("esri.views.3d.state.Constraints.CollisionConstraint")],ll);var ul=al,dl=function(e){Object(f.a)(r,e);var t=Object(p.a)(r);function r(){var e;return Object(c.a)(this,r),(e=t.apply(this,arguments)).min=ol.min,e.max=ol.max,e}return Object(l.a)(r,[{key:"mode",get:function(){return Object(rl.a)(j.a.getLogger(this.declaredClass),"esri.views.SceneView.constraints.altitude.mode is deprecated. The altitude constraint no longer applies to local scenes and does not have an automatic mode anymore.",{version:"4.6"}),"manual"},set:function(e){Object(rl.a)(j.a.getLogger(this.declaredClass),"esri.views.SceneView.constraints.altitude.mode is deprecated. The altitude constraint no longer applies to local scenes and does not have an automatic mode anymore.",{version:"4.6"})}}]),r}(de.a);Object(b.a)([Object(y.b)({type:Number})],dl.prototype,"min",void 0),Object(b.a)([Object(y.b)({type:Number})],dl.prototype,"max",void 0);var hl=dl=Object(b.a)([Object(w.a)("esri.views.3d.constraints.AltitudeConstraint")],dl),fl=function(e){Object(f.a)(r,e);var t=Object(p.a)(r);function r(){var e;return Object(c.a)(this,r),(e=t.apply(this,arguments)).mode="auto",e}return Object(l.a)(r,[{key:"near",get:function(){return this._get("near")},set:function(e){this._set("near",e),e>=this._get("far")&&(this.far=e+1e-9),this.mode="manual"}},{key:"castNear",value:function(e){return Math.max(1e-8,e)}},{key:"far",get:function(){return this._get("far")},set:function(e){this._set("far",e),e<=this._get("near")&&(this.near=e-1e-9),this.mode="manual"}},{key:"castFar",value:function(e){return Math.max(1e-8,e)}},{key:"autoUpdate",value:function(e,t){"auto"===this.mode&&(this._get("near")!==e&&this._set("near",e),this._get("far")!==t&&this._set("far",t))}}]),r}(de.a);Object(b.a)([Object(y.b)({type:Number,value:1e-8})],fl.prototype,"near",null),Object(b.a)([Object(O.a)("near")],fl.prototype,"castNear",null),Object(b.a)([Object(y.b)({type:Number,value:1e-8})],fl.prototype,"far",null),Object(b.a)([Object(O.a)("far")],fl.prototype,"castFar",null),Object(b.a)([Object(y.b)({type:["auto","manual"]})],fl.prototype,"mode",void 0);var pl=fl=Object(b.a)([Object(w.a)("esri.views.3d.constraints.ClipDistanceConstraint")],fl),bl={min:Object(m.r)(sl.min),max:Object(m.r)(sl.max)},vl=function(e){Object(f.a)(r,e);var t=Object(p.a)(r);function r(){var e;return Object(c.a)(this,r),(e=t.apply(this,arguments)).mode="auto",e}return Object(l.a)(r,[{key:"max",get:function(){return this._get("max")},set:function(e){this._set("max",e),this.mode="manual"}},{key:"castMax",value:function(e){return Object(m.e)(e,bl.min,bl.max)}},{key:"autoUpdate",value:function(e){"auto"===this.mode&&this._get("max")!==e&&this._set("max",e)}}]),r}(de.a);Object(b.a)([Object(y.b)({type:["auto","manual"]})],vl.prototype,"mode",void 0),Object(b.a)([Object(y.b)({type:Number,value:bl.max})],vl.prototype,"max",null),Object(b.a)([Object(O.a)("max")],vl.prototype,"castMax",null);var ml=vl=Object(b.a)([Object(w.a)("esri.views.3d.constraints.TiltConstraint")],vl),yl=function(e){Object(f.a)(r,e);var t=Object(p.a)(r);function r(){var e;return Object(c.a)(this,r),(e=t.apply(this,arguments)).tilt=new ml,e.altitude=new hl,e.clipDistance=new pl,e}return r}(de.a);Object(b.a)([Object(y.b)({type:ml})],yl.prototype,"tilt",void 0),Object(b.a)([Object(y.b)({type:hl})],yl.prototype,"altitude",void 0),Object(b.a)([Object(y.b)({type:pl})],yl.prototype,"clipDistance",void 0);var gl,Ol=yl=Object(b.a)([Object(w.a)("esri.views.3d.constraints.Constraints")],yl),jl=r(25),_l=gl=function(e){Object(f.a)(r,e);var t=Object(p.a)(r);function r(){return Object(c.a)(this,r),t.apply(this,arguments)}return Object(l.a)(r,[{key:"quality",set:function(e){-1!==["low","high"].indexOf(e)&&this._set("quality",e)}},{key:"clone",value:function(){return new gl({quality:this.quality})}}]),r}(de.a);Object(b.a)([Object(y.b)({type:["low","high"],value:"low"})],_l.prototype,"quality",null);var wl,xl=_l=gl=Object(b.a)([Object(w.a)("esri.views.3d.environment.SceneViewAtmosphere")],_l),kl=wl=function(e){Object(f.a)(r,e);var t=Object(p.a)(r);function r(e){var n;return Object(c.a)(this,r),(n=t.call(this,e)).date=null,n.directShadowsEnabled=!1,n.displayUTCOffset=null,n}return Object(l.a)(r,[{key:"readDate",value:function(e,t){return null!=t.datetime&&new Date(t.datetime)||null}},{key:"writeDate",value:function(e,t,r){t[r]=e.getTime()}},{key:"readDirectShadowsEnabled",value:function(e,t){return!!t.directShadows}},{key:"writedirectShadowsEnabled",value:function(e,t,r){e&&(t[r]=e)}},{key:"writeDisplayUTCOffset",value:function(e,t){null!=e&&(t.displayUTCOffset=e)}},{key:"clone",value:function(){return new wl(this.cloneConstructProperties())}},{key:"cloneConstructProperties",value:function(){var e={directShadowsEnabled:this.directShadowsEnabled,displayUTCOffset:null!=this.displayUTCOffset?this.displayUTCOffset:null};return null!=this.date&&(e.date=new Date(this.date.getTime())),e}}]),r}(v.a);Object(b.a)([Object(y.b)({type:Date,json:{type:Number,write:{target:"datetime"}}})],kl.prototype,"date",void 0),Object(b.a)([Object(_.a)("date",["datetime"])],kl.prototype,"readDate",null),Object(b.a)([Object(x.a)("date")],kl.prototype,"writeDate",null),Object(b.a)([Object(y.b)({type:Boolean,json:{default:!1,write:{target:"directShadows"}}})],kl.prototype,"directShadowsEnabled",void 0),Object(b.a)([Object(_.a)("directShadowsEnabled",["directShadows"])],kl.prototype,"readDirectShadowsEnabled",null),Object(b.a)([Object(x.a)("directShadowsEnabled")],kl.prototype,"writedirectShadowsEnabled",null),Object(b.a)([Object(y.b)({type:Number,json:{write:!0}})],kl.prototype,"displayUTCOffset",void 0),Object(b.a)([Object(x.a)("displayUTCOffset")],kl.prototype,"writeDisplayUTCOffset",null);var Sl,Tl=kl=wl=Object(b.a)([Object(w.a)("esri.webscene.Lighting")],kl),Cl=Sl=function(e){Object(f.a)(r,e);var t=Object(p.a)(r);function r(e){var n;Object(c.a)(this,r),(n=t.call(this,e)).positionTimezoneInfo={hours:0,minutes:0,seconds:0,autoUpdated:!0},n.cameraTrackingEnabled=!0,n.ambientOcclusionEnabled=!1,n.waterReflectionEnabled=!1;var i=(new Date).getFullYear(),a=new Date("March 15, "+i+" 12:00:00 UTC");return n._set("defaultDate",a),n._set("date",a),n}return Object(l.a)(r,[{key:"defaultDate",get:function(){return new Date(this._get("defaultDate").getTime())},set:function(e){var t=this._get("date")===this._get("defaultDate");e=new Date(e.getTime()),this._set("defaultDate",e),t&&this._set("date",e)}},{key:"date",set:function(e){null!=e&&(this.positionTimezoneInfo.autoUpdated=!1,this._set("date",new Date(e.getTime())))}},{key:"autoUpdate",value:function(e,t){var r=Ml(this.positionTimezoneInfo);this.positionTimezoneInfo.hours=t.hours,this.positionTimezoneInfo.minutes=t.minutes,this.positionTimezoneInfo.seconds=t.seconds;var n=null;null!=e&&(this.positionTimezoneInfo.autoUpdated=!0,n=this.date&&this.date.getTime(),this._set("date",new Date(e.getTime())));var i=Ml(this.positionTimezoneInfo);if(r!==i&&(Pl.target=this,Pl.timezoneOffset=i,this.emit("timezone-will-change",Pl)),null!=e)return n!==e.getTime()}},{key:"clone",value:function(){var e=this._get("date")===this._get("defaultDate"),t=new Sl(Object(ie.a)(Object(ie.a)({},this.cloneConstructProperties()),{},{defaultDate:this.defaultDate,cameraTrackingEnabled:this.cameraTrackingEnabled,ambientOcclusionEnabled:this.ambientOcclusionEnabled,waterReflectionEnabled:this.waterReflectionEnabled}));return e&&t._set("date",t._get("defaultDate")),t.positionTimezoneInfo.autoUpdated=this.positionTimezoneInfo.autoUpdated,t.positionTimezoneInfo.hours=this.positionTimezoneInfo.hours,t.positionTimezoneInfo.minutes=this.positionTimezoneInfo.minutes,t.positionTimezoneInfo.seconds=this.positionTimezoneInfo.seconds,t}},{key:"cloneWithWebsceneLighting",value:function(e){var t=this.clone();return null!=e.date&&(t.date=e.date),t.directShadowsEnabled=e.directShadowsEnabled,t.displayUTCOffset=e.displayUTCOffset,t}}],[{key:"fromWebsceneLighting",value:function(e){return new Sl(Object(ie.a)({},e.cloneConstructProperties()))}}]),r}(Ii.a.EventedMixin(Tl));function Ml(e){var t=e.hours,r=e.minutes,n=e.seconds;return Math.round(t+r/60+n/3600)}Object(b.a)([Object(y.b)({type:Boolean})],Cl.prototype,"cameraTrackingEnabled",void 0),Object(b.a)([Object(y.b)({type:Boolean})],Cl.prototype,"ambientOcclusionEnabled",void 0),Object(b.a)([Object(y.b)({type:Boolean})],Cl.prototype,"waterReflectionEnabled",void 0),Object(b.a)([Object(y.b)({type:Date})],Cl.prototype,"defaultDate",null),Object(b.a)([Object(y.b)({type:Date})],Cl.prototype,"date",null),Cl=Sl=Object(b.a)([Object(w.a)("esri.views.3d.environment.SceneViewLighting")],Cl);var Pl={target:null,timezoneOffset:0},Al=function(e){Object(f.a)(r,e);var t=Object(p.a)(r);function r(e){return Object(c.a)(this,r),t.call(this,e)}return Object(l.a)(r,[{key:"clone",value:function(){}}]),r}(v.a);Object(b.a)([Object(y.b)({readOnly:!0,json:{read:!1}})],Al.prototype,"type",void 0);var El,Rl=Al=Object(b.a)([Object(w.a)("esri.webscene.background.Background")],Al),Il=r(49),Dl=r(52),Fl=r(131),Ll=Object(ie.a)(Object(ie.a)({},Fl.a),{},{nonNullable:!0}),zl=El=function(e){Object(f.a)(r,e);var t=Object(p.a)(r);function r(e){var n;return Object(c.a)(this,r),(n=t.call(this,e)).type="color",n.color=new Il.a([0,0,0,1]),n}return Object(l.a)(r,[{key:"clone",value:function(){return new El(this.cloneProperties())}},{key:"cloneProperties",value:function(){return{color:this.color.clone()}}}]),r}(Rl);Object(b.a)([Object(Dl.a)({color:"color"},{readOnly:!0})],zl.prototype,"type",void 0),Object(b.a)([Object(y.b)(Ll)],zl.prototype,"color",void 0);var Vl=zl=El=Object(b.a)([Object(w.a)("esri.webscene.background.ColorBackground")],zl),Nl={base:Rl,key:"type",typeMap:{color:Vl}};var Ul,Bl,Gl={types:Nl,json:{read:(Ul=Nl,function(e,t,r){if(!e)return e;for(var n in Ul.typeMap)if(e.type===n){var i=new Ul.typeMap[n];return i.read(e,r),i}}),write:{overridePolicy:function(e,t,r){return{enabled:!r||!r.isPresentation}}}}},ql=function(e,t,r){return{enabled:!r||!r.isPresentation}},Hl=Bl=function(e){Object(f.a)(r,e);var t=Object(p.a)(r);function r(e){var n;return Object(c.a)(this,r),(n=t.call(this,e)).lighting=new Tl,n.background=null,n.atmosphereEnabled=!0,n.starsEnabled=!0,n}return Object(l.a)(r,[{key:"clone",value:function(){return new Bl(this.cloneConstructProperties())}},{key:"cloneConstructProperties",value:function(){return{lighting:Tl.prototype.clone.call(this.lighting),background:Object(jl.a)(this.background),atmosphereEnabled:this.atmosphereEnabled,starsEnabled:this.starsEnabled}}}]),r}(v.a);Object(b.a)([Object(y.b)({type:Tl,json:{write:!0}})],Hl.prototype,"lighting",void 0),Object(b.a)([Object(y.b)(Gl)],Hl.prototype,"background",void 0),Object(b.a)([Object(y.b)({type:Boolean,nonNullable:!0,json:{write:{overridePolicy:ql}}})],Hl.prototype,"atmosphereEnabled",void 0),Object(b.a)([Object(y.b)({type:Boolean,nonNullable:!0,json:{write:{overridePolicy:ql}}})],Hl.prototype,"starsEnabled",void 0);var Wl,Ql=Hl=Bl=Object(b.a)([Object(w.a)("esri.webscene.Environment")],Hl),Zl=Wl=function(e){Object(f.a)(r,e);var t=Object(p.a)(r);function r(e){var n;return Object(c.a)(this,r),(n=t.call(this,e)).atmosphere=new xl,n}return Object(l.a)(r,[{key:"castLighting",value:function(e){return this.convertLighting(e)}},{key:"applyLighting",value:function(e){this.lighting=this.convertLighting(e)}},{key:"convertLighting",value:function(e){return e?e instanceof Cl?e:e instanceof Tl?this.lighting?this.lighting.cloneWithWebsceneLighting(e):Cl.fromWebsceneLighting(e):Object(k.m)(Cl,e):new Cl}},{key:"clone",value:function(){return new Wl({lighting:this.lighting.clone(),atmosphere:this.atmosphere.clone(),atmosphereEnabled:this.atmosphereEnabled,starsEnabled:this.starsEnabled,background:Object(jl.a)(this.background)})}},{key:"cloneWithWebsceneEnvironment",value:function(e){return new Wl(Object(ie.a)(Object(ie.a)({atmosphere:this.atmosphere.clone(),atmosphereEnabled:this.atmosphereEnabled,starsEnabled:this.starsEnabled,background:Object(jl.a)(this.background)},e.cloneConstructProperties()),{},{lighting:null!=this.lighting?this.lighting.cloneWithWebsceneLighting(e.lighting):Cl.fromWebsceneLighting(e.lighting)}))}}],[{key:"fromWebsceneEnvironment",value:function(e){var t=e.cloneConstructProperties();return new Wl(Object(ie.a)(Object(ie.a)({},t),{},{lighting:Cl.fromWebsceneLighting(t.lighting)}))}}]),r}(Ql);Object(b.a)([Object(y.b)({type:xl,json:{read:!1}})],Zl.prototype,"atmosphere",void 0),Object(b.a)([Object(y.b)()],Zl.prototype,"lighting",void 0),Object(b.a)([Object(O.a)("lighting")],Zl.prototype,"castLighting",null);var Xl=Zl=Wl=Object(b.a)([Object(w.a)("esri.views.3d.environment.SceneViewEnvironment")],Zl),Yl=r(4),$l=r(43),Jl=r(26),Kl=r(31),eu=r(156),tu=r(610),ru=r(91),nu=r(95),iu=r(24),au=r(77),ou=r(88),su=r(41),cu=function(e){Object(f.a)(r,e);var t=Object(p.a)(r);function r(){return Object(c.a)(this,r),t.apply(this,arguments)}return Object(l.a)(r,[{key:"initializeProgram",value:function(e){var t=r.shader.get(),n=this.configuration,i=t.build({geometry:n.geometry});return new ou.a(e.rctx,i,au.a)}},{key:"initializePipeline",value:function(){return 1===this.configuration.geometry?Object(su.g)({blending:Object(su.h)(770,1,771,771),culling:su.b,depthTest:{func:515},colorWrite:su.d}):Object(su.g)({blending:Object(su.h)(770,1,771,771),depthTest:{func:515},colorWrite:su.d})}}]),r}(nu.a);cu.shader=new ru.a(tu.a,(function(){return r.e(178).then(r.bind(null,1057))}));var lu=function(e){Object(f.a)(r,e);var t=Object(p.a)(r);function r(){var e;return Object(c.a)(this,r),(e=t.apply(this,arguments)).geometry=0,e}return r}(iu.a);Object(b.a)([Object(iu.b)({count:3})],lu.prototype,"geometry",void 0);var uu="data:image/png;base64, iVBORw0KGgoAAAANSUhEUgAAAAEAAAIACAYAAABD1gYFAAAACXBIWXMAAC4jAAAuIwF4pT92AAAKT2lDQ1BQaG90b3Nob3AgSUNDIHByb2ZpbGUAAHjanVNnVFPpFj333vRCS4iAlEtvUhUIIFJCi4AUkSYqIQkQSoghodkVUcERRUUEG8igiAOOjoCMFVEsDIoK2AfkIaKOg6OIisr74Xuja9a89+bN/rXXPues852zzwfACAyWSDNRNYAMqUIeEeCDx8TG4eQuQIEKJHAAEAizZCFz/SMBAPh+PDwrIsAHvgABeNMLCADATZvAMByH/w/qQplcAYCEAcB0kThLCIAUAEB6jkKmAEBGAYCdmCZTAKAEAGDLY2LjAFAtAGAnf+bTAICd+Jl7AQBblCEVAaCRACATZYhEAGg7AKzPVopFAFgwABRmS8Q5ANgtADBJV2ZIALC3AMDOEAuyAAgMADBRiIUpAAR7AGDIIyN4AISZABRG8lc88SuuEOcqAAB4mbI8uSQ5RYFbCC1xB1dXLh4ozkkXKxQ2YQJhmkAuwnmZGTKBNA/g88wAAKCRFRHgg/P9eM4Ors7ONo62Dl8t6r8G/yJiYuP+5c+rcEAAAOF0ftH+LC+zGoA7BoBt/qIl7gRoXgugdfeLZrIPQLUAoOnaV/Nw+H48PEWhkLnZ2eXk5NhKxEJbYcpXff5nwl/AV/1s+X48/Pf14L7iJIEyXYFHBPjgwsz0TKUcz5IJhGLc5o9H/LcL//wd0yLESWK5WCoU41EScY5EmozzMqUiiUKSKcUl0v9k4t8s+wM+3zUAsGo+AXuRLahdYwP2SycQWHTA4vcAAPK7b8HUKAgDgGiD4c93/+8//UegJQCAZkmScQAAXkQkLlTKsz/HCAAARKCBKrBBG/TBGCzABhzBBdzBC/xgNoRCJMTCQhBCCmSAHHJgKayCQiiGzbAdKmAv1EAdNMBRaIaTcA4uwlW4Dj1wD/phCJ7BKLyBCQRByAgTYSHaiAFiilgjjggXmYX4IcFIBBKLJCDJiBRRIkuRNUgxUopUIFVIHfI9cgI5h1xGupE7yAAygvyGvEcxlIGyUT3UDLVDuag3GoRGogvQZHQxmo8WoJvQcrQaPYw2oefQq2gP2o8+Q8cwwOgYBzPEbDAuxsNCsTgsCZNjy7EirAyrxhqwVqwDu4n1Y8+xdwQSgUXACTYEd0IgYR5BSFhMWE7YSKggHCQ0EdoJNwkDhFHCJyKTqEu0JroR+cQYYjIxh1hILCPWEo8TLxB7iEPENyQSiUMyJ7mQAkmxpFTSEtJG0m5SI+ksqZs0SBojk8naZGuyBzmULCAryIXkneTD5DPkG+Qh8lsKnWJAcaT4U+IoUspqShnlEOU05QZlmDJBVaOaUt2ooVQRNY9aQq2htlKvUYeoEzR1mjnNgxZJS6WtopXTGmgXaPdpr+h0uhHdlR5Ol9BX0svpR+iX6AP0dwwNhhWDx4hnKBmbGAcYZxl3GK+YTKYZ04sZx1QwNzHrmOeZD5lvVVgqtip8FZHKCpVKlSaVGyovVKmqpqreqgtV81XLVI+pXlN9rkZVM1PjqQnUlqtVqp1Q61MbU2epO6iHqmeob1Q/pH5Z/YkGWcNMw09DpFGgsV/jvMYgC2MZs3gsIWsNq4Z1gTXEJrHN2Xx2KruY/R27iz2qqaE5QzNKM1ezUvOUZj8H45hx+Jx0TgnnKKeX836K3hTvKeIpG6Y0TLkxZVxrqpaXllirSKtRq0frvTau7aedpr1Fu1n7gQ5Bx0onXCdHZ4/OBZ3nU9lT3acKpxZNPTr1ri6qa6UbobtEd79up+6Ynr5egJ5Mb6feeb3n+hx9L/1U/W36p/VHDFgGswwkBtsMzhg8xTVxbzwdL8fb8VFDXcNAQ6VhlWGX4YSRudE8o9VGjUYPjGnGXOMk423GbcajJgYmISZLTepN7ppSTbmmKaY7TDtMx83MzaLN1pk1mz0x1zLnm+eb15vft2BaeFostqi2uGVJsuRaplnutrxuhVo5WaVYVVpds0atna0l1rutu6cRp7lOk06rntZnw7Dxtsm2qbcZsOXYBtuutm22fWFnYhdnt8Wuw+6TvZN9un2N/T0HDYfZDqsdWh1+c7RyFDpWOt6azpzuP33F9JbpL2dYzxDP2DPjthPLKcRpnVOb00dnF2e5c4PziIuJS4LLLpc+Lpsbxt3IveRKdPVxXeF60vWdm7Obwu2o26/uNu5p7ofcn8w0nymeWTNz0MPIQ+BR5dE/C5+VMGvfrH5PQ0+BZ7XnIy9jL5FXrdewt6V3qvdh7xc+9j5yn+M+4zw33jLeWV/MN8C3yLfLT8Nvnl+F30N/I/9k/3r/0QCngCUBZwOJgUGBWwL7+Hp8Ib+OPzrbZfay2e1BjKC5QRVBj4KtguXBrSFoyOyQrSH355jOkc5pDoVQfujW0Adh5mGLw34MJ4WHhVeGP45wiFga0TGXNXfR3ENz30T6RJZE3ptnMU85ry1KNSo+qi5qPNo3ujS6P8YuZlnM1VidWElsSxw5LiquNm5svt/87fOH4p3iC+N7F5gvyF1weaHOwvSFpxapLhIsOpZATIhOOJTwQRAqqBaMJfITdyWOCnnCHcJnIi/RNtGI2ENcKh5O8kgqTXqS7JG8NXkkxTOlLOW5hCepkLxMDUzdmzqeFpp2IG0yPTq9MYOSkZBxQqohTZO2Z+pn5mZ2y6xlhbL+xW6Lty8elQfJa7OQrAVZLQq2QqboVFoo1yoHsmdlV2a/zYnKOZarnivN7cyzytuQN5zvn//tEsIS4ZK2pYZLVy0dWOa9rGo5sjxxedsK4xUFK4ZWBqw8uIq2Km3VT6vtV5eufr0mek1rgV7ByoLBtQFr6wtVCuWFfevc1+1dT1gvWd+1YfqGnRs+FYmKrhTbF5cVf9go3HjlG4dvyr+Z3JS0qavEuWTPZtJm6ebeLZ5bDpaql+aXDm4N2dq0Dd9WtO319kXbL5fNKNu7g7ZDuaO/PLi8ZafJzs07P1SkVPRU+lQ27tLdtWHX+G7R7ht7vPY07NXbW7z3/T7JvttVAVVN1WbVZftJ+7P3P66Jqun4lvttXa1ObXHtxwPSA/0HIw6217nU1R3SPVRSj9Yr60cOxx++/p3vdy0NNg1VjZzG4iNwRHnk6fcJ3/ceDTradox7rOEH0x92HWcdL2pCmvKaRptTmvtbYlu6T8w+0dbq3nr8R9sfD5w0PFl5SvNUyWna6YLTk2fyz4ydlZ19fi753GDborZ752PO32oPb++6EHTh0kX/i+c7vDvOXPK4dPKy2+UTV7hXmq86X23qdOo8/pPTT8e7nLuarrlca7nuer21e2b36RueN87d9L158Rb/1tWeOT3dvfN6b/fF9/XfFt1+cif9zsu72Xcn7q28T7xf9EDtQdlD3YfVP1v+3Njv3H9qwHeg89HcR/cGhYPP/pH1jw9DBY+Zj8uGDYbrnjg+OTniP3L96fynQ89kzyaeF/6i/suuFxYvfvjV69fO0ZjRoZfyl5O/bXyl/erA6xmv28bCxh6+yXgzMV70VvvtwXfcdx3vo98PT+R8IH8o/2j5sfVT0Kf7kxmTk/8EA5jz/GMzLdsAAAAgY0hSTQAAeiUAAICDAAD5/wAAgOkAAHUwAADqYAAAOpgAABdvkl/FRgAAAXVJREFUeNq0k9GWhDAIQ3PjzP9/cuehFqhW19mz++IhkCZAq1prsqT+kSQS9g8Vnqp6VGVWkYVktR6tj3Gr968nLnfwlHzHYyHapkKS73bPd/39eI38AYWj24OGvqdwWjZ3l8IDgacXyl1Dj9tdLOzZiicj+P1YcGk0H2O2vN/VQpTveEHmPHQxZxYlqsQdhUeuCWREuDEvAjqlCqDIMYwIo2ijR1HdYUS58dQrKpgQ0EGeMocsTNXrxzyOhS9kfzlWjn82YuWLqwAnvfNEWJFjYXkJCT0s7AmS0NG4x7Lt6Cpy2MiVPBZmS668QT5AR1cevp7b6CpzQ/ZSNH0vmhy5CsNtdax0MBpXDBiFsrDiMSLKMc8b6hH93bNbEpRsIyHDUhNcfTyeKF16PC7c/2QdczvUnvOB1ylZHVFSMtd5s8C2IW/7w6hwM5GLavLCd1zkiFjB+BwH1DSgctQ7mPOimBLJrw35beSXkd8BM/cCqbXWPgMA+GQQ5sIgkfAAAAAASUVORK5CYII=",du=r(142),hu=r(108),fu=r(106),pu=r(171),bu=r(81),vu=r(60),mu=r(92),yu=r(104),gu=j.a.getLogger("esri.views.3d.environment.PanoramicAtmosphere"),Ou=function(){function e(){Object(c.a)(this,e),this.slot=14,this._atmosphereTechniqueConfig=new lu,this._readyResolver=Object(q.h)(),this._readyController=Object(q.e)()}return Object(l.a)(e,[{key:"canRender",get:function(){return null!=this._texture}},{key:"destroy",value:function(){this._readyResolver.reject(),this._texture=Object(I.f)(this._texture),this._vao=Object(I.f)(this._vao),this._readyController=Object(I.a)(this._readyController)}},{key:"when",value:function(){return this._readyResolver.promise}},{key:"initializeRenderContext",value:function(e){var t=this;this._atmosphereTechniqueConfig.geometry=1,this._atmosphereTechnique=e.shaderTechniqueRep.acquire(cu,this._atmosphereTechniqueConfig);var r=e.renderContext.rctx;this._vao=this._createVertexArrayObject(r),this._vaoCount=Object(mu.f)(this._vao,"geometry"),Object(eu.a)(uu,{signal:this._readyController.signal}).then((function(n){t._texture=new vu.a(r,{pixelFormat:6408,dataType:5121,wrapMode:33071,samplingMode:9729,flipped:!0},n),e.requestRender(),t._readyController=null,t._readyResolver.resolve()})).catch((function(e){Object(q.n)(e)||gu.error("Unable to initialize atmosphere: image request failed",e),t._readyResolver.reject()}))}},{key:"uninitializeRenderContext",value:function(){this.destroy()}},{key:"render",value:function(e){if(e.slot!==this.slot||0!==e.pass)return!1;var t=e.rctx,r=this._atmosphereTechnique.program;return t.useProgram(r),this._atmosphereTechnique.bindPipelineState(t),r.bindTexture(this._texture,"tex"),Object(fu.c)(r,e.camera.projectionMatrix),function(e,t){Object(Jl.d)(e,t),e[12]=0,e[13]=0,e[14]=0,e[15]=1}(ju,e.camera.viewMatrix),r.setUniformMatrix4fv("view",ju),r.setUniform4f("color",1,1,1,1),e.scenelightingData.setLightDirectionUniform(r),t.bindVAO(this._vao),r.assertCompatibleVertexAttributeLocations(this._vao),t.drawArrays(4,0,this._vaoCount),!0}},{key:"_createVertexArrayObject",value:function(e){for(var t=pu.a.createPolySphereGeometry(1,2,!1),r=t.indices.get("position"),n=0;n<r.length;n+=3){var i=r[n];r[n]=r[n+2],r[n+2]=i}for(var a=t.vertexAttributes.get("position").data,o=_u.createBuffer(r.length),s=o.position,c=0;c<r.length;++c){var l=3*r[c];s.set(c,0,a[l]),s.set(c,1,a[l+1]),s.set(c,2,a[l+2])}return new yu.a(e,au.a,{geometry:Object(du.a)(_u)},{geometry:bu.a.createVertex(e,35044,o.buffer)})}}]),e}();var ju=Object(Kl.d)(),_u=Object(hu.a)().vec3f("position"),wu=Ou,xu=r(29),ku=r(38),Su=r(54);function Tu(e){var t=1e5;return Math.min(1,Math.max(0,(e-t)/9e5))}var Cu=r(611),Mu=function(e){Object(f.a)(r,e);var t=Object(p.a)(r);function r(){return Object(c.a)(this,r),t.apply(this,arguments)}return Object(l.a)(r,[{key:"initializeProgram",value:function(e){var t=r.shader.get(),n=this.configuration,i=t.build({haze:n.haze});return new ou.a(e.rctx,i,au.a)}},{key:"initializePipeline",value:function(){return this.configuration.haze?Object(su.g)({blending:Object(su.h)(1,0,769,1),colorWrite:su.d}):Object(su.g)({blending:Object(su.h)(770,1,771,771),depthTest:{func:515},colorWrite:su.d})}}]),r}(nu.a);Mu.shader=new ru.a(Cu.a,(function(){return r.e(177).then(r.bind(null,1058))}));var Pu=function(e){Object(f.a)(r,e);var t=Object(p.a)(r);function r(){var e;return Object(c.a)(this,r),(e=t.apply(this,arguments)).haze=!1,e}return r}(iu.a);Object(b.a)([Object(iu.b)()],Pu.prototype,"haze",void 0);var Au=function(){function e(t){Object(c.a)(this,e),this._view=t,this.canRender=!0,this._skyslot=14,this._hazeSlot=15,this._renderData={texDepth:Object(ku.b)(),cameraPosition:Object(X.e)(),projectionInverse:Object(Kl.d)(),viewInverse:Object(Kl.d)(),heightParameters:Object($l.e)(),atmosphereParameters1:Object($l.e)(),atmosphereParameters2:Object($l.e)(),atmosphereParameters3:Object(X.e)(),invWavelength:Iu,invWavelengthScaled:Du,radii:Object(ku.b)(),scale:0,scaleDepth:Fu,lowerAlphaBlendBound:0,scaleOverScaleDepth:0,oneOverScaleDepth:0,scaleDepthBlue:Lu,oneOverScaleDepthBlue:Vu,scaleOverScaleDepthBlue:0,g:Nu,g2:Nu*Nu,miePhaseCoefficients:Uu,nearFar:Object(ku.b)(),cameraHeight:0,cameraHeightSq:0,C:0,CSur:0,innerFadeDistance:0,altitudeFade:0},this._lowerElevationBoundRadius=0,this._lowerBoundEarthRadius=nl.a.radius,this._updateRadius(nl.a.radius)}return Object(l.a)(e,[{key:"destroy",value:function(){this._handles&&(this._handles.destroy(),this._handles=null),this._vao&&(this._vao.dispose(),this._vao=null)}},{key:"when",value:function(){return Promise.resolve()}},{key:"initializeRenderContext",value:function(e){var t=this,r=e.renderContext.rctx;this._handles=new oe.a,this._updateElevation({spatialReference:this._view.basemapTerrain.spatialReference,tile:this._view.basemapTerrain.rootTiles[0],extent:this._view.basemapTerrain.rootTiles[0].extent,context:"ground"}),this._handles.add(Object(W.b)(this._view,"basemapTerrain","elevation-change",(function(e){return t._updateElevation(e)}),(function(){return t._updateElevation()}))),this._handles.add(Object(W.b)(this._view,"basemapTerrain","elevation-bounds-change",(function(){return t._updateVisibleElevationBounds()}),(function(){return t._updateVisibleElevationBounds()})));var n=new Pu;n.haze=!1,this._atmosphereTechnique=e.shaderTechniqueRep.acquire(Mu,n),n.haze=!0,this._atmosphereHazeTechnique=e.shaderTechniqueRep.acquire(Mu,n),this._vao=this._createVertexArrayObject(r)}},{key:"uninitializeRenderContext",value:function(){this.destroy()}},{key:"render",value:function(e){return(e.slot===this._hazeSlot||e.slot===this._skyslot)&&0===e.pass&&(this._update(e.camera),e.slot===this._skyslot&&this._renderSky(e),e.slot===this._hazeSlot&&this._renderHaze(e),!0)}},{key:"_renderSky",value:function(e){var t=e.rctx,r=this._atmosphereTechnique.program;t.useProgram(r),this._atmosphereTechnique.bindPipelineState(t),r.setUniform3fv("atmosphereParameters3",this._renderData.atmosphereParameters3),this._renderCommon(r,e)}},{key:"_renderHaze",value:function(e){var t=this,r=e.rctx,n=e.offscreenRenderingHelper,i=this._atmosphereHazeTechnique.program;r.useProgram(i),this._atmosphereHazeTechnique.bindPipelineState(r),n.renderDepthDetached((function(){var r=n.depthTexture;i.bindTexture(r,"depthTex"),t._renderCommon(i,e)}))}},{key:"_renderCommon",value:function(e,t){var r=t.rctx;e.setUniform3fv("invWavelength",this._renderData.invWavelength),e.setUniform3fv("invWavelengthScaled",this._renderData.invWavelengthScaled),t.scenelightingData.setLightDirectionUniform(e),e.setUniform4fv("heightParameters",this._renderData.heightParameters),e.setUniform3fv("cameraPosition",this._renderData.cameraPosition),e.setUniformMatrix4fv("projectionInverse",this._renderData.projectionInverse),e.setUniformMatrix4fv("viewInverse",this._renderData.viewInverse),e.setUniform2fv("nearFar",this._renderData.nearFar),e.setUniform2fv("radii",this._renderData.radii),e.setUniform4fv("atmosphereParameters1",this._renderData.atmosphereParameters1),e.setUniform4fv("atmosphereParameters2",this._renderData.atmosphereParameters2),e.setUniform1f("innerFadeDistance",this._renderData.innerFadeDistance),e.setUniform1f("altitudeFade",this._renderData.altitudeFade),r.bindVAO(this._vao),e.assertCompatibleVertexAttributeLocations(this._vao),r.drawArrays(5,0,4)}},{key:"_createVertexArrayObject",value:function(e){var t=Bu.createBuffer(4);return t.position.setVec(0,[-1,-1]),t.position.setVec(1,[1,-1]),t.position.setVec(2,[-1,1]),t.position.setVec(3,[1,1]),t.uv0.setVec(0,[0,0]),t.uv0.setVec(1,[1,0]),t.uv0.setVec(2,[0,1]),t.uv0.setVec(3,[1,1]),new yu.a(e,au.a,{geometry:Object(du.a)(Bu)},{geometry:bu.a.createVertex(e,35044,t.buffer)})}},{key:"_adjustRadiusForTesselation",value:function(e){var t=Math.PI/Math.pow(2,4)/16;return e*Math.cos(t)}},{key:"_updateElevation",value:function(e){var t=e?e.tile:this._view.basemapTerrain.rootTiles[0];if(0===t.lij[0]){var r=this._adjustRadiusForTesselation(nl.a.radius+t.elevationBounds[0]);r!==this._lowerElevationBoundRadius&&(this._lowerElevationBoundRadius=r,this._lowerBoundEarthRadius=-1,this._updateVisibleElevationBounds())}}},{key:"_updateVisibleElevationBounds",value:function(){var e=this._adjustRadiusForTesselation(nl.a.radius+this._view.basemapTerrain.elevationBounds.min);(this._lowerBoundEarthRadius<0||e<this._lowerBoundEarthRadius)&&this._updateRadius(e)}},{key:"_updateRadius",value:function(e){this._lowerBoundEarthRadius=e;var t=e,r=t/10*10.25,n=1/(r-t),i=n/Fu,a=n/Lu,o=.3*(r-t)+t,s=this._renderData;Object(Su.l)(s.atmosphereParameters1,n,Fu,i,zu),Object(Su.l)(s.atmosphereParameters2,Nu,Lu,a,Vu),Object(Yl.y)(s.atmosphereParameters3,Nu*Nu,Uu,o),Object(xu.r)(s.radii,t,r),s.scale=n,s.lowerAlphaBlendBound=o,s.scaleOverScaleDepth=i,s.scaleOverScaleDepthBlue=a;s.innerFadeDistance=2*Math.sqrt(1e4*(2*t-1e4))}},{key:"_update",value:function(e){e&&(this._renderData.cameraHeight=Object(Yl.r)(e.eye),this._renderData.cameraHeightSq=this._renderData.cameraHeight*this._renderData.cameraHeight,this._renderData.C=this._renderData.cameraHeightSq-this._renderData.radii[1]*this._renderData.radii[1],this._renderData.CSur=this._renderData.cameraHeightSq-this._renderData.radii[0]*this._renderData.radii[0],this._renderData.heightParameters=Object($l.g)(this._renderData.cameraHeight,this._renderData.cameraHeightSq,this._renderData.C,this._renderData.CSur),Object(Yl.m)(this._renderData.cameraPosition,e.eye),Object(Jl.a)(this._renderData.projectionInverse,e.projectionMatrix),Object(Jl.a)(this._renderData.viewInverse,e.viewMatrix),Object(xu.r)(this._renderData.nearFar,e.near,e.far),this._renderData.altitudeFade=Tu(this._renderData.cameraHeight-this._lowerBoundEarthRadius))}}],[{key:"isSupported",value:function(e){return e.renderContext.rctx.capabilities.depthTexture}}]),e}(),Eu=.02*Math.PI,Ru=.004*Math.PI,Iu=Object(X.g)(1/Math.pow(.65,4),1/Math.pow(.57,4),1/Math.pow(.475,4)),Du=Object(X.c)(Iu);Object(Yl.g)(Du,Du,Eu),Object(Yl.h)(Du,Du,Object(X.g)(Ru,Ru,Ru));var Fu=.25,Lu=.05,zu=1/Fu,Vu=1/Lu,Nu=-.99999,Uu=(1-Nu*Nu)/(2+Nu*Nu)*1.5,Bu=Object(hu.a)().vec2f("position").vec2f("uv0"),Gu=r(124),qu=r(46),Hu=j.a.getLogger("esri.views.3d.environment.SimpleAtmosphere"),Wu=128,Qu=-1e4,Zu=Object(T.h)([[50,.1015625],[500,.21875],[5e3,1-250/512],[5e4,.4140625]]),Xu=function(){function e(t){Object(c.a)(this,e),this.view=t,this.slot=14,this._renderData={texV:Object(ku.b)(),silCircleCenter:Object(X.e)(),silCircleV1:Object(X.e)(),silCircleV2:Object(X.e)(),altitudeFade:0,innerScale:0,undergroundFadeAlpha:0},this._fadeVaoCount=0,this._readyResolver=Object(q.h)(),this._readyController=Object(q.e)(),this.texV1=1,this.isOnMars=Object(qs.h)(t.spatialReference);var r=Object(J.e)(t.spatialReference);this.planetRadius=r.radius,this.outerRimWidth=r.outerAtmosphereRimWidth,this.innerRimFactor=(this.planetRadius+Qu)/this.planetRadius,this.middleRimFactor=(this.planetRadius+0)/this.planetRadius,this.outerRimFactor=(this.planetRadius+this.outerRimWidth)/this.planetRadius,this.texV0=0/this.outerRimWidth,this.texVScale=this.texV1-this.texV0}return Object(l.a)(e,[{key:"canRender",get:function(){return null!=this._texture}},{key:"when",value:function(){return this._readyResolver.promise}},{key:"initializeRenderContext",value:function(e){var t=this,r=e.renderContext.rctx;this._cameraChangeHandle=Object(W.a)(this.view,"state.camera",(function(){return e.requestRender()}),!0);var n=new lu;n.geometry=0,this._atmosphereConeTechnique=e.shaderTechniqueRep.acquire(cu,n),n.geometry=2,this._atmosphereUndergroundTechnique=e.shaderTechniqueRep.acquire(cu,n),this._vao=this._createRibbon(r),this._vaoCount=Object(mu.f)(this._vao,"geometry"),this._fadeVao=Object(Gu.d)(r),this._fadeVaoCount=Object(mu.f)(this._fadeVao,"geometry"),Object(eu.a)(this.isOnMars?"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAIACAYAAAE00TaTAAAACXBIWXMAAA7AAAAOwAFq1okJAAAKT2lDQ1BQaG90b3Nob3AgSUNDIHByb2ZpbGUAAHjanVNnVFPpFj333vRCS4iAlEtvUhUIIFJCi4AUkSYqIQkQSoghodkVUcERRUUEG8igiAOOjoCMFVEsDIoK2AfkIaKOg6OIisr74Xuja9a89+bN/rXXPues852zzwfACAyWSDNRNYAMqUIeEeCDx8TG4eQuQIEKJHAAEAizZCFz/SMBAPh+PDwrIsAHvgABeNMLCADATZvAMByH/w/qQplcAYCEAcB0kThLCIAUAEB6jkKmAEBGAYCdmCZTAKAEAGDLY2LjAFAtAGAnf+bTAICd+Jl7AQBblCEVAaCRACATZYhEAGg7AKzPVopFAFgwABRmS8Q5ANgtADBJV2ZIALC3AMDOEAuyAAgMADBRiIUpAAR7AGDIIyN4AISZABRG8lc88SuuEOcqAAB4mbI8uSQ5RYFbCC1xB1dXLh4ozkkXKxQ2YQJhmkAuwnmZGTKBNA/g88wAAKCRFRHgg/P9eM4Ors7ONo62Dl8t6r8G/yJiYuP+5c+rcEAAAOF0ftH+LC+zGoA7BoBt/qIl7gRoXgugdfeLZrIPQLUAoOnaV/Nw+H48PEWhkLnZ2eXk5NhKxEJbYcpXff5nwl/AV/1s+X48/Pf14L7iJIEyXYFHBPjgwsz0TKUcz5IJhGLc5o9H/LcL//wd0yLESWK5WCoU41EScY5EmozzMqUiiUKSKcUl0v9k4t8s+wM+3zUAsGo+AXuRLahdYwP2SycQWHTA4vcAAPK7b8HUKAgDgGiD4c93/+8//UegJQCAZkmScQAAXkQkLlTKsz/HCAAARKCBKrBBG/TBGCzABhzBBdzBC/xgNoRCJMTCQhBCCmSAHHJgKayCQiiGzbAdKmAv1EAdNMBRaIaTcA4uwlW4Dj1wD/phCJ7BKLyBCQRByAgTYSHaiAFiilgjjggXmYX4IcFIBBKLJCDJiBRRIkuRNUgxUopUIFVIHfI9cgI5h1xGupE7yAAygvyGvEcxlIGyUT3UDLVDuag3GoRGogvQZHQxmo8WoJvQcrQaPYw2oefQq2gP2o8+Q8cwwOgYBzPEbDAuxsNCsTgsCZNjy7EirAyrxhqwVqwDu4n1Y8+xdwQSgUXACTYEd0IgYR5BSFhMWE7YSKggHCQ0EdoJNwkDhFHCJyKTqEu0JroR+cQYYjIxh1hILCPWEo8TLxB7iEPENyQSiUMyJ7mQAkmxpFTSEtJG0m5SI+ksqZs0SBojk8naZGuyBzmULCAryIXkneTD5DPkG+Qh8lsKnWJAcaT4U+IoUspqShnlEOU05QZlmDJBVaOaUt2ooVQRNY9aQq2htlKvUYeoEzR1mjnNgxZJS6WtopXTGmgXaPdpr+h0uhHdlR5Ol9BX0svpR+iX6AP0dwwNhhWDx4hnKBmbGAcYZxl3GK+YTKYZ04sZx1QwNzHrmOeZD5lvVVgqtip8FZHKCpVKlSaVGyovVKmqpqreqgtV81XLVI+pXlN9rkZVM1PjqQnUlqtVqp1Q61MbU2epO6iHqmeob1Q/pH5Z/YkGWcNMw09DpFGgsV/jvMYgC2MZs3gsIWsNq4Z1gTXEJrHN2Xx2KruY/R27iz2qqaE5QzNKM1ezUvOUZj8H45hx+Jx0TgnnKKeX836K3hTvKeIpG6Y0TLkxZVxrqpaXllirSKtRq0frvTau7aedpr1Fu1n7gQ5Bx0onXCdHZ4/OBZ3nU9lT3acKpxZNPTr1ri6qa6UbobtEd79up+6Ynr5egJ5Mb6feeb3n+hx9L/1U/W36p/VHDFgGswwkBtsMzhg8xTVxbzwdL8fb8VFDXcNAQ6VhlWGX4YSRudE8o9VGjUYPjGnGXOMk423GbcajJgYmISZLTepN7ppSTbmmKaY7TDtMx83MzaLN1pk1mz0x1zLnm+eb15vft2BaeFostqi2uGVJsuRaplnutrxuhVo5WaVYVVpds0atna0l1rutu6cRp7lOk06rntZnw7Dxtsm2qbcZsOXYBtuutm22fWFnYhdnt8Wuw+6TvZN9un2N/T0HDYfZDqsdWh1+c7RyFDpWOt6azpzuP33F9JbpL2dYzxDP2DPjthPLKcRpnVOb00dnF2e5c4PziIuJS4LLLpc+Lpsbxt3IveRKdPVxXeF60vWdm7Obwu2o26/uNu5p7ofcn8w0nymeWTNz0MPIQ+BR5dE/C5+VMGvfrH5PQ0+BZ7XnIy9jL5FXrdewt6V3qvdh7xc+9j5yn+M+4zw33jLeWV/MN8C3yLfLT8Nvnl+F30N/I/9k/3r/0QCngCUBZwOJgUGBWwL7+Hp8Ib+OPzrbZfay2e1BjKC5QRVBj4KtguXBrSFoyOyQrSH355jOkc5pDoVQfujW0Adh5mGLw34MJ4WHhVeGP45wiFga0TGXNXfR3ENz30T6RJZE3ptnMU85ry1KNSo+qi5qPNo3ujS6P8YuZlnM1VidWElsSxw5LiquNm5svt/87fOH4p3iC+N7F5gvyF1weaHOwvSFpxapLhIsOpZATIhOOJTwQRAqqBaMJfITdyWOCnnCHcJnIi/RNtGI2ENcKh5O8kgqTXqS7JG8NXkkxTOlLOW5hCepkLxMDUzdmzqeFpp2IG0yPTq9MYOSkZBxQqohTZO2Z+pn5mZ2y6xlhbL+xW6Lty8elQfJa7OQrAVZLQq2QqboVFoo1yoHsmdlV2a/zYnKOZarnivN7cyzytuQN5zvn//tEsIS4ZK2pYZLVy0dWOa9rGo5sjxxedsK4xUFK4ZWBqw8uIq2Km3VT6vtV5eufr0mek1rgV7ByoLBtQFr6wtVCuWFfevc1+1dT1gvWd+1YfqGnRs+FYmKrhTbF5cVf9go3HjlG4dvyr+Z3JS0qavEuWTPZtJm6ebeLZ5bDpaql+aXDm4N2dq0Dd9WtO319kXbL5fNKNu7g7ZDuaO/PLi8ZafJzs07P1SkVPRU+lQ27tLdtWHX+G7R7ht7vPY07NXbW7z3/T7JvttVAVVN1WbVZftJ+7P3P66Jqun4lvttXa1ObXHtxwPSA/0HIw6217nU1R3SPVRSj9Yr60cOxx++/p3vdy0NNg1VjZzG4iNwRHnk6fcJ3/ceDTradox7rOEH0x92HWcdL2pCmvKaRptTmvtbYlu6T8w+0dbq3nr8R9sfD5w0PFl5SvNUyWna6YLTk2fyz4ydlZ19fi753GDborZ752PO32oPb++6EHTh0kX/i+c7vDvOXPK4dPKy2+UTV7hXmq86X23qdOo8/pPTT8e7nLuarrlca7nuer21e2b36RueN87d9L158Rb/1tWeOT3dvfN6b/fF9/XfFt1+cif9zsu72Xcn7q28T7xf9EDtQdlD3YfVP1v+3Njv3H9qwHeg89HcR/cGhYPP/pH1jw9DBY+Zj8uGDYbrnjg+OTniP3L96fynQ89kzyaeF/6i/suuFxYvfvjV69fO0ZjRoZfyl5O/bXyl/erA6xmv28bCxh6+yXgzMV70VvvtwXfcdx3vo98PT+R8IH8o/2j5sfVT0Kf7kxmTk/8EA5jz/GMzLdsAAAAgY0hSTQAAeiUAAICDAAD5/wAAgOkAAHUwAADqYAAAOpgAABdvkl/FRgAAAp1JREFUSMd9lcmSEzEQRCtflnqxYZgIThBDAP//kXDQ0pJtuDhqycxWZ5fKERFCERARIAVEyCjCtSFFEjWVa9q7OdJE0oiidIhKhRBROlhloiGVhaYERQHJWFEwMpYKrjUlibI2cqSJIJEpKNmM2c3GkRTOJDnThTMpnMWu0VFszs3Jfbe5bza3w+a229yOIs6zmP3czfn1K2w/for8+EVU15pNmmyqkeJyclinXNJRu1xrUaJmjmdzJiejVNt7zZVBRAIq1RwrsrrWnez+SR7WmQQP/1itKz2q/pmzuJtYnNy2bth9x9z2NLfDcB7FHOcGx6ebOb9/iPzxG/ztg4iorglFiKjzF9HSNphCoRb1OY3RZQJrYgRdT68bmgXGDdBzrTG8qNS7QP/m19ef7tGlcoH7vESYkK70uoPuOLEetz0IqeGoWQW6MlB/j36EnipYGKPWwDRg/RkNhXCNJIzAhMk6PrDePJNII6JHqM5VWqYApCtNFPe0GFFGtOWopWCrEVBSoiQi06KkRRaD08IlxXa/ifz8Jvz2LvjyLnh7F/r8Rei8a8xfjNkIrpmMOQ1C02COrkTEHxGhh+6DQJfXc/eZprXxcIyVIf1LJVgWvKaHvwI/1aQxtv851SQ/nqGXL6MHFVY3nmhLyqKsWO/+qzWif+yS1TpNKq8NezjGPCV69ciZoQj1PwfN6QRpWyCGVMe1D/AAHt3/gefu1Ign3AVpjOiNXkN90JlpL6TUnzFEUU+Jvks0tkp/dY3Fy1TzI24BWwsYJPyg11Q0FqDwK72xIz2kLojbeuxS1FpgtfNWyMX1gFw0j3W7RNeSHTVEe3VaV7SdCzVywFaEt02w7QH7Eeg4AvZDNdJ+Cu1HENsutO+Byi6ilEBZ9BeCNBJceJIjHgAAAABJRU5ErkJggg==":uu,{signal:this._readyController.signal}).then((function(n){t._texture=new vu.a(r,{pixelFormat:6408,dataType:5121,wrapMode:33071,samplingMode:9729,flipped:!0},n),e.requestRender(),t._readyController=null,t._readyResolver.resolve()})).catch((function(e){Object(q.n)(e)||Hu.error("Unable to initialize simple atmosphere: image request failed",e),t._readyResolver.reject()}))}},{key:"uninitializeRenderContext",value:function(){this.destroy()}},{key:"destroy",value:function(){this._readyResolver.reject(),this._cameraChangeHandle&&(this._cameraChangeHandle.remove(),this._cameraChangeHandle=null),this._texture&&(this._texture.dispose(),this._texture=null),this._fadeVao&&(this._fadeVao.dispose(),this._fadeVao=null),this._vao&&(this._vao.dispose(),this._vao=null),this._readyController&&(this._readyController.abort(),this._readyController=null)}},{key:"render",value:function(e){if(e.slot!==this.slot||0!==e.pass)return!1;this._update(e.camera);var t=e.rctx;if(this._atmosphereConeTechnique.bindPipelineState(t),this._renderData.undergroundFadeAlpha<1){var r=this._atmosphereConeTechnique.program;t.useProgram(r),r.setUniformMatrix4fv("proj",e.camera.projectionMatrix),r.setUniformMatrix4fv("view",e.camera.viewMatrix),r.setUniform3fv("silCircleCenter",this._renderData.silCircleCenter),r.setUniform3fv("silCircleV1",this._renderData.silCircleV1),r.setUniform3fv("silCircleV2",this._renderData.silCircleV2),r.setUniform2fv("texV",this._renderData.texV),r.bindTexture(this._texture,"tex"),e.scenelightingData.setLightDirectionUniform(r),r.setUniform1f("altitudeFade",this._renderData.altitudeFade),r.setUniform1f("innerScale",this._renderData.innerScale),t.bindVAO(this._vao),t.drawArrays(4,0,this._vaoCount)}if(this._renderData.undergroundFadeAlpha>0){var n=this._atmosphereUndergroundTechnique.program;t.useProgram(n),n.setUniform1f("undergroundFadeAlpha",this._renderData.undergroundFadeAlpha),e.scenelightingData.setLightDirectionUniform(n),n.setUniform3fv("cameraPosition",e.camera.eye),t.bindVAO(this._fadeVao),t.drawArrays(5,0,this._fadeVaoCount)}return!0}},{key:"_update",value:function(e){var t=Object(X.e)(),r=this.planetRadius,n=Object(Yl.r)(e.eye),i=n-r;if(i<0){var a=Math.min(-i/5e3,1);this._renderData.undergroundFadeAlpha=a}else this._renderData.undergroundFadeAlpha=0;var o=Math.max(50,i),s=r+Qu;this._renderData.innerScale=function(e,t,r){return e*e/(Math.sqrt(e*e-t*t)*Math.sqrt(e*e-r*r)+t*r)}(r+o,r,s)-1,this._renderData.altitudeFade=Tu(i),Object(Yl.g)(t,e.eye,(r+50)/n),Yu(t,e.center,e.up,r,this._renderData);var c=this._computeScreenRimWidth(e,t,e.up,this._renderData),l=1-511/512,u=Zu(i),d=this.texV0+l*this.texVScale,h=this.texV0+c*u*this.texVScale;if(i>50){Yu(e.eye,e.center,e.up,r,this._renderData);var f=this._computeScreenRimWidth(e,e.eye,e.up,this._renderData),p=Object(m.e)((f-1.5)/(c-1.5),0,1);d=this.texV0+p*l*this.texVScale,h=this.texV0+Object(m.m)(this.texV1,c*u,p)*this.texVScale}Object(xu.r)(this._renderData.texV,d,h)}},{key:"_createRibbon",value:function(e){var t=new Float32Array(1155),r=new Uint32Array(1920);t[0]=0,t[1]=0,t[2]=-1;for(var n=0;n<Wu;n++){var i=9*n+3;t[i+0]=n,t[i+1]=this.innerRimFactor,t[i+2]=-1,t[i+3]=n,t[i+4]=this.middleRimFactor,t[i+5]=0,t[i+6]=n,t[i+7]=this.outerRimFactor,t[i+8]=1;var a=3*n+1,o=127===n?1:a+3,s=15*n;r[s+0]=a,r[s+1]=a+1,r[s+2]=o+1,r[s+3]=o+1,r[s+4]=o,r[s+5]=a,r[s+6]=a+1,r[s+7]=a+2,r[s+8]=o+2,r[s+9]=o+2,r[s+10]=o+1,r[s+11]=a+1,r[s+12]=a,r[s+13]=o,r[s+14]=0}for(var c=ed.createBuffer(r.length),l=c.position,u=0;u<r.length;++u){var d=3*r[u];l.set(u,0,t[d]),l.set(u,1,t[d+1]),l.set(u,2,t[d+2])}return new yu.a(e,au.a,{geometry:Object(du.a)(ed)},{geometry:bu.a.createVertex(e,35044,c.buffer)})}},{key:"_computeScreenRimWidth",value:function(e,t,r,n){return Object(Yl.h)(Ju,n.silCircleCenter,n.silCircleV2),Object(Yl.g)(Ku,Ju,this.outerRimFactor),Object(Jl.l)($u,t,Ju,r),Object(qu.j)(Ju,$u,e.projectionMatrix,e.viewport),Object(qu.j)(Ku,$u,e.projectionMatrix,e.viewport),Object(Yl.o)(Ju,Ku)/e.height}}]),e}();function Yu(e,t,r,n,i){var a=Object(Yl.r)(e),o=n*Math.sqrt(a*a-n*n)/a,s=Math.sqrt(n*n-o*o),c=i.silCircleV1,l=i.silCircleV2;return Object(Yl.g)(i.silCircleCenter,e,s/a),Object(Yl.i)(c,e,t),Object(Yl.v)(c)<1&&Object(Yl.i)(c,e,r),Object(Yl.g)(c,c,o/Object(Yl.r)(c)),Object(Yl.i)(l,c,e),Object(Yl.g)(l,l,o/Object(Yl.r)(l)),o}var $u=Object(Kl.d)(),Ju=Object(X.e)(),Ku=Object(X.e)();var ed=Object(hu.a)().vec3f("position"),td=Xu,rd=r(612),nd=function(e){Object(f.a)(r,e);var t=Object(p.a)(r);function r(){return Object(c.a)(this,r),t.apply(this,arguments)}return Object(l.a)(r,[{key:"initializeProgram",value:function(e){var t=r.shader.get().build();return new ou.a(e.rctx,t,au.a)}},{key:"initializePipeline",value:function(){return Object(su.g)({blending:Object(su.h)(770,1,771,771),depthTest:{func:515},colorWrite:su.d})}},{key:"bindPass",value:function(e){var t=e.camera,r=e.modelMatrix,n=this.makeInfiniteProjectionMatrix(t.projectionMatrix,t.near,id);Object(Jl.m)(n,n,t.viewMatrix),Object(Jl.m)(n,n,r),this.program.setUniformMatrix4fv("transform",n),this.program.setUniform4fv("viewport",t.fullViewport),this.program.setUniform1f("pixelRatio",t.pixelRatio)}},{key:"makeInfiniteProjectionMatrix",value:function(e,t,r){var n=24e-8;return Object(Jl.d)(r,e),r[10]=n-1,r[11]=-1,r[14]=(n-2)*t,r}}]),r}(nu.a);nd.shader=new ru.a(rd.a,(function(){return r.e(179).then(r.bind(null,1059))}));var id=Object(Kl.d)(),ad=j.a.getLogger("esri.views.3d.environment.Stars"),od=function(e){Object(f.a)(r,e);var t=Object(p.a)(r);function r(e){var n;return Object(c.a)(this,r),(n=t.call(this,e)).slot=14,n._loadDataTask=null,n._numPoints=0,n._modelMatrix=Object(Kl.d)(),n._updatingTracking=new fe.a,n._requestRender=function(){},n}return Object(l.a)(r,[{key:"updating",get:function(){return this._updatingTracking.updating||this.loading}},{key:"loading",get:function(){return Object(I.j)(this._loadDataTask)&&!this._loadDataTask.finished}},{key:"canRender",get:function(){return!this.loading}},{key:"initialize",value:function(){this._loadDataTask=this._createLoadDataTask()}},{key:"destroy",value:function(){this._loadDataTask=Object(I.a)(this._loadDataTask),this._updatingTracking.destroy(),this._numPoints=0,this._technique=Object(I.f)(this._technique),this._vao=Object(I.f)(this._vao),this._requestRender=null}},{key:"initializeRenderContext",value:function(e){this._requestRender=e.requestRender}},{key:"uninitializeRenderContext",value:function(){this.destroy()}},{key:"render",value:function(e){if(e.slot!==this.slot||0!==e.pass)return!1;if(this._ensureResources(e),Object(I.i)(this._technique)||Object(I.i)(this._vao))return!0;var t=e.rctx,r=this._technique.program;return t.useProgram(r),this._technique.bindPass({camera:e.camera,modelMatrix:this._modelMatrix}),this._technique.bindPipelineState(t),t.bindVAO(this._vao),r.assertCompatibleVertexAttributeLocations(this._vao),t.drawArrays(0,0,this._numPoints),!0}},{key:"_ensureResources",value:function(e){var t=this;if(!Object(I.j)(this._technique)&&!Object(I.i)(hd)){var r=e.rctx;this._technique=new nd({rctx:r,viewingMode:this.view.state.viewingMode},null),this._numPoints=hd.byteLength/ud;var n=new Float32Array(hd,0,2*this._numPoints),i=new Uint8Array(hd,2*this._numPoints*4,this._numPoints);this._vao=this._createVertexArrayObject(e.rctx,n,i,this._numPoints),this._updatingTracking.add(this.view,"environment.lighting.date",(function(e){return t._update(e)}),2)}}},{key:"_computeDayDuration",value:function(e){var t=e,r=new Date(e.getFullYear(),0,1,11,58,56);return(+t-+r)/(+new Date(e.getFullYear()+1,0,1,11,58,55)-+r)}},{key:"_update",value:function(e){if(e){var t=(e.getHours()/12+e.getMinutes()/60*(2/24)+e.getSeconds()/60*(2/1440)-.9972222)%2,r=2*this._computeDayDuration(e),n=this._modelMatrix;Object(Jl.d)(n,ld),Object(Jl.r)(n,n,-r*Math.PI),Object(Jl.m)(n,cd,n),Object(Jl.r)(n,n,-t*Math.PI),this._requestRender()}}},{key:"_hexToRGB",value:function(e){return[parseInt(e.substring(0,2),16),parseInt(e.substring(2,4),16),parseInt(e.substring(4,6),16)]}},{key:"_unpackUint8Attributes",value:function(e){return e>=192?[2.9,e-192]:e>=160?[2.5,e-160]:e>=128?[2,e-128]:e>=96?[1.5,e-96]:e>=64?[1,e-64]:e>=32?[.7,e-32]:[.4,e]}},{key:"_createVertexArrayObject",value:function(e,t,r,n){for(var i=dd.createBuffer(n),a=i.position,o=i.color,s=i.size,c=0;c<n;c++){var l=t[2*c+0],u=t[2*c+1];a.set(c,0,-Math.cos(l)*Math.sin(u)),a.set(c,1,-Math.sin(l)*Math.sin(u)),a.set(c,2,-Math.cos(u));var d=this._unpackUint8Attributes(r[c]),h=this._hexToRGB(sd[d[1]]);o.set(c,0,255*h[0]),o.set(c,1,255*h[1]),o.set(c,2,255*h[2]),o.set(c,3,255),s.set(c,d[0])}return new yu.a(e,au.a,{geometry:Object(du.a)(dd)},{geometry:bu.a.createVertex(e,35044,i.buffer)})}},{key:"_createLoadDataTask",value:function(){var e=this;if(Object(I.j)(hd))return null;var t=Object(q.i)(function(){var t=Object(s.a)(o.a.mark((function t(r){var n,i;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(_t.a)("esri/views/3d/environment/resources/stars.wsv",{responseType:"array-buffer",signal:r});case 2:n=t.sent,i=n.data,e._verifyStarData(i),hd=i;case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}());return t.promise.catch((function(e){Object(q.n)(e)||ad.error(e)})).then((function(){e.destroyed||(e._requestRender(),e.notifyChange("updating"))})),t}},{key:"_verifyStarData",value:function(e){if(!e)throw new U.a("stars:no-data-received","Failed to create stars because star catalogue is missing");var t=e.byteLength/ud;if(t%1!=0||t>5e4||t<5e3)throw new U.a("stars:invalid-data","Failed to create stars because star catalogue data is invalid")}}]),r}(de.a);Object(b.a)([Object(y.b)({constructOnly:!0})],od.prototype,"view",void 0),Object(b.a)([Object(y.b)({readOnly:!0})],od.prototype,"updating",null),Object(b.a)([Object(y.b)()],od.prototype,"_loadDataTask",void 0),Object(b.a)([Object(y.b)()],od.prototype,"_updatingTracking",void 0),od=Object(b.a)([Object(w.a)("esri.views.3d.environment.Stars")],od);var sd=["9bb2ff","9eb5ff","aabfff","bbccff","ccd8ff ","dae2ff","e4e9ff","eeefff","f8f6ff","fff9fb","fff5ef","fff1e5","ffeddb","ffe9d2","ffe6ca","ffe3c3","ffe0bb","ffddb4","ffdaad","ffd6a5","ffd29c","ffcc8f","ffc178","ffa94b","ff7b00"],cd=Object(Kl.e)(1,0,0,0,0,.9174771405229186,.39778850739794974,0,0,-.39778850739794974,.9174771405229186,0,0,0,0,1),ld=Object(Kl.e)(1,0,0,0,0,.9174771405229186,-.39778850739794974,0,0,.39778850739794974,.9174771405229186,0,0,0,0,1),ud=9,dd=Object(hu.a)().vec3f("position").vec4u8("color").f32("size"),hd=null,fd=[14,15],pd=function(e){Object(f.a)(r,e);var t=Object(p.a)(r);function r(){var e;return Object(c.a)(this,r),(e=t.apply(this,arguments))._handles=new oe.a,e._context=null,e._pendingAtmosphere=null,e._atmosphere=null,e._stars=null,e}return Object(l.a)(r,[{key:"canRender",get:function(){return!(!this.view.basemapTerrain||!this.view.basemapTerrain.renderer.canRender)||"global"!==this.view.viewingMode}},{key:"updating",get:function(){return Object(I.j)(this._pendingAtmosphere)||Object(I.j)(this._stars)&&this._stars.updating}},{key:"initialize",value:function(){this.view._stage.addRenderPlugin(fd,this)}},{key:"destroy",value:function(){this._pendingAtmosphere=Object(I.e)(this._pendingAtmosphere),this._atmosphere=Object(I.e)(this._atmosphere),this._stars=Object(I.e)(this._stars),this._handles=Object(I.e)(this._handles),this.view&&null!=this.view._stage&&(this.view._stage.removeRenderPlugin(this),this._set("view",null))}},{key:"initializeRenderContext",value:function(e){this._context=e,this.setup()}},{key:"setup",value:function(){var e=this;this._handles.add(Object(W.f)(this.view,"basemapTerrain",(function(){return e._updateBasemapTerrain()}),!0)),this._handles.add([Object(W.a)(this.view,["viewingMode","environment.atmosphereEnabled","environment.atmosphere.quality"],(function(){return e._updateAtmosphere()}),!0),Object(W.a)(this.view,"environment.starsEnabled",(function(){return e._updateStars()}),!0)])}},{key:"uninitializeRenderContext",value:function(){Object(I.j)(this._stars)&&(this._stars.uninitializeRenderContext(),this._stars.destroy(),this._stars=null),Object(I.j)(this._atmosphere)&&(this._atmosphere.uninitializeRenderContext(),this._atmosphere.destroy(),this._atmosphere=null)}},{key:"render",value:function(e){var t=!0;return Object(I.j)(this._stars)&&this._stars.canRender&&(t=this._stars.render(e)&&t),Object(I.j)(this._atmosphere)&&this._atmosphere.canRender&&(t=this._atmosphere.render(e)&&t),t}},{key:"_setNeedsRender",value:function(){this._context&&this._context.requestRender()}},{key:"_updateStars",value:function(){var e,t,r,n=null!=(e=null==(t=this.view)||null==(r=t.environment)?void 0:r.starsEnabled)&&e;n&&Object(I.i)(this._stars)?(this._stars=new od({view:this.view}),this._stars.initializeRenderContext(this._context),this._setNeedsRender()):!n&&Object(I.j)(this._stars)&&(this._stars.destroy(),this._stars=null,this._setNeedsRender())}},{key:"_updateAtmosphere",value:function(){var e=this,t=this._getAtmosphereType();if(this.atmosphereType!==t){this.atmosphereType=t,Object(I.j)(this._pendingAtmosphere)&&(this._pendingAtmosphere!==this._atmosphere&&this._pendingAtmosphere.destroy(),this._pendingAtmosphere=null);var r=this._getAtmosphereClass();if(!r)return Object(I.j)(this._atmosphere)&&(this._atmosphere.destroy(),this._atmosphere=null,this._setNeedsRender()),void this._updateBasemapTerrain();var n=new r(this.view);n.initializeRenderContext(this._context),Object(I.i)(this._atmosphere)&&(this._atmosphere=n,this._setNeedsRender()),this._pendingAtmosphere=n,n.when().then((function(){Object(I.j)(e._atmosphere)&&e._pendingAtmosphere!==e._atmosphere&&(e._atmosphere.destroy(),e._atmosphere=e._pendingAtmosphere),e._pendingAtmosphere=null,e._setNeedsRender(),e._updateBasemapTerrain()})).catch((function(){e._pendingAtmosphere===n&&(e._pendingAtmosphere=null)}))}}},{key:"_getAtmosphereClass",value:function(){var e=this._getAtmosphereType();if(this.atmosphereClassFromType)return this.atmosphereClassFromType(e);switch(e){case"none":return null;case"realistic":return Au;case"panoramic":return wu;case"simple":return td;default:return}}},{key:"_getAtmosphereType",value:function(){var e=this.view.get("environment.atmosphereEnabled"),t=this.view.get("environment.atmosphere.quality"),r=this.view.viewingMode;return!e||null==t||Object(qs.i)(this.view.spatialReference)?"none":"local"===r?"panoramic":"high"===t&&Au.isSupported(this._context)&&!Object(qs.h)(this.view.spatialReference)?"realistic":"simple"}},{key:"_updateBasemapTerrain",value:function(){var e=this.view.basemapTerrain;e&&(e.velvetOverground=null!=this._atmosphere&&"simple"===this.atmosphereType)}},{key:"test",get:function(){return{atmosphere:this._atmosphere}}}]),r}(de.a);Object(b.a)([Object(y.b)({constructOnly:!0})],pd.prototype,"view",void 0),Object(b.a)([Object(y.b)({constructOnly:!0})],pd.prototype,"atmosphereClassFromType",void 0),Object(b.a)([Object(y.b)()],pd.prototype,"updating",null),Object(b.a)([Object(y.b)()],pd.prototype,"_pendingAtmosphere",void 0),Object(b.a)([Object(y.b)()],pd.prototype,"_stars",void 0);var bd=pd=Object(b.a)([Object(w.a)("esri.views.3d.environment.EnvironmentRenderer")],pd);function vd(e,t,r){return function(e,t,r,n,i){var a=Object(m.g)(r),o=Object(m.g)(i),s=a-o,c=Object(m.g)(t)-Object(m.g)(n),l=Math.sin(s/2),u=Math.sin(c/2),d=2*Object(m.c)(Math.sqrt(l*l+Math.cos(a)*Math.cos(o)*u*u))*e;return Math.round(1e4*d)/1e4}(e,t.longitude,t.latitude,r.longitude,r.latitude)}function md(e,t,r){var n=t.spatialReference,i=Object(J.e)(n),a=new S.a(t.x,e.y,n),o=new S.a(r.x,e.y,n),s=new S.a(e.x,t.y,n),c=new S.a(e.x,r.y,n);return{lon:vd(i.radius,a,o),lat:vd(i.radius,s,c)}}function yd(e,t){var r=e/15;return t||(r=Math.round(r)),r}function gd(e,t){t||(t={hours:0,minutes:0,seconds:0}),t.hours=yd(e[0],!0);var r=t.hours%1;t.hours-=r,t.minutes=60*r;var n=t.minutes%1;return t.minutes-=n,t.seconds=Math.round(60*n),t}var Od,jd,_d={exports:{}};Od=_d,void 0!==(jd=function(){var e=Math.PI,t=Math.sin,r=Math.cos,n=Math.tan,i=Math.asin,a=Math.atan2,o=Math.acos,s=e/180,c=864e5,l=2440588,u=2451545,d={dec:0,ra:0};function h(e){return new Date((e+.5-l)*c)}function f(e){return function(e){return e.valueOf()/c-.5+l}(e)-u}var p=23.4397*s;function b(e,i){return a(t(e)*r(p)-n(i)*t(p),r(e))}function v(e,n){return i(t(n)*r(p)+r(n)*t(p)*t(e))}function m(e,i,o){return a(t(e),r(e)*t(i)-n(o)*r(i))}function y(e,n,a){return i(t(n)*t(a)+r(n)*r(a)*r(e))}function g(e,t){return s*(280.16+360.9856235*e)-t}function O(e){return s*(357.5291+.98560028*e)}function j(e){return s*(1.9148*t(e)+.02*t(2*e)+3e-4*t(3*e))}function _(t,r){return t+r+102.9372*s+e}function w(e,t){var r=O(e),n=_(r,j(r));return t||(t={dec:0,ra:0}),t.dec=v(n,0),t.ra=b(n,0),t}var x={POLAR_EXCEPTION:{NORMAL:0,MIDNIGHT_SUN:1,POLAR_NIGHT:2},getPosition:function(e,t,r,n){var i=s*-r,a=s*t,o=f(e),c=w(o,d),l=g(o,i)-c.ra;return n||(n={azimuth:0,altitude:0}),n.azimuth=m(l,a,c.dec),n.altitude=y(l,a,c.dec),n}},k=[[-.83,"sunrise","sunset"]];x.addTime=function(e,t,r){k.push([e,t,r])};var S=9e-4;function T(t,r){return Math.round(t-S-r/(2*e))}function C(t,r,n){return S+(t+r)/(2*e)+n}function M(e,r,n){return u+e+.0053*t(r)-.0069*t(2*n)}function P(e,n,i){return o((t(e)-t(n)*t(i))/(r(n)*r(i)))}function A(e){var n=s*(134.963+13.064993*e),i=s*(93.272+13.22935*e),a=s*(218.316+13.176396*e)+6.289*s*t(n),o=5.128*s*t(i),c=385001-20905*r(n);return{ra:b(a,o),dec:v(a,o),dist:c}}return x.getTimes=function(e,n,i){var a=s*-i,o=s*n,c=T(f(e),a),l=C(0,a,c),u=O(l),d=j(u),p=_(u,d),b=v(p,0),m=M(l,u,p);function y(e){return M(C(P(e,o,b),a,c),u,p)}var g,w,S,A,E,R={solarNoon:h(m),nadir:h(m-.5),polarException:x.POLAR_EXCEPTION.NORMAL};for(g=0,w=k.length;g<w;g+=1)E=m-((A=y((S=k[g])[0]*s))-m),R[S[1]]=h(E),R[S[2]]=h(A);return R.polarException=function(e){var n=(t(e)-t(o)*t(b))/(r(o)*r(b));return n<-1?x.POLAR_EXCEPTION.MIDNIGHT_SUN:n>1?x.POLAR_EXCEPTION.POLAR_NIGHT:x.POLAR_EXCEPTION.NORMAL}(k[0][0]*s),R},x.getMoonPosition=function(e,t,r){var i=s*-r,a=s*t,o=f(e),c=A(o),l=g(o,i)-c.ra,u=y(l,a,c.dec);return u+=.017*s/n(u+10.26*s/(u+5.1*s)),{azimuth:m(l,a,c.dec),altitude:u,distance:c.dist}},x.getMoonFraction=function(e){var n=f(e),i=w(n),s=A(n),c=149598e3,l=o(t(i.dec)*t(s.dec)+r(i.dec)*r(s.dec)*r(i.ra-s.ra)),u=a(c*t(l),s.dist-c*r(l));return(1+r(u))/2},x}())&&(Od.exports=jd);var wd=_d.exports,xd={local:{altitude:1500,ambientAtNight:.1,ambientAtNoon:.45,ambientAtTwilight:.2,diffuseAtNoon:.65,diffuseAtTwilight:.7},global:{altitude:8e5,ambient:.015,diffuse:.75},planarDirection:{localAltitude:1e4,globalAltitude:1e6,globalAngles:{azimuth:1.3*Math.PI,altitude:.6*Math.PI}}};function kd(e,t){var r=t[2],n=Md;Object(Yl.y)(n.ambient.color,1,1,1),n.ambient.intensity=xd.global.ambient,Object(Yl.y)(n.diffuse.color,1,1,1),n.diffuse.intensity=xd.global.diffuse;var i=(Math.abs(r)-xd.local.altitude)/(xd.global.altitude-xd.local.altitude);i=Object(m.e)(i,0,1),n.globalFactor=i;var a=wd.getTimes(e,t[1],t[0]);if(i<1){var o=function(e,t){var r,n,i=e.valueOf();t.polarException===wd.POLAR_EXCEPTION.MIDNIGHT_SUN?(r=i-60*(e.getHours()+48)*60*1e3-60*e.getMinutes()*1e3,n=r+432e6):t.polarException===wd.POLAR_EXCEPTION.POLAR_NIGHT?(r=i-2,n=i-1):(r=t.sunrise.valueOf(),n=t.sunset.valueOf());var a,o,s=n-r,c=r+s/2,l=s/4,u=c-l,d=c+l,h=.06*s,f=r-h/2,p=r+h/2,b=n-h/2,v=n+h/2,m=xd.local,y=[.01,m.ambientAtNight],g=[.8,.8,1],O=[.01,.01,.01],j=[m.diffuseAtTwilight,m.ambientAtTwilight],_=[1,.75,.75],w=[.8,.8,1],x=[.9*m.diffuseAtNoon,m.ambientAtNoon],k=[1,.98,.98],S=[.98,.98,1],T=[m.diffuseAtNoon,m.ambientAtNoon],C=[1,1,1],M=[1,1,1],P=x,A=k,E=S,R=j,I=_,D=w,F=[0,0],L=[0,0,0],z=[0,0,0];return i<f||i>v?(F=y,L=O,z=g,o="night"):i<p?(F=Pd(i-f,a=p-f,y,j),L=Pd(i-f,a,O,_),z=Pd(i-f,a,g,w),o="sun rising"):i<u?(F=Pd(i-p,a=u-p,j,x),L=Pd(i-p,a,_,k),z=Pd(i-p,a,w,S),o="early morning"):i<c?(F=Pd(i-u,a=c-u,x,T),L=Pd(i-u,a,k,C),z=Pd(i-u,a,S,M),o="late morning"):i<d?(F=Pd(i-c,a=d-c,T,P),L=Pd(i-c,a,C,A),z=Pd(i-c,a,M,E),o="early afternoon"):i<b?(F=Pd(i-d,a=b-d,P,R),L=Pd(i-d,a,A,I),z=Pd(i-d,a,E,D),o="late afternoon"):i<v&&(F=Pd(i-b,a=v-b,R,y),L=Pd(i-b,a,I,O),z=Pd(i-b,a,D,g),o="sun setting"),{diffuse:{intensity:F[0],color:Object(X.g)(L[0],L[1],L[2])},ambient:{intensity:F[1],color:Object(X.g)(z[0],z[1],z[2])},timeOfDay:o}}(e,a);Object(Yl.k)(n.ambient.color,o.ambient.color,n.ambient.color,i),n.ambient.intensity=Object(m.m)(o.ambient.intensity,n.ambient.intensity,i),Object(Yl.k)(n.diffuse.color,o.diffuse.color,n.diffuse.color,i),n.diffuse.intensity=Object(m.m)(o.diffuse.intensity,n.diffuse.intensity,i)}return n.noonFactor=function(e,t){var r,n,i=e.valueOf();t.polarException===wd.POLAR_EXCEPTION.MIDNIGHT_SUN?(r=i-60*(e.getHours()+48)*60*1e3-60*e.getMinutes()*1e3,n=r+432e6):t.polarException===wd.POLAR_EXCEPTION.POLAR_NIGHT?(r=i-2,n=i-1):(r=t.sunrise.valueOf(),n=t.sunset.valueOf());var a=r+(n-r)/2;return 1-Object(m.e)(Math.abs(i-a)/432e5,0,1)}(e,a),n}function Sd(e,t,r,n){n||(n=Object(X.e)());var i=Cd,a=Object(Jl.i)(Td);if("global"===r)wd.getPosition(e,0,0,i),Object(Yl.y)(n,0,0,-1),Object(Jl.b)(a,a,-i.azimuth),Object(Jl.j)(a,a,-i.altitude),Object(Yl.s)(n,n,a);else{var o=xd.planarDirection,s=o.globalAngles,c=t[2],l=(Math.abs(c)-o.localAltitude)/(o.globalAltitude-o.localAltitude);(l=Object(m.e)(l,0,1))<1?(wd.getPosition(e,t[1],t[0],i),i.azimuth=(1-l)*i.azimuth+l*s.azimuth,i.altitude=(1-l)*i.altitude+l*s.altitude):(i.azimuth=s.azimuth,i.altitude=s.altitude),Object(Yl.y)(n,0,-1,0),Object(Jl.r)(a,a,-i.azimuth),Object(Jl.b)(a,a,-i.altitude),Object(Yl.s)(n,n,a)}return n}var Td=Object(Kl.d)(),Cd={azimuth:0,altitude:0},Md={ambient:{color:Object(X.e)(),intensity:0},diffuse:{color:Object(X.e)(),intensity:0,directionToLightSource:Object(X.e)()},globalFactor:0,noonFactor:0};function Pd(e,t,r,n){for(var i=[],a=0;a<r.length;a++)i[a]=(n[a]-r[a])*e/t+r[a];return i}new Date(0);var Ad=r(231),Ed=Object(X.g)(.5773502691896258,-.5773502691896258,.5773502691896258),Rd=function(e){Object(f.a)(r,e);var t=Object(p.a)(r);function r(){var e;Object(c.a)(this,r);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return(e=t.call.apply(t,[this].concat(i)))._referencePointUpdateDelay=200,e._referencePointUpdateInterval=3e3,e._referencePointUpdateDistThreshold=1e6,e._referencePosUpdateQuery=null,e._referencePosMapCoordsRequested=null,e._viewHandles=new oe.a,e._preserveAbsoluteDateTime=!1,e._trackingEnabled=!1,e._referencePosResetPreserveAbsoluteTime=!1,e.referencePosUpdateTimer=null,e._referencePosMapCoords=null,e._mainLight=new Ad.c,e._ambientLight=new Ad.a,e._moonLight=new Ad.b,e._renderer=null,e._referencePosWGS84Comparable=null,e._resetReferencePosition(),e}return Object(l.a)(r,[{key:"destroy",value:function(){this.disconnectView(),this._viewHandles.destroy()}},{key:"updating",get:function(){return!!(!this.disableQueries&&(this._referencePosUpdateQuery||this._referencePosMapCoordsRequested)||this._renderer&&this._renderer.updating)}},{key:"referencePositionWGS84Comparable",get:function(){return this._referencePosWGS84Comparable}},{key:"connectView",value:function(e){var t=this;this._renderer||(this._view=e,this._renderer=new bd({view:e}),this._viewHandles.add([e.watch("environment.lighting.date",(function(e){return t._lightingDateHandler(e)}),!0),e.watch("stationary",(function(){return t._interactingStationaryHandler()})),e.watch(["environment.lighting.directShadowsEnabled","environment.lighting.ambientOcclusionEnabled","environment.lighting.waterReflectionEnabled","environment.background.color"],(function(){return t._updateRenderParamsHandler()}),!0),e.watch("spatialReference",(function(){return t._resetReferencePosition(!0)}),!0),Object(W.a)(e,"viewingMode",(function(){return t._resetReferencePosition(!0)}),!0),Object(W.a)(e,"environment.lighting.cameraTrackingEnabled",(function(e){return t._updateCameraTracking(e)}),!0),Object(W.a)(e,"state.camera",(function(){return t._cameraHandler(null)}),!0),this.watch("disableQueries",(function(){return t._cameraHandler(null)}))]),this._updateRenderParamsHandler(),this._updateLightParams(),this._cameraHandler(),this.notifyChange("updating"))}},{key:"disconnectView",value:function(){this._renderer&&(this._viewHandles.removeAll(),this._resetReferencePosition(),this._renderer.destroy(),this._renderer=null,this._view=null)}},{key:"_updateCameraTracking",value:function(e){if(this._trackingEnabled=e,e)this._cameraHandler();else{var t=this._view.environment.lighting;t&&(t.positionTimezoneInfo.autoUpdated=!1)}}},{key:"_lightingDateHandler",value:function(e){if(e){var t=this._view.environment.lighting;if(!t.positionTimezoneInfo.autoUpdated){this._preserveAbsoluteDateTime=!0;var r=this._view.spatialReference;if(!Object($.a)(r)){var n=this._view.camera.position;if(!this._referencePosMapCoords||!this._referencePosMapCoords.equals(n))return void this._requestReferencePositionUpdate(n)}if(this._preupdateTracking(e),Object(I.j)(this._referencePosWGS84Comparable)){var i=gd(this._referencePosWGS84Comparable,Dd);Object(I.j)(i)&&(t.autoUpdate(null,i),this._trackingEnabled&&(t.positionTimezoneInfo.autoUpdated=!0))}}this._updateLightParams(e)}}},{key:"_preupdateTracking",value:function(e){!this._trackingEnabled&&this._view.environment.lighting.cameraTrackingEnabled&&this._cameraHandler(e)}},{key:"_cameraHandler",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;if(this._view.ready){var t=this._view.camera;t&&(this._cameraHandlerClientSide(t,e)||this._cameraHandlerServerSide(t))}}},{key:"_cameraHandlerClientSide",value:function(e,t){var r=Object(qs.f)(this._view.spatialReference);if(r&&!Object($.a)(this._view.spatialReference))return!1;var n=e.position;return Object(I.i)(this._referencePosWGS84Comparable)&&(this._referencePosWGS84Comparable=Object(X.e)()),r?Object($.v)(n,this._referencePosWGS84Comparable):Object(Yl.y)(this._referencePosWGS84Comparable,n.longitude,n.latitude,n.z),this.notifyChange("referencePositionWGS84Comparable"),this._autoUpdateTimezone(this._referencePosWGS84Comparable,t)||this._updateLightParams(t),!0}},{key:"_cameraHandlerServerSide",value:function(e){var t=e.position;(!this._referencePosMapCoords||this._referencePosMapCoordsRequested||this._exceedsReferencePosDistThreshold(t))&&this._requestReferencePositionUpdate(t,!0),this._view.mapCoordsHelper&&this._referencePosWGS84Comparable&&(this._referencePosWGS84Comparable[2]=t.z*this._view.mapCoordsHelper.unitInMeters,this._referencePosChanged())}},{key:"_interactingStationaryHandler",value:function(){this._view.stationary&&this._executePendingReferencePositionUpdate()}},{key:"_updateLightParams",value:function(e){var t=this._view.environment.lighting;e=e||t.date;var r,n=this._view._stage;Object(I.j)(this._referencePosWGS84Comparable)?(r=kd(e,this._referencePosWGS84Comparable),Sd(e,this._referencePosWGS84Comparable,this._view.viewingMode,r.diffuse.directionToLightSource)):r={diffuse:{color:[1,1,1],intensity:.55,directionToLightSource:Ed},ambient:{color:[1,1,1],intensity:.55},noonFactor:.5,globalFactor:0},Object(Yl.g)(this._mainLight.intensity,r.diffuse.color,r.diffuse.intensity*Math.PI),Object(Yl.m)(this._mainLight.direction,r.diffuse.directionToLightSource),Object(Yl.g)(this._ambientLight.intensity,r.ambient.color,r.ambient.intensity),Object(Yl.k)(this._moonLight.intensity,Fd,Ld,r.globalFactor);var i=(1-.5*r.globalFactor)*(1-.4*r.noonFactor*(1-r.globalFactor));Object(Yl.g)(this._moonLight.intensity,this._moonLight.intensity,i),Object(Yl.m)(this._moonLight.direction,r.diffuse.directionToLightSource),n.renderView.updateLightSources([this._mainLight,this._ambientLight,this._moonLight],1-r.noonFactor,r.globalFactor),this._updateRenderParamsHandler()}},{key:"_autoUpdateTimezone",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(!this._view.environment.lighting.cameraTrackingEnabled||Object(I.i)(e))return!1;var r=Id;r.setTime((t||this._view.environment.lighting.date).getTime());var n=gd(e,Dd);if(Object(I.i)(n))return!1;var i=this._view.environment.lighting.positionTimezoneInfo;if(i.autoUpdated){if(i.hours===n.hours&&i.minutes===n.minutes&&i.seconds===n.seconds)return!1}else i=n;var a=r.getUTCHours()-(n.hours-i.hours),o=r.getUTCMinutes()-(n.minutes-i.minutes),s=r.getUTCSeconds()-(n.seconds-i.seconds);return r.setUTCHours(a),r.setUTCMinutes(o),r.setUTCSeconds(s),!t&&this._view.environment.lighting.autoUpdate(r,n)}},{key:"_updateRenderParamsHandler",value:function(){var e=this,t=this._view._stage;if(t){var r=Object(I.m)(this._referencePosWGS84Comparable,!0,(function(t){return function(e,t){if("global"===t)return!0;var r=xd.planarDirection,n=e[2];return Math.abs(n)<r.localAltitude}(t,e._view.viewingMode)})),n=this._view.environment.background,i=n instanceof Vl?{type:"color",color:Object($l.d)(Il.a.toUnitRGBA(n.color))}:{type:"color",color:Object($l.g)(0,0,0,1)};t.renderView.setRenderParameters({shadowMap:this._view.environment.lighting.directShadowsEnabled&&r,ssao:this._view.environment.lighting.ambientOcclusionEnabled,waterReflectionEnabled:this._view.environment.lighting.waterReflectionEnabled,background:i})}}},{key:"_resetReferencePosition",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this._cancelReferencePosUpdates(),this._referencePosMapCoords=null,this._referencePosMapCoordsRequested=null,this._referencePosResetPreserveAbsoluteTime=null,this._referencePosWGS84Comparable=null,this.notifyChange("updating"),e&&this._cameraHandler(null)}},{key:"_requestReferencePositionUpdate",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!this.disableQueries&&(this._referencePosMapCoordsRequested?this._referencePosMapCoordsRequested.copy(e):this._referencePosMapCoordsRequested=e.clone(),this._referencePosResetPreserveAbsoluteTime=!!r,!this._referencePosUpdateQuery&&!this.referencePosUpdateTimer&&this._view.stationary)){var n=this._referencePosUpdateQuery=Object(q.a)(this._referencePointUpdateDelay).then((function(){if(t._referencePosUpdateQuery===n){return t._doReferencePositionUpdateQuery((function(){return t._referencePosUpdateQuery!==n}))}})).catch((function(e){"mapcoordshelper:missing-geometry-service"===e.name&&(t.disableQueries=!0)})).then((function(){t._referencePosUpdateQuery===n&&(t._referencePosUpdateQuery=null,t.referencePosUpdateTimer||t._executePendingReferencePositionUpdate(),t.notifyChange("updating"))})),i=this.referencePosUpdateTimer=Object(q.a)(this._referencePointUpdateInterval).then((function(){t.referencePosUpdateTimer===i&&(t.referencePosUpdateTimer=null,t._referencePosUpdateQuery||t._executePendingReferencePositionUpdate())}));this.notifyChange("updating")}}},{key:"_doReferencePositionUpdateQuery",value:function(){var e=Object(s.a)(o.a.mark((function e(t){var r,n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this._referencePosResetPreserveAbsoluteTime&&(this._preserveAbsoluteDateTime=!1),this._referencePosMapCoords?this._referencePosMapCoords.copy(this._referencePosMapCoordsRequested):this._referencePosMapCoords=this._referencePosMapCoordsRequested.clone(),this._referencePosResetPreserveAbsoluteTime=null,this._referencePosMapCoordsRequested=null,e.next=3,this._view.mapCoordsHelper.toGeographic(this._referencePosMapCoords);case 3:r=e.sent,t()||isNaN(r[0])||isNaN(r[1])||(n=this._referencePosMapCoords.z*this._view.mapCoordsHelper.unitInMeters,this._referencePosWGS84Comparable?(this._referencePosWGS84Comparable[0]=r[0],this._referencePosWGS84Comparable[1]=r[1],this._referencePosWGS84Comparable[2]=n):this._referencePosWGS84Comparable=[r[0],r[1],n],this._referencePosChanged());case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_executePendingReferencePositionUpdate",value:function(){var e=this._referencePosMapCoordsRequested;e&&this._requestReferencePositionUpdate(e,this._referencePosResetPreserveAbsoluteTime)}},{key:"_referencePosChanged",value:function(){this._preserveAbsoluteDateTime?this._updateLightParams():this._autoUpdateTimezone(this._referencePosWGS84Comparable)||this._updateLightParams(),this.notifyChange("referencePositionWGS84Comparable")}},{key:"_exceedsReferencePosDistThreshold",value:function(e){if(this._referencePosMapCoords){var t=this._referencePosMapCoords.distance(e);return this._view.mapCoordsHelper&&(t*=this._view.mapCoordsHelper.unitInMeters),t>this._referencePointUpdateDistThreshold}return!0}},{key:"_cancelReferencePosUpdates",value:function(){var e=!!this._referencePosUpdateQuery;return this._referencePosUpdateQuery=null,this.referencePosUpdateTimer=null,e}},{key:"test",get:function(){var e=this;return{renderer:this._renderer,set referencePointUpdateInterval(t){e._referencePointUpdateInterval=t},set referencePointUpdateDistThreshold(t){e._referencePointUpdateDistThreshold=t},set referencePosUpdateTimer(t){e.referencePosUpdateTimer=t},set referencePointUpdateDelay(t){e._referencePointUpdateDelay=t}}}}]),r}(Ii.a.EventedAccessor);Rd.FIXED_LIGHT_DIRECTION=Ed,Object(b.a)([Object(y.b)({type:Boolean,readOnly:!0})],Rd.prototype,"updating",null),Object(b.a)([Object(y.b)()],Rd.prototype,"disableQueries",void 0),Object(b.a)([Object(y.b)()],Rd.prototype,"referencePositionWGS84Comparable",null),Object(b.a)([Object(y.b)()],Rd.prototype,"_renderer",void 0),Object(b.a)([Object(y.b)()],Rd.prototype,"_referencePosWGS84Comparable",void 0),Rd=Object(b.a)([Object(w.a)("esri.views.3d.environment.SceneViewEnvironmentManager")],Rd);var Id=new Date,Dd={hours:0,minutes:0,seconds:0},Fd=Object(X.g)(.22,.22,.33),Ld=Object(X.g)(.22,.22,.22),zd=Rd,Vd=r(75),Nd=r(70),Ud=r(79);function Bd(e,t){return 0!=(e&t)}function Gd(e,t,r,n,i,a){0!==e&&(r?(a.min=Math.min(a.min,t),a.max=Math.max(a.max,t)):null!=n?(a.min-=Math.max(0,(t-a.min)*(1-n)),a.max+=Math.max(0,(t-a.max)*(1-n))):i&&(a.min-=Math.max(0,t-a.min-i),a.max+=Math.max(0,t-a.max-i)))}var qd={selection:0,interactionType:0,interactionFactor:0,interactionStartCamera:null,interactionDirection:null,tiltMode:0};function Hd(e,t,r,n){return t=t||e.viewForward,Object(Yl.m)(n,t),Object(Yl.g)(n,n,Object(m.t)(Object(Yl.j)(t,r))),n}var Wd=r(521);function Qd(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:qd;if(!Zd(e,r))return 0;var n=$d(e.state.constraints.altitude,Jd);Xd(e,r,n);var i=e.renderCoordsHelper.getAltitude(t.eye),a=Object(m.e)(i,n.min,n.max)-i;return Math.abs(a)<=1e-6?0:a}function Zd(e,t){var r=e.state.constraints.altitude;return!(!e.state.isGlobal||!r)&&(2!==t.interactionType||!Bd(t.selection,1))}function Xd(e,t,r){var n=t.interactionType;if(0!==n){var i=r.min,a=r.max,o=t.interactionStartCamera,s=t.interactionFactor,c=2===n||1===n,l=Qd(e,o),u=0===l?0:e.renderCoordsHelper.getAltitude(o.eye);r.min=i,r.max=a,Gd(l,u,c,s,.05*u,r)}}function Yd(e,t,r,n){return e.renderCoordsHelper.worldUpAtPosition(t.eye,n),Object(Yl.g)(n,n,r),n}function $d(e,t){return t.min=e.min,t.max=e.max,t}var Jd={min:0,max:0},Kd=Object(X.e)(),eh=Object(X.e)(),th=Object(X.e)(),rh=Object(X.e)();function nh(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:qd;if(!e.state.isLocal)return 0;var n=e.state.constraints.distance;if(!e.pointsOfInterest.surfaceOrigin.renderLocation||n===1/0)return 0;sh.min=0,sh.max=n,ih(e,r,sh);var i=ah(e,t),a=sh.max-i;return a>=-1e-6?0:a}function ih(e,t,r){var n=t.interactionType;if(0!==n){var i=r.min,a=r.max,o=t.interactionStartCamera,s=t.interactionFactor,c=1===n||4===n,l=nh(e,o),u=0===l?0:ah(e,o);r.min=i,r.max=a,Gd(l,u,c,s,.05*u,r)}}function ah(e,t){var r=e.pointsOfInterest.surfaceOrigin;return Object(Yl.o)(t.eye,r.renderLocation)}function oh(e,t,r){var n=e.pointsOfInterest.surfaceOrigin;return Object(Yl.x)(r,t.eye,n.renderLocation)}var sh={min:0,max:0},ch=Object(X.e)(),lh=Object(X.e)(),uh=Object(X.e)(),dh=Object(X.e)(),hh=Object(X.e)(),fh=r(144);function ph(e,t,r,n){return Object(I.j)(e.renderCoordsHelper.fromRenderCoords(t.eye,gh,n))&&Object(K.h)(r,gh)}function bh(e,t){return e.elevationProvider?Object(I.t)(e.elevationProvider.getElevation(t[0],t[1],t[2],e.renderCoordsHelper.spatialReference,"ground"),0):0}function vh(e,t,r,n){var i=e.state.camera.clone();t&&(i.eye=t,i.center=r,i.up=n),function(e,t,r){var n=yh[e.viewingMode];n||((n=new fh.a(e.state.viewingMode)).options.backfacesTerrain=!e.state.isGlobal,n.options.invisibleTerrain=!0,yh[e.viewingMode]=n);var i=e.state.isGlobal;return!(!e.sceneIntersectionHelper.intersectRay(t,n,r)||mh(e,t.origin,r))||!(!e.renderCoordsHelper.intersectManifold(t,0,r)||mh(e,t.origin,r))||!!i&&function(e,t,r){var n=Object(Yl.j)(e.origin,e.origin)-r*r,i=n>0?Math.sqrt(n)/3:1;return Object(Yl.g)(t,e.direction,i/Object(Yl.r)(e.direction)),Object(Yl.h)(t,t,e.origin),!0}(t,r,Object(J.e)(e.spatialReference).radius)}(e,i.ray,Oh)||Object(Yl.m)(Oh,i.center);var a=e.state.constraints,o=a.minimumPoiDistance;if(Object(Yl.n)(i.eye,Oh)<o){var s=a.collision.enabled;Object(Yl.m)(jh,i.viewForward),Object(Yl.g)(jh,jh,o),s?i.eye=Object(Yl.l)(gh,Oh,jh):Object(Yl.h)(Oh,i.eye,jh);var c=e.renderCoordsHelper,l=c.getAltitude(i.eye),u=a.collision.elevationMargin;s&&l<u&&(Object(Yl.l)(jh,Oh,i.eye),i.eye=c.setAltitude(gh,u,i.eye),Object(Yl.h)(Oh,i.eye,jh))}return i.center=Oh,i}function mh(e,t,r){if(!e.state.isGlobal)return!1;var n=bh(e,t),i=e.stateManager.constraintsManager.nearFarHeuristic.compute(t,r,e.dataExtent,n,_h).far,a=i*i;return Object(Yl.n)(t,r)>a}var yh={},gh=Object(X.e)(),Oh=Object(X.e)(),jh=Object(X.e)(),_h={near:0,far:0};function wh(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=e.state.constraints;if(!n.collision.enabled)return!1;var i=bh(e,t.eye),a=e.renderCoordsHelper.getAltitude(t.eye),o=i+n.collision.elevationMargin;if(a>=o)return!1;var s=Object(Yl.r)(t.eye);if(Object(Yl.l)(xh,t.center,t.eye),t.eye=e.renderCoordsHelper.setAltitude(kh,o,t.eye),1===r)t.center=Object(Yl.h)(xh,t.eye,xh);else if(2===r){var c=(s-a+o)/s;t.center=Object(Yl.g)(xh,t.center,c)}return!0}var xh=Object(X.e)(),kh=Object(X.e)(),Sh=r(134);function Th(e,t,r){e.worldUpAtPosition(t,Ch),Object(Yl.l)(Mh,r,t);var n=Object(Yl.r)(Mh);return 0===n?0:Object(m.b)(Object(Yl.j)(Mh,Ch)/n)}var Ch=Object(X.e)(),Mh=Object(X.e)();function Ph(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:qd,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:qd,i=arguments.length>4?arguments[4]:void 0;if(!e.state.constraints.tilt)return 0;var a=t.distance,o=e.state.constraints.tilt(a,Uh);return Dh(e,r,o),2===n.interactionType&&Bd(n.selection,2)&&Fh(e,n.interactionStartCamera,o),1===r.tiltMode||1===n.tiltMode?Eh(e,t,o,i):Ah(e,t,o)}function Ah(e,t,r){var n=Th(e.renderCoordsHelper,t.center,t.eye),i=n-Object(m.e)(n,r.min,r.max);return Rh(i)?i:0}function Eh(e,t,r,n){switch(n&&(n.requiresTwoSteps=!1),e.viewingMode){case"global":return function(e,t,r,n){var i,a,o=function(e,t,r){var n=e.pointsOfInterest.centerOnSurfaceFrequent.estimatedSurfaceAltitude,i=n+Object(J.e)(e.spatialReference).radius,a=e.renderCoordsHelper.intersectManifold(t.ray,n,Vh);return r.eyeCenterDistance=t.distance,r.centerIsOnSurface=!1,Object(I.j)(a)?(r.eyeCenterDistance=Object(Yl.o)(t.eye,a),r.tiltAtCenter=Th(e.renderCoordsHelper,a,t.eye),r.centerIsOnSurface=!0):e.state.isLocal?r.tiltAtCenter=Th(e.renderCoordsHelper,t.center,t.eye):(Object(Nd.b)(Object(Nd.e)(i),t.ray,Vh),r.eyeCenterDistance=Object(Yl.o)(t.eye,Vh),r.tiltAtCenter=Object(m.b)(-Object(Yl.j)(t.viewForward,Object(Yl.t)(Vh,Vh)))),r.radius=i,r.eyeRadius=Object(Yl.r)(t.eye),r.constraints=e.state.constraints,r}(e,t,Bh),s=Object(m.e)(o.tiltAtCenter,r.min,r.max);return Rh(o.tiltAtCenter-s)?(o.centerIsOnSurface?(i=function(e){var t=e.constraints,r=e.eyeCenterDistance,n=e.tiltAtCenter,i=n,a=t.clampTilt(r,n),o=Ih(e,a);if(t.clampTilt(o,n)===a)return a;for(var s=0;s<10&&Rh(a-i);){var c=(i+a)/2,l=Ih(e,c);Rh(t.clampTilt(l,c)-c)?i=c:a=c,s++}return a}(o),a=function(e,t){var r=Object(m.c)(e.radius/e.eyeRadius*Math.sin(e.tiltAtCenter)),n=Object(m.c)(e.radius/e.eyeRadius*Math.sin(t));return e.eyeRadius>e.radius?r-n:n-r}(o,i)):(i=o.constraints.clampTilt(o.eyeCenterDistance,o.tiltAtCenter),n&&i<Math.PI/2&&(n.requiresTwoSteps=!0,i=Math.PI/2-1e-5),a=function(e,t){return e.tiltAtCenter-Math.PI/2-(t-Math.PI/2)}(o,i)),n&&(n.eyeCenterDistance=Ih(o,i)),a):0}(e,t,r,n);case"local":return function(e,t,r,n){var i=Th(e.renderCoordsHelper,t.center,t.eye),a=Object(m.e)(i,r.min,r.max),o=i-a;if(!Rh(o))return 0;if(n){var s=e.pointsOfInterest.centerOnSurfaceFrequent.estimatedSurfaceAltitude,c=e.renderCoordsHelper.getAltitude(t.eye)-s,l=Math.cos(a);Math.abs(l)>1e-4?n.eyeCenterDistance=c/l:n.eyeCenterDistance=t.distance}return o}(e,t,r,n);default:return void Object(Sh.a)(e.viewingMode)}}function Rh(e){return Math.abs(e)>1e-9}function Ih(e,t){if(!e.centerIsOnSurface)return e.eyeCenterDistance;var r=Math.PI-Object(m.e)(t,0,Math.PI),n=Object(m.c)(e.radius/e.eyeRadius*Math.sin(r)),i=Math.PI-r-n,a=Math.sin(i)/Math.sin(r);if(e.eyeRadius<e.radius&&a>1){var o=Math.PI-n,s=Math.PI-r-o;return Math.sin(s)/Math.sin(r)*e.eyeRadius}return a*e.eyeRadius}function Dh(e,t,r){if(0!==t.interactionType){var n=t.interactionStartCamera,i=t.interactionFactor,a=r.min,o=r.max,s=Ph(e,n,qd,t),c=0===s?0:Th(e.renderCoordsHelper,n.center,n.eye);r.min=a,r.max=o,2===t.interactionType?(Bd(t.selection,2)&&Fh(e,n,r),Gd(s,c,!0,i,Nh,r)):Gd(s,c,!1,i,Nh,r)}}function Fh(e,t,r){if(!e.state.isLocal){var n=e.state.constraints;if(n.altitude){var i=Object(Yl.v)(t.center),a=Math.sqrt(i),o=t.distance,s=Object(J.e)(e.spatialReference).radius,c=n.altitude.min+s,l=n.altitude.max+s,u=(c*c-o*o-i)/(-2*a*o),d=(l*l-o*o-i)/(-2*a*o);r.min=Math.max(r.min,Math.min(Math.PI-Object(m.b)(d),r.max)),r.max=Math.min(r.max,Math.PI-Object(m.b)(u))}}}var Lh=Object(X.e)(),zh=Object(Kl.d)(),Vh=Object(X.e)(),Nh=Object(m.g)(5),Uh={min:0,max:0},Bh={constraints:null,radius:0,eyeRadius:0,centerIsOnSurface:!0,eyeCenterDistance:0,tiltAtCenter:0},Gh={eyeCenterDistance:0,requiresTwoSteps:!1};var qh=function(e){return e*e},Hh=function(e){return 1-qh(1-e)},Wh=function(e){return e*e*e},Qh=function(e){return 1-Wh(1-e)},Zh=function(e){return e<.5?Wh(2*e)/2:(Qh(2*(e-.5))+1)/2},Xh=function(e){return e*e*e*e},Yh=function(e){return 1-Xh(1-e)},$h=function(e){return e*e*e*e*e},Jh=function(e){return 1-$h(1-e)},Kh=function(e){return 1-Math.cos(e*Math.PI/2)},ef=function(e){return 1-Kh(1-e)},tf=function(e){return Math.pow(2,10*(e-1))},rf=function(e){return 1-tf(1-e)},nf=function(e){return-(Math.sqrt(1-e*e)-1)},af=function(e){return 1-nf(1-e)};function of(e){var t=2*(e-Math.sqrt((e-1)*e)),r=t/2/e;return function(n){return n<r?e*n*n:t*n-t+1}}function sf(e,t){return function(r,n){return r<t?t*e(r/t,n):1-e((1-r)/(1-t),n)*(1-t)}}var cf=sf(of(1),1),lf=sf(of(1),0),uf=sf(of(1),.5),df=sf(of(2),1),hf=sf(of(2),0),ff=sf(of(2),.5),pf=sf(of(3),1),bf=sf(of(3),0),vf=sf(of(3),.5),mf=sf(of(4),1),yf=sf(of(4),0),gf=sf(of(4),.5),Of={linear:function(e){return e},"in-quad":qh,"out-quad":Hh,"in-out-quad":function(e){return e<.5?qh(2*e)/2:(Hh(2*(e-.5))+1)/2},"in-coast-quad":cf,"out-coast-quad":lf,"in-out-coast-quad":uf,"in-cubic":Wh,"out-cubic":Qh,"in-out-cubic":Zh,"in-coast-cubic":df,"out-coast-cubic":hf,"in-out-coast-cubic":ff,"in-quart":Xh,"out-quart":Yh,"in-out-quart":function(e){return e<.5?Xh(2*e)/2:(Yh(2*(e-.5))+1)/2},"in-coast-quart":pf,"out-coast-quart":bf,"in-out-coast-quart":vf,"in-quint":$h,"out-quint":Jh,"in-out-quint":function(e){return e<.5?$h(2*e)/2:(Jh(2*(e-.5))+1)/2},"in-coast-quint":mf,"out-coast-quint":yf,"in-out-coast-quint":gf,"in-sine":Kh,"out-sine":ef,"in-out-sine":function(e){return e<.5?Kh(2*e)/2:(ef(2*(e-.5))+1)/2},"in-expo":tf,"out-expo":rf,"in-out-expo":function(e){return e<.5?tf(2*e)/2:(rf(2*(e-.5))+1)/2},"in-circ":nf,"out-circ":af,"in-out-circ":function(e){return e<.5?nf(2*e)/2:(af(2*(e-.5))+1)/2}};function jf(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:kf,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:t,a=!1;n!==t&&n.copyFrom(t),n.computeUp(e.state.viewingMode);for(var o=0;o<Sf;o++){var s,c=0,l=Object(i.a)(xf);try{for(l.s();!(s=l.n()).done;){var u=s.value;if(Bd(r.selection,u.type)){var d=Math.abs(u.error(e,n,r));u.apply(e,n,r)&&(a=!0,c+=d)}}}catch(p){l.e(p)}finally{l.f()}if(0===c)break}var h=Bd(r.selection,8),f=_f(r.interactionType,e);return h&&wh(e,n,f)&&(a=!0),a&&n.computeUp(e.state.viewingMode),a}function _f(e,t){switch(e){case 4:return 1;case 5:return t.state.isGlobal?2:1;default:return 0}}function wf(e,t){var r="number"==typeof e?e:Object(xu.d)(e,t),n=Math.min(1,r/150);return Zh(n)}var xf=[{type:1,error:function(e,t,r){return Ph(e,t,r)*t.distance},apply:function e(t,r){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:qd,i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];Gh.eyeCenterDistance=0,Gh.requiresTwoSteps=!1;var a=Ph(t,r,n,void 0,Gh);if(0===a)return!1;switch(Object(Jl.i)(zh),Object(Jl.c)(zh,zh,-a,r.viewRight),n.tiltMode){case 1:Object(Yl.s)(Lh,r.viewForward,zh),Object(Yl.g)(Lh,Lh,Gh.eyeCenterDistance),r.center=Object(Yl.h)(Vh,r.eye,Lh);break;case 0:Object(Yl.l)(Lh,r.center,r.eye),Object(Yl.s)(Lh,Lh,zh),r.eye=Object(Yl.l)(Vh,r.center,Lh);break;default:Object(Sh.a)(n.tiltMode)}return r.up=Object(Yl.s)(Vh,r.up,zh),!Gh.requiresTwoSteps||!i||e(t,r,n,!1)}},{type:2,error:Qd,apply:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:qd,n=Qd(e,t,r);if(0===n)return!1;var i=e.renderCoordsHelper,a=i.getAltitude(t.eye)+n,o=Hd(t,r.interactionDirection,Yd(e,t,Object(m.t)(n),eh),Kd),s=Object(Yl.m)(th,t.viewForward),c=i.intersectInfiniteManifold(Object(Ud.g)(t.eye,o),a,rh);return t.eye=Object(I.j)(c)?c:i.setAltitude(rh,a,t.eye),t.center=Object(Wd.a)(rh,t.eye,s,t.center),!0}},{type:4,error:nh,apply:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:qd,n=nh(e,t,r);if(0===n)return!1;var i=e.pointsOfInterest.surfaceOrigin,a=ah(e,t)+n,o=Object(Yl.m)(ch,t.eye),s=Hd(t,r.interactionDirection,oh(e,t,dh),uh);if(!Object(Nd.i)(Object(Nd.k)(i.renderLocation,a),Object(Ud.g)(t.eye,s),hh))return!1;t.eye=hh;var c=Object(Yl.l)(lh,t.eye,o);t.center=Object(Yl.h)(hh,t.center,c);var l=e.renderCoordsHelper.getAltitude(t.center),u=e.renderCoordsHelper.intersectInfiniteManifold(t.ray,l,hh);return Object(I.j)(u)&&(t.center=u),!0}}],kf={selection:15,interactionType:0,interactionFactor:0,interactionStartCamera:null,interactionDirection:null,tiltMode:0},Sf=5,Tf=r(67),Cf=r(96),Mf=Object(X.e)(),Pf=Object(X.e)(),Af=Object(X.e)(),Ef=Object(X.e)(),Rf=Object(X.e)(),If=Object(X.e)(),Df={upward:Object(X.g)(0,0,1),forward:Object(X.g)(0,1,0),sideway:Object(X.g)(1,0,0)},Ff=Object(Cf.b)(),Lf=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;Object(c.a)(this,e),this.viewingMode=t,this.center=Object(X.e)(),this.pitch=0,this.yaw=0,this.distance=0,this.lookAtDirection=Object(X.c)(Df.forward)}return Object(l.a)(e,[{key:"pixelsPerPanAtZoom",value:function(e){return this.size/2/(this._zoomToPanScale*e)}},{key:"zoomAtPixelsPerPan",value:function(e){return this.size/2/(this._zoomToPanScale*e)}},{key:"pixelsPerRotateAtZoom",value:function(){var e=Math.max(Math.cos(Math.abs(this.pitch)),.5);return this.size/2/e}},{key:"compareTo",value:function(e,t){if(t||(t={pan:0,rotate:0,sourceZoom:0,targetZoom:0}),1===this.viewingMode){var r=(Object(Yl.r)(this.center)+Object(Yl.r)(e.center))/2;t.pan=Object(T.b)(this.center,e.center)*r}else t.pan=Object(Yl.o)(this.center,e.center);var n=Math.abs(e.yaw-this.yaw);n>=Math.PI&&(n=2*Math.PI-n);var i=Math.abs(e.pitch-this.pitch);return t.rotate=Math.max(n,i),t.sourceZoom=this.distance,t.targetZoom=e.distance,t}},{key:"interpolate",value:function(e,t,r){1===this.viewingMode?Object(T.l)(e.center,t.center,r.pan,this.center):Object(Yl.k)(this.center,e.center,t.center,r.pan),this.distance=Object(m.m)(e.distance,t.distance,r.zoom),this.pitch=Object(m.m)(e.pitch,t.pitch,r.rotate);var n=e.yaw,i=t.yaw;Math.abs(i-n)>=Math.PI&&(n+=2*(n<i?1:-1)*Math.PI),this.yaw=Object(m.m)(n,i,r.rotate)}},{key:"copyFrom",value:function(e){Object(Yl.m)(this.center,e.center),this.pitch=e.pitch,this.yaw=e.yaw,this.distance=e.distance,Object(Yl.m)(this.lookAtDirection,e.lookAtDirection),this.size=e.size,this.copyFromCommon(e),this.viewingMode=e.viewingMode}},{key:"copyFromRenderCamera",value:function(e){var t=this._lookAtOrientation(e.center,Ff);Object(Yl.m)(this.center,e.center),Object(Yl.l)(Ef,e.center,e.eye),Object(Yl.z)(Ef,Ef,t),Object(Yl.z)(Rf,e.up,t),this.distance=Object(Yl.r)(Ef),Ef[0]/=this.distance,Ef[1]/=this.distance,Ef[2]/=this.distance,this.pitch=this._eyeUpToPitch(Ef),this.yaw=this._eyeUpToYaw(Ef,Rf),this.size=Math.sqrt(e.width*e.width+e.height*e.height),this.copyFromCommon(e)}},{key:"copyFromCommon",value:function(e){this.fov=e.fov,this._zoomToPanScale=Math.atan(.5*this.fov)}},{key:"copyToRenderCamera",value:function(e){var t=this._lookAtOrientation(this.center,Ff);Object(Tf.n)(t,t),this._axisAngleVec3(Df.sideway,this.pitch-Math.PI/2,Df.forward,Ef),this._axisAngleVec3(Df.upward,this.yaw,Ef),this._axisAngleVec3(Df.sideway,this.pitch-Math.PI/2,Df.upward,Rf),this._axisAngleVec3(Df.upward,this.yaw,Rf),Object(Yl.g)(Ef,Ef,this.distance),Object(Yl.z)(Ef,Ef,t),Object(Yl.z)(Rf,Rf,t),e.center=this.center,e.eye=Object(Yl.l)(Ef,this.center,Ef),e.up=Rf}},{key:"_axisAngleVec3",value:function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:r,i=Math.cos(t),a=Math.sin(t);return Object(Yl.g)(Mf,r,i),Object(Yl.i)(Pf,e,r),Object(Yl.g)(Pf,Pf,a),Object(Yl.g)(Af,e,(1-i)*Object(Yl.j)(e,r)),Object(Yl.h)(n,Object(Yl.h)(n,Mf,Pf),Af)}},{key:"_lookAtOrientation",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Object(Cf.b)();return this._upAtLookAt(e,Af),Object(Yl.i)(Mf,this.lookAtDirection,Af),Object(Yl.t)(Mf,Mf),0===Mf[0]&&0===Mf[1]&&0===Mf[2]&&Object(Yl.m)(Mf,Df.sideway),Object(Yl.i)(Pf,Af,Mf),Object(Yl.t)(Pf,Pf),t[0]=Mf[0],t[1]=Pf[0],t[2]=Af[0],t[3]=Mf[1],t[4]=Pf[1],t[5]=Af[1],t[6]=Mf[2],t[7]=Pf[2],t[8]=Af[2],t}},{key:"_upAtLookAt",value:function(e,t){return 2===this.viewingMode?Object(Yl.m)(t,Df.upward):Object(Yl.t)(t,e)}},{key:"_eyeUpToPitch",value:function(e){return Math.PI-Object(T.b)(Df.upward,e)}},{key:"_eyeUpToYaw",value:function(e,t){var r=If;return Math.abs(t[2])<.5?(Object(Yl.m)(r,t),e[2]>0&&Object(Yl.g)(r,r,-1)):Object(Yl.m)(r,e),Object(Yl.i)(Pf,r,Df.upward),Object(Yl.t)(Pf,Pf),Object(T.b)(Df.sideway,Pf,Df.upward)}}]),e}(),zf=r(86),Vf=2,Nf=Object(Vd.a)(500),Uf=Object(Vd.a)(8e3),Bf=function(){function e(t){Object(c.a)(this,e),this.createCamera=t,this.compared={sourceZoom:0,targetZoom:0,pan:0,rotate:0},this.settings={desiredScreenFlow:Vf},this.source=t(),this.target=t()}return Object(l.a)(e,[{key:"clone",value:function(){var t=new e(this.createCamera);return t.copyFrom(this),t}},{key:"copyFrom",value:function(e){this.update(e.source,e.target,e.settings)}},{key:"update",value:function(e,t,r){this.source!==e&&this.source.copyFrom(e),this.target!==t&&this.target.copyFrom(t),this.compared=this.source.compareTo(this.target,this.compared),this.settings.desiredScreenFlow=null!=r.desiredScreenFlow?r.desiredScreenFlow:Vf,this.desiredPixelFlow=this.settings.desiredScreenFlow*this.target.size,this.halfWindowSize=this.target.size/2}},{key:"halfWindowPanAtZoom",value:function(e){var t=this.target.pixelsPerPanAtZoom(e);return this.halfWindowSize/t}},{key:"hasZoom",get:function(){return Math.abs(this.compared.sourceZoom-this.compared.targetZoom)>1e-5}},{key:"hasPan",get:function(){return this.compared.pan>1e-9}},{key:"hasRotate",get:function(){return this.compared.rotate>1e-9}}]),e}(),Gf=function(){function e(){Object(c.a)(this,e),this.segments=[]}return Object(l.a)(e,[{key:"time",get:function(){return this.segments.reduce((function(e,t){return Object(Vd.c)(e+t.time)}),Object(Vd.c)(0))}},{key:"interpolateComponentsAt",value:function(e,t){e=Math.min(Math.max(e,0),1),e*=this.time;for(var r=0,n=0,i=this.definition,a=0;a<this.segments.length;a++){var o=this.segments[a],s=o.definition;if(e<=o.time||a===this.segments.length-1){t=this.segmentInterpolateComponentsAt(o,e/o.time,t),i.hasPan?t.pan=(r+s.compared.pan*t.pan)/i.compared.pan:t.pan=1,i.hasRotate?t.rotate=(n+s.compared.rotate*t.rotate)/i.compared.rotate:t.rotate=1;var c=t.zoom*(s.compared.targetZoom-s.compared.sourceZoom)+s.compared.sourceZoom,l=this.segments[0].definition.compared.sourceZoom,u=this.segments[this.segments.length-1].definition.compared.targetZoom;return i.hasZoom?t.zoom=(c-l)/(u-l):t.zoom=1,t}e-=o.time,r+=s.compared.pan,n+=s.compared.rotate}}},{key:"segmentInterpolateComponentsAt",value:function(e,t,r){return e.interpolateComponentsAt(t,r)}}]),e}(),qf=function(){function e(t){Object(c.a)(this,e),t&&this.update(t)}return Object(l.a)(e,[{key:"time",get:function(){return this._time}},{key:"update",value:function(e){e&&(this.definition?this.definition.copyFrom(e):this.definition=e.clone()),this._updatePrecomputedVariables(),this._updatePixelFlow()}},{key:"_updatePrecomputedVariables",value:function(){var e=this.definition,t=e.compared,r=t.sourceZoom,n=t.targetZoom;this._zoomSign=r>n?1:-1,this._panPixelsAtSource=t.pan*e.source.pixelsPerPanAtZoom(r);var i=(e.source.pixelsPerRotateAtZoom(r)+e.target.pixelsPerRotateAtZoom(n))/2;this._rotatePixels=t.rotate*i}},{key:"_updatePixelFlow",value:function(){var e=this.definition.compared.sourceZoom,t=this.definition.compared.targetZoom,r=this.definition,n=r.hasZoom,i=r.hasPan,a=r.hasRotate,o=0,s=0;n&&(i&&(o=(t/e-1)/(-1/(this._zoomSign*this.definition.halfWindowSize)*Math.LN2*this._panPixelsAtSource)),a&&(s=this._zoomSign*(Math.log(e/t)/Math.LN2)*this.definition.halfWindowSize/this._rotatePixels)),this._zoomPixelFlow=0,this._panPixelFlow=0,this._rotatePixelFlow=0;var c=this.definition.desiredPixelFlow;if(n&&i&&a){var l=o+s+o*s;this._zoomPixelFlow=o*s/l*c,this._panPixelFlow=s/l*c,this._rotatePixelFlow=o/l*c}else if(n&&i){var u=1+o;this._zoomPixelFlow=o/u*c,this._panPixelFlow=1/u*c}else if(n&&a){var d=1+s;this._zoomPixelFlow=s/d*c,this._rotatePixelFlow=1/d*c}else if(i&&a){var h=this._panPixelsAtSource/this._rotatePixels,f=1+h;this._panPixelFlow=h/f*c,this._rotatePixelFlow=1/f*c}else i?this._panPixelFlow=c:n?this._zoomPixelFlow=c:a&&(this._rotatePixelFlow=c);this._time=a?this.rotateTime:n?this.zoomTime:i?this.panTime:Object(Vd.c)(0)}},{key:"rotateTime",get:function(){return this.definition.hasRotate?Object(Vd.c)(this._rotatePixels/this._rotatePixelFlow):Object(Vd.c)(0)}},{key:"zoomTime",get:function(){return this.definition.hasZoom?Object(Vd.c)(this._zoomSign*(Math.log(this.definition.compared.sourceZoom/this.definition.compared.targetZoom)/Math.LN2)*this.definition.halfWindowSize/this._zoomPixelFlow):Object(Vd.c)(0)}},{key:"panTime",get:function(){if(this.definition.hasPan){if(this.definition.hasZoom){var e=-1/(this._zoomSign*this.definition.halfWindowSize)*Math.LN2,t=e*this._panPixelsAtSource;return Object(Vd.c)(Math.log(t*(this._zoomPixelFlow/this._panPixelFlow)+1)/(e*this._zoomPixelFlow))}return Object(Vd.c)(this._panPixelsAtSource/this._panPixelFlow)}return Object(Vd.c)(0)}},{key:"_interpolateComponentsZoom",value:function(e){if(0===e||1===e)return e;if(this.definition.hasZoom){var t=this.definition.compared.sourceZoom,r=this.definition.compared.targetZoom;return(t*Math.pow(t/r,-e)-t)/(r-t)}return e}},{key:"_interpolateComponentsPan",value:function(e){if(0===e||1===e)return e;if(this.definition.hasPan&&this.definition.hasZoom){var t=-1/(this._zoomSign*this.definition.halfWindowSize)*this._zoomPixelFlow;return 1/this._panPixelsAtSource*(this._panPixelFlow*(Math.pow(2,t*e*this._time)-1))/(t*Math.LN2)}return e}},{key:"_interpolateComponentsRotate",value:function(e){return e}},{key:"interpolateComponentsAt",value:function(e,t){e=Math.min(Math.max(e,0),1);var r=this._interpolateComponentsZoom(e),n=this._interpolateComponentsPan(e),i=this._interpolateComponentsRotate(e);return t?(t.zoom=r,t.pan=n,t.rotate=i):t={zoom:r,pan:n,rotate:i},t}}]),e}();function Hf(e,t,r){var n=t-e.compared.sourceZoom,i=e.halfWindowPanAtZoom(n);return-e.halfWindowSize*(r.ascensionFactor*Math.LN2*e.compared.pan+i)*Math.log(e.compared.sourceZoom/t)/(e.desiredPixelFlow*Math.LN2*i)}function Wf(e,t,r){var n=1/t,i=Math.log(e.compared.sourceZoom*n),a=1/e.desiredPixelFlow,o=1/Math.LN2,s=t-e.compared.sourceZoom,c=1/s,l=(r.ascensionFactor*Math.LN2*e.compared.pan+e.halfWindowPanAtZoom(s))/e.halfWindowPanAtZoom(1);return e.halfWindowSize*n*a*o*c*l-e.halfWindowSize*i*a*o*c+e.halfWindowSize*i*a*o*l/(s*s)}function Qf(e,t,r){var n=t-e.compared.sourceZoom,i=1/n,a=1/t,o=Math.log(e.compared.sourceZoom*a),s=(r.ascensionFactor*Math.LN2*e.compared.pan+e.halfWindowPanAtZoom(n))/e.halfWindowPanAtZoom(1);return e.halfWindowSize*i*(-2*i*a*s+2*i*o+2*a-2*o*s/(n*n)-s/(t*t))/(e.desiredPixelFlow*Math.LN2)}function Zf(e,t){return-e.halfWindowSize*Math.log(e.compared.sourceZoom/t)/(e.desiredPixelFlow*Math.LN2)}function Xf(e,t){return e.halfWindowSize/(t*e.desiredPixelFlow*Math.LN2)}function Yf(e,t){return-e.halfWindowSize/(t*t*e.desiredPixelFlow*Math.LN2)}function $f(e,t,r){return e.halfWindowSize*(-e.halfWindowPanAtZoom(t)-r.descensionFactor*Math.LN2*e.compared.pan+e.halfWindowPanAtZoom(e.compared.targetZoom))*Math.log(t/e.compared.targetZoom)/(e.desiredPixelFlow*Math.LN2*e.halfWindowPanAtZoom(-t+e.compared.targetZoom))}function Jf(e,t,r){var n=Math.log(t/e.compared.targetZoom),i=1/e.desiredPixelFlow,a=1/Math.LN2,o=-t+e.compared.targetZoom,s=1/o,c=(-e.halfWindowPanAtZoom(t)-r.descensionFactor*Math.LN2*e.compared.pan+e.halfWindowPanAtZoom(e.compared.targetZoom))/e.halfWindowPanAtZoom(1);return-e.halfWindowSize*n*i*a*s+e.halfWindowSize*n*i*a*c/(o*o)+e.halfWindowSize*i*a*s*c/t}function Kf(e,t,r){var n=t-e.compared.targetZoom,i=1/n,a=1/t,o=Math.log(t/e.compared.targetZoom),s=(e.halfWindowPanAtZoom(t)+r.descensionFactor*Math.LN2*e.compared.pan-e.halfWindowPanAtZoom(e.compared.targetZoom))/e.halfWindowPanAtZoom(1);return e.halfWindowSize*i*(-2*i*a*s-2*i*o+2*a+2*o*s/(n*n)-s/(t*t))/(e.desiredPixelFlow*Math.LN2)}function ep(e,t){return e.halfWindowSize*Math.log(t/e.compared.targetZoom)/(e.desiredPixelFlow*Math.LN2)}function tp(e,t){return e.halfWindowSize/(t*e.desiredPixelFlow*Math.LN2)}function rp(e,t){return-e.halfWindowSize/(t*t*e.desiredPixelFlow*Math.LN2)}function np(e,t){var r,n,i=function(e,t){var r=Math.max(e.compared.sourceZoom,e.compared.targetZoom),n=e.source.zoomAtPixelsPerPan(e.desiredPixelFlow/e.compared.pan)/2;return n<r?null!=t.maximumDistance?r+(t.maximumDistance-r)/2:1.5*r:t.maximumDistance?Math.min(t.maximumDistance,n):n}(e,t),a={ascensionFactor:null!=t.ascensionFactor?t.ascensionFactor:.5,descensionFactor:null!=t.descensionFactor?t.descensionFactor:.5},o=0===a.ascensionFactor,s=0===a.descensionFactor,c=o?Zf:Hf,l=o?Xf:Wf,u=o?Yf:Qf,d=s?ep:$f,h=s?tp:Jf,f=s?rp:Kf,p=function(t){return c(e,t,a)+function(e,t,r){return-e.compared.pan*e.halfWindowSize*(r.ascensionFactor+r.descensionFactor-1)/(e.desiredPixelFlow*e.halfWindowPanAtZoom(t))}(e,t,a)+d(e,t,a)},b=function(t){return u(e,t,a)+function(e,t,r){return-2*e.compared.pan*e.halfWindowSize*(r.ascensionFactor+r.descensionFactor-1)/(e.desiredPixelFlow*e.halfWindowPanAtZoom(t*t*t))}(e,t,a)+f(e,t,a)},v=p(i),m=function(e){var t=Math.LN2*e.compared.pan,r=e.compared.sourceZoom-e.compared.targetZoom,n=e.halfWindowPanAtZoom(r),i=e.halfWindowSize*Math.log(e.compared.sourceZoom/e.compared.targetZoom)/(e.desiredPixelFlow*Math.LN2*n);return e.compared.sourceZoom<=e.compared.targetZoom?i*(t-n):i*(t+n)}(e),y=t.maximumIterations||20,g=null!=t.maximumDistance?t.maximumDistance:1/0;for(r=0;r<y;r++){var O=(l(e,n=i,a)+function(e,t,r){return e.compared.pan*e.halfWindowSize*(r.ascensionFactor+r.descensionFactor-1)/(e.desiredPixelFlow*e.halfWindowPanAtZoom(t*t))}(e,n,a)+h(e,n,a)+1e-6)/b(i);if(isNaN(O)||i>=g&&O<0){if(!isFinite(g))return null;v=p(i=g);break}if((i-=O)<e.compared.sourceZoom||i<e.compared.targetZoom)return null;var j=p(i);if(Math.abs(j-v)/v<=.005)break;v=j}return v>.7*m||i<e.compared.sourceZoom||i<e.compared.targetZoom?null:i}var ip,ap=function(e){Object(f.a)(r,e);var t=Object(p.a)(r);function r(e,n){var i;return Object(c.a)(this,r),(i=t.call(this))._preallocSegments=[new qf,new qf,new qf],i.update(e,n),i}return Object(l.a)(r,[{key:"update",value:function(e,t){if(e){this.definition?this.definition.copyFrom(e):this.definition=e.clone();var r=null;t&&t.apex&&(r=np(e,t.apex)),this.segments.length=0,this._ascensionSegment=null,this._descensionSegment=null,null==r?this._updateWithoutApex():this._updateWithApex(r,t.apex)}}},{key:"segmentInterpolateComponentsAt",value:function(e,t,r){return r=e.interpolateComponentsAt(t,r),e===this._ascensionSegment?r.zoom=Hh(r.zoom):e===this._descensionSegment&&(r.zoom=qh(r.zoom)),r}},{key:"_updateWithApex",value:function(e,t){var r=Object(ue.a)(this._preallocSegments,3),n=r[0],i=r[1],a=r[2],o=null!=t.ascensionFactor?t.ascensionFactor:.5,s=Math.min(1-o,null!=t.ascensionFactor?t.descensionFactor:.5),c=1-o-s;n.definition?n.definition.copyFrom(this.definition):n.definition=this.definition.clone(),n.definition.compared.targetZoom=e,n.definition.compared.pan=this.definition.compared.pan*o,n.definition.compared.rotate=this.definition.compared.rotate*o,n.update(),this._ascensionSegment=n,this.segments.push(n),c>0&&(i.definition?i.definition.copyFrom(this.definition):i.definition=this.definition.clone(),i.definition.copyFrom(this.definition),i.definition.compared.sourceZoom=e,i.definition.compared.targetZoom=e,i.definition.compared.pan=this.definition.compared.pan*c,i.definition.compared.rotate=this.definition.compared.rotate*c,i.update(),this.segments.push(i)),a.definition?a.definition.copyFrom(this.definition):a.definition=this.definition.clone(),a.definition.compared.sourceZoom=e,a.definition.compared.pan=this.definition.compared.pan*s,a.definition.compared.rotate=this.definition.compared.rotate*s,a.update(),this._descensionSegment=a,this.segments.push(a)}},{key:"_updateWithoutApex",value:function(){var e=Object(ue.a)(this._preallocSegments,1)[0];e.update(this.definition),this.segments.push(e)}}]),r}(Gf),op={zoom:0,pan:0,rotate:0},sp=function(){function e(t){Object(c.a)(this,e),this.createCamera=t,this._time=Object(Vd.a)(0),this.definition=new Bf(t),this.path=new ap}return Object(l.a)(e,[{key:"time",get:function(){return this._time}},{key:"update",value:function(e,t,r){this.definition.update(e,t,r),this.path.update(this.definition,r),this._time=this._applyTimeSettings(Object(Vd.b)(this.path.time),r),this._easing=r.easing?r.easing:this._time>=1e3?uf:rf}},{key:"cameraAt",value:function(e,t){t=t||this.createCamera(),e=Math.min(Math.max(0,e),1),e=this._normalizedEasing(e);var r=this.path.interpolateComponentsAt(e,op);return t.interpolate(this.definition.source,this.definition.target,r),t}},{key:"_normalizedEasing",value:function(e){var t=this._easing(0,this._time),r=this._easing(1,this._time);return(this._easing(e,this._time)-t)/(r-t)}},{key:"_applyTimeSettings",value:function(e,t){var r=null!=t.speedFactor?t.speedFactor:1;null!=t.duration?e=t.duration:null!=t.speedFactor&&(e=Object(Vd.a)(e/r));var n=null!=t.minDuration?t.minDuration:Nf/r,i=null!=t.maxDuration?t.maxDuration:Uf/r;return Object(Vd.a)(Math.min(Math.max(n,e),i))}}]),e}(),cp=Object(X.e)(),lp=function(){function e(t){Object(c.a)(this,e),this.currentTime=Object(Vd.a)(0),this._animation=new sp((function(){return new Lf(t)})),this._current=new Lf(t)}return Object(l.a)(e,[{key:"finished",get:function(){return this.currentTime>=this._animation.time}},{key:"time",get:function(){return this._animation.time}},{key:"update",value:function(e,t,r){var n=this._animation.definition.source,i=this._animation.definition.target,a=Object(Yl.l)(cp,t.center,e.center),o=Object(Yl.r)(a);o>=1e-5?(a[0]/=o,a[1]/=o,a[2]/=o):(a[0]=0,a[1]=1,a[0]=0),Object(Yl.m)(n.lookAtDirection,a),Object(Yl.m)(i.lookAtDirection,a),n.copyFromRenderCamera(e),i.copyFromRenderCamera(t),this._current.copyFrom(n),this._animation.update(n,i,r),this.currentTime=Object(Vd.a)(0),e.almostEquals(t)&&(this.currentTime=this._animation.time)}},{key:"cameraAt",value:function(e,t){return this._animation.cameraAt(e,this._current),t=t||new zf.a,this._current.copyToRenderCamera(t),t}},{key:"step",value:function(e,t){return this.finished||(this.currentTime=Object(Vd.a)(this.currentTime+Object(Vd.b)(e)),this.currentTime>=this.time&&(this.currentTime=this.time)),this.cameraAt(this.currentTime/this.time,t)}}]),e}();!function(e){e.Ready="ready",e.Rejected="rejected",e.Running="running",e.Stopped="stopped",e.Finished="finished"}(ip||(ip={}));var up=function(e){Object(f.a)(r,e);var t=Object(p.a)(r);function r(){var e;return Object(c.a)(this,r),(e=t.apply(this,arguments)).state=ip.Ready,e}return Object(l.a)(r,[{key:"active",get:function(){return this.state===ip.Running}},{key:"isInteractive",get:function(){return!1}},{key:"canStop",get:function(){return!1}},{key:"stopController",value:function(){return!!this.canStop&&(this.state=ip.Stopped,!0)}},{key:"finishController",value:function(){this.state=ip.Finished}},{key:"steppingFinished",get:function(){return!1}}]),r}(de.a);Object(b.a)([Object(y.b)({readOnly:!0})],up.prototype,"active",null),Object(b.a)([Object(y.b)()],up.prototype,"state",void 0);var dp=function(e){Object(f.a)(r,e);var t=Object(p.a)(r);function r(){return Object(c.a)(this,r),t.apply(this,arguments)}return Object(l.a)(r,[{key:"canStop",get:function(){return!0}},{key:"asyncResult",get:function(){return this._asyncResult},set:function(e){this._asyncResult&&(this._asyncResult.reject(Object(q.f)()),this._asyncResult=null),this.state===ip.Finished||this.state===ip.Stopped?this.state===ip.Finished?e.resolve():e.reject(Object(q.f)()):this._asyncResult=e}},{key:"onControllerStart",value:function(){var e=this;this.state=ip.Running,Object(I.j)(this.viewAnimation)&&this.viewAnimation.when((function(){return e.updateStateFromViewAnimation()}),(function(){return e.updateStateFromViewAnimation()}))}},{key:"updateStateFromViewAnimation",value:function(){!Object(I.j)(this.viewAnimation)||this.state!==ip.Ready&&this.state!==ip.Running||(this.viewAnimation.state===Xc.State.FINISHED?this.finish():this.viewAnimation.state===Xc.State.STOPPED&&(this.state=ip.Stopped))}},{key:"onControllerEnd",value:function(){Object(I.j)(this.viewAnimation)&&!this.viewAnimation.done&&(this.state===ip.Finished?this.viewAnimation.finish():this.state===ip.Stopped&&this.viewAnimation.stop()),this._asyncResult&&(this.state===ip.Finished?this._asyncResult.resolve():this._asyncResult.reject(Object(q.f)()))}},{key:"finish",value:function(){this.finishController()}}]),r}(up=Object(b.a)([Object(w.a)("esri.views.3d.state.controllers.CameraController")],up)),hp=function(e){Object(f.a)(r,e);var t=Object(p.a)(r);function r(e){var n;return Object(c.a)(this,r),(n=t.call(this,e)).view=null,n.mode="interaction",n.hasTarget=!1,n}return Object(l.a)(r,[{key:"intersectionHelper",get:function(){return this.view.sceneIntersectionHelper}},{key:"initialize",value:function(){this.animation=new lp(this.view.state.viewingMode),this.viewAnimation="interaction"===this.mode?null:new Xc}},{key:"isInteractive",get:function(){return"interaction"===this.mode}},{key:"begin",value:function(e,t){this.hasTarget=!0;var r=this.animationSettings(t);fp.copyFrom(this.view.state.camera);var n=new fh.a(this.view.state.viewingMode);this.intersectionHelper.intersectRay(fp.ray,n,pp)&&(fp.center=pp),this.animation.update(fp,e,r),this.animation.finished&&this.finish()}},{key:"finish",value:function(){this.animation.currentTime=this.animation.time,Object(d.a)(Object(h.a)(r.prototype),"finish",this).call(this)}},{key:"steppingFinished",get:function(){return this.hasTarget&&this.animation.finished}},{key:"stepController",value:function(e,t){this.hasTarget&&this.animation.step(e,t)}},{key:"onControllerEnd",value:function(e){this.hasTarget&&(this.animation.cameraAt(this.animation.currentTime/this.animation.time,e),this.animation.currentTime=this.animation.time),Object(d.a)(Object(h.a)(r.prototype),"onControllerEnd",this).call(this,e)}},{key:"animationSettings",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(ie.a)(Object(ie.a)({apex:{maximumDistance:this.view.state.constraints.clampAltitude(1/0)/6,ascensionFactor:void 0,descensionFactor:void 0}},e),{},{easing:"string"==typeof e.easing?Of[e.easing]:e.easing})}}]),r}(dp=Object(b.a)([Object(w.a)("esri.views.3d.state.controllers.AnimationController")],dp));Object(b.a)([Object(y.b)({constructOnly:!0})],hp.prototype,"view",void 0),Object(b.a)([Object(y.b)({constructOnly:!0})],hp.prototype,"mode",void 0),hp=Object(b.a)([Object(w.a)("esri.views.3d.state.controllers.PointToPointAnimationController")],hp);var fp=new zf.a,pp=Object(X.e)(),bp=r(193),vp=r(196),mp=r(210),yp=r(47);function gp(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:wp;return[e[0],e[1],e[2],e[3]]}function Op(e,t){return jp(e[0],e[1],e[2],t,yp.d.get())}function jp(e,t,r,n){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:gp();return i[0]=e,i[1]=t,i[2]=r,i[3]=n,i}function _p(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:gp();return Object(Yl.i)(r,e,t),Object(Yl.t)(r,r),r[3]=Object(mp.a)(e,t),r}var wp=[0,0,1,0];Object(vp.b)(),Object(vp.b)();function xp(e){return{operations:e,value:e.create()}}function kp(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:xp(e);return r.operations=e,e.copy(t,r.value),r}var Sp=Math.pow(2,50);function Tp(e,t,r,n){return e.operations.setAltitudeAt(e.value,t,r,n)}function Cp(e,t,r){return e.operations.elevate(e.value,t,r.value)}var Mp=Object(X.e)();function Pp(e,t,r,n,i){return i[0]=Object(Yl.j)(e,t),i[1]=Object(Yl.j)(e,r),i[2]=Object(Yl.j)(e,n),i}function Ap(e,t,r,n,i){Object(Yl.m)(r,e),Object(Yl.m)(Ep,t),Object(Yl.t)(Ep,Ep),Object(Yl.i)(n,Ep,r),Object(Yl.i)(i,n,r)}var Ep=Object(X.e)(),Rp=r(37),Ip=r(208);function Dp(e,t,r,n){var i=Object(Ip.d)(t,r,Fp);return Object(Nd.i)(e,i,n)}var Fp=Object(Ud.c)();function Lp(e,t,r){return r[0]=t[0]/(e.fullWidth/e.pixelRatio),r[1]=t[1]/(e.fullHeight/e.pixelRatio),r}function zp(e){for(;e>Math.PI;)e-=2*Math.PI;for(;e<-Math.PI;)e+=2*Math.PI;return e}function Vp(e,t,r){var n=yp.a.get();Object(Jl.i)(n),Object(Jl.c)(n,n,r[3],r),Object(Yl.l)(Pb,e.eye,t),Object(Yl.s)(Pb,Pb,n),e.eye=Object(Yl.h)(Pb,Pb,t),Object(Yl.l)(Pb,e.center,t),Object(Yl.s)(Pb,Pb,n),e.center=Object(Yl.h)(Pb,Pb,t),e.up=Object(Yl.s)(Pb,e.up,n)}function Np(e,t,r,n){return Object(Rp.m)(e,Object(Ip.c)(t,r,Db),n)}function Up(e,t,r,n){var i=yp.c.get(),a=1-r;Object(Yl.l)(i,t,e.eye);var o=Object(Yl.r)(i),s=o*(1-a);a>=0&&s<n&&(a=-((s=n)-o)/o),Math.abs(o-s)<1e-6||(Object(Yl.g)(i,i,a),e.eye=Object(Yl.h)(Pb,e.eye,i),e.center=Object(Yl.k)(Pb,e.center,t,a))}function Bp(e,t,r){t.getScreenCenter(qp),Dp(e,t,qp,Pb)&&(t.center=Pb);var n=t.distance,i=n*r;if(!(Math.abs(n-i)<1e-6)){var a=Object(Yl.g)(yp.c.get(),t.viewForward,i);t.eye=Object(Yl.l)(Pb,t.center,a)}}var Gp,qp=Object(Z.f)();function Hp(e,t){Object(Yl.y)(t,0,0,0);var r,n=Object(i.a)(e);try{for(n.s();!(r=n.n()).done;){var a=r.value;Object(Yl.h)(t,t,a)}}catch(o){n.e(o)}finally{n.f()}Object(Yl.g)(t,t,1/e.length)}function Wp(e,t,r,n){return Math.sin(e/Object(Yl.r)(t))*(r+n.radius)}function Qp(e,t,r,n){return Wp(Math.PI/2,t,r,n)+(e-Math.PI/2)}!function(e){e[e.Vertical=0]="Vertical",e[e.Horizontal=1]="Horizontal"}(Gp||(Gp={}));var Zp=3e4,Xp=Object(m.g)(6),Yp={Pole:.95,Angle:Object(m.g)(18),Tilt:45},$p=Object(m.g)(80);function Jp(e,t,r,n,i){var a=Object(X.e)(),o=Object(Nd.c)(),s=!0,c=!0;return e.intersectScreen(r,a)?o[3]=Object(Yl.r)(a):(c=!1,t.aboveGround?o[3]=Math.max(Object(Yl.r)(t.center),.9*i.radius):o[3]=Object(Yl.r)(t.eye)-t.relativeElevation,n?rb(o,t,r,a):s=Dp(o,t,r,a)),{sphere:o,scenePickPoint:s?a:null,hasGeometryIntersection:c}}function Kp(e,t,r,n){return Object(Yl.r)(e.eye)-n.radius>Zp?Gp.Horizontal:r?(Object(Ip.d)(e,t,Fb),-Object(m.t)(e.relativeElevation)*(.5*Math.PI+Object(mp.a)(e.eye,Fb.direction))<Xp?Gp.Vertical:Gp.Horizontal):Gp.Vertical}function eb(e,t,r){Object(Yl.l)(tb,r,t),e.eye=Object(Yl.l)(Pb,e.eye,tb),e.center=Object(Yl.l)(Pb,e.center,tb)}var tb=Object(X.e)();function rb(e,t,r,n){var i=Object(Ip.d)(t,r,Db);return!Object(I.i)(i)&&(Object(Nd.b)(e,i,nb),Object(Nd.i)(e,i,n)?!(Object(Yl.n)(nb,i.origin)<Object(Yl.n)(n,i.origin))||(Object(Yl.m)(n,nb),!1):(Object(Yl.l)(ib,t.eye,t.center),Object(Yl.t)(ib,ib),Object(Rp.f)(ib,-Object(Yl.j)(Object(Yl.t)(ib,ib),nb),ab),Object(Rp.m)(ab,i,n),!1))}var nb=Object(X.e)(),ib=Object(X.e)(),ab=Object(Rp.d)();function ob(e,t,r,n,i,a){var o;if(Object(Yl.i)(Rb,e,t),Object(Yl.l)(Ab,e,t),Object(Yl.r)(e)<=i||!n.aboveGround){Object(Yl.i)(r,Ab,n.eye);var s=Object(Yl.j)(e,t)/(Object(Yl.r)(e)*Object(Yl.r)(t)),c=Math.cos(Object(m.e)(T.f.normalize(Object(m.g)(a)),0,$p));o=-Object(m.b)(s)-Math.max(0,Object(Yl.r)(t)-i)/(c*i)}else Object(Yl.l)(sb,n.eye,n.center),Object(Yl.i)(r,Ab,sb),o=-Object(Yl.r)(Ab)/i;return Object(Yl.t)(r,r),Object(Yl.g)(r,r,Object(Yl.r)(Rb)),o}var sb=Object(X.e)();function cb(e,t,r,n){var i,a=Math.cos(Object(m.e)(T.f.normalize(Object(m.g)(n)),0,$p));return i=t>r?-(t-r)/(a*r):t<-r?Math.PI-(t+r)/(a*r):Object(m.b)(t/r),((e>r?-(e-r)/(a*r):e<-r?Math.PI-(e+r)/(a*r):Object(m.b)(e/r))-i)*r}function lb(e,t,r,n,i,a,o,s,c,l){Object(Yl.i)(Rb,e,t),Ap(a.up,a.eye,gb,Ob,jb),Ap([0,0,1],a.eye,vb,mb,yb),Object(Yl.m)(r,mb),Object(Yl.m)(n,vb),Object(Yl.t)(r,r),Object(Yl.g)(r,r,Object(Yl.r)(Rb)),Pp(e,Object(Yl.t)(Ob,Ob),Object(Yl.t)(jb,jb),Object(Yl.t)(gb,gb),_b),Pp(t,Ob,jb,gb,wb),function(e,t,r,n,i,a,o,s,c,l){var u=cb(e[2],t[2],o[3],c),d=l?cb(e[0],t[0],o[3],180):t[0]-e[0],h=Math.sin(s)*d-Math.cos(s)*u,f=Math.cos(s)*d+Math.sin(s)*u;Object(Yl.t)(Pb,i);var p=l?h/Math.sqrt(Math.abs(Math.pow(o[3],2)-Math.pow(Object(Yl.j)(r,Pb),2))):h/o[3],b=f/Math.sqrt(Math.abs(Math.pow(o[3],2)-Math.pow(Object(Yl.j)(r,n),2)));Object(xu.r)(a,p,b)}(_b,wb,e,vb,mb,i,o,s,c,l)}function ub(e,t,r,n,i,a,o){Object(Jl.i)(Sb),Object(Jl.i)(Tb),Object(Jl.i)(Cb),Object(Jl.c)(Sb,Sb,i,n),Object(Jl.c)(Tb,Tb,o,a),Object(Jl.m)(Cb,Sb,Tb),Object(Yl.l)(t,e,r),Object(Yl.s)(t,t,Cb),Object(Yl.h)(t,t,r)}function db(e,t,r,n,i,a){Object(Jl.i)(Sb),Object(Jl.i)(Tb),Object(Jl.i)(Cb),Object(Jl.c)(Sb,Sb,n,r),Object(Jl.c)(Tb,Tb,a,i),Object(Jl.m)(Cb,Sb,Tb),Object(Yl.l)(Pb,e.eye,t),Object(Yl.s)(Pb,Pb,Cb),e.eye=Object(Yl.h)(Pb,Pb,t),Object(Yl.l)(Pb,e.center,t),Object(Yl.s)(Pb,Pb,Cb),e.center=Object(Yl.h)(Pb,Pb,t),Object(Yl.l)(Pb,e.up,t),Object(Yl.s)(Pb,Pb,Cb),e.up=Object(Yl.h)(Pb,Pb,t)}function hb(e,t,r,n,i,a){var o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:Yp.Pole,s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:Yp.Angle,c=Math.abs(n)>Math.PI-s||Math.abs(n)<s,l=Math.abs(e[2])<r*o||Math.abs(t)>r;return!!(c&&l&&a.aboveGround&&i<Yp.Tilt)}function fb(e,t,r,n,i,a){if(a)_p(r,n,kb),Vp(t,e,kb);else{var o=ob(r,n,Ib,t,e[3],i);Vp(t,e,Op(Ib,o))}}function pb(e,t,r,n,i,a,o){var s,c=o?20:1;Object(Yl.m)(Mb,n),Eb.copyFrom(t);for(var l=0;l<c&&Object(Yl.n)(r,Mb)>1e-12&&(s=Object(Yl.n)(r,Mb),lb(r,Mb,mb,vb,xb,Eb,e,i,a,o),db(Eb,e,vb,xb[1],mb,xb[0]),ub(Mb,Mb,e,vb,xb[1],mb,xb[0]),Object(Yl.n)(r,Mb)<s||0===l);l++)t.copyFrom(Eb)}function bb(e,t,r,n,i,a,o,s,c){hb(e.center,Object(Yl.j)(e.up,e.center),Object(Yl.r)(e.center),-T.f.normalize(Object(m.g)(a)),o,t)?function(e,t,r,n,i,a){Ap([0,0,1],e.eye,vb,mb,yb);var o=t.translation[0]*r.pan,s="zoom"===i.mode?0:t.translation[1]*r.pan,c=Math.max(Math.sqrt(Math.abs(1-Math.pow(Object(Yl.j)(e.center,vb),2)/Math.pow(Object(Yl.r)(e.center),2))),.5),l=(Math.sin(a)*s+Math.cos(a)*o)/c,u=-Math.cos(a)*s+Math.sin(a)*o;switch(Object(Jl.c)(n.pan.matrix,n.pan.matrix,l,vb),n.pan.enabled=!0,i.mode){case"pan":Object(Jl.c)(n.pan.matrix,n.pan.matrix,u,mb),n.pan.enabled=!0;break;case"zoom":n.zoom=-t.translation[1]*r.zoom}}(t,r,n,s,c,-T.f.normalize(Object(m.g)(i))):function(e,t,r,n,i){var a=e.eye,o=e.viewRight,s=Object(Yl.i)(yp.c.get(),o,a),c=t.translation[0]*r.pan;switch(0!==c&&(Object(Jl.c)(n.pan.matrix,n.pan.matrix,-c,s),n.pan.enabled=!0),i.mode){case"pan":var l=t.translation[1]*r.pan;0!==l&&(Object(Jl.c)(n.pan.matrix,n.pan.matrix,l,o),n.pan.enabled=!0);break;case"zoom":n.zoom=-t.translation[1]*r.zoom}}(t,r,n,s,c)}var vb=Object(X.e)(),mb=Object(X.e)(),yb=Object(X.e)(),gb=Object(X.e)(),Ob=Object(X.e)(),jb=Object(X.e)(),_b=Object(X.e)(),wb=Object(X.e)(),xb=Object(ku.b)(),kb=gp(),Sb=Object(Kl.d)(),Tb=Object(Kl.d)(),Cb=Object(Kl.d)(),Mb=Object(X.e)(),Pb=Object(X.e)(),Ab=Object(X.e)(),Eb=new zf.a,Rb=Object(X.e)(),Ib=Object(X.e)(),Db={origin:Object(X.e)(),direction:Object(X.e)()},Fb={origin:Object(X.e)(),direction:Object(X.e)()},Lb=function(e){Object(f.a)(r,e);var t=Object(p.a)(r);function r(){var e;return Object(c.a)(this,r),(e=t.apply(this,arguments)).zoomLocation=Object(X.e)(),e.tmpCamera=new zf.a,e.tmpViewDir=Object(X.e)(),e.tmpRayDir={origin:Object(X.e)(),direction:Object(X.e)()},e.targetOnSphere=Object(X.e)(),e.tmpCenter=Object(X.e)(),e.constraintOptions={selection:7,interactionType:1,interactionFactor:null,interactionStartCamera:new zf.a,interactionDirection:null,tiltMode:0},e.sphere=Object(Nd.c)(),e}return Object(l.a)(r,[{key:"initialize",value:function(){this.intersector=new fh.a(this.view.state.viewingMode)}},{key:"zoomStep",value:function(e,t){if(this.active){var r=this.view.state,n=this.constraintOptions.interactionStartCamera;this.animation.finished?n.copyFrom(r.camera):this.animation.cameraAt(1,n);var i=!1,a=!1;this.intersectionHelper.intersectScreen(t,this.zoomLocation)&&(i=e>0,a=!0),this.tmpCamera.copyFrom(r.camera),i?this.intersectionHelper.intersectRay(this.tmpCamera.ray,this.intersector,this.tmpCenter)&&(this.tmpCamera.center=this.tmpCenter):this.intersectionHelper.intersectRay(this.tmpCamera.ray,this.intersector,this.zoomLocation)?this.tmpCamera.center=this.zoomLocation:Object(Yl.m)(this.zoomLocation,this.tmpCamera.center),this.updateCamera(this.tmpCamera,e,this.zoomLocation,t,a),this.begin(this.tmpCamera)}}},{key:"animationSettings",value:function(){return{apex:null,duration:Object(Vd.a)(600),easing:rf}}},{key:"updateCamera",value:function(e,t,r,n,i){if(Kp(e,n,i,Object(J.e)(this.view.spatialReference))===Gp.Horizontal||Object(g.a)("disable-feature:context-navigation")){var a=Math.pow(.6,t);this.sphere[3]=Object(Yl.r)(r),Object(Yl.l)(this.tmpViewDir,e.center,e.eye);var o=Object(Yl.r)(this.tmpViewDir),s=o*a;if(a<=1&&s<4&&(a=(s=4)/o),Math.abs(o-s)<1e-6)return;var c=Object(Yl.r)(e.center);if(this.sphere[3]!==c){var l=this.sphere[3]+a*(c-this.sphere[3]);e.center=Object(Yl.g)(zb,e.center,l/c)}Object(Yl.g)(this.tmpViewDir,this.tmpViewDir,-a),e.eye=Object(Yl.h)(zb,e.center,this.tmpViewDir),jf(this.view,e,this.constraintOptions),Object(Yl.n)(r,e.center)>1e-12&&Dp(this.sphere,e,n,this.targetOnSphere)&&function(e,t,r,n,i,a,o){hb(r,Object(Yl.j)(t.up,r),e[3],-T.f.normalize(Object(m.g)(i)),a,t,Yp.Pole,Yp.Angle)?pb(e,t,r,n,-T.f.normalize(Object(m.g)(i)),a,o):fb(e,t,r,n,a,o)}(this.sphere,e,r,this.targetOnSphere,this.view.camera.heading,this.view.camera.tilt,!0)}else{var u,d=Math.pow(.6,Math.abs(t)),h=t>0?1:-1;Object(Ip.d)(e,n,this.tmpRayDir),Object(Yl.t)(this.tmpRayDir.direction,this.tmpRayDir.direction),this.view.camera.position.hasZ&&(u=Math.abs(this.view.camera.position.z));var f=Math.max(12*u,20),p=this.view._stage.renderView.getMinimalDepthForArea(n[0],n[1],this.view.state.camera,60);f=f>p?p:f,Object(Yl.g)(this.tmpRayDir.direction,this.tmpRayDir.direction,f),Object(Yl.h)(r,this.tmpRayDir.origin,this.tmpRayDir.direction);var b=f*d;if(t>0&&b<4&&(d=(b=4)/f),Math.abs(f-b)<1e-6)return;Object(Yl.g)(this.tmpRayDir.direction,this.tmpRayDir.direction,h*(1-d)),e.eye=Object(Yl.h)(zb,e.eye,this.tmpRayDir.direction),e.center=Object(Yl.h)(zb,e.center,this.tmpRayDir.direction)}wh(this.view,e)}}]),r}(hp);Lb=Object(b.a)([Object(w.a)("esri.views.3d.state.controllers.global.ZoomStepController")],Lb);var zb=Object(X.e)(),Vb=r(322),Nb=function(e){Object(f.a)(r,e);var t=Object(p.a)(r);function r(){var e;return Object(c.a)(this,r),(e=t.apply(this,arguments)).zoomLocation=Object(X.e)(),e.tmpCamera=new zf.a,e.tmpRayDir=Object(X.e)(),e.tmpCenter=Object(X.e)(),e.constraintOptions={selection:15,interactionType:1,interactionFactor:null,interactionStartCamera:new zf.a,interactionDirection:null,tiltMode:0},e}return Object(l.a)(r,[{key:"zoomStep",value:function(e,t){if(this.active){var r=this.view.state,n=this.constraintOptions.interactionStartCamera;this.animation.finished?n.copyFrom(r.camera):this.animation.cameraAt(1,n),this.tmpCamera.copyFrom(r.camera);var i=new fh.a(this.view.state.viewingMode);e>0?(this.intersectionHelper.intersectScreenFreePointFallback(t,this.zoomLocation),this.intersectionHelper.intersectRay(this.tmpCamera.ray,i,this.tmpCenter)&&(this.tmpCamera.center=this.tmpCenter)):this.intersectionHelper.intersectRay(this.tmpCamera.ray,i,this.zoomLocation)?this.tmpCamera.center=this.zoomLocation:Object(Yl.m)(this.zoomLocation,this.tmpCamera.center);var a=Math.pow(.6,e);if(!Object(Vb.a)()){var o=this.view._stage.renderView.getMinimalDepthForArea(t[0],t[1],this.view.state.camera,60),s=Math.max(14*Math.abs(this.view.camera.position.z),20);if(o=o?Math.min(o,s):s){var c=Object(X.e)();Object(Yl.l)(c,this.zoomLocation,this.tmpCamera.eye),o<Object(Yl.r)(c)&&(Object(Yl.t)(c,c),Object(Yl.h)(this.zoomLocation,this.tmpCamera.eye,Object(Yl.g)(c,c,o)))}}this.updateCamera(this.tmpCamera,a,this.zoomLocation),this.begin(this.tmpCamera)}}},{key:"animationSettings",value:function(){return{apex:null,duration:Object(Vd.a)(600),easing:rf}}},{key:"updateCamera",value:function(e,t,r){Object(Yl.l)(this.tmpRayDir,r,e.eye);var n=Object(Yl.r)(this.tmpRayDir),i=n*t;t<=1&&i<4&&(t=(i=4)/n),Math.abs(n-i)<1e-6||(Object(Yl.g)(this.tmpRayDir,this.tmpRayDir,t),e.eye=Object(Yl.l)(Ub,r,this.tmpRayDir),e.center=Object(Yl.k)(Ub,e.center,r,1-t),jf(this.view,e,this.constraintOptions))}}]),r}(hp);Nb=Object(b.a)([Object(w.a)("esri.views.3d.state.controllers.local.ZoomStepController")],Nb);var Ub=Object(X.e)();function Bb(e,t){if("touch"===e.pointerType)return!1;switch(t){case"primary":return 0===e.button;case"secondary":return 2===e.button;case"tertiary":return 1===e.button}}var Gb=function(e){Object(f.a)(r,e);var t=Object(p.a)(r);function r(e,n){var i;return Object(c.a)(this,r),(i=t.call(this,!0)).view=e,i.registerIncoming("double-click",n,(function(e){return i.handleDoubleClick(e)})),i}return Object(l.a)(r,[{key:"handleDoubleClick",value:function(e){var t=e.data;if(function(e,t){switch(t){case"primary":return"touch"===e.pointerType||0===e.button;case"secondary":return"touch"!==e.pointerType&&2===e.button;case"tertiary":return"touch"!==e.pointerType&&1===e.button}}(t,"primary")){var r=this.view.state.isGlobal?new Lb({view:this.view,mode:"animation"}):new Nb({view:this.view,mode:"animation"});this.view.state.switchCameraController(r),r.zoomStep(Math.log(.5)/Math.log(.6),Object(Z.f)(t.x,t.y)),e.stopPropagation()}}}]),r}(sa),qb=function(e){Object(f.a)(r,e);var t=Object(p.a)(r);function r(){var e;return Object(c.a)(this,r),(e=t.apply(this,arguments)).startCamera=new zf.a,e.currentCamera=new zf.a,e}return Object(l.a)(r,[{key:"isInteractive",get:function(){return!0}},{key:"stepController",value:function(e,t){t.copyViewFrom(this.currentCamera),this.currentCamera.copyFrom(t)}},{key:"onControllerStart",value:function(e){this.state=ip.Running,this.startCamera.copyFrom(e),this.currentCamera.copyFrom(e)}},{key:"onControllerEnd",value:function(e){e.copyViewFrom(this.currentCamera)}}]),r}(up);qb=Object(b.a)([Object(w.a)("esri.views.3d.state.controllers.InteractiveController")],qb);var Hb=function(e){Object(f.a)(r,e);var t=Object(p.a)(r);function r(e){var n;return Object(c.a)(this,r),(n=t.call(this,e)).view=null,n.pivot=0,n.lastPoint=Object(ku.b)(),n.tmpWorldUp=Object(X.e)(),n.tmpViewDir=Object(X.e)(),n.tmpRotCurPoint=Object(ku.b)(),n.tmpTransf=Object(Kl.d)(),n.tmpAxis=Object(X.e)(),n.tmpPivotPoint=Object(X.e)(),n.pivotPos=Object(X.e)(),n.constraintOptions={selection:15,interactionType:2,interactionFactor:0,interactionStartCamera:null,interactionDirection:null,tiltMode:0},n}return Object(l.a)(r,[{key:"intersectionHelper",get:function(){return this.view.sceneIntersectionHelper}},{key:"initialize",value:function(){this.rotScale=0===this.pivot?3:1.5}},{key:"begin",value:function(e){if(this.active){switch(this.pivot){case 1:Object(Yl.m)(this.pivotPos,this.startCamera.eye),this.constraintOptions.interactionType=3,this.constraintOptions.tiltMode=1,this.constraintOptions.selection=0;break;case 0:this.intersectionHelper.intersectRayFreePointFallback(this.startCamera.ray,this.pivotPos)||Object(Yl.m)(this.pivotPos,this.startCamera.center),Object(g.a)("disable-feature:context-navigation")||this.constrainPivotPoint(e),this.startCamera.center=this.pivotPos,this.constraintOptions.interactionType=2,this.constraintOptions.tiltMode=0,this.constraintOptions.selection=11}this.constraintOptions.interactionStartCamera=this.startCamera,Lp(this.startCamera,e,this.lastPoint)}}},{key:"constrainPivotPoint",value:function(e){var t=this.startCamera,r=Object(X.e)();Object(Yl.l)(r,this.pivotPos,t.eye);var n=Object(Yl.r)(r);this.view.camera.position.hasZ&&(n=Math.min(n,7*Math.abs(this.view.camera.position.z)));var i=Object(J.e)(this.view.spatialReference),a=Object(Z.f)(t.width/t.pixelRatio*.5,t.height/t.pixelRatio*.5),o=Kp(this.startCamera,a,!0,i),s=this.view._stage.renderView.getMinimalDepthForArea(t.fullWidth/t.pixelRatio*.5,t.fullHeight/t.pixelRatio*.5,t,225,90),c=this.view._stage.renderView.getMinimalDepthForArea(e[0],e[1],t,90);void 0===s&&void 0===c||(n=(s=void 0===s?c:s)>(c=void 0===c||o===Gp.Horizontal?s:c)?c:s),Object(Yl.t)(r,r),Object(Yl.m)(this.pivotPos,Object(Yl.h)(this.tmpPivotPoint,t.eye,Object(Yl.g)(this.tmpPivotPoint,r,n)))}},{key:"update",value:function(e){if(this.active){switch(this.pivot){case 1:this.currentCamera.center=this.applyRotation(this.currentCamera,e,this.currentCamera.center,this.pivotPos);break;case 0:this.currentCamera.center=this.pivotPos,this.currentCamera.eye=this.applyRotation(this.currentCamera,e,this.currentCamera.eye,this.pivotPos)}jf(this.view,this.currentCamera,this.constraintOptions)}}},{key:"end",value:function(){this.active&&this.finishController()}},{key:"applyRotation",value:function(e,t,r,n){this.view.renderCoordsHelper.worldUpAtPosition(n,this.tmpWorldUp),Lp(e,t,this.tmpRotCurPoint);var i=(this.lastPoint[1]-this.tmpRotCurPoint[1])*this.rotScale,a=(this.tmpRotCurPoint[0]-this.lastPoint[0])*this.rotScale;Object(Yl.l)(this.tmpViewDir,r,n);var o=Object(Yl.r)(this.tmpViewDir),s=Object(m.b)(Object(Yl.j)(this.tmpViewDir,this.tmpWorldUp)/o);if(1===this.pivot){i*=-.5;var c=.5*Math.PI-s,l=.5*Math.PI*.99;i=c-Math.max(-l,Math.min(l,c+i))}return i=Object(m.e)(i+s,sl.min,sl.max)-s,Object(Jl.i)(this.tmpTransf),Object(Yl.i)(this.tmpAxis,e.up,this.tmpViewDir),0===this.pivot&&(a=-a),Object(Jl.c)(this.tmpTransf,this.tmpTransf,a,this.tmpWorldUp),Object(Jl.c)(this.tmpTransf,this.tmpTransf,i,this.tmpAxis),Object(Yl.s)(this.tmpViewDir,this.tmpViewDir,this.tmpTransf),e.up=Object(Yl.s)(Wb,e.up,this.tmpTransf),Object(Yl.h)(Wb,n,this.tmpViewDir),Object(xu.c)(this.lastPoint,this.tmpRotCurPoint),Wb}}]),r}(qb);Object(b.a)([Object(y.b)({constructOnly:!0})],Hb.prototype,"view",void 0),Object(b.a)([Object(y.b)()],Hb.prototype,"pivot",void 0),Hb=Object(b.a)([Object(w.a)("esri.views.3d.state.controllers.RotateController")],Hb);var Wb=Object(X.e)(),Qb=function(e){Object(f.a)(r,e);var t=Object(p.a)(r);function r(e,n,i,a){var o;return Object(c.a)(this,r),(o=t.call(this,!0)).view=e,o.pointerAction=n,o.pivot=i,o.registerIncoming("drag",a,(function(e){return o.handleDrag(e)})),o}return Object(l.a)(r,[{key:"handleDrag",value:function(e){var t=e.data;if(!(t.pointers.size>1)&&Bb(e.data,this.pointerAction)){var r=Object(Z.f)(t.center.x,t.center.y);switch(t.action){case"start":this.cameraController&&(this.cameraController.end(),this.cameraController=null),this.cameraController=new Hb({view:this.view,pivot:this.pivot}),this.view.state.switchCameraController(this.cameraController),this.cameraController.begin(r);break;case"update":this.cameraController&&this.cameraController.update(r);break;case"end":this.cameraController&&(this.cameraController.end(),this.cameraController=null)}e.stopPropagation()}}}]),r}(sa),Zb=function(e){Object(f.a)(r,e);var t=Object(p.a)(r);function r(e){var n;return Object(c.a)(this,r),(n=t.call(this,e)).view=null,n.pickPoint=Object(X.e)(),n.tmpP0=Object(ku.b)(),n.panAxisAngle=gp(),n.tmpRayDir=Object(X.e)(),n.targetOnSphere=Object(X.e)(),n.tmpRay={origin:Object(X.e)(),direction:Object(X.e)()},n.dragBeginPoint=Object(Z.f)(),n.normalizedAnchorPoint=Object(ku.b)(),n.constraintOptions={selection:7,interactionType:1,interactionFactor:0,interactionStartCamera:null,interactionDirection:null,tiltMode:0},n.sphere=Object(Nd.c)(),n.hasPickPoint=!1,n}return Object(l.a)(r,[{key:"intersectionHelper",get:function(){return this.view.sceneIntersectionHelper}},{key:"begin",value:function(e){if(this.active){Object(xu.c)(this.dragBeginPoint,e),Lp(this.startCamera,e,this.normalizedAnchorPoint);var t=Object(J.e)(this.view.spatialReference),r=Jp(this.intersectionHelper,this.startCamera,e,!1,t);if(this.navMode=Kp(this.startCamera,e,r.hasGeometryIntersection,t),this.navMode===Gp.Horizontal||Object(g.a)("disable-feature:context-navigation"))this.hasPickPoint=!!r.scenePickPoint,this.pickPoint=r.scenePickPoint,this.sphere=r.sphere;else{var n;Object(Ip.d)(this.startCamera,e,this.tmpRay),Object(Yl.t)(this.tmpRay.direction,this.tmpRay.direction),this.view.camera.position.hasZ&&(n=Math.abs(this.view.camera.position.z));var i=30*n,a=this.view._stage.renderView.getMinimalDepthForArea(e[0],e[1],this.view.state.camera,70);i=i>a?a:i,this.hasPickPoint=!0,Object(Yl.g)(this.tmpRay.direction,this.tmpRay.direction,i),Object(Yl.h)(this.pickPoint,this.tmpRay.origin,this.tmpRay.direction)}this.constraintOptions.interactionStartCamera=this.startCamera}}},{key:"update",value:function(e){if(this.active){if(this.currentCamera.eye=this.startCamera.eye,this.currentCamera.center=this.startCamera.center,this.currentCamera.up=this.startCamera.up,this.navMode===Gp.Horizontal||Object(g.a)("disable-feature:context-navigation")){Object(Yl.l)(this.tmpRayDir,this.currentCamera.center,this.currentCamera.eye);var t=Object(Yl.r)(this.tmpRayDir);Lp(this.currentCamera,e,this.tmpP0);var r=12*(this.normalizedAnchorPoint[1]-this.tmpP0[1]),n=t*Math.pow(2,r),i=this.view.state.constraints.minimumPoiDistance;if(r<0&&n<i&&(n=i),Math.abs(t-n)<1e-6)return;if(this.hasPickPoint&&n<t){var a=1-(1-n/t)*(1-this.sphere[3]/Object(Yl.r)(this.currentCamera.center));this.currentCamera.center=Object(Yl.g)(Xb,this.currentCamera.center,a)}Object(Yl.g)(this.tmpRayDir,this.tmpRayDir,-n/t),this.currentCamera.eye=Object(Yl.h)(Xb,this.currentCamera.center,this.tmpRayDir),this.constraintOptions.interactionFactor=wf(this.dragBeginPoint,e),jf(this.view,this.currentCamera,this.constraintOptions),this.hasPickPoint&&(rb(this.sphere,this.currentCamera,this.dragBeginPoint,this.targetOnSphere),_p(this.pickPoint,this.targetOnSphere,this.panAxisAngle),Vp(this.currentCamera,this.sphere,this.panAxisAngle))}else{var o=Object(Yl.r)(this.tmpRay.direction);Lp(this.currentCamera,e,this.tmpP0);var s=12*(this.normalizedAnchorPoint[1]-this.tmpP0[1]),c=o*Math.pow(2,s),l=this.view.state.constraints.minimumPoiDistance;if(s<0&&c<l&&(c=l),Math.abs(o-c)<1e-6)return;Object(Yl.g)(this.tmpRayDir,this.tmpRay.direction,1-c/o),this.currentCamera.eye=Object(Yl.h)(Xb,this.currentCamera.eye,this.tmpRayDir),this.currentCamera.center=Object(Yl.h)(Xb,this.currentCamera.center,this.tmpRayDir)}wh(this.view,this.currentCamera)}}},{key:"end",value:function(){this.active&&this.finishController()}}]),r}(qb);Object(b.a)([Object(y.b)({constructOnly:!0})],Zb.prototype,"view",void 0),Zb=Object(b.a)([Object(w.a)("esri.views.3d.state.controllers.global.ZoomController")],Zb);var Xb=Object(X.e)(),Yb=function(e){Object(f.a)(r,e);var t=Object(p.a)(r);function r(e){var n;return Object(c.a)(this,r),(n=t.call(this,e)).view=null,n.tmpP=Object(X.e)(),n.tmpDir=Object(X.e)(),n.tmpN=Object(X.e)(),n.tmpP0=Object(ku.b)(),n.tmpPoi=Object(X.e)(),n.tmpRayDir=Object(X.e)(),n.dragBeginPoint=Object(Z.f)(),n.normalizedAnchorPoint=Object(ku.b)(),n.constraintOptions={selection:15,interactionType:1,interactionFactor:0,interactionStartCamera:null,interactionDirection:Object(X.e)(),tiltMode:0},n.plane=Object(Rp.d)(),n}return Object(l.a)(r,[{key:"intersectionHelper",get:function(){return this.view.sceneIntersectionHelper}},{key:"begin",value:function(e){if(this.active){var t;Object(xu.c)(this.dragBeginPoint,e),Lp(this.startCamera,e,this.normalizedAnchorPoint),this.intersectionHelper.intersectScreenFreePointFallback(e,this.tmpP),Object(Yl.l)(this.tmpDir,this.tmpP,this.startCamera.eye),Object(Yl.t)(this.tmpDir,this.tmpDir),this.view.camera.position.hasZ&&(t=Math.abs(this.view.camera.position.z));var r=30*t,n=this.view._stage.renderView.getMinimalDepthForArea(e[0],e[1],this.view.state.camera,70);r=r>n?n:r,Object(Yl.g)(this.tmpDir,this.tmpDir,r),Object(Yl.h)(this.tmpP,this.startCamera.eye,this.tmpDir),Object(Yl.l)(this.tmpN,this.startCamera.eye,this.startCamera.center),Object(Yl.t)(this.tmpN,this.tmpN),this.tmpN[1]<0&&Object(Yl.u)(this.tmpN,this.tmpN),Object(Rp.h)(this.tmpP,this.tmpN,this.plane),this.constraintOptions.interactionStartCamera=this.startCamera}}},{key:"update",value:function(e){if(this.active){Np(this.plane,this.currentCamera,this.dragBeginPoint,this.tmpPoi)||Object(Yl.m)(this.tmpPoi,this.currentCamera.center),Lp(this.currentCamera,e,this.tmpP0);var t=4*(this.tmpP0[1]-this.normalizedAnchorPoint[1]);Object(xu.c)(this.normalizedAnchorPoint,this.tmpP0),Object(Yl.l)(this.tmpRayDir,this.tmpPoi,this.currentCamera.eye);var r=Object(Yl.r)(this.tmpRayDir),n=r*(1-t);Object(Yl.m)(this.constraintOptions.interactionDirection,this.tmpRayDir),Object(Yl.g)(this.constraintOptions.interactionDirection,this.constraintOptions.interactionDirection,Object(m.t)(t)/r);var i=this.view.state.constraints.minimumPoiDistance;t>=0&&n<i&&(t=-((n=i)-r)/r),Math.abs(r-n)<1e-6||(Object(Yl.g)(this.tmpRayDir,this.tmpRayDir,t),this.currentCamera.eye=Object(Yl.h)($b,this.currentCamera.eye,this.tmpRayDir),Object(Yl.k)($b,this.currentCamera.center,this.tmpPoi,t),this.tmpPoi[2]>this.startCamera.center[2]?$b[2]=Math.max(this.startCamera.center[2],$b[2]):$b[2]=Math.min(this.startCamera.center[2],$b[2]),this.currentCamera.center=$b,this.constraintOptions.interactionFactor=wf(this.dragBeginPoint,e),jf(this.view,this.currentCamera,this.constraintOptions))}}},{key:"end",value:function(){this.active&&this.finishController()}}]),r}(qb);Object(b.a)([Object(y.b)({constructOnly:!0})],Yb.prototype,"view",void 0),Yb=Object(b.a)([Object(w.a)("esri.views.3d.state.controllers.local.ZoomController")],Yb);var $b=Object(X.e)(),Jb=function(e){Object(f.a)(r,e);var t=Object(p.a)(r);function r(e,n,i){var a;return Object(c.a)(this,r),(a=t.call(this,!0)).view=e,a.pointerAction=n,a.registerIncoming("drag",i,(function(e){return a.handleDrag(e)})),a}return Object(l.a)(r,[{key:"handleDrag",value:function(e){var t=e.data;if(!(t.pointers.size>1)&&Bb(e.data,this.pointerAction)){var r=Object(Z.f)(t.center.x,t.center.y);switch(t.action){case"start":this.cameraController&&(this.cameraController.end(),this.cameraController=null),this.view.state.isGlobal?this.cameraController=new Zb({view:this.view}):this.cameraController=new Yb({view:this.view}),this.view.state.switchCameraController(this.cameraController),this.cameraController.begin(r);break;case"update":this.cameraController&&this.cameraController.update(r);break;case"end":this.cameraController&&(this.cameraController.end(),this.cameraController=null)}e.stopPropagation()}}}]),r}(sa),Kb=Object(X.e)(),ev=Object(X.e)();function tv(){return{direction:Object(X.e)(),up:Object(X.e)()}}function rv(e,t,r,n,i){var a=Object(Yl.t)(Kb,e),o=Object(Yl.j)(a,n),s=o>0;(o=Math.abs(o))>.99&&((o=Math.abs(Object(Yl.j)(t,n)))<.99?(Object(Yl.m)(a,t),s&&Object(Yl.g)(a,a,-1)):a=null);var c=0;if(a){Object(Yl.g)(ev,n,Object(Yl.j)(n,a)),Object(Yl.l)(a,a,ev);var l=Object(Yl.j)(a,i)/(Object(Yl.r)(a)*Object(Yl.r)(i));Object(Yl.i)(ev,a,i),c=(Object(Yl.j)(ev,n)>0?1:-1)*Object(m.r)(Object(m.b)(l))}var u=Object(m.r)(Object(m.b)(-Object(Yl.j)(n,e)/Object(Yl.r)(e)));return r?(r.heading=c,r.tilt=u,r):{heading:c,tilt:u}}var nv=Object(X.g)(0,1,0),iv=Object(X.g)(0,0,1),av=Object(Kl.d)(),ov=Object(X.e)(),sv=Object(X.e)();function cv(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:tv();Object(Jl.i)(av);var i=n.direction,a=n.up;return Object(Jl.r)(av,av,-Object(m.g)(t)),Object(Jl.b)(av,av,Object(m.g)(r)),Object(Yl.s)(i,iv,av),Object(Yl.g)(i,i,-1),Object(Yl.s)(a,nv,av),n}function lv(e,t,r,n,i){var a=e.renderSpatialReference,o=e.map&&e.spatialReference||t.spatialReference;return Object($.u)(t,ov,a),Object($.u)(t,sv,a),ov[0]-=r/2,sv[0]+=r/2,ov[1]-=n/2,sv[1]+=n/2,Object($.z)(ov,a,ov,o),Object($.z)(sv,a,sv,o),i?(i.xmin=ov[0],i.ymin=ov[1],i.xmax=sv[0],i.ymax=sv[1],i.spatialReference=o):i=new Bs.a(ov[0],ov[1],sv[0],sv[1],o),i}var uv=Object.freeze({__proto__:null,headingTiltToDirectionUp:cv,directionToHeadingTilt:function(e,t,r,n){return rv(t,r,n,iv,nv)},eyeForCenterWithHeadingTilt:function(e,t,r,n){var i=cv(e,r,n),a=Object(X.e)();return Object(Yl.g)(a,i.direction,-t),Object(Yl.h)(a,a,e),{up:i.up,eye:a,heading:r,tilt:n}},lookAtTiltToEyeTilt:function(e){return Object(m.r)(e)},eyeTiltToLookAtTilt:function(e){return Object(m.g)(e)},toExtent:lv}),dv=Object(X.g)(0,0,1),hv=Object(Yl.t)(Object(X.e)(),Object(X.g)(1,1,1)),fv=new T.a(-180,180),pv=Object(Kl.d)(),bv=Object(X.e)(),vv=Object(X.e)();function mv(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:tv();Object(Yl.i)(bv,e,dv),0===Object(Yl.j)(bv,bv)&&Object(Yl.i)(bv,e,hv),Object(Jl.i)(pv),Object(Jl.c)(pv,pv,-Object(m.g)(t),e),Object(Jl.c)(pv,pv,-Object(m.g)(r),bv);var i=n.up,a=n.direction;return Object(Yl.i)(i,bv,e),Object(Yl.t)(i,i),Object(Yl.s)(i,i,pv),Object(Yl.t)(a,e),Object(Yl.u)(a,a),Object(Yl.s)(a,a,pv),n}function yv(e){var t=e[1];e[1]=-e[2],e[2]=t}function gv(e,t){var r=mv(t,e.heading,e.tilt);return e.up=r.up,e}function Ov(e,t,r,n,i){var a,o,s,c,l=t.latitude,u=t.longitude,d=function(e,t,r){var n=t/r,i=Object(m.g)(e),a=Math.sin(n/2),o=Math.cos(i),s=2*Object(m.c)(Math.sqrt(a*a/(o*o)));return Object(m.r)(s)}(l,r,Object(J.e)(e.spatialReference).radius)/2;a=u-d,o=u+d;var h=Object(m.g)(l),f=Object(J.e)(e.spatialReference).radius,p=(1+Math.sin(h))/(1-Math.sin(h)),b=(p+1)*Math.tan(n/f/2),v=b*b;function y(e){var t=Math.PI/2;return(e=T.d.normalize(e,-t))>t&&(e=Math.PI-e),e}if(c=(s=1.5*Math.PI-2*Math.atan(.5*(b+Math.sqrt(4*p+v))))+n/f,s=y(s),(c=y(c))<s){var g=c;c=s,s=g}if(s=Math.max(Object(m.r)(s),-90),c=Math.min(Object(m.r)(c),90),(o=fv.monotonic(a,o))-a>180){var O=(o-a-180)/2;a+=O,o-=O}var j=e.spatialReference&&e.spatialReference.isGeographic?e.spatialReference:Gs.a.WGS84;return i?(i.xmin=a,i.ymin=s,i.xmax=o,i.ymax=c,i.spatialReference=j):i=new Bs.a(a,s,o,c,j),e.spatialReference&&e.spatialReference.isWebMercator&&Object(re.b)(i,!1,i),i}var jv=Object.freeze({__proto__:null,headingTiltToDirectionUp:mv,directionToHeadingTilt:function(e,t,r,n){var i=bv,a=vv;return Object(Yl.t)(i,e),Object(Yl.i)(vv,i,dv),0===Object(Yl.j)(vv,vv)&&Object(Yl.i)(vv,i,hv),Object(Yl.i)(a,vv,i),rv(t,r,n,i,a)},eyeForCenterWithHeadingTilt:function(e,t,r,n){var i={eye:Object(X.e)(),up:null,tilt:n,heading:r},a=bv;a[0]=e[0],a[1]=e[2],a[2]=-e[1];var o,s=t,c=Object(m.g)(r),l=Object(m.g)(n),u=Math.sin(c),d=Math.cos(c),h=Math.sin(l),f=Math.cos(l),p=Object(Yl.r)(a);if(Math.abs(l)<1e-8)o=s+p;else{var b=p/h,v=Object(m.c)(s/b),y=Math.PI-l-v;o=b*Math.sin(y)}var g=f*s,O=s*s*(h*h),j=d*d*O,_=o-g,w=_*_,x=j*(j+w-a[1]*a[1]);if(x<0)return Object(Yl.g)(i.eye,a,o/p),i.tilt=0,i;var k,S=Math.sqrt(x),T=a[1]*_,C=j+w;if(k=d>0?-S+T:S+T,Math.abs(C)<1e-8)return p<1e-8?(i.eye[0]=0,i.eye[1]=0,i.eye[2]=s):Object(Yl.g)(i.eye,a,o/p),i.tilt=0,yv(i.eye),gv(i,e);i.eye[1]=k/C;var M=u*u*O,P=h*s,A=d*P*i.eye[1],E=i.eye[1]*i.eye[1],R=1-E,I=Math.sqrt(R),D=j*E+M-2*A*I*_+R*w;return Math.abs(D)<1e-8?(Object(Yl.g)(i.eye,a,o/p),i.tilt=0,yv(i.eye),gv(i,e)):(i.eye[0]=(R*(o*a[0]-g*a[0])-P*I*(a[0]*i.eye[1]*d+a[2]*u))/D,i.eye[2]=(R*(o*a[2]-g*a[2])-P*I*(a[2]*i.eye[1]*d-a[0]*u))/D,Object(Yl.g)(i.eye,i.eye,o),yv(i.eye),gv(i,e))},lookAtTiltToEyeTilt:function(e,t,r){var n=Object(Yl.r)(t),i=Math.sqrt(r*r+n*n-2*r*n*Math.cos(Math.PI-e)),a=Object(m.c)(r/(i/Math.sin(e)));return Object(m.r)(e-a)},eyeTiltToLookAtTilt:function(e,t,r){var n=Object(m.g)(e),i=Object(Yl.r)(t);return Object(m.c)(r/(i/Math.sin(n)))+n},toExtent:Ov});function _v(e,t){return null!=e&&("2d"===t||("local"===t?!e.isGeographic:e.isWebMercator||e.isWGS84||4490===e.wkid||104971===e.wkid||104905===e.wkid||104903===e.wkid))}var wv=j.a.getLogger("esri.views.3d.support.cameraUtils"),xv=Object(X.e)(),kv=Object(X.e)(),Sv={heading:0,tilt:0},Tv=new S.a,Cv=new T.a(-20037508.342788905,20037508.342788905),Mv=new T.a(-180,180);function Pv(e){return e.spatialReference||Gs.a.WGS84}function Av(e){return"global"===e.viewingMode?jv:uv}function Ev(e,t){if(Object(I.i)(t))return null;var r=e.renderSpatialReference,n=Av(e).headingTiltToDirectionUp,i=Object(X.e)();if(!Object($.u)(t.position,i,r))return null;var a=n(i,t.heading,t.tilt);Object(Yl.g)(a.direction,a.direction,e.state.camera.distance),Object(Yl.h)(a.direction,a.direction,i);var o=vh(e,i,a.direction,a.up);return o.fov=Object(m.g)(t.fov),o}var Rv=Object(X.e)();function Iv(e,t,r){var n=e.renderSpatialReference,i=Vv(e,t.eye,t.viewForward,t.up,Sv),a=Pv(e);return Object($.z)(t.eye,n,Rv,a)||(a=Gs.a.WGS84,Object($.z)(t.eye,n,Rv,a)),Object(I.i)(r)?new P(new S.a(Rv,a),i.heading,i.tilt,Object(m.r)(t.fov)):(r.position.x=Rv[0],r.position.y=Rv[1],r.position.z=Rv[2],r.position.spatialReference=a,r.heading=i.heading,r.tilt=i.tilt,r.fov=Object(m.r)(t.fov),r)}function Dv(e,t,r){var n=e.state.camera,i=n.width/2/n.pixelRatio;return 1===e.renderCoordsHelper.viewingMode&&null!=r&&(t*=Math.cos(Object(m.g)(r))),i/(96*39.37/(t/=e.renderCoordsHelper.unitInMeters))/Math.tan(n.fovX/2)}function Fv(e,t,r){var n=e.state.camera,i=t*Math.tan(n.fovX/2),a=96*39.37/(n.width/2/n.pixelRatio/i);return 1===e.renderCoordsHelper.viewingMode&&(a/=Math.cos(Object(m.g)(r))),a*=e.renderCoordsHelper.unitInMeters}function Lv(e,t,r,n,i,a){return zv(e,t,Dv(e,r,t.latitude),n,i,a)}function zv(e,t,r,n,i,a){if(Kv(a)){var o=new Jv(a.signal);return Bv(e,n.heading,n.tilt,t,r,i,o),void o.resolver.promise.then((function(t){var r=Zv(e,t,n.fov);if(!Object(I.i)(r))return a.resolver.resolve(r);a.resolver.reject()}),(function(e){return a.resolver.reject(e)}))}var s=Bv(e,n.heading,n.tilt,t,r,i);return Zv(e,s,n.fov,a)}function Vv(e,t,r,n,i){return Av(e).directionToHeadingTilt(t,r,n,i)}function Nv(){return(Nv=Object(s.a)(o.a.mark((function e(t,r,n){var i;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.renderCoordsHelper.fromRenderCoords(r,Tv,t.spatialReference)){e.next=2;break}return e.abrupt("return",!1);case 2:return e.next=4,t.elevationProvider.queryElevation(Tv.x,Tv.y,Tv.z,Tv.spatialReference,"ground",n);case 4:return i=e.sent,e.abrupt("return",Object(I.t)(i,0)>Tv.z-1);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Uv(){return(Uv=Object(s.a)(o.a.mark((function e(t,r,n){var i,a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=Object(X.e)(),!r){e.next=13;break}if(!(r instanceof S.a)){e.next=10;break}if(Object($.u)(r,i,t.renderSpatialReference),null!=r.z||null==t.basemapTerrain){e.next=8;break}return e.next=6,t.elevationProvider.queryElevation(r.x,r.y,r.z,r.spatialReference,"ground",n);case 6:return a=e.sent,e.abrupt("return",(Object(I.j)(a)&&t.renderCoordsHelper.setAltitude(i,a),i));case 8:e.next=11;break;case 10:Object(Yl.m)(i,r);case 11:e.next=14;break;case 13:Object(Yl.m)(i,t.state.camera.center);case 14:return e.abrupt("return",i);case 15:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Bv(e,t,r,n,i,a,o){var s=n&&n instanceof S.a?n:null;if(Kv(o))return function(e,t,r){return Uv.apply(this,arguments)}(e,n,o.signal).then((function(n){Gv(e,t,r,s,n,i,a,o)}),(function(e){return o.resolver.reject(e)})),null;var c=function(e,t){var r=Object(X.e)();if(t&&t instanceof S.a){if(Object($.u)(t,r,e.renderSpatialReference),null==t.z&&null!=e.basemapTerrain){var n=Object(Ms.b)(e.elevationProvider,t);Object(I.j)(n)&&e.renderCoordsHelper.setAltitude(r,n)}}else Object(Yl.m)(r,t||e.state.camera.center);return r}(e,n);return Gv(e,t,r,s,c,i,a,o)}function Gv(e,t,r,n,i,a,o,s){if(Object(I.i)(n)){var c=e.renderSpatialReference;if(n=Object($.y)(i,c,Pv(e)),Object(I.i)(n))return null}a=Math.max(a,e.state.constraints.minimumPoiDistance);var l=function(e,t,r,n,i,a){var o=0;return 1===a&&function(e,t,r){var n=e.pointsOfInterest.centerOnSurfaceFrequent.distance;if(Math.log(r/n)/Math.LN2>8)return!0;var i=e.renderSpatialReference,a=Pv(e),o=Object($.y)(t,i,a),s=Object($.y)(e.pointsOfInterest.centerOnSurfaceFrequent.renderLocation,i,a);if(Object(I.i)(o)||Object(I.i)(s))return!1;var c=Math.tan(.5*e.state.camera.fov)*n;return s.distance(o)/c>5}(e,n,i)?(t=0,o=function(e,t,r,n){var i=e.state.constraints.tilt(t);i.max=Math.min(i.max,.5*Math.PI);var a=i.min*(1-Hv)+i.max*Hv,o=Qv(e,n,t,r);return Math.min(o,a)}(e,i,r,n)):o=Qv(e,n,i,r),o=e.state.constraints.clampTilt(i,o),{heading:t,tilt:r=Wv(e,n,i,o)}}(e,t,r,i,a,o),u=(0,Av(e).eyeForCenterWithHeadingTilt)(i,a,l.heading,l.tilt);if(1===o&&"global"===e.viewingMode&&r>0){var d=function(){var c=Wv(e,i,a,function(e,t,r,n){var i=e.state.constraints.tilt(t),a=Qv(e,n,t,r);return a=Math.min(a,.5*Math.PI),i.min*(1-Hv)+a*Hv}(e,a,r,i));return Gv(e,t,c,n,i,a,o=r-c<1?0:1,s)},h=e.map.ground.navigationConstraint;if(!h||"stay-above"===h.type){if(function(e,t){return!!(e.basemapTerrain&&e.renderCoordsHelper.fromRenderCoords(t,Tv,e.spatialReference)&&Object(I.t)(Object(Ms.b)(e.elevationProvider,Tv),0)>Tv.z-1)}(e,u.eye))return d();if(Kv(s))return function(e,t,r){return Nv.apply(this,arguments)}(e,u.eye,s.signal).then((function(e){return e?d():(s.resolver.resolve({eye:u.eye,up:u.up,center:Object(X.c)(i),heading:u.heading,tilt:u.tilt}),null)})),null}}var f=!s||Kv(s)?{center:Object(X.e)(),eye:Object(X.e)(),up:Object(X.e)(),tilt:0,heading:0}:s;return f.eye=u.eye,f.up=u.up,f.center=Object(X.c)(i),f.heading=u.heading,f.tilt=u.tilt,Kv(s)&&s.resolver.resolve(f),f}function qv(e,t,r,n,i){var a,o,s,c,l=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,u=0;if(null!=t.zmax&&null!=t.zmin&&(a=(t.zmax+t.zmin)/2,u=t.zmax-t.zmin),"global"===e.viewingMode){if(!_v(t.spatialReference,"global"))return Kv(l)&&l.resolver.reject(),null;var d=new S.a(t.xmin,t.ymin,t.spatialReference),h=new S.a(t.xmax,t.ymax,t.spatialReference),f=t.spatialReference.isGeographic?Mv:Cv;o=new S.a(f.center(d.x,h.x),(h.y+d.y)/2,t.spatialReference),null!=a&&(o.z=a);var p=Object(J.e)(t.spatialReference),b=md(o,d,h);s=b.lon,c=b.lat,f.diff(d.x,h.x)>f.range/2&&(s+=p.halfCircumference),s=Math.min(s,p.halfCircumference),c=Math.min(c,p.halfCircumference)}else{var v=Pv(e);s=t.xmax-t.xmin,c=t.ymax-t.ymin,o=new S.a({x:t.xmin+.5*s,y:t.ymin+.5*c,z:a,spatialReference:v})}var m=e.state.camera,y=1/Math.tan(m.fovX/2),g=1/Math.tan(m.fovY/2),O=1/Math.tan(m.fov/2),j=Math.max(.5*s*y,.5*c*g,.5*u*O)/1;if(Kv(l)){var _=new Jv(l.signal);return Bv(e,r,n,o,j,i,_),void _.resolver.promise.then((function(t){var r=Zv(e,t,e.camera.fov);if(!Object(I.i)(r))return l.resolver.resolve(r);l.resolver.reject()}),(function(e){return l.resolver.reject(e)}))}var w=Bv(e,r,n,o,j,i);return Zv(e,w,e.camera.fov,l)}var Hv=.7;function Wv(e,t,r,n){return Av(e).lookAtTiltToEyeTilt(n,t,r)}function Qv(e,t,r,n){return Av(e).eyeTiltToLookAtTilt(n,t,r)}function Zv(e,t,r,n){if(Object(I.i)(t))return null;var i=e.renderSpatialReference,a=Object($.y)(t.eye,i,Pv(e));return Object(I.i)(a)?null:Object(I.j)(n)?(n.position=a,n.heading=t.heading,n.tilt=t.tilt,n.fov=r,n):new P(a,t.heading,t.tilt,r)}function Xv(e,t){var r,n=null==(r=e.basemapTerrain)?void 0:r.tilingScheme;if(n)return n.levelAtScale(t);wv.error("#scaleToZoom()","Cannot compute zoom from scale without a tiling scheme")}function Yv(e,t){var r,n=null==(r=e.basemapTerrain)?void 0:r.tilingScheme;if(n)return n.scaleAtLevel(t);wv.error("#zoomToScale()","Cannot compute scale from zoom without a tiling scheme")}function $v(e,t,r){var n,i,a=e.renderSpatialReference;t||(t=e.state.camera);var o=Gs.a.WGS84;return t instanceof P?(n=t.position.latitude,Object($.u)(t.position,xv,a),Object($.u)(r,kv,a),i=Object(Yl.o)(xv,kv)):(Object($.z)(t.center,a,kv,o),n=kv[1],i=t.distance),Fv(e,i,n)}var Jv=function e(t){Object(c.a)(this,e),this.signal=t,this.resolver=Object(q.h)()};function Kv(e){return e&&"resolver"in e}function em(e){var t=e*e;return e<0&&(t*=-1),t}function tm(e,t,r){var n=r,i=e.state,a=e.device,o="forward-down"===t.tiltDirection?1:-1;return"standard"===a.deviceType?(n.translation[0]=em(i.axes[0]),n.translation[1]=em(i.axes[1]),n.translation[2]=em(i.buttons[7])-em(i.buttons[6]),n.heading=em(i.axes[2]),n.tilt=em(i.axes[3])):"spacemouse"===a.deviceType&&(n.translation[0]=1.2*em(i.axes[0]),n.translation[1]=1.2*em(i.axes[1]),n.translation[2]=2*-em(i.axes[2]),n.heading=1.2*em(i.axes[5]),n.tilt=1.2*em(i.axes[3])),n.tilt*=o,Object(Yl.g)(n.translation,n.translation,1),n}function rm(e,t){var r=t;return r.translation[0]=e[1]-e[0],r.translation[1]=e[3]-e[2],r.translation[2]=e[4]-e[5],r.heading=e[7]-e[6],r.tilt=e[8]-e[9],r.zoom=e[10]-e[11],r}function nm(e){return 0===e.translation[0]&&0===e.translation[1]&&0===e.translation[2]&&0===e.heading&&0===e.tilt&&0===e.zoom}var im=function(e){Object(f.a)(r,e);var t=Object(p.a)(r);function r(e){var n;return Object(c.a)(this,r),(n=t.call(this,e)).transformation={translation:[0,0,0],heading:0,tilt:0,zoom:0},n.keysButtonState=[0,0,0,0,0,0,0,0,0,0,0,0],n.tmpCamera=new zf.a,n.constraintOptions={selection:15,interactionType:0,interactionStartCamera:new zf.a,interactionFactor:0,interactionDirection:null,tiltMode:1},n}return Object(l.a)(r,[{key:"handleEventGamepad",value:function(e){var t=tm(e,this.view.navigation.gamepad,this.transformation);("end"===e.action||nm(t))&&this.finishController()}},{key:"activateDirection",value:function(e){this.keysButtonState[e]=1,rm(this.keysButtonState,this.transformation)}},{key:"deactivateDirection",value:function(e){this.keysButtonState[e]=0,nm(rm(this.keysButtonState,this.transformation))&&this.finishController()}},{key:"onControllerStart",value:function(e){this.filteredSurfaceElevation=this.view.pointsOfInterest.cameraOnSurface.location.z,this.headingStart=this.view.camera.heading,Object(d.a)(Object(h.a)(r.prototype),"onControllerStart",this).call(this,e)}},{key:"updateFilteredSurfaceElevation",value:function(e){var t=this.view.pointsOfInterest.cameraOnSurface.location.z;this.filteredSurfaceElevation+=1*(t-this.filteredSurfaceElevation)*e}},{key:"stepController",value:function(e,t){this.updateStartHeading(),this.updateFilteredSurfaceElevation(e),this.currentCamera.copyViewFrom(t),this.updateCameraCenter(),this.constraintOptions.interactionStartCamera.copyFrom(this.currentCamera),this.calculateControlTransformation(e,this.currentCamera,hm),this.applyDisabledMovementTypes(hm),this.applyPan(hm.pan),this.applyRotate(hm.rotate),this.applyZoom(hm.zoom),this.applyAscend(hm.ascend),this.constraintOptions.interactionType=0,this.constraintOptions.selection=8,jf(this.view,this.currentCamera,this.constraintOptions),Object(d.a)(Object(h.a)(r.prototype),"stepController",this).call(this,e,t)}},{key:"updateStartHeading",value:function(){0!==this.transformation.heading&&(this.headingStart=this.view.camera.heading)}},{key:"applyRotate",value:function(e){if(e.enabled){var t=this.currentCamera;Object(Yl.l)(fm,t.center,t.eye),Object(Yl.s)(fm,fm,e.matrix),t.center=Object(Yl.h)(fm,fm,t.eye),t.up=Object(Yl.s)(fm,t.up,e.matrix),this.constraintOptions.interactionType=3,this.constraintOptions.selection=7,jf(this.view,t,this.constraintOptions)}}},{key:"applyPan",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.currentCamera;e.enabled&&(t.eye=Object(Yl.s)(fm,t.eye,e.matrix),t.center=Object(Yl.s)(fm,t.center,e.matrix),this.view.state.isGlobal&&(t.up=Object(Yl.s)(fm,t.up,e.matrix)),this.constraintOptions.interactionType=4,this.constraintOptions.selection=15,jf(this.view,t,this.constraintOptions))}},{key:"applyZoom",value:function(e){if(e){var t=this.currentCamera.viewForward;this.currentCamera.eye=Object(Yl.h)(fm,this.currentCamera.eye,Object(Yl.g)(yp.c.get(),t,e)),Object(Yl.m)(pm,t),Object(Yl.u)(pm,pm),this.constraintOptions.interactionDirection=pm,this.constraintOptions.interactionType=1,this.constraintOptions.selection=7,jf(this.view,this.currentCamera,this.constraintOptions),this.constraintOptions.interactionDirection=null}}},{key:"applyAscend",value:function(e){if(e){var t=this.view.renderCoordsHelper.worldUpAtPosition(this.currentCamera.eye,yp.c.get());if(this.constraintOptions.interactionDirection=Object(Yl.m)(pm,t),this.view.state.isGlobal){var r=Object(Yl.r)(this.currentCamera.eye),n=(r+e)/r;this.currentCamera.eye=Object(Yl.g)(fm,this.currentCamera.eye,n),this.currentCamera.center=Object(Yl.g)(fm,this.currentCamera.center,n)}else{var i=Object(Yl.g)(yp.c.get(),t,e);this.currentCamera.eye=Object(Yl.h)(fm,this.currentCamera.eye,i),this.currentCamera.center=Object(Yl.h)(fm,this.currentCamera.center,i)}this.updateCameraCenter(),this.constraintOptions.interactionType=5,this.constraintOptions.selection=8,jf(this.view,this.currentCamera,this.constraintOptions)&&this.updateCameraCenter(),this.constraintOptions.selection=7,jf(this.view,this.currentCamera,this.constraintOptions),this.constraintOptions.interactionDirection=null}}},{key:"calculateControlTransformation",value:function(e,t,r){!function(e){e.zoom=0,e.ascend=0,e.pan.enabled=!1,Object(Jl.i)(e.pan.matrix),e.rotate.enabled=!1,Object(Jl.i)(e.rotate.matrix)}(r);var n=this.computeVelocities(e);this.view.state.isLocal?this.calculateControlTransformationLocal(n,t,r):this.calculateControlTransformationGlobal(n,t,r)}},{key:"updateCameraCenter",value:function(){var e=this.view.pointsOfInterest.centerOnSurfaceFrequent.estimatedSurfaceAltitude,t=this.view.renderCoordsHelper,r=this.currentCamera.ray;this.currentCamera.center=t.intersectManifoldClosestSilhouette(r,e,fm)}},{key:"calculateControlTransformationLocal",value:function(e,t,r){var n=t.viewRight,i=t.viewForward,a=this.transformation,o=this.view.navigation.gamepad,s=Object(Yl.y)(yp.c.get(),i[0],i[1],0);Object(Yl.t)(s,s);var c=a.translation[0]*e.pan;if(0!==c){var l=Object(Yl.g)(yp.c.get(),n,c);Object(Jl.t)(r.pan.matrix,r.pan.matrix,l),r.pan.enabled=!0}switch(o.mode){case"pan":var u=-a.translation[1]*e.pan;if(0!==u){var d=Object(Yl.g)(yp.c.get(),s,u);Object(Jl.t)(r.pan.matrix,r.pan.matrix,d),r.pan.enabled=!0}r.zoom=a.zoom*e.zoom;break;case"zoom":r.zoom=(-a.translation[1]+a.zoom)*e.zoom;break;default:Object(Sh.a)(o.mode)}var h=a.translation[2]*e.ascend;r.ascend=h;var f=-a.heading*e.rotate;0!==f&&(Object(Jl.c)(r.rotate.matrix,r.rotate.matrix,f,this.view.renderCoordsHelper.worldUpAtPosition(t.eye,yp.c.get())),r.rotate.enabled=!0);var p=a.tilt*e.rotate,b=Th(this.view.renderCoordsHelper,t.center,t.eye),v=Object(m.e)(b+p,sl.min,sl.max)-b;v&&(Object(Jl.c)(r.rotate.matrix,r.rotate.matrix,v,n),r.rotate.enabled=!0)}},{key:"calculateControlTransformationGlobal",value:function(e,t,r){var n=t.eye,i=t.viewRight,a=this.transformation,o=this.view.navigation.gamepad,s=Object(Yl.i)(yp.c.get(),i,n);Object(Yl.t)(s,s),Object(Yl.u)(s,s),bb(this.startCamera,t,a,e,this.view.camera.heading,this.headingStart,this.view.camera.tilt,r,o),this.tmpCamera.copyFrom(this.currentCamera),this.applyPan(hm.pan,this.tmpCamera);var c=this.view.pointsOfInterest.centerOnSurfaceFrequent.estimatedSurfaceAltitude,l=a.translation[2]*e.ascend;r.ascend=l;var u=-a.heading*e.rotate;0!==u&&(Object(Jl.c)(r.rotate.matrix,r.rotate.matrix,u,this.tmpCamera.eye),r.rotate.enabled=!0);var d=a.tilt*e.rotate,h=this.clampTiltDeltaGlobalToValidRange(d,t.ray,c);0!==h&&(Object(Jl.c)(r.rotate.matrix,r.rotate.matrix,h,this.tmpCamera.viewRight),r.rotate.enabled=!0),r.zoom+=a.zoom*e.zoom}},{key:"clampTiltDeltaGlobalToValidRange",value:function(e,t,r){var n=Object(J.e)(this.view.spatialReference),i=Wp(sl.min,t.origin,r,n),a=0,o=0,s=yp.c.get();this.view.renderCoordsHelper.intersectManifold(t,r,s)?(a=Wp(Th(this.view.renderCoordsHelper,s,t.origin),t.origin,r,n),o=Wp(sl.max,t.origin,r,n)):(Object(Nd.b)(Object(Nd.e)(r+n.radius),t,s),a=Qp(Object(m.b)(-Object(Yl.j)(t.direction,Object(Yl.t)(s,s))),t.origin,r,n),o=Qp(sl.max,t.origin,r,n));return Object(m.e)(a+e,i,o)-a}},{key:"getPointAbsoluteSurfaceElevation",value:function(e,t,r){var n=this.view.renderCoordsHelper,i=n.getAltitude(e),a=t+Math.abs(i-t);return n.setAltitude(r,a,e),a}},{key:"clampedDistanceToSurface",value:function(e,t){var r=this.view.renderCoordsHelper,n=this.view.state.camera,i=function(e,t,r,n,i){return Av(e).headingTiltToDirectionUp(t,r,n,i)}(this.view,t,0,om,bm).direction,a=r.intersectManifoldClosestSilhouette(Object(Ud.g)(t,i),e,yp.c.get()),o=Object(Yl.o)(t,a),s=r.intersectManifoldClosestSilhouette(Object(Ud.g)(t,Object(Yl.x)(yp.c.get(),t,n.center)),e,yp.c.get()),c=Object(Yl.o)(t,s);return Math.min(o,c)}},{key:"computeHeadingRotateRadius",value:function(e){var t=this.view,r=t.renderCoordsHelper,n=t.state,i=n.camera,a=n.isGlobal,o=r.intersectManifoldClosestSilhouette(i.ray,this.filteredSurfaceElevation,yp.c.get());if(a){var s=Object(Yl.l)(yp.c.get(),e,o),c=Object(Yl.r)(s);Object(Yl.g)(s,s,1/c);var l=Object(Yl.t)(yp.c.get(),e),u=Object(m.b)(Object(Yl.j)(l,s));return c*Math.sin(Math.min(sm,u))}var d=Object(Yl.m)(yp.c.get(),e);return r.setAltitude(d,this.filteredSurfaceElevation),Object(Yl.o)(o,d)}},{key:"minimumAscendVelocity",value:function(){return this.view.state.constraints.collision.enabled?0:lm}},{key:"computeVelocities",value:function(e){var t=this.filteredSurfaceElevation,r=t+Object(J.e)(this.view.spatialReference).radius,n=this.view.state,i=n.camera,a=n.isGlobal,o=yp.c.get(),s=this.getPointAbsoluteSurfaceElevation(i.eye,t,o),c=this.clampedDistanceToSurface(t,o),l=i.width/2,u=cm*i.width,d=cm*i.width,h=c*Math.tan(.5*i.fovX)/l,f=h/r,p=h/this.computeHeadingRotateRadius(o),b=s-t;return{pan:(a?f:h)*u*e,ascend:Math.max(this.minimumAscendVelocity()*e,Math.pow(2,u*e/l)*b-b),zoom:Math.pow(2,u*e/l)*c-c,rotate:Object(m.e)(p*d,um,dm)*e}}},{key:"applyDisabledMovementTypes",value:function(e){!Object(I.j)(this.disableMovements)||void 0!==this.disableMovements.mode&&this.view.state.viewingMode!==this.disableMovements.mode||(e.zoom=this.disableMovements.zoom?0:e.zoom,e.ascend=this.disableMovements.ascend?0:e.ascend,e.pan.enabled=!this.disableMovements.pan,this.disableMovements.pan&&Object(Jl.i)(e.pan.matrix),e.rotate.enabled=!this.disableMovements.rotate,this.disableMovements.rotate&&Object(Jl.i)(e.rotate.matrix))}}],[{key:"activatesFor",value:function(e,t){var r=tm(t,e.navigation.gamepad,am);return!("end"===t.action||nm(r))}}]),r}(qb);Object(b.a)([Object(y.b)({constructOnly:!0})],im.prototype,"view",void 0),Object(b.a)([Object(y.b)({constructOnly:!0})],im.prototype,"gamepadDevice",void 0),Object(b.a)([Object(y.b)({constructOnly:!0})],im.prototype,"disableMovements",void 0),im=Object(b.a)([Object(w.a)("esri.views.3d.state.controllers.GamepadKeyboardController")],im);var am={translation:[0,0,0],heading:0,tilt:0,zoom:0},om=80,sm=Object(m.g)(om),cm=.75,lm=5,um=Object(m.g)(30),dm=Object(m.g)(80),hm={zoom:0,ascend:0,pan:{enabled:!1,matrix:Object(Kl.d)()},rotate:{enabled:!1,matrix:Object(Kl.d)()}},fm=Object(X.e)(),pm=Object(X.e)(),bm=tv();var vm=function(e){Object(f.a)(r,e);var t=Object(p.a)(r);function r(e){var n;return Object(c.a)(this,r),(n=t.call(this,!0)).view=e,n.watchHandles=new oe.a,n.handle=n.registerIncoming("gamepad",(function(e){return n.handleEventGamepad(e)})),n.handle.pause(),n}return Object(l.a)(r,[{key:"onInstall",value:function(e){var t=this;Object(d.a)(Object(h.a)(r.prototype),"onInstall",this).call(this,e),this.watchHandles.add([Object(W.a)(this.view.navigation.gamepad,"enabled",(function(e){e?t.handle.resume():(t.handle.pause(),t.cameraControllerGamepad&&(t.cameraControllerGamepad.finishController(),t.cameraControllerGamepad=null))})),this.view.navigation.gamepad.watch("device",(function(e){t.cameraControllerGamepad&&e&&t.cameraControllerGamepad.gamepadDevice!==e&&(t.cameraControllerGamepad.finishController(),t.cameraControllerGamepad=null)}))])}},{key:"onUninstall",value:function(){this.watchHandles.removeAll(),Object(d.a)(Object(h.a)(r.prototype),"onUninstall",this).call(this)}},{key:"handleEventGamepad",value:function(e){var t=this.view.navigation.gamepad.device;if(!t||e.data.device===t){var r=this.cameraControllerGamepad&&this.cameraControllerGamepad.active;if(r||im.activatesFor(this.view,e.data)){if(!r){var n=new im({view:this.view,gamepadDevice:e.data.device});this.view.state.switchCameraController(n)&&(this.cameraControllerGamepad=n)}this.cameraControllerGamepad&&this.cameraControllerGamepad.active&&this.cameraControllerGamepad.gamepadDevice===e.data.device&&this.cameraControllerGamepad.handleEventGamepad(e.data)}}}}]),r}(sa),mm=function(e){Object(f.a)(r,e);var t=Object(p.a)(r);function r(e,n){var i,a;return Object(c.a)(this,r),(a=t.call(this,!0)).view=e,a.disableMovements={pan:!0,zoom:!1,ascend:!0,rotate:!1,mode:2},a.keyToNumber=(i={},Object(ve.a)(i,n.left,0),Object(ve.a)(i,n.right,1),Object(ve.a)(i,n.forward,2),Object(ve.a)(i,n.backward,3),Object(ve.a)(i,n.up,4),Object(ve.a)(i,n.down,5),Object(ve.a)(i,n.headingLeft,6),Object(ve.a)(i,n.headingRight,7),Object(ve.a)(i,n.tiltUp,8),Object(ve.a)(i,n.tiltDown,9),Object(ve.a)(i,n.zoomIn,10),Object(ve.a)(i,n.zoomOut,11),i),a.registerIncoming("key-down",null,(function(e){return a.handleKeyDown(e)})),a.registerIncoming("key-up",null,(function(e){return a.handleKeyUp(e)})),a.registerIncoming("blur",null,(function(){return a.handleBlur()})),a}return Object(l.a)(r,[{key:"handleKeyDown",value:function(e){if(!e.data.native.ctrlKey&&!e.data.native.metaKey){var t=this.keyToNumber[e.data.key];null!=t&&(this.cameraControllerKeyboard&&this.cameraControllerKeyboard.active||(this.cameraControllerKeyboard=new im({view:this.view,disableMovements:this.disableMovements}),this.view.state.switchCameraController(this.cameraControllerKeyboard)),this.cameraControllerKeyboard.active&&(this.cameraControllerKeyboard.activateDirection(t),e.stopPropagation()))}}},{key:"handleBlur",value:function(){this.cameraControllerKeyboard&&this.cameraControllerKeyboard.active&&(this.cameraControllerKeyboard.finishController(),this.cameraControllerKeyboard=null)}},{key:"handleKeyUp",value:function(e){if(!e.data.native.ctrlKey&&!e.data.native.metaKey){var t=this.keyToNumber[e.data.key];null!=t&&this.cameraControllerKeyboard&&this.cameraControllerKeyboard.active&&(this.cameraControllerKeyboard.deactivateDirection(t),e.stopPropagation())}}}]),r}(sa),ym=function(e){Object(f.a)(r,e);var t=Object(p.a)(r);function r(e,n){var i;return Object(c.a)(this,r),(i=t.call(this,!0)).view=e,i.registerIncoming("mouse-wheel",n,(function(e){return i.handleMouseWheel(e)})),i}return Object(l.a)(r,[{key:"handleMouseWheel",value:function(e){if(this.view.navigation.mouseWheelZoomEnabled){var t=e.data;this.cameraController&&this.cameraController.active||(this.cameraController=this.view.state.isGlobal?new Lb({view:this.view,mode:"interaction"}):new Nb({view:this.view,mode:"interaction"}),this.view.state.switchCameraController(this.cameraController)),this.cameraController.zoomStep(-1/60*t.deltaY,Object(Z.f)(t.x,t.y)),e.preventDefault(),e.stopPropagation()}}}]),r}(sa),gm=function(){function e(t){Object(c.a)(this,e),this._gain=t}return Object(l.a)(e,[{key:"reset",value:function(e){this._value=e}},{key:"gain",set:function(e){this._gain=e}},{key:"value",get:function(){return void 0===this._value?0:this._value}},{key:"update",value:function(e){void 0===this._value?this._value=e:this._value=this._gain*e+(1-this._gain)*this._value}}]),e}(),Om=function(e){Object(f.a)(r,e);var t=Object(p.a)(r);function r(e){var n;return Object(c.a)(this,r),(n=t.call(this,e)).view=null,n.beginCamera=new zf.a,n.elapsedTimeSec=0,n.constraintOptions={selection:15,interactionType:4,interactionFactor:0,interactionStartCamera:new zf.a,interactionDirection:null,tiltMode:0},n}return Object(l.a)(r,[{key:"initialize",value:function(){this.constraintOptions.interactionType=this.interactionType,this.viewAnimation=new Xc}},{key:"steppingFinished",get:function(){return this.momentum.isFinished(this.elapsedTimeSec)}},{key:"onControllerStart",value:function(e){this.beginCamera.copyFrom(e),this.constraintOptions.interactionStartCamera=this.beginCamera,Object(d.a)(Object(h.a)(r.prototype),"onControllerStart",this).call(this,e)}},{key:"stepController",value:function(e,t){t.copyViewFrom(this.beginCamera),this.elapsedTimeSec+=e,this.momentumStep(this.elapsedTimeSec,t),jf(this.view,t,this.constraintOptions)}}]),r}(dp);Object(b.a)([Object(y.b)({constructOnly:!0})],Om.prototype,"view",void 0);var jm=function(e){Object(f.a)(r,e);var t=Object(p.a)(r);function r(e){var n;return Object(c.a)(this,r),(n=t.call(this,e)).interactionType=4,n.tmpPan=Object(X.e)(),n}return Object(l.a)(r,[{key:"momentumStep",value:function(e,t){var r=this.momentum.value(e);Object(Yl.g)(this.tmpPan,this.momentum.direction,r),t.eye=Object(Yl.l)(_m,t.eye,this.tmpPan),t.center=Object(Yl.l)(_m,t.center,this.tmpPan),this.constraintOptions.interactionDirection=this.tmpPan}}]),r}(Om=Object(b.a)([Object(w.a)("esri.views.3d.state.controllers.momentum.MomentumController")],Om));Object(b.a)([Object(y.b)({constructOnly:!0})],jm.prototype,"momentum",void 0),jm=Object(b.a)([Object(w.a)("esri.views.3d.state.controllers.momentum.PanPlanarMomentumController")],jm);var _m=Object(X.e)(),wm=Object(X.e)(),xm=Object(X.e)(),km=function(e){Object(f.a)(r,e);var t=Object(p.a)(r);function r(e){var n;return Object(c.a)(this,r),(n=t.call(this,e)).interactionType=4,n}return Object(l.a)(r,[{key:"momentumStep",value:function(e,t){var r=this.momentum.value1(e),n=this.momentum.value2(e);Object(Yl.m)(xm,t.eye),Object(Yl.t)(xm,xm),Object(Yl.i)(this.momentum.axis2,xm,this.momentum.axis1),db(t,wm,this.momentum.axis1,r,this.momentum.axis2,n)}}]),r}(Om);Object(b.a)([Object(y.b)({constructOnly:!0})],km.prototype,"momentum",void 0),km=Object(b.a)([Object(w.a)("esri.views.3d.state.controllers.momentum.PanSphericalMomentumController")],km);var Sm=function(e){Object(f.a)(r,e);var t=Object(p.a)(r);function r(e){var n;return Object(c.a)(this,r),(n=t.call(this,e)).interactionType=2,n}return Object(l.a)(r,[{key:"center",set:function(e){this._set("center",Object(X.c)(e))}},{key:"axis",set:function(e){this._set("axis",Object(X.c)(e))}},{key:"momentumStep",value:function(e,t){var r=this.momentum.value(e);Vp(t,this.center,Op(this.axis,r))}}]),r}(Om);Object(b.a)([Object(y.b)({constructOnly:!0})],Sm.prototype,"momentum",void 0),Object(b.a)([Object(y.b)({constructOnly:!0})],Sm.prototype,"center",null),Object(b.a)([Object(y.b)({constructOnly:!0})],Sm.prototype,"axis",null),Sm=Object(b.a)([Object(w.a)("esri.views.3d.state.controllers.momentum.MomentumController")],Sm);var Tm=function(e){Object(f.a)(r,e);var t=Object(p.a)(r);function r(e){var n;return Object(c.a)(this,r),(n=t.call(this,e)).interactionType=1,n.constraintOptions.interactionDirection=Object(X.e)(),n}return Object(l.a)(r,[{key:"zoomCenter",set:function(e){this._set("zoomCenter",Object(X.c)(e))}},{key:"momentumStep",value:function(e,t){Object(Yl.m)(this.constraintOptions.interactionDirection,t.eye);var r=this.momentum.valueDelta(0,e);Up(t,this.zoomCenter,r,this.view.state.constraints.minimumPoiDistance),this.constraintOptions.interactionDirection=Object(Yl.x)(this.constraintOptions.interactionDirection,t.eye,this.constraintOptions.interactionDirection)}}]),r}(Om);Object(b.a)([Object(y.b)({constructOnly:!0})],Tm.prototype,"momentum",void 0),Object(b.a)([Object(y.b)({constructOnly:!0})],Tm.prototype,"zoomCenter",null),Tm=Object(b.a)([Object(w.a)("esri.views.3d.state.controllers.momentum.ZoomPlanarMomentumController")],Tm);var Cm=function(e){Object(f.a)(r,e);var t=Object(p.a)(r);function r(e){var n;return Object(c.a)(this,r),(n=t.call(this,e)).interactionType=1,n.radius=0,n.tmpSceneCenter=Object(X.e)(),n.tmpZoomAxisAngle=gp(),n.sphere=Object(Nd.c)(),n}return Object(l.a)(r,[{key:"screenCenter",set:function(e){this._set("screenCenter",Object(Z.f)(e[0],e[1]))}},{key:"sceneCenter",set:function(e){this._set("sceneCenter",Object(X.c)(e))}},{key:"initialize",value:function(){this.sphere[3]=this.radius}},{key:"momentumStep",value:function(e,t){var r=this.momentum.valueDelta(0,e);Bp(this.sphere,t,r),this.constraintOptions.interactionType=1,jf(this.view,t,this.constraintOptions),rb(this.sphere,t,this.screenCenter,this.tmpSceneCenter),_p(this.sceneCenter,this.tmpSceneCenter,this.tmpZoomAxisAngle),Vp(t,this.sphere,this.tmpZoomAxisAngle),this.constraintOptions.interactionType=4}}]),r}(Om);Object(b.a)([Object(y.b)({constructOnly:!0})],Cm.prototype,"momentum",void 0),Object(b.a)([Object(y.b)({constructOnly:!0})],Cm.prototype,"screenCenter",null),Object(b.a)([Object(y.b)({constructOnly:!0})],Cm.prototype,"sceneCenter",null),Object(b.a)([Object(y.b)({constructOnly:!0})],Cm.prototype,"radius",void 0),Cm=Object(b.a)([Object(w.a)("esri.views.3d.state.controllers.momentum.ZoomSphericalMomentumController")],Cm);var Mm=function(){function e(t){Object(c.a)(this,e),this.gain=t}return Object(l.a)(e,[{key:"update",value:function(e){if(this.hasLastValue){var t=this.computeDelta(e);this.updateDelta(t)}this.lastValue=e}},{key:"reset",value:function(){this.lastValue=void 0,this.filteredDelta=void 0}},{key:"hasLastValue",get:function(){return void 0!==this.lastValue}},{key:"hasFilteredDelta",get:function(){return void 0!==this.filteredDelta}},{key:"computeDelta",value:function(e){return e-this.lastValue}},{key:"updateDelta",value:function(e){this.hasFilteredDelta?this.filteredDelta=(1-this.gain)*this.filteredDelta+this.gain*e:this.filteredDelta=e}}]),e}(),Pm=function(){function e(t,r,n){Object(c.a)(this,e),this._initialVelocity=t,this._stopVelocity=r,this._friction=n,this._duration=Math.abs(Math.log(Math.abs(this._initialVelocity)/this._stopVelocity)/Math.log(1-this._friction))}return Object(l.a)(e,[{key:"duration",get:function(){return this._duration}},{key:"isFinished",value:function(e){return e>this.duration}},{key:"friction",get:function(){return this._friction}},{key:"value",value:function(e){return this.valueFromInitialVelocity(this._initialVelocity,e)}},{key:"valueDelta",value:function(e,t){var r=this.value(e);return this.value(e+t)-r}},{key:"valueFromInitialVelocity",value:function(e,t){t=Math.min(t,this.duration);var r=1-this.friction;return e*(Math.pow(r,t)-1)/Math.log(r)}}]),e}(),Am=function(e){Object(f.a)(r,e);var t=Object(p.a)(r);function r(e,n,i,a,o){var s;return Object(c.a)(this,r),(s=t.call(this,e,n,i)).sceneVelocity=a,s.direction=o,s}return Object(l.a)(r,[{key:"value",value:function(e){return Object(d.a)(Object(h.a)(r.prototype),"valueFromInitialVelocity",this).call(this,this.sceneVelocity,e)}}]),r}(Pm),Em=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:300,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:12,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.84;Object(c.a)(this,e),this.minimumInitialVelocity=t,this.stopVelocity=r,this.friction=n,this.enabled=!0,this.time=new Mm(.6),this.screen=[new Mm(.4),new Mm(.4)],this.scene=[new Mm(.6),new Mm(.6),new Mm(.6)],this.tmpDirection=Object(X.e)()}return Object(l.a)(e,[{key:"add",value:function(e,t,r){if(this.enabled){if(this.time.hasLastValue&&this.time.computeDelta(r)<.015)return;this.screen[0].update(e[0]),this.screen[1].update(e[1]),this.scene[0].update(t[0]),this.scene[1].update(t[1]),this.scene[2].update(t[2]),this.time.update(r)}}},{key:"reset",value:function(){this.screen[0].reset(),this.screen[1].reset(),this.scene[0].reset(),this.scene[1].reset(),this.scene[2].reset(),this.time.reset()}},{key:"evaluateMomentum",value:function(){if(!this.enabled||!this.screen[0].hasFilteredDelta)return null;var e=this.screen[0].filteredDelta,t=this.screen[1].filteredDelta,r=Math.sqrt(e*e+t*t)/this.time.filteredDelta;return Math.abs(r)<this.minimumInitialVelocity?null:this.createMomentum(r,this.stopVelocity,this.friction)}},{key:"createMomentum",value:function(e,t,r){Object(Yl.y)(this.tmpDirection,this.scene[0].filteredDelta,this.scene[1].filteredDelta,this.scene[2].filteredDelta);var n=Object(Yl.r)(this.tmpDirection);n>0&&Object(Yl.g)(this.tmpDirection,this.tmpDirection,1/n);var i=n/this.time.filteredDelta;return new Am(e,t,r,i,this.tmpDirection)}}]),e}(),Rm=function(){function e(t){Object(c.a)(this,e),this.gain=t}return Object(l.a)(e,[{key:"update",value:function(e){this.hasFilteredValue?this.filteredValue=(1-this.gain)*this.filteredValue+this.gain*e:this.filteredValue=e}},{key:"reset",value:function(){this.filteredValue=void 0}},{key:"hasFilteredValue",get:function(){return void 0!==this.filteredValue}}]),e}(),Im=1e-5,Dm=function(e){Object(f.a)(r,e);var t=Object(p.a)(r);function r(e,n,i,a,o){var s,l=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,u=arguments.length>6?arguments[6]:void 0;return Object(c.a)(this,r),(s=t.call(this,e,n,i)).angularVelocity1=a,s.axis1=o,s.angularVelocity2=l,s.axis2=u,s}return Object(l.a)(r,[{key:"value1",value:function(e){return Object(d.a)(Object(h.a)(r.prototype),"valueFromInitialVelocity",this).call(this,this.angularVelocity1,e)}},{key:"value2",value:function(e){return Object(d.a)(Object(h.a)(r.prototype),"valueFromInitialVelocity",this).call(this,this.angularVelocity2,e)}}]),r}(Pm),Fm=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:300,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:12,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.84;Object(c.a)(this,e),this.minimumInitialVelocity=t,this.stopVelocity=r,this.friction=n,this.enabled=!0,this.tmpAxis1=Object(X.e)(),this.tmpAxis2=Object(X.e)(),this.tmpAngles=Object(ku.b)(),this.time=new Mm(.3),this.screen=[new Mm(.4),new Mm(.4)],this.angle1=new Rm(.6),this.angle2=new Rm(.6),this.axis1=Object(X.e)(),this.axis2=Object(X.e)(),this.lastScene=Object(X.e)()}return Object(l.a)(e,[{key:"addMomentumDirectRotation",value:function(e,t,r,n,i,a){if(this.enabled){if(this.time.hasLastValue){if(this.time.computeDelta(r)<.01)return;var o=ob(this.lastScene,t,this.tmpAxis2,n,i,a);this.angle2.update(0),Object(Yl.v)(this.tmpAxis2)<Im?o=0:Object(Yl.t)(this.axis1,this.tmpAxis2),this.angle1.update(o),Object(Yl.m)(this.lastScene,t)}this.screen[0].update(e[0]),this.screen[1].update(e[1]),this.time.update(r)}}},{key:"addMomentumPreserveHeading",value:function(e,t,r,n,i,a,o){if(this.enabled){if(this.time.hasLastValue){if(this.time.computeDelta(r)<.01)return;lb(this.lastScene,t,this.tmpAxis2,this.tmpAxis1,this.tmpAngles,n,i,a,o,!1),Object(Yl.v)(this.tmpAxis2)<Im?(this.angle1.update(0),this.angle2.update(0)):(this.angle1.update(this.tmpAngles[1]),this.angle2.update(this.tmpAngles[0]),Object(Yl.t)(this.axis1,this.tmpAxis1),Object(Yl.t)(this.axis2,this.tmpAxis2)),Object(Yl.m)(this.lastScene,t)}this.screen[0].update(e[0]),this.screen[1].update(e[1]),this.time.update(r)}}},{key:"reset",value:function(){this.screen[0].reset(),this.screen[1].reset(),this.angle1.reset(),this.angle2.reset(),this.time.reset()}},{key:"evaluateMomentum",value:function(){if(!this.enabled||!this.screen[0].hasFilteredDelta)return null;var e=this.screen[0].filteredDelta,t=this.screen[1].filteredDelta,r=Math.sqrt(e*e+t*t)/this.time.filteredDelta;return Math.abs(r)<this.minimumInitialVelocity?null:this.createMomentum(r,this.stopVelocity,this.friction)}},{key:"createMomentum",value:function(e,t,r){var n=this.angle1.filteredValue/this.time.filteredDelta,i=this.angle2.filteredValue/this.time.filteredDelta;return new Dm(e,t,r,n,this.axis1,i,this.axis2)}}]),e}(),Lm=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:2.5,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.01,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.95,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:12;Object(c.a)(this,e),this.minimumInitialVelocity=t,this.stopVelocity=r,this.friction=n,this.maxVelocity=i,this.enabled=!0,this.value=new Mm(.8),this.time=new Mm(.3)}return Object(l.a)(e,[{key:"add",value:function(e,t){if(this.enabled){if(this.time.hasLastValue){if(this.time.computeDelta(t)<.01)return;if(this.value.hasFilteredDelta){var r=this.value.computeDelta(e);this.value.filteredDelta*r<0&&this.value.reset()}}this.time.update(t),this.value.update(e)}}},{key:"reset",value:function(){this.value.reset(),this.time.reset()}},{key:"evaluateMomentum",value:function(){if(!this.enabled||!this.value.hasFilteredDelta)return null;var e=this.value.filteredDelta/this.time.filteredDelta;return e=Object(m.e)(e,-this.maxVelocity,this.maxVelocity),Math.abs(e)<this.minimumInitialVelocity?null:this.createMomentum(e,this.stopVelocity,this.friction)}},{key:"createMomentum",value:function(e,t,r){return new Pm(e,t,r)}}]),e}(),zm=function(e){Object(f.a)(r,e);var t=Object(p.a)(r);function r(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:3,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.01,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.95,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:12;return Object(c.a)(this,r),t.call(this,e,n,i,a)}return Object(l.a)(r,[{key:"add",value:function(e,t){if(this.value.hasLastValue){for(var n=this.value.lastValue,i=e-n;i>Math.PI;)i-=2*Math.PI;for(;i<-Math.PI;)i+=2*Math.PI;e=n+i}Object(d.a)(Object(h.a)(r.prototype),"add",this).call(this,e,t)}}]),r}(Lm),Vm=function(e){Object(f.a)(r,e);var t=Object(p.a)(r);function r(e,n,i){return Object(c.a)(this,r),t.call(this,e,n,i)}return Object(l.a)(r,[{key:"value",value:function(e){var t=Object(d.a)(Object(h.a)(r.prototype),"value",this).call(this,e);return Math.exp(t)}},{key:"valueDelta",value:function(e,t){var n=Object(d.a)(Object(h.a)(r.prototype),"value",this).call(this,e),i=Object(d.a)(Object(h.a)(r.prototype),"value",this).call(this,e+t)-n;return Math.exp(i)}}]),r}(Pm),Nm=function(e){Object(f.a)(r,e);var t=Object(p.a)(r);function r(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:2.5,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.01,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.95,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:12;return Object(c.a)(this,r),t.call(this,e,n,i,a)}return Object(l.a)(r,[{key:"add",value:function(e,t){Object(d.a)(Object(h.a)(r.prototype),"add",this).call(this,Math.log(e),t)}},{key:"createMomentum",value:function(e,t,r){return new Vm(e,t,r)}}]),r}(Lm),Um=function(e){Object(f.a)(r,e);var t=Object(p.a)(r);function r(e){var n;return Object(c.a)(this,r),(n=t.call(this,e)).view=null,n.smoothRotation=new gm(.05),n.rotationAxis=Object(X.e)(),n.panningPlane=Object(Rp.d)(),n.smoothScaling=new gm(.05),n.zoomCenterScreen=Object(Z.f)(),n.zoomMomentumEstimator=new Nm,n.rotationMomentumEstimator=new zm,n.panSphericalMomentumEstimator=new Fm,n.panPlanarMomentumEstimator=new Em,n.adjustedSphere=Object(Nd.c)(),n.tmp3d=Object(X.e)(),n.tmpScreenPointArray=Object(Z.f)(),n.beginScreenPoint=Object(Z.f)(),n.beginScenePoint=Object(X.e)(),n.screenPickPoint=Object(Z.f)(),n.navMode=Gp.Horizontal,n.tmpInteractionDirection=Object(X.e)(),n.constraintOptions={selection:15,interactionType:0,interactionFactor:0,interactionStartCamera:new zf.a,interactionDirection:null,tiltMode:0},n}return Object(l.a)(r,[{key:"intersectionHelper",get:function(){return this.view.sceneIntersectionHelper}},{key:"begin",value:function(e){if(this.active){var t=this.view.navigation.momentumEnabled;this.zoomMomentumEstimator.enabled=t,this.rotationMomentumEstimator.enabled=t,this.panPlanarMomentumEstimator.enabled=t,this.panSphericalMomentumEstimator.enabled=t,this.beginHeading=-T.f.normalize(Object(m.g)(this.view.camera.heading)),this.beginRadius=e.radius,this.pointerCount=e.pointers.size,this.beginAngle=e.angle,this.smoothRotation.reset(),Object(Z.i)(e.center,this.screenPickPoint),Object(xu.c)(this.beginScreenPoint,this.screenPickPoint);var r=Object(J.e)(this.view.spatialReference),n=Jp(this.intersectionHelper,this.startCamera,this.screenPickPoint,!0,r);this.scenePickPoint=n.scenePickPoint,this.sphere=n.sphere,Object(Yl.m)(this.beginScenePoint,this.scenePickPoint),this.navMode=Kp(this.startCamera,this.screenPickPoint,n.hasGeometryIntersection,r),this.navMode===Gp.Vertical&&this.preparePlanarPanMode(e),this.constraintOptions.interactionStartCamera.copyFrom(this.startCamera)}}},{key:"preparePlanarPanMode",value:function(e){var t=Object(Yl.u)(this.tmp3d,this.startCamera.viewForward);Object(Rp.h)(this.scenePickPoint,t,this.panningPlane);var r=Object(Z.f)(this.screenPickPoint[0],0),n=Object(X.e)(),i=Object(Yl.r)(this.startCamera.eye);this.adjustedSphere[3]=i<this.sphere[3]?i-100:this.sphere[3],rb(this.adjustedSphere,this.startCamera,r,n);var a=Object(Z.d)();this.startCamera.projectToRenderScreen(n,a);var o=.9*a[1];if(this.screenPickPoint[1]=Math.min(this.screenPickPoint[1],o),this.intersectionHelper.intersectScreen(this.screenPickPoint,this.scenePickPoint)&&Object(Rp.h)(this.scenePickPoint,Object(Rp.s)(this.panningPlane),this.panningPlane),!Object(Vb.a)()){var s=Object(X.e)(),c=Object(X.e)(),l=Object(X.e)();Object(Yl.l)(s,this.scenePickPoint,this.currentCamera.eye),Object(Yl.t)(s,s);var u=5*Math.max(Math.abs(this.view.camera.position.z),50),d=this.view._stage.renderView.getMinimalDepthForArea(this.screenPickPoint[0],this.screenPickPoint[1],this.view.state.camera,80),h=d?Math.min(d,u):u;Object(Yl.m)(l,Object(Yl.h)(c,this.currentCamera.eye,Object(Yl.g)(c,s,h))),this.panningPlane[3]=-Object(Yl.j)(this.panningPlane,l),this.startCamera.center=Object(Yl.h)(c,this.startCamera.eye,Object(Yl.g)(c,this.startCamera.viewForward,h))}var f=Object(Z.i)(e.center,this.tmpScreenPointArray);Np(this.panningPlane,this.startCamera,f,this.beginScenePoint)}},{key:"update",value:function(e){if(this.active){this.currentCamera.copyFrom(this.startCamera);var t=e.pointers.size>1;this.navMode===Gp.Horizontal?(t&&this.zoomSpherical(e),this.panningSpherical(e),t&&this.rotateSpherical(e)):(t&&this.zoomPlanar(e),this.panningPlanar(e),t&&this.rotatePlanar(e))}}},{key:"end",value:function(e){e.pointers.size===this.pointerCount&&this.update(e),this.finishController();var t=this.zoomMomentumEstimator.evaluateMomentum();if(t)return this.navMode===Gp.Horizontal?new Cm({view:this.view,momentum:t,screenCenter:this.zoomCenterScreen,sceneCenter:this.beginScenePoint,radius:this.sphere[3]}):new Tm({view:this.view,momentum:t,zoomCenter:this.beginScenePoint});var r=this.rotationMomentumEstimator.evaluateMomentum();if(r)return new Sm({view:this.view,momentum:r,center:this.sphere,axis:this.rotationAxis});if(this.navMode===Gp.Horizontal){var n=this.panSphericalMomentumEstimator.evaluateMomentum();if(n)return new km({view:this.view,momentum:n})}else{var i=this.panPlanarMomentumEstimator.evaluateMomentum();if(i)return new jm({view:this.view,momentum:i})}return null}},{key:"zoomSpherical",value:function(e){var t=this.beginRadius/e.radius,r=.001875*Math.min(Math.max(e.radius,40),120);this.smoothScaling.gain=r,this.smoothScaling.update(t),Bp(this.sphere,this.currentCamera,this.smoothScaling.value),Object(Z.i)(e.center,this.zoomCenterScreen),this.zoomMomentumEstimator.add(this.smoothScaling.value,.001*e.timestamp),this.constraintOptions.interactionType=1,this.constraintOptions.interactionFactor=wf(e.radius-this.beginRadius),jf(this.view,this.currentCamera,this.constraintOptions)}},{key:"panningSpherical",value:function(e){var t=Object(Z.i)(e.center,this.tmpScreenPointArray);rb(this.sphere,this.currentCamera,t,this.tmp3d),hb(this.beginScenePoint,Object(Yl.j)(this.currentCamera.up,this.beginScenePoint),this.sphere[3],this.beginHeading,this.view.camera.tilt,this.startCamera)?(pb(this.sphere,this.currentCamera,this.beginScenePoint,this.tmp3d,this.beginHeading,this.view.camera.tilt,!1),this.panSphericalMomentumEstimator.addMomentumPreserveHeading(t,this.tmp3d,.001*e.timestamp,this.startCamera,this.sphere,this.beginHeading,this.view.camera.tilt)):(fb(this.sphere,this.currentCamera,this.beginScenePoint,this.tmp3d,this.view.camera.tilt,!1),this.panSphericalMomentumEstimator.addMomentumDirectRotation(t,this.tmp3d,.001*e.timestamp,this.startCamera,this.sphere[3],this.view.camera.tilt)),this.constraintOptions.interactionType=4,this.constraintOptions.interactionFactor=wf(this.screenPickPoint,t),jf(this.view,this.currentCamera,this.constraintOptions)}},{key:"rotateSpherical",value:function(e){Object(Yl.t)(this.rotationAxis,this.scenePickPoint),this.currentCamera.aboveGround||Object(Yl.u)(this.rotationAxis,this.rotationAxis);var t=this.smoothRotation.value,r=t+zp(e.angle-t),n=.00125*Math.min(Math.max(e.radius,40),120);this.smoothRotation.gain=n,this.smoothRotation.update(r);var i=this.smoothRotation.value-this.beginAngle;this.rotationMomentumEstimator.add(i,.001*e.timestamp),Vp(this.currentCamera,this.sphere,Op(this.rotationAxis,i)),this.constraintOptions.interactionType=2,this.constraintOptions.interactionFactor=wf(e.radius*r),jf(this.view,this.currentCamera,this.constraintOptions)}},{key:"panningPlanar",value:function(e){var t=Object(Z.i)(e.center,this.tmpScreenPointArray);Np(this.panningPlane,this.currentCamera,t,this.tmp3d)&&(eb(this.currentCamera,this.beginScenePoint,this.tmp3d),this.panPlanarMomentumEstimator.add(t,this.tmp3d,.001*e.timestamp),this.constraintOptions.interactionType=4,this.constraintOptions.interactionFactor=wf(this.beginScreenPoint,t),this.constraintOptions.interactionDirection=this.view.renderCoordsHelper.worldUpAtPosition(this.currentCamera.eye,this.tmpInteractionDirection),jf(this.view,this.currentCamera,this.constraintOptions),this.constraintOptions.interactionDirection=null)}},{key:"zoomPlanar",value:function(e){var t=this.beginRadius/e.radius,r=.001875*Math.min(Math.max(e.radius,40),120);this.smoothScaling.gain=r,this.smoothScaling.update(t),this.zoomMomentumEstimator.add(this.smoothScaling.value,.001*e.timestamp),Up(this.currentCamera,this.beginScenePoint,this.smoothScaling.value,this.view.state.constraints.minimumPoiDistance),this.constraintOptions.interactionType=1,this.constraintOptions.interactionFactor=wf(e.radius-this.beginRadius),jf(this.view,this.currentCamera,this.constraintOptions)}},{key:"rotatePlanar",value:function(e){Object(Yl.m)(this.rotationAxis,this.beginScenePoint),this.currentCamera.aboveGround||Object(Yl.u)(this.rotationAxis,this.rotationAxis);var t=this.smoothRotation.value,r=e.angle-t,n=t+(r=zp(r)),i=.00125*Math.min(Math.max(e.radius,40),120);this.smoothRotation.gain=i,this.smoothRotation.update(n);var a=this.smoothRotation.value-this.beginAngle;this.rotationMomentumEstimator.add(a,.001*e.timestamp),Vp(this.currentCamera,this.sphere,Op(this.rotationAxis,a)),this.constraintOptions.interactionType=2,this.constraintOptions.interactionFactor=wf(e.radius*a),jf(this.view,this.currentCamera,this.constraintOptions)}}]),r}(qb);Object(b.a)([Object(y.b)({constructOnly:!0})],Um.prototype,"view",void 0),Um=Object(b.a)([Object(w.a)("esri.views.3d.state.controllers.global.PinchAndPanController")],Um);var Bm=Object(X.g)(0,0,1),Gm=16/180*Math.PI,qm=function(e){Object(f.a)(r,e);var t=Object(p.a)(r);function r(e){var n;return Object(c.a)(this,r),(n=t.call(this,e)).view=null,n.rotationValueSmooth=new gm(.05),n.scalingValueSmooth=new gm(.05),n.planeHorizontal=Object(Rp.d)(),n.planeVertical=Object(Rp.d)(),n.rotationMomentumEstimator=new zm,n.panMomentumEstimator=new Em(300,12,.9),n.zoomMomentumEstimator=new Nm,n.beginCenter=Object(X.e)(),n.tmpPoints=[],n.beginCenterScreen=Object(Z.f)(),n.tmpCentroid3d=Object(X.e)(),n.tmpCentroid2d=Object(Z.f)(),n.tmp2d=Object(Z.f)(),n.constraintOptions={selection:15,interactionType:0,interactionFactor:0,interactionStartCamera:new zf.a,interactionDirection:null,tiltMode:0},n}return Object(l.a)(r,[{key:"intersectionHelper",get:function(){return this.view.sceneIntersectionHelper}},{key:"begin",value:function(e){if(this.active){var t=this.view.navigation.momentumEnabled;this.zoomMomentumEstimator.enabled=t,this.rotationMomentumEstimator.enabled=t,this.panMomentumEstimator.enabled=t,this.beginRadius=e.radius,this.pointerCount=e.pointers.size,this.beginAngle=e.angle,this.rotationValueSmooth.reset(),this.scalingValueSmooth.reset(),Object(Z.i)(e.center,this.beginCenterScreen),Object(Rp.f)(Bm,0,this.planeHorizontal);var r=Object(X.e)();this.intersectionHelper.intersectScreenFreePointFallback(this.beginCenterScreen,r);var n=Object(X.e)();Object(Yl.u)(n,this.startCamera.viewForward);var i=Object(X.e)();Object(Yl.m)(i,Bm);var a=Object(Yl.j)(n,i),o=Object(m.c)(a<0?-a:a);if(this.panMode=o>=Gm?Gp.Horizontal:Gp.Vertical,Object(Rp.v)(this.planeHorizontal,r,this.planeHorizontal),this.startCamera.aboveGround||Object(Rp.r)(this.planeHorizontal,this.planeHorizontal),this.panMode===Gp.Vertical){if(Object(Yl.g)(i,i,a),Object(Yl.l)(this.planeVertical,n,i),Object(Yl.t)(this.planeVertical,this.planeVertical),Object(Rp.v)(this.planeVertical,r,this.planeVertical),!Object(Vb.a)()){var s=Object(X.e)(),c=Object(X.e)(),l=Object(X.e)();Object(Yl.l)(s,r,this.currentCamera.eye),Object(Yl.t)(s,s);var u=5*Math.max(Math.abs(this.view.camera.position.z),50),d=this.view._stage.renderView.getMinimalDepthForArea(this.beginCenterScreen[0],this.beginCenterScreen[1],this.view.state.camera,80),h=d?Math.min(d,u):u;Object(Yl.m)(l,Object(Yl.h)(c,this.currentCamera.eye,Object(Yl.g)(c,s,h))),this.planeVertical[3]=-Object(Yl.j)(this.planeVertical,l)}this.computePlanePoints(e.pointers,this.planeVertical,this.startCamera,this.tmpPoints),Hp(this.tmpPoints,this.beginCenter)}else this.computePlanePoints(e.pointers,this.planeHorizontal,this.startCamera,this.tmpPoints),Hp(this.tmpPoints,this.beginCenter);this.constraintOptions.interactionStartCamera.copyFrom(this.startCamera)}}},{key:"update",value:function(e){if(this.active){this.currentCamera.copyFrom(this.startCamera);var t=e.pointers.size>1,r=this.panMode===Gp.Horizontal?this.planeHorizontal:this.planeVertical,n=this.beginCenter;if(t){var i=this.beginRadius/e.radius,a=.001875*Math.min(Math.max(e.radius,40),120);this.scalingValueSmooth.gain=a,this.scalingValueSmooth.update(i),Up(this.currentCamera,n,this.scalingValueSmooth.value,this.view.state.constraints.minimumPoiDistance),this.zoomMomentumEstimator.add(this.scalingValueSmooth.value,.001*e.timestamp),this.constraintOptions.interactionType=1,this.constraintOptions.interactionFactor=wf(Math.abs(e.radius-this.beginRadius)),jf(this.view,this.currentCamera,this.constraintOptions)}if(this.computePlanePoints(e.pointers,r,this.currentCamera,this.tmpPoints),Hp(this.tmpPoints,this.tmpCentroid3d),Object(Z.i)(e.center,this.tmpCentroid2d),eb(this.currentCamera,n,this.tmpCentroid3d),this.panMomentumEstimator.add(this.tmpCentroid2d,this.tmpCentroid3d,.001*e.timestamp),this.constraintOptions.interactionType=4,this.constraintOptions.interactionFactor=wf(this.beginCenterScreen,this.tmpCentroid2d),jf(this.view,this.currentCamera,this.constraintOptions),t){var o=this.planeHorizontal,s=n,c=this.rotationValueSmooth.value,l=c+zp(e.angle-c),u=.00125*Math.min(Math.max(e.radius,40),120);this.rotationValueSmooth.gain=u,this.rotationValueSmooth.update(l);var d=this.rotationValueSmooth.value-this.beginAngle;this.rotationMomentumEstimator.add(d,.001*e.timestamp),Vp(this.currentCamera,s,Op(o,d)),this.constraintOptions.interactionType=2,this.constraintOptions.interactionFactor=wf(Math.abs(e.radius*d)),jf(this.view,this.currentCamera,this.constraintOptions)}}}},{key:"end",value:function(e){e.pointers.size===this.pointerCount&&this.update(e),this.finishController();var t=this.zoomMomentumEstimator.evaluateMomentum();if(t)return new Tm({view:this.view,momentum:t,zoomCenter:this.beginCenter});var r=this.rotationMomentumEstimator.evaluateMomentum();if(r)return new Sm({view:this.view,momentum:r,center:this.beginCenter,axis:Object(Rp.s)(this.planeHorizontal)});var n=this.panMomentumEstimator.evaluateMomentum();return n?new jm({view:this.view,momentum:n}):null}},{key:"computePlanePoints",value:function(e,t,r,n){n.length=e.size;var i=this.tmp2d,a=0;return e.forEach((function(e){i[0]=e.x,i[1]=e.y,void 0===n[a]&&(n[a]=Object(X.e)()),Np(t,r,i,n[a]),a+=1})),n}}]),r}(qb);Object(b.a)([Object(y.b)({constructOnly:!0})],qm.prototype,"view",void 0),qm=Object(b.a)([Object(w.a)("esri.views.3d.state.controllers.local.PinchAndPanController")],qm);var Hm=function(e){Object(f.a)(r,e);var t=Object(p.a)(r);function r(e,n,i){var a;return Object(c.a)(this,r),(a=t.call(this,!0)).view=e,a.pointerAction=n,a.lastEndTimestamp=0,a.lastTimestamp=0,a.registerIncoming("drag",i,(function(e){return a.handleDrag(e)})),a}return Object(l.a)(r,[{key:"handleDrag",value:function(e){if("mouse"!==e.data.pointerType||Bb(e.data,this.pointerAction)){var t=e.timestamp-this.lastEndTimestamp,r=this.momentum&&this.momentum.active&&t<40;switch(e.data.action){case"start":case"update":if(r)break;this.controller&&this.controller.active?e.data.timestamp-this.lastTimestamp>2&&(this.controller.update(e.data),this.lastTimestamp=e.timestamp):this.startController(e);break;case"end":case"removed":this.endController(e,!0);break;case"added":this.endController(e,!1),this.startController(e)}e.stopPropagation()}}},{key:"endController",value:function(e,t){if(this.controller&&this.controller.active){this.lastEndTimestamp=e.timestamp;var r=this.controller.end(e.data);t&&r&&(this.momentum=r,this.view.state.switchCameraController(this.momentum))}this.controller=null}},{key:"startController",value:function(e){this.controller=this.createController(),this.view.state.switchCameraController(this.controller),this.controller.begin(e.data),this.lastTimestamp=e.timestamp}},{key:"createController",value:function(){return this.view.state.isGlobal?new Um({view:this.view}):new qm({view:this.view})}}]),r}(sa),Wm=function(e){Object(f.a)(r,e);var t=Object(p.a)(r);function r(e,n){var i;return Object(c.a)(this,r),(i=t.call(this,!0)).view=e,i.registerIncoming("pointer-down",n,(function(){return i.view.state.stopActiveCameraController()})),i}return r}(sa),Qm=function(e){Object(f.a)(r,e);var t=Object(p.a)(r);function r(e,n){var i;return Object(c.a)(this,r),(i=t.call(this,!0)).key=e,i.registerIncoming("key-down",n,(function(e){return i._handleKeyDown(e)})),i}return Object(l.a)(r,[{key:"_handleKeyDown",value:function(e){e.data.key===this.key&&(this.activate(),e.stopPropagation())}}]),r}(sa),Zm=function(e){Object(f.a)(r,e);var t=Object(p.a)(r);function r(e,n,i){var a;return Object(c.a)(this,r),(a=t.call(this,n,i)).view=e,a.key=n,a}return Object(l.a)(r,[{key:"activate",value:function(){this.view.goTo({heading:0}).catch((function(){}))}}]),r}(Qm),Xm=function(e){Object(f.a)(r,e);var t=Object(p.a)(r);function r(e,n,i){var a;return Object(c.a)(this,r),(a=t.call(this,n,i)).view=e,a.key=n,a}return Object(l.a)(r,[{key:"activate",value:function(){this.view.goTo({tilt:0}).catch((function(){}))}}]),r}(Qm),Ym=function(e){Object(f.a)(r,e);var t=Object(p.a)(r);function r(e){var n,i=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return Object(c.a)(this,r),(n=t.call(this,!0)).view=e,n.invert=i,n.registerIncoming("vertical-two-finger-drag",(function(e){return n.handleTwoFinger(e)})),n}return Object(l.a)(r,[{key:"handleTwoFinger",value:function(e){var t,r,n,i=this.invert?-1:1,a=Object(Z.f)(0,e.data.delta*i);switch(e.data.action){case"begin":null==(t=this.cameraController)||t.end(),this.cameraController=new Hb({view:this.view,pivot:0}),this.view.state.switchCameraController(this.cameraController),this.cameraController.begin(a);break;case"update":null==(r=this.cameraController)||r.update(a);break;case"end":null==(n=this.cameraController)||n.end(),this.cameraController=null}}}]),r}(sa);function $m(e){var t=e.native;return t?{buttons:t.buttons.map((function(e){return e.pressed?e.value?e.value:1:0})),axes:t.axes.map((function(t){return function(e,t){var r=Math.abs(e);return r<t?0:Object(m.t)(e)*(r-t)/(1-t)}(t,e.axisThreshold)}))}:{buttons:[],axes:[]}}var Jm=function(){function e(t,r){var n=this;Object(c.a)(this,e),this.element=t,this.input=r,this._hasEventListeners=!1,this.onConnectGamepad=function(e){n.connectGamepad(e.gamepad)},this.onDisconnectGamepad=function(e){var t=e.gamepad,r=t.index,i=n.inputDevices[r];i&&(n.emitGamepadEvent(t,$m(i),!1),n.inputDevices.splice(r,1),n.latestUpdate.splice(r,1),n.input.gamepad.devices.remove(i),n.ensurePollingState())},this.frameTask=null,this.latestUpdate=new Array,this.inputDevices=new Array,this.callback=null;var i="getGamepads"in window.navigator,a=window.isSecureContext;this.supported=i&&a,this.supported&&(this.forEachGamepad(this.connectGamepad),window.addEventListener("gamepadconnected",this.onConnectGamepad),window.addEventListener("gamepaddisconnected",this.onDisconnectGamepad),this.ensurePollingState())}return Object(l.a)(e,[{key:"destroy",value:function(){this.hasEventListeners=!1,this.supported&&(window.removeEventListener("gamepadconnected",this.onConnectGamepad),window.removeEventListener("gamepaddisconnected",this.onDisconnectGamepad))}},{key:"hasEventListeners",set:function(e){this._hasEventListeners!==e&&(this._hasEventListeners=e,this.ensurePollingState())}},{key:"eventsEnabled",get:function(){return this.supported&&this.inputDevices.length>0&&this._hasEventListeners}},{key:"onEvent",set:function(e){this.callback=e}},{key:"connectGamepad",value:function(e){var t=new Cc(e);"unknown"!==t.deviceType&&(this.inputDevices[e.index]=t,this.input.gamepad.devices.add(t)),this.ensurePollingState()}},{key:"ensurePollingState",value:function(){this.eventsEnabled?this.startPolling():this.stopPolling()}},{key:"startPolling",value:function(){var e=this;null==this.frameTask&&(this.frameTask=Object(H.a)({update:function(){return e.readGamepadState()}}))}},{key:"stopPolling",value:function(){null!=this.frameTask&&(this.frameTask.remove(),this.frameTask=null,this.latestUpdate=new Array)}},{key:"readGamepadState",value:function(){var e=this,t=document.hasFocus(),r=this.element.contains(document.activeElement),n="document"===this.input.gamepad.enabledFocusMode&&!t||"view"===this.input.gamepad.enabledFocusMode&&!r;this.forEachGamepad((function(t){var r=e.inputDevices[t.index];if(r){var i=e.latestUpdate[t.index],a=$m(r),o=n||function(e){for(var t=0;t<e.axes.length;t++)if(0!==e.axes[t])return!1;for(var r=0;r<e.buttons.length;r++)if(0!==e.buttons[r])return!1;return!0}(a);if(i){if(i.timestamp===t.timestamp)return;if(!i.active&&o)return;if(function(e,t){if(e.axes.length!==t.axes.length)return!1;if(e.buttons.length!==t.buttons.length)return!1;for(var r=0;r<e.axes.length;r++)if(e.axes[r]!==t.axes[r])return!1;for(var n=0;n<e.buttons.length;n++)if(e.buttons[n]!==t.buttons[n])return!1;return!0}(i.state,a))return}e.emitGamepadEvent(t,a,!o)}}))}},{key:"forEachGamepad",value:function(e){for(var t=window.navigator.getGamepads(),r=0;r<t.length;r++){var n=t[r];this.validate(n)&&e(n)}}},{key:"emitGamepadEvent",value:function(e,t,r){var n=this.latestUpdate[e.index],i=n&&n.active;if(i||r){var a=!i&&r?"start":i&&r?"update":"end";this.latestUpdate[e.index]={timestamp:e.timestamp,state:t,active:r},this.callback&&this.callback({device:this.inputDevices[e.index],state:t,action:a})}}},{key:"validate",value:function(e){if(!e)return!1;if(!e.connected)return!1;for(var t=0;t<e.axes.length;t++)if(isNaN(e.axes[t]))return!1;return!0}}]),e}(),Km=Object(g.a)("trident"),ey=Object(g.a)("edge"),ty=Object(g.a)("chrome"),ry=Object(g.a)("ff"),ny=Object(g.a)("safari"),iy="esri-view-surface--touch-none",ay="esri-view-surface--touch-pan",oy=function(){function e(t,r){var n=this;Object(c.a)(this,e),this.input=r,this._active={},this._activePointerCaptures=new Set,this._keyDownState=new Set,this._eventId=1,this._browserTouchPanningEnabled=!1,this._element=t,t.getAttribute("tabindex")||t.setAttribute("tabindex","0"),this._eventHandlers={"key-down":this._handleKey,"key-up":this._handleKey,"pointer-down":this._handlePointer,"pointer-move":this._handlePointerPreventDefault,"pointer-up":this._handlePointerPreventDefault,"pointer-enter":this._handlePointer,"pointer-leave":this._handlePointer,"pointer-cancel":this._handlePointer,"mouse-wheel":this._handleMouseWheel,"pointer-capture-lost":this._handlePointerCaptureLost},this._updateTouchAction(),this._element.addEventListener("keydown",this._preventAltKeyDefault),this._gamepadSource=new Jm(t,this.input),this._gamepadSource.onEvent=function(e){return n._callback("gamepad",e)}}return Object(l.a)(e,[{key:"destroy",value:function(){var e=this;this._callback=null,this.activeEvents=null,this._activePointerCaptures.forEach((function(t){e._releasePointerCaptureSafe(t)})),this._gamepadSource&&(this._gamepadSource.destroy(),this._gamepadSource=null),this._activePointerCaptures=null,this._removeTouchAction(),this._element.removeEventListener("keydown",this._preventAltKeyDefault)}},{key:"browserTouchPanningEnabled",get:function(){return this._browserTouchPanningEnabled},set:function(e){this._browserTouchPanningEnabled=e,this._updateTouchAction(),this._updateTouchEventHandling()}},{key:"onEventReceived",set:function(e){this._callback=e}},{key:"activeEvents",set:function(e){var t=this;for(var r in this._active)if(!e||!e.has(r)){var n=this._active[r];this._element.removeEventListener(sy[r],n),delete this._active[r]}e&&e.forEach((function(e){if(!t._active[e]&&sy[e]){var r=(t._eventHandlers[e]||t._handleDefault).bind(t,e);t._element.addEventListener(sy[e],r),t._active[e]=r}})),this._gamepadSource.hasEventListeners=e&&e.has("gamepad")}},{key:"setPointerCapture",value:function(e,t){t?(this._element.setPointerCapture(e.pointerId),this._activePointerCaptures.add(e.pointerId)):(this._releasePointerCaptureSafe(e.pointerId),this._activePointerCaptures.delete(e.pointerId))}},{key:"_updateTouchAction",value:function(){this._element.classList.remove(this._browserTouchPanningEnabled?iy:ay),this._element.classList.add(this._browserTouchPanningEnabled?ay:iy)}},{key:"_updateTouchEventHandling",value:function(){this._browserTouchPanningEnabled?this._element.addEventListener("touchmove",this._preventMultiTouchPanning):this._element.removeEventListener("touchmove",this._preventMultiTouchPanning)}},{key:"_removeTouchAction",value:function(){this._element.classList.remove(iy),this._element.classList.remove(ay),this._element.removeEventListener("touchmove",this._preventMultiTouchPanning)}},{key:"_releasePointerCaptureSafe",value:function(e){try{if(this._element.hasPointerCapture&&!this._element.hasPointerCapture(e))return;this._element.releasePointerCapture(e)}catch(t){}}},{key:"_updateNormalizedPointerLikeEvent",value:function(t,r){var n=hc(this._element,t);return e.test.disableSubpixelCoordinates&&(n.x=Math.round(n.x),n.y=Math.round(n.y)),r.x=n.x,r.y=n.y,r}},{key:"_handleKey",value:function(e,t){var r=function(e){if(void 0!==e.key)return Object(B.a)(e);var t=ea[e.keyCode];return Array.isArray(t)?e.shiftKey?t[1]:t[0]:t}(t);r&&"key-up"===e&&this._keyDownState.delete(r);var n={native:t,key:r,repeat:r&&this._keyDownState.has(r)};r&&"key-down"===e&&this._keyDownState.add(n.key),this._callback(e,n)}},{key:"_handlePointer",value:function(e,t){var r=this._updateNormalizedPointerLikeEvent(t,{native:t,x:0,y:0,pointerType:t.pointerType,button:t.button,buttons:t.buttons,eventId:this._eventId++});this._callback(e,r)}},{key:"_handlePointerPreventDefault",value:function(e,t){var r=this._updateNormalizedPointerLikeEvent(t,{native:t,x:0,y:0,pointerType:t.pointerType,button:t.button,buttons:t.buttons,eventId:this._eventId++});t.preventDefault(),this._callback(e,r)}},{key:"_handleMouseWheel",value:function(e,t){var r=t.deltaY;switch(t.deltaMode){case 0:(Km||ey)&&(r=r/document.documentElement.clientHeight*600);break;case 1:r*=30;break;case 2:r*=900}Km||ey?r*=.7:ty||ny?r*=.6:ry&&(r*=1.375);var n=Math.abs(r);if(n>100){r=r/n*200/(1+Math.exp(-.02*(n-100)))}var i=this._updateNormalizedPointerLikeEvent(t,{native:t,x:0,y:0,deltaY:r});this._callback(e,i)}},{key:"_handlePointerCaptureLost",value:function(e,t){this._activePointerCaptures.delete(t.pointerId),this._handleDefault(e,t)}},{key:"_handleDefault",value:function(e,t){var r={native:t};t.preventDefault(),this._callback(e,r)}},{key:"_preventAltKeyDefault",value:function(e){"Alt"===e.key&&e.preventDefault()}},{key:"_preventMultiTouchPanning",value:function(e){e.touches.length>1&&e.preventDefault()}}]),e}();oy.test={disableSubpixelCoordinates:!1};var sy={"key-down":"keydown","key-up":"keyup","pointer-down":"pointerdown","pointer-up":"pointerup","pointer-move":"pointermove","mouse-wheel":"wheel","pointer-capture-got":"gotpointercapture","pointer-capture-lost":"lostpointercapture","context-menu":"contextmenu","pointer-enter":"pointerenter","pointer-leave":"pointerleave","pointer-cancel":"pointercancel",focus:"focus",blur:"blur"},cy=function(e){Object(f.a)(r,e);var t=Object(p.a)(r);function r(){var e;return Object(c.a)(this,r),(e=t.call(this,!0)).registerIncoming("context-menu",(function(e){e.data.native.preventDefault()})),e}return r}(sa);function ly(e,t){return Math.abs(t.x-e.x)+Math.abs(t.y-e.y)}var uy,dy=function(e){Object(f.a)(r,e);var t=Object(p.a)(r);function r(e){var n;return Object(c.a)(this,r),(n=t.call(this,!1)).navigationTouch=e,n.startStateModifiers=new Set,n.activePointerMap=new Map,n.isDragging=!1,n.isCurrentDragSuppressed=!1,n.drag=n.registerOutgoing("drag"),n.registerIncoming("pointer-drag",n.handlePointerDrag.bind(Object(u.a)(n))),n.registerIncoming("pointer-up",n.handlePointerUpAndPointerLost.bind(Object(u.a)(n))),n.registerIncoming("pointer-capture-lost",n.handlePointerUpAndPointerLost.bind(Object(u.a)(n))),n.registerIncoming("pointer-cancel",n.handlePointerUpAndPointerLost.bind(Object(u.a)(n))),n}return Object(l.a)(r,[{key:"createPayload",value:function(e,t,r,n){return{action:e,pointerType:this.pointerType,button:this.mouseButton,buttons:t.buttons,timestamp:n,pointers:py(this.activePointerMap),pointer:t,angle:r.angle,radius:r.radius,center:r.center}}},{key:"addPointer",value:function(e){var t=e.native.pointerId,r=fy(this.activePointerMap).angle,n={event:e,initialAngle:0,lastAngle:0};this.activePointerMap.set(t,n);var i=by(n,hy(this.activePointerMap));n.initialAngle=i,n.lastAngle=i,this.updatePointerAngles(r)}},{key:"updatePointer",value:function(e){if(!e||null!=e.x||null!=e.y){var t=e.native.pointerId,r=this.activePointerMap.get(t);r?r.event=e:this.addPointer(e)}}},{key:"removePointer",value:function(e){var t=fy(this.activePointerMap).angle;this.activePointerMap.delete(e),this.updatePointerAngles(t)}},{key:"updatePointerAngles",value:function(e){var t=fy(this.activePointerMap);this.activePointerMap.forEach((function(r){r.initialAngle=by(r,t)-e,r.lastAngle=by(r,t)-e}))}},{key:"emitEvent",value:function(e,t,r){var n=fy(this.activePointerMap);this.drag.emit(this.createPayload(e,t,n,r),void 0,this.startStateModifiers)}},{key:"handlePointerUpAndPointerLost",value:function(e){var t=e.data.native.pointerId,r=Object(Vd.a)(e.timestamp);this.activePointerMap.get(t)&&(1===this.activePointerMap.size?(this.updatePointer(e.data),!this.isCurrentDragSuppressed&&this.emitEvent("end",e.data,r),this.isDragging=!1,this.isCurrentDragSuppressed=!1,this.removePointer(t)):(this.removePointer(t),this.emitEvent("removed",e.data,Object(Vd.a)(e.timestamp))))}},{key:"handlePointerDrag",value:function(e){var t=e.data,r=t.currentEvent,n=Object(Vd.a)(e.timestamp);switch(t.action){case"start":case"update":this.isDragging?this.activePointerMap.has(r.native.pointerId)?(this.updatePointer(r),!this.isCurrentDragSuppressed&&this.emitEvent("update",r,n)):(this.addPointer(r),this.emitEvent("added",r,n),this.isCurrentDragSuppressed=this.isSuppressed):(this.updatePointer(r),this.pointerType=e.data.startEvent.pointerType,this.mouseButton=e.data.startEvent.button,this.startStateModifiers=e.modifiers,this.isDragging=!0,this.isCurrentDragSuppressed=this.isSuppressed,!this.isCurrentDragSuppressed&&this.emitEvent("start",r,n))}}},{key:"isSuppressed",get:function(){return this.navigationTouch&&!this.navigationTouch.browserTouchPanEnabled&&"touch"===this.pointerType&&1===this.activePointerMap.size}}]),r}(sa);function hy(e){var t=[];return e.forEach((function(e){t.push(Object(Z.e)(e.event.x,e.event.y))})),function(e,t){if(t?(t.radius=0,t.center.x=0,t.center.y=0):t={radius:0,center:Object(Z.e)()},0===e.length)return t;if(1===e.length)return t.center.x=e[0].x,t.center.y=e[0].y,t;if(2===e.length){var r=Object(ue.a)(e,2),n=r[0],i=r[1],a=i.x-n.x,o=i.y-n.y;return t.radius=Math.sqrt(a*a+o*o)/2,t.center.x=(n.x+i.x)/2,t.center.y=(n.y+i.y)/2,t}for(var s=0,c=0,l=0;l<e.length;l++)s+=e[l].x,c+=e[l].y;s/=e.length,c/=e.length;for(var u=e.map((function(e){return e.x-s})),d=e.map((function(e){return e.y-c})),h=0,f=0,p=0,b=0,v=0,m=0,y=0,g=0;g<u.length;g++){var O=u[g],j=d[g],_=O*O,w=j*j;h+=_,f+=w,p+=O*j,b+=_*O,v+=w*j,m+=O*w,y+=j*_}var x=.5*(b+m),k=.5*(v+y),S=h*f-p*p,T=(x*f-k*p)/S,C=(h*k-p*x)/S,M=Object(Z.e)(T+s,C+c);return{radius:Math.sqrt(T*T+C*C+(h+f)/e.length),center:M}}(t)}function fy(e){var t=hy(e),r=0;return e.forEach((function(e){for(var n=by(e,t),i=n-e.lastAngle;i>Math.PI;)i-=2*Math.PI;for(;i<-Math.PI;)i+=2*Math.PI;n=e.lastAngle+i,e.lastAngle=n;var a=n-e.initialAngle;r+=a})),{angle:r/=e.size||1,radius:t.radius,center:t.center}}function py(e){var t=new Map;return e.forEach((function(e,r){return t.set(r,e.event)})),t}function by(e,t){var r=e.event,n=r.x-t.center.x,i=r.y-t.center.y;return Math.atan2(i,n)}!function(e){e[e.Left=0]="Left",e[e.Middle=1]="Middle",e[e.Right=2]="Right",e[e.Back=3]="Back",e[e.Forward=4]="Forward",e[e.Undefined=-1]="Undefined"}(uy||(uy={}));var vy=r(327),my=250,yy=10,gy=350,Oy=35,jy=function(e){Object(f.a)(r,e);var t=Object(p.a)(r);function r(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:my,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:yy,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:gy,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Oy,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:vy.a;return Object(c.a)(this,r),(e=t.call(this,!1)).maximumDoubleClickDelay=n,e.maximumDoubleClickDistance=i,e.maximumDoubleTouchDelay=a,e.maximumDoubleTouchDistance=o,e._clock=s,e._pointerState=new Map,e._click=e.registerOutgoing("click"),e._doubleClick=e.registerOutgoing("double-click"),e.registerIncoming("immediate-click",e._handleImmediateClick.bind(Object(u.a)(e))),e.registerIncoming("pointer-drag",e._handlePointerDrag.bind(Object(u.a)(e))),e.registerIncoming("drag",e._handleDrag.bind(Object(u.a)(e))),e}return Object(l.a)(r,[{key:"onUninstall",value:function(){this._pointerState.forEach((function(e){null!=e.doubleClickTimeout&&(e.doubleClickTimeout.remove(),e.doubleClickTimeout=null)}))}},{key:"hasPendingInputs",get:function(){return Object(Qs.b)(this._pointerState,(function(e){return null!=e.doubleClickTimeout}))}},{key:"_pointerId",value:function(e){var t=e.native;return"mouse"===t.pointerType?"".concat(t.pointerId,":").concat(t.button):"".concat(t.pointerType)}},{key:"_handleImmediateClick",value:function(e){var t=e.data,r=this._pointerId(t),n=this._pointerState.get(r);if(n){var i="touch"===t.native.pointerType?this.maximumDoubleTouchDistance:this.maximumDoubleClickDistance;ly(n.event.data,t)>i?(this._clearDoubleClickTimeout(r,!0),this._startClick(e)):(this._clearDoubleClickTimeout(r,!1),this._doubleClick.emit(n.event.data,void 0,n.event.modifiers))}else this._startClick(e)}},{key:"_startClick",value:function(e){var t=this,r=this._pointerId(e.data),n="touch"===e.data.native.pointerType?this.maximumDoubleTouchDelay:this.maximumDoubleClickDelay;this._pointerState.set(r,{event:e,doubleClickTimeout:this._clock.setTimeout((function(){return t._doubleClickTimeoutExceeded(r)}),n)}),this.refreshHasPendingInputs()}},{key:"_handlePointerDrag",value:function(e){var t=this._pointerId(e.data.currentEvent);this._clearDoubleClickTimeout(t,!0)}},{key:"_handleDrag",value:function(e){var t=this._pointerId(e.data.pointer);this._clearDoubleClickTimeout(t,!0)}},{key:"_clearDoubleClickTimeout",value:function(e,t){var r=this._pointerState.get(e);r&&(r.doubleClickTimeout.remove(),r.doubleClickTimeout=null,t&&this._doubleClickTimeoutExceeded(e),this._pointerState.delete(e),this.refreshHasPendingInputs())}},{key:"_doubleClickTimeoutExceeded",value:function(e){var t=this._pointerState.get(e);this._click.emit(t.event.data,void 0,t.event.modifiers),t.doubleClickTimeout=null,this._pointerState.delete(e),this.refreshHasPendingInputs()}}]),r}(sa),_y=function(e){Object(f.a)(r,e);var t=Object(p.a)(r);function r(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:my,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:yy,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:gy,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Oy,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:vy.a;return Object(c.a)(this,r),(e=t.call(this,!1)).maximumDoubleClickDelay=n,e.maximumDoubleClickDistance=i,e.maximumDoubleTouchDelay=a,e.maximumDoubleTouchDistance=o,e._clock=s,e._pointerState=new Map,e._immediateDoubleClick=e.registerOutgoing("immediate-double-click"),e.registerIncoming("pointer-down",e._handlePointerDown.bind(Object(u.a)(e))),e.registerIncoming("pointer-up",(function(t){e._handlePointerLoss(t,"pointer-up")})),e.registerIncoming("pointer-capture-lost",(function(t){e._handlePointerLoss(t,"pointer-capture-lost")})),e.registerIncoming("pointer-cancel",(function(t){e._handlePointerLoss(t,"pointer-cancel")})),e}return Object(l.a)(r,[{key:"onUninstall",value:function(){this._pointerState.forEach((function(e){e.immediateDoubleClick&&e.immediateDoubleClick.timeoutHandle.remove()})),Object(d.a)(Object(h.a)(r.prototype),"onUninstall",this).call(this)}},{key:"_handlePointerDown",value:function(e){var t=e.data,r=this._pointerId(t);if(!this._pointerState.has(r)){var n={downButton:t.native.button,immediateDoubleClick:null};this._pointerState.set(r,n),this.startCapturingPointer(t.native)}}},{key:"_handlePointerLoss",value:function(e,t){var r=e.data,n=this._pointerId(r),i=this._pointerState.get(n);if(i&&"pointer-up"===t&&i.downButton===r.native.button){var a=i.immediateDoubleClick;if(a){a.timeoutHandle.remove();var o="touch"===e.data.native.pointerType?this.maximumDoubleTouchDistance:this.maximumDoubleClickDistance;ly(a,e.data)>o?this._startImmediateDoubleClick(e,i):(this._immediateDoubleClick.emit(e.data,void 0,a.modifiers),this._removeState(r))}else this._startImmediateDoubleClick(e,i)}}},{key:"_startImmediateDoubleClick",value:function(e,t){var r=this,n="touch"===e.data.native.pointerType?this.maximumDoubleTouchDelay:this.maximumDoubleClickDelay;t.immediateDoubleClick={x:e.data.x,y:e.data.y,modifiers:e.modifiers,timeoutHandle:this._clock.setTimeout((function(){return r._removeState(e.data)}),n)}}},{key:"_pointerId",value:function(e){var t=e.native;return"mouse"===t.pointerType?"".concat(t.pointerId,":").concat(t.button):"".concat(t.pointerType)}},{key:"_removeState",value:function(e){var t=this._pointerId(e);this._pointerState.delete(t),this.stopCapturingPointer(e.native),this.refreshHasPendingInputs()}}]),r}(sa),wy=300,xy=1.5,ky=6,Sy=6,Ty=500,Cy=function(e){Object(f.a)(r,e);var t=Object(p.a)(r);function r(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:wy,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:xy,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:ky,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Sy,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Ty,l=arguments.length>5&&void 0!==arguments[5]?arguments[5]:vy.a;return Object(c.a)(this,r),(e=t.call(this,!1)).maximumClickDelay=n,e.movementUntilMouseDrag=i,e.movementUntilPenDrag=a,e.movementUntilTouchDrag=o,e.holdDelay=s,e._clock=l,e._pointerState=new Map,e._pointerDrag=e.registerOutgoing("pointer-drag"),e._immediateClick=e.registerOutgoing("immediate-click"),e._pointerHold=e.registerOutgoing("hold"),e.registerIncoming("pointer-down",e._handlePointerDown.bind(Object(u.a)(e))),e.registerIncoming("pointer-up",(function(t){e._handlePointerLoss(t,"pointer-up")})),e.registerIncoming("pointer-capture-lost",(function(t){e._handlePointerLoss(t,"pointer-capture-lost")})),e.registerIncoming("pointer-cancel",(function(t){e._handlePointerLoss(t,"pointer-cancel")})),e._moveHandle=e.registerIncoming("pointer-move",e._handlePointerMove.bind(Object(u.a)(e))),e._moveHandle.pause(),e}return Object(l.a)(r,[{key:"onUninstall",value:function(){this._pointerState.forEach((function(e){null!=e.holdTimeout&&(e.holdTimeout.remove(),e.holdTimeout=null)})),Object(d.a)(Object(h.a)(r.prototype),"onUninstall",this).call(this)}},{key:"_handlePointerDown",value:function(e){var t=this,r=e.data,n=r.native.pointerId,i=null;0===this._pointerState.size&&(i=this._clock.setTimeout((function(){var r=t._pointerState.get(n);if(r){if(!r.isDragging){var i=r.previousEvent;t._pointerHold.emit(i,void 0,e.modifiers),r.holdEmitted=!0}r.holdTimeout=null}}),this.holdDelay));var a={startEvent:r,previousEvent:r,startTimestamp:e.timestamp,isDragging:!1,downButton:r.native.button,holdTimeout:i,modifiers:new Set};this._pointerState.set(n,a),this.startCapturingPointer(r.native),this._moveHandle.resume(),this._pointerState.size>1&&this.startDragging(e)}},{key:"_createPointerDragData",value:function(e,t,r){return{action:e,startEvent:t.startEvent,previousEvent:t.previousEvent,currentEvent:r}}},{key:"_handlePointerMove",value:function(e){var t=e.data,r=t.native.pointerId,n=this._pointerState.get(r);n&&(n.isDragging?this._pointerDrag.emit(this._createPointerDragData("update",n,t),void 0,n.modifiers):function(e,t){var r=t.x-e.x,n=t.y-e.y;return Math.sqrt(r*r+n*n)}(t,n.startEvent)>this._getDragThreshold(t.native.pointerType)&&this.startDragging(e),n.previousEvent=t)}},{key:"_getDragThreshold",value:function(e){switch(e){case"touch":return this.movementUntilTouchDrag;case"pen":return this.movementUntilPenDrag;case"mouse":default:return this.movementUntilMouseDrag}}},{key:"startDragging",value:function(e){var t=this,r=e.data,n=r.native.pointerId;this._pointerState.forEach((function(i){null!=i.holdTimeout&&(i.holdTimeout.remove(),i.holdTimeout=null),i.isDragging||(i.modifiers=e.modifiers,i.isDragging=!0,n===i.startEvent.native.pointerId?t._pointerDrag.emit(t._createPointerDragData("start",i,r)):t._pointerDrag.emit(t._createPointerDragData("start",i,i.previousEvent),e.timestamp))}))}},{key:"_handlePointerLoss",value:function(e,t){var r=e.data,n=r.native.pointerId,i=this._pointerState.get(n);i&&(null!=i.holdTimeout&&(i.holdTimeout.remove(),i.holdTimeout=null),i.isDragging?this._pointerDrag.emit(this._createPointerDragData("end",i,"pointer-up"===t?r:i.previousEvent),void 0,i.modifiers):"pointer-up"===t&&i.downButton===r.native.button&&e.timestamp-i.startTimestamp<=this.maximumClickDelay&&!i.holdEmitted&&this._immediateClick.emit(r),this._pointerState.delete(n),this.stopCapturingPointer(r.native),0===this._pointerState.size&&this._moveHandle.pause())}}]),r}(sa),My=function(){function e(t){Object(c.a)(this,e),this.callbacks=t,this.currentCount=0,this.callbacks.condition||(this.callbacks.condition=function(){return!0})}return Object(l.a)(e,[{key:"handle",value:function(e){var t=e.data,r=t.pointers.size;switch(t.action){case"start":this.currentCount=r,this.emitStart(e);break;case"added":this.emitEnd(this.previousEvent),this.currentCount=r,this.emitStart(e);break;case"update":this.emitUpdate(e);break;case"removed":this.startEvent&&this.emitEnd(this.previousEvent),this.currentCount=r,this.emitStart(e);break;case"end":this.emitEnd(e),this.currentCount=0}this.previousEvent=e}},{key:"emitStart",value:function(e){this.startEvent=e,this.callbacks.condition(this.currentCount,e)&&this.callbacks.start(this.currentCount,e,this.startEvent)}},{key:"emitUpdate",value:function(e){this.callbacks.condition(this.currentCount,e)&&this.callbacks.update(this.currentCount,e,this.startEvent)}},{key:"emitEnd",value:function(e){this.callbacks.condition(this.currentCount,e)&&this.callbacks.end(this.currentCount,e,this.startEvent),this.startEvent=null}}]),e}(),Py=function(e){Object(f.a)(r,e);var t=Object(p.a)(r);function r(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:20,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:40;return Object(c.a)(this,r),(e=t.call(this,!1))._threshold=n,e._maxDelta=i,e.state="ready",e.emittedArtificalEnd2=!1,e._vertical=e.registerOutgoing("vertical-two-finger-drag"),e._artificalDrag=e.registerOutgoing("drag"),e.dragEventSeparator=new My({start:function(t,r){return e.observeStart(t,r)},update:function(t,r,n){return e.observeUpdate(t,r,n)},end:function(t,r){return e.observeEnd(r)}}),e.registerIncoming("drag",(function(t){return e.dragEventSeparator.handle(t)})),e}return Object(l.a)(r,[{key:"failed",get:function(){return"failed"===this.state}},{key:"observeStart",value:function(e,t){1===e&&this.emittedArtificalEnd2&&(this.emittedArtificalEnd2=!1,this._artificalDrag.emit({action:"start",button:t.data.button,buttons:t.data.buttons,pointerType:t.data.pointerType,timestamp:t.data.timestamp,pointers:t.data.pointers,pointer:t.data.pointer,angle:t.data.angle,radius:t.data.radius,center:t.data.center}),t.stopPropagation()),this.state=2===e?"ready":"failed"}},{key:"observeUpdate",value:function(e,t,r){if("failed"!==this.state&&2===e)return"active"===this.state?(this._vertical.emit({delta:t.data.center.y-this._thresholdReachedCenter.y,action:"update"}),void t.stopPropagation()):void(this.checkMovementWithinLimits(t.data,r.data)?this.checkVerticalThresholdReached(t.data,r.data)&&(this.state="active",this.emittedArtificalEnd2=!0,this._thresholdReachedCenter=t.data.center,this._artificalDrag.emit({action:"end",button:t.data.button,buttons:t.data.buttons,pointerType:t.data.pointerType,timestamp:t.data.timestamp,pointers:t.data.pointers,pointer:t.data.pointer,angle:t.data.angle,radius:t.data.radius,center:t.data.center}),this._vertical.emit({delta:t.data.center.y-this._thresholdReachedCenter.y,action:"begin"}),t.stopPropagation()):this.state="failed")}},{key:"observeEnd",value:function(e){"active"===this.state&&(this._vertical.emit({delta:e.data.center.y-this._thresholdReachedCenter.y,action:"end"}),this.state="ready",e.stopPropagation())}},{key:"checkMovementWithinLimits",value:function(e,t){var r=-1/0,n=1/0,i=-1/0,a=1/0;t.pointers.forEach((function(e){r=Math.max(r,e.x),n=Math.min(n,e.x),i=Math.max(i,e.y),a=Math.min(a,e.y)}));var o=-1/0,s=1/0,c=-1/0,l=1/0;e.pointers.forEach((function(e){o=Math.max(o,e.x),s=Math.min(s,e.x),c=Math.max(c,e.y),l=Math.min(l,e.y)}));var u=r-n,d=i-a,h=o-s,f=c-l;return Math.abs(e.center.x-t.center.x)<this._threshold&&Math.abs(h-u)<=this._maxDelta&&Math.abs(f-d)<=this._maxDelta}},{key:"checkVerticalThresholdReached",value:function(e,t){var r=Math.abs(e.center.y-t.center.y);return e.pointers.forEach((function(e,n){var i=t.pointers.get(n);r=Math.min(r,Math.abs(e.y-i.y))})),r>=this._threshold}}]),r}(sa),Ay=function(e){Object(f.a)(r,e);var t=Object(p.a)(r);function r(){var e;return Object(c.a)(this,r),(e=t.apply(this,arguments))._handles=new oe.a,e}return Object(l.a)(r,[{key:"destroy",value:function(){this._handles&&(this._handles.removeAll(),this._handles=null),this.disconnect()}},{key:"primaryDragAction",get:function(){return this._get("primaryDragAction")},set:function(e){"pan"!==e&&"rotate"!==e||e===this._get("primaryDragAction")||(this._set("primaryDragAction",e),this._updateMode())}},{key:"mode",get:function(){return this._get("mode")},set:function(e){"default"!==e&&"pro"!==e||e===this._get("mode")||(this._set("mode",e),this._updateMode())}},{key:"disconnect",value:function(){this.view.viewEvents.disconnect(),this._inputManager&&(this._inputManager.destroy(),this._inputManager=null),this._source&&(this._source.destroy(),this._source=null)}},{key:"connect",value:function(){var e=this,t=this.view;this._source=new oy(this.view.surface,t.input);var r=[new _y,new Cy,new jy,new dy(this.view.navigation),new Py],n=new ha({eventSource:this._source,recognizers:r});this._inputManager=n,n.installHandlers("prevent-context-menu",[new cy],pa.INTERNAL),this._modeDragPan=new Hm(t,"primary"),this._modeDragRotate=new Qb(t,"secondary",0),this._modeDragZoom=new Jb(t,"tertiary");var i="b",a={left:"ArrowLeft",right:"ArrowRight",forward:"ArrowUp",backward:"ArrowDown",up:"u",down:"j",headingLeft:"a",headingRight:"d",tiltUp:"w",tiltDown:"s",zoomIn:"+",zoomOut:"-"},o="n",s="p";n.installHandlers("navigation",[new Wm(t),new Gb(t),new vm(t),new mm(t,a),new ym(t),new Xm(t,s),new Zm(t,o),new Qb(t,"primary",1,[i]),new Qb(t,"secondary",0,[i]),new Hm(t,"tertiary",[i]),this._modeDragRotate,this._modeDragZoom,this._modeDragPan,new Ym(t)],pa.INTERNAL),this.view.viewEvents.connect(n),this._updateMode(),Object(W.a)(this.view.navigation,"browserTouchPanEnabled",(function(t){e._source.browserTouchPanningEnabled=!t}))}},{key:"_updateMode",value:function(){var e=this.mode,t=this.primaryDragAction,r=Ey.get(e).get(t);this._modeDragPan&&(this._modeDragPan.pointerAction=r.pan),this._modeDragRotate&&(this._modeDragRotate.pointerAction=r.rotate),this._modeDragZoom&&(this._modeDragZoom.pointerAction=r.zoom)}},{key:"test",get:function(){return{inputManager:this._inputManager,modeDragPan:this._modeDragPan,modeDragRotate:this._modeDragRotate,modeDragZoom:this._modeDragZoom}}}]),r}(de.a);Object(b.a)([Object(y.b)()],Ay.prototype,"view",void 0),Object(b.a)([Object(y.b)({value:"pan"})],Ay.prototype,"primaryDragAction",null),Object(b.a)([Object(y.b)({value:"default"})],Ay.prototype,"mode",null),Object(b.a)([Object(y.b)({readOnly:!0,aliasOf:"_inputManager.hasPendingInputs"})],Ay.prototype,"hasPendingInputs",void 0),Object(b.a)([Object(y.b)({readOnly:!0,aliasOf:"_inputManager.latestPointerType"})],Ay.prototype,"latestPointerType",void 0),Object(b.a)([Object(y.b)()],Ay.prototype,"_inputManager",void 0),Ay=Object(b.a)([Object(w.a)("esri.views.3d.input.SceneInputManager")],Ay);var Ey=new Map,Ry=new Map,Iy=new Map;Ry.set("pan",{pan:"primary",rotate:"secondary",zoom:"tertiary"}),Ry.set("rotate",{pan:"secondary",rotate:"primary",zoom:"tertiary"}),Iy.set("pan",{pan:"primary",rotate:"tertiary",zoom:"secondary"}),Iy.set("rotate",{pan:"tertiary",rotate:"primary",zoom:"secondary"}),Ey.set("default",Ry),Ey.set("pro",Iy);var Dy,Fy,Ly=Ay,zy=r(74),Vy=r(84),Ny=!1,Uy=!1,By=!1,Gy=!1,qy=null;function Hy(e){By=Vy.a.DECONFLICTOR_SHOW_VISIBLE,Gy=Vy.a.DECONFLICTOR_SHOW_INVISIBLE,Ny=By||Gy,Uy=Vy.a.DECONFLICTOR_SHOW_GRID,qy=null,Ny||Uy?qy=function(){return function(e){null==Dy&&((Dy=document.createElement("canvas")).setAttribute("id","canvas2d"),e.surface.parentElement.style.position="relative",e.surface.parentElement.appendChild(Dy));var t=e.width*e.pixelRatio,r=e.height*e.pixelRatio;Dy.setAttribute("width","".concat(t,"px")),Dy.setAttribute("height","".concat(r,"px")),Dy.setAttribute("style","position:absolute;left:0px;top:0px;display:block;pointer-events:none;width:".concat(e.width,"px;height:").concat(e.height,"px")),(Fy=Dy.getContext("2d")).clearRect(0,0,e.width,e.height),Fy.font="12px Arial"}(e)}:Dy&&(Dy.parentElement.removeChild(Dy),Dy=null)}function Wy(){qy&&(qy(),qy=null)}function Qy(e,t,r,n,i){Wy();var a=Dy.height,o=Fy;o.beginPath(),o.lineWidth=1,o.strokeStyle=i,o.moveTo(e,a-r),o.lineTo(t,a-r),o.stroke(),o.lineTo(t,a-n),o.stroke(),o.lineTo(t,a-r),o.stroke(),o.lineTo(e,a-r),o.stroke(),o.lineTo(e,a-r),o.stroke(),o.closePath()}function Zy(e,t){Ny&&(t&&By||!t&&Gy)&&Qy(e.aabr[0],e.aabr[2],e.aabr[1],e.aabr[3],t?"green":"red")}var Xy=r(230),Yy=r(295),$y=o.a.mark(bg),Jy=o.a.mark(vg),Ky=Object(X.e)(),eg=Object($l.e)(),tg=Object($l.e)(),rg=Object(X.e)(),ng=Object(Kl.d)(),ig=Object(Nd.c)(),ag=Object(Ud.c)(),og=Object(X.e)(),sg=Object(K.k)(),cg=function e(){Object(c.a)(this,e),this.aabr=Object(K.k)(),this.distance=0,this.culled=!1,this.visible=!1},lg=function e(t,r){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};Object(c.a)(this,e),this.graphics3DGraphic=t,this.slicePlaneEnabled=r,this.info=n},ug=function(){function e(){Object(c.a)(this,e),this.active=new Map,this.visible=new Map}return Object(l.a)(e,[{key:"clear",value:function(){this.active.clear(),this.visible.clear()}}]),e}(),dg=function e(){Object(c.a)(this,e)},hg=function e(){Object(c.a)(this,e),this.sortArray=new zy.a({allocator:function(e){return e||new dg}})},fg=function(){function e(){Object(c.a)(this,e),this.camera=new zf.a,this.slicePlane=Object(ee.b)(),this.slicePlaneEnabled=!1}return Object(l.a)(e,[{key:"copyFrom",value:function(e){this.camera.copyFrom(e.camera),Object(ee.d)(e.slicePlane,this.slicePlane),this.slicePlaneEnabled=e.slicePlaneEnabled}}]),e}(),pg=function(e){Object(f.a)(r,e);var t=Object(p.a)(r);function r(){var e;return Object(c.a)(this,r),(e=t.apply(this,arguments))._dirty=!1,e._runningViewState=new fg,e._state=0,e.graphics=new ug,e.iterators=new hg,e.accBinsNumX=15,e.accBinsNumY=20,e.accBinsSizeX=0,e.accBinsSizeY=0,e.accBins=null,e.accNumTests=0,e}return Object(l.a)(r,[{key:"dirty",get:function(){return this._dirty}},{key:"state",get:function(){return this._state}},{key:"destroy",value:function(){this.graphics.clear(),this.iterators=null}},{key:"setDirty",value:function(){!this._dirty&&this.graphics.active.size>0&&(this._dirty=!0,this.notifyChange("updating"))}},{key:"updating",get:function(){return 0!==this._state||this._dirty}},{key:"updatingProgress",get:function(){if(!this.updating)return 1;var e=this._state/4;return this._dirty?.5*e:e}},{key:"running",get:function(){return this.view.ready&&null!=this.view.state&&this.updating}},{key:"runTask",value:function(e){switch(this._state){case 0:this.startUpdate(),e.madeProgress();case 1:if(this._state=1,!this.processActiveGraphics(e))return;case 2:if(this._state=2,!this.sortVisibleGraphics(e))return;case 3:if(this._state=3,!this.deconflictVisibleGraphics(e))return;default:(function(e,t){if(Uy&&Fy){Wy();for(var r=Fy,n=0,i=0;i<e.accBinsNumX;i++)for(var a=0;a<e.accBinsNumY;a++){var o=e.accBins[i][e.accBinsNumY-1-a];n+=o.length;var s=i*e.accBinsSizeX,c=(i+1)*e.accBinsSizeX,l=a*e.accBinsSizeY,u=(a+1)*e.accBinsSizeY;r.fillText(o.length.toFixed(),s+5,l+15),Qy(s,c,l,u,"blue")}r.fillText("total totalShownLabels: "+n,70,40),r.fillText("total visible labels: "+t.size,70,50),r.fillText("total numTests: "+e.accNumTests,70,30)}})(this,this.graphics.visible),this._state=0,this.notifyChange("updating")}}},{key:"modifyGraphics",value:function(e,t){var r=this;t?e.forEach((function(e){return r.addToActiveGraphics(e)})):e.forEach((function(e){return r.removeFromActiveGraphics(e)})),this.setDirty()}},{key:"layerSupportsDeconfliction",value:function(e){if(Object(I.i)(e)||"object3d"!==e.type)return!1;var t=e.stageObject;return 1===(t?t.getNumGeometryRecords():0)&&t.getGeometryRecord(0).material instanceof Yy.a}},{key:"startUpdate",value:function(){Hy(this.view),this._dirty=!1,this._runningViewState.copyFrom(this.viewState);var e=this._runningViewState.camera,t=e.fullWidth,r=e.fullHeight;this.initBins(t,r),this.resetIterators()}},{key:"addToActiveGraphics",value:function(e){e.info[this.visibilityGroup]=new cg,this.graphics.active.set(e.graphics3DGraphic.graphic.uid,e),this.setDirty()}},{key:"removeFromActiveGraphics",value:function(e){this.removeFromVisibleGraphics(e),function(e,t){var r=e.graphics3DGraphic;r.destroyed||r.clearVisibilityFlag(3,t)}(e,this.visibilityGroup),delete e.info[this.visibilityGroup],this.graphics.active.delete(e.graphics3DGraphic.graphic.uid),this.setDirty()}},{key:"addToVisibleGraphics",value:function(e){this.graphics.visible.set(e.graphics3DGraphic.graphic.uid,e)}},{key:"removeFromVisibleGraphics",value:function(e){this.graphics.visible.delete(e.graphics3DGraphic.graphic.uid)}},{key:"processActiveGraphics",value:function(e){var t=this.ensureActiveGraphicsIterator(),r=Object(Jl.a)(ng,this._runningViewState.camera.projectionMatrix),n="global"===this.view.viewingMode&&1===this.view.map.ground.opacity&&this._runningViewState.camera.relativeElevation>0?ig:null,i=0;for(Object(I.j)(n)&&(Object(Yl.s)(n,X.b,this._runningViewState.camera.viewMatrix),n[3]=Object(J.e)(this.view.spatialReference).radius,i=Object(Nd.d)(n,X.b));!e.done;){e.madeProgress();var a=t.next();if(a.done)return this.resetActiveGraphicsIterator(),!0;var o=a.value,s=o&&o.info[this.visibilityGroup];s&&(this.collectGraphics3DGraphics(o,r,n,i),s.culled?this.removeFromVisibleGraphics(o):this.addToVisibleGraphics(o))}return!1}},{key:"sortVisibleGraphics",value:function(e){for(var t=this.ensureSortGraphicsIterator();!e.done;){var r=t.next();if(e.madeProgress(),r.done)return this.resetSortGraphicsIterator(),!0}return!1}},{key:"deconflictVisibleGraphics",value:function(e){for(var t=this.ensureVisibleGraphicsIterator(),r=1===this.visibilityGroup;!e.done;){e.madeProgress();var n=t.next();if(n.done)return this.resetVisibleGraphicsIterator(),!0;var i=n.value,a=i.info[this.visibilityGroup];if(a&&!a.culled){var o=i.graphics3DGraphic,s=(!r||o.isVisible())&&!this.isConflicted(i);s&&this.addToBins(i),a.visible=s,this.setGraphicVisibility(i,s),Zy(a,s)}}return!1}},{key:"resetIterators",value:function(){this.iterators.active=null,this.iterators.visible=null,this.iterators.sort=null}},{key:"ensureActiveGraphicsIterator",value:function(){return this.iterators.active||(this.iterators.active=bg(this.graphics.active)),this.iterators.active}},{key:"resetActiveGraphicsIterator",value:function(){this.iterators.active=null}},{key:"ensureVisibleGraphicsIterator",value:function(){return this.iterators.visible||(this.iterators.visible=bg(this.graphics.visible)),this.iterators.visible}},{key:"resetVisibleGraphicsIterator",value:function(){this.iterators.visible=null}},{key:"ensureSortGraphicsIterator",value:function(){return this.iterators.sort||(this.iterators.sort=vg(this.graphics.visible,this.iterators.sortArray,this.visibilityGroup)),this.iterators.sort}},{key:"resetSortGraphicsIterator",value:function(){this.iterators.sort=null}},{key:"collectGraphics3DGraphics",value:function(e,t,r,n){var a=e.graphics3DGraphic;if(!a.destroyed){var o=e.info[this.visibilityGroup];if(a.isVisible(0,3)){var s=this.getGraphicsLayers(a);Object(K.m)(o.aabr);var c,l=null,u=Object(i.a)(s);try{for(u.s();!(c=u.n()).done;){var d=c.value;if(this.layerSupportsDeconfliction(d)){var h=d.stageObject.getGeometryRecord(0).material;if(Object(I.i)(l)){if((l=this.getProjectionInfo(d,t,yg)).isOutsideScreen||this.isCulledBySlice(e,Ky)||Object(I.j)(r)&&this.isCulledByHorizon(l,r,n))return void(o.culled=!0);!Vy.a.DISABLE_DECONFLICTOR_VISIBILITY_OFFSET&&o.visible&&(l.distance*=.7)}this.expandBoundingRect(o,d,h,l)}}}catch(f){u.e(f)}finally{u.f()}Object(I.i)(l)?o.culled=!0:(o.distance=l.distance,o.culled=!1)}else o.culled=!0}}},{key:"getProjectionInfo",value:function(e,t,r){var n=this._runningViewState.camera,i=e.stageObject,a=i.getGeometryRecord(0),o=a.material,s=Object(Nd.g)(i.boundingVolumeWorldSpace.bounds);Object(Yl.s)(Ky,s,n.viewMatrix);var c=a.geometry.vertexAttributes,l=c.get("normal").data,u=c.get("auxpos1").data;return o.applyShaderOffsetsView(Ky,l,i.transformation,u,n,r.scaleInfo,Ky),Object(Su.l)(eg,Ky[0],Ky[1],Ky[2],1),Object(Su.m)(tg,eg,n.projectionMatrix),Object(Yl.g)(r.positionNDC,tg,1/tg[3]),o.applyShaderOffsetsNDC(r.positionNDC,u,n,r.positionNDC,rg),r.distanceWithoutPolygonOffset=n.depthNDCToWorld(rg[2]),r.distance=rg[2]===r.positionNDC[2]?r.distanceWithoutPolygonOffset:n.depthNDCToWorld(r.positionNDC[2]),Object(Su.l)(tg,r.positionNDC[0],r.positionNDC[1],r.positionNDC[2],1),Object(Su.m)(eg,tg,t),Object(Su.b)(eg,eg,1/eg[3]),Object(Yl.y)(r.positionView,Ky[0],Ky[1],Ky[2]),r}},{key:"isCulledByHorizon",value:function(e,t,r){return Object(Yl.m)(ag.direction,e.positionView),Object(Yl.y)(ag.origin,0,0,0),!!Object(Nd.i)(t,ag,og)&&e.distanceWithoutPolygonOffset>r}},{key:"isCulledBySlice",value:function(e,t){return e.slicePlaneEnabled&&this._runningViewState.slicePlaneEnabled&&Object(ee.f)(this._runningViewState.slicePlane,t)}},{key:"expandBoundingRect",value:function(e,t,r,n){var i=n.positionNDC,a=n.scaleInfo,o=this._runningViewState.camera,s=t.getScreenSize(mg);Object(Xy.a)(s,a.factor,s),s[0]*=o.pixelRatio,s[1]*=o.pixelRatio;var c=Object(K.x)(r.calculateRelativeScreenBounds(s,a.factorAlignment.scale,sg),Object(m.m)(0,o.fullWidth,.5+.5*i[0]),Object(m.m)(0,o.fullHeight,.5+.5*i[1])),l=this.iconMarginFactor;if(0!==l){var u=l*Math.min(Object(K.A)(c),Object(K.t)(c));c[0]-=u,c[1]-=u,c[2]+=u,c[3]+=u}Object(K.o)(e.aabr,c)}},{key:"isConflicted",value:function(e){for(var t=e.graphics3DGraphic.graphic.uid,r=e.info[this.visibilityGroup],n=Math.floor(r.aabr[0]/this.accBinsSizeX);n<=Math.floor(r.aabr[2]/this.accBinsSizeX);n++)if(!(n<0||n>=this.accBinsNumX))for(var i=Math.floor(r.aabr[1]/this.accBinsSizeY);i<=Math.floor(r.aabr[3]/this.accBinsSizeY);i++)if(!(i<0||i>=this.accBinsNumY))for(var a=this.accBins[n][i],o=0;o<a.length;o++){var s=a.data[o],c=s.info[this.visibilityGroup];if(c&&c.visible&&s.graphics3DGraphic.graphic.uid!==t&&(this.accNumTests++,Object(K.v)(c.aabr,r.aabr)))return!0}return!1}},{key:"initBins",value:function(e,t){if(null==this.accBins){this.accBins=[];for(var r=0;r<this.accBinsNumX;r++){this.accBins.push([]);for(var n=this.accBins[this.accBins.length-1],i=0;i<this.accBinsNumY;i++)n.push(new zy.a)}}else for(var a=0;a<this.accBinsNumX;a++)for(var o=0;o<this.accBinsNumY;o++)this.accBins[a][o].clear();this.accBinsSizeX=e/this.accBinsNumX,this.accBinsSizeY=t/this.accBinsNumY,this.accNumTests=0}},{key:"addToBins",value:function(e){for(var t=e.info[this.visibilityGroup],r=Math.floor(t.aabr[0]/this.accBinsSizeX),n=Math.floor(t.aabr[2]/this.accBinsSizeX),i=Math.floor(t.aabr[1]/this.accBinsSizeY),a=Math.floor(t.aabr[3]/this.accBinsSizeY),o=r;o<=n;o++)if(!(o<0||o>=this.accBinsNumX))for(var s=i;s<=a;s++)s<0||s>=this.accBinsNumY||this.accBins[o][s].push(e)}},{key:"setGraphicVisibility",value:function(e,t){var r=e.graphics3DGraphic;r.destroyed||(r.setVisibilityFlag(3,t,this.visibilityGroup),1===this.visibilityGroup&&this.view.labeler.setLabelGraphicVisibility(r,t))}}]),r}(de.a);function bg(e){var t,r;return o.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!Map.prototype.entries){n.next=11;break}t=e.entries(),r=t.next();case 3:if(r.done){n.next=9;break}return n.next=6,r.value[1];case 6:r=t.next(),n.next=3;break;case 9:n.next=12;break;case 11:return n.delegateYield(e.values(),"t0",12);case 12:case"end":return n.stop()}}),$y)}function vg(e,t,r){var n,i;return o.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return t.clear(),e.forEach((function(e,n){var i=t.pushNew();i.id=n,i.prio=e.info?-e.info[r].distance:Number.MAX_VALUE})),void(a.next=4);case 4:n=t.iterableSort((function(e,t){return t.prio-e.prio})),i=n.next();case 6:if(i.done){a.next=12;break}return void(a.next=9);case 9:i=n.next(),a.next=6;break;case 12:t.forAll((function(t){var r=e.get(t.id);r&&(e.delete(t.id),e.set(t.id,r))})),t.clear();case 13:case"end":return a.stop()}}),Jy)}Object(b.a)([Object(y.b)({constructOnly:!0})],pg.prototype,"view",void 0),Object(b.a)([Object(y.b)({type:Boolean,readOnly:!0})],pg.prototype,"updating",null),pg=Object(b.a)([Object(w.a)("esri.views.3d.layers.graphics.Deconflictor")],pg);var mg=Object(ku.b)(),yg=new(function(){function e(){Object(c.a)(this,e),this.positionView=Object(X.e)(),this.positionNDC=Object(X.e)(),this.distance=0,this.distanceWithoutPolygonOffset=0,this.scaleInfo={factor:{scale:0,factor:0,minPixelSize:0,paddingPixels:0},factorAlignment:{scale:0,factor:0,minPixelSize:0,paddingPixels:0}}}return Object(l.a)(e,[{key:"isOutsideScreen",get:function(){var e=this.positionNDC;return e[0]<-1||e[1]<-1||e[2]<-1||e[0]>=1||e[1]>=1}}]),e}()),gg=function(e){Object(f.a)(r,e);var t=Object(p.a)(r);function r(){var e;return Object(c.a)(this,r),(e=t.apply(this,arguments)).visibilityGroup=1,e.iconMarginFactor=0,e._lastDeconfliction=0,e}return Object(l.a)(r,[{key:"viewState",get:function(){return this.parent.viewState}},{key:"runTask",value:function(e){if(!this.parent.running){var t=performance.now();(2===e.state||t-this._lastDeconfliction>2e3)&&(Object(d.a)(Object(h.a)(r.prototype),"runTask",this).call(this,e),0===this.state&&(this._lastDeconfliction=t))}}},{key:"enabledChanged",value:function(e,t){this.modifyGraphics(t,e.labelsEnabled)}},{key:"getGraphicsLayers",value:function(e){return e.labelGraphics}}]),r}(pg);Object(b.a)([Object(y.b)({constructOnly:!0})],gg.prototype,"parent",void 0),gg=Object(b.a)([Object(w.a)("esri.views.3d.layers.graphics.LabelDeconflictor")],gg);var Og=r(97),jg=function(e){Object(f.a)(r,e);var t=Object(p.a)(r);function r(){var e;return Object(c.a)(this,r),(e=t.apply(this,arguments))._handles=new oe.a,e._contexts=new Map,e._viewState=new fg,e.visibilityGroup=0,e._iconMarginFactor=-.1,e}return Object(l.a)(r,[{key:"labels",get:function(){return this._labels}},{key:"viewState",get:function(){return this._viewState}},{key:"initialize",value:function(){var e=this;this._handles.add([this.view.watch("state.camera",(function(){e.updateViewState(),e.setDirty()})),this.view.watch("map.ground.opacity",(function(t,r){1!==t&&1!==r||e.setDirty()})),Object(W.a)(this.view,"slicePlane",(function(){e.updateSlicePlane(),e.slicePlaneChanged()}))]),this._frameTask=this.view.resourceController.scheduler.registerTask(Og.b.GRAPHICS_DECONFLICTOR,this),this._labels=new gg({view:this.view,parent:this})}},{key:"destroy",value:function(){this._labels.destroy(),this._labels=null,this._handles.destroy(),this._handles=null,this._frameTask&&(this._frameTask.remove(),this._frameTask=null)}},{key:"iconMarginFactor",get:function(){return this._iconMarginFactor},set:function(e){this._iconMarginFactor=e,this.setDirty()}},{key:"setDirty",value:function(){this._contexts.size>0&&(Object(d.a)(Object(h.a)(r.prototype),"setDirty",this).call(this),this._labels.setDirty())}},{key:"runTask",value:function(e){Object(d.a)(Object(h.a)(r.prototype),"runTask",this).call(this,e),this.running||this._labels.setDirty()}},{key:"setInitialIconVisibilityFlag",value:function(e,t){var r=!(this._graphicSupportsDeconfliction(t)&&_g(e));t.setVisibilityFlag(3,r,0)}},{key:"updateViewState",value:function(){this.view&&this.view.state&&(this._viewState.camera.copyFrom(this.view.state.camera),this.updateSlicePlane())}},{key:"updateSlicePlane",value:function(){var e=this.view?this.view.slicePlane:null;Object(I.j)(e)&&Object(ee.k)(e,this._viewState.camera.viewMatrix,this._viewState.slicePlane),this._viewState.slicePlaneEnabled=Object(I.j)(e)}},{key:"slicePlaneChanged",value:function(){Object(Qs.b)(this._contexts,(function(e,t){return t.symbolCreationContext.slicePlaneEnabled}))&&this.setDirty()}},{key:"addGraphicsOwner",value:function(e){var t=this,r=this._contexts.get(e);return null==r&&(r=new Map,this._contexts.set(e,r),this.setDirty()),{addGraphic:function(n){return t.addGraphic(e,r,n)},removeGraphic:function(e){return t.removeGraphic(r,e)},labelingInfoChange:function(){return t._labels.enabledChanged(e,r)},featureReductionChange:function(){return t.enabledChanged(e,r)},slicePlaneEnabledChange:function(){return t._slicePlaneEnabledChanged(e,r)},clear:function(){return r.forEach((function(e){return t.removeGraphic(r,e.graphics3DGraphic)}))}}}},{key:"removeGraphicsOwner",value:function(e){var t=this,r=this._contexts.get(e);r&&(r.forEach((function(e){return t.removeGraphic(r,e.graphics3DGraphic)})),this._contexts.delete(e),this.setDirty())}},{key:"addGraphic",value:function(e,t,r){var n=r.graphic.uid,i=new lg(r,e.symbolCreationContext.slicePlaneEnabled);t.set(n,i),_g(e)&&this.addToActiveGraphics(i),e.labelsEnabled&&this._labels.addToActiveGraphics(i)}},{key:"removeGraphic",value:function(e,t){var r=t.graphic.uid,n=e.get(r);n&&(this.removeFromActiveGraphics(n),this._labels.removeFromActiveGraphics(n),e.delete(r),this.setDirty())}},{key:"enabledChanged",value:function(e,t){var r=_g(e);r||function(e){var t=e.graphics3DGraphics;t&&t.forEach((function(e){return e.clearVisibilityFlag(3)}))}(e),this.modifyGraphics(t,r)}},{key:"_slicePlaneEnabledChanged",value:function(e,t){var r=e.symbolCreationContext.slicePlaneEnabled;t.forEach((function(e){return e.slicePlaneEnabled=r})),this.setDirty()}},{key:"getGraphicsLayers",value:function(e){return e._graphics}},{key:"_graphicSupportsDeconfliction",value:function(e){if(e.isDraped)return!1;var t=e._graphics;if(!t||!t.length)return!1;var r,n=Object(i.a)(t);try{for(n.s();!(r=n.n()).done;){var a=r.value;if(this.layerSupportsDeconfliction(a))return!0}}catch(o){n.e(o)}finally{n.f()}return!1}}]),r}(pg);function _g(e){var t=e.layer;return!(!t||!t.featureReduction||"selection"!==t.featureReduction.type)}jg=Object(b.a)([Object(w.a)("esri.views.3d.layers.graphics.GraphicsDeconflictor")],jg);var wg=r(128),xg=r(342),kg=r(678),Sg=r(229),Tg=r(674),Cg=r(652),Mg=r(634),Pg=r(656);function Ag(e){return e instanceof Pg.a?e.graphics3DSymbol:e instanceof Mg.a?e:null}var Eg=r(34),Rg=j.a.getLogger("esri.views.3d.layers.graphics.labelPlacement");function Ig(e){var t=function(e){var t=e.labelClass.labelPlacement,r=e.labelSymbol,n=e.graphics3DGraphic,i=Ag(n.graphics3DSymbol),a=Object(I.j)(i)?i.symbol:null,o=Ng[t]||Lg(e);return"point-3d"===a.type&&a.supportsCallout()&&a.hasVisibleVerticalOffset()&&!n.isDraped?{placement:null,hasLabelVerticalOffset:!1,verticalOffset:Vg(a.verticalOffset),anchor:null,normalizedOffset:null}:!r||!r.hasVisibleVerticalOffset()||"point-3d"===a.type&&a.supportsCallout()&&a.verticalOffset&&!n.isDraped?{placement:null,verticalOffset:null,anchor:null,normalizedOffset:null,hasLabelVerticalOffset:!1}:function(e){switch(e){case"above-center":return!0;default:return!1}}(o.placement)?{placement:"above-center",verticalOffset:Vg(r.verticalOffset),anchor:"bottom",normalizedOffset:[0,o.normalizedOffset[1],0],hasLabelVerticalOffset:!0}:(Rg.errorOncePerTick("Callouts and vertical offset on labels are currently only supported with 'above-center' label placement (not with "+t+" placement)"),null)}(e);if(Object(I.i)(t))return null;var r=function(e,t){if(t.anchor)return t;var r=e.labelClass.labelPlacement,n=Ng[r],i=n||Lg(e);return r&&!n&&Rg.warnOncePerTick("the requested label placement '".concat(r,"' is not currently supported in SceneView")),function(e,t){var r=t.graphics3DGraphic.graphic.geometry;if(Object(I.i)(r))return null;if(Object(I.j)(t.disablePlacement))return t.labelClass.labelPlacement?(Rg.warnOncePerTick(Fg(e.placement,t.disablePlacement.logEntityDescription)),Lg(t)):e;var n=r.type;switch(n){case"polyline":case"polygon":case"extent":case"multipoint":if(t.labelClass.labelPlacement)return Rg.warnOncePerTick(Fg(e.placement,"'".concat(n,"' geometries"))),Lg(t);break;case"point":case"mesh":return e}return e}(i,e)}(e,t);if(Object(I.i)(r))return null;var n=r.anchor,i=!!t.hasLabelVerticalOffset;return function(e,t,r){var n=r.graphics3DGraphic.graphic.geometry;if(Object(I.i)(n))return null;switch(n.type){case"point":!function(e,t,r){var n=Dg(r);if(Object(I.i)(n))return;var i=r.graphics3DGraphic._graphics[0];switch(Object(I.j)(i)?i.getCenterObjectSpace(e.translation):Object(Yl.y)(e.translation,0,0,0),n.type){case"icon":case"text":!function(e,t,r,n){var i=r.graphics3DGraphic,a=Object(I.j)(n)?n.getScreenSize():null;if(!i.isDraped&&Object(I.j)(a)){var o=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Wg,r=e.graphics3DGraphic._graphics[0],n=Object(I.j)(r)?r.stageObject.geometryRecords[0].material:null;if(n&&n instanceof Yy.a){var i=n.params.anchorPos;t[0]=2*(i[0]-.5),t[1]=2*(i[1]-.5)}else t[0]=0,t[1]=0;return t}(r);Hg[0]=a[0]/2*(t.normalizedOffset[0]-o[0]),Hg[1]=a[1]/2*(t.normalizedOffset[1]-o[1]),e.screenOffset[0]=Hg[0],e.hasLabelVerticalOffset?(e.centerOffset[1]=Hg[1],e.centerOffsetUnits="screen"):e.screenOffset[1]=Hg[1]}else e.hasLabelVerticalOffset||"center"===e.anchor||(Ng[r.labelClass.labelPlacement]&&Rg.warnOncePerTick("the requested placement '".concat(t.placement,"' is currently unsupported for draped graphics")),e.anchor="center")}(e,t,r,i);break;case"object":zg(e,t,i)}}(e,t,r);break;case"polygon":!function(e,t,r){var n=Dg(r);if(!Object(I.i)(n))switch(n.type){case"extrude":var i=r.graphics3DGraphic._graphics[0];Object(I.j)(i)?(i.getBoundingBoxObjectSpace(Qg),Object(Eg.e)(Qg,e.translation),e.translation[2]=Object(Eg.u)(Qg)/2):Object(Yl.y)(e.translation,0,0,0),zg(e,t,i)}}(e,t,r);break;case"mesh":zg(e,t,r.graphics3DGraphic._graphics[0])}return e}({anchor:n,verticalOffset:t.verticalOffset,screenOffset:Object(ku.b)(),centerOffset:Object($l.g)(0,0,0,-1),centerOffsetUnits:"world",translation:Object(X.e)(),elevationOffset:0,hasLabelVerticalOffset:i},r,e)}function Dg(e){var t=Ag(e.graphics3DGraphic.graphics3DSymbol);return Object(I.j)(t)?t.symbol.symbolLayers.getItemAt(0):null}function Fg(e,t){return"the requested label placement '".concat(e,"' is currently unsupported for ").concat(t," in SceneView")}function Lg(e){var t=e.graphics3DGraphic.graphic.geometry;if(Object(I.i)(t))return null;switch(t.type){case"polyline":case"extent":case"multipoint":return{placement:"center-center",normalizedOffset:null,anchor:"center"};case"polygon":var r=Dg(e);return Object(I.j)(r)&&"extrude"===r.type?Ng["above-center"]:{placement:"center-center",normalizedOffset:null,anchor:"center"};case"point":case"mesh":return Ng["above-center"];default:return}}function zg(e,t,r){var n=Object(I.j)(r)?r.getBoundingBoxObjectSpace(Qg):Qg,i=Object(X.g)(n[3]-n[0],n[4]-n[1],n[5]-n[2]),a=Math.sqrt(i[0]*i[0]+i[1]*i[1]);e.centerOffset[0]=a/2*t.normalizedOffset[0];var o=e.translation[2],s=i[2]/2*t.normalizedOffset[1];e.translation[2]=0,e.elevationOffset=o+s;var c=Object(Yl.r)(i);e.centerOffset[2]=c/2*t.normalizedOffset[2]}function Vg(e){return{screenLength:e.screenLength,minWorldLength:e.minWorldLength,maxWorldLength:e.maxWorldLength}}var Ng={"above-center":{placement:"above-center",normalizedOffset:[0,1,0],anchor:"bottom"},"above-left":{placement:"above-left",normalizedOffset:[-1,1,0],anchor:"bottom-right"},"above-right":{placement:"above-right",normalizedOffset:[1,1,0],anchor:"bottom-left"},"below-center":{placement:"below-center",normalizedOffset:[0,-1,2],anchor:"top"},"below-left":{placement:"below-left",normalizedOffset:[-1,-1,0],anchor:"top-right"},"below-right":{placement:"below-right",normalizedOffset:[1,-1,0],anchor:"top-left"},"center-center":{placement:"center-center",normalizedOffset:[0,0,1],anchor:"center"},"center-left":{placement:"center-left",normalizedOffset:[-1,0,0],anchor:"right"},"center-right":{placement:"center-right",normalizedOffset:[1,0,0],anchor:"left"}},Ug={"above-center":["default","esriServerPointLabelPlacementAboveCenter"],"above-left":["esriServerPointLabelPlacementAboveLeft"],"above-right":["esriServerPointLabelPlacementAboveRight"],"below-center":["esriServerPointLabelPlacementBelowCenter"],"below-left":["esriServerPointLabelPlacementBelowLeft"],"below-right":["esriServerPointLabelPlacementBelowRight"],"center-center":["esriServerPointLabelPlacementCenterCenter"],"center-left":["esriServerPointLabelPlacementCenterLeft"],"center-right":["esriServerPointLabelPlacementCenterRight"]},Bg=function(e){var t=Ug[e],r=Ng[e];t.forEach((function(e){Ng[e]=r}))};for(var Gg in Ug)Bg(Gg);Object.freeze&&(Object.freeze(Ng),Object.keys(Ng).forEach((function(e){Object.freeze(Ng[e]),Object.freeze(Ng[e].normalizedOffset)})));var qg,Hg=[0,0],Wg=[0,0],Qg=Object(Eg.h)(),Zg=function(){function e(t){Object(c.a)(this,e),this._stage=t,this._materials=new Map}return Object(l.a)(e,[{key:"get",value:function(e){return this._materials.get(e)}},{key:"add",value:function(e,t){this._materials.set(e,t),this._stage.add(t)}},{key:"dispose",value:function(){this._stage.removeMany(Array.from(this._materials.values())),this._materials.clear()}}]),e}(),Xg=r(445),Yg=r(537),$g=r(182),Jg=512,Kg=4096,eO=qg=function(e){Object(f.a)(r,e);var t=Object(p.a)(r);function r(e){var n;return Object(c.a)(this,r),(n=t.call(this,e)).type=4,n.id=Object($g.b)(),n.events=new Ii.a,n.glTexture=null,n.needsClear=!1,n.elementsToAddOrUpdate=new Map,n.elementsToRemove=new Map,n.elementsToRender=new Map,n.elements=new Map,n.stageObjects=new Map,n.updating=!1,n}return Object(l.a)(r,[{key:"initialize",value:function(){this.stage=this.view._stage,this.canvas=this.create2DCanvas(),this.ctx=this.canvas.getContext("2d"),this.stage.add(this);var e=this.computeAtlasResolution(this.view.width,this.view.height);this.createAtlasRegion(e),this.update2DCanvasSize(),this.resetAtlasCursor()}},{key:"unload",value:function(){Object(I.j)(this.glTexture)&&(this.glTexture.dispose(),this.glTexture=null),this.events.emit("unloaded")}},{key:"width",get:function(){return this.atlas.size.width}},{key:"height",get:function(){return this.atlas.size.height}},{key:"requiresFrameUpdates",get:function(){return!1}},{key:"createDescriptor",value:function(e){return{target:3553,pixelFormat:6408,dataType:5121,wrapMode:33071,flipped:!0,samplingMode:9987,hasMipmap:!0,preMultiplyAlpha:!0,maxAnisotropy:e.parameters.maxMaxAnisotropy}}},{key:"load",value:function(e){if(Object(I.j)(this.glTexture))return this.glTexture;this.glTexture=new vu.a(e,this.createDescriptor(e),this.canvas);var t=this.view.resourceController.scheduler;return this.frameWorker=t.registerTask(Og.b.TEXT_TEXTURE_ATLAS,this),this.setDirty(),this.glTexture}},{key:"dispose",value:function(){this.elements=null,this.elementsToAddOrUpdate=null,this.elementsToRemove=null,this.elementsToRender=null,this.frameWorker=Object(I.r)(this.frameWorker),this.glTexture&&(this.stage.remove(this),this.glTexture=null),this.canvas.width=0,this.canvas.height=0,this.canvas=null,this.ctx=null}},{key:"create2DCanvas",value:function(){var e=document.createElement("canvas");return e.setAttribute("id","canvas2d"),e.setAttribute("style","display:none"),e.setAttribute("width",Jg.toString()),e.setAttribute("height",Jg.toString()),e}},{key:"update2DCanvasSize",value:function(){this.canvas.setAttribute("width",this.atlas.size.width.toString()),this.canvas.setAttribute("height",this.atlas.size.height.toString())}},{key:"createAtlasRegion",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Jg;this.atlas={size:{width:e,height:e},cursor:{x:0,y:0},lineHeight:0}}},{key:"computeAtlasResolution",value:function(e,t){var r=Math.max(e,t);return r+=256,r=Object(m.p)(r),r=Math.min(r,Kg)}},{key:"resizeAtlas",value:function(e,t){t=t||e;var r=this.atlas;r.size.width=e,r.size.height=t,Object(I.j)(this.glTexture)&&this.glTexture.resize(e,t),this.update2DCanvasSize()}},{key:"resetAtlasCursor",value:function(){var e=this.atlas;e.cursor.x=tO,e.cursor.y=tO+rO,e.lineHeight=0,this.needsClear=!0}},{key:"getAtlasUsage",value:function(){var e=this.atlas;return(e.cursor.x+e.cursor.y*e.size.width)/(e.size.width*e.size.height)}},{key:"getExpectedAtlasUsage",value:function(){var e=this.elementsToRemove.size,t=this.elementsToAddOrUpdate.size,r=this.elements.size;return this.getAtlasUsage()/r*(r+t-e)}},{key:"addAtlasElement",value:function(e,t,r,n){var i=this.atlas,a=e.textRenderer,o=a.renderedWidth,s=a.renderedHeight,c=a.displayWidth,l=a.displayHeight;e.placement.offset.x=i.cursor.x,e.placement.offset.y=i.cursor.y,e.placement.size.width=o,e.placement.size.height=s,e.placement.size.displayWidth=c,e.placement.size.displayHeight=l,e.placement.uvMinMax=[e.placement.offset.x/i.size.width,1-(e.placement.offset.y+s)/i.size.height,(e.placement.offset.x+o)/i.size.width,1-e.placement.offset.y/i.size.height],i.cursor.x+=r,i.lineHeight=Math.max(i.lineHeight,n),this.elements.set(t,e)}},{key:"removeAtlasElement",value:function(e){if(e&&this.elements.has(e.textId)){var t=e.placement.offset,r=e.placement.size;this.ctx.clearRect(t.x,t.y,r.width,r.height),this.elements.delete(e.textId)}}},{key:"ensureStageObjects",value:function(e){var t=this.stageObjects.get(e);if(t)return t;var r=new Set;return this.stageObjects.set(e,r),r}},{key:"addStageObject",value:function(e,t){this.ensureStageObjects(e).add(t)}},{key:"removeStageObject",value:function(e,t){var r=this.stageObjects.get(e);r&&r.delete(t)&&(t.geometries[0].vertexAttributes.get("size").data=[0,0],t.geometryVertexAttrsUpdated(0))}},{key:"_processAddition",value:function(e,t){var r=this.atlas,n=e.textId,i=e.textRenderer.renderedWidth,a=e.textRenderer.renderedHeight,o=i+tO,s=a+tO+rO;if(r.cursor.x+o<r.size.width&&r.cursor.y+s<r.size.height)this.addAtlasElement(e,n,o,s),this.elementsToRender.set(n,e),this.elementsToAddOrUpdate.delete(n);else{if(!(r.cursor.y+s+r.lineHeight<r.size.height)){var c=this.getExpectedAtlasUsage(),l=c>.85&&r.size.width<Kg;return l&&this.resizeAtlas(2*r.size.width,2*r.size.height),!t||!l&&c>.95&&r.size.width===Kg?(this.processRemovals(),0):(this.repack(),1)}r.cursor.x=tO,r.cursor.y+=r.lineHeight,r.lineHeight=0,this.addAtlasElement(e,n,o,s),this.elementsToRender.set(n,e),this.elementsToAddOrUpdate.delete(n)}return 0}},{key:"processRemovals",value:function(){var e=this;this.elementsToRemove.forEach((function(t,r){var n=e.stageObjects.get(r);n&&0!==n.size||e.removeAtlasElement(t),n&&0===n.size&&e.stageObjects.delete(r)})),this.elementsToRemove.clear()}},{key:"repack",value:function(){var e=this;this.processRemovals(),this.elements.forEach((function(t,r){t.rendered=!1,e.elementsToAddOrUpdate.set(r,t)})),this.elements.clear(),this.resetAtlasCursor(),this.elementsToRender.clear()}},{key:"processRenderingRequest",value:function(e){this.ctx.clearRect(e.placement.offset.x,e.placement.offset.y,e.placement.size.width,e.placement.size.height),e.textRenderer.render(this.ctx,e.placement.offset.x,e.placement.offset.y);var t=this.stageObjects.get(e.textId);t&&t.forEach((function(t){t.geometries[0].vertexAttributes.get("uv0").data=new Float32Array(e.placement.uvMinMax),t.geometries[0].vertexAttributes.get("size").data=[e.placement.size.displayWidth,e.placement.size.displayHeight],t.geometryVertexAttrsUpdated(0)})),e.rendered=!0}},{key:"running",get:function(){return this.updating}},{key:"runTask",value:function(e){var t=this,r=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(this.glTexture){var n=!1;if(Object(Qs.b)(this.elementsToAddOrUpdate,(function(e,i){var a=t.elements.get(i);if(a&&a.rendered){var o=t.stageObjects.get(i);return o&&o.forEach((function(e){var r=e.geometries[0].vertexAttributes,n=t.elements.get(i);r.get("uv0").data=new Float32Array(n.placement.uvMinMax),r.get("size").data=new Float32Array([n.placement.size.displayWidth,n.placement.size.displayHeight]),e.geometryVertexAttrsUpdated(0)})),t.elementsToAddOrUpdate.delete(i),!1}return 1===t._processAddition(t.elementsToAddOrUpdate.get(i),r)&&(n=!0,!0)})),n)this.runTask(Og.d,!1);else{var i=!1;this.elementsToRender.size>0&&this.needsClear&&(this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),this.needsClear=!1),Object(Qs.b)(this.elementsToRender,(function(r,n){return t.processRenderingRequest(r),t.elementsToRender.delete(n),i=!0,e.madeProgress(),e.done})),i&&Object(I.j)(this.glTexture)&&this.glTexture.setData(this.canvas),this.updating=this.elementsToRender.size>0,!this.updating&&qg.test.orderedRepackingEnabled&&this.repackOrdered()}}}},{key:"addTextTexture",value:function(e,t){var r=e.key;this.elementsToAddOrUpdate.has(r)||this.elementsToAddOrUpdate.set(r,{textId:r,placement:{offset:{x:0,y:0},size:{width:0,height:0,displayWidth:0,displayHeight:0},uvMinMax:[]},textRenderer:e,rendered:!1}),this.addStageObject(r,t),this.elementsToRemove.delete(r),this.setDirty()}},{key:"removeTextTexture",value:function(e,t){var r=e.key;this.elementsToRemove.set(r,this.elements.get(r)),this.removeStageObject(r,t)}},{key:"setDirty",value:function(){this.updating=!0}},{key:"repackOrdered",value:function(){if(0!==this.elements.size){var e=[];this.elements.forEach((function(t,r){return e.push({element:t,key:r})}));for(var t=!0,r=0;r<e.length-1;r++)if(e[r].key.localeCompare(e[r+1].key)>0){t=!1;break}if(!t||this.elementsToRemove.size){e.sort((function(e,t){return e.key.localeCompare(t.key)})),this.elements.clear();var n,a=Object(i.a)(e);try{for(a.s();!(n=a.n()).done;){var o=n.value,s=o.element,c=o.key;this.elements.set(c,s)}}catch(l){a.e(l)}finally{a.f()}this.repack(),this.setDirty()}}}},{key:"test",get:function(){var e=this.elements,t=this.stageObjects,r=this.elementsToRemove,n=this.atlas,i=this;return{elements:e,stageObjects:t,elementsToRemove:r,atlas:n,resizeAtlas:function(e,t){return i.resizeAtlas(e,t)},run:function(e,t){return i.runTask(e,t)}}}}]),r}(de.a);eO.test={orderedRepackingEnabled:!1},Object(b.a)([Object(y.b)({constructOnly:!0})],eO.prototype,"view",void 0),Object(b.a)([Object(y.b)({type:Boolean})],eO.prototype,"updating",void 0),eO=qg=Object(b.a)([Object(w.a)("esri.views.3d.webgl-engine.lib.TextTextureAtlas")],eO);var tO=2,rO=2,nO=eO,iO=r(279),aO=j.a.getLogger("esri.views.3d.layers.graphics.Labeler"),oO=function(e){Object(f.a)(r,e);var t=Object(p.a)(r);function r(){var e;return Object(c.a)(this,r),(e=t.apply(this,arguments))._dirty=!1,e._labels=new Map,e._labelsToAdd=new Map,e._labelsToRemove=new Map,e._labelingContexts=new Array,e}return Object(l.a)(r,[{key:"setup",value:function(){var e=this;this.dispose(),this._handles=new oe.a,this._handles.add([this.view.watch("state.camera",(function(){return e.setDirty()})),this.view.watch("pixelRatio",(function(){return e._resetAllLabels()})),this.view.resourceController.scheduler.registerTask(Og.b.LABELER,this)]),this._textTextureAtlas=new nO({view:this.view}),this._hudMaterialCollection=new Zg(this.view._stage),this._calloutMaterialCollection=new Zg(this.view._stage)}},{key:"dispose",value:function(){this._handles=Object(I.e)(this._handles),this._textTextureAtlas=Object(I.f)(this._textTextureAtlas),this._hudMaterialCollection=Object(I.f)(this._hudMaterialCollection),this._calloutMaterialCollection=Object(I.f)(this._calloutMaterialCollection),this._labelingContexts.length=0,this._labels.clear(),this._labelsToAdd.clear(),this._labelsToRemove.clear()}},{key:"_activateLabelingContext",value:function(e){var t=this;e.labels.forEach((function(e,r){t._labels.set(r,e),e.graphics3DGraphic.setVisibilityFlag(0,!0,1)})),e.active=!0}},{key:"_deactivateLabelingContext",value:function(e){var t=this;e.labels.forEach((function(e,r){e.graphics3DGraphic.setVisibilityFlag(0,!1,1),t.setLabelGraphicVisibility(e.graphics3DGraphic,!1),t._labels.delete(r)})),e.active=!1}},{key:"_addLabelTextureToAtlas",value:function(e){var t,r=Object(i.a)(e.graphics3DGraphic.labelGraphics);try{for(r.s();!(t=r.n()).done;){var n=t.value;if(n._labelClass){var a=e.textRenderers[n._labelIndex];a&&this._textTextureAtlas.addTextTexture(a,n.stageObject)}}}catch(o){r.e(o)}finally{r.f()}e.rendered=!0}},{key:"_removeLabelTextureFromAtlas",value:function(e){var t,r=Object(i.a)(e.graphics3DGraphic.labelGraphics);try{for(r.s();!(t=r.n()).done;){var n=t.value;if(n._labelClass){var a=e.textRenderers[n._labelIndex];a&&this._textTextureAtlas.removeTextTexture(a,n.stageObject)}}}catch(o){r.e(o)}finally{r.f()}e.rendered=!1}},{key:"running",get:function(){var e;return!!this.view.ready&&(this._dirty||(null==(e=this._textTextureAtlas)?void 0:e.updating)||this.deconflictor.running)}},{key:"runTask",value:function(e){this._updateLabels(e),!this._dirty&&this.deconflictor.running&&this.deconflictor.runTask(e)}},{key:"_updateLabels",value:function(e){var t=this;if(this._dirty){this._dirty=!1;var r,n=Object(i.a)(this._labelingContexts);try{var a=function(){var n=r.value;if(function(e){return e.active&&Object(ne.a)(e.layer)}(n)){if(!cO(n)){if(function(e){return null===e.labelClassContexts}(n))return t._deactivateLabelingContext(n),"continue";if(t._createLabelClassContext(n),sO(n))return t._dirty=!0,"continue";if(!cO(n))return"continue"}Object(Qs.b)(n.labelsToInitialize,(function(r,i){return t._ensureGraphics3DResources(r)&&(t._labels.set(i,r),t.deconflictor.setDirty(),e.madeProgress()),(r.visible&&r.hasTextTextureResources||!r.visible&&r.hasGraphics3DResources)&&(n.labelsToInitialize.delete(i),e.madeProgress()),e.done}))&&(t._dirty=!0)}};for(n.s();!(r=n.n()).done;)a()}catch(o){n.e(o)}finally{n.f()}this._labelsToRemove.forEach((function(e){return t._removeLabelTextureFromAtlas(e)})),this._labelsToAdd.forEach((function(e){return t._addLabelTextureToAtlas(e)})),this._labelsToRemove.clear(),this._labelsToAdd.clear(),this._dirty||this.notifyChange("updating")}}},{key:"_createLabelClassContextAsync",value:function(){var e=Object(s.a)(o.a.mark((function e(t){var r,n,i,a,c,l,u=this;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.labelClassAbortController.signal,e.next=3,t.layer.when();case 3:if(Object(q.x)(r),t.scaleVisibility&&t.scaleVisibility.updateScaleRangeActive(),n=t.graphics3DCore,i=n.layer,(a=i.labelingInfo&&i.labelingInfo.filter((function(e){return!!e.symbol})))&&0!==a.length){e.next=8;break}return e.abrupt("return");case 8:return c=new Array(a.length),l=!1,e.next=12,Object(wg.b)(a,function(){var e=Object(s.a)(o.a.mark((function e(i,a){var s,d,h,f;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s=i.symbol,d=Ag(n.getOrCreateGraphics3DSymbol(s)),!Object(I.i)(d)){e.next=3;break}return e.abrupt("return",void aO.error("Failed to create Graphics3DSymbol for label"));case 3:return e.next=5,d.load();case 5:if(Object(q.x)(r),h=null,e.t0=Object(Sg.d)(s)&&s.hasVisibleCallout(),!e.t0){e.next=13;break}return h=Object(Tg.a)(s,n.symbolCreationContext),e.next=12,h.load();case 12:Object(q.x)(r);case 13:return e.next=15,Object(wg.d)(Object(kg.createLabelFunction)(i,t.layer.fieldsIndex,u.view.spatialReference));case 15:f=e.sent,Object(q.x)(r),!0===f.ok?c[a]={labelClass:i,labelFunction:f.value,graphics3DSymbol:d,graphics3DCalloutSymbolLayer:h,calloutSymbolLayerIndex:0,textRenderParameters:u._createTextRenderParameters(d.symbol)}:(aO.error("Label expression failed to evaluate: ".concat(f.error)),l=!0);case 17:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}());case 12:Object(q.x)(r),l||(t.labelClassContexts=c);case 14:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"_createLabelClassContext",value:function(){var e=Object(s.a)(o.a.mark((function e(t){var r=this;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(t.labelClassPromise||(t.labelClassPromise=this._createLabelClassContextAsync(t).catch((function(e){if(Object(q.n)(e))throw e;t.labelClassContexts=null})).then((function(){t.labelClassAbortController=null,r.notifyChange("updating")})).catch((function(){})),this.notifyChange("updating")),t.labelClassPromise));case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_createTextRenderParameters",value:function(e){var t=e.symbolLayers.getItemAt(0);return t&&"text"===t.type?Yg.a.fromSymbol(t,this.view.pixelRatio):null}},{key:"_destroyLabelClassContext",value:function(e){var t,r=Object(i.a)(e.labelClassContexts);try{for(r.s();!(t=r.n()).done;){var n=t.value;--n.graphics3DSymbol.referenced,n.graphics3DSymbol=null}}catch(o){r.e(o)}finally{r.f()}var a=e.labelClassAbortController;e.labelClassAbortController=Object(q.e)(),a&&a.abort(),e.labelClassContexts=[],e.labelClassPromise=null,this.notifyChange("updating")}},{key:"_createTextSymbolGraphic",value:function(e,t,r,n,i){var a={text:e.text,centerOffset:r.centerOffset,translation:r.translation,elevationOffset:r.elevationOffset,screenOffset:r.screenOffset,anchor:r.anchor,centerOffsetUnits:r.centerOffsetUnits,verticalOffset:r.verticalOffset,debugDrawBorder:Vy.a.LABELS_SHOW_BORDER,displayWidth:e.displayWidth,displayHeight:e.displayHeight};return lO.graphic=t,lO.renderingInfo=null,lO.layer=n,i.createLabel(lO,a,this._hudMaterialCollection,this._textTextureAtlas)}},{key:"_createLineCalloutGraphic",value:function(e,t,r,n,i){var a={symbol:t,translation:n.translation,elevationOffset:n.elevationOffset,screenOffset:n.screenOffset,centerOffset:n.centerOffset,centerOffsetUnits:n.centerOffsetUnits,materialCollection:this._calloutMaterialCollection};return lO.graphic=e,lO.renderingInfo=a,lO.layer=i,r.createGraphics3DGraphic(lO)}},{key:"_ensureGraphics3DResources",value:function(e){if(e.hasGraphics3DResources)return!1;var t=e.graphics3DGraphic;if(t.destroyed)return!1;this._ensureTextTextureResources(e);var r=e.labelingContext,n=r.labelClassContexts;if(!n||0===n.length||!r.emptySymbolLabelSupported&&0===t._graphics.length)return!1;for(var i=!1,a=t.graphic,o=r.layer,s=Object(ne.a)(r.layer),c=this.view._stage,l=0;l<n.length;l++){var u=e.textRenderers[l];if(u){var d=n[l],h=d.graphics3DSymbol,f=null;h.symbol&&"label-3d"===h.symbol.type&&(f=h.symbol);var p=h.symbolLayers[0];if(p){var b=d.labelClass,v=Ig({graphics3DGraphic:t,labelSymbol:f,labelClass:b,disablePlacement:r.disablePlacement});if(!Object(I.i)(v)){p.setElevationInfoOverride(r.elevationInfoOverride);var m=this._createTextSymbolGraphic(u,a,v,o,p);if(!m)return!1;m._labelClass=b,m._labelIndex=l,t.addLabelGraphic(m,c,r.stageLayer),t.setVisibilityFlag(0,s,1),t.clearVisibilityFlag(1,1),t.setVisibilityFlag(3,!1,1),i=!0;var y=d.graphics3DCalloutSymbolLayer;if(y&&v.hasLabelVerticalOffset){y.setElevationInfoOverride(r.elevationInfoOverride);var g=this._createLineCalloutGraphic(a,f,y,v,o);g&&(d.calloutSymbolLayerIndex=t.labelGraphics.length,t.addLabelGraphic(g,c,r.stageLayer))}break}}}}return r.scaleVisibility&&i&&r.scaleVisibility.updateGraphicLabelScaleVisibility(t),e.hasGraphics3DResources=!0,!0}},{key:"_destroyGraphics3DResources",value:function(e){var t,r=e.labelingContext.labelClassContexts,n=Object(i.a)(e.graphics3DGraphic.labelGraphics);try{for(n.s();!(t=n.n()).done;){var a=t.value;if(null!=a._labelClass){var o=r[a._labelIndex].graphics3DSymbol.symbolLayers[0];null!=o&&o.onRemoveGraphic(a)}}}catch(s){n.e(s)}finally{n.f()}e.graphics3DGraphic.clearLabelGraphics(),e.hasGraphics3DResources=!1}},{key:"_ensureTextTextureResources",value:function(e){if(!e.hasTextTextureResources){var t=e.labelingContext,r=t.labelClassContexts;if(r&&0!==r.length){for(var n=e.graphics3DGraphic.graphic,i=0;i<r.length;i++){var a=r[i];if(e.textRenderers[i]=null,a.textRenderParameters){var o=a.labelFunction,s=void 0;if("arcade"===o.type)try{var c=o.needsHydrationToEvaluate()?Object(xg.c)(n,t.layer):n;s=o.evaluate(c)}catch(l){s=null}else s=o.evaluate(n);Object(I.i)(s)||""===s||/^\s+$/.test(s)||(e.textRenderers[i]=new Xg.a(s,a.textRenderParameters))}}e.hasTextTextureResources=!0}}}},{key:"_destroyTextTextureResources",value:function(e){e.textRenderers=[],e.hasTextTextureResources=!1}},{key:"_addGraphic",value:function(e,t){var r={hasGraphics3DResources:!1,hasTextTextureResources:!1,visible:!1,rendered:!1,labelingContext:e,graphics3DGraphic:t,textRenderers:[]},n=t.graphic.uid;e.labels.set(n,r),e.labelsToInitialize.set(n,r),this.setDirty(),this.deconflictor.setDirty()}},{key:"_removeGraphic",value:function(e,t){var r=t.graphic.uid,n=e.labels.get(r);n&&(this._destroyGraphic(n,r),e.labels.delete(r),e.labelsToInitialize.delete(r),this.setDirty(),this.deconflictor.setDirty())}},{key:"_destroyGraphic",value:function(e,t){this._labels.has(t)&&(this._labels.delete(t),this._labelsToAdd.delete(t),this._labelsToRemove.delete(t)),e.hasTextTextureResources&&(this._removeLabelTextureFromAtlas(e),this._destroyTextTextureResources(e)),e.hasGraphics3DResources&&this._destroyGraphics3DResources(e)}},{key:"_labelingInfoChange",value:function(){var e=Object(s.a)(o.a.mark((function e(t,r){var n,a,s,c;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r){e.next=2;break}return e.abrupt("return",(this._visibilityInfoChange(t),this._resetLabels(t),this._createLabelClassContext(t)));case 2:n=Object(i.a)(r);try{for(n.s();!(a=n.n()).done;)s=a.value,(c=t.labels.get(s))&&(this._removeGraphic(t,c.graphics3DGraphic),this._addGraphic(t,c.graphics3DGraphic))}catch(o){n.e(o)}finally{n.f()}case 4:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"_globalPropertyChanged",value:function(e,t){var r,n=Object(i.a)(t.labelClassContexts);try{var a=function(){var n=r.value,i=new Map;t.labels.forEach((function(e){var t=e.graphics3DGraphic;i.set(t.graphic.uid,t)}));if(Object(I.s)(n.graphics3DSymbol.symbolLayers[0]).globalPropertyChanged(e,i,(function(e){return e.labelGraphics[0]})),n.graphics3DCalloutSymbolLayer){n.graphics3DCalloutSymbolLayer.globalPropertyChanged(e,i,(function(e){return e.labelGraphics[n.calloutSymbolLayerIndex]}))}};for(n.s();!(r=n.n()).done;)a()}catch(o){n.e(o)}finally{n.f()}}},{key:"_visibilityInfoChange",value:function(e){var t=e.layer.labelsVisible;t&&!e.active&&this._activateLabelingContext(e),!t&&e.active&&this._deactivateLabelingContext(e),this.setDirty()}},{key:"_resetAllLabels",value:function(){var e,t=Object(i.a)(this._labelingContexts);try{for(t.s();!(e=t.n()).done;){var r=e.value;this._resetLabels(r)}}catch(n){t.e(n)}finally{t.f()}}},{key:"_resetLabels",value:function(e){var t=this;e.labels.forEach((function(r,n){t._destroyGraphic(r,n),r.visible=!1,r.rendered=!1,e.labelsToInitialize.set(n,r)})),this._destroyLabelClassContext(e),this.setDirty(),this.deconflictor.setDirty()}},{key:"_findLabelingContext",value:function(e){var t,r=Object(i.a)(this._labelingContexts);try{for(r.s();!(t=r.n()).done;){var n=t.value;if(n.graphics3DCore===e)return n}}catch(a){r.e(a)}finally{r.f()}return null}},{key:"addGraphicsOwner",value:function(e,t,r){var n=this,i=r&&r.emptySymbolLabelSupported||!1,a=r&&r.elevationInfoOverride||null,o=r&&r.disablePlacement||null;if(!this._findLabelingContext(e)){var s=e.layer,c={graphics3DCore:e,layer:s,scaleVisibility:t,emptySymbolLabelSupported:i,elevationInfoOverride:a,disablePlacement:o,active:s.labelsVisible,labelClassPromise:null,labelClassAbortController:Object(q.e)(),labelClassContexts:[],labels:new Map,labelsToInitialize:new Map,stageLayer:new iO.a({isPickable:!0},s.uid)};return this.view._stage.add(c.stageLayer),this._labelingContexts.push(c),this.setDirty(),{addGraphic:function(e){return n._addGraphic(c,e)},removeGraphic:function(e){return n._removeGraphic(c,e)},featureReductionChange:function(){},layerLabelsEnabled:function(){return Object(ne.a)(c.layer)},labelingInfoChange:function(e){return n._labelingInfoChange(c,e)},elevationInfoChange:function(){return n._globalPropertyChanged("elevationInfo",c)},slicePlaneEnabledChange:function(){return n._globalPropertyChanged("slicePlaneEnabled",c)},visibilityInfoChange:function(){return n._visibilityInfoChange(c)},reset:function(){return n._resetLabels(c)},clear:function(){}}}}},{key:"removeGraphicsOwner",value:function(e){var t=this,r=this._findLabelingContext(e);if(r){var n=this._labelingContexts.indexOf(r);this._labelingContexts.splice(n,1),r.labels.forEach((function(e){return t._removeGraphic(r,e.graphics3DGraphic)})),this.view._stage.remove(r.stageLayer),r.stageLayer=null,this.setDirty()}}},{key:"setLabelGraphicVisibility",value:function(e,t){var r=e.graphic.uid,n=this._labels.get(r);n&&n.visible!==t&&(t&&!n.rendered?(this._labelsToAdd.set(r,n),this._labelsToRemove.delete(r),n.hasTextTextureResources||n.labelingContext.labelsToInitialize.set(r,n)):!t&&n.rendered&&(this._labelsToRemove.set(r,n),this._labelsToAdd.delete(r)),n.visible=t,this.setDirty())}},{key:"setDirty",value:function(){!this._dirty&&this._labelingContexts.length>0&&(this._dirty=!0,this.notifyChange("updating"))}},{key:"updating",get:function(){var e;return this._dirty||(null==(e=this._textTextureAtlas)?void 0:e.updating)||this.deconflictor.updating||this._labelingContexts.some((function(e){return sO(e)}))}},{key:"updatingProgress",get:function(){if(!this.updating||!this._textTextureAtlas)return 1;var e=this._labelingContexts.length>0?this._labelingContexts.reduce((function(e,t){return e+(sO(t)?0:1)}),0)/this._labelingContexts.length:1;return(this._dirty?0:.3)+(this._textTextureAtlas.updating?0:.1)+.1*e+.5*this.deconflictor.updatingProgress}},{key:"test",get:function(){var e=this;return{textTextureAtlas:this._textTextureAtlas,resetAllLabels:function(){return e._resetAllLabels()}}}}]),r}(de.a);function sO(e){return e.labelClassPromise&&!!e.labelClassAbortController}function cO(e){return e.labelClassContexts&&e.labelClassContexts.length}Object(b.a)([Object(y.b)({constructOnly:!0})],oO.prototype,"view",void 0),Object(b.a)([Object(y.b)({constructOnly:!0})],oO.prototype,"deconflictor",void 0),Object(b.a)([Object(y.b)()],oO.prototype,"_textTextureAtlas",void 0),Object(b.a)([Object(y.b)({type:Boolean,readOnly:!0})],oO.prototype,"updating",null),oO=Object(b.a)([Object(w.a)("esri.views.3d.layers.graphics.Labeler")],oO);var lO=new Cg.a(null,null,null),uO=r(491),dO=r(494),hO=r(444),fO=function(){function e(){Object(c.a)(this,e),this.gltfCache=new Map,this.wosrCache=new Map,this.evictHandles=new oe.a}return Object(l.a)(e,[{key:"loadGLTF",value:function(e,t,r){var n=r?"gltfPBR:".concat(e):"gltf:".concat(e);return this.fromCache(this.gltfCache,n,(function(t){return Object(dO.a)(new uO.a(t.streamDataRequester),e,t,r)}),t)}},{key:"loadWOSR",value:function(e,t){var r="wosr:".concat(e,":").concat(t.disableTextures);return this.fromCache(this.wosrCache,r,(function(t){return Object(hO.a)(e,t)}),t)}},{key:"destroy",value:function(){this.evictHandles.destroy(),this.gltfCache.clear(),this.wosrCache.clear()}},{key:"size",get:function(){return this.wosrCache.size+this.gltfCache.size}},{key:"fromCache",value:function(e,t,r,n){var i=this;return new Promise((function(a,o){if(Object(q.o)(n))o(Object(q.f)());else{var s=Object(q.s)(n,(function(){i.remove(e,t),o(Object(q.f)())})),c=e.get(t);if(c)return i.evictHandles.remove(t),c.refCount++,void c.item.then(a,o);var l=Object(q.e)(),u=Object(ie.a)(Object(ie.a)({},n),{},{signal:l.signal}),d={refCount:1,abortController:l,item:r(u).then((function(r){return d.abortController=null,r.remove=function(){return i.remove(e,t)},r}))};e.set(t,d),d.item.then((function(e){Object(I.j)(s)&&s.remove(),a(e)}),(function(e){Object(I.j)(s)&&s.remove(),o(e)}))}}))}},{key:"remove",value:function(e,t){var r=e.get(t);r&&(r.refCount--,0===r.refCount&&this.evictHandles.add(Object(G.c)((function(){e.delete(t),Object(I.j)(r.abortController)&&r.abortController.abort()}),pO),t))}}]),e}(),pO=1e4,bO=function(){function e(t,r,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;Object(c.a)(this,e),this.lij=[0,0,0],this.extent=Object(K.k)(),this.resolution=0,this.loadPriority=0,this.measures={visibility:2,screenRect:Object(K.k)(),distance:0,shouldSplit:!1},this.used=!1,i&&this.acquire(t,r,n,i)}return Object(l.a)(e,[{key:"acquire",value:function(t,r,n,i){this.tilingScheme=i,this.id=e.id(t,r,n),this.lij[0]=t,this.lij[1]=r,this.lij[2]=n,i.getExtent(t,r,n,this.extent),this.resolution=i.resolutionAtLevel(t)}},{key:"release",value:function(){this.tilingScheme=null}},{key:"getChildren",value:function(t){var r=this.lij[0]+1,n=2*this.lij[1],i=2*this.lij[2];return t?(t[0].acquire(r,n,i,this.tilingScheme),t[1].acquire(r,n+1,i,this.tilingScheme),t[2].acquire(r,n,i+1,this.tilingScheme),t[3].acquire(r,n+1,i+1,this.tilingScheme),t):[new e(r,n,i,this.tilingScheme),new e(r,n+1,i,this.tilingScheme),new e(r,n,i+1,this.tilingScheme),new e(r,n+1,i+1,this.tilingScheme)]}},{key:"copyMeasurementsFrom",value:function(e){this.measures.visibility=e.measures.visibility,this.measures.shouldSplit=e.measures.shouldSplit,this.measures.distance=e.measures.distance,Object(K.y)(e.measures.screenRect,this.measures.screenRect)}}],[{key:"id",value:function(e,t,r){return"".concat(e,"/").concat(t,"/").concat(r)}}]),e}(),vO=r(437),mO=r(117),yO=r(118),gO=function(){function e(t){Object(c.a)(this,e),this.renderCoordsHelper=t,this.frustum=Object(yO.c)(),this._points=Object(yO.d)(),this.lines=new Array(12),this._origin=Object(X.e)(),this._direction=Object(X.e)(),this._altitude=null;for(var r=0;r<12;r++)this.lines[r]={origin:null,direction:Object(X.e)(),endpoint:null}}return Object(l.a)(e,[{key:"planes",get:function(){return this.frustum}},{key:"points",get:function(){return this._points}},{key:"mutablePoints",get:function(){return this._points}},{key:"direction",get:function(){return this._direction}},{key:"update",value:function(e){Object(yO.e)(e.viewMatrix,e.projectionMatrix,this.frustum,this._points),Object(Yl.m)(this._origin,e.eye),Object(Yl.m)(this._direction,e.viewForward),this._altitude=this.renderCoordsHelper.getAltitude(this._origin),this.updateLines()}},{key:"updatePoints",value:function(e){for(var t=0;t<this._points.length;t++)Object(Yl.m)(this._points[t],e[t]);Object(yO.a)(this.frustum,this._points),this.updateLines()}},{key:"altitude",get:function(){return this._altitude}},{key:"intersectsSphere",value:function(e){return Object(yO.j)(this.frustum,e)}},{key:"intersectsRay",value:function(e){return Object(yO.i)(this.frustum,e)}},{key:"intersectsLineSegment",value:function(e,t){return Object(yO.g)(this.frustum,e,t)}},{key:"intersectsPoint",value:function(e){return Object(yO.h)(this.frustum,e)}},{key:"updateLines",value:function(){for(var e=this._points,t=0;t<4;t++){var r=t+4;OO(this.lines[t],e[t],e[r]),OO(this.lines[t+4],e[t],3===t?e[0]:e[t+1]),OO(this.lines[t+8],e[r],3===t?e[4]:e[r+1])}}}]),e}();function OO(e,t,r){e.origin=t,e.endpoint=r,Object(Yl.x)(e.direction,t,r)}gO.planePointIndices=yO.k,gO.nearFarLineIndices=[[0,4],[1,5],[2,6],[3,7]];var jO=r(623),_O=function(){function e(t){Object(c.a)(this,e),this.renderCoordsHelper=t,this.surfaceElevation=0,this.cache=new Map,this.frustum=new gO(t),this.extendedFrustum=new gO(t),this.intersector=new jO.a({renderCoordsHelper:t}),this.renderCoordsHelper=t}return Object(l.a)(e,[{key:"begin",value:function(e,t){this.surfaceElevation=t,this.aboveGround=this.renderCoordsHelper.getAltitude(e.eye)>t,this.frustum.update(e),this.shortenFrustumFarPlane(this.frustum),this.updateExtendedFrustum(e)}},{key:"end",value:function(){this.cache.clear()}},{key:"calculate",value:function(e){if(this.allTilesInvisible)return 0;var t=1===this.renderCoordsHelper.viewingMode&&e.lij[0]>=wO&&e.lij[0]<xO,r=this.getOrCalculateSingleTileVisibility(e,!t);return 0!==r&&t?this.calculateAggregatedChildrenVisibility(e):r}},{key:"shortenFrustumFarPlane",value:function(e){var t,r=gO.nearFarLineIndices,n=e.mutablePoints,a=Object(i.a)(r);try{for(a.s();!(t=a.n()).done;){var o=t.value,s=Object(ue.a)(o,2),c=s[0],l=s[1],u=n[c],d=n[l];Object(Yl.l)(CO,d,u),Object(Yl.g)(CO,CO,SO),Object(Yl.h)(n[l],u,CO)}}catch(h){a.e(h)}finally{a.f()}e.updatePoints(n)}},{key:"calculateAggregatedChildrenVisibility",value:function(e){var t=0,r=this.cache.get(e.id);if(null!=r)return r;var n=AO.acquire();e.getChildren(n);var a,o=Object(i.a)(n);try{for(o.s();!(a=o.n()).done;){var s=a.value,c=this.calculate(s);if(0!==c&&(t=c,2===c))break}}catch(l){o.e(l)}finally{o.f()}return AO.release(n),this.cache.set(e.id,t),t}},{key:"getOrCalculateSingleTileVisibility",value:function(e,t){var r=this.cache.get(e.id);if(null!=r)return r;var n=this.calculateSingleTileVisibility(e);return t&&this.cache.set(e.id,n),n}},{key:"calculateSingleTileVisibility",value:function(e){return!this.aboveGround&&1===this.renderCoordsHelper.viewingMode&&e.lij[0]<kO?0===this.calculateSingleTileVisibilitySided(e,!1)?this.calculateSingleTileVisibilitySided(e,!0):void 0:this.calculateSingleTileVisibilitySided(e,this.aboveGround)}},{key:"calculateSingleTileVisibilitySided",value:function(e,t){this.intersector.update(e.extent,e.tilingScheme.spatialReference,this.surfaceElevation,t);var r=Object(J.e)(e.tilingScheme.spatialReference).radius;return this.intersector.isVisibleInFrustum(this.extendedFrustum,r)?this.intersector.isVisibleInFrustum(this.frustum,r,!0)?2:1:0}},{key:"updateExtendedFrustum",value:function(e){this.extendedFrustum.update(e),this.shortenFrustumFarPlane(this.extendedFrustum);var t=this.renderCoordsHelper.worldUpAtPosition(e.eye,CO);this.aboveGround||Object(Yl.u)(t,t);var r=Object(m.b)(-Object(Yl.j)(t,e.viewForward));if(this.allTilesInvisible=r>(Math.PI+e.fovY)/2,!this.allTilesInvisible&&(this.hasExtendedFrustum=r>e.fovY/2,this.hasExtendedFrustum)){for(var n=this.extendedFrustumParameters(),i=this.extendedFrustum.mutablePoints,a=0;a<4;a++){var o=n.pointIndices[a],s=i[o],c=this.renderCoordsHelper.getAltitude(s);if(n.needsAltitudeAdjustment(c)){switch(this.renderCoordsHelper.worldUpAtPosition(s,CO),o){case 4:case 7:case 0:case 3:Object(Rp.u)(this.extendedFrustum.planes[0],CO,CO);break;case 5:case 6:case 1:case 2:Object(Rp.u)(this.extendedFrustum.planes[1],CO,CO)}Object(Yl.g)(CO,CO,n.direction),this.renderCoordsHelper.intersectInfiniteManifold(Object(Ud.g)(s,CO),n.zWithMargin,s)}}if(this.extendedFrustum.updatePoints(i),Object(Rp.g)(i[0],i[1],i[2],MO),Object(Rp.g)(i[1],i[2],i[3],PO),Object(Yl.j)(Object(Rp.s)(MO),Object(Rp.s)(PO))<0){var l,u,d=this.extendedFrustum.mutablePoints;this.aboveGround?(l=[d[1],d[0]],d[0]=l[0],d[1]=l[1]):(u=[d[2],d[3]],d[3]=u[0],d[2]=u[1]),this.extendedFrustum.updatePoints(d)}}}},{key:"extendedFrustumParameters",value:function(){return this.aboveGround?this.extendedFrustumParametersAboveSurface():this.extendedFrustumParametersBelowSurface()}},{key:"extendedFrustumParametersAboveSurface",value:function(){var e=this.surfaceElevation-TO;return{zWithMargin:e,pointIndices:gO.planePointIndices.bottom,direction:-1,needsAltitudeAdjustment:function(t){return t>e}}}},{key:"extendedFrustumParametersBelowSurface",value:function(){var e=this.surfaceElevation+TO;return{zWithMargin:e,pointIndices:gO.planePointIndices.top,direction:1,needsAltitudeAdjustment:function(t){return t<e}}}}]),e}(),wO=2,xO=6,kO=12,SO=.95,TO=1,CO=Object(X.e)(),MO=Object(Rp.d)(),PO=Object(Rp.d)(),AO=new mO.a(Array,(function(e){4!==e.length&&(e[0]=new bO,e[1]=new bO,e[2]=new bO,e[3]=new bO)}),(function(e){e[0].release(),e[1].release(),e[2].release(),e[3].release()})),EO=function(){function e(t){Object(c.a)(this,e),this.camera=new zf.a,this.focusOnMap=[0,0],this.screenRect=Object(K.k)(),this.tileSize=t.tileSize,this.renderCoordsHelper=t.renderCoordsHelper,this.tilingScheme=t.tilingScheme,this.visibility=new _O(t.renderCoordsHelper)}return Object(l.a)(e,[{key:"begin",value:function(e,t,r){this.camera.copyFrom(e),this.surfaceElevation=r,this.focusOnMap[0]=t.x,this.focusOnMap[1]=t.y,Object(K.s)(0,0,e.fullWidth,e.fullHeight,this.screenRect),this.visibility.begin(this.camera,r)}},{key:"end",value:function(){this.visibility.end()}},{key:"updateTile",value:function(e){e.measures.visibility=this.visibility.calculate(e),e.measures.distance=Object(K.l)(e.extent,this.focusOnMap),0!==e.measures.visibility&&this.updateScreenMeasure(e)}},{key:"updateScreenMeasure",value:function(e){var t=DO,r=1<<t,n=e.measures.screenRect;Object(K.m)(n);for(var i=0,a=e.lij[0]+t,o=e.lij[1]<<t,s=e.lij[2]<<t,c=this.tileSizeWithBias(e),l=c*c,u=0;u<r;u++)for(var d=0;d<r;d++)if((i+=this.computeScreenArea(e,a,o+u,s+d,n))>l)return void(e.measures.shouldSplit=!0);e.measures.shouldSplit=!1}},{key:"tileSizeWithBias",value:function(e){return 1===e.measures.visibility?this.tileSize*FO:this.tileSize}},{key:"computeScreenArea",value:function(e,t,r,n,i){var a=1===e.measures.visibility;this.projectToScreen(t,r,n,a,LO),Object(K.m)(RO);for(var o=0;o<4;o++)Object(K.p)(RO,LO[o]);return Object(K.o)(i,RO),Object(K.u)(RO,this.screenRect,IO),Object(vO.a)(LO[0],LO[1],LO[2])+Object(vO.a)(LO[0],LO[2],LO[3])}},{key:"projectToScreen",value:function(e,t,r,n,i){this.tilingScheme.ensureMaxLod(e),this.tilingScheme.getExtent(e,t,r,zO),this.toRenderCoords(zO,0,3,NO[0]),this.toRenderCoords(zO,2,3,NO[1]),this.toRenderCoords(zO,2,1,NO[2]),this.toRenderCoords(zO,0,1,NO[3]),n&&(this.projectToPlane(NO,this.camera.frustum[4]),this.projectToPlane(NO,this.camera.frustum[3]),this.projectToPlane(NO,this.camera.frustum[2]));for(var a=0;a<4;a++)this.camera.projectToRenderScreen(NO[a],BO),this.camera.renderToScreen(BO,i[a])}},{key:"projectToPlane",value:function(e,t){for(var r=0;r<4;r++)UO[r]=Object(Rp.w)(t,e[r]);var n=Math.max(UO[0],UO[1],UO[2],UO[3]);if(n>0)for(var i=Object(Yl.g)(VO,Object(Rp.s)(t),-n),a=0;a<4;a++)Object(Yl.h)(e[a],e[a],i)}},{key:"toRenderCoords",value:function(e,t,r,n){return VO[0]=e[t],VO[1]=e[r],VO[2]=this.surfaceElevation,this.renderCoordsHelper.toRenderCoords(VO,this.tilingScheme.spatialReference,n),n}}]),e}(),RO=Object(K.k)(),IO=Object(K.k)(),DO=2,FO=5,LO=[Object(Z.f)(),Object(Z.f)(),Object(Z.f)(),Object(Z.f)()],zO=Object(K.k)(),VO=Object(X.e)(),NO=[Object(X.e)(),Object(X.e)(),Object(X.e)(),Object(X.e)()],UO=[0,0,0,0],BO=Object(Z.d)(),GO=r(453),qO=j.a.getLogger("esri.views.3d.layers.support.FeatureTileTree3D"),HO=function(e){Object(f.a)(r,e);var t=Object(p.a)(r);function r(e){var n;return Object(c.a)(this,r),(n=t.call(this,e)).tiles=new V.a,n.tileSize=512,n._idToTile=new Map,n._handles=new oe.a,n._clients=new Set,n._dirty=!1,n._newTiles=new zy.a,n}return Object(l.a)(r,[{key:"tilingScheme",get:function(){var e=this.tilingSchemeOwner.tilingScheme;return e?e.clone():null}},{key:"filterExtent",set:function(e){if(!e||e.spatialReference.equals(this.viewState.spatialReference)){var t=this._get("filterExtent");if(!(t===e||t&&e&&t.equals(e))){var r=e?e.clone():null;this._set("filterExtent",r),this._setDirty()}}else qO.error("#extent","extent spatial reference needs to be in the same spatial reference as the view")}},{key:"filterExtentRect",get:function(){if(!this.filterExtent||!this.tilingScheme)return null;var e=Object(K.k)();return Object(GO.b)(this.filterExtent,e,this.tilingScheme.spatialReference),e}},{key:"rootTileIds",get:function(){return this.filterExtentRect?this.tilingScheme.rootTilesInExtent(this.filterExtentRect):[[0,0,0]]}},{key:"suspended",set:function(e){e!==this._get("suspended")&&(this._set("suspended",e),this._setDirty())}},{key:"updating",get:function(){return this._dirty||!!this._pendingTiles}},{key:"initialize",value:function(){var e=this;this._handles.add(this.watch(["tilingScheme","tileSize"],(function(){return e._reset()}),!0)),this._handles.add(Object(W.a)(this,["tileSize","cameraOnSurface.location","tilingScheme","viewState.contentCamera","focus.location"],(function(){return e._setDirty()}),!0)),this.scheduler&&(this._frameWorker=this.scheduler.registerTask(Og.b.FEATURE_TILE_TREE,this))}},{key:"destroy",value:function(){this._frameWorker=Object(I.r)(this._frameWorker),this._handles=Object(I.e)(this._handles)}},{key:"addClient",value:function(){var e=this,t=WO++;return this._clients.add(t),1===this._clients.size&&this._setDirty(),{remove:function(){return e._removeClient(t)}}}},{key:"_removeClient",value:function(e){this._clients.delete(e),this._hasClients||this._clear()}},{key:"_hasClients",get:function(){return this._clients.size>0}},{key:"_setDirty",value:function(){!this._hasClients||this.suspended||this._dirty||(this._frameWorker?(this._dirty=!0,this.notifyChange("updating")):this.runTask(Og.d))}},{key:"_clear",value:function(){this.tiles.removeAll(),this._idToTile.clear(),this._reset(),this._dirty=!1,this.notifyChange("updating")}},{key:"running",get:function(){return this.updating}},{key:"runTask",value:function(e){this._dirty=!1,this._pendingTiles||(this._startUpdate(),Object(I.j)(this._frameWorker)&&(this._frameWorker.priority=Og.b.FEATURE_TILE_TREE_ACTIVE)),this._subdivideTilesForView(e),!this._pendingTiles&&Object(I.j)(this._frameWorker)&&(this._frameWorker.priority=Og.b.FEATURE_TILE_TREE),this.notifyChange("updating")}},{key:"_startUpdate",value:function(){if(!this.suspended)if(this.tilingScheme){this._tileMeasurements||(this._tileMeasurements=new EO({renderCoordsHelper:this.renderCoordsHelper,tilingScheme:this.tilingScheme,tileSize:this.tileSize}));var e=this.viewState.contentCamera;this._tileMeasurements.begin(e,this.focus.location,this.cameraOnSurface.location.z),this._pendingTiles=this._getRootTiles()}else this._clear()}},{key:"_reset",value:function(){this._newTiles.clear(),this._tileMeasurements=null,this._pendingTiles=null,this._setDirty()}},{key:"_getRootTiles",value:function(){var e=this;return this.rootTileIds.map((function(t){return new bO(t[0],t[1],t[2],e.tilingScheme)}))}},{key:"_purgeHorizonTiles",value:function(e){e.sort((function(e,t){var r=e.measures.screenRect,n=t.measures.screenRect;return r[1]+r[3]-(n[1]+n[3])})),Object(K.m)(QO);for(var t=0;t<e.length;t++)if(Object(K.o)(QO,e.data[t].measures.screenRect),Object(K.t)(QO)>ZO)return e.data.slice(t,e.length);return[]}},{key:"_subdivideTilesForView",value:function(e){if(this._pendingTiles){for(;this._pendingTiles.length>0&&!e.done;){var t,r=this._pendingTiles.pop();e.madeProgress(),this.filterExtentRect&&!Object(K.v)(this.filterExtentRect,r.extent)||(this._tileMeasurements.updateTile(r),0!==r.measures.visibility&&(r.measures.shouldSplit?(this.tilingScheme.ensureMaxLod(r.lij[0]+1),(t=this._pendingTiles).push.apply(t,Object(xe.a)(r.getChildren()))):this._newTiles.push(r)))}0===this._pendingTiles.length&&(this._updateTiles(this._purgeHorizonTiles(this._newTiles)),this._newTiles.clear(),this._tileMeasurements.end(),this._pendingTiles=null)}}},{key:"_updateTiles",value:function(e){var t,r=this,n=Object(i.a)(this.tiles.items);try{for(n.s();!(t=n.n()).done;){t.value.used=!1}}catch(s){n.e(s)}finally{n.f()}var a=e.filter((function(e){var t=r._idToTile.get(e.id);return t?(t.copyMeasurementsFrom(e),t.used=!0):r._idToTile.set(e.id,e),!t})),o=this.tiles.items.filter((function(e){return!e.used&&(r._idToTile.delete(e.id),!0)}));this.tiles.removeMany(o),this.tiles.addMany(a),this.sortTiles()}},{key:"sortTiles",value:function(){this.viewState.fixedContentCamera||this.tiles.sort((function(e,t){return e.measures.visibility!==t.measures.visibility?2===e.measures.visibility?-1:1:e.measures.distance-t.measures.distance})),this.tiles.forEach((function(e,t){return e.loadPriority=t}))}}]),r}(de.a);Object(b.a)([Object(y.b)({constructOnly:!0})],HO.prototype,"scheduler",void 0),Object(b.a)([Object(y.b)({constructOnly:!0})],HO.prototype,"renderCoordsHelper",void 0),Object(b.a)([Object(y.b)({constructOnly:!0})],HO.prototype,"tilingSchemeOwner",void 0),Object(b.a)([Object(y.b)({constructOnly:!0})],HO.prototype,"cameraOnSurface",void 0),Object(b.a)([Object(y.b)({constructOnly:!0})],HO.prototype,"focus",void 0),Object(b.a)([Object(y.b)({constructOnly:!0})],HO.prototype,"viewState",void 0),Object(b.a)([Object(y.b)({constructOnly:!0})],HO.prototype,"terrain",void 0),Object(b.a)([Object(y.b)()],HO.prototype,"tiles",void 0),Object(b.a)([Object(y.b)()],HO.prototype,"tileSize",void 0),Object(b.a)([Object(y.b)({readOnly:!0})],HO.prototype,"tilingScheme",null),Object(b.a)([Object(y.b)()],HO.prototype,"filterExtent",null),Object(b.a)([Object(y.b)({readOnly:!0})],HO.prototype,"filterExtentRect",null),Object(b.a)([Object(y.b)({readOnly:!0})],HO.prototype,"rootTileIds",null),Object(b.a)([Object(y.b)({value:!1})],HO.prototype,"suspended",null),Object(b.a)([Object(y.b)({readOnly:!0})],HO.prototype,"updating",null),HO=Object(b.a)([Object(w.a)("esri.views.3d.layers.support.FeatureTileTree3D")],HO);var WO=0;var QO=Object(K.k)(),ZO=10,XO=HO,YO=r(309),$O=r(209),JO=function(e){Object(f.a)(r,e);var t=Object(p.a)(r);function r(){var e;return Object(c.a)(this,r),(e=t.apply(this,arguments))._propertiesPool=new $O.a({camera:zf.a},Object(u.a)(e)),e._lastSeenCameraProjectionValues=new zf.a,e.events=new Ii.a,e.viewingMode=1,e._cameraChanged=!1,e.updateQueue=new Array,e.processingUpdates=!1,e}return Object(l.a)(r,[{key:"init",value:function(e,t){this._set("viewingMode",e),this._set("spatialReference",t),this._set("constraints",new ul({mode:this.viewingMode}))}},{key:"exit",value:function(){this.cameraController=null,this._propertiesPool.destroy(),this._propertiesPool=new $O.a({camera:zf.a},this)}},{key:"createInitialCamera",value:function(){if(1===this.viewingMode){var e=Object(J.e)(this.spatialReference).radius;this.camera=new zf.a(Object(X.g)(4*e,0,0),Object(X.g)(e,0,0),Object(X.g)(0,0,1))}else this.camera=new zf.a(Object(X.g)(0,0,100),Object(X.g)(0,0,0),Object(X.g)(0,1,0))}},{key:"animation",get:function(){return this.cameraController instanceof dp&&Object(I.j)(this.cameraController.viewAnimation)?this.cameraController.viewAnimation:null}},{key:"camera",get:function(){return this._get("camera")},set:function(e){var t=this;e!==ej&&ej.copyFrom(e),ej.computeUp(this.viewingMode),tj.camera=ej,this.events.emit("before-camera-change",tj);var r=this._get("camera");if(this.cameraProjectionChanged(this._lastSeenCameraProjectionValues,ej)&&(this._lastSeenCameraProjectionValues.copyFrom(ej),rj.camera=this._lastSeenCameraProjectionValues,this.events.emit("camera-projection-changed",rj)),(!r||!r.equals(ej))&&(this._set("camera",this._propertiesPool.get("camera").copyFrom(ej)),this._cameraChanged=!r||!r.almostEquals(ej),this._cameraChanged))var n=Object(YO.a)((function(){t._cameraChanged=!1,n.remove()}))}},{key:"contentCamera",get:function(){return Object(I.j)(this._contentCamera)?this._contentCamera:this.camera},set:function(e){this._contentCamera=Object(I.j)(e)?e.clone():null}},{key:"fixedContentCamera",get:function(){return!!Object(I.j)(this._contentCamera)}},{key:"isGlobal",get:function(){return 1===this.viewingMode}},{key:"isLocal",get:function(){return 2===this.viewingMode}},{key:"navigating",get:function(){return!(!this.cameraController||!this.cameraController.isInteractive)}},{key:"stationary",get:function(){return!this._cameraChanged&&!this.navigating}},{key:"cameraController",get:function(){return this._get("cameraController")},set:function(e){var t=this;this.stopActiveCameraController()?(e&&(e.watch("state",(function(r){r!==ip.Finished&&r!==ip.Stopped||(t._set("cameraController",null),t.updateCamera((function(t){return e.onControllerEnd(t)})))}),!0),e.onControllerStart(this.camera)),this._set("cameraController",e)):e&&(e.state=ip.Rejected)}},{key:"switchCameraController",value:function(e){return this.cameraController=e,e.state!==ip.Rejected}},{key:"stopActiveCameraController",value:function(){return!(this.cameraController&&!this.cameraController.stopController())}},{key:"updateCamera",value:function(e){this.updateQueue.push(e),this.processUpdateQueue()}},{key:"processUpdateQueue",value:function(){if(0!==this.updateQueue.length&&!this.processingUpdates){this.processingUpdates=!0;var e=this.updateQueue.shift();ej.copyFrom(this._get("camera")),e(ej),this.camera=ej,this.processingUpdates=!1,this.processUpdateQueue()}}},{key:"cameraProjectionChanged",value:function(e,t){return e.fov!==t.fov||e.fullViewport[0]!==t.fullViewport[0]||e.fullViewport[1]!==t.fullViewport[1]||e.fullViewport[2]!==t.fullViewport[2]||e.fullViewport[3]!==t.fullViewport[3]||e.padding[0]!==t.padding[0]||e.padding[1]!==t.padding[1]||e.padding[2]!==t.padding[2]||e.padding[3]!==t.padding[3]}}]),r}(de.a);Object(b.a)([Object(y.b)({readOnly:!0,type:Xc})],JO.prototype,"animation",null),Object(b.a)([Object(y.b)({type:zf.a})],JO.prototype,"camera",null),Object(b.a)([Object(y.b)({})],JO.prototype,"_contentCamera",void 0),Object(b.a)([Object(y.b)({type:zf.a})],JO.prototype,"contentCamera",null),Object(b.a)([Object(y.b)({readOnly:!0})],JO.prototype,"fixedContentCamera",null),Object(b.a)([Object(y.b)({readOnly:!0})],JO.prototype,"constraints",void 0),Object(b.a)([Object(y.b)({readOnly:!0})],JO.prototype,"events",void 0),Object(b.a)([Object(y.b)({readOnly:!0})],JO.prototype,"isGlobal",null),Object(b.a)([Object(y.b)({readOnly:!0})],JO.prototype,"isLocal",null),Object(b.a)([Object(y.b)({readOnly:!0})],JO.prototype,"viewingMode",void 0),Object(b.a)([Object(y.b)({readOnly:!0})],JO.prototype,"spatialReference",void 0),Object(b.a)([Object(y.b)({readOnly:!0})],JO.prototype,"navigating",null),Object(b.a)([Object(y.b)({readOnly:!0})],JO.prototype,"stationary",null),Object(b.a)([Object(y.b)()],JO.prototype,"_cameraChanged",void 0),Object(b.a)([Object(y.b)()],JO.prototype,"cameraController",null);var KO=JO=Object(b.a)([Object(w.a)("esri.views.3d.state.ViewState")],JO),ej=new zf.a,tj={camera:null},rj={camera:null},nj=KO,ij=r(69);var aj=function(){function e(t,r){Object(c.a)(this,e),this.elevationProvider=t,this._referenceEllipsoid=Object(J.e)(r),this.unitInMeters=Object(ij.f)(r,this._referenceEllipsoid.metersPerDegree)}return Object(l.a)(e,[{key:"compute",value:function(e,t,r,n,i){i||(i={near:0,far:0});var a=e[2]*this.unitInMeters,o=a,s=a-n,c=this.elevationProvider?this.elevationProvider.elevationBounds:null;c&&(a=s>=0?o-this.unitInMeters*c.min:this.unitInMeters*c.max-o);var l={x:r.xmax-r.xmin,y:r.ymax-r.ymin,z:4*Math.max(r.xmax-r.xmin,r.ymax-r.ymin)},u=Math.max(l.x,l.y,l.z);Object(Yl.l)(fj,t,e),hj[0]=fj[0]>0?r.xmax:r.xmin,hj[1]=fj[1]>0?r.ymax:r.ymin,hj[2]=fj[2]>0?u/2:-u/2,Object(Yl.l)(hj,hj,e),Object(Yl.t)(fj,fj);var d=1.1*Object(Yl.j)(hj,fj)*this.unitInMeters,h=Math.sqrt(a*(a+2*this._referenceEllipsoid.radius)),f=Math.max(r.xmax-r.xmin,r.ymax-r.ymin),p=f*uj*this.unitInMeters,b=f*dj*this.unitInMeters,v=Object(m.e)((a-b)/(p-b),0,1);v*=v*v;var y=Object(m.m)(h,d,v);return y*=Math.max(Math.log(Math.abs(s)),1),y=Math.min(y,Math.max(34064e4,u)),sj(y/=this.unitInMeters,cj,this.unitInMeters,i)}}]),e}(),oj=function(){function e(t){Object(c.a)(this,e),this._referenceEllipsoid=Object(J.e)(t)}return Object(l.a)(e,[{key:"compute",value:function(e,t,r,n,i){i||(i={near:0,far:0});var a=Object(Yl.r)(e)-this._referenceEllipsoid.radius,o=this._referenceEllipsoid.radius+Math.min(0,n),s=Math.abs(a-n),c=Math.max(s,Math.abs(a));return sj(1.2*Math.sqrt(c*(c+2*o)),Object(m.e)(2e4-(Math.log(c)-7.983)/9.011*19e3,1e3,2e4),1,i)}}]),e}();function sj(e,t,r,n){var i=lj/r;return e/t>i?(n.far=e,n.near=n.far/t):(n.near=i,n.far=n.near*t),n}var cj=2e4,lj=2,uj=.001,dj=1e-4,hj=Object(X.e)(),fj=Object(X.e)(),pj=function(e){Object(f.a)(r,e);var t=Object(p.a)(r);function r(e){var n;return Object(c.a)(this,r),(n=t.call(this,e)).handles=new oe.a,n}return Object(l.a)(r,[{key:"initialize",value:function(){var e=this;this.handles.add(this.view.basemapTerrain.on("elevation-change",(function(t){return e.handleElevationChangeEvent(t)})))}},{key:"destroy",value:function(){this.handles&&(this.handles.destroy(),this.handles=null)}},{key:"handleElevationChangeEvent",value:function(e){if(!this.view.state.cameraController){var t=this.view.state.camera;ph(this.view,t,e.extent,e.spatialReference)&&this.applyToCurrentCamera()}}},{key:"applyToCurrentCamera",value:function(){var e=this;this.view.state.updateCamera((function(t){wh(e.view,t,1)}))}}]),r}(de.a);Object(b.a)([Object(y.b)({constructOnly:!0})],pj.prototype,"view",void 0);var bj=pj=Object(b.a)([Object(w.a)("esri.views.3d.state.ElevationCollisionConstraint")],pj),vj=function(e){Object(f.a)(r,e);var t=Object(p.a)(r);function r(e){var n;return Object(c.a)(this,r),(n=t.call(this,e))._handles=new oe.a,n.nearFarHeuristic=function(e,t,r){return 1===e?new oj(r):new aj(t,r)}(e.view.state.viewingMode,e.view.basemapTerrain,e.view.renderCoordsHelper.spatialReference),n}return Object(l.a)(r,[{key:"initialize",value:function(){var e=this;this._handles.add([this.view.watch(["constraints.clipDistance.near","constraints.clipDistance.far"],(function(){return e._clipDistanceNearFarChanged()})),this.view.watch("constraints.clipDistance.mode",(function(){return e._updateNearFar()})),this.view.state.events.on("before-camera-change",(function(t){return e._updateCameraNearFar(t.camera)})),this.view.watch("dataExtent",(function(){return e._updateNearFar()}),!0),this.view.watch(["constraints.altitude.min","constraints.altitude.max"],(function(){return e._updateAltitude()}),!0),this.view.watch("constraints.tilt.max",(function(){return e._updateTiltMax()}),!0),this.view.watch("constraints.tilt.mode",(function(){return e._updateTilt()}),!0),this.view.watch("state.camera",(function(){return e._updateTiltAutoMax()}),!0),this.view.watch(["map.ground.navigationConstraint.type","constraints.collision.enabled"],(function(){return e._updateCollision()}),!0)]),this.view.state.isLocal&&this._handles.add(Object(W.a)(this.view,"dataExtent",(function(t){return e._updateLocalSurfaceDistance(t)}))),this._updateNearFar(),2!==this.view.state.viewingMode&&this._updateAltitude(),this._updateTilt(),this._updateCollision(),this._set("surfaceCollisionConstraint",new bj({view:this.view}))}},{key:"destroy",value:function(){this._handles=Object(I.e)(this._handles),this.surfaceCollisionConstraint&&(this.surfaceCollisionConstraint.destroy(),this._set("surfaceCollisionConstraint",null))}},{key:"_clipDistanceNearFarChanged",value:function(){var e=this,t=this.view.constraints&&this.view.constraints.clipDistance;t&&"auto"!==t.mode&&this.view.state.updateCamera((function(r){return e._updateCameraNearFarManual(r,t),!0}))}},{key:"_updateNearFar",value:function(){var e=this;this.view.state.updateCamera((function(t){return e._updateCameraNearFar(t),!0}))}},{key:"_updateCameraNearFar",value:function(e){var t=this.view.constraints&&this.view.constraints.clipDistance;"manual"===(t?t.mode:"auto")?this._updateCameraNearFarManual(e,t):this._updateCameraNearFarAuto(e,t)}},{key:"_updateCameraNearFarAuto",value:function(e,t){this.nearFarHeuristic.compute(e.eye,e.center,this.view.dataExtent,bh(this.view,e.eye),e),t&&t.autoUpdate(e.near,e.far)}},{key:"_updateCameraNearFarManual",value:function(e,t){t&&(e.near=t.near,e.far=t.far)}},{key:"_updateCollision",value:function(){var e,t,r,n=null==(e=this.view.map)||null==(t=e.ground)||null==(r=t.navigationConstraint)?void 0:r.type,i=!n||"stay-above"===n,a=this.view.state.constraints.collision;if(i!==a.enabled){a.enabled=i,i&&this._reapplyConstraints(8);var o=this.view.constraints&&this.view.constraints.tilt;o&&"auto"!==o.mode||this._updateTiltAuto()}}},{key:"_updateAltitude",value:function(){var e=this.view.constraints&&this.view.constraints.altitude;e&&2!==this.view.state.viewingMode?this.view.state.constraints.altitude={min:e.min,max:e.max}:this.view.state.constraints.altitude=null,this._reapplyConstraints()}},{key:"_updateTiltMax",value:function(){var e=this.view.constraints&&this.view.constraints.tilt;e&&"auto"!==e.mode&&(this._updateTiltManual(e),this._reapplyConstraints())}},{key:"_updateTilt",value:function(){var e=this.view.constraints&&this.view.constraints.tilt;"manual"===(e?e.mode:"auto")?this._updateTiltManual(e):this._updateTiltAuto(),this._reapplyConstraints()}},{key:"_updateTiltManual",value:function(e){var t=this.view.state.constraints;t.tilt=t.createConstantMaxTilt(Object(m.g)(e.max))}},{key:"_updateTiltAuto",value:function(){var e=this.view.state.constraints;e.tilt=e.createDefaultTilt(),this._updateTiltAutoMax()}},{key:"_updateTiltAutoMax",value:function(){var e=this.view.constraints&&this.view.constraints.tilt;if(e&&"auto"===e.mode){var t=this.view.state.constraints;if(t.tilt){var r=t.tilt(this.view.state.camera.distance).max;e.autoUpdate(Object(m.r)(r))}}}},{key:"_updateLocalSurfaceDistance",value:function(e){var t=Math.max(e.width,e.height);if(!(t<=0)){e.hasZ&&(t=Math.max(t,e.zmax-e.zmin));var r=this.view.state,n=3*t/Math.atan(r.camera.fov/2);n!==r.constraints.distance&&(r.constraints.distance=n)}}},{key:"_reapplyConstraints",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:15;this.view.state.updateCamera((function(r){return jf(e.view,r,{selection:t,interactionType:0,interactionFactor:null,interactionStartCamera:null,interactionDirection:null,tiltMode:0})}))}}]),r}(de.a);Object(b.a)([Object(y.b)({constructOnly:!0})],vj.prototype,"view",void 0),Object(b.a)([Object(y.b)({readOnly:!0})],vj.prototype,"surfaceCollisionConstraint",void 0);var mj=vj=Object(b.a)([Object(w.a)("esri.views.3d.state.ConstraintsManager")],vj),yj=function(e){Object(f.a)(r,e);var t=Object(p.a)(r);function r(e){var n;return Object(c.a)(this,r),(n=t.call(this,e)).handles=new oe.a,n}return Object(l.a)(r,[{key:"desiredCamera",set:function(e){this._set("desiredCamera",e.clone())}},{key:"canStop",get:function(){return!0}},{key:"constraintEnabled",get:function(){return this.view.state.constraints.collision.enabled}},{key:"onControllerStart",value:function(){var e=this;this.state=ip.Running,this.handles.add(this.view.basemapTerrain.on("elevation-change",(function(t){return e.handleElevationChangeEvent(t)}))),this.applyCorrection()}},{key:"onControllerEnd",value:function(){this.handles.removeAll()}},{key:"stepController",value:function(){}},{key:"handleElevationChangeEvent",value:function(e){ph(this.view,this.desiredCamera,e.extent,e.spatialReference)&&this.applyCorrection()}},{key:"applyCorrection",value:function(){var e=this;this.view.state.updateCamera((function(t){t.copyViewFrom(e.desiredCamera),wh(e.view,t,1)||e.constraintEnabled||(e.state=ip.Stopped)}))}}]),r}(up);Object(b.a)([Object(y.b)({constructOnly:!0})],yj.prototype,"view",void 0),Object(b.a)([Object(y.b)({constructOnly:!0})],yj.prototype,"desiredCamera",null),yj=Object(b.a)([Object(w.a)("esri.views.3d.state.controllers.SurfaceCollisionCorrectionController")],yj);var gj=r(160);function Oj(e){return 360-T.e.normalize(e)}function jj(e){return T.e.normalize(360-e)}function _j(e){return Object(I.j)(e)&&e.resolver&&e.resolver.reject(),null}function wj(e,t){return Object(I.j)(e)&&e.resolver&&e.resolver.resolve(t),t}function xj(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;if(!t)return _j(n);var i=e.spatialReference||Gs.a.WGS84;if(Object(I.j)(t.camera)){var a=t.get("camera.position.spatialReference");if(!Object(re.a)(a,i))return _j(n);var o=t.camera.clone();return a.equals(i)||(o.position=Object(re.d)(o.position,i)),wj(n,o)}if(Object(I.i)(t.targetGeometry))return _j(n);var s=t.get("targetGeometry.spatialReference");if(s&&!Object(re.a)(s,i))return _j(n);var c=Iv(e,e.state.camera),l=1;if(null!=t.rotation&&(c.heading=Oj(t.rotation),l=0),null!=r&&(c.tilt=r),"point"===t.targetGeometry.type){var u=t.targetGeometry,d=t.targetGeometry.clone();return zv(e,d,null!=t.scale?Dv(e,t.scale,u.latitude):e.state.camera.distance,c,l,n)}var h=t.targetGeometry.extent;return qv(e,h,c.heading,c.tilt,l,n)}function kj(){return(kj=Object(s.a)(o.a.mark((function e(t,r,n){var i,a,s,c,l,u,d,h,f;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=Xj(t,r)){e.next=3;break}throw new U.a("viewpointutils-create:no-target","Missing target for creating viewpoint");case 3:if(a=new P({fov:t.camera.fov}),s=new z({camera:a}),!(i.target instanceof z)){e.next=10;break}return e.t0=Yj,e.next=8,Dj(t,i.target,i,n,s);case 8:return e.t1=e.sent,e.abrupt("return",(0,e.t0)(e.t1));case 10:if(!(i.target instanceof P)){e.next=12;break}return e.abrupt("return",Yj(Lj(t,i.target,s)));case 12:if(c=null!=i.scale||null!=i.zoom,!(i.target instanceof Bs.a)){e.next=27;break}if(l=i.target.xmin===i.target.xmax||i.target.ymin===i.target.ymax,e.t2=Yj,!c&&!l){e.next=22;break}return e.next=19,Vj(t,i,i.target.center,a,n,s);case 19:e.t3=e.sent,e.next=25;break;case 22:return e.next=24,qj(t,i,i.target,a,n,s);case 24:e.t3=e.sent;case 25:return e.t4=e.t3,e.abrupt("return",(0,e.t2)(e.t4));case 27:return u={boundingBox:Object(Eg.k)(),hasZ:!1,screenSpaceObjects:[]},d=c?Tj(t,i):void 0,e.next=30,Rj(t,i.target,d,u);case 30:if(!isFinite(u.boundingBox[0])){e.next=43;break}if(Object(Eg.e)(u.boundingBox,Jj),s_.x=Jj[0],s_.y=Jj[1],s_.z=Jj[2],s_.spatialReference=t.spatialReference,isFinite(s_.z)&&u.hasZ?h=Object(Eg.x)(u.boundingBox):(s_.z=void 0,h=Object(K.w)(Object(Eg.F)(u.boundingBox,r_))),!c&&!h){e.next=37;break}return e.t5=Yj,e.next=35,Vj(t,i,s_,a,n,s);case 35:return e.t6=e.sent,e.abrupt("return",(0,e.t5)(e.t6));case 37:return f=$j(t,u.screenSpaceObjects),e.t7=Yj,e.next=41,Qj(t,i,s_,u.boundingBox,f,a,n,s);case 41:return e.t8=e.sent,e.abrupt("return",(0,e.t7)(e.t8));case 43:if(!i.position){e.next=47;break}e.t9=Yj(Uj(t,i,a,s)),e.next=52;break;case 47:return e.t10=Yj,e.next=50,Bj(t,i,a,n,s);case 50:e.t11=e.sent,e.t9=(0,e.t10)(e.t11);case 52:return e.abrupt("return",e.t9);case 53:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Sj(e,t){return null==t.scale&&null!=t.zoom?Yv(e,t.zoom):t.scale}function Tj(e,t){return function(e,t){return e.spatialReference?Object(te.a)(t,e.spatialReference):void 0}(e,Sj(e,t))}function Cj(e,t){var r=!1;return null!=t.heading?(e.heading=t.heading,r=!0):null!=t.rotation&&(e.heading=Oj(t.rotation),r=!0),null!=t.tilt&&(e.tilt=t.tilt,r=!0),null!=t.fov&&(e.fov=t.fov),r}function Mj(e,t,r,n){var i=e.spatialReference||Gs.a.WGS84;return t=Object(I.j)(t)?t:Ev(e,r),Object(I.i)(t)||(n.targetGeometry=Object($.y)(t.center,e.renderSpatialReference,i),n.scale=$v(e,t),n.rotation=jj(r.heading),n.camera=r),n}function Pj(e,t,r){if(t){if(!Object(re.a)(t.spatialReference,e.spatialReference))throw new U.a("viewpointutils:incompatible-spatialreference","Spatial reference (".concat(t.spatialReference?t.spatialReference.wkid:"unknown",") is incompatible with the view (").concat(e.spatialReference.wkid,")"),{geometry:t});var n=[];if(!t.hasZ&&e.basemapTerrain){var i;switch(t.type){case"point":i=t;break;case"multipoint":case"polyline":i=t.extent.center;break;case"mesh":i=t.origin;break;case"extent":i=t.center;break;case"polygon":i=t.centroid}i&&Object(re.a)(i,e.basemapTerrain.spatialReference)?Jj[2]=Object(I.t)(Object(Ms.b)(e.elevationProvider,i),0):Jj[2]=0}(0,c_[t.type])(t,(function(e){n.push(e[0],e[1],e[2])}),Jj);var a=n.length/3;if(0!==a){var o=new Array(n.length);if(Object($.q)(n,t.spatialReference,0,o,e.spatialReference,0,a)){t.hasZ&&(r.hasZ=!0);for(var s=0;s<o.length;s+=3)t.hasZ?(Jj[0]=o[s+0],Jj[1]=o[s+1],Jj[2]=o[s+2]):(Jj[0]=o[s+0],Jj[1]=o[s+1]),Object(Eg.r)(r.boundingBox,Jj)}}}}function Aj(e,t,r,n){return Ej.apply(this,arguments)}function Ej(){return(Ej=Object(s.a)(o.a.mark((function e(t,r,n,i){var a,s,c,l,u,d;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(wg.d)(t.whenViewForGraphic(r));case 2:if(!1!==(a=e.sent).ok&&!Object(I.i)(a.value)&&"whenGraphicBounds"in a.value){e.next=5;break}return e.abrupt("return",void Pj(t,r.geometry,i));case 5:return s=a.value,e.next=8,Object(wg.d)(s.whenGraphicBounds(r,{minDemResolution:n}));case 8:if(!1!==(c=e.sent).ok){e.next=11;break}return e.abrupt("return",void Pj(t,r.geometry,i));case 11:l=c.value,u=l.screenSpaceObjects,d=l.boundingBox,Object(Eg.m)(i.boundingBox,d),u&&u.forEach((function(e){i.screenSpaceObjects.push(e)})),isFinite(d[2])&&(i.hasZ=!0);case 13:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Rj(e,t,r,n){return Ij.apply(this,arguments)}function Ij(){return(Ij=Object(s.a)(o.a.mark((function e(t,r,n,i){var a,s;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!Array.isArray(r)||2!==r.length){e.next=4;break}if(a=r[0],s=r[1],"number"!=typeof a||"number"!=typeof s){e.next=4;break}return e.abrupt("return",(s_.x=a,s_.y=s,s_.z=void 0,s_.spatialReference=t.spatialReference.isGeographic?t.spatialReference:Gs.a.WGS84,void Pj(t,s_,i)));case 4:if(!r||"function"!=typeof r.map){e.next=9;break}return e.next=7,Object(q.k)(r.map((function(e){return Rj(t,e,n,i)})));case 7:e.next=17;break;case 9:if(!(r instanceof gj.a)){e.next=13;break}Pj(t,r,i),e.next=17;break;case 13:if(e.t0=r instanceof E.a,!e.t0){e.next=17;break}return e.next=17,Aj(t,r,n,i);case 17:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Dj(e,t,r,n,i){return Fj.apply(this,arguments)}function Fj(){return(Fj=Object(s.a)(o.a.mark((function e(t,r,n,i,a){var s,c;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!Object(I.j)(r.camera)){e.next=2;break}return e.abrupt("return",Lj(t,r.camera,a));case 2:return a.scale=r.scale,a.rotation=r.rotation,a.targetGeometry=Object(I.j)(r.targetGeometry)?r.targetGeometry.clone():null,a.camera=null,null!=n.heading?a.rotation=jj(n.heading):null!=n.rotation&&(a.rotation=n.rotation),null!=(s=Sj(t,n))&&(a.scale=s),c=new Jv(i),xj(t,a,n.tilt,c),e.next=9,c.resolver.promise;case 9:return a.camera=e.sent,e.abrupt("return",a);case 11:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Lj(e,t,r){var n=e.spatialReference,i=t.position.spatialReference;return Object(re.a)(i,n)?((t=t.clone()).fov=e.camera.fov,i.equals(n)||(t.position=Object(re.d)(t.position,n)),Mj(e,null,t,r)):null}function zj(e,t,r,n,i,a){var o=e.renderSpatialReference;return Object($.u)(r.position,i_,o),Object($.u)(t,a_,o),a.targetGeometry=new S.a(t),i.position=new S.a(r.position),Object(Yl.l)(n_,a_,i_),Vv(e,i_,n_,n.up,i),a.scale=Fv(e,Object(Yl.o)(i_,a_),a.targetGeometry.latitude),a.rotation=jj(i.heading),a.camera=i,a}function Vj(e,t,r,n,i,a){return Nj.apply(this,arguments)}function Nj(){return(Nj=Object(s.a)(o.a.mark((function e(t,r,n,i,a,s){var c,l,u,d,h;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!Object(I.i)(n)){e.next=2;break}throw new U.a("createfromcenter","invalid point");case 2:if(s.targetGeometry=n.clone(),c=vh(t),!r.position){e.next=6;break}return e.abrupt("return",zj(t,s.targetGeometry,r,c,i,s));case 6:if(r.zoomFactor&&(l=c.distance/r.zoomFactor,u=Object(Yl.g)(Jj,c.viewForward,-l),c.eye=Object(Yl.h)(Jj,c.center,u),s.scale=Fv(t,l,n.latitude)),Iv(t,c,i),d=Cj(i,r)?0:1,r.zoomFactor){e.next=16;break}return s.scale=Sj(t,r),null==s.scale&&(Object($.u)(n,Jj,t.renderSpatialReference),Object(yO.h)(c.frustum,Jj)?s.scale=Fv(t,Object(Yl.o)(c.eye,Jj),n.latitude):s.scale=$v(t,c)),h=new Jv(a),Lv(t,s.targetGeometry,s.scale,i,d,h),e.next=15,h.resolver.promise;case 15:s.camera=e.sent;case 16:return e.abrupt("return",s);case 17:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Uj(e,t,r,n){var i=vh(e);return Object(Yl.m)(n_,i.viewForward),Vv(e,i.eye,n_,i.up,o_),r.position=new S.a(t.position),r.heading=null!=t.heading?t.heading:o_.heading,r.tilt=null!=t.tilt?t.tilt:o_.tilt,Mj(e,null,r,n)}function Bj(e,t,r,n,i){return Gj.apply(this,arguments)}function Gj(){return(Gj=Object(s.a)(o.a.mark((function e(t,r,n,i,a){var s;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=vh(t),e.abrupt("return",Vj(t,r,Object($.y)(s.center,t.renderSpatialReference,t.spatialReference),n,i,a));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function qj(e,t,r,n,i,a){return Hj.apply(this,arguments)}function Hj(){return(Hj=Object(s.a)(o.a.mark((function e(t,r,n,i,a,s){var c,l,u;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s.targetGeometry=n.clone(),c=vh(t),Iv(t,c,i),l=Cj(i,r)?0:1,u=new Jv(a),qv(t,n,i.heading,i.tilt,l,u),e.next=7,u.resolver.promise;case 7:return s.camera=e.sent,e.abrupt("return",s);case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Wj(e,t,r,n,i){var a=0;r.hasZ?a=r.z:e.basemapTerrain&&(a=Object(I.s)(Object(Ms.b)(e.elevationProvider,r))),Object(Yl.y)(Jj,r.x,r.y,a),Object($.d)(e.spatialReference,Jj,Kj,e.renderSpatialReference),Object(Tf.f)(e_,Kj),Object(Tf.n)(e_,e_),Object(Eg.k)(t_);for(var o=[[0,1,2],[3,1,2],[0,4,2],[3,4,2],[0,1,5],[3,1,5],[0,4,5],[3,4,5]],s=0;s<o.length;s++){var c=o[s],l=n[c[2]];isFinite(l)||(l=a),Object(Yl.y)(Jj,n[c[0]],n[c[1]],l),Object($.z)(Jj,e.spatialReference,Jj,e.renderSpatialReference),Object(Eg.r)(t_,Object(Yl.z)(Jj,Jj,e_))}var u=Object(Eg.G)(t_),d=Object(Eg.u)(t_),h=Object(Eg.i)(t_),f=1/Math.tan(t.fovX/2),p=1/Math.tan(t.fovY/2),b=.5*Math.sqrt(u*u+h*h)*Math.max(p,f)+.5*d,v=.5*d*p+.5*Math.max(u,h);return Math.max(b,v)/i}function Qj(e,t,r,n,i,a,o,s){return Zj.apply(this,arguments)}function Zj(){return(Zj=Object(s.a)(o.a.mark((function e(t,r,n,i,a,s,c,l){var u,d,h,f;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return l.targetGeometry=n.clone(),u=vh(t),d=Wj(t,u,n,i,a),Iv(t,u,s),h=Cj(s,r)?0:1,l.scale=Fv(t,d,l.targetGeometry.latitude),f=new Jv(c),Lv(t,l.targetGeometry,l.scale,s,h,f),e.next=9,f.resolver.promise;case 9:return l.camera=e.sent,e.abrupt("return",l);case 11:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Xj(e,t){if(!t||!e.spatialReference)return null;var r={target:null};if("declaredClass"in t||Array.isArray(t))r.target=t;else{for(var n in t)r[n]=t[n];t.center&&!r.target&&(r.target=t.center)}return r}function Yj(e){return e&&Object(I.j)(e.camera)&&(e.rotation=jj(e.camera.heading)),e}function $j(e,t){if(!t.length)return.66;for(var r=Number.NEGATIVE_INFINITY,n=0;n<t.length;n++){var i=t[n].screenSpaceBoundingRect;r=Math.max(r,Math.abs(i[0]),Math.abs(i[1]),Math.abs(i[2]),Math.abs(i[3]))}return.66-r/Math.min(e.width,e.height)*2}var Jj=Object(X.e)(),Kj=Object(Kl.d)(),e_=Object(Cf.b)(),t_=Object(Eg.h)(),r_=Object(K.k)(),n_=Object(X.e)(),i_=Object(X.e)(),a_=Object(X.e)(),o_={heading:0,tilt:0},s_=new S.a,c_={point:function(e,t,r){r[0]=e.x,r[1]=e.y,e.hasZ&&(r[2]=e.z),t(r)},polygon:function(e,t,r){for(var n=e.hasZ,i=0;i<e.rings.length;i++)for(var a=e.rings[i],o=0;o<a.length;o++)r[0]=a[o][0],r[1]=a[o][1],n&&(r[2]=a[o][2]),t(r)},polyline:function(e,t,r){for(var n=e.hasZ,i=0;i<e.paths.length;i++)for(var a=e.paths[i],o=0;o<a.length;o++)r[0]=a[o][0],r[1]=a[o][1],n&&(r[2]=a[o][2]),t(r)},multipoint:function(e,t,r){for(var n=e.points,i=e.hasZ,a=0;a<n.length;a++)r[0]=n[a][0],r[1]=n[a][1],i&&(r[2]=n[a][2]),t(r)},extent:function(e,t,r){e.hasZ?(t(Object(Yl.y)(r,e.xmin,e.ymin,e.zmin)),t(Object(Yl.y)(r,e.xmax,e.ymin,e.zmin)),t(Object(Yl.y)(r,e.xmin,e.ymax,e.zmin)),t(Object(Yl.y)(r,e.xmax,e.ymax,e.zmin)),t(Object(Yl.y)(r,e.xmin,e.ymin,e.zmax)),t(Object(Yl.y)(r,e.xmax,e.ymin,e.zmax)),t(Object(Yl.y)(r,e.xmin,e.ymax,e.zmax)),t(Object(Yl.y)(r,e.xmax,e.ymax,e.zmax))):(t(Object(Yl.y)(r,e.xmin,e.ymin,r[2])),t(Object(Yl.y)(r,e.xmax,e.ymin,r[2])),t(Object(Yl.y)(r,e.xmin,e.ymax,r[2])),t(Object(Yl.y)(r,e.xmax,e.ymax,r[2])))},mesh:function(e,t,r){var n=e.vertexAttributes&&e.vertexAttributes.position;if(n)for(var i=0;i<n.length;i+=3)t(Object(Yl.y)(r,n[i+0],n[i+1],n[i+2]))}},l_=function(){function e(t,r,n){var i=this;Object(c.a)(this,e),this.target=t,this.options=r,this.view=n,this.state="pending",this.abortController=null,this.animationController=null,this.promise=new Promise((function(e,t){i.resolveCallback=e,i.rejectCallback=t;var r=Object(q.e)();Object(I.j)(i.options.signal)&&Object(q.s)(i.options.signal,(function(){i.abort()})),i.abortController=r,i.waitForReady()}))}return Object(l.a)(e,[{key:"then",value:function(e,t){return this.promise.then(e,t)}},{key:"catch",value:function(e){return this.promise.catch(e)}},{key:"resolve",value:function(e){return this.state="finished",this.resolveCallback(e)}},{key:"reject",value:function(e){return this.state="finished",this.rejectCallback(e)}},{key:"abort",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];switch(this.state){case"pending":case"wait-for-ready":case"wait-for-viewpoint":this.reject(Object(q.f)());break;case"wait-for-animation-finish":!e&&Object(I.j)(this.animationController)&&this.view.state.cameraController===this.animationController&&this.animationController.active&&this.animationController.stopController(),this.reject(Object(q.f)())}}},{key:"waitForReady",value:function(){var e=this;this.state="wait-for-ready",this.view.ready?this.createViewPoint():Object(W.j)(this.view,"ready",this.abortController.signal).then((function(){e.createViewPoint()}),(function(t){e.reject(t)}))}},{key:"createViewPoint",value:function(){var e=this;"finished"!==this.state&&(this.state="wait-for-viewpoint",this.animationController=this.options.animate?this.getAnimationController():null,function(e,t,r){return kj.apply(this,arguments)}(this.view,this.target,this.abortController.signal).then((function(t){if("finished"!==e.state){var r=e.getCameraFromViewpoint(t);if(!Object(I.i)(r))if(e.options.animate){if(Object(I.i)(e.animationController))return;e.startAnimation(r,e.animationController)}else e.view.stateManager.setStateCamera(r.camera,{applyConstraints:!r.isFullySpecified,positionAndOrientationOnly:!0,doNotCancelGoToOperation:!0}),e.resolve()}}),(function(t){e.reject(t)})))}},{key:"getCameraFromViewpoint",value:function(e){var t=!!(this.target instanceof z&&this.target.camera||this.target instanceof P),r=e.camera;if(Object(I.i)(r))return null;if(!this.view.stateManager.isCompatible(r)){var n=r.position,i=n&&n.spatialReference,a=i?i.wkid:"none",o=this.view.spatialReference.wkid;return this.reject(new U.a("GotoAnimation:incompatible-spatialreference","Resulting camera has an incompatible spatial reference (camera: ".concat(a,", view: ").concat(o,")"),{camera:r})),null}var s=Ev(this.view,r);return Object(I.i)(s)?(this.reject(new U.a("GotoAnimation:invalid-camera","Resulting camera is invalid")),null):{viewpoint:e,camera:s,isFullySpecified:t}}},{key:"startAnimation",value:function(e,t){var r=this;this.state="wait-for-animation-finish";var n=t.viewAnimation;if(Object(I.i)(n))this.reject(new U.a("GotoAnimation:missing-animation","Unreachable code in view.stateManager"));else{if(n.update(e.viewpoint,"running"),!t.active||Object(I.i)(t.viewAnimation)||t.viewAnimation.target!==e.viewpoint||this.view.state.cameraController!==t)return this.abort();var i;e.isFullySpecified?(i=new yj({view:this.view,desiredCamera:e.camera}),wh(this.view,e.camera,1)):jf(this.view,e.camera),t.begin(e.camera,this.options);var a=function(e){if(!Object(I.i)(r.view.state))switch(t.state){case ip.Finished:switch(r.state){case"pending":case"wait-for-ready":case"wait-for-viewpoint":case"wait-for-animation-finish":r.resolve()}break;case ip.Ready:case ip.Rejected:case ip.Running:case ip.Stopped:switch(r.state){case"pending":case"wait-for-ready":case"wait-for-viewpoint":case"wait-for-animation-finish":r.reject(e)}}};n.when((function(){var n=r.view.state.cameraController;i&&(n&&n.active?n instanceof hp&&Object(I.j)(n.viewAnimation)&&n.viewAnimation.target===e.viewpoint&&(r.view.state.cameraController=i):Object(I.j)(t.viewAnimation)&&t.viewAnimation.target===e.viewpoint&&"finished"===t.state&&(r.view.state.cameraController=i))}),(function(e){return a(e)})),t.asyncResult={resolve:function(){return a()},reject:function(e){return a(e)}}}}},{key:"getAnimationController",value:function(){var e,t=null,r=this.view.state.cameraController;return r instanceof hp&&(r.updateStateFromViewAnimation(),r.active&&(t=(e=r).viewAnimation)),null!=e||(t=(e=new hp({view:this.view,mode:"animation"})).viewAnimation,this.view.state.switchCameraController(e))?e:(Object(I.j)(t)&&t.stop(),this.reject(new U.a("GotoAnimation:goto-cannot-interrupt","Cannot start an animation while interacting")),null)}}]),e}(),u_=j.a.getLogger("esri.views.3d.state.ViewStateManager"),d_=function(e){Object(f.a)(r,e);var t=Object(p.a)(r);function r(e){var n;return Object(c.a)(this,r),(n=t.call(this,e)).propertiesPool=new $O.a({frustum:gO},Object(u.a)(n)),n.handles=new oe.a,n.cameraSetByUser=!1,n.gotoOperation=null,n.ready=!1,n.updateDevicePixelRatio=null,n.test={contentCameraResetState:new Map},n}return Object(l.a)(r,[{key:"camera",get:function(){var e=this._get("camera");if(!this.ready)return e;var t=Iv(this.view,this.view.state.camera);return t&&e&&t.equals(e)?e:t},set:function(e){this.updatePropertyBeforeReady("camera",e)||this.setStateCamera(Ev(this.view,e),{applyConstraints:!1})||u_.error("#camera=","Invalid camera",e)}},{key:"contentCamera",get:function(){var e=this._get("contentCamera");if(!this.ready)return e;var t=Iv(this.view,this.view.state.contentCamera);return t&&e&&t.equals(e)?e:t},set:function(e){if(!this.updatePropertyBeforeReady("contentCamera",e)){var t=Ev(this.view,e);Object(I.i)(t)?this.view.state.contentCamera=null:(this.updateElevation(t),this.view.state.contentCamera=t)}}},{key:"installContentCameraReset",value:function(e){var t=this;if(this.handles.remove("contentCameraReset"),this.test.contentCameraResetState.clear(),!this.view.state.fixedContentCamera)return!1;var r=this.zoom,n=Math.pow(this.view.state.camera.distance,2),i=Object(X.f)(this.view.state.camera.center),a=e.sticky?this.contentCamera.clone():null;return this.handles.add([this.watch("contentCamera",(function(){e.sticky||(t.handles.remove("contentCameraReset"),t.test.contentCameraResetState.clear())})),this.watch("zoom",(function(e){t.test.contentCameraResetState.set("view.zoom",Math.abs(e-r)/2),Math.abs(e-r)>2?t.contentCamera=null:t.view.state.fixedContentCamera||(t.contentCamera=a)})),this.view.state.watch("camera",(function(e){var r=Object(Yl.n)(i,e.center);t.test.contentCameraResetState.set("camera.center",r/n),r>n?t.contentCamera=null:t.view.state.fixedContentCamera||(t.contentCamera=a)}))],"contentCameraReset"),!0}},{key:"center",get:function(){return this.ready?this.view.pointsOfInterest.centerOnContent.location:this._get("center")},set:function(e){this.updatePropertyBeforeReady("center",e)||(e?this.isCompatible(e)?this.setStateCamera(this.centerToCamera(e),{applyConstraints:!0})?this.view.pointsOfInterest.centerOnContent.runTask():u_.error("#center=","Invalid center",e):u_.error("#center=","Center has an incompatible spatial reference (center: "+(e.spatialReference?e.spatialReference.wkid:"none")+", view: "+this.view.spatialReference.wkid+")",e):u_.error("#center=","Center may not be null or undefined"))}},{key:"extent",get:function(){if(!this.ready)return this._get("extent");var e=this.view,t=function(e,t,r){var n=e.renderSpatialReference,i=Object($.y)(r,n,Pv(e));if(Object(I.i)(i))return null;var a=Math.tan(t.fovX/2),o=Math.tan(t.fovY/2),s=Object(Yl.p)(t.eye,r),c=2*s*a*1,l=2*s*o*1;return"global"===e.viewingMode?Ov(e,i,c,l):lv(e,i,c,l)}(e,e.state.camera,e.pointsOfInterest.centerOnContent.renderLocation);return Object(I.j)(t)?t:this._get("extent")},set:function(e){this.updatePropertyBeforeReady("extent",e)||(e?this.isCompatible(e)?this.setStateCamera(this.extentToCamera(e),{applyConstraints:!0})||u_.error("#extent=","Invalid extent",e):u_.error("#extent=","Extent has an incompatible spatial reference (extent: "+(e.spatialReference?e.spatialReference.wkid:"none")+", view: "+this.view.spatialReference.wkid+")",e):u_.error("#extent=","Extent may not be null or undefined"))}},{key:"frustum",get:function(){var e=this.propertiesPool.get("frustum");return e.renderCoordsHelper=this.view.renderCoordsHelper,e.update(this.view.state.camera),e}},{key:"hasInitialView",get:function(){return!!this.view.get("map.initialViewProperties.viewpoint")}},{key:"scale",get:function(){if(this.ready){var e=this.view.pointsOfInterest.centerOnContent;return Fv(this.view,e.distance,e.location.latitude)}return this._get("scale")},set:function(e){this.updatePropertyBeforeReady("scale",e)||this.setStateCamera(this.scaleToCamera(e),{applyConstraints:!0})||u_.error("#scale=","Invalid scale",e)}},{key:"padding",get:function(){if(!this.ready)return this._get("padding");var e=this.view.state.camera,t=e.padding,r=e.pixelRatio,n=this._get("padding"),i=Math.round(t[0]/r),a=Math.round(t[1]/r),o=Math.round(t[2]/r),s=Math.round(t[3]/r);return null!=n&&n.top===i&&n.right===a&&n.bottom===o&&n.left===s?n:{top:i,right:a,bottom:o,left:s}},set:function(e){this.updatePropertyBeforeReady("padding",e)||(this.paddingToArray(e,this.view.state.camera.pixelRatio,g_),this.view.state.updateCamera((function(e){return e.padding=g_})))}},{key:"paddingToArray",value:function(e,t,r){e?Object(Su.l)(r,e.top||0,e.right||0,e.bottom||0,e.left||0):Object(Su.l)(r,0,0,0,0);for(var n=0;n<4;n++)r[n]=Math.round(r[n]*t)}},{key:"screenCenter",get:function(){var e=this.padding;return Object(Z.e)((this.view.width-(e.left+e.right))/2+e.left,(this.view.height-(e.top+e.bottom))/2+e.top)}},{key:"viewpoint",get:function(){return this.ready?function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return Object(I.i)(r)&&(r=new z),Mj(e,null,t.clone(),r)}(this.view,this.camera):this._get("viewpoint")},set:function(e){if(!this.updatePropertyBeforeReady("viewpoint",e))if(e)if(this.isCompatible(e))this.setStateCamera(this.viewpointToCamera(e),{applyConstraints:!e.camera})||u_.error("#viewpoint=","Invalid viewpoint",e);else{var t=Object(I.j)(e.camera)?e.camera.position:e.targetGeometry,r=Object(I.j)(t)&&t.spatialReference;u_.error("#viewpoint=","Viewpoint has an incompatible spatial reference (viewpoint: "+(r?r.wkid:"none")+", view: "+this.view.spatialReference.wkid+")",e)}else u_.error("#viewpoint=","Viewpoint may not be null or undefined")}},{key:"zoom",get:function(){return this.ready?Xv(this.view,this.scale):this._get("zoom")},set:function(e){this.updatePropertyBeforeReady("zoom",e)||this.setStateCamera(this.zoomToCamera(e),{applyConstraints:!0})||u_.error("#zoom=","Invalid zoom",e)}},{key:"initialize",value:function(){var e=this;this.handles.add([Object(W.b)(this.view,"state.events","before-camera-change",(function(t){return e.updateElevation(t.camera)}))]),Object(W.c)(this.view.state,"camera",(function(t){return e.updateElevation(t)}),!0),this.handles.add(Object(H.a)({prepare:function(){return e.prepareFrame()}})),this.handles.add(this.view.state.watch("cameraController",(function(){e.cameraSetByUser=!0,e.handles.remove(O_)}))),this.handles.add(Object(W.b)(this.view,"state.events","camera-projection-changed",(function(){return e.notifyChange("scale")})))}},{key:"destroy",value:function(){this.deinit(),this.handles&&(this.handles.destroy(),this.handles=null),this.propertiesPool&&(this.propertiesPool.destroy(),this.propertiesPool=null)}},{key:"init",value:function(){var e=this;this.constraintsManager=new mj({view:this.view}),this.prepareFrame();var t=this.getInitialProperties();this.cameraSetByUser=!1,this._set("ready",!0);var r,n=Object(i.a)(t);try{for(n.s();!(r=n.n()).done;){var a=r.value;this.set(a.name,a.value)}}catch(s){n.e(s)}finally{n.f()}if(!this.cameraSetByUser){var o=this.view.get("map.initialViewProperties.viewpoint")||this.view.initialExtent;o&&this.isCompatible(o)?this.setInitialView(o):2===this.view.state.viewingMode&&this.handles.add(Object(W.j)(this.view.basemapTerrain,"ready",(function(){e.handles.remove(O_),e.setInitialView(e.view.groundExtent)})),O_)}}},{key:"deinit",value:function(){this.cancelGoToOperation(),this.ready&&(this._override("padding",this.padding),this._set("ready",!1),this._clearOverride("hasInitialView"),this.cameraSetByUser=!1,this.handles.remove(O_),this.constraintsManager&&(this.constraintsManager.destroy(),this.constraintsManager=null))}},{key:"goTo",value:function(){var e=Object(s.a)(o.a.mark((function e(t,r){var n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=Object(ie.a)({animate:!0},r),e.abrupt("return",(Object(I.j)(this.gotoOperation)&&this.gotoOperation.abort(n.animate),this.gotoOperation=new l_(t,n,this.view),this.view.resourceController.scheduler.stopFrame(),this.gotoOperation));case 2:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"debugSetCameraOnContent",value:function(){this.setStateCamera(vh(this.view),{applyConstraints:!1})}},{key:"step",value:function(e){var t=this.view.state,r=t&&this.view.state.cameraController;r&&(t.updateCamera((function(t){r.stepController(e,t)})),r.steppingFinished&&r.finishController())}},{key:"cancelGoToOperation",value:function(){Object(I.j)(this.gotoOperation)&&(this.gotoOperation.abort(),this.gotoOperation=null)}},{key:"getInitialProperties",value:function(){var e,t=new Set,r=[],n=Object(i.a)(b_);try{for(n.s();!(e=n.n()).done;){var a=e.value,o=a.propertyName,s=a.overrides,c=t.has(o),l=this._isOverridden(o);!c&&l&&r.push({name:o,value:this._get(o)}),this._clearOverride(o),(c||l)&&s.forEach((function(e){return t.add(e)}))}}catch(u){n.e(u)}finally{n.f()}return r}},{key:"setInitialView",value:function(e){if(e&&!this.cameraSetByUser)if(e instanceof P)this.setStateCamera(Ev(this.view,e),{applyConstraints:!1});else if(e instanceof z){if(e.targetGeometry instanceof Bs.a){var t=qv(this.view,e.targetGeometry,0,.5,0);return void(Object(I.j)(t)&&this.setStateCamera(Ev(this.view,t),{applyConstraints:!0}))}var r={applyConstraints:!e.camera},n=this.viewpointToCamera(e);this.setStateCamera(n,r)}else{var i=qv(this.view,e,0,.5,0);Object(I.j)(i)&&this.setStateCamera(Ev(this.view,i),{applyConstraints:!0})}}},{key:"updatePropertyBeforeReady",value:function(e,t){return!this.ready&&(this._override(e,t),t&&-1!==p_.indexOf(e)&&this._override("hasInitialView",!0),!0)}},{key:"isCompatible",value:function(e){return!Object(I.i)(e)&&(e instanceof z?e.camera?this.isCompatible(e.camera):this.isCompatible(e.targetGeometry):e instanceof P?this.isCompatible(e.position):e.spatialReference&&Object(re.a)(e.spatialReference,this.view.spatialReference))}},{key:"getPreservingHeadingTilt",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:v_;return this.cameraSetByUser?(e.heading=this.camera.heading,e.tilt=this.camera.tilt):(e.heading=0,e.tilt=.5),e}},{key:"centerPointAtDistanceToCamera",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:y_,n=this.getPreservingHeadingTilt(),i=n.heading,a=n.tilt,o=Bv(this.view,i,a,e,t,1);return Object(I.i)(o)?null:(r.copyFrom(this.view.state.camera),r.eye=o.eye,r.center=o.center,r.up=o.up,r)}},{key:"centerToCamera",value:function(e){var t=this.view.pointsOfInterest.centerOnContent;t.runTask();var r=t.distance;return this.centerPointAtDistanceToCamera(e,r)}},{key:"extentToCamera",value:function(e){var t=this.getPreservingHeadingTilt(),r=t.heading,n=t.tilt,i=qv(this.view,e,r,n,1,m_);return Object(I.j)(i)?Ev(this.view,i):null}},{key:"scaleToCamera",value:function(e){if(null==e)return null;var t=this.view.pointsOfInterest.centerOnContent;t.runTask();var r=t.renderLocation,n=t.location.latitude,i=Dv(this.view,e,n);return this.centerPointAtDistanceToCamera(r,i)}},{key:"zoomToCamera",value:function(e){return this.scaleToCamera(Yv(this.view,e))}},{key:"viewpointToCamera",value:function(e){return Ev(this.view,xj(this.view,e))}},{key:"setStateCamera",value:function(e,t){var r=this;return!(Object(I.i)(e)||!this.view.state.stopActiveCameraController())&&(this.cameraSetByUser=!0,t.doNotCancelGoToOperation||this.cancelGoToOperation(),this.view.state.updateCamera((function(n){t.positionAndOrientationOnly?(n.eye=e.eye,n.center=e.center,n.up=e.up):n.copyFrom(e),t.applyConstraints&&jf(r.view,n)})),t.applyConstraints||(this.view.state.cameraController=new yj({view:this.view,desiredCamera:e})),!0)}},{key:"prepareFrame",value:function(){var e=this.view,t=e.container,r=e.canvas;if(t&&r){Object(I.j)(this.updateDevicePixelRatio)&&this.updateDevicePixelRatio();var n=this.view.pixelRatio,i=Math.round(t.clientWidth*n),a=Math.round(t.clientHeight*n);if(0!==i&&0!==a&&(r.width===i&&r.height===a||(r.width=i,r.height=a),this.view.state)){var o=this.view.state.camera;o.fullWidth===i&&o.fullHeight===a&&o.pixelRatio===n||(y_.copyFrom(o),y_.pixelRatio!==n&&(this.paddingToArray(this.padding,n,g_),y_.padding=g_),y_.fullWidth=i,y_.fullHeight=a,y_.pixelRatio=n,this.view.state.camera=y_)}}}},{key:"updateElevation",value:function(e){var t=this.view.basemapTerrain&&this.view.basemapTerrain.spatialReference,r=this.view.renderCoordsHelper.getAltitude(e.eye),n=t?bh(this.view,e.eye):0;e.relativeElevation=r-n}}]),r}(de.a);Object(b.a)([Object(y.b)({type:P,dependsOn:["view.state.camera","ready"]})],d_.prototype,"camera",null),Object(b.a)([Object(y.b)({type:P,dependsOn:["view.state.contentCamera","ready"]})],d_.prototype,"contentCamera",null),Object(b.a)([Object(y.b)({type:S.a})],d_.prototype,"center",null),Object(b.a)([Object(y.b)({type:Bs.a})],d_.prototype,"extent",null),Object(b.a)([Object(y.b)({readOnly:!0})],d_.prototype,"frustum",null),Object(b.a)([Object(y.b)({readOnly:!0})],d_.prototype,"hasInitialView",null),Object(b.a)([Object(y.b)({readOnly:!0,type:Boolean})],d_.prototype,"ready",void 0),Object(b.a)([Object(y.b)({type:Number})],d_.prototype,"scale",null),Object(b.a)([Object(y.b)()],d_.prototype,"padding",null),Object(b.a)([Object(y.b)({readOnly:!0})],d_.prototype,"screenCenter",null),Object(b.a)([Object(y.b)({constructOnly:!0})],d_.prototype,"view",void 0),Object(b.a)([Object(y.b)({type:z})],d_.prototype,"viewpoint",null),Object(b.a)([Object(y.b)({type:Number})],d_.prototype,"zoom",null),Object(b.a)([Object(y.b)({constructOnly:!0})],d_.prototype,"updateDevicePixelRatio",void 0);var h_,f_=d_=Object(b.a)([Object(w.a)("esri.views.3d.state.ViewStateManager")],d_),p_=["camera","viewpoint","extent","scale","center","zoom"],b_=[{propertyName:"camera",overrides:["viewpoint"]},{propertyName:"viewpoint",overrides:["extent"]},{propertyName:"extent",overrides:["center","scale"]},{propertyName:"center",overrides:[]},{propertyName:"scale",overrides:["zoom"]},{propertyName:"zoom",overrides:[]},{propertyName:"padding",overrides:[]}],v_={heading:0,tilt:0},m_=new P,y_=new zf.a,g_=Object($l.e)(),O_="pending-initial-view",j_=f_,__=r(243),w_=function(){function e(t,r,n){Object(c.a)(this,e),this.viewingMode=t,this.layerProvider=r,this.view=n,this.externalIntersectionHandlers=new zy.a,this.tolerance=fh.a.DEFAULT_TOLERANCE,this.tmpRay=Object(Ud.c)(),this.validateHUDIntersector=new fh.a(this.viewingMode),this.validateHUDIntersector.options.hud=!1}return Object(l.a)(e,[{key:"intersectScreen",value:function(e,t){return this.intersectRay(this.getPickRay(e,this.tmpRay),k_(this.viewingMode),t)}},{key:"intersectScreenFreePointFallback",value:function(e,t){return this.intersectRayFreePointFallback(this.getPickRay(e,this.tmpRay),t)}},{key:"intersectRayFreePointFallback",value:function(e,t){return this.intersectRay(e,k_(this.viewingMode),t)||this.intersectRayFreePointLocal(e,t)}},{key:"intersectRay",value:function(e,t,r,n){return t.options.selectionMode=!1,t.options.store=0,this.computeIntersection(e,t,n),!!t.results.min&&t.results.min.getIntersectionPoint(r)}},{key:"getCenterRayWithSubpixelOffset",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.5,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5;return e.getRenderCenter(M_,r,n),M_[0]+=.0466,M_[1]-=.0123,Object(Ip.b)(e,M_,t)}},{key:"intersectIntersectorScreen",value:function(e,t,r){this.computeIntersection(this.getPickRay(e,this.tmpRay),t,r)}},{key:"intersectToolIntersectorScreen",value:function(e,t,r){var n=this.getPickRay(e,this.tmpRay);this.intersectToolIntersectorRay(n,t,r)}},{key:"intersectToolIntersectorRay",value:function(e,t,r){t.options.selectionMode=!0,this.computeIntersection(e,t,r);var n=t.results.min;this.view.basemapTerrain&&this.view.basemapTerrain.opaque||n.hasIntersectionPoint&&"TerrainRenderer"!==n.intersector||(t.options.selectionMode=!1,this.computeIntersection(e,t,r))}},{key:"setTolerance",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:fh.a.DEFAULT_TOLERANCE;this.tolerance=e}},{key:"addIntersectionHandler",value:function(e){this.externalIntersectionHandlers.push(e),this.externalIntersectionHandlers.sort((function(e,t){return"Terrain"===e.type?1:"Terrain"===t.type?-1:0}))}},{key:"removeIntersectionHandler",value:function(e){this.externalIntersectionHandlers.removeUnordered(e),this.externalIntersectionHandlers.sort((function(e,t){return"Terrain"===e.type?1:"Terrain"===t.type?-1:0}))}},{key:"getPickRay",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Object(Ud.c)(),r=this.view.state.camera;return Object(Ip.c)(r,e,t)}},{key:"intersectRayFreePointLocal",value:function(e,t){if(2!==this.viewingMode||Object(I.i)(e))return!1;var r=this.view.dataExtent,n={x:r.xmax-r.xmin,y:r.ymax-r.ymin,z:8*Math.max(r.xmax-r.xmin,r.ymax-r.ymin)},i=Math.max(n.x,n.y,n.z);if(0===i)return Object(Yl.h)(t,e.origin,Object(Yl.t)(yp.c.get(),e.direction)),!0;var a=this.view.state.camera,o=Math.max(0,r.xmin-a.eye[0],a.eye[0]-r.xmax),s=Math.max(0,r.ymin-a.eye[1],a.eye[1]-r.ymax),c=Math.sqrt(o*o+s*s),l=Math.abs(a.relativeElevation)+Number.MIN_VALUE,u=Math.pow(Math.max(0,Math.log(i/l)),2),d=i/Math.max(1,u);d=Math.max(d,Math.min(c,i));var h=Object(Yl.g)(yp.c.get(),e.direction,d/Object(Yl.r)(e.direction));return Object(Yl.h)(t,e.origin,h),!0}},{key:"intersectElevationFromScreen",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;return this.intersectElevation(this.getPickRay(e,this.tmpRay),t,r,n)}},{key:"intersectElevation",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;if(Object(I.i)(e))return null;var i=Object(I.j)(t)?t.mode:"absolute-height",a=Object(I.j)(t)?Object(I.t)(t.offset,0):0,o="on-the-ground"!==i?a+r:0,s=o/this.view.renderCoordsHelper.unitInMeters;if("absolute-height"===i){if(this.view.renderCoordsHelper.intersectInfiniteManifold(e,o,C_)){var c=this.view.computeMapPointFromVec3d(C_);return c.z-=a,c}return null}var l=this.view.state.camera,u=Object(Z.b)(yp.c.get());l.projectToRenderScreen(e.origin,u);var d=this.prepareFilters(null,S_),h=this.view.slicePlane,f=Object(I.j)(h)?Object(__.c)(h):null,p=new fh.a(this.viewingMode);p.options.store=0,p.options.verticalOffset=s;var b=e.origin,v=Object(Yl.h)(yp.c.get(),b,e.direction);p.reset(b,v),p.point=u,p.camera=l,p.filterPredicate=null;var m=Object(I.j)(n)?"type"in n&&"graphics"===n.type?function(e){return e.metadata.layerUid!==n.uid}:function(e){return e.metadata.graphicUid!==n.uid}:null;switch(i){case"relative-to-scene":var y=function(e){return(Object(I.i)(m)||m(e))&&e.metadata&&e.metadata.isElevationSource};p.intersect(d.layers,u,l,this.tolerance,null,y),this.externalIntersectionHandlers.forAll((function(e){if("I3S"===e.type||"Terrain"===e.type){var t=e.slicePlane?f:null;e.intersect(p,t,p.rayBeginPoint,p.rayEndPoint,u)}}));break;case"on-the-ground":case"relative-to-ground":this.externalIntersectionHandlers.forAll((function(e){if(e.isGround){var t=e.slicePlane?f:null;e.intersect(p,t,p.rayBeginPoint,p.rayEndPoint,u)}}))}if(p.results.min.getIntersectionPoint(C_)){var g=this.view.computeMapPointFromVec3d(C_);return g.z=r,g}return null}},{key:"computeIntersection",value:function(e,t,r){var n=this;if(!Object(I.i)(e)){var i=this.view.state.camera,a=Object(Z.b)(yp.c.get());i.projectToRenderScreen(e.origin,a);var o=this.prepareFilters(r,S_);t.options.selectOpaqueTerrainOnly=!r||!("include"in r||"exclude"in r);var s=e.origin,c=Object(Yl.h)(yp.c.get(),e.origin,e.direction);t.reset(s,c),t.intersect(o.layers,a,i,this.tolerance);var l=this.view.slicePlane,u=Object(I.j)(l)?Object(__.c)(l):null;t.intersect(o.sliceableLayers,a,i,this.tolerance,u);var d=r&&(r.requiresGroundFeedback||r.enableDraped);this.externalIntersectionHandlers.forAll((function(e){if(t.options.isFiltered=!o.filterLayerUid(e.intersectionHandlerId),e.isGround&&d||!t.options.isFiltered){var r=e.slicePlane?u:null;e.intersect(t,r,s,c,a)}}));var h=yp.c.get();if(r&&r.enableDraped&&t.results.ground.getIntersectionPoint(h)){var f=this.view.basemapTerrain.overlayManager.renderer,p=this.view.renderCoordsHelper.spatialReference,b=yp.c.get();this.view.renderCoordsHelper.fromRenderCoords(h,b,this.view.spatialReference),b[2]=Object(I.t)(this.view.elevationProvider.getElevation(h[0],h[1],h[2],p,"ground"),0),f.intersect(t,b,o.filterRenderGeometry)}t.sortResults();var v=t.results.hud;if(v.hasIntersectionPoint){var m=Object(Z.b)(yp.c.get()),y=yp.c.get(),g=yp.c.get();this.unprojectHUDResultRay(v.center,m,y,g);var O=Object(Yl.o)(v.center,y)/Object(Yl.o)(y,g)*.99;this.validateHUDIntersector.reset(y,g),this.validateHUDIntersector.intersect(o.layers,m,i,this.tolerance),this.validateHUDIntersector.intersect(o.sliceableLayers,m,i,this.tolerance,u),this.externalIntersectionHandlers.forAll((function(e){if(o.filterLayerUid(e.intersectionHandlerId)){var t=e.slicePlane?u:null;e.intersect(n.validateHUDIntersector,t,y,g,m)}}));var j=this.validateHUDIntersector.results.min;(null==j.dist||O<=j.dist)&&(t.results.min.copyFrom(v),t.results.all.splice(0,0,v))}}}},{key:"prepareFilters",value:function(e,t){var r=[],n=[];return this.layerProvider.forEachLayer((function(e){e.isPickable&&(e.isSliceable?n:r).push(e)})),t.include=e&&e.include,t.exclude=e&&e.exclude,t.layers.length=0,t.sliceableLayers.length=0,x_(r,t.filterLayer,t.layers),x_(n,t.filterLayer,t.sliceableLayers),t}},{key:"unprojectHUDResultRay",value:function(e,t,r,n){var i=this.view.state.camera;i.projectToRenderScreen(e,t);var a=Object(Z.b)(yp.c.get());a[0]=t[0],a[1]=t[1],a[2]=0,i.unprojectFromRenderScreen(a,r),a[2]=1,i.unprojectFromRenderScreen(a,n)}}]),e}();function x_(e,t,r){var n,a=Object(i.a)(e);try{for(a.s();!(n=a.n()).done;){var o=n.value;t&&!t(o)||r.push(o)}}catch(s){a.e(s)}finally{a.f()}return r}function k_(e){return h_||(h_=new fh.a(e)),h_.viewingMode=e,h_}var S_={include:null,exclude:null,layers:[],sliceableLayers:[],filterLayer:function(e){return S_.filterLayerUid(e.apiLayerUid)},filterLayerUid:function(e){var t=S_.include,r=S_.exclude;return Object(I.i)(e)?null==t&&null==r:(null==t||t.has(e))&&(null==r||!r.has(e))},filterRenderGeometry:function(e){return S_.filterLayerUid(e.layerUid)}};function T_(e){return"object"==typeof e&&"intersect"in e}var C_=Object(X.e)(),M_=Object(Z.c)(),P_=r(657),A_=function(e){Object(f.a)(r,e);var t=Object(p.a)(r);function r(e){var n;return Object(c.a)(this,r),(n=t.call(this,e)).im=new Array,n.ground=new Array,n.scene=new Array,n.handles=new Map,n}return Object(l.a)(r,[{key:"destroy",value:function(){this._elevationQuery=Object(I.e)(this._elevationQuery)}},{key:"elevationQuery",get:function(){var e=this;return Object(I.i)(this._elevationQuery)&&(this._elevationQuery=new P_.a(this.view.resourceController.scheduler,this.view.spatialReference,(function(){return e.view.map&&e.view.map.ground}),{maximumAutoTileRequests:4})),this._elevationQuery}},{key:"getElevation",value:function(e,t,r,n,i){var a=null;return a=E_(a,this.im,e,t,r,n,i),Object(I.i)(a)&&(a=E_(a,this.ground,e,t,r,n,i)),"scene"===i&&(a=E_(a,this.scene,e,t,r,n,i)),a}},{key:"queryElevation",value:function(e,t,r,n,i){var a=this,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,c=Object(q.h)();return this.elevationQuery.queryElevation(e,t,o,s).then((function(o){"scene"===i&&(o=E_(o,a.scene,e,t,r,n,i)),c.resolve(o)})).catch((function(o){Object(q.n)(o)?c.reject(o):c.resolve(a.getElevation(e,t,r,n,i))})),c.promise}},{key:"register",value:function(e,t){var r=this;this.handles.set(t,t.on("elevation-change",(function(e){return r.emit("elevation-change",e)}))),this[e].push(t)}},{key:"unregister",value:function(e){this.handles.has(e)&&(this.handles.get(e).remove(),this.handles.delete(e));for(var t=0,r=[this.im,this.ground,this.scene];t<r.length;t++){var n=r[t],i=n.indexOf(e);i>-1&&n.splice(i,1)}}}]),r}(Ii.a.EventedMixin(de.a));function E_(e,t,r,n,a,o,s){var c,l=Object(i.a)(t);try{for(l.s();!(c=l.n()).done;){var u=c.value.getElevation(r,n,a,o,s);Object(I.j)(u)&&(e=Object(I.j)(e)?Math.max(u,e):u)}}catch(d){l.e(d)}finally{l.f()}return e}Object(b.a)([Object(y.b)({constructOnly:!0})],A_.prototype,"view",void 0),Object(b.a)([Object(y.b)({readOnly:!0,aliasOf:"view.basemapTerrain.spatialReference"})],A_.prototype,"spatialReference",void 0),A_=Object(b.a)([Object(w.a)("esri.views.3d.support.CombinedElevationProvider")],A_);var R_=function(){function e(){Object(c.a)(this,e)}return Object(l.a)(e,null,[{key:"isValidProfile",value:function(t){return t in e.profiles}},{key:"getDefaultProfile",value:function(){return Object(g.a)("trident")||Object(g.a)("esri-iPhone")?"low":"medium"}},{key:"apply",value:function(t,r){var n=e.profiles[t];r.graphics3D.maxTotalNumberOfFeatures=n.graphics3D.maxTotalNumberOfFeatures,r.graphics3D.maxTotalNumberOfPrimitives=n.graphics3D.maxTotalNumberOfPrimitives,r.graphics3D.polygonLodFactor=n.graphics3D.polygonLodFactor,r.graphics3D.polylineLodFactor=n.graphics3D.polylineLodFactor;var i=r.sceneService["3dObject"],a=n.sceneService["3dObject"];i.lodFactor=a.lodFactor,i.lodCrossfadeinDuration=a.lodCrossfadeinDuration,i.lodCrossfadeoutDuration=a.lodCrossfadeoutDuration,i.lodCrossfadeUncoveredDuration=a.lodCrossfadeUncoveredDuration,r.sceneService.point.lodFactor=n.sceneService.point.lodFactor,r.sceneService.integratedMesh.lodFactor=n.sceneService.integratedMesh.lodFactor,r.sceneService.pointCloud.lodFactor=n.sceneService.pointCloud.lodFactor,r.sceneService.uncompressedTextureDownsamplingEnabled=n.sceneService.uncompressedTextureDownsamplingEnabled,r.tiledSurface.lodBias=n.tiledSurface.lodBias,r.tiledSurface.angledSplitBias=n.tiledSurface.angledSplitBias,r.tiledSurface.reduceTileLevelDifferences=n.tiledSurface.reduceTileLevelDifferences,r.tiledSurface.textureFadeDuration=n.tiledSurface.textureFadeDuration,r.antialiasingEnabled=n.antialiasingEnabled,r.physicallyBasedRenderingEnabled=n.physicalBasedRenderingEnabled,r.highQualityTransparency=n.highQualityTransparency,r.memoryLimit=n.memoryLimit,r.additionalCacheMemory=n.additionalCacheMemory,r.frameRate=n.frameRate,r.maximumRenderResolution=n.maximumRenderResolution,r.maximumPixelRatio=n.maximumPixelRatio}}]),e}();function I_(){var e=!!Object(g.a)("esri-mobile");return{low:{graphics3D:{maxTotalNumberOfFeatures:25e3,maxTotalNumberOfPrimitives:85e4,polygonLodFactor:.5,polylineLodFactor:1},sceneService:{"3dObject":{lodFactor:.2,lodCrossfadeinDuration:0,lodCrossfadeoutDuration:0,lodCrossfadeUncoveredDuration:0},point:{lodFactor:1},integratedMesh:{lodFactor:.6},pointCloud:{lodFactor:.5},uncompressedTextureDownsamplingEnabled:!0},tiledSurface:{lodBias:-1,angledSplitBias:.5,reduceTileLevelDifferences:!1,textureFadeDuration:0},antialiasingEnabled:!1,physicalBasedRenderingEnabled:!1,highQualityTransparency:!1,memoryLimit:200,additionalCacheMemory:0,frameRate:0,maximumRenderResolution:null,maximumPixelRatio:1},medium:{graphics3D:{maxTotalNumberOfFeatures:5e4,maxTotalNumberOfPrimitives:17e5,polygonLodFactor:e?.8:1,polylineLodFactor:e?1.2:1.5},sceneService:{"3dObject":{lodFactor:1,lodCrossfadeinDuration:0,lodCrossfadeoutDuration:0,lodCrossfadeUncoveredDuration:400},point:{lodFactor:1},integratedMesh:{lodFactor:1},pointCloud:{lodFactor:1},uncompressedTextureDownsamplingEnabled:e},tiledSurface:{lodBias:0,angledSplitBias:1,reduceTileLevelDifferences:!Object(g.a)("disable-feature:reduce-map-tile-levels"),textureFadeDuration:400},antialiasingEnabled:!0,physicalBasedRenderingEnabled:!0,highQualityTransparency:!0,memoryLimit:e?600:750,additionalCacheMemory:e?0:150,frameRate:0,maximumRenderResolution:null,maximumPixelRatio:1},high:{graphics3D:{maxTotalNumberOfFeatures:5e4,maxTotalNumberOfPrimitives:17e5,polygonLodFactor:e?1.2:2,polylineLodFactor:e?1.2:2},sceneService:{"3dObject":{lodFactor:1,lodCrossfadeinDuration:0,lodCrossfadeoutDuration:0,lodCrossfadeUncoveredDuration:400},point:{lodFactor:1},integratedMesh:{lodFactor:1},pointCloud:{lodFactor:1},uncompressedTextureDownsamplingEnabled:!1},tiledSurface:{lodBias:0,angledSplitBias:1,reduceTileLevelDifferences:!Object(g.a)("disable-feature:reduce-map-tile-levels"),textureFadeDuration:400},antialiasingEnabled:!0,physicalBasedRenderingEnabled:!0,highQualityTransparency:!0,memoryLimit:e?900:1500,additionalCacheMemory:0,frameRate:0,maximumRenderResolution:e?null:4096,maximumPixelRatio:e?1:null}}}R_.debug={reset:function(){var e=I_();for(var t in e)R_.profiles[t]=e[t]}},function(e){e.profiles=I_()}(R_||(R_={}));var D_=R_,F_=r(203),L_=function(e){Object(f.a)(r,e);var t=Object(p.a)(r);function r(){var e;return Object(c.a)(this,r),(e=t.apply(this,arguments)).color=new Il.a([0,255,255]),e.haloColor=null,e.haloOpacity=1,e.fillOpacity=.25,e.shadowOpacity=.4,e.shadowColor=new Il.a([0,0,0]),e.shadowDifference=.2,e}return Object(l.a)(r,null,[{key:"toEngineOptions",value:function(e){var t=Il.a.toUnitRGBA(e.color),r=Object(I.j)(e.haloColor)?Il.a.toUnitRGBA(e.haloColor):t,n=Il.a.toUnitRGBA(e.shadowColor);return{color:Object(F_.c)(t[0],t[1],t[2],t[3]),haloColor:Object(F_.c)(r[0],r[1],r[2],r[3]),haloOpacity:e.haloOpacity,haloOpacityOccluded:.25*e.haloOpacity,fillOpacity:e.fillOpacity,fillOpacityOccluded:.25*e.fillOpacity,shadowOpacity:e.shadowOpacity,shadowColor:Object(F_.c)(n[0],n[1],n[2],n[3]),occludedShadowOpacity:e.shadowOpacity*(1-e.shadowDifference)}}}]),r}(de.a);Object(b.a)([Object(y.b)({type:Il.a})],L_.prototype,"color",void 0),Object(b.a)([Object(y.b)({type:Il.a})],L_.prototype,"haloColor",void 0),Object(b.a)([Object(y.b)()],L_.prototype,"haloOpacity",void 0),Object(b.a)([Object(y.b)()],L_.prototype,"fillOpacity",void 0),Object(b.a)([Object(y.b)()],L_.prototype,"shadowOpacity",void 0),Object(b.a)([Object(y.b)({type:Il.a})],L_.prototype,"shadowColor",void 0),Object(b.a)([Object(y.b)()],L_.prototype,"shadowDifference",void 0);var z_=L_=Object(b.a)([Object(w.a)("esri.views.3d.support.HighlightOptions")],L_),V_=r(576),N_=r(493),U_=function(){function e(t,r){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;Object(c.a)(this,e),this.spatialReference=r,this.unitInMeters=Object(ij.f)(this.spatialReference,Object(J.e)(this.spatialReference).metersPerDegree),this._geometryServicePromise=Object(wg.d)(this.loadGeometryService(t,n))}return Object(l.a)(e,[{key:"loadGeometryService",value:function(){var e=Object(s.a)(o.a.mark((function e(t,r){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!r){e.next=2;break}return e.abrupt("return",r);case 2:return e.prev=2,e.next=5,Object(V_.create)(t&&t.get("portalItem"));case 5:return e.abrupt("return",e.sent);case 8:throw e.prev=8,e.t0=e.catch(2),new U.a("mapcoordshelper:missing-geometry-service","Must specify geometryService in esri/config");case 11:case"end":return e.stop()}}),e,null,[[2,8]])})));return function(t,r){return e.apply(this,arguments)}}()},{key:"awaitGeometryService",value:function(){var e=Object(s.a)(o.a.mark((function e(){var t;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._geometryServicePromise;case 2:if(!0!==(t=e.sent).ok){e.next=5;break}return e.abrupt("return",t.value);case 5:throw t.error;case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"toGeographic",value:function(){var e=Object(s.a)(o.a.mark((function e(t){var r,n,i,a,s,c,l=this;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.awaitGeometryService();case 2:return r=e.sent,i=!0,Array.isArray(t[0])&&"number"!=typeof t[0]?n=t:(n=[t],i=!1),a=n.map((function(e){return e instanceof S.a?e:new S.a(e,l.spatialReference)})),s=new N_.a({geometries:a,outSpatialReference:Gs.a.WGS84}),e.next=9,r.project(s);case 9:return c=e.sent.map((function(e){return"point"===e.type?[e.x,e.y]:void 0})),e.abrupt("return",i?c:c[0]);case 11:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),e}(),B_=function(e){Object(f.a)(r,e);var t=Object(p.a)(r);function r(){var e;return Object(c.a)(this,r),(e=t.apply(this,arguments)).minTotalNumberOfFeatures=2e3,e.maxTotalNumberOfFeatures=5e4,e.maxTotalNumberOfPrimitives=17e5,e.polygonLodFactor=1,e.polylineLodFactor=1,e}return r}(de.a);Object(b.a)([Object(y.b)()],B_.prototype,"minTotalNumberOfFeatures",void 0),Object(b.a)([Object(y.b)()],B_.prototype,"maxTotalNumberOfFeatures",void 0),Object(b.a)([Object(y.b)()],B_.prototype,"maxTotalNumberOfPrimitives",void 0),Object(b.a)([Object(y.b)()],B_.prototype,"polygonLodFactor",void 0),Object(b.a)([Object(y.b)()],B_.prototype,"polylineLodFactor",void 0),B_=Object(b.a)([Object(w.a)("esri.views.3d.support.QualitySettings.Graphics3DSettings")],B_);var G_=function(e){Object(f.a)(r,e);var t=Object(p.a)(r);function r(){var e;return Object(c.a)(this,r),(e=t.apply(this,arguments)).lodFactor=1,e}return r}(de.a);Object(b.a)([Object(y.b)()],G_.prototype,"lodFactor",void 0);var q_=function(e){Object(f.a)(r,e);var t=Object(p.a)(r);function r(){var e;return Object(c.a)(this,r),(e=t.apply(this,arguments)).lodCrossfadeinDuration=0,e.lodCrossfadeoutDuration=0,e.lodCrossfadeUncoveredDuration=0,e}return r}(G_=Object(b.a)([Object(w.a)("esri.views.3d.support.QualitySettings.LoDFactorSettings")],G_));q_=Object(b.a)([Object(w.a)("esri.views.3d.support.QualitySettings.LoDFactor3DObjectSettings")],q_);var H_=function(e){Object(f.a)(r,e);var t=Object(p.a)(r);function r(){var e;return Object(c.a)(this,r),(e=t.apply(this,arguments))["3dObject"]=new q_,e.point=new G_,e.integratedMesh=new G_,e.pointCloud=new G_,e.uncompressedTextureDownsamplingEnabled=!1,e}return r}(de.a);Object(b.a)([Object(y.b)({type:q_})],H_.prototype,"3dObject",void 0),Object(b.a)([Object(y.b)({type:G_})],H_.prototype,"point",void 0),Object(b.a)([Object(y.b)({type:G_})],H_.prototype,"integratedMesh",void 0),Object(b.a)([Object(y.b)({type:G_})],H_.prototype,"pointCloud",void 0),Object(b.a)([Object(y.b)()],H_.prototype,"uncompressedTextureDownsamplingEnabled",void 0),H_=Object(b.a)([Object(w.a)("esri.views.3d.support.QualitySettings.SceneServiceSettings")],H_);var W_=function(e){Object(f.a)(r,e);var t=Object(p.a)(r);function r(){var e;return Object(c.a)(this,r),(e=t.apply(this,arguments)).lodBias=0,e.angledSplitBias=1,e.reduceTileLevelDifferences=!0,e.textureFadeDuration=500,e}return r}(de.a);Object(b.a)([Object(y.b)()],W_.prototype,"lodBias",void 0),Object(b.a)([Object(y.b)()],W_.prototype,"angledSplitBias",void 0),Object(b.a)([Object(y.b)()],W_.prototype,"reduceTileLevelDifferences",void 0),Object(b.a)([Object(y.b)()],W_.prototype,"textureFadeDuration",void 0),W_=Object(b.a)([Object(w.a)("esri.views.3d.support.QualitySettings.TiledSurfaceSettings")],W_);var Q_=function(e){Object(f.a)(r,e);var t=Object(p.a)(r);function r(){var e;return Object(c.a)(this,r),(e=t.apply(this,arguments)).graphics3D=new B_,e.sceneService=new H_,e.tiledSurface=new W_,e.antialiasingEnabled=!0,e.physicallyBasedRenderingEnabled=!1,e.highQualityTransparency=!0,e}return r}(de.a);Object(b.a)([Object(y.b)({type:B_})],Q_.prototype,"graphics3D",void 0),Object(b.a)([Object(y.b)({type:H_})],Q_.prototype,"sceneService",void 0),Object(b.a)([Object(y.b)({type:W_})],Q_.prototype,"tiledSurface",void 0),Object(b.a)([Object(y.b)()],Q_.prototype,"antialiasingEnabled",void 0),Object(b.a)([Object(y.b)()],Q_.prototype,"physicallyBasedRenderingEnabled",void 0),Object(b.a)([Object(y.b)()],Q_.prototype,"highQualityTransparency",void 0),Object(b.a)([Object(y.b)()],Q_.prototype,"memoryLimit",void 0),Object(b.a)([Object(y.b)()],Q_.prototype,"additionalCacheMemory",void 0),Object(b.a)([Object(y.b)()],Q_.prototype,"frameRate",void 0),Object(b.a)([Object(y.b)()],Q_.prototype,"maximumRenderResolution",void 0),Object(b.a)([Object(y.b)()],Q_.prototype,"maximumPixelRatio",void 0);var Z_=Q_=Object(b.a)([Object(w.a)("esri.views.3d.support.QualitySettings.QualitySettings")],Q_),X_=r(359),Y_=function(){function e(t,r,n,i){Object(c.a)(this,e),this.viewingMode=t,this.spatialReference=r,this.unitInMeters=n,this.coordinateSystem=i,this._coordinateSystem=function(e){var t=e.value,r=e.operations;return{operations:r,value:r.create(t)}}(i)}return Object(l.a)(e,[{key:"extent",set:function(e){e&&function(e,t,r){e.operations.setExtent(e.value,t,r.value)}(this.coordinateSystem,e,this.coordinateSystem)}},{key:"getAltitude",value:function(e){return function(e,t){return e.operations.altitudeAt(e.value,t)}(this.coordinateSystem,e)}},{key:"setAltitude",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e;return Tp(this.coordinateSystem,r,t,e)}},{key:"setAltitudeOfTransformation",value:function(e,t){!function(e,t,r,n){t!==n&&Object(Jl.d)(n,t),Object(Yl.y)(Mp,n[12],n[13],n[14]),Tp(e,Mp,r,Mp),n[12]=Mp[0],n[13]=Mp[1],n[14]=Mp[2]}(this.coordinateSystem,t,e,t)}},{key:"worldUpAtPosition",value:function(e,t){return function(e,t,r){return e.operations.axisAt(e.value,t,2,r)}(this.coordinateSystem,e,t)}},{key:"worldBasisAtPosition",value:function(e,t,r){return function(e,t,r,n){return e.operations.axisAt(e.value,t,r,n)}(this.coordinateSystem,e,t,r)}},{key:"basisMatrixAtPosition",value:function(e,t){var r=this.worldBasisAtPosition(e,0,yp.c.get()),n=this.worldBasisAtPosition(e,1,yp.c.get()),i=this.worldBasisAtPosition(e,2,yp.c.get());return Object(Jl.h)(t,r[0],r[1],r[2],0,n[0],n[1],n[2],0,i[0],i[1],i[2],0,0,0,0,1),t}},{key:"intersectManifoldClosestSilhouette",value:function(e,t,r){return Cp(this.coordinateSystem,t,this._coordinateSystem),function(e,t,r){e.operations.intersectRayClosestSilhouette(e.value,t,r)}(this._coordinateSystem,e,r),r}},{key:"intersectManifold",value:function(e,t,r){Cp(this.coordinateSystem,t,this._coordinateSystem);var n=yp.c.get();return function(e,t,r){return e.operations.intersectRay(e.value,t,r)}(this._coordinateSystem,e,n)?Object(Yl.m)(r,n):null}},{key:"intersectInfiniteManifold",value:function(e,t,r){if(1===this.viewingMode)return this.intersectManifold(e,t,r);Cp(this.coordinateSystem,t,this._coordinateSystem);var n=this._coordinateSystem.value,i=yp.c.get();return Object(Rp.m)(n.plane,e,i)?Object(Yl.m)(r,i):null}},{key:"toRenderCoords",value:function(e,t,r){return Object(X_.a)(e)?Object($.u)(e,t,this.spatialReference):Object($.z)(e,t,r,this.spatialReference)}},{key:"fromRenderCoords",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return Object(X_.a)(t)?(Object(I.j)(r)&&(t.spatialReference=r),Object($.x)(e,this.spatialReference,t)):t instanceof Gs.a?Object($.y)(e,this.spatialReference,t):Object($.z)(e,this.spatialReference,t,r)?t:null}}],[{key:"create",value:function(t,r){switch(t){case 2:return new e(2,r,Object(ij.f)(r),kp(ee.c,Object(ee.g)([0,0,0],[Sp,0,0],[0,Sp,0])));case 1:return new e(1,r,1,function(e){return kp(Nd.l,Object(Nd.f)(0,0,0,Object(J.e)(e).radius))}(r))}}}]),e}(),$_=r(549),J_=r(346);function K_(e){return"function"==typeof e.getUsedMemory}var ew=j.a.getLogger("esri.views.3d.support.MemoryController");var tw,rw=function(){function e(t){Object(c.a)(this,e),this._view=t,this.events=new Ii.a,this.minQuality=.1,this._maxMemory=500,this._additionalCacheMemory=100,this._quality=1,this._stableQuality=0,this._downscaleMemoryUsed=0,this._canFastRecover=!1,this._memoryUsed=0,this._memoryPredicted=0,this._cacheStorage=new J_.c,this._numQualityChanges=0,this._updating=!1}return Object(l.a)(e,[{key:"destroy",value:function(){this.events=null,this._cacheStorage.destroy()}},{key:"getMemCache",value:function(e,t){return new J_.b(e,this._cacheStorage,t)}},{key:"maxMemory",get:function(){return this._maxMemory},set:function(e){null!=e&&e>0&&(this._stableQuality=0,this._canFastRecover=!1,this._maxMemory<e&&this._updateQuality(1),this._maxMemory=e)}},{key:"additionalCacheMemory",set:function(e){null!=e&&e>=0&&(this._additionalCacheMemory=e)}},{key:"disableMemCache",value:function(){this._additionalCacheMemory=-4096}},{key:"memoryFactor",get:function(){return this._quality}},{key:"updating",get:function(){return this._updating}},{key:"usedMemory",get:function(){return this._memoryUsed}},{key:"resetStableQuality",value:function(){this._stableQuality=0}},{key:"update",value:function(){if(this._updateMemory(),!(this._memoryPredicted<=0)||this._updating){var e=this._layersUpdating();if(this._memoryPredicted<.6&&this._canFastRecover)this._downscaleMemoryUsed=0,this._stableQuality=0,this._canFastRecover=!1,this._updateQuality(1);else if(e)(this._memoryPredicted>1.1||this._memoryUsed>1)&&(this._stableQuality>0?(this._downscaleMemoryUsed=0,this._updateQuality(this._stableQuality)):this._quality>this.minQuality&&this._downscaleMemoryUsed<this._memoryUsed&&(this._updateQuality(this._quality/1.3),this._downscaleMemoryUsed=this._memoryUsed,this._canFastRecover=!1));else if(this._downscaleMemoryUsed=0,this._memoryUsed>1)this._stableQuality=0,this._canFastRecover=!1,e=this._updateQuality(this._quality/1.3),this._downscaleMemoryUsed=this._memoryPredicted;else if(this._stableQuality!==this._quality)if(this._memoryUsed<.75&&this._quality<1){this._stableQuality=this._quality;e=this._updateQuality(this._quality+.05)}else this._quality<1&&(this._canFastRecover=!0);this.updating!==e&&(this._updating=e,this.events.emit("updating-changed",this.updating))}}},{key:"_updateQuality",value:function(e){return(e=Math.min(Math.max(e,this.minQuality),1))!==this._quality&&(this._quality=e,this.events.emit("quality-changed",this._quality),++this._numQualityChanges,!0)}},{key:"_layersUpdating",value:function(){return this._view.allLayerViews.some((function(e){return!!e.updating}))}},{key:"_updateMemory",value:function(){var e=this,t=0,r=0;this._view.basemapTerrain&&this._view.basemapTerrain.getUsedMemory&&(t+=this._view.basemapTerrain.getUsedMemory());var n=this._view._stage&&this._view._stage.renderView&&this._view._stage.renderView.edgeView;Object(I.j)(n)&&(t+=n.usedMemory),this._view.allLayerViews&&this._view.allLayerViews.forEach((function(n){if(K_(n)){var i=n.ignoresMemoryFactor()?e._quality:1;t+=n.getUsedMemory()*i,r+=n.getUnloadedMemory()*i}}));var i=null==this._warnMemoryUsage||Math.round(10*t)!==Math.round(10*this._warnMemoryUsage),a=1048576*this._maxMemory;if(t>a&&i){this._warnMemoryUsage=t;var o=function(e){return(e/1048576).toLocaleString(void 0,{maximumFractionDigits:1})+" MB"},s=Math.round(100*this._quality);ew.warn("Memory Limit exceeded! Limit: ".concat(o(a)," Current: ").concat(o(t)," Projected: ").concat(o(t+r)," Quality: ").concat(s,"%"))}this._memoryUsed=t/a,this._memoryPredicted=(t+r)/a;var c=a-t;this._cacheStorage.maxSize=Math.max(0,c+1048576*this._additionalCacheMemory),this.events.emit("memory-used",this._memoryUsed)}},{key:"test",get:function(){var e=this;return{cacheStorage:this._cacheStorage,resetQualityChanges:function(){var t=e._numQualityChanges;return e._numQualityChanges=0,t}}}}]),e}(),nw=r(307),iw=function(e){Object(f.a)(r,e);var t=Object(p.a)(r);function r(){var e;return Object(c.a)(this,r),(e=t.apply(this,arguments)).updating=!1,e}return r}(de.a);Object(b.a)([Object(y.b)({readOnly:!0})],iw.prototype,"updating",void 0),iw=Object(b.a)([Object(w.a)("esri.views.3d.support.ResourceController")],iw),function(e){var t=function(e){Object(f.a)(n,e);var t=Object(p.a)(n);function n(){var e;return Object(c.a)(this,n),(e=t.apply(this,arguments))._scheduler=null,e._memoryController=null,e._streamDataLoader=null,e._cameraChangeTime=0,e._handles=new oe.a,e._frameTask=null,e._scheduleTask=Og.a,e}return Object(l.a)(n,[{key:"initialize",value:function(){var e=this;this._cameraChangeTime=this.now(),this._scheduler=Object(Og.c)(this.now),this._memoryController=function(e){return new rw(e)}(this.view),this._streamDataLoader=new nw.b,this._streamDataLoader.setup($_.b,$_.a,this._scheduler),this._handles.add([this.view.watch("state.camera",(function(t,r){return e._cameraChangedHandler(t,r)}),!0),this.view.watch("stationary",(function(){return e._stationaryChangedHandler()})),this._memoryController.events.on("updating-changed",(function(){return e.notifyChange("updating")}))]),this._frameTask=Object(H.a)({update:function(t){return e.frame(t)}}),this._scheduleTask=this._scheduler.registerTask(Og.b.RESOURCE_CONTROLLER)}},{key:"destroy",value:function(){this._handles=Object(I.e)(this._handles),this._scheduleTask.remove(),this._frameTask=Object(I.r)(this._frameTask),this._streamDataLoader=Object(I.e)(this._streamDataLoader),this._memoryController=Object(I.e)(this._memoryController),this._scheduler=Object(I.e)(this._scheduler)}},{key:"updating",get:function(){var e,t;return!!(null!=(e=this._memoryController)&&e.updating||null!=(t=this._streamDataLoader)&&t.updating)}},{key:"scheduler",get:function(){return this._scheduler}},{key:"memoryController",get:function(){return this._memoryController}},{key:"schedule",value:function(e,t,r){return this._scheduleTask.schedule(e,t,r)}},{key:"createStreamDataRequester",value:function(e){var t=this._streamDataLoader;return{request:function(r,n,i){return t.request(r,n,e,i)},get busy(){return!t.hasDownloadSlots(e)}}}},{key:"frame",value:function(e){this.view.suspended||this.view.stateManager&&(this.view.stateManager.step(Object(Vd.d)(e.deltaTime)),!this._scheduler)||(this._scheduler.state=this.state,this._scheduler.updateBudget(e)?(this._memoryController.update(),this._scheduler.frame()):this._memoryController.updating&&this._memoryController.update())}},{key:"_cameraChangedHandler",value:function(e,t){e&&t&&e.almostEquals(t)||(this._cameraChangeTime=this._scheduler.now,this._scheduler.state=this.state)}},{key:"_stationaryChangedHandler",value:function(){this.memoryController.resetStableQuality()}},{key:"state",get:function(){var e=this.view;return e.animation?0:e.interacting||this._scheduler.now-this._cameraChangeTime<=r?1:2}},{key:"test",get:function(){var e=this;return{getQueueStats:function(t){return e._streamDataLoader.test.loadQueue.getStatsForType(t)},state:this.state}}}]),n}(iw);Object(b.a)([Object(y.b)({constructOnly:!0})],t.prototype,"view",void 0),Object(b.a)([Object(y.b)({constructOnly:!0})],t.prototype,"now",void 0),Object(b.a)([Object(y.b)()],t.prototype,"_scheduler",void 0),Object(b.a)([Object(y.b)()],t.prototype,"_memoryController",void 0),Object(b.a)([Object(y.b)()],t.prototype,"_streamDataLoader",void 0),Object(b.a)([Object(y.b)({readOnly:!0})],t.prototype,"updating",null),t=Object(b.a)([Object(w.a)("esri.views.3d.support.ResourceController")],t),e.ResourceController=t;var r=300}(tw||(tw={}));var aw=r(78),ow=function e(t,r){if(Object(c.a)(this,e),this.layer=null,this.memory=0,this.displayedNumberOfFeatures=0,this.maximumNumberOfFeatures=null,this.totalNumberOfFeatures=null,this.layer=t.layer,this.memory=Object(aw.j)(t)?r.basemapTerrain.getUsedMemoryForLayerView(t):t.getUsedMemory(),"performanceInfo"in t){var n=t.performanceInfo;this.displayedNumberOfFeatures=n.displayedNumberOfFeatures,this.maximumNumberOfFeatures=n.maximumNumberOfFeatures,this.totalNumberOfFeatures=n.totalNumberOfFeatures}},sw=function e(t){var r=this;Object(c.a)(this,e),this.totalMemory=0,this.usedMemory=0,this.quality=1,this.load=0,this.terrainMemory=0,this.edgesMemory=0,this.layerPerformanceInfos=new Array;var n=t.resourceController.memoryController;this.totalMemory=1048576*n.maxMemory,this.usedMemory=Math.round(n.usedMemory*this.totalMemory),this.quality=n.memoryFactor,this.load=t.resourceController.scheduler.load,this.terrainMemory=t.basemapTerrain?t.basemapTerrain.getUsedMemory():0;var i=t._stage&&t._stage.renderView&&t._stage.renderView.edgeView;this.edgesMemory=Object(I.j)(i)?i.usedMemory:0,t.allLayerViews.items.forEach((function(e){(K_(e)||Object(aw.j)(e))&&r.layerPerformanceInfos.push(new ow(e,t))})),this.layerPerformanceInfos.sort((function(e,t){return t.memory-e.memory}))},cw=r(39),lw=r(206),uw=r(308),dw=function(){function e(t,r,n,i){Object(c.a)(this,e),this._streamDataRequester=t,this._stage=r,this._textureOptions=n,this._textureRequests=new Map,this._frameTask=Object(I.j)(i)?i.registerTask(Og.b.TEXTURE_UNLOAD):Og.a}return Object(l.a)(e,[{key:"destroy",value:function(){var e=this;this._frameTask.remove(),this._textureRequests.forEach((function(t){return e.releaseTextureRequest(t)})),this._textureRequests.clear()}},{key:"fromUrl",value:function(){var e=Object(s.a)(o.a.mark((function e(t,r,n){var i,a,s,c,l,u=this;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Object(q.x)(n),i=Object(I.j)(n)&&n.signal,a=this.makeUid(t,r),(s=this._textureRequests.get(a))||(c=Object(q.e)(),l=this._streamDataRequester.request(t,"image",{uid:a,signal:c.signal}),s={referenceCount:0,texture:null,textureAsync:null,abortController:c},this._textureRequests.set(a,s),s.textureAsync=l.then((function(e){var n=u.createTexture(t,e,r);return s.texture=n,s.abortController=null,u.addToStage(n),{uid:a,texture:n}}),(function(e){throw s.abortController=null,e}))),e.abrupt("return",(s.referenceCount++,new Promise((function(e,t){Object(q.s)(i,(function(){t(Object(q.f)())})),s.textureAsync.then(e,t)})).catch((function(e){throw u.release(a),e}))));case 5:case"end":return e.stop()}}),e,this)})));return function(t,r,n){return e.apply(this,arguments)}}()},{key:"fromData",value:function(e,t){var r=this.makeUid(e),n=this._textureRequests.get(r);return n||(n={referenceCount:0,texture:t(),textureAsync:null,abortController:null},this.addToStage(n.texture),this._textureRequests.set(r,n)),n.referenceCount++,{uid:r,texture:n.texture}}},{key:"release",value:function(e){var t=this;if(this._textureRequests){var r=this._textureRequests.get(e);r?(r.referenceCount<1&&console.warn("TextureCollection: reference count is < 1 for "+e),r.referenceCount--,r.referenceCount<1&&this._frameTask.schedule((function(){return t.releaseNow(e)}))):console.warn("TextureCollection: texture doesn't exist: '".concat(e,"'"))}}},{key:"test",get:function(){return{textureRequests:this._textureRequests}}},{key:"releaseNow",value:function(e){if(this._textureRequests){var t=this._textureRequests.get(e);!t||t.referenceCount>0||(this.releaseTextureRequest(t),this._textureRequests.delete(e))}}},{key:"releaseTextureRequest",value:function(e){e.texture?this.removeFromStage(e.texture):e.abortController&&(e.abortController.abort(),e.abortController=null)}},{key:"createTexture",value:function(e,t,r){var n=Object(ie.a)(Object(ie.a)({},this._textureOptions),{},{powerOfTwoResizeMode:2});if(Object(cw.x)(e)){if(r||0===t.width&&0===t.height){var i=t.width?t.height/t.width:1;r=r||64,i>1?(t.width=Math.round(r/i),t.height=r):(t.width=r,t.height=Math.round(r*i))}this._stage.renderView&&Object(uw.b)(this._stage.renderView.renderingContext).svgAlwaysPremultipliesAlpha&&(n.preMultiplyAlpha=!1)}return n.width=t.width,n.height=t.height,new lw.a(t,n)}},{key:"addToStage",value:function(e){this._stage.add(e)}},{key:"removeFromStage",value:function(e){this._stage.remove(e)}},{key:"makeUid",value:function(e,t){return null!=t?"".concat(e,".").concat(t,"px"):e}}]),e}(),hw=function(){function e(t){Object(c.a)(this,e),this.textures=null,this.streamDataRequester=null,this.graphicsOwners=[],this.screenSizePerspectiveHandles=null,this.cimSymbolRasterizer=null,this.viewState=t.viewState,this.view=t.view,this.pointsOfInterest=t.pointsOfInterest,this.objectResourceCache=t.objectResourceCache,this.streamDataRequester=t.resourceController.createStreamDataRequester(4),this.textures=new dw(this.streamDataRequester,t.view._stage,{preMultiplyAlpha:!0,wrap:{s:33071,t:33071}},t.resourceController.scheduler);var r=Object(J.e)(this.view.spatialReference).radius;this.screenSizePerspectiveSettings=Object(Xy.d)(t.viewingMode,r),this.screenSizePerspectiveSettingsLabels=Object(Xy.c)(t.viewingMode,r)}return Object(l.a)(e,[{key:"destroy",value:function(){this.textures.destroy(),this.textures=null,this.streamDataRequester=null}},{key:"addGraphicsOwner",value:function(e){var t=this;if(!e)return{remove:function(){}};this.graphicsOwners.push(e);var r="layer"in e?e.watch("layer.screenSizePerspectiveEnabled",(function(){return t.updateScreenSizePerspectiveEnabled()})):null;return this.updateScreenSizePerspectiveEnabled(),{remove:function(){r&&(r.remove(),Object(Fs.k)(t.graphicsOwners,e),t.updateScreenSizePerspectiveEnabled())}}}},{key:"updateScreenSizePerspectiveEnabled",value:function(){var e=this,t=this.graphicsOwners.some((function(e){return!0===e.get("layer.screenSizePerspectiveEnabled")}));if(t&&!this.screenSizePerspectiveHandles){this.screenSizePerspectiveHandles=new oe.a;var r=function(){return e.updateScreenSizePerspectiveSettings()};this.screenSizePerspectiveHandles.add([this.pointsOfInterest.centerOnSurfaceInfrequent.watch("distance",r,!0),this.viewState.events.on("camera-projection-changed",r)]),this.updateScreenSizePerspectiveSettings()}else!t&&this.screenSizePerspectiveHandles&&(this.screenSizePerspectiveHandles.destroy(),this.screenSizePerspectiveHandles=null)}},{key:"updateScreenSizePerspectiveSettings",value:function(){var e=this.pointsOfInterest;fw.distance=e.centerOnSurfaceInfrequent.distance,fw.fovY=this.viewState.camera.fovY,this.screenSizePerspectiveSettings.update(fw),this.screenSizePerspectiveSettingsLabels.update(fw),this.view._stage.renderView.setNeedsRender()}}]),e}(),fw={distance:0,fovY:0},pw=r(218),bw=r(201),vw=r(219),mw=function(){function e(t,r){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";Object(c.a)(this,e),this.graphics=t,this._symbol=new pw.a({symbolLayers:[new bw.a({material:{color:r},outline:{color:[255,255,255],size:1},resource:{primitive:"circle"}}),new vw.a({text:n,halo:{color:"white",size:1/.75},material:{color:r},size:12})]})}return Object(l.a)(e,[{key:"showPoint",value:function(e,t){if(!Object(I.i)(t)){this.remove();var r=new S.a({x:e[0],y:e[1],z:e[2],spatialReference:t});this._graphic=new E.a({geometry:r,symbol:this._symbol}),this.graphics.add(this._graphic)}}},{key:"remove",value:function(){Object(I.j)(this._graphic)&&(this.graphics.remove(this._graphic),this._graphic=null)}}]),e}(),yw=function(e){Object(f.a)(r,e);var t=Object(p.a)(r);function r(e){var n;return Object(c.a)(this,r),(n=t.call(this,e)).handles=new oe.a,n}return Object(l.a)(r,[{key:"destroy",value:function(){this.handles.destroy()}}]),r}(de.a);Object(b.a)([Object(y.b)({constructOnly:!0})],yw.prototype,"renderCoordsHelper",void 0),Object(b.a)([Object(y.b)({constructOnly:!0})],yw.prototype,"surface",void 0),Object(b.a)([Object(y.b)({constructOnly:!0})],yw.prototype,"state",void 0);yw=Object(b.a)([Object(w.a)("esri.views.3d.support.PointOfInterest")],yw);var gw=Array,Ow=function(e){Object(f.a)(r,e);var t=Object(p.a)(r);function r(e){var n;return Object(c.a)(this,r),(n=t.call(this,e))._dirty=!1,n._propertiesPool=new $O.a({location:S.a,renderLocation:gw},Object(u.a)(n)),n._estimatedSurfaceAltitude=0,n._pendingElevationQueryController=null,n.cameraName="camera",n.renderLocation=Object(X.e)(),n.tmpPoint=new S.a,n}return Object(l.a)(r,[{key:"initialize",value:function(){var e=this;if(this.scheduler&&this.handles.add(this.scheduler.registerTask(this.task,this)),this.runTask(),this.map){var t=function(){return e._setDirty()};this.handles.add(Object(W.b)(this.map,"ground.layers","change",t,t,t))}this._updateRenderLocation()}},{key:"destroy",value:function(){this._cancelPendingRequest(),this._propertiesPool.destroy(),this._propertiesPool=null}},{key:"_camera",get:function(){return this.state[this.cameraName]}},{key:"location",get:function(){var e=this._propertiesPool.get("location");return this.renderCoordsHelper.fromRenderCoords(this.renderLocation,e,this.state.spatialReference),e}},{key:"scale",get:function(){var e=this._camera,t=Object(Yl.o)(e.eye,this.renderLocation);return Fv({renderCoordsHelper:this.renderCoordsHelper,state:{camera:e}},t,0)}},{key:"updating",get:function(){return this._dirty||null!=this._pendingElevationQueryController}},{key:"updateRenderLocation",value:function(){this._setDirty(),this._updateRenderLocation()}},{key:"_setDirty",value:function(){this._dirty||(this._dirty=!0,this.notifyChange("updating"))}},{key:"_cancelPendingRequest",value:function(){var e=this._pendingElevationQueryController;e&&(this._pendingElevationQueryController=null,e.abort(),this.notifyChange("updating"))}},{key:"running",get:function(){return!this._pendingElevationQueryController&&this._dirty}},{key:"runTask",value:function(){var e=this;if(this._cancelPendingRequest(),this._dirty=!1,this.notifyChange("updating"),this.map&&this.map.ground){this.renderCoordsHelper.fromRenderCoords(this._camera.eye,this.tmpPoint,this.state.spatialReference);var t=Object(q.e)();this.map.ground.queryElevation(this.tmpPoint,{signal:t.signal,cache:this.cache}).then((function(t){return e._updateSurfaceAltitude(t.geometry.z)})).catch((function(t){Object(q.n)(t)||e._updateSurfaceAltitude(0)})).catch((function(){})).then((function(){e._pendingElevationQueryController===t&&(e._pendingElevationQueryController=null,e.notifyChange("updating")),t=null})),this._pendingElevationQueryController=t}else this._updateSurfaceAltitude(0)}},{key:"_updateSurfaceAltitude",value:function(e){this._estimatedSurfaceAltitude!==e&&(this._estimatedSurfaceAltitude=e,this._updateRenderLocation())}},{key:"_updateRenderLocation",value:function(){this.renderCoordsHelper.setAltitude(jw,this._estimatedSurfaceAltitude,this._camera.eye),Object(Yl.q)(this._get("renderLocation"),jw)||this._set("renderLocation",Object(Yl.m)(this._propertiesPool.get("renderLocation"),jw))}}]),r}(yw);Object(b.a)([Object(y.b)({constructOnly:!0})],Ow.prototype,"scheduler",void 0),Object(b.a)([Object(y.b)({constructOnly:!0})],Ow.prototype,"cache",void 0),Object(b.a)([Object(y.b)({constructOnly:!0})],Ow.prototype,"task",void 0),Object(b.a)([Object(y.b)({constructOnly:!0})],Ow.prototype,"cameraName",void 0),Object(b.a)([Object(y.b)({readOnly:!0})],Ow.prototype,"location",null),Object(b.a)([Object(y.b)({constructOnly:!0})],Ow.prototype,"map",void 0),Object(b.a)([Object(y.b)({readOnly:!0})],Ow.prototype,"renderLocation",void 0),Object(b.a)([Object(y.b)({readOnly:!0})],Ow.prototype,"scale",null),Object(b.a)([Object(y.b)({readOnly:!0})],Ow.prototype,"updating",null),Ow=Object(b.a)([Object(w.a)("esri.views.3d.support.CameraOnSurface")],Ow);var jw=Object(X.e)(),_w=Ow,ww=Array,xw=function(e){Object(f.a)(r,e);var t=Object(p.a)(r);function r(e){var n;return Object(c.a)(this,r),(n=t.call(this,e))._propertiesPool=new $O.a({location:S.a,renderLocation:ww},Object(u.a)(n)),n._currentSurfaceAltitude=0,n._latestSurfaceAltitude=0,n.distance=0,n.renderLocation=Object(X.e)(),n.updating=!1,n}return Object(l.a)(r,[{key:"initialize",value:function(){this._frameWorker=this.scheduler.registerTask(this.task,this),this.runTask()}},{key:"destroy",value:function(){this._frameWorker&&(this._frameWorker.remove(),this._frameWorker=null),this._propertiesPool.destroy(),this._propertiesPool=null}},{key:"location",get:function(){var e=this._propertiesPool.get("location");return this.renderCoordsHelper.fromRenderCoords(this.renderLocation,e,this.state.spatialReference),e}},{key:"updateRenderLocation",value:function(){this.updating=!0,this._updateRenderLocation()}},{key:"estimatedSurfaceAltitude",get:function(){return this._latestSurfaceAltitude}},{key:"running",get:function(){return this.updating}},{key:"runTask",value:function(){this._latestSurfaceAltitude=this.estimateSurfaceAltitudeAtCenter(),this._updateRenderLocation(),this.updating=!1}},{key:"_updateRenderLocation",value:function(){var e=Sw,t=this.calculateSurfaceIntersection(this._currentSurfaceAltitude,e),r=this._currentSurfaceAltitude!==this._latestSurfaceAltitude;!t&&r&&((t=this.calculateSurfaceIntersection(this._latestSurfaceAltitude,e))&&(this._currentSurfaceAltitude=this._latestSurfaceAltitude));var n=Tw;if(t&&this.latestSurfaceAltitudeChangesDistanceSignificantly(e,n)&&(Object(Yl.m)(e,n),this._currentSurfaceAltitude=this._latestSurfaceAltitude),t)this.distance=Object(Yl.o)(this.state.camera.eye,e);else{var i=this.state.camera;Object(Yl.g)(e,i.viewForward,this._get("distance")),Object(Yl.h)(e,e,i.eye)}Object(Yl.q)(this._get("renderLocation"),e)||this._set("renderLocation",Object(Yl.m)(this._propertiesPool.get("renderLocation"),e))}},{key:"calculateSurfaceIntersection",value:function(e,t){var r=this.state.camera;if(!this.renderCoordsHelper.intersectManifold(r.ray,e,t))return!1;if(this.state.isGlobal){var n=Object(J.e)(this.renderCoordsHelper.spatialReference).radius,i=n+e,a=Object(Yl.v)(r.eye),o=a<i*i,s=Object(Yl.o)(r.eye,t);if(o&&s>n/4){var c=i-Math.sqrt(a);return Object(Yl.g)(t,r.viewForward,c),Object(Yl.h)(t,t,r.eye),!0}}else{var l=this.surface.ready&&this.surface.extent;l&&(t[0]=Object(m.e)(t[0],l[0],l[2]),t[1]=Object(m.e)(t[1],l[1],l[3]))}return!0}},{key:"latestSurfaceAltitudeChangesDistanceSignificantly",value:function(e,t){if(this._latestSurfaceAltitude===this._currentSurfaceAltitude||null==e)return!1;if(this.calculateSurfaceIntersection(this._latestSurfaceAltitude,t)){if(Vy.a.TESTS_DISABLE_UPDATE_THRESHOLDS)return!0;var r=this.state.camera.eye,n=Object(Yl.o)(r,e),i=Object(Yl.o)(r,t);if(Math.abs(i-n)/n>kw)return!0}return!1}}]),r}(yw);Object(b.a)([Object(y.b)({constructOnly:!0})],xw.prototype,"scheduler",void 0),Object(b.a)([Object(y.b)({constructOnly:!0})],xw.prototype,"task",void 0),Object(b.a)([Object(y.b)()],xw.prototype,"distance",void 0),Object(b.a)([Object(y.b)({constructOnly:!0})],xw.prototype,"estimateSurfaceAltitudeAtCenter",void 0),Object(b.a)([Object(y.b)({readOnly:!0})],xw.prototype,"location",null),Object(b.a)([Object(y.b)({readOnly:!0})],xw.prototype,"renderLocation",void 0),Object(b.a)([Object(y.b)()],xw.prototype,"updating",void 0),xw=Object(b.a)([Object(w.a)("esri.views.3d.support.CenterOnSurface")],xw);var kw=.05,Sw=Object(X.e)(),Tw=Object(X.e)(),Cw=xw,Mw=function(){function e(t){var r=this;Object(c.a)(this,e),this.handles=new oe.a,this.events=new Ii.a,this.contentLayerViews=t.contentLayerViews,this.handles.add(this.contentLayerViews.on("change",(function(e){return r.layerViewsChanged(e)}))),this.layerViewsChanged({added:this.contentLayerViews.toArray(),removed:[],moved:[],target:this.contentLayerViews})}return Object(l.a)(e,[{key:"destroy",value:function(){this.handles&&(this.handles.destroy(),this.handles=null)}},{key:"layerViewsChanged",value:function(e){var t=this;e.added.forEach((function(e){"esri.views.3d.layers.SceneLayerView3D"===e.declaredClass&&t.handles.add(e.on("visible-geometry-changed",(function(){return t.contentChanged()})),e.uid)})),e.removed.forEach((function(e){return t.handles.remove(e.uid)}))}},{key:"contentChanged",value:function(){this.events.emit("request-update",Pw)}}]),e}(),Pw={},Aw=Array,Ew=function(e){Object(f.a)(r,e);var t=Object(p.a)(r);function r(e){var n;return Object(c.a)(this,r),(n=t.call(this,e))._propertiesPool=new $O.a({location:S.a,renderLocation:Aw},Object(u.a)(n)),n._dirty=!0,n.renderLocation=n._propertiesPool.get("renderLocation"),n}return Object(l.a)(r,[{key:"initialize",value:function(){var e=this;this.handles.add([this.centerOnSurface.watch("renderLocation",(function(){return e.updateRenderLocation()})),this.state.watch("camera",(function(){return e.updateRenderLocation()}))]),this.scheduler&&this.handles.add(this.scheduler.registerTask(Og.b.POINT_OF_INTEREST_FREQUENT,this))}},{key:"destroy",value:function(){this._propertiesPool.destroy(),this._propertiesPool=null}},{key:"updating",get:function(){return this._dirty||this.centerOnSurface.updating}},{key:"location",get:function(){var e=this._propertiesPool.get("location");return this.renderCoordsHelper.fromRenderCoords(this.renderLocation,e,this.state.spatialReference),e}},{key:"running",get:function(){return this._dirty}},{key:"runTask",value:function(){var e=this._get("renderLocation"),t=this.centerOnSurface.renderLocation,r=this.renderCoordsHelper,n=this.state.camera;this._dirty=!1,r.worldUpAtPosition(t,Rw);var i=Math.max(0,(Math.acos(Object(Yl.j)(Rw,n.viewForward))-.5*Math.PI)*(n.aboveGround?1:-1));if(Number.isNaN(i)){if(!e||!Object(Yl.F)(e,t)){var a=this._propertiesPool.get("renderLocation");Object(Yl.m)(a,t),this._set("renderLocation",a)}}else{var o=1-Object(m.e)(i/(.5*Math.PI),0,1),s=o*o*o;this._calculateScreenHorizontalEdgeOnSurface(Dw);var c=this._propertiesPool.get("renderLocation");Object(Yl.k)(c,t,Dw,s),e&&Object(Yl.F)(e,c)||this._set("renderLocation",c)}}},{key:"_calculateScreenHorizontalEdgeOnSurface",value:function(e){var t=this.state.camera,r=t.getRenderCenter(Object(Z.d)());if(r[1]=t.aboveGround?t.padding[2]:t.fullHeight-t.padding[0],this.estimateSurfaceIntersectionAtRenderPoint(r,e))return e;var n=this.renderCoordsHelper.getAltitude(this.centerOnSurface.renderLocation);if(t.unprojectFromRenderScreen(r,Iw)){Object(Yl.l)(Iw,Iw,t.eye);var i=Object(Yl.t)(Iw,Iw);if(this.renderCoordsHelper.intersectManifold(Object(Ud.g)(t.eye,i),n,e))return e}return this.renderCoordsHelper.setAltitude(e,n,t.eye)}},{key:"updateRenderLocation",value:function(){this._dirty=!0}}]),r}(yw);Object(b.a)([Object(y.b)()],Ew.prototype,"_dirty",void 0),Object(b.a)([Object(y.b)({constructOnly:!0})],Ew.prototype,"scheduler",void 0),Object(b.a)([Object(y.b)({constructOnly:!0})],Ew.prototype,"centerOnSurface",void 0),Object(b.a)([Object(y.b)({constructOnly:!0})],Ew.prototype,"estimateSurfaceIntersectionAtRenderPoint",void 0),Object(b.a)([Object(y.b)({readOnly:!0})],Ew.prototype,"updating",null),Object(b.a)([Object(y.b)({readOnly:!0})],Ew.prototype,"location",null),Object(b.a)([Object(y.b)({readOnly:!0})],Ew.prototype,"renderLocation",void 0),Ew=Object(b.a)([Object(w.a)("esri.views.3d.support.CenterOnSurface")],Ew);var Rw=Object(X.e)(),Iw=Object(X.e)(),Dw=Object(X.e)(),Fw=Ew,Lw=function(e){Object(f.a)(r,e);var t=Object(p.a)(r);function r(e){var n;return Object(c.a)(this,r),(n=t.call(this,e)).location=null,n._updateController=null,n._handles=new oe.a,n}return Object(l.a)(r,[{key:"renderLocation",get:function(){if(!this.location)return null;var e=Object(X.e)();return this.view.renderCoordsHelper.toRenderCoords(this.location,e),e}},{key:"initialize",value:function(){var e=this;this.view.state.isLocal&&(this._handles.add([this.watch(["surfaceView.spatialReference","surfaceView.extent"],(function(){return e._update()})),Object(W.b)(this,"surface.layers","change",(function(){return e._update()}))]),this._update())}},{key:"destroy",value:function(){this._handles.destroy()}},{key:"_update",value:function(){var e=this;if(this._updateController&&(this._updateController.abort(),this._updateController=null),this.surfaceView&&this.surfaceView.extent&&this.surfaceView.spatialReference){var t=Object(K.e)(this.surfaceView.extent),r=new S.a({x:t[0],y:t[1],z:0,spatialReference:this.surfaceView.spatialReference});this.surface&&this.surface.layers.length>0?(this._set("location",null),this._updateController=Object(q.e)(),this.surface.queryElevation(r,{noDataValue:0,signal:this._updateController.signal,cache:this.cache}).then((function(t){e._updateController=null,e._set("location",t.geometry)})).catch((function(e){Object(q.n)(e)||e&&"elevation-query:invalid-layer"===e.name||console.error("StableSurfaceCenter failed to update: ",e)}))):this._set("location",r)}else this._set("location",null)}}]),r}(de.a);Object(b.a)([Object(y.b)({constructOnly:!0})],Lw.prototype,"view",void 0),Object(b.a)([Object(y.b)({constructOnly:!0})],Lw.prototype,"cache",void 0),Object(b.a)([Object(y.b)({readOnly:!0,aliasOf:"view.map.ground"})],Lw.prototype,"surface",void 0),Object(b.a)([Object(y.b)({readOnly:!0,aliasOf:"view.basemapTerrain"})],Lw.prototype,"surfaceView",void 0),Object(b.a)([Object(y.b)({readOnly:!0})],Lw.prototype,"location",void 0),Object(b.a)([Object(y.b)({readOnly:!0})],Lw.prototype,"renderLocation",null),Lw=Object(b.a)([Object(w.a)("esri.views.3d.terrain.StableSurfaceCenter")],Lw);var zw=function(e){Object(f.a)(r,e);var t=Object(p.a)(r);function r(){var e;return Object(c.a)(this,r),(e=t.apply(this,arguments)).handles=new oe.a,e._tileGeometryUpdateExtent=Object(K.m)(),e._tileGeometryUpdateSpatialReference=null,e.events=new Ii.a,e.updating=!1,e}return Object(l.a)(r,[{key:"initialize",value:function(){var e=this;this.handles.add([this.surface.on("elevation-change",(function(t){return e._tileGeometryChanged(t)})),this.scheduler.registerTask(Og.b.SURFACE_GEOMETRY_UPDATES,this)])}},{key:"destroy",value:function(){this.handles&&(this.handles.destroy(),this.handles=null)}},{key:"running",get:function(){return this.updating}},{key:"runTask",value:function(){this.updating&&(this._centerIntersectsExtent(this._tileGeometryUpdateExtent,this._tileGeometryUpdateSpatialReference)&&this.events.emit("request-update",Vw),Object(K.m)(this._tileGeometryUpdateExtent),this._set("updating",!1))}},{key:"_tileGeometryChanged",value:function(e){this._tileGeometryUpdateSpatialReference=e.spatialReference,Object(K.o)(this._tileGeometryUpdateExtent,e.tile.extent),this._set("updating",!0)}},{key:"_furthestCenterOnSurface",value:function(){for(var e=this.centerOnSurfaces[0],t=1;t<this.centerOnSurfaces.length;t++){var r=this.centerOnSurfaces[t];r.distance>e.distance&&(e=r)}return e}},{key:"_centerIntersectsExtent",value:function(e,t){var r=this.state.camera.eye,n=Bw,i=this._furthestCenterOnSurface();return this.renderCoordsHelper.fromRenderCoords(r,Nw,t),this.renderCoordsHelper.fromRenderCoords(i.renderLocation,Uw,t),Nw[0]<Uw[0]?(n[0]=Nw[0],n[2]=Uw[0]):(n[0]=Uw[0],n[2]=Nw[0]),Nw[1]<Uw[1]?(n[1]=Nw[1],n[3]=Uw[1]):(n[1]=Uw[1],n[3]=Nw[1]),Object(K.v)(n,e)}}]),r}(de.a);Object(b.a)([Object(y.b)({constructOnly:!0})],zw.prototype,"state",void 0),Object(b.a)([Object(y.b)({constructOnly:!0})],zw.prototype,"centerOnSurfaces",void 0),Object(b.a)([Object(y.b)({constructOnly:!0})],zw.prototype,"renderCoordsHelper",void 0),Object(b.a)([Object(y.b)({constructOnly:!0})],zw.prototype,"scheduler",void 0),Object(b.a)([Object(y.b)({constructOnly:!0})],zw.prototype,"surface",void 0),Object(b.a)([Object(y.b)({readOnly:!0})],zw.prototype,"updating",void 0),zw=Object(b.a)([Object(w.a)("esri.views.3d.support.SurfaceGeometryUpdates")],zw);var Vw={},Nw=Object(X.e)(),Uw=Object(X.e)(),Bw=Object(K.m)(),Gw=zw,qw=r(183),Hw=function(e){Object(f.a)(r,e);var t=Object(p.a)(r);function r(e){var n;return Object(c.a)(this,r),(n=t.call(this,e))._handles=new oe.a,n._tmpRay=Object(Ud.c)(),n._centerRayDirty=!0,n._surfaceAltitudeAtCenter=0,n._surfaceAltitudeAtCenterDirty=!0,n._contentAltitudeAtCenter=0,n._contentAltitudeAtCenterDirty=!0,n._propertiesPool=new $O.a({renderPointOfView:Ww},Object(u.a)(n)),n.renderPointOfView=Object(X.e)(),n._pois=new Array,n._debugCenters=new Map,n}return Object(l.a)(r,[{key:"initialize",value:function(){var e,t=this,r=this.view,n=r.state,a=r.basemapTerrain,o=r.renderCoordsHelper,s=r.map;this._surfaceIntersector=new fh.a(n.viewingMode),n.isGlobal?this._surfaceIntersector.options.backfacesTerrain=!1:this._surfaceIntersector.options.backfacesTerrain=!0,this._surfaceIntersector.options.invisibleTerrain=!1,this._surfaceIntersector.options.store=0,this._contentIntersector=new fh.a(n.viewingMode);var c=function(){return t._estimateSurfaceAltitudeAtCenter()},l=this.view.resourceController.scheduler,u=Object(I.s)(null==(e=this.view.basemapTerrain)?void 0:e.elevationQueryCache),d={state:n,scheduler:l,surface:a,renderCoordsHelper:o};this._set("centerOnSurfaceInfrequent",new Cw(Object(ie.a)(Object(ie.a)({},d),{},{task:Og.b.POINT_OF_INTEREST_INFREQUENT,estimateSurfaceAltitudeAtCenter:c}))),this._set("centerOnSurfaceFrequent",new Cw(Object(ie.a)(Object(ie.a)({},d),{},{task:Og.b.POINT_OF_INTEREST_FREQUENT,estimateSurfaceAltitudeAtCenter:c}))),this._set("centerOnContent",new Cw(Object(ie.a)(Object(ie.a)({},d),{},{task:Og.b.POINT_OF_INTEREST_FREQUENT,estimateSurfaceAltitudeAtCenter:function(){return t._estimateContentAltitudeAtCenter()}}))),this._set("cameraOnSurface",new _w(Object(ie.a)(Object(ie.a)({},d),{},{cache:u,task:Og.b.POINT_OF_INTEREST_INFREQUENT,map:s}))),this._set("contentCameraOnSurface",new _w(Object(ie.a)(Object(ie.a)({},d),{},{cache:u,task:Og.b.POINT_OF_INTEREST_INFREQUENT,map:s,cameraName:"contentCamera"}))),this._set("surfaceGeometryUpdates",new Gw(Object(ie.a)(Object(ie.a)({},d),{},{centerOnSurfaces:[this.centerOnSurfaceFrequent,this.centerOnContent,this.centerOnSurfaceInfrequent]}))),this._set("contentGeometryUpdates",new Mw({contentLayerViews:this.view.allLayerViews,renderCoordsHelper:o})),this._set("surfaceOrigin",new Lw({cache:u,view:this.view})),this._set("focus",new Fw({state:n,scheduler:l,surface:a,renderCoordsHelper:o,centerOnSurface:this.centerOnSurfaceFrequent,estimateSurfaceIntersectionAtRenderPoint:function(e,r){return t._estimateSurfaceIntersectionAtRenderPoint(e,r)}})),this._pois.push(this.centerOnContent,this.centerOnSurfaceFrequent,this.centerOnSurfaceInfrequent,this.cameraOnSurface,this.contentCameraOnSurface,this.focus);var h=this.view.graphics;this._debugCenters.set(this.centerOnContent,new mw(h,"red","CenterOnContent")),this._debugCenters.set(this.centerOnSurfaceFrequent,new mw(h,"red","CenterOnSurface")),this._debugCenters.set(this.cameraOnSurface,new mw(h,"blue","CameraOnSurface")),this._debugCenters.set(this.contentCameraOnSurface,new mw(h,"blue","CameraOfInterestOnSurface")),this._debugCenters.set(this.focus,new mw(h,"green","Focus")),this._handles.add([n.watch("camera",(function(e){return t._cameraChanged(e)}),!0),a.watch("extent",(function(){return t._updateCenterPointsOfInterest()})),Object(W.g)(a,"updating",(function(){return t._updateCenterPointsOfInterest()}),!0),this.surfaceGeometryUpdates.events.on("request-update",(function(){return t._updateCenterPointsOfInterest()})),this.contentGeometryUpdates.events.on("request-update",(function(){return t._updateCenterOnContent()})),Object(W.a)(Vy.a,"SHOW_POI",(function(e){return t._setDebug(e)}))]),this._cameraChanged(this.view.state.camera);var f,p=Object(i.a)(this._pois);try{for(p.s();!(f=p.n()).done;){f.value.runTask()}}catch(b){p.e(b)}finally{p.f()}}},{key:"destroy",value:function(){this._setDebug(!1),this._handles.destroy(),this._propertiesPool.destroy();var e,t=Object(i.a)(this._pois);try{for(t.s();!(e=t.n()).done;){e.value.destroy()}}catch(r){t.e(r)}finally{t.f()}this.surfaceOrigin.destroy()}},{key:"updating",get:function(){var e;return!!(null!=(e=this.surfaceGeometryUpdates)&&e.updating||this._pois.some((function(e){return e.updating})))}},{key:"centerRay",get:function(){return this._centerRayDirty&&(this._centerRay=this.view.sceneIntersectionHelper.getCenterRayWithSubpixelOffset(this.view.state.camera,this._tmpRay),this._centerRayDirty=!1),this._centerRay}},{key:"_estimateContentAltitudeAtCenter",value:function(){if(!this._contentAltitudeAtCenterDirty)return this._contentAltitudeAtCenter;this._contentAltitudeAtCenterDirty=!1;var e=this.centerRay;return Object(I.i)(e)||(this.view.sceneIntersectionHelper.intersectRay(e,this._contentIntersector,Qw,Xw)?this._contentAltitudeAtCenter=this.view.renderCoordsHelper.getAltitude(Qw):this._contentAltitudeAtCenter=this._estimateSurfaceAltitudeAtCenter()),this._contentAltitudeAtCenter}},{key:"_estimateSurfaceAltitudeAtCenter",value:function(){if(!this.view.basemapTerrain)return 0;if(!this._surfaceAltitudeAtCenterDirty)return this._surfaceAltitudeAtCenter;this._surfaceAltitudeAtCenterDirty=!1;var e=this.centerRay;if(Object(I.i)(e))return this._surfaceAltitudeAtCenter;var t=e.origin,r=Object(Yl.h)(Qw,e.origin,e.direction);return this._surfaceIntersector.resetWithRay(e),this._surfaceIntersector.camera=this.view.state.camera,this.view.basemapTerrain.intersect(this._surfaceIntersector,null,t,r),this._surfaceIntersector.results.min.getIntersectionPoint(Qw)&&(this._surfaceAltitudeAtCenter=this.view.renderCoordsHelper.getAltitude(Qw)),this._surfaceAltitudeAtCenter}},{key:"_estimateSurfaceIntersectionAtRenderPoint",value:function(e,t){var r=Object(Ip.b)(this.view.state.camera,e,Zw);if(Object(I.i)(r))return null;var n=r.origin,i=Object(Yl.h)(Qw,r.origin,r.direction);return this._surfaceIntersector.resetWithRay(r),this._surfaceIntersector.camera=this.view.state.camera,this.view.basemapTerrain.intersect(this._surfaceIntersector,null,n,i),this._surfaceIntersector.results.min.getIntersectionPoint(t)?t:null}},{key:"_cameraChanged",value:function(e){this._updateCenterPointsOfInterest();var t=e.eye;Object(Yl.q)(this.renderPointOfView,t)||this._set("renderPointOfView",Object(Yl.m)(this._propertiesPool.get("renderPointOfView"),t))}},{key:"_updateCenterPointsOfInterest",value:function(){this._centerRayDirty=!0,this._surfaceAltitudeAtCenterDirty=!0,this._contentAltitudeAtCenterDirty=!0;var e,t=Object(i.a)(this._pois);try{for(t.s();!(e=t.n()).done;){e.value.updateRenderLocation()}}catch(r){t.e(r)}finally{t.f()}}},{key:"_updateCenterOnContent",value:function(){this._contentAltitudeAtCenterDirty=!0,this.centerOnContent.updateRenderLocation()}},{key:"_setDebug",value:function(e){var t=this;if(!e)return this._debugCenters.forEach((function(e){return e.remove()})),void this._handles.remove("debug");var r,n=Object(i.a)(this._pois);try{var a=function(){var e=r.value;t._handles.add(Object(W.a)(e,"renderLocation",(function(r){return t._debugCenters.get(e).showPoint(r,e.renderCoordsHelper.spatialReference)})),"debug")};for(n.s();!(r=n.n()).done;)a()}catch(o){n.e(o)}finally{n.f()}}},{key:"test",get:function(){var e=this;return{update:function(){e.surfaceGeometryUpdates.runTask();var t,r=Object(i.a)(e._pois);try{for(r.s();!(t=r.n()).done;){t.value.runTask()}}catch(n){r.e(n)}finally{r.f()}},surfaceGeometryUpdates:this.surfaceGeometryUpdates}}}]),r}(de.a);Object(b.a)([Object(y.b)({readOnly:!0})],Hw.prototype,"centerOnContent",void 0),Object(b.a)([Object(y.b)({readOnly:!0})],Hw.prototype,"centerOnSurfaceFrequent",void 0),Object(b.a)([Object(y.b)({readOnly:!0})],Hw.prototype,"centerOnSurfaceInfrequent",void 0),Object(b.a)([Object(y.b)({readOnly:!0})],Hw.prototype,"cameraOnSurface",void 0),Object(b.a)([Object(y.b)({readOnly:!0})],Hw.prototype,"contentCameraOnSurface",void 0),Object(b.a)([Object(y.b)({readOnly:!0})],Hw.prototype,"focus",void 0),Object(b.a)([Object(y.b)({readOnly:!0})],Hw.prototype,"renderPointOfView",void 0),Object(b.a)([Object(y.b)({readOnly:!0})],Hw.prototype,"surfaceOrigin",void 0),Object(b.a)([Object(y.b)({readOnly:!0})],Hw.prototype,"contentGeometryUpdates",void 0),Object(b.a)([Object(y.b)({readOnly:!0})],Hw.prototype,"surfaceGeometryUpdates",void 0),Object(b.a)([Object(y.b)({constructOnly:!0})],Hw.prototype,"view",void 0),Object(b.a)([Object(y.b)({readOnly:!0})],Hw.prototype,"updating",null),Hw=Object(b.a)([Object(w.a)("esri.views.3d.support.PointsOfInterest")],Hw);var Ww=Array,Qw=Object(X.e)(),Zw=Object(Ud.c)(),Xw={exclude:new Set([qw.b])},Yw=Hw,$w=function(){function e(t){Object(c.a)(this,e),this.store=t}return Object(l.a)(e,[{key:"destroy",value:function(){this.store.destroy()}},{key:"get",value:function(e){return this.store.get(e)}},{key:"put",value:function(e,t){this.store.put(e,t,t.values.byteLength+256)}}]),e}(),Jw=r(659),Kw=r(355),ex=r(679),tx=r(416),rx=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;Object(c.a)(this,e),this.min=t,this.max=r,this.level=0,this.hasNoDataValues=!1}return Object(l.a)(e,[{key:"copyFrom",value:function(e){this.min=e.min,this.max=e.max,this.level=e.level,this.hasNoDataValues=e.hasNoDataValues}}]),e}(),nx=function(){function e(t,r,n){Object(c.a)(this,e),this.samplerData=null,this.level=t[0],this.i=t[1],this.j=t[2],this.extent=r;for(var i=n.noDataValue,a=n.values,o=1/0,s=-1/0,l=!0,u=!1,d=0;d<a.length;d++){var h=a[d];h!==i?(o=h<o?h:o,s=h>s?h:s,l=!1):u=!0}l&&(o=0,s=0),s=s>-3e38?s:0,this.samplerData={pixelData:n.values,width:n.width,height:n.height,noDataValue:i,safeWidth:.99999999*(n.width-1),dx:(n.width-1)/(r[2]-r[0]),dy:(n.width-1)/(r[3]-r[1]),x0:r[0],y1:r[3]},this.bounds=[o,s],this.hasNoDataValues=u}return Object(l.a)(e,[{key:"release",value:function(){this.samplerData=null,this.bounds=null}},{key:"computeMinMaxValue",value:function(e,t,r,n){n.min=1/0,n.max=-1/0,n.hasNoDataValues=!1;var i=e-this.level;if(i<=0)return n;var a=Math.pow(2,i);if(Math.floor(t/a)!==this.i||Math.floor(r/a)!==this.j)return n;var o=1/0,s=-1/0,c=this.samplerData.width,l=this.samplerData.pixelData,u=.5*Ps.c,d=(c-1)/a,h=(r-this.j*a)*d,f=(t-this.i*a)*d;if(d<1){var p=Math.floor(h),b=Math.floor(f),v=p+b*c,m=l[v],y=l[v+1],g=l[v+c],O=l[v+c+1];if(m+y+g+O<u){var j=h-p,_=f-b,w=Object(T.c)(m,y,g,O,j,_),x=Object(T.c)(m,y,g,O,j+d,_),k=Object(T.c)(m,y,g,O,j,_+d),S=Object(T.c)(m,y,g,O,j+d,_+d);return n.min=Math.min(w,x,k,S),n.max=Math.max(w,x,k,S),n}h=p,f=b,d=1}else h=Math.floor(h),f=Math.floor(f),d=Math.ceil(d);for(var C=h;C<=h+d;C++)for(var M=f;M<=f+d;M++){var P=l[C+M*c];P<u?(o=Math.min(o,P),s=Math.max(s,P)):n.hasNoDataValues=!0}return n.min=o,n.max=s,n}}],[{key:"sample",value:function(e,t,r){var n,a=Object(i.a)(r);try{for(a.s();!(n=a.n()).done;){var o=n.value;if(o){var s=o.safeWidth,c=o.width,l=o.pixelData,u=Object(m.e)(o.dy*(o.y1-t),0,s),d=Object(m.e)(o.dx*(e-o.x0),0,s),h=Math.floor(u),f=Math.floor(d),p=h*c+f,b=p+c,v=l[p],y=l[b],g=l[p+1],O=l[b+1];if(v+y+g+O<.5*Ps.c){var j=v+(g-v)*(d-=f);return j+(y+(O-y)*d-j)*(u-=h)}}}}catch(_){a.e(_)}finally{a.f()}return null}}]),e}(),ix=Object(Vd.a)(40),ax=Object(Vd.a)(50),ox=r(439),sx=r(266),cx=r(294),lx=r(71);function ux(){var e,t=null==(e=lx.a.require)?void 0:e.modules;if(t)for(var r=0,n=Object.keys(t);r<n.length;r++){var i=n[r];-1!==i.search(".glsl")&&delete t[i]}}var dx,hx=[[-.1,-2,3.9,2],[-.1,-3.9,3.9,.1],[-2,-3.9,2,.1],[-3.9,-3.9,.1,.1],[-3.9,-2,.1,2],[-3.9,-.1,.1,3.9],[-2,-.1,2,3.9],[-.1,-.1,3.9,3.9]],fx=function(e){Object(f.a)(r,e);var t=Object(p.a)(r);function r(e){var n;return Object(c.a)(this,r),(n=t.call(this,e))._handles=new oe.a,n._spatialReference=null,n._renderSR=null,n._overlaySREqualsRenderSR=!0,n._drapeSources=new Map,n._drapeTargets=new Set,n._renderedAltitude=0,n._displayOpacity=0,n._displayOpacityTime=-1,n._placementDirty=!1,n._drawTexturesDirty=!1,n._drawTexturesAnimateDirty=!1,n._layerViewsDirty=!0,n._hasUnusedRenderTargets=!1,n._longitudeCyclical=null,n._latestOriginId=0,n._maxResolution=Object(g.a)("esri-mobile")?2048:4096,n._animationTimeLast=0,n}return Object(l.a)(r,[{key:"running",get:function(){return(this._placementDirty||this._layerViewsDirty)&&(this._drapeSources.size>0||this.view.graphics.length>0||Vy.a.OVERLAY_DRAW_DEBUG_TEXTURE)&&!!this._spatialReference&&!this.suspended&&this.surface.ready}},{key:"_isSpherical",get:function(){return this.view.state.isGlobal}},{key:"view",get:function(){return this.surface.view}},{key:"updating",get:function(){return this.running||this.renderer.updating}},{key:"hasHighlights",get:function(){return this.renderer.hasHighlights}},{key:"rendersOccluded",get:function(){return this.renderer.rendersOccluded}},{key:"initialize",value:function(){var e=this,t=this.view,r=t.state.isGlobal&&Object(I.j)(this._spatialReference)?Object(ij.f)(this._spatialReference):1;this.renderer=new sx.b({view:t,globalUnitScale:r,spatialReference:this._spatialReference}),this.renderer.onHasHighlightsChanged=function(){e._setDrawTexturesDirty(),e.notifyChange("hasHighlights")},this.renderer.onRendersOccludedChanged=function(){e._setDrawTexturesDirty(),e.notifyChange("rendersOccluded")},this.renderer.onContentChanged=function(){return e._setDrawTexturesDirty()},this.renderer.onHasWaterChanged=function(e){var r;return null==(r=t._stage)?void 0:r.renderView.setRenderParameters({hasOverlayWater:e})},this.groundIntersector=new fh.a(this.view.state.viewingMode),this.groundIntersector.options.backfacesTerrain=!0,this.groundIntersector.options.invisibleTerrain=!0,this.groundIntersector.options.hud=!1,this._handles.add([t.watch(["pointsOfInterest.renderPointOfView","pointsOfInterest.centerOnSurfaceFrequent.location","pixelRatio"],(function(){return e.setOverlayPlacementDirty()})),this.surface.on("elevation-change",(function(){return e.setOverlayPlacementDirty()})),t.allLayerViews.on("after-changes",(function(){return e._layerViewsDirty=!0})),t.on("resize",(function(){return e.setOverlayPlacementDirty()})),Object(H.a)({preRender:function(t){e.renderer.processSyncLayers(),e._updateLayerViews(),e.renderer.hasOverlays&&(e._dispatchRendererUpdate(t),e._drawOverlayTextures(e.renderer.overlays)),e._hasUnusedRenderTargets&&e._collectUnusedRenderTargetMemory()}}),t.resourceController.scheduler.registerTask(Og.b.OVERLAY_MANAGER,this),t._stage.renderView.events.on("force-camera-for-screenshot",(function(t){e._updateOverlays(t),e.renderer.hasOverlays&&e._drawOverlayTextures(e.renderer.overlays)}))]),this._updateLayerViews()}},{key:"destroy",value:function(){var e=this;this._drapeSources.forEach((function(t,r){return e.unregisterDrapeSource(r)})),this._drapeTargets.forEach((function(t){return e._unregisterDrapeTarget(t)})),this.renderer.dispose(),this._handles&&(this._handles.destroy(),this._handles=null),Object(I.j)(dx)&&(dx.remove(),dx=null)}},{key:"hasOverlays",get:function(){return this.renderer.hasOverlays}},{key:"setSpatialReference",value:function(e){this._spatialReference=e,this.renderer.spatialReference=e,this._longitudeCyclical=null;var t=this.view.renderSpatialReference;Object(I.j)(e)&&Object(I.j)(t)?(this._renderSR=t,this._overlaySREqualsRenderSR=e.equals(this._renderSR),this._isSpherical&&(this._longitudeCyclical=e.isWebMercator?new T.a(-20037508.342787,20037508.342787):new T.a(-180,180),this.renderer.longitudeCyclical=this._longitudeCyclical),this.renderer&&(this.renderer.globalUnitScale=this._isSpherical&&Object(I.j)(this._spatialReference)?Object(ij.f)(this._spatialReference):1)):this.renderer.disposeOverlays()}},{key:"getGpuMemoryUsage",value:function(){return this.renderer.gpuMemoryUsage}},{key:"_updateLayerViews",value:function(){var e=this;if(this._layerViewsDirty){var t,r=new Set,n=Object(i.a)(this.view.allLayerViews.items);try{for(n.s();!(t=n.n()).done;){var a=t.value;r.add(a.uid),"drapeSourceType"in a&&!this._drapeSources.has(a)&&this._registerDrapeSource(a,0),"drapeTargetType"in a&&!this._drapeTargets.has(a)&&this._registerDrapeTarget(a)}}catch(o){n.e(o)}finally{n.f()}this._drapeSources.forEach((function(t,n){0!==t||r.has(n.uid)||e.unregisterDrapeSource(n)})),this._drapeTargets.forEach((function(t){r.has(t.uid)||e._unregisterDrapeTarget(t)})),this.renderer.updateLayerOrder(),this._setDrawTexturesDirty(),this._layerViewsDirty=!1}}},{key:"registerDrapeSource",value:function(e){this._registerDrapeSource(e,1)}},{key:"_registerDrapeSource",value:function(e,t){var r=this;this._drapeSources.set(e,t),this.renderer.ensureOverlays(this._drapeTargets,this._drapeSources),this.renderer.overlays.forEach((function(t){r._updateDrapeSource(e,t)})),this._setOverlayContentDirty(),this.notifyChange("running")}},{key:"_updateDrapeSource",value:function(e,t){Object(I.j)(e.setDrapingExtent)&&Object(I.j)(this._spatialReference)&&e.setDrapingExtent(t,this._spatialReference)}},{key:"unregisterDrapeSource",value:function(e){this._drapeSources.has(e)&&(this._drapeSources.delete(e),this.renderer.ensureDrapeSources(this._drapeSources),this._setOverlayContentDirty(),this.notifyChange("running"))}},{key:"_registerDrapeTarget",value:function(e){this._drapeTargets.add(e),this._updateDrapeTarget(e),this.renderer.ensureOverlays(this._drapeTargets,this._drapeSources)}},{key:"_updateDrapeTarget",value:function(e){this.renderer.overlays.forEach((function(t){return e.setDrapingTextures(t)}))}},{key:"_unregisterDrapeTarget",value:function(e){this._drapeTargets.delete(e),this.renderer.ensureDrapeTargets(this._drapeTargets)}},{key:"_setOverlayContentDirty",value:function(){this.setOverlayPlacementDirty(),this._setDrawTexturesDirty()}},{key:"setOverlayPlacementDirty",value:function(){this._placementDirty=!0}},{key:"runTask",value:function(){this._updateOverlays(this.view.state.camera)}},{key:"_updateOverlays",value:function(e){if(this._spatialReference){this._updateLayerViews();var t=Object(ox.b)(e.fullWidth,e.fullHeight,this._maxResolution);this._computeOverlayExtents(e,t,vx);var r=Object(K.A)(vx.inner)/Object(K.A)(vx.outer);this.renderer.ensureOverlays(this._drapeTargets,this._drapeSources);var n=this._updateOverlay(0,vx.inner,t,1),i=this._updateOverlay(1,vx.outer,t,r);(n||i)&&(this.surface.updateTileOverlayParams(),this._setDrawTexturesDirty()),this._placementDirty=!1,this.surface.updateOverlayOpacity()}}},{key:"_updateOverlay",value:function(e,t,r,n){var i=this;if(0===this.renderer.overlays.length)return!1;var a=this.renderer.overlays[e];if(!function(e,t){for(var r=1e-5,n=Vy.a.TESTS_DISABLE_UPDATE_THRESHOLDS?0:r*Math.max(e[2]-e[0],e[3]-e[1],t[2]-t[0],t[3]-t[1]),i=0;i<4;i++)if(Math.abs(t[i]-e[i])>n)return!0;return!1}(t,a.extent)&&r===a.resolution&&a.pixelRatio===n)return!1;Object(K.y)(a.extent,t),a.resolution=r,a.pixelRatio=n;var o=Object(K.e)(a.extent);return a.renderLocalOrigin=Object(cx.a)(o[0],o[1],0,"OV_"+this._latestOriginId++),this._drapeSources.forEach((function(e,t){return i._updateDrapeSource(t,a)})),!0}},{key:"computeOpacity",value:function(e){if(!this.renderer.hasOverlays)return this._displayOpacity=0,this._displayOpacityTime=-1,1;if(3.5*e<this._renderedAltitude){var t=(e-this._renderedAltitude/10)/(this._renderedAltitude/3.5-this._renderedAltitude/10);this._displayOpacity=Math.sqrt(Object(m.e)(t,0,1)),this._displayOpacityTime=performance.now()}else if(1!==this._displayOpacity){var r=performance.now();this._displayOpacityTime=this._displayOpacityTime>0?this._displayOpacityTime:r;var n=r-this._displayOpacityTime,i=this.surface.textureFadeDuration;if(n<i)return this._displayOpacity+(1-this._displayOpacity)*(n/i);this._displayOpacity=1,this._displayOpacityTime=-1}return this._displayOpacity}},{key:"setTileParameters",value:function(e){var t=e.renderData.overlay;if(this.renderer.overlays.length>0){var r=this.renderer.overlays[0],n=this.renderer.overlays[1],i=Object(K.u)(e.extent,e.surface.extent,mx);this._rectInsideRect(i,r.extent)||this._rectanglesOverlap(i,r.extent)||this._rectanglesOverlap(i,n.extent)?(this._setTileOverlayData(i,0,t),this._setTileOverlayData(i,1,t)):(this._clearTileOverlayData(0,t),this._clearTileOverlayData(1,t))}else this._clearTileOverlayData(0,t),this._clearTileOverlayData(1,t)}},{key:"overlayPixelSizeInMapUnits",value:function(e){if(0===this.renderer.overlays.length)return 0;var t=this.renderer.overlays[0],r=this.renderer.overlays[1],n=this._pointIsInExtent(e,t.extent)?t:r;return(n.extent[2]-n.extent[0])/n.resolution}},{key:"_setTileOverlayData",value:function(e,t,r){if(0!==this.renderer.overlays.length){var n=this.renderer.overlays[t].extent;r.setScale(t,(e[2]-e[0])/(n[2]-n[0]),(e[3]-e[1])/(n[3]-n[1]));var i=e[0];if(this._longitudeCyclical){i=this._longitudeCyclical.minimalMonotonic(n[0],i);var a=this._longitudeCyclical.minimalMonotonic(n[0],e[2]);i>a&&(i=a-(e[2]-e[0]))}r.setOffset(t,(i-n[0])/(n[2]-n[0]),(e[1]-n[1])/(n[3]-n[1]))}}},{key:"_clearTileOverlayData",value:function(e,t){t.setScale(e,-1,-1),t.setOffset(e,-1,-1)}},{key:"reloadShaders",value:function(){var e=Object(s.a)(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return ux(),e.next=3,this.renderer.reloadShaders();case 3:this.runTask();case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"stopAnimationsAtTime",value:function(e){this.renderer.stopAnimationsAtTime(e),this._drawTexturesAnimateDirty=!0}},{key:"_dispatchRendererUpdate",value:function(e){var t=Object(Vd.a)(e.time-this._animationTimeLast);t<ax||(this._animationTimeLast=e.time,this.renderer.updateLogic({dt:t,camera:this.view.state.camera})&&(this._drawTexturesAnimateDirty=!0))}},{key:"_setDrawTexturesDirty",value:function(){this.renderer.hasOverlays?this._drawTexturesDirty=!0:this.setOverlayPlacementDirty()}},{key:"_intersectGroundFromView",value:function(e,t,r,n){var i=this.view.sceneIntersectionHelper.getCenterRayWithSubpixelOffset(e,gx,t,r);if(Object(I.i)(i))return!1;var a=i.origin,o=Object(Yl.h)(bx,i.origin,i.direction);return this.groundIntersector.reset(a,o),this.groundIntersector.intersect([],null,e),this.view.basemapTerrain.intersect(this.groundIntersector,null,a,o),this.groundIntersector.results.min.getIntersectionPoint(n)}},{key:"_findHorizonBasedPointOfInterest",value:function(e,t){var r=.5,n=.55,i=this.view.renderCoordsHelper.getAltitude(e.eye),a=this.view.pointsOfInterest.centerOnSurfaceFrequent,o=1e-5,s=Object(m.e)(a.estimatedSurfaceAltitude,e.aboveGround?-1/0:i+o,e.aboveGround?i-o:1/0),c=e.aboveGround;if("global"===this.view.viewingMode){var l=bx;Object(Nd.b)(Object(Nd.e)(Object(J.e)(this.view.spatialReference).radius+s),Object(Ud.g)(e.eye,e.viewForward),l),Object(Yl.l)(l,l,e.eye);var u=T.f.normalize(Object(mp.b)(e.viewForward,l,e.viewRight))/e.fovY+.5,d=u<=0||u>=1?.5:n;r=c?d*u:u+d*(1-u)}else{var h=.5*Math.PI-Math.acos(-e.viewForward[2]),f=Math.tan(h),p=Object($l.g)(0,f,1,0),b=Object(Su.m)(p,p,e.projectionMatrix)[1],v=Object(m.e)(.5+.5*b,0,1);r=1===v||0===v?.5:c?v*n:1-(1-v)*n}return!!this._intersectGroundFromView(e,.5,r,t)&&Object(Yl.E)(t,e.eye)<a.distance*a.distance}},{key:"_computeOverlayExtents",value:function(e,t,r){var n=this.surface.extent,i=this.view.pointsOfInterest.centerOnSurfaceFrequent.renderLocation,a=Object(X.e)();this._findHorizonBasedPointOfInterest(e,a)||Object(Yl.m)(a,i),this._renderedAltitude=this.view.renderCoordsHelper.getAltitude(e.eye);var o=Object(Yl.o)(e.eye,a),s=Th(this.view.renderCoordsHelper,i,e.eye),c=Math.PI/2-Math.abs(s-Math.PI/2);Vy.a.OVERLAY_SHOW_CENTER?(Object(I.i)(dx)&&(dx=new mw(this.view.graphics,"red")),dx.showPoint(a,this._renderSR)):Object(I.j)(dx)&&dx.remove(),this._overlaySREqualsRenderSR||Object($.z)(a,this._renderSR,a,this._spatialReference);var l=t*e.perRenderPixelRatio*o/2,u=!1,d=1/0;this._isSpherical&&Object(I.j)(this._spatialReference)&&(this._spatialReference.isWebMercator?(l/=Math.cos(Object(re.h)(a[1])),d=this.surface.extent[3]):(u=!0,l/=Object(J.e)(this._spatialReference).metersPerDegree,d=90),l>=d&&(l=d,a[1]=0,this._spatialReference.isWebMercator&&(a[0]=0)));var h=1;u&&(l*(h=1/Math.max(.2,Math.cos(Math.abs(Object(m.g)(a[1])))))>180&&(h=180/l));var f=Math.log(2)/12,p=(l=Math.exp(Math.round(Math.log(l)/f)*f))*h,b=.5*t/(32*p),v=.5*t/(32*l);a[0]=Math.round(a[0]*b)/b,a[1]=Math.round(a[1]*v)/v;var y=r.inner;y[0]=a[0]-p,y[1]=a[1]-l,y[2]=a[0]+p,y[3]=a[1]+l,this._isSpherical&&this._shiftExtentToFitBounds(y,1/0,d);var g=r.outer;if(Object(K.y)(g,y),6*p>n[2]-n[0])Object(K.y)(g,n);else if(c<=.25*Math.PI)g[0]-=p,g[1]-=l,g[2]+=p,g[3]+=l;else{Object($.z)(e.eye,this._renderSR,bx,this._spatialReference),Object(xu.a)(px,a,bx);var O=-Math.atan2(px[1],px[0])+.125*Math.PI;O<0&&(O+=2*Math.PI);var j=Math.floor(O/(.25*Math.PI));Object(Su.b)(px,hx[j],2*l),px[0]*=h,px[2]*=h,Object(Su.a)(g,g,px)}if(this._isSpherical&&(g[0]=this._longitudeCyclical.clamp(g[0]),g[2]=this._longitudeCyclical.clamp(g[2]),g[1]=Math.max(g[1],-d),g[3]=Math.min(g[3],d)),!this._isSpherical&&n){var _=Object(K.u)(y,n,mx),w=Object(K.u)(g,n,yx);Object(K.g)(_,w)&&(g[2]=g[0],g[3]=g[1])}}},{key:"_drawOverlayTextures",value:function(e){var t=this;if(0!==e.length&&(this._drawTexturesDirty||this._drawTexturesAnimateDirty)){var r=this._drawOverlay(e[0]),n=this._drawOverlay(e[1]);0!==r&&0!==n||this.surface.updateTileOverlayParams(),this._collectUnusedRenderTargetMemory(),this._drapeTargets.forEach((function(e){return t._updateDrapeTarget(e)})),this._drawTexturesAnimateDirty=!1,this._drawTexturesDirty?(this._drawTexturesDirty=!1,this.surface.requestRender(),this.surface.requestUpdate()):this.surface.requestRender(0)}}},{key:"_drawOverlay",value:function(e){return this._longitudeCyclical?e.setupGeometryViewsCyclical(this._longitudeCyclical):e.setupGeometryViewsDirect(),e.draw(this.renderer,this.view.state.camera.pixelRatio)}},{key:"_collectUnusedRenderTargetMemory",value:function(){if(this._hasUnusedRenderTargets=!1,this.renderer.hasOverlays){var e=performance.now();this._hasUnusedRenderTargets=this.renderer.collectUnusedRenderTargetMemory(e)}}},{key:"_rectanglesOverlap",value:function(e,t){return this._longitudeCyclical?(this._longitudeCyclical.contains(t[0],t[2],e[0])||this._longitudeCyclical.contains(t[0],t[2],e[2])||this._longitudeCyclical.contains(e[0],e[2],t[0]))&&!(e[1]>t[3]||e[3]<t[1]):Object(K.v)(e,t)}},{key:"_rectInsideRect",value:function(e,t){return this._longitudeCyclical?this._longitudeCyclical.contains(t[0],t[2],e[0])&&this._longitudeCyclical.contains(t[0],t[2],e[2])&&e[1]>t[1]&&e[3]<t[3]:Object(K.g)(t,e)}},{key:"_pointIsInExtent",value:function(e,t){if(this._longitudeCyclical)return this._longitudeCyclical.contains(t[0],t[2],e.x)&&e.y>=t[1]&&e.y<=t[3];var r=e.x,n=e.y;return r>t[0]&&r<t[2]&&n>t[1]&&n<t[3]}},{key:"_shiftExtentToFitBounds",value:function(e,t,r){var n=0,i=0;e[0]<-t?n=e[0]+t:e[2]>t&&(n=t-e[2]),e[1]<-r?i=e[1]+r:e[3]>r&&(i=r-e[3]),Object(K.x)(e,n,i)}},{key:"test",get:function(){var e=this;return{renderer:this.renderer,update:function(){return e.runTask()}}}}]),r}(de.a);Object(b.a)([Object(y.b)()],fx.prototype,"_spatialReference",void 0),Object(b.a)([Object(y.b)({readOnly:!0})],fx.prototype,"running",null),Object(b.a)([Object(y.b)()],fx.prototype,"_placementDirty",void 0),Object(b.a)([Object(y.b)()],fx.prototype,"_layerViewsDirty",void 0),Object(b.a)([Object(y.b)()],fx.prototype,"renderer",void 0),Object(b.a)([Object(y.b)({constructOnly:!0})],fx.prototype,"surface",void 0),Object(b.a)([Object(y.b)({readOnly:!0,aliasOf:"surface.suspended"})],fx.prototype,"suspended",void 0),Object(b.a)([Object(y.b)({readOnly:!0})],fx.prototype,"updating",null),Object(b.a)([Object(y.b)({type:Boolean})],fx.prototype,"hasHighlights",null),Object(b.a)([Object(y.b)({type:Boolean})],fx.prototype,"rendersOccluded",null),fx=Object(b.a)([Object(w.a)("esri.views.3d.terrain.OverlayManager")],fx);var px=Object($l.e)(),bx=Object(X.e)(),vx={inner:Object(K.k)(),outer:Object(K.k)()},mx=Object(K.k)(),yx=Object(K.k)(),gx=Object(Ud.c)(),Ox=function(){function e(t,r){Object(c.a)(this,e),this._factoryCallback=t,this._lengthCallback=r,this._pool=new Map}return Object(l.a)(e,[{key:"acquire",value:function(t){if(!e.test.disabled){var r=this._pool.get(t);if(r&&0!==r.length)return r.pop()}try{return this._factoryCallback(t)}catch(a){var n=window.performance&&window.performance.memory,i="";throw n&&(i="\n  totalJSHeapSize: ".concat(n.totalJSHeapSize,", usedJSHeapSize: ").concat(n.usedJSHeapSize,", jsHeapSizeLimit: ").concat(n.jsHeapSizeLimit)),console.log("Array allocation of size "+t+" failed: "+a+i),a}}},{key:"release",value:function(t){if(!e.test.disabled){var r=this._lengthCallback(t),n=this._pool.get(r);n||(n=new zy.a({shrink:!0}),this._pool.set(r,n)),n.push(t)}}},{key:"clear",value:function(){this._pool.clear()}},{key:"test",get:function(){return{size:this._pool.size}}}]),e}();Ox.test={disabled:!1};var jx=r(102),_x=Object(hu.a)().vec3f("position").vec2f("uv0"),wx=new Ox((function(e){return _x.createBuffer(e)}),(function(e){return e.count})),xx=function e(){Object(c.a)(this,e),this.indices=null,this.vertexAttributes=null,this.boundingBox=Object(Eg.k)(),this.numSurfaceIndices=0,this.numSkirtIndices=0,this.numWithoutSkirtIndices=0,this.numVertsPerRow=0,this.skirtLength=0,this.uvOffsetAndScale=Object($l.e)()},kx=function e(t,r,n){Object(c.a)(this,e),this.values=t,this.numSurfaceIndices=r,this.numSkirtIndices=n};var Sx=new Map;function Tx(e,t,r,n){var i=(2&r)>0,a=t+(n?1024:0)+(i?2048:0),o=Sx.get(a);o||(o=function(e,t,r){var n=e-1,i=e-1,a=e*e,o=2*n+2*i,s=n*i*2*3,c=6*o,l=6*(2*n+i-1);r&&(s*=2,c*=2,l*=2);for(var u,d,h,f,p=a+o>65536?new Uint32Array(s+c):new Uint16Array(s+c),b=0,v=0,m=s,y=0,g=0;g<=i;g++){t&&(y=0===g?l:g===i?-l:0),m+=y;for(var O=0;O<=n;O++){var j=Px(O,g,n,i);if(j>-1){var _=Ax(O,g,n,i);0!==_&&(u=b,d=a+j,h=a+(0===O&&1===g?0:j+1),f=b+_,r?(p[m+0]=u,p[m+1]=d,p[m+2]=d,p[m+3]=h,p[m+4]=h,p[m+5]=u,p[m+6]=h,p[m+7]=f,p[m+8]=f,p[m+9]=u,p[m+10]=u,p[m+11]=h,m+=12):(p[m+0]=u,p[m+1]=d,p[m+2]=h,p[m+3]=h,p[m+4]=f,p[m+5]=u,m+=6))}++b,O<n&&g<i&&(f=(h=(d=(u=g*(n+1)+O)+1)+(n+1))-1,r?(p[v+0]=u,p[v+1]=d,p[v+2]=d,p[v+3]=h,p[v+4]=h,p[v+5]=u,p[v+6]=h,p[v+7]=f,p[v+8]=f,p[v+9]=u,p[v+10]=u,p[v+11]=h,v+=12):(p[v+0]=u,p[v+1]=d,p[v+2]=h,p[v+3]=h,p[v+4]=f,p[v+5]=u,v+=6))}m-=y}return new kx(p,s,c)}(t,i,n),Sx.set(a,o)),e.indices=o.values,e.numSurfaceIndices=o.numSurfaceIndices,e.numSkirtIndices=o.numSkirtIndices,e.numWithoutSkirtIndices=e.numSurfaceIndices+(r?6*(t-1)*(n?2:1):0)}function Cx(e,t,r,n){e<n[0]&&(n[0]=e),e>n[3]&&(n[3]=e),t<n[1]&&(n[1]=t),t>n[4]&&(n[4]=t),r<n[2]&&(n[2]=r),r>n[5]&&(n[5]=r)}function Mx(e,t){var r=t>e?1:0;return 2+4*r+(1-2*r)*(e+t)}function Px(e,t,r,n){return 0===t?e:e===r?r+t:t===n?r+n+(r-e):0===e&&t>0?2*r+n+(n-t):-1}function Ax(e,t,r,n){return 0===t&&e!==r?1:e===r&&t!==n?r+1:t===n&&0!==e?-1:0===e&&0!==t?-(r+1):0}var Ex=new Array(Ps.h+1),Rx=new Array(Ps.h+1),Ix=new Array(Ps.h+1),Dx=new Array(Ps.h+1),Fx=Object(X.e)(),Lx=Object(X.e)(),zx=r(517),Vx=r(139),Nx=function(){function e(){Object(c.a)(this,e)}return Object(l.a)(e,[{key:"updating",get:function(){return!!this._tileRequested}},{key:"init",value:function(e,t,r,n){this.tile=e,this._layerIdx=t,this._layerClass=r,this._suspended=n,this._tileLayerInfo=e.getLayerInfo(t,r),this._tileRequested=null;var i=this._findAncestorWithData();this._setUpsampleTile(i)}},{key:"startLoading",value:function(){return this._requestNext()}},{key:"dispose",value:function(){this._tileRequested&&(this._tileRequested.unrequestLayerData(this._layerIdx,this._layerClass,this),this._tileRequested=null),this.tile=null,this._tileLayerInfo=null}},{key:"setSuspension",value:function(e){e!==this._suspended&&(this._suspended=e,e?this._tileRequested&&(this._tileRequested.unrequestLayerData(this._layerIdx,this._layerClass,this),this._tileRequested=null):this._tileLayerInfo.data||this.update())}},{key:"update",value:function(){var e=this._findAncestorWithData();return this._setUpsampleTile(e),this._requestNext()}},{key:"dataArrived",value:function(e){this._setUpsampleTile(e),this._tileRequested=null,e===this.tile?this.tile.updateRenderData(this._layerClass):this._requestNext()}},{key:"dataMissing",value:function(){this._tileRequested=null,this._tileLayerInfo.data=null,this._requestNext()}},{key:"_agentDone",value:function(){this.tile.agentDone(this._layerIdx,this._layerClass),this.dispose()}},{key:"_requestNext",value:function(){if(this._suspended)return!0;var e=this._findNextDownload();if(this._tileRequested){if(e===this._tileRequested)return!0;this._tileRequested.unrequestLayerData(this._layerIdx,this._layerClass,this),this._tileRequested=null}return Object(I.j)(e)?e.requestLayerData(this._layerIdx,this._layerClass,this)&&(this._tileRequested=e):this._agentDone(),!!this._tileRequested}},{key:"_findNextDownload",value:function(){for(var e,t=this._layerIdx,r=this._layerClass,n=this.tile.surface.layerViewByIndex(t,r),i=Object(aw.c)(n),a=n.dataLevelRange,o=a.minLevel,s=a.maxLevel,c=this._desiredMinLevelDelta,l=this._progressiveLevelModulo+c,u=this._scaleRangeEnabled?Vx.e:function(){return!0},d=this.tile,h=d.level,f=this._tileLayerInfo.upsampleInfo,p=f?f.tile.level:-1,b=Object(I.h)(i,"tilemapCache");d&&u(d,i,!1)&&d.level>=o;){var v=d.level,m=h-v,y=d.layerInfo[r][t];if(y.data&&m>=c){v>p&&this._setUpsampleTile(d),y.dataInvalidated&&(e=d);break}if((Object(I.i)(b)||"unavailable"!==b.getAvailability(d.lij[0],d.lij[1],d.lij[2]))&&v<=s&&!y.data&&!y.dataMissing&&((Object(I.i)(e)||d.level===o||v%Ps.j==0||h-e.level<c)&&(e=d),m>=l))break;d=d.parent}return Object(I.j)(e)&&h-e.level<c&&this._tileLayerInfo.upsampleInfo&&(e=null),e}},{key:"_findAncestorWithData",value:function(){for(var e,t=this.tile.vlevel,r=this._desiredMinLevelDelta,n=this.tile;n;n=n.parent)if(n.hasLayerData(this._layerIdx,this._layerClass)){if(t-n.level>=r)return n;e=n}return e}},{key:"_setUpsampleTile",value:function(e){this._tileLayerInfo.setUpsampleInfo(this.tile,e),this.tile.updateRenderData(this._layerClass)}},{key:"test",get:function(){var e=this;return{findNextDownload:function(){return e._findNextDownload()},tileLayerInfo:this._tileLayerInfo}}}]),e}(),Ux=function(e){Object(f.a)(r,e);var t=Object(p.a)(r);function r(){return Object(c.a)(this,r),t.apply(this,arguments)}return Object(l.a)(r,[{key:"_desiredMinLevelDelta",get:function(){throw Bx}},{key:"_progressiveLevelModulo",get:function(){throw Bx}},{key:"dispose",value:function(){}}]),r}(Nx),Bx=new Error("Abstract method called on TileAgent"),Gx=new Ux,qx=function(e){Object(f.a)(r,e);var t=Object(p.a)(r);function r(){var e;return Object(c.a)(this,r),(e=t.apply(this,arguments))._scaleRangeEnabled=!1,e}return Object(l.a)(r,[{key:"_desiredMinLevelDelta",get:function(){return Ps.b-(this.tile.vlevel-this.tile.level)}},{key:"_progressiveLevelModulo",get:function(){return 0}}]),r}(Nx),Hx=function(e){Object(f.a)(r,e);var t=Object(p.a)(r);function r(){var e;return Object(c.a)(this,r),(e=t.call(this))._scaleRangeEnabled=!0,e}return Object(l.a)(r,[{key:"_desiredMinLevelDelta",get:function(){return 0}},{key:"_progressiveLevelModulo",get:function(){return Ps.j}}]),r}(Nx),Wx=r(431),Qx=function(){function e(){Object(c.a)(this,e),this.waitingAgents=new zy.a,this._upsampleInfo=null,this.loadingAgent=null,this.requestPromise=null,this.requestAbort=null,this.pendingUpdates=0}return Object(l.a)(e,[{key:"release",value:function(){this.dispose(),Xx.delete(this),Zx.release(this)}},{key:"dispose",value:function(){this.loadingAgent=Object(I.f)(this.loadingAgent),this.abortRequest(),this._unsetUpsampleInfo(),this.pendingUpdates=0,this._data=Object(aw.p)(this._data)}},{key:"_init",value:function(e){this.waitingAgents.clear(),this._data=Object(aw.p)(this._data),this.dataMissing=!1,this.dataInvalidated=!1,this._unsetUpsampleInfo(),this.abortRequest(),this.loadingAgent=null,this.pendingUpdates=0,this._pool=e,this.elevationBounds=null}},{key:"invalidateSourceData",value:function(){this.dataInvalidated=!0,this.dataMissing=!1,this._unsetUpsampleInfo()}},{key:"abortRequest",value:function(){this.requestAbort=Object(I.a)(this.requestAbort),this.requestPromise=null}},{key:"upsampleInfo",get:function(){return this._upsampleInfo}},{key:"_unsetUpsampleInfo",value:function(){this._upsampleInfo&&(this._upsampleInfo.tile.unrefMapData(),this._pool.release(this._upsampleInfo),this._upsampleInfo=null)}},{key:"setUpsampleInfo",value:function(e,t){if(e===t||Object(I.i)(t))this._unsetUpsampleInfo();else{if(null==this._upsampleInfo)this._upsampleInfo=this._pool.acquire();else{if(this._upsampleInfo.tile===t)return;this._upsampleInfo.tile.unrefMapData()}t.refMapData(),Object(Vx.d)(e,t,this._upsampleInfo)}}},{key:"data",get:function(){return this._data},set:function(e){Object(aw.p)(this._data),this._data=e}}],[{key:"acquire",value:function(e){var t=Zx.acquire();return t._init(e),t}},{key:"prune",value:function(){Zx.prune(0)}}]),e}(),Zx=new mO.a(Qx,null,(function(){})),Xx=new Map;var Yx=r(253),$x=Object(X.e)(),Jx=Object(X.e)(),Kx=Object(X.e)(),ek=Object($l.e)(),tk=function e(){Object(c.a)(this,e),this.fovX=0,this.fovY=0,this.relativeWidthLimit=0,this.relativeHeightLimit=0,this.maxLod=0,this.angledSplitBias=0,this.aboveGround=!0},rk=function(){function e(t){Object(c.a)(this,e),this._numSubdivisionAtLevel=t,this.lij=[0,0,0],this._children=[null,null,null,null],this._dirty=!0,this._previouslyRendered=!1,this.extent=Object(K.k)(),this._elevationBounds=Object(ku.b)(),this.layerInfo=[[],[]],this.extentInRadians=Object(K.k)(),this.centerAtSeaLevel=Object(X.e)(),this._center=[Object(X.e)(),Object(Nd.c)(),Object(X.e)()],this.up=Object(X.h)(),this._isWithinClippingArea=!0,this._intersectsClippingArea=!0,this._maxTesselation=0,this._usedMemory=ck,this._mapTileMemory=0,this._mapDataRefCount=0,this._screenDepth=0,this.renderOrder=0,this._edgeLen=0,this._edgeLen2=0,this._curvatureHeight=0}return Object(l.a)(e,[{key:"usedMemory",get:function(){return this._usedMemory===ck&&this._updateMemoryUsed(),this._usedMemory+(this.isCached?0:this.mapTileMemory)}},{key:"cachedMemory",get:function(){return this.isCached?this.mapTileMemory:0}},{key:"mapTileMemory",get:function(){this._usedMemory===ck&&this._updateMemoryUsed();var e,t=this._mapTileMemory,r=Object(i.a)(this.layerInfo[1]);try{for(r.s();!(e=r.n()).done;){var n=e.value.data;n instanceof Kw.a&&(t+=n.memoryUsage)}}catch(a){r.e(a)}finally{r.f()}return t}},{key:"isCached",get:function(){return!this.shouldLoad&&this._mapDataRefCount<=0}},{key:"maxTesselation",get:function(){return this._maxTesselation}},{key:"numSubdivisionsAtLevel",get:function(){return this._numSubdivisionAtLevel}},{key:"isWithinClippingArea",get:function(){return this._isWithinClippingArea}},{key:"intersectsClippingArea",get:function(){return this._intersectsClippingArea}},{key:"clippingArea",get:function(){return this._clippingArea}},{key:"parent",get:function(){return this._parent}},{key:"children",get:function(){return this._children}},{key:"surface",get:function(){return this._surface}},{key:"elevationBounds",get:function(){return this._elevationBounds}},{key:"level",get:function(){return this.lij[0]}},{key:"edgeLen",get:function(){return this._edgeLen}},{key:"radius",get:function(){return this._center[1][3]}},{key:"screenDepth",get:function(){return this._screenDepth}},{key:"visible",get:function(){if(this._dirty){this._dirty=!1;var e=this._isVisible(this.surface.frustum);e!==this._visible&&(this._visible=e,this._surface.emit("tiles-visibility-changed"),this._surface.renderer.setNeedsRender()),this.updateAgentSuspension()}return this._visible}},{key:"loadable",get:function(){return this.visible||this._surface.view.state.fixedContentCamera}},{key:"rendered",get:function(){var e=!!this.renderData;return e!==this._previouslyRendered&&(this._surface.emit("tiles-visibility-changed"),this._previouslyRendered=e,this._surface.renderer.setNeedsRender()),e}},{key:"shouldLoad",get:function(){if(!this.loadable)return!1;if(1===this._surface.lodSnapping){var e=this.level-this._surface.snapLevel;if(0===e)return!0;if(1===e)return!1}return this.isLeaf}},{key:"init",value:function(e,t,r){this.lij[0]=e[0],this.lij[1]=e[1],this.lij[2]=e[2],this.ellipsoid=Object(J.e)(r.tilingScheme.spatialReference),r.tilingScheme.getExtent(e[0],e[1],e[2],this.extent),r.tilingScheme.convertExtentToRadians(this.extent,this.extentInRadians),this._isWithinClippingArea=!0,this._intersectsClippingArea=!0,this._clippingArea=null,this._mapDataRefCount=0,r.upsampleMapCache.pop(Object(Vx.i)(this)),this._edgeLen=0,this._edgeLen2=0,this._center[1][3]=0,this.vlevel=e?e[0]:0,t&&t.elevationBounds?Object(xu.c)(this._elevationBounds,t.elevationBounds):Object(xu.r)(this._elevationBounds,0,0),this._pendingUpdates=0,this.renderData=null,this._screenDepth=0,this._visible=!1,this._previouslyRendered=!1,this._parent=t,this.unsetChildren(),this._surface=r,this.updateVisibility();var n,a=Object(i.a)(Ps.f);try{for(a.s();!(n=a.n()).done;){var o,s=n.value,c=r.numLayers(s),l=this.layerInfo[s],u=Object(i.a)(l);try{for(u.s();!(o=u.n()).done;){o.value.release()}}catch(h){u.e(h)}finally{u.f()}l.length=c;for(var d=0;d<c;d++)l[d]=Qx.acquire(this._surface.upsampleInfoPool),0===s&&this.findElevationBoundsForLayer(d,-1)}}catch(h){a.e(h)}finally{a.f()}this.computeElevationBounds(),this._maxTesselation=Math.min(r.tilingScheme.pixelSize,Ps.h)}},{key:"release",value:function(){Object(aw.s)(!this.renderData,"tile.renderData was not unloaded"),this._surface.upsampleMapCache.pop(Object(Vx.i)(this));var e,t=Object(i.a)(Ps.f);try{for(t.s();!(e=t.n()).done;){var r,n=e.value,a=Object(i.a)(this.layerInfo[n]);try{for(a.s();!(r=a.n()).done;){r.value.release()}}catch(o){a.e(o)}finally{a.f()}this.layerInfo[n].length=0}}catch(o){t.e(o)}finally{t.f()}this._parent=null,this._surface=null,this._usedMemory=ck}},{key:"refMapData",value:function(){++this._mapDataRefCount,this.isCached||this._surface.upsampleMapCache.pop(Object(Vx.i)(this))}},{key:"unrefMapData",value:function(){if(--this._mapDataRefCount,this.isCached){var e=this.cachedMemory;e>0&&(this._surface.upsampleMapCache.put(Object(Vx.i)(this),this,e),this.setMemoryDirty())}}},{key:"setMemoryDirty",value:function(){this._usedMemory=ck}},{key:"cpuImageMemorySize",get:function(){var e=this._surface.tilingScheme.pixelSize;return e*e*4}},{key:"_updateMemoryUsed",value:function(){this._usedMemory=0,this._mapTileMemory=0;var e,t=this.cpuImageMemorySize,r=Object(i.a)(this.layerInfo[1]);try{for(r.s();!(e=r.n()).done;){var n=e.value.data;n instanceof Yx.a?this._mapTileMemory+=Object(mu.c)(n.texture):n instanceof HTMLImageElement||n instanceof nw.a?this._mapTileMemory+=t:n instanceof Wx.a&&(this._mapTileMemory+=n.memoryUsage)}}catch(c){r.e(c)}finally{r.f()}var a,o=Object(i.a)(this.layerInfo[0]);try{for(o.s();!(a=o.n()).done;){var s=a.value;this._usedMemory+=s.data?t:0}}catch(c){o.e(c)}finally{o.f()}this.renderData&&(this._usedMemory+=this.renderData.estimatedGeometryMemoryUsage,this._mapTileMemory+=Object(mu.c)(this.renderData.textureDescriptor)),this.isCached&&this._surface.upsampleMapCache.updateSize(Object(Vx.i)(this),this,this.cachedMemory)}},{key:"getUsedMemoryForLayer",value:function(e,t){var r=this.layerInfo[e][t];if(!r||!r.data)return 0;if(1!==e||this.isCached){if(0===e)return this.cpuImageMemorySize}else{var n=r.data;if(n instanceof Yx.a)return Object(mu.c)(n.texture);if(n instanceof HTMLImageElement||n instanceof nw.a)return this.cpuImageMemorySize;if(n instanceof Kw.a||n instanceof Wx.a)return n.memoryUsage}return 0}},{key:"updateScreenDepth",value:function(e){Object(Yl.m)(ek,this._center[1]),ek[3]=1,Object(Su.m)(ek,ek,e),this._screenDepth=ek[2]<0?0:ek[2]/ek[3]}},{key:"shouldSplit",value:function(e,t,r){var n=this;if(Object(I.j)(e.frustum)&&!this._isVisible(e.frustum))return 0;var i=this.level;Object(Yl.l)($x,this._center[1],t);var a=Object(Yl.v)($x),o=1;Object(Yl.l)(Jx,this._center[0],t);var s=Object(Yl.v)(Jx);s<a&&(a=s,o=0),Object(Yl.l)(Jx,this._center[2],t);var c=Object(Yl.v)(Jx);if(c<a&&(a=c,o=2),this._edgeLen2>a&&i<e.maxLod)return 2;var l=Math.sqrt(a),u=e.fovX*l*2,d=this._edgeLen/u,h=function(){var t=i+Math.ceil(-Object(m.n)(e.relativeWidthLimit/d));return t!==n.vlevel?(n.vlevel=t,4):1};if(1===r&&1===this._surface.snapLevel-i)return i>=e.maxLod?h():2;var f=Object(Yl.j)(this.up,$x),p=this._elevationBounds[1]-this._elevationBounds[0],b=p/this.edgeLen;if(e.aboveGround&&f>0&&b<.001&&f/l-Math.sin(this._curvatureHeight/(this.edgeLen*Math.SQRT1_2)*Math.PI)-b>0)return 0;if(d<e.relativeWidthLimit)return this.vlevel!==this.level?(this.vlevel=this.level,4):0;if(i>=e.maxLod)return h();if(i>6){Object(Yl.l)(Jx,this._center[o],t),Object(Yl.g)(Kx,this.up,f),Object(Yl.l)(Kx,Kx,Jx);var v=Object(Yl.v)(Kx);if(v>this.radius*this.radius){Object(Yl.g)(Kx,Kx,this.radius/Math.sqrt(v)),Object(Yl.h)(Kx,Kx,this._center[o]),Object(Yl.l)(Kx,t,Kx);var y=Math.min(1,(Math.abs(Object(Yl.j)(Kx,this.up))+.5*p+this._curvatureHeight)/Object(Yl.r)(Kx)),g=.1/e.angledSplitBias,O=e.fovY*l*2;if(y*(this._edgeLen/O)<g*e.relativeHeightLimit)return 0}}return 2}},{key:"setChildren",value:function(e,t,r,n){Object(aw.s)(!!(e&&t&&r&&n),"Null child passed"),this._children[0]=e,this._children[1]=t,this._children[2]=r,this._children[3]=n}},{key:"unsetChildren",value:function(){this._children[0]=null,this._children[1]=null,this._children[2]=null,this._children[3]=null}},{key:"load",value:function(e){this.refMapData();var t,r=Object(i.a)(Ps.f);try{for(r.s();!(t=r.n()).done;){var n=t.value;this._createOrUpdateAgents(0,n)}}catch(a){r.e(a)}finally{r.f()}e.loadTile(this)}},{key:"unload",value:function(e){e.unloadTile(this);var t,r=Object(i.a)(Ps.f);try{for(r.s();!(t=r.n()).done;){var n,a=t.value,o=this.layerInfo[a],s=Object(i.a)(o);try{for(s.s();!(n=s.n()).done;){var c=n.value;c.loadingAgent&&c.loadingAgent!==Gx&&(ik(c.loadingAgent),c.loadingAgent=null),c.pendingUpdates=0}}catch(l){s.e(l)}finally{s.f()}}}catch(l){r.e(l)}finally{r.f()}this.resetPendingUpdate(32),this.resetPendingUpdate(64),this.unrefMapData()}},{key:"unloadMapData",value:function(){var e,t=this.layerInfo[1],r=Object(i.a)(t);try{for(r.s();!(e=r.n()).done;){var n=e.value;n.loadingAgent&&n.loadingAgent!==Gx&&(ik(n.loadingAgent),n.loadingAgent=null),n.pendingUpdates=0}}catch(a){r.e(a)}finally{r.f()}this.renderData&&this.renderData.releaseTexture(),this.setMemoryDirty()}},{key:"updateClippingStatus",value:function(e){if(Object(K.n)(e,this._clippingArea))return!1;var t=this._intersectsClippingArea,r=this._isWithinClippingArea;Object(I.j)(e)?(this._intersectsClippingArea=this.intersectsExtent(e),this._isWithinClippingArea=this._isWithinExtent(e)):(this._intersectsClippingArea=!0,this._isWithinClippingArea=!0),this._clippingArea=e,this.updateVisibility();var n=r&&this._isWithinClippingArea,i=!(r||t||this._isWithinClippingArea||this._intersectsClippingArea);return!this.renderData||n||i||this.setPendingUpdate(32),!0}},{key:"updateVisibility",value:function(){this._dirty=!0,this._surface.setTileTreeDirty()}},{key:"getLayerInfo",value:function(e,t){return this.layerInfo[t][e]}},{key:"hasLayerData",value:function(e,t){var r=this.layerInfo[t][e];return!(!r||!r.data||r.dataInvalidated)}},{key:"updating",get:function(){if(this.hasPendingUpdates)return!0;var e,t=Object(i.a)(Ps.f);try{for(t.s();!(e=t.n()).done;){var r,n=e.value,a=this.layerInfo[n],o=Object(i.a)(a);try{for(o.s();!(r=o.n()).done;){var s=r.value;if(s.loadingAgent&&s.loadingAgent!==Gx&&s.loadingAgent.updating)return!0}}catch(c){o.e(c)}finally{o.f()}}}catch(c){t.e(c)}finally{t.f()}return!1}},{key:"isSuspended",value:function(e){return!!this.hasPendingUpdate(2)||0!==e&&!this.loadable}},{key:"hasPendingUpdates",get:function(){return 0!==this._pendingUpdates}},{key:"hasPendingUpdate",value:function(e){return(this._pendingUpdates&e)===e}},{key:"setPendingUpdate",value:function(e){this._pendingUpdates|=e,2===e||8===e?this._surface.setTileTreeDirty():this._surface.requestUpdate()}},{key:"resetPendingUpdate",value:function(e){return!!this.hasPendingUpdate(e)&&(this._pendingUpdates&=~e,!0)}},{key:"requestLayerData",value:function(e,t,r){var n=this.layerInfo[t][e];if(n.waitingAgents.has(r))return console.warn("agent already requested this piece of map data (tile %s, agent tile %s, layer: %d/%d)",this.lij.toString(),r.tile.lij.toString(),t,e),!0;if(n.waitingAgents.push(r),n.data&&!n.dataInvalidated)return console.warn("agent requested existing data (tile %s, agent tile %s, layer: %d/%d)",this.lij.toString(),r.tile.lij.toString(),t,e),r.dataArrived(this),!0;if(n.requestPromise)return!0;Object(I.a)(n.requestAbort),n.requestAbort=Object(q.e)();var i=this._surface.requestTileData(this,e,t,n.requestAbort);if(!i)return n.requestAbort=null,!1;var a=function(){n.requestPromise===i&&(n.requestPromise=null,n.requestAbort=null)};return n.requestPromise=i,i.then(a,a),!0}},{key:"isLeaf",get:function(){return null==this._children[0]}},{key:"hasLij",value:function(e){return this.lij[0]===e[0]&&this.lij[1]===e[1]&&this.lij[2]===e[2]}},{key:"findByLij",value:function(e){return this.hasLij(e)?this:this.isLeaf?null:this._children[0].findByLij(e)||this._children[1].findByLij(e)||this._children[2].findByLij(e)||this._children[3].findByLij(e)||null}},{key:"distanceToSquared",value:function(e){return Object(Yl.v)(Object(Yl.l)(Kx,this._center[1],e))}},{key:"containsPoint",value:function(e){var t=this.extent;return e[0]>=t[0]&&e[1]>=t[1]&&e[0]<=t[2]&&e[1]<=t[3]}},{key:"unrequestLayerData",value:function(e,t,r){var n=this.layerInfo[t][e],i=n.waitingAgents,a=null!=i.removeUnordered(r);Object(aw.s)(a,"agent has not requested this piece of map data"),i.length<1&&(n.abortRequest(),this._updateMemoryUsed())}},{key:"dataArrived",value:function(e,t,r){var n=this,i=this.layerInfo[t][e];i.data=r,i.dataInvalidated=!1,i.waitingAgents.forAll((function(e){return e.dataArrived(n)})),i.waitingAgents.clear(),this._updateMemoryUsed()}},{key:"dataMissing",value:function(e,t,r){r.notInTilemap||console.error("Tile ".concat(this.lij.toString()," layer ").concat(t,"/").concat(e," error ").concat(r));var n=this.layerInfo[t][e];n.dataMissing=!0,n.waitingAgents.forAll((function(e){return e.dataMissing()})),n.waitingAgents.clear(),this._updateMemoryUsed()}},{key:"updateRenderData",value:function(e){switch(e){case 1:return this.updateTexture();case 0:return this.updateGeometry()}}},{key:"updateTexture",value:function(){this.renderData&&this.setPendingUpdate(64)}},{key:"updateGeometry",value:function(){this.setPendingUpdate(32);var e,t=Object(i.a)(this.layerInfo[0]);try{for(t.s();!(e=t.n()).done;){e.value.pendingUpdates|=32}}catch(r){t.e(r)}finally{t.f()}}},{key:"invalidateLayerData",value:function(e,t){this.layerInfo[t][e].invalidateSourceData(),this.restartAgents(t)}},{key:"computeElevationBounds",value:function(){Object(xu.r)(this._elevationBounds,Number.MAX_VALUE,-Number.MAX_VALUE);var e,t=this.layerInfo[0],r=!0,n=Object(i.a)(t);try{for(n.s();!(e=n.n()).done;){var a=e.value;Object(I.j)(a.elevationBounds)&&(this._elevationBounds[0]=Math.min(this._elevationBounds[0],a.elevationBounds.min),this._elevationBounds[1]=Math.max(this._elevationBounds[1],a.elevationBounds.max),a.elevationBounds.hasNoDataValues||(r=!1))}}catch(o){n.e(o)}finally{n.f()}r&&(this._elevationBounds[0]=Math.min(this._elevationBounds[0],0),this._elevationBounds[1]=Math.max(this._elevationBounds[1],0)),this.updateRadiusAndCenter(),this._surface.setTileTreeDirty()}},{key:"_updateCenter",value:function(){var e=.5*(this._elevationBounds[0]+this._elevationBounds[1]);Object(Yl.g)(Kx,this.up,e),Object(Yl.h)(this._center[1],this.centerAtSeaLevel,Kx),Object(Yl.g)(Kx,this.up,this._elevationBounds[0]),Object(Yl.h)(this._center[0],this.centerAtSeaLevel,Kx),Object(Yl.g)(Kx,this.up,this._elevationBounds[1]),Object(Yl.h)(this._center[2],this.centerAtSeaLevel,Kx)}},{key:"findElevationBoundsForLayer",value:function(e,t){var r=this.layerInfo[0][e];if(!(Object(I.j)(r.elevationBounds)&&r.elevationBounds.level>=t)){var n=this._surface.layerViewByIndex(e,0),i=Object(aw.c)(n);if(Object(Vx.e)(this,i,!1)){var a=sk,o=!1;if(r.data){var s=r.data;a.min=s.bounds[0],a.max=s.bounds[1],a.hasNoDataValues=s.hasNoDataValues,a.level=this.lij[0],o=!0}else{for(var c,l,u=0,d=this._parent;d&&(!l||u<Ps.b)&&(u=this.vlevel-d.level,c=l||c,!(!(l=d.layerInfo[0][e].data)&&c&&u>=Ps.b));d=d.parent);(l=l||c)&&(l.computeMinMaxValue(this.lij[0],this.lij[1],this.lij[2],a),a.min!==1/0&&(a.level=l.level,o=!0))}o&&(Object(I.i)(r.elevationBounds)&&(r.elevationBounds=new rx),r.elevationBounds.copyFrom(a))}}}},{key:"modifyLayers",value:function(e,t,r){var n,a=this.layerInfo[r],o=Object(i.a)(a);try{for(o.s();!(n=o.n()).done;){var s=n.value;s.loadingAgent&&s.loadingAgent!==Gx&&(ik(s.loadingAgent),s.loadingAgent=null),s.waitingAgents.clear()}}catch(f){o.e(f)}finally{o.f()}for(var c=0;c<a.length;++c)void 0===e[c]&&a[c].release();var l=Object(zx.a)(Array,Object(xe.a)(a)),u=t.length;a.length=u;for(var d=0;d<u;d++){var h=t[d];a[d]=h>-1?l[h]:Qx.acquire(this._surface.upsampleInfoPool)}this._updateMemoryUsed()}},{key:"restartAgents",value:function(e){this.renderData&&(this._createOrUpdateAgents(0,e),this.updateRenderData(e))}},{key:"updateAgents",value:function(e){if(this.renderData){var t,r=this.layerInfo[e],n=Object(i.a)(r);try{for(n.s();!(t=n.n()).done;){var a=t.value;a.loadingAgent===Gx&&(a.loadingAgent=null)}}catch(o){n.e(o)}finally{n.f()}this._createOrUpdateAgents(0,e)}}},{key:"updateAgentSuspension",value:function(){var e,t=Object(i.a)(Ps.f);try{for(t.s();!(e=t.n()).done;){var r,n=e.value,a=this.isSuspended(n),o=Object(i.a)(this.layerInfo[n]);try{for(o.s();!(r=o.n()).done;){var s=r.value;s.loadingAgent&&s.loadingAgent!==Gx&&(s.loadingAgent.setSuspension(a),s.loadingAgent===Gx&&this.updateRenderData(n))}}catch(c){o.e(c)}finally{o.f()}}}catch(c){t.e(c)}finally{t.f()}}},{key:"removeLayerAgent",value:function(e,t){var r=this.layerInfo[t][e];r.loadingAgent&&r.loadingAgent!==Gx&&r.loadingAgent.dispose(),r.loadingAgent=null}},{key:"agentDone",value:function(e,t){var r=this.layerInfo[t][e];r.loadingAgent=Gx,r.data||r.upsampleInfo||this._createOrUpdateAgents(e+1,t)}},{key:"_createOrUpdateAgents",value:function(e,t){for(var r=this.isSuspended(t),n=this.layerInfo[t],i=e;i<n.length;++i){var a=n[i],o=!1,s=this._surface.layerViewByIndex(i,t),c=Object(aw.c)(s);if(a.loadingAgent?Object(Vx.e)(this,c,!1)?(a.loadingAgent!==Gx&&a.loadingAgent.setSuspension(r),a.loadingAgent!==Gx&&(o=a.loadingAgent.update())):a.dispose():Object(Vx.e)(this,c,!1)&&(a.loadingAgent=nk(this,i,t,r),(o=a.loadingAgent.startLoading())?a.loadingAgent===Gx&&this.setPendingUpdate(32):(ik(a.loadingAgent),a.loadingAgent=Gx)),a.loadingAgent===Gx&&this.updateRenderData(t),o&&s.isOpaque)return}}},{key:"_isWithinExtent",value:function(e){var t=this.extent;return t[0]>=e[0]&&e[2]>=t[2]&&t[1]>=e[1]&&e[3]>=t[3]}},{key:"intersectsExtent",value:function(e){var t=this.extent;return t[2]>=e[0]&&e[2]>=t[0]&&t[3]>=e[1]&&e[3]>=t[1]}},{key:"test",get:function(){return{cachedMemory:this.cachedMemory}}}],[{key:"prune",value:function(){ak.prune(0),ok.prune(0),Qx.prune()}}]),e}();function nk(e,t,r,n){var i=0===r?ok.acquire():ak.acquire();return i.init(e,t,r,n),i}function ik(e){e.dispose(),e instanceof qx?ok.release(e):e instanceof Hx&&ak.release(e)}var ak=new mO.a(Hx),ok=new mO.a(qx),sk=new rx,ck=-1,lk=rk,uk=function(e){Object(f.a)(r,e);var t=Object(p.a)(r);function r(e,n,i){var a;return Object(c.a)(this,r),a=t.call(this,r.NumSubdivisionsAtLevel),void 0!==e&&a.init(e,n,i),a}return Object(l.a)(r,[{key:"init",value:function(e,t,n){Object(d.a)(Object(h.a)(r.prototype),"init",this).call(this,e,t,n),this._edgeLen=this.extent[2]-this.extent[0],this._edgeLen2=this._edgeLen*this._edgeLen,this.centerAtSeaLevel[0]=Object(m.m)(this.extent[0],this.extent[2],.5),this.centerAtSeaLevel[1]=Object(m.m)(this.extent[1],this.extent[3],.5),this.centerAtSeaLevel[2]=0,this.updateRadiusAndCenter()}},{key:"updateRadiusAndCenter",value:function(){this._updateCenter();var e=(this.extent[2]-this.extent[0])*Math.SQRT1_2,t=.5*(this.elevationBounds[0]-this.elevationBounds[1]);this._center[1][3]=Math.sqrt(e*e+t*t)}},{key:"_isVisible",value:function(e){return this.intersectsClippingArea&&Object(yO.f)(e,Object(Eg.H)(this.extent[0],this.extent[1],this.elevationBounds[0],this.extent[2],this.extent[3],this.elevationBounds[1]))}},{key:"createGeometry",value:function(e,t){(function(e,t,r,n){var i=t[0],a=t[1],o=t[2]-i,s=t[3]-a,c=e.clippingArea,l=Object(I.j)(c)?Math.max(0,(c[0]-t[0])/o):0,u=Object(I.j)(c)?Math.max(0,(c[1]-t[1])/s):0,d=Object(I.j)(c)?Math.min(1,(c[2]-t[0])/o):1,h=Object(I.j)(c)?Math.min(1,(c[3]-t[1])/s):1,f=d>l?1/(d-l):1,p=h>u?1/(h-u):1,b=-l*f,v=-u*p,m=.1*o,y=e.numVertsPerRow-1,g=e.numVertsPerRow-1,O=e.numVertsPerRow*e.numVertsPerRow,j=2*y+2*g,_=wx.acquire(O+j),w=_.position.typedBuffer,x=_.uv0.typedBuffer,k=n.geometryInfo.boundingBox;Object(Eg.k)(k);for(var S=0,T=0;T<=g;T++){var C=T/g,M=v+C*p,P=a+C*s;Object(I.j)(c)&&(P<c[1]?(P=c[1],M=0):P>c[3]&&(P=c[3],M=1));for(var A=0;A<=y;A++){var E=A/y,R=b+E*f,D=i+E*o;Object(I.j)(c)&&(D<c[0]?(D=c[0],R=0):D>c[2]&&(D=c[2],R=1));var F=e.samplerData&&nx.sample(D,P,e.samplerData)||0,L=D-r[0],z=P-r[1],V=F-r[2];Cx(L,z,V,k);var N=Ps.e*S;w[N+0]=L,w[N+1]=z,w[N+2]=V,x[N+0]=R,x[N+1]=M;var U=Px(A,T,y,y);if(U>-1){var B=Ps.e*(O+U);w[B+0]=L,w[B+1]=z,w[B+2]=V,x[B+0]=Mx(R,M),x[B+1]=m}++S}}n.geometryInfo.numVertsPerRow=e.numVertsPerRow,n.geometryInfo.vertexAttributes=_,n.geometryInfo.skirtLength=m,Object(Su.l)(n.geometryInfo.uvOffsetAndScale,l,u,d-l,h-u),Tx(n.geometryInfo,e.numVertsPerRow,0,e.wireframe)})(e,this.extent,t,this.renderData),this.setMemoryDirty()}}]),r}(lk);uk.NumSubdivisionsAtLevel=[2,2,2,2,2,2,2,2];var dk=function(e){Object(f.a)(r,e);var t=Object(p.a)(r);function r(e,n,i){var a;Object(c.a)(this,r),(a=t.call(this,hk)).obb=new Array(8),a.isWebMercator=!1;for(var o=0;o<8;o++)a.obb[o]=Object(X.e)();return void 0!==e&&a.init(e,n,i),a}return Object(l.a)(r,[{key:"init",value:function(e,t,n){Object(d.a)(Object(h.a)(r.prototype),"init",this).call(this,e,t,n),this.isWebMercator=n.tilingScheme.spatialReference.isWebMercator;var i=this.ellipsoid.radius,a=this.extentInRadians[0],o=this.extentInRadians[1],s=this.extentInRadians[2],c=this.extentInRadians[3],l=e[0],u=Object(m.m)(o,c,.5),f=Object(m.m)(a,s,.5),p=0===l?0:Math.min(Math.abs(o),Math.abs(c));this._edgeLen=(s-a)*Math.cos(p)*i,this._edgeLen2=this._edgeLen*this._edgeLen,this._curvatureHeight=i-Math.sqrt(i*i-this._edgeLen2/4),Object($.l)(this.centerAtSeaLevel,f,u,this.ellipsoid.radius,0);var b=Object(X.f)(this.centerAtSeaLevel);Object(Yl.t)(b,b),this.up=b,this._updateOBB(),this.updateRadiusAndCenter()}},{key:"updateRadiusAndCenter",value:function(){if(0===this.lij[0])Object(Yl.y)(this._center[1],0,0,0),Object(Yl.y)(this._center[0],0,0,0),Object(Yl.y)(this._center[2],0,0,0),this.ellipsoid||(this.ellipsoid=Object(J.e)(this.surface.tilingScheme.spatialReference)),this._center[1][3]=this.ellipsoid.radius+this.elevationBounds[1];else{this._updateCenter();var e=Math.max(Object(Yl.n)(this._center[1],this.obb[0]),Object(Yl.n)(this._center[1],this.obb[1]));this._center[1][3]=Math.sqrt(e)}}},{key:"_isVisible",value:function(e){if(!this.intersectsClippingArea)return!1;if(this.lij[0]<10)return Object(yO.j)(e,this._center[1]);for(var t=this.obb,r=0;r<6;r++){var n=void 0,i=e[r];for(4===r&&(i=Object(Rp.c)(i,fk),fk[3]-=this.surface.view.state.camera.near),n=0;n<8&&!Object(Rp.p)(i,t[n]);n++);if(8===n)return!1}return!0}},{key:"computeElevationBounds",value:function(){Object(d.a)(Object(h.a)(r.prototype),"computeElevationBounds",this).call(this),this._updateOBB()}},{key:"createGeometry",value:function(e,t){var r=this._isPole(this.lij[1],this.lij[0]);(function(e,t,r,n,i,a,o,s){var c=i[0],l=i[1],u=i[2],d=i[3],h=.1*o.radius*(d-l),f=e.numVertsPerRow-1,p=e.numVertsPerRow-1,b=e.numVertsPerRow*e.numVertsPerRow,v=2*f+2*p,y=wx.acquire(b+v),g=y.position.typedBuffer,O=y.uv0.typedBuffer,j=n.geometryInfo.boundingBox;Object(Eg.k)(j);for(var _=t[2]-t[0],w=t[3]-t[1],x=u-c,k=r[0],S=r[1],T=r[2],C=0;C<=f;C++){var M=C/f,P=c+M*x;Ex[C]=Math.sin(P),Rx[C]=Math.cos(P),Ix[C]=M,Dx[C]=t[0]+M*_}for(var A=a&&!!(1&s),E=a&&!!(2&s),R=0,I=0;I<=p;I++){var D=I/p,F=Object(m.m)(l,d,D),L=Math.cos(F),z=Math.sin(F),V=void 0;a?D=((V=o.halfSemiMajorAxis*Math.log((1+z)/(1-z)))-t[1])/w:V=180*F/Math.PI;for(var N=0;N<=f;N++){var U=Ix[N],B=Ex[N],G=Rx[N],q=o.radius;e.samplerData&&(q+=nx.sample(Dx[N],V,e.samplerData)||0);var H=G*L*q-k,W=B*L*q-S,Q=z*q-T;Cx(H,W,Q,j);var Z=Ps.e*R;g[Z+0]=H,g[Z+1]=W,g[Z+2]=Q,O[Z+0]=U,O[Z+1]=D;var X=Px(N,I,f,p);if(X>-1){var Y=Ps.e*(b+X),$=A&&0===I?-1:E&&I===p?1:0,J=0===$?H:-k,K=0===$?W:-S,ee=0===$?Q:o.radius*$-T;g[Y+0]=J,g[Y+1]=K,g[Y+2]=ee,O[Y+0]=0===$?Mx(U,D):U,O[Y+1]=0===$?h:D,0!==$&&Cx(J,K,ee,j)}++R}}n.geometryInfo.numVertsPerRow=e.numVertsPerRow,n.geometryInfo.vertexAttributes=y,n.geometryInfo.skirtLength=h,Object(Su.l)(n.geometryInfo.uvOffsetAndScale,0,0,1,1),Tx(n.geometryInfo,e.numVertsPerRow,a?s:0,e.wireframe)})(e,this.extent,t,this.renderData,this.extentInRadians,this.isWebMercator,this.ellipsoid,r),this.setMemoryDirty()}},{key:"_updateOBB",value:function(){for(var e=this.extentInRadians,t=this.obb,r=0;r<2;r++){var n=this.elevationBounds[r],i=4*r;Object($.l)(t[i++],e[0],e[1],this.ellipsoid.radius,n),Object($.l)(t[i++],e[0],e[3],this.ellipsoid.radius,n),Object($.l)(t[i++],e[2],e[3],this.ellipsoid.radius,n),Object($.l)(t[i++],e[2],e[1],this.ellipsoid.radius,n)}if(this.isWebMercator){var a=this._isPole(this.lij[1],this.lij[0]);2===a?(Object(Yl.y)(t[1],0,0,this.ellipsoid.radius),Object(Yl.y)(t[2],0,0,this.ellipsoid.radius),Object(Yl.y)(t[5],0,0,this.ellipsoid.radius),Object(Yl.y)(t[6],0,0,this.ellipsoid.radius)):1===a&&(Object(Yl.y)(t[0],0,0,-this.ellipsoid.radius),Object(Yl.y)(t[3],0,0,-this.ellipsoid.radius),Object(Yl.y)(t[4],0,0,-this.ellipsoid.radius),Object(Yl.y)(t[7],0,0,-this.ellipsoid.radius))}}},{key:"_isPole",value:function(e,t){var r=0;return e===(1<<t)-1&&(r+=1),0===e&&(r+=2),r}}]),r}(lk),hk=[128,64,32,16,16,8,8,4],fk=Object(Rp.d)(),pk=function(e){Object(f.a)(r,e);var t=Object(p.a)(r);function r(e){var n;return Object(c.a)(this,r),(n=t.call(this,e))._handles=new oe.a,n}return Object(l.a)(r,[{key:"initialize",value:function(){var e=this;this._handles.add([this.layerViews.on("change",(function(){return e.notifyChange("stencilEnabledExtents")}))])}},{key:"destroy",value:function(){this._handles.destroy(),this._handles=null}},{key:"layerViewsExtent",get:function(){return this._computeLayerViewsExtent()}},{key:"tiledLayersExtent",get:function(){return this._computeTiledLayersExtent()}},{key:"stencilEnabledExtents",get:function(){return this._computeStencilEnabledExtents()}},{key:"spatialReference",set:function(e){this.tilingScheme||this._set("spatialReference",e)}},{key:"tilingScheme",set:function(e){this._set("tilingScheme",e),this._set("spatialReference",e.spatialReference)}},{key:"_computeStencilEnabledExtents",value:function(){var e=this,t=[];return this.layerViews.forEach((function(r){var n=r.layer;if("IntegratedMeshLayer"===n.operationalLayerType&&null!=e.spatialReference){var i=mk(n.fullExtent,e.spatialReference);null!=i&&t.push(Object(K.r)(i))}})),t}}]),r}(de.a);Object(b.a)([Object(y.b)({readOnly:!0,dependsOn:[]})],pk.prototype,"layerViewsExtent",null),Object(b.a)([Object(y.b)({readOnly:!0,dependsOn:["spatialReference","tilingScheme"]})],pk.prototype,"tiledLayersExtent",null),Object(b.a)([Object(y.b)({readOnly:!0,dependsOn:["spatialReference"]})],pk.prototype,"stencilEnabledExtents",null),Object(b.a)([Object(y.b)()],pk.prototype,"spatialReference",null),Object(b.a)([Object(y.b)()],pk.prototype,"tilingScheme",null),Object(b.a)([Object(y.b)()],pk.prototype,"defaultTiledLayersExtent",void 0),Object(b.a)([Object(y.b)({constructOnly:!0})],pk.prototype,"layers",void 0),Object(b.a)([Object(y.b)({constructOnly:!0})],pk.prototype,"layerViews",void 0);var bk=function(e){Object(f.a)(r,e);var t=Object(p.a)(r);function r(){return Object(c.a)(this,r),t.apply(this,arguments)}return Object(l.a)(r,[{key:"_computeLayerViewsExtent",value:function(){return this._getGlobalExtent()}},{key:"_computeTiledLayersExtent",value:function(){return this._getGlobalExtent()}},{key:"_getGlobalExtent",value:function(){return this.spatialReference.isWebMercator?Ps.m:Ps.d}}]),r}(pk=Object(b.a)([Object(w.a)("esri.views.3d.terrain.SurfaceExtentHelperBase")],pk));Object(b.a)([Object(y.b)({dependsOn:["spatialReference"]})],bk.prototype,"layerViewsExtent",void 0),bk=Object(b.a)([Object(w.a)("esri.views.3d.terrain.SurfaceExtentHelperGlobal")],bk);var vk=function(e){Object(f.a)(r,e);var t=Object(p.a)(r);function r(){return Object(c.a)(this,r),t.apply(this,arguments)}return Object(l.a)(r,[{key:"initialize",value:function(){var e=this;this._handles.add([this.layers.on("change",(function(t){return e._handleLayersChanged(t)})),this.layerViews.on("change",(function(){return e.notifyChange("layerViewsExtent")}))])}},{key:"_handleLayersChanged",value:function(e){var t,r=this,n=Object(i.a)(e.removed);try{for(n.s();!(t=n.n()).done;){var a=t.value;this._handles.remove(a.uid)}}catch(l){n.e(l)}finally{n.f()}var o,s=Object(i.a)(e.added);try{for(s.s();!(o=s.n()).done;){var c=o.value;this._handles.add(Object(W.a)(c,"loaded",(function(){return r.notifyChange("tiledLayersExtent")})),c.uid)}}catch(l){s.e(l)}finally{s.f()}}},{key:"_computeLayerViewsExtent",value:function(){var e=Object(K.m)(),t=this.spatialReference;this.layerViews.forEach((function(r){var n=r.layer;if(r.isResolved()&&("graphics"!==n.type||!n.internal)){var i=mk("fullExtentInLocalViewSpatialReference"in r&&r.fullExtentInLocalViewSpatialReference||r.layer.fullExtent,t);i&&Object(K.o)(e,i)}}));var r=Object(K.c)(e)?e:null,n=this._get("layerViewsExtent");return Object(K.n)(r,n)?n:r}},{key:"_computeTiledLayersExtent",value:function(){var e=this.tilingScheme;if(!e)return null;var t=this.spatialReference,r=Object(K.m)();this.layers.forEach((function(n){if(n.loaded&&Object(ne.c)(n)){var i=Object(aw.d)(n,t,2),a=i.tileInfo,o=i.fullExtent;(a&&Object(aw.h)(n)&&o||a&&e.compatibleWith(a)&&o&&o.spatialReference.equals(t))&&Object(K.o)(r,o)}})),this.defaultTiledLayersExtent&&Object(K.o)(r,this.defaultTiledLayersExtent);var n=Object(K.c)(r)?r:null,i=this._get("tiledLayersExtent");return Object(K.n)(n,i)?i:n}}]),r}(pk);function mk(e,t){return e&&!e.spatialReference.equals(t)&&(e=Object(re.a)(e.spatialReference,t)?Object(re.d)(e,t):null),e}vk=Object(b.a)([Object(w.a)("esri.views.3d.terrain.SurfaceExtentHelperLocal")],vk);var yk=r(205),gk=function(e){Object(f.a)(r,e);var t=Object(p.a)(r);function r(e){var n;return Object(c.a)(this,r),(n=t.call(this,e))._handles=new oe.a,n}return Object(l.a)(r,[{key:"initialize",value:function(){var e=this;this._handles.add(this.layers.on("change",(function(){return e._update()}))),this._handles.add(this.extentHelper.watch("layerViewsExtent",(function(){return e._setAdHocTilingScheme()}))),this._update(),this.tilingSchemeLocked||this._setAdHocTilingScheme()}},{key:"destroy",value:function(){this._handles.destroy(),this._handles=null,this._waitTask=null}},{key:"_update",value:function(){var e,t=this;if(this._waitTask=null,!this.tilingSchemeLocked)if(this._set("tilingSchemeDone",!1),this.layers.some((function(r){return!(!Object(ne.c)(r)||r.isRejected())&&!(r.isFulfilled()&&!function(e,t,r){return!!Object(aw.d)(e,t,r).tileInfo}(r,t.viewSpatialReference,t.viewingMode))&&(e=r,!Object(aw.m)(r)&&!Object(aw.h)(r))})),e)if(e.isResolved()){var r=e,n=Object(aw.d)(r,this.viewSpatialReference,this.viewingMode).tileInfo,i=new yk.a(n);this._set("tilingSchemeDone",!0),this._lockTilingScheme(i)}else this._updateWhen(e);else this._set("tilingSchemeDone",!0)}},{key:"_updateWhen",value:function(e){var t=this,r=e.when().catch((function(e){return e})).then((function(){r!==t._waitTask||t.destroyed||t._update()}));this._waitTask=r}},{key:"_lockTilingScheme",value:function(e){var t=this;if(1===this.viewingMode){var r=e.levels.length-1;e.spatialReference.isWebMercator?e=yk.a.makeWebMercatorAuxiliarySphere(r):Object($.a)(e.spatialReference)&&(e=yk.a.makeGCSWithTileSize(e.spatialReference,e.pixelSize,r))}this.tilingSchemeLocked=!0,this.tilingScheme=e,this.extentHelper.tilingScheme=this.tilingScheme,this._updateTiledLayerExtent(),this._handles.removeAll(),this._handles.add(this.extentHelper.watch("tiledLayersExtent",(function(){return t._updateTiledLayerExtent()})))}},{key:"_updateTiledLayerExtent",value:function(){this.extent=this.extentHelper.tiledLayersExtent}},{key:"_setAdHocTilingScheme",value:function(){if(1===this.viewingMode){var e=this.extentHelper.spatialReference,t=Object($.a)(e)||Object(qs.h)(e)||Object(qs.i)(e);e.isWebMercator?this.tilingScheme=yk.a.WebMercatorAuxiliarySphere:t&&(this.tilingScheme=yk.a.makeGCSWithTileSize(e,256)),this.extent=this.extentHelper.layerViewsExtent}else{var r=this.extentHelper.layerViewsExtent;r&&(this.tilingScheme=yk.a.fromExtent(r,this.extentHelper.spatialReference),this.extent=r)}}}]),r}(de.a);Object(b.a)([Object(y.b)()],gk.prototype,"tilingScheme",void 0),Object(b.a)([Object(y.b)()],gk.prototype,"extent",void 0),Object(b.a)([Object(y.b)({value:!1})],gk.prototype,"tilingSchemeLocked",void 0),Object(b.a)([Object(y.b)({readOnly:!0,value:!1})],gk.prototype,"tilingSchemeDone",void 0),Object(b.a)([Object(y.b)({constructOnly:!0})],gk.prototype,"viewSpatialReference",void 0),Object(b.a)([Object(y.b)({constructOnly:!0})],gk.prototype,"layers",void 0),Object(b.a)([Object(y.b)({constructOnly:!0})],gk.prototype,"extentHelper",void 0),Object(b.a)([Object(y.b)({constructOnly:!0})],gk.prototype,"viewingMode",void 0),gk=Object(b.a)([Object(w.a)("esri.views.3d.terrain.SurfaceTilingSchemeLogic")],gk);var Ok=r(32),jk=function(){function e(t){Object(c.a)(this,e),this._getFadeDuration=t,this._fadeStart=0,this._delayedTime=0}return Object(l.a)(e,[{key:"clear",value:function(){this._current=Object(I.e)(this._current),this._next=Object(I.e)(this._next),this._waiting=Object(I.e)(this._waiting),this._delayed=Object(I.e)(this._delayed)}},{key:"current",get:function(){if(Object(I.i)(this._current))return null;if(!this._isFading){var e=this._delayed||this._waiting||this._next||this._current;e!==this._current&&(this._current=null,this.clear(),this._current=e)}var t=0;if(Object(I.j)(this._delayed)&&((t=performance.now())>=this._delayedTime&&(this._push(this._delayed,0),this._delayed=null)),Object(I.j)(this._next)){t=t||performance.now();var r=this._fadeDuration;t-this._fadeStart>=r&&(Object(I.e)(this._current),this._current=this._next,this._next=this._waiting,this._waiting=null,this._fadeStart=this._alignFadeStart(t))}return this._current}},{key:"next",get:function(){return this._next}},{key:"fadeFactor",get:function(){if(Object(I.i)(this._next))return 1;var e=Math.max(0,performance.now()-this._fadeStart),t=this._fadeDuration;return e>t?0:1-e/t}},{key:"isFading",get:function(){return Object(I.j)(this._next)||Object(I.j)(this._delayed)}},{key:"push",value:function(e,t,r,n){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;this._delayed=Object(I.e)(this._delayed);var a=Object(I.j)(e)?new _k(e,t,r,n):null;this._push(a,i)}},{key:"_push",value:function(e,t){if(this._isFading||this.clear(),!Object(I.i)(this._current)){var r=performance.now();return 0!==t?(this._delayed=e,void(this._delayedTime=r+t)):Object(I.i)(this._next)?(this._next=e,void(this._fadeStart=this._alignFadeStart(r))):void(Object(I.i)(e)||(Object(I.e)(this._waiting),this._waiting=e))}this._current=e}},{key:"_fadeDuration",get:function(){return Object(I.i)(this._waiting)?this._getFadeDuration():.5*this._getFadeDuration()}},{key:"_alignFadeStart",value:function(e){var t=this._getFadeDuration();return e+t-e%t}},{key:"_isFading",get:function(){return this._getFadeDuration()>0}}]),e}(),_k=function(){function e(t,r,n,i){Object(c.a)(this,e),this.texture=t,t.retain(),this.offsetAndScale=Object($l.g)(r,n,i,i)}return Object(l.a)(e,[{key:"destroy",value:function(){this.texture.release()}}]),e}(),wk=jk,xk=function(){function e(){Object(c.a)(this,e),this._scales=[-1,-1,-1,-1],this._offsets=[-1,-1,-1,-1]}return Object(l.a)(e,[{key:"clear",value:function(){this._scales[0]=this._scales[1]=this._scales[2]=this._scales[3]=-1,this._offsets[0]=this._offsets[1]=this._offsets[2]=this._offsets[3]=-1}},{key:"setScale",value:function(e,t,r){this._scales[2*e]=t,this._scales[2*e+1]=r}},{key:"setOffset",value:function(e,t,r){this._offsets[2*e]=t,this._offsets[2*e+1]=r}},{key:"scales",get:function(){return this._scales}},{key:"offsets",get:function(){return this._offsets}}]),e}(),kk=function(){function e(){var t=this;Object(c.a)(this,e),this.geometryInfo=new xx,this._textureRef=new wk((function(){return t.tile.surface.textureFadeDuration})),this.overlay=new xk}return Object(l.a)(e,[{key:"init",value:function(e){this.tile=e,this.clear();var t=this.geometryInfo;t.indices=null,t.vertexAttributes=null,Object(Eg.k)(t.boundingBox),t.numSurfaceIndices=0,t.numSkirtIndices=0,t.numWithoutSkirtIndices=0,t.numVertsPerRow=0,this.geometryState={numVertsPerRow:0,samplerData:null,clippingArea:null,wireframe:!1},this.opacity=1,this.localOrigin=null,this.overlay.clear()}},{key:"clear",value:function(){this.releaseGeometry(),this.releaseTexture(),this._textureRef.clear()}},{key:"updateGeometry",value:function(e,t){return!!this._updateGeometryState(t)&&(this._releaseGeometry(),this._createGeometry(e),!0)}},{key:"releaseGeometry",value:function(){return!!this._releaseGeometry()&&(this.geometryState={numVertsPerRow:0,samplerData:null,clippingArea:null,wireframe:!1},!0)}},{key:"ensureTexture",value:function(e,t){return Object(I.j)(this._texture)&&this._texture.descriptor.width!==e&&this.releaseTexture(),Object(I.i)(this._texture)&&(this._texture=t(),this.tile.setMemoryDirty()),this._texture}},{key:"releaseTexture",value:function(){Object(I.j)(this._texture)&&(this._texture.release(),this._texture=null,this.tile.setMemoryDirty())}},{key:"_updateGeometryState",value:function(e){var t=this._getElevationInfo(),r=this.tile.level,n=r<8?this.tile.numSubdivisionsAtLevel[r]+1:2;if(t.samplerData){var i=this.tile.vlevel-r,a=Math.max(r-t.maxTileLevel,Ps.b-i),o=this.tile.maxTesselation;n=Object(m.e)(1+(o>>a),2,o+1)}var s=this.tile.clippingArea;this.tile.intersectsClippingArea&&!this.tile.isWithinClippingArea||(s=null);var c=this.geometryState,l=!1;return c.numVertsPerRow!==n&&(c.numVertsPerRow=n,l=!0),t.changed&&(c.samplerData=t.samplerData,l=!0),Object(Fs.e)(c.clippingArea,s)||(c.clippingArea=s,l=!0),c.wireframe!==e&&(c.wireframe=e,l=!0),l}},{key:"_createGeometry",value:function(e){this.tile.createGeometry(this.geometryState,this.localOrigin);var t=this.geometryInfo.vertexAttributes,r=this.geometryInfo.indices,n=e.gl;this._vao=new yu.a(e,au.a,{geometry:Object(du.a)(t.layout)},{geometry:bu.a.createVertex(e,n.STATIC_DRAW,t.buffer)},bu.a.createIndex(e,n.STATIC_DRAW,r))}},{key:"_releaseGeometry",value:function(){return!!this._vao&&(this._vao.dispose(),this._vao=null,function(e){wx.release(e.vertexAttributes),e.vertexAttributes=null,e.indices=null}(this.geometryInfo),!0)}},{key:"vao",get:function(){return this._vao}},{key:"setTextureReference",value:function(e,t,r,n){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;e!==this._texture&&this.releaseTexture(),this._textureRef.push(e,t,r,n,i)}},{key:"textureReference",get:function(){return this._textureRef.current}},{key:"nextTextureReference",get:function(){return this._textureRef.next}},{key:"textureFadeFactor",get:function(){return this._textureRef.fadeFactor}},{key:"textureIsFading",get:function(){return this._textureRef.isFading}},{key:"_getElevationInfo",value:function(){for(var e=this.geometryState.samplerData,t=this.tile.layerInfo[0],r=t.length,n=new Array(r),i=0,a=0,o=!1,s=0;s<r;s++){var c=t[s];if(c.upsampleInfo){var l=c.upsampleInfo.tile,u=l.layerInfo[0][s].data,d=u&&u.samplerData;e&&e[i]===d||(o=!0),n[i++]=d,a=Math.max(a,l.lij[0])}else if(c.data){var h=this.tile.surface.layerViewByIndex(s,0);if(Object(Vx.e)(this.tile,h.layer,!1)){var f=c.data;e&&e[i]===f.samplerData||(o=!0),n[i++]=f.samplerData,a=this.tile.lij[0]}}}return e&&e.length!==i&&(o=!0),i>0?n.length=i:n=null,{changed:o,samplerData:n,maxTileLevel:a}}},{key:"estimatedGeometryMemoryUsage",get:function(){return this.geometryInfo.indices.byteLength+this.geometryInfo.vertexAttributes.byteLength}},{key:"textureDescriptor",get:function(){return Object(I.j)(this._texture)?this._texture.descriptor:null}},{key:"test",get:function(){return{hasTexture:null!=this._texture}}}]),e}(),Sk=r(107),Tk=(r(122),r(159)),Ck=(r(239),r(63)),Mk=r(174),Pk=r(592);function Ak(){return[1,0,0,1,0,0]}Object.freeze({__proto__:null,create:Ak,clone:function(e){return[e[0],e[1],e[2],e[3],e[4],e[5]]},fromValues:function(e,t,r,n,i,a){return[e,t,r,n,i,a]},createView:function(e,t){return new Float64Array(e,t,6)}});var Ek=r(224),Rk=r(244);function Ik(e){return(t=e)instanceof Float32Array&&t.length>=2||function(e){return Array.isArray(e)&&e.length>=2}(e);var t}var Dk=39.37,Fk=180/Math.PI;function Lk(e,t,r,n){return n&&r&&!n.equals(r)&&Object(re.a)(n,r)&&n.isWebMercator?n.isWebMercator?function(e,t){var r=t[1];return r>89.99999?r=89.99999:r<-89.99999&&(r=-89.99999),r=Math.sin(Object(Ck.d)(r)),Object(xu.r)(e,Object(Ck.d)(t[0])*nl.a.radius,.5*nl.a.radius*Math.log((1+r)/(1-r)))}(e,t):function(e,t,r){var n=Object(Ck.c)(t[0]/nl.a.radius);return Object(xu.r)(e,r?n:n-360*Math.floor((n+180)/360),Object(Ck.c)(.5*Math.PI-2*Math.atan(Math.exp(-1*t[1]/nl.a.radius))))}(e,t):Object(xu.c)(e,t)}function zk(e){return e.wkid?e:e.spatialReference||Gs.a.WGS84}function Vk(e,t){return t.type?Object(xu.r)(e,t.x,t.y):Object(xu.c)(e,t)}function Nk(e){return Object(ij.f)(e)}function Uk(e,t){var r=e.targetGeometry,n=t.targetGeometry;return r.x=n.x,r.y=n.y,r.spatialReference=n.spatialReference,e.scale=t.scale,e.rotation=t.rotation,e}var Bk=function(){var e=Object(ku.b)();return function(t,r,n){var i=r.targetGeometry;Vk(e,i);var a=.5*Hk(r);return t.xmin=e[0]-a*n[0],t.ymin=e[1]-a*n[1],t.xmax=e[0]+a*n[0],t.ymax=e[1]+a*n[1],t.spatialReference=i.spatialReference,t}}();var Gk=function(){var e=Object(ku.b)();return function(t,r,n){return Object(xu.e)(t,function(e,t){return Object(xu.b)(e,t,.5)}(t,r),function(e,t,r){return r?Object(xu.r)(e,.5*(t[0]-r.right+r.left),.5*(t[1]-r.bottom+r.top)):Object(xu.b)(e,t,.5)}(e,r,n))}}(),qk=function(){var e=[1,0,0,1,0,0],t=Object(ku.b)();return function(r,n,i,a){var o=Hk(n),s=Wk(n);return Object(xu.r)(t,o,o),Object(Mk.c)(e,t),Object(Mk.f)(e,e,s),Object(Mk.h)(e,e,Gk(t,i,a)),Object(Mk.h)(e,e,[0,a.top-a.bottom]),Object(xu.r)(r,e[4],e[5])}}();function Hk(e){return e.scale*function(e){return Object(I.j)(e)&&Object(qs.j)(e.spatialReference)?1/(Nk(e.spatialReference)*Dk*96):1}(e.targetGeometry)}function Wk(e){return Object(Ck.d)(e.rotation)||0}var Qk=function(){var e=Object(ku.b)(),t=Object(ku.b)(),r=Object(ku.b)();return function(n,i,a,o,s,c){return Object(xu.n)(e,i),Object(xu.b)(t,a,.5*c),Object(xu.r)(r,1/o*c,-1/o*c),Object(Mk.d)(n),Object(Mk.h)(n,n,t),s&&Object(Mk.f)(n,n,s),Object(Mk.g)(n,n,r),Object(Mk.h)(n,n,e),n}}(),Zk=function(){var e=Object(ku.b)();return function(t,r,n,i){var a=Hk(r),o=Wk(r);return Vk(e,r.targetGeometry),Qk(t,e,n,a,o,i)}}(),Xk=function(){var e=Object(ku.b)();return function(t,r,n,i){var a=Hk(r);return Vk(e,r.targetGeometry),Qk(t,e,n,a,0,i)}}();function Yk(e,t){return Math.round(function(e){if(e.isWrappable){var t=Object(qs.d)(e);return t.valid[1]-t.valid[0]}return 0}(e)/t)}(function(){var e=Object(ku.b)(),t=Object(ku.b)(),r=[0,0,0]})(),function(){var e=Object(ku.b)()}(),function(){var e=Object(ku.b)()}(),function(){var e=Object(ku.b)()}();!function(){var e=Object(ku.b)()}();var $k=function(){var e=Object(ku.b)();return function(t,r,n,i,a){return Uk(t,r),isNaN(n)||0===n||(eS(e,i,r,a),t.scale=r.scale*n,tS(e,e,t,a),rS(t,t,Object(xu.r)(e,e[0]-i[0],i[1]-e[1]))),t}}();var Jk,Kk=function(){var e=Object(ku.b)();return function(t,r,n,i,a,o){return Uk(t,r),isNaN(n)||0===n||(eS(e,a,r,o),t.scale=r.scale*n,t.rotation+=i,tS(e,e,t,o),rS(t,t,Object(xu.r)(e,e[0]-a[0],a[1]-e[1]))),t}}(),eS=(function(){var e=Object(ku.b)(),t=Object(ku.b)()}(),function(){var e=[1,0,0,1,0,0];return function(t,r,n,i){return Object(xu.s)(t,r,function(e,t,r,n){return Zk(e,t,r,n),Object(Mk.a)(e,e)}(e,n,i,1))}}()),tS=function(){var e=[1,0,0,1,0,0];return function(t,r,n,i){return Object(xu.s)(t,r,Zk(e,n,i,1))}}(),rS=function(){var e=Object(ku.b)(),t=[1,0,0,1,0,0];return function(r,n,i){Uk(r,n);var a=Hk(n),o=r.targetGeometry;return Object(Mk.b)(t,Wk(n)),Object(Mk.g)(t,t,Object(ku.f)(a,a)),Object(xu.s)(e,i,t),o.x+=e[0],o.y+=e[1],r}}(),nS=[0,0],iS=Jk=function(e){Object(f.a)(r,e);var t=Object(p.a)(r);function r(e){var n;return Object(c.a)(this,r),(n=t.call(this,e))._viewpoint2D={center:Object(ku.b)(),rotation:0,scale:0,spatialReference:null},n.center=[0,0],n.extent=new Bs.a,n.id=0,n.inverseTransform=[1,0,0,1,0,0],n.resolution=0,n.rotation=0,n.scale=0,n.transform=[1,0,0,1,0,0],n.transformNoRotation=[1,0,0,1,0,0],n.displayMat3=Object(Ek.b)(),n.displayViewMat3=Object(Ek.b)(),n.viewMat3=Object(Ek.b)(),n.viewMat2d=Object(Pk.a)(),n.worldScreenWidth=0,n.size=[0,0],n}return Object(l.a)(r,[{key:"pixelRatio",set:function(e){this._set("pixelRatio",e),this._update()}},{key:"size",set:function(e){this._set("size",e),this._update()}},{key:"viewpoint",set:function(e){if(e){var t=this._viewpoint2D,r=e.targetGeometry;t.center[0]=r.x,t.center[1]=r.y,t.rotation=e.rotation,t.scale=e.scale,t.spatialReference=r.spatialReference}this._update()}},{key:"copy",value:function(e){var t=this.size,r=this.viewpoint;return r&&t?(this.viewpoint=Uk(r,e.viewpoint),this._set("size",Object(xu.c)(t,e.size))):(this.viewpoint=e.viewpoint.clone(),this._set("size",[e.size[0],e.size[1]])),this._set("pixelRatio",e.pixelRatio),this}},{key:"clone",value:function(){return new Jk({size:this.size,viewpoint:this.viewpoint.clone(),pixelRatio:this.pixelRatio})}},{key:"toMap",value:function(e,t,r){return Ik(t)?Object(xu.s)(e,t,this.inverseTransform):(nS[0]=t,nS[1]=r,Object(xu.s)(e,nS,this.inverseTransform))}},{key:"toScreen",value:function(e,t,r){return Ik(t)?Object(xu.s)(e,t,this.transform):(nS[0]=t,nS[1]=r,Object(xu.s)(e,nS,this.transform))}},{key:"toScreenNoRotation",value:function(e,t,r){return Ik(t)?Object(xu.s)(e,t,this.transformNoRotation):(nS[0]=t,nS[1]=r,Object(xu.s)(e,nS,this.transformNoRotation))}},{key:"getScreenTransform",value:function(e,t){var r=this._viewpoint2D.center,n=this._get("pixelRatio")||1,i=this._get("size");return Qk(e,r,i,t,0,n),e}},{key:"_update",value:function(){var e=this._viewpoint2D,t=e.center,r=e.spatialReference,n=e.scale,i=e.rotation,a=this._get("pixelRatio")||1,o=this._get("size"),s=new z({targetGeometry:new S.a(t[0],t[1],r),scale:n,rotation:i});if(this._set("viewpoint",s),o&&r&&n){this.resolution=Hk(s),this.rotation=i,this.scale=n,this.spatialReference=r,Object(xu.c)(this.center,t);var c=0!==o[0]?2/o[0]:0,l=0!==o[1]?-2/o[1]:0;Object(Tf.m)(this.displayMat3,c,0,0,0,l,0,-1,1,1);var u=Object(Tf.b)(this.viewMat3),d=Object(Rk.b)(o[0]/2,o[1]/2),h=Object(Rk.b)(-o[0]/2,-o[1]/2),f=Object(Ck.d)(i);Object(Tf.c)(u,u,d),Object(Tf.l)(u,u,f),Object(Tf.c)(u,u,h),Object(Tf.j)(this.displayViewMat3,this.displayMat3,u);var p=Object(Mk.d)(this.viewMat2d);return Object(Mk.h)(p,p,d),Object(Mk.f)(p,p,f),Object(Mk.h)(p,p,h),Bk(this.extent,s,o),Zk(this.transform,s,o,a),Object(Mk.a)(this.inverseTransform,this.transform),Xk(this.transformNoRotation,s,o,a),this.worldScreenWidth=Yk(this.spatialReference,this.resolution),this._set("id",this.id+1),this}}}]),r}(v.a);Object(b.a)([Object(y.b)({readOnly:!0})],iS.prototype,"id",void 0),Object(b.a)([Object(y.b)({value:1,json:{write:!0}})],iS.prototype,"pixelRatio",null),Object(b.a)([Object(y.b)({json:{write:!0}})],iS.prototype,"size",null),Object(b.a)([Object(y.b)({type:z,json:{write:!0}})],iS.prototype,"viewpoint",null);var aS=iS=Jk=Object(b.a)([Object(w.a)("esri.views.2d.ViewState")],iS),oS=function(){function e(){Object(c.a)(this,e),this._renderParams={context:null,drawPhase:1,state:new aS({viewpoint:new z({targetGeometry:new S.a(0,0),scale:1,rotation:0}),size:[256,256]}),stationary:!0,pixelRatio:1,displayLevel:-1,requiredLevel:-1,globalOpacity:1,renderPass:"background",styleLayer:null,styleLayerUID:-1,painter:null,glyphMosaic:null,spriteMosaic:null,driverTestResult:null,profiler:null,renderingOptions:null,deltaTime:-1,timeline:null,time:0,hasClipping:!1,blendMode:null,dataUploadCounter:0,effects:null,inFadeTransition:!1,requireFBO:!1}}return Object(l.a)(e,[{key:"dispose",value:function(){this._renderParams=null}},{key:"render",value:function(e,t,r,n,i,a,o,s,c,l){var u=a.adjustLevel(t[0]),d=this._renderParams;d.context=e,d.painter=n,d.glyphMosaic=n.glyphMosaic,d.spriteMosaic=n.spriteMosaic,d.pixelRatio=l,d.displayLevel=u,d.requiredLevel=u;var h=a.getScale(t[0]),f=a.getShift(t,o*h),p=Object(ue.a)(f,2),b=p[0],v=p[1],m=.125*o*h/c,y=r.transforms.dvs;y[0]=m,y[4]=-m,y[6]=-1-b-s[0]*o*2,y[7]=1+v+(1-s[1])*o*2-2,d.state.size[0]=c,d.state.size[1]=c,r.stage||r.attachWithContext(e),r.triangleCount=0,n.drawTile(d,r,i)}}]),e}(),sS=r(624),cS=function(e){Object(f.a)(r,e);var t=Object(p.a)(r);function r(){return Object(c.a)(this,r),t.apply(this,arguments)}return Object(l.a)(r,[{key:"initializeProgram",value:function(e){var t=r.shader.get().build();return new ou.a(e.rctx,t,au.a)}},{key:"initializePipeline",value:function(){var e=2===this.configuration.mode?Object(su.i)(1,771):1===this.configuration.mode?Object(su.i)(0,770):null;return Object(su.g)({blending:e,colorWrite:su.d})}}]),r}(nu.a);cS.shader=new ru.a(sS.a,(function(){return r.e(190).then(r.bind(null,1071))}));var lS=function(e){Object(f.a)(r,e);var t=Object(p.a)(r);function r(){var e;return Object(c.a)(this,r),(e=t.apply(this,arguments)).mode=0,e}return r}(iu.a);Object(b.a)([Object(iu.b)({count:3})],lS.prototype,"mode",void 0);var uS=r(625),dS=r(187),hS=function(e){Object(f.a)(r,e);var t=Object(p.a)(r);function r(){return Object(c.a)(this,r),t.apply(this,arguments)}return Object(l.a)(r,[{key:"uniformLocationInfos",get:function(){return this._uniformLocationInfos||(this._uniformLocationInfos=Object(dS.i)(this._context,this.program)),this._uniformLocationInfos}},{key:"initializeProgram",value:function(e){var t=r.shader.get(),n=this.configuration,i=t.build({output:n.colorizerType,applyColormap:n.applyColormap});return this._context=e.rctx,new ou.a(e.rctx,i,au.a)}},{key:"initializePipeline",value:function(){var e=2===this.configuration.mode?Object(su.i)(1,771):1===this.configuration.mode?Object(su.i)(0,770):null;return Object(su.g)({blending:e,colorWrite:su.d})}},{key:"bindPass",value:function(e){Object(dS.k)(this.program,this.uniformLocationInfos,e.basic),Object(dS.k)(this.program,this.uniformLocationInfos,e.common),Object(I.j)(e.colormap)&&Object(dS.k)(this.program,this.uniformLocationInfos,e.colormap),0===this.configuration.colorizerType&&Object(I.j)(e.stretch)?Object(dS.k)(this.program,this.uniformLocationInfos,e.stretch):2===this.configuration.colorizerType&&Object(I.j)(e.hillshade)&&Object(dS.k)(this.program,this.uniformLocationInfos,e.hillshade)}}]),r}(nu.a);hS.shader=new ru.a(uS.a,(function(){return r.e(188).then(r.bind(null,1072))}));var fS=function(e){Object(f.a)(r,e);var t=Object(p.a)(r);function r(){var e;return Object(c.a)(this,r),(e=t.apply(this,arguments)).mode=2,e.colorizerType=0,e.applyColormap=!0,e}return r}(iu.a);Object(b.a)([Object(iu.b)({count:3})],fS.prototype,"mode",void 0),Object(b.a)([Object(iu.b)({count:3})],fS.prototype,"colorizerType",void 0),Object(b.a)([Object(iu.b)()],fS.prototype,"applyColormap",void 0);var pS=function(){function e(t){Object(c.a)(this,e),this.renderingContext=t,this._pools=new Map}return Object(l.a)(e,[{key:"acquire",value:function(e){return this.getPool(e).acquire()}},{key:"release",value:function(e){this.getPool(e.width).release(e)}},{key:"clear",value:function(){this._pools.forEach((function(e){return e.destroy()})),this._pools.clear()}},{key:"getPool",value:function(e){var t=this._pools.get(e);if(!t){var r=Sk.a.bind(Sk.a,this.renderingContext,{colorTarget:0,depthStencilTarget:1,width:e,height:e});t=new mO.a(r),this._pools.set(e,t)}return t}}]),e}(),bS=r(268),vS=function(){function e(t,r,n){Object(c.a)(this,e),this._rctx=t,this.tileSize=r,this._backgroundIsGrid=!1,this._backgroundTexture=null,this._backgroundColor=null,this._blackTex=null,this._vectorTileHelper=new oS,this._maxAnisotropy=this._rctx.parameters.maxMaxAnisotropy,this._vaoQuad=Object(Gu.d)(this._rctx,bS.b);var i=new lS;i.mode=2,this._blendLayersTechnique=n.acquire(cS,i),i.mode=1,this._applyOpacityTechnique=n.acquire(cS,i),this._techniqueRep=n,this._blackTex=new Yx.a(Object(Gu.a)(this._rctx,[0,0,0,1])),this._fboPool=new pS(this._rctx)}return Object(l.a)(e,[{key:"dispose",value:function(){this._fboPool&&(this._fboPool.clear(),this._fboPool=null),this._vaoQuad=Object(I.f)(this._vaoQuad),this._backgroundTexture=Object(I.q)(this._backgroundTexture),this._blackTex=Object(I.q)(this._blackTex),this._blendLayersTechnique=Object(I.f)(this._blendLayersTechnique),this._applyOpacityTechnique=Object(I.f)(this._applyOpacityTechnique),this._vectorTileHelper=Object(I.f)(this._vectorTileHelper)}},{key:"updateTileTexture",value:function(e){var t,r=e.layerInfo[1],n=Object(i.a)(r);try{for(n.s();!(t=n.n()).done;){t.value.pendingUpdates&=-65}}catch(j){n.e(j)}finally{n.f()}if(e.renderData){for(var a=e.surface,o=a.baseOpacity,s=0,c=0,l=this.tileSize,u=!1,d=a.view.pixelRatio,h=r.length,f=0;f<r.length&&!u;f++){var p=a.layerViewByIndex(f,1),b=p.fullOpacity;if(yS[f]=b,Object(ne.b)(p.layer)&&h>=r.length&&(h=f),0!==b){++c;var v=mS(e,f,gS);v&&(Object(aw.n)(p)?l=Math.max(l,this.tileSize*d):1===o&&1===b&&(p.isOpaque||this._dataToTexture(v)&&Object(I.j)(v.sourceLayerInfo.data)&&v.sourceLayerInfo.data.descriptor.isOpaque)&&(u=!0),++s)}}this._cleanupFBOPool(d,r.length);var y=(l=function(e){var t=Object(m.p)(e),r=t*t,n=e*e;if(r===n)return e;var i=t/2;return r-n<n-i*i?t:i}(l))/this.tileSize,g=f-1;if(0===s){var O=0;return(e.surface.view.layerViewManager.updating||c>0)&&(O=5e3),this._backgroundTexture&&Object(I.i)(e.renderData.textureReference)&&(O=0),void this._useBackgroundTexture(e,O)}1===s&&(u||this._backgroundIsGrid||Object(I.j)(this._backgroundColor))&&this._useLayerTexture(e,g,h,yS[g])||this._composeMapLayers(e,g,h,u,yS,l,y)}}},{key:"setBackground",value:function(e,t){Object(I.q)(this._backgroundTexture),this._backgroundIsGrid=t,e instanceof HTMLImageElement?(this._backgroundTexture=this._buildTexture(e),this._backgroundColor=null):(this._backgroundTexture=new Yx.a(Object(Gu.a)(this._rctx,e)),this._backgroundColor=Object($l.g)(e[0]||0,e[1]||0,e[2]||0,e[3]||0))}},{key:"backgroundIsGrid",get:function(){return this._backgroundIsGrid}},{key:"backgroundColor",get:function(){return this._backgroundColor}},{key:"_buildTexture",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:9987;if(Object(I.i)(e))return null;var r,n={target:3553,pixelFormat:6408,dataType:5121,wrapMode:33071,samplingMode:t,maxAnisotropy:this._maxAnisotropy,flipped:!0,hasMipmap:!0},i=this._rctx;if("number"==typeof e)n.width=n.height=e,r=new Yx.a(new vu.a(i,n));else if(e instanceof nw.a)n.isOpaque=e.isOpaque,r=new Yx.a(new vu.a(i,n,e.image)),e.release();else try{r=new Yx.a(new vu.a(i,n,e))}catch(o){r=new Yx.a(Object(Gu.c)(i)),console.warn("TileRenderer: failed to execute 'texImage2D', cross-origin image may not be loaded.")}var a=i.bindTexture(r.texture,vu.a.TEXTURE_UNIT_FOR_UPDATES);return r.generateMipmap(),i.bindTexture(a,vu.a.TEXTURE_UNIT_FOR_UPDATES),r}},{key:"_drawQuad",value:function(e){this._rctx.bindVAO(this._vaoQuad),e.assertCompatibleVertexAttributeLocations(this._vaoQuad),this._rctx.drawArrays(5,0,Object(mu.f)(this._vaoQuad,"geometry"))}},{key:"_drawRasterData",value:function(e,t,r,n){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1;if(!Object(I.i)(t)){var a=this._rctx,o=e.program;a.setPipelineState(e.pipeline),a.useProgram(o),o.bindTexture(t,"tex"),o.setUniform1f("scale",r),o.setUniform2f("offset",n[0],n[1]),o.setUniform1f("opacity",i),this._drawQuad(o)}}},{key:"hasNearestInterpolation",value:function(e){var t=e.sourceLayerInfo.data;return!(Object(I.i)(t)||!t.source)&&"nearest"===t.interpolation}},{key:"_drawImageryTileData",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=e.sourceLayerInfo.data;if(!Object(I.i)(r)&&r.source){e.tile.surface.layerViewByIndex(e.layerIndex,1).ensureSymbolizerParameters(r);var n=this._getRasterColorizerTechnique(r.symbolizerParameters.type,!!r.symbolizerParameters.colormap),i=this._rctx,a=n.program;if(i.setPipelineState(n.pipeline),i.useProgram(a),r.bind(i)){r.opacity=t,r.scale=e.scale,r.offset=e.offset;var o=r.getTextures(),s=o.names,c=o.textures;s.forEach((function(e,t){return a.bindTexture(c[t],e)})),n.bindPass(r.getUniforms()),this._drawQuad(a),i.bindVAO()}}}},{key:"_getRasterColorizerTechnique",value:function(e,t){var r=["stretch","lut","hillshade"].indexOf(e);return this._rasterColorizerConfig||(this._rasterColorizerConfig=new fS,this._rctx.gl.getExtension("WEBGL_color_buffer_float"),this._rctx.gl.getExtension("OES_texture_float")),this._rasterColorizerConfig.colorizerType=r,this._rasterColorizerConfig.applyColormap=t,this._rasterColorizerTechnique=this._techniqueRep.releaseAndAcquire(hS,this._rasterColorizerConfig,this._rasterColorizerTechnique),this._rasterColorizerTechnique}},{key:"_drawVectorData",value:function(e,t,r,n,i,a,o){var s=t.sourceLayerInfo.data;if(Object(I.i)(s))return o;var c,l=this._rctx,u=t.tile.surface.layerViewByIndex(t.layerIndex,1);return l.setPipelineState(e.pipeline),n<1?(c=this._fboPool.acquire(i),l.bindFramebuffer(c),l.setClearColor(1,1,1,0),l.clearSafe(16640)):o&&l.clearSafe(256),this._vectorTileHelper.render(l,t.sourceLod,s,u.painter,u.layer.styleRepository,u.schemaHelper,Math.round(1/t.scale),t.offset,this.tileSize,r),!Object(I.j)(c)||(l.bindFramebuffer(a),this._drawRasterData(e,c.colorTexture,1,[0,0],n),this._fboPool.release(c),o)}},{key:"_useBackgroundTexture",value:function(e,t){e.renderData.opacity=e.surface.baseOpacity,e.renderData.compositeBackgroundInShader=!1,e.renderData.layerOpacity=1,e.renderData.baseOpacity=1,e.renderData.setTextureReference(this._backgroundTexture,0,0,1,t)}},{key:"_useLayerTexture",value:function(e,t,r,n){var i=t<r;e.renderData.opacity=i?1:e.surface.baseOpacity,e.renderData.compositeBackgroundInShader=!0,e.renderData.layerOpacity=n,e.renderData.baseOpacity=i?e.surface.baseOpacity:1;var a=mS(e,t,gS);if(this._dataToTexture(a)){var o=a.offset;return e.renderData.setTextureReference(a.sourceLayerInfo.data,o[0],o[1],a.scale),!0}return!1}},{key:"_composeMapLayers",value:function(e,t,r,n,i,a,o){var s=this,c=this._rctx,l=this._fboPool.acquire(a);c.bindFramebuffer(l),c.setViewport(0,0,a,a),c.setClearColor(0,0,0,0),c.setClearDepth(1),c.clearSafe(16640);var u=!1;!n&&Object(I.j)(this._backgroundTexture)&&this._drawRasterData(this._blendLayersTechnique,this._backgroundTexture.texture,1,ku.a);for(var d=e.surface.baseOpacity,h=!1,f=9987,p=t;p>=0;p--){var b=mS(e,p,gS);b&&(p<r&&d<1&&!h&&(this._drawRasterData(this._applyOpacityTechnique,this._blackTex.texture,1,ku.a,d),h=!0),0!==i[p]&&(Object(aw.o)(b)?u=this._drawVectorData(this._blendLayersTechnique,b,o,i[p],a,l,u):Object(aw.g)(b)?(this._drawImageryTileData(b,i[p]),this.hasNearestInterpolation(b)&&(f=9728)):this._dataToTexture(b)&&Object(I.j)(b.sourceLayerInfo.data)&&this._drawRasterData(this._blendLayersTechnique,b.sourceLayerInfo.data.texture,b.scale,b.offset,i[p])))}var v=e.renderData.ensureTexture(a,(function(){return s._buildTexture(a,f)})),m=c.bindTexture(v.texture,vu.a.TEXTURE_UNIT_FOR_UPDATES),y=v.descriptor;c.gl.copyTexImage2D(c.gl.TEXTURE_2D,0,y.pixelFormat,0,0,y.width,y.height,0),v.generateMipmap(),c.bindTexture(m,vu.a.TEXTURE_UNIT_FOR_UPDATES),c.bindFramebuffer(null),this._fboPool.release(l),e.renderData.opacity=h?1:d,e.renderData.compositeBackgroundInShader=!1,e.renderData.layerOpacity=1,e.renderData.baseOpacity=1,e.renderData.setTextureReference(v,0,0,1)}},{key:"_dataToTexture",value:function(e){return Object(aw.i)(e)&&this._rasterDataToTexture(e),Object(aw.k)(e)}},{key:"_rasterDataToTexture",value:function(e){var t=e.sourceLayerInfo;t.data=this._buildTexture(t.data),e.tile.setMemoryDirty()}},{key:"_cleanupFBOPool",value:function(e,t){e===this._lastPixelRatio&&t===this._lastNumLayers||(this._fboPool.clear(),this._lastPixelRatio=e,this._lastNumLayers=t)}},{key:"test",get:function(){return{backgroundTexture:this._backgroundTexture}}}]),e}();function mS(e,t,r){r.layerIndex=t;var n=e.layerInfo[1][t];if(n.data)return Object(xu.r)(r.offset,0,0),r.tile=e,r.scale=1,r.sourceLod=e.lij,r.sourceLayerInfo=n,r;var i=n.upsampleInfo;if(i){var a=i.tile.layerInfo[1][t];return r.tile=i.tile,Object(xu.c)(r.offset,i.offset),r.scale=i.scale,r.sourceLod=i.tile.lij,r.sourceLayerInfo=a,r}return null}var yS=new Array,gS={tile:null,sourceLayerInfo:null,sourceLod:null,offset:[0,0],scale:1,layerIndex:0},OS=r(76),jS=r(333),_S=r(626),wS=r(111),xS=function(e){Object(f.a)(r,e);var t=Object(p.a)(r);function r(){return Object(c.a)(this,r),t.apply(this,arguments)}return Object(l.a)(r,[{key:"initializeProgram",value:function(e){var t=r.shader.get(),n=this.configuration,i=t.build({overlayMode:n.overlayMode,output:n.output,viewingMode:e.viewingMode,slicePlaneEnabled:n.slicePlaneEnabled,sliceHighlightDisabled:!1,sliceEnabledForVertexPrograms:!1,textureFadingEnabled:n.textureFadingEnabled&&!n.renderOccluded,hasBackgroundColor:n.hasBackgroundColor,useGrid:n.useGrid,receiveShadows:n.receiveShadows&&!n.renderOccluded,receiveAmbientOcclusion:!1,atmosphere:n.atmosphere,tileBorders:n.tileBorders,screenSizePerspective:n.screenSizePerspective,pbrMode:0,ssrEnabled:n.ssrEnabled,highStepCount:!1});return new ou.a(e.rctx,i,au.a)}},{key:"initializePipeline",value:function(){var e=this.configuration,t=e.backfaceCullingEnabled&&!e.renderOccluded;return Object(su.g)({blending:e.renderOccluded?Object(su.i)(1,771):null,culling:t&&su.b,depthTest:!e.renderOccluded&&{func:513},depthWrite:!e.renderOccluded&&su.e,colorWrite:su.d,stencilTest:e.stencilEnabled?Object(wS.c)(1):null})}}]),r}(nu.a);xS.shader=new ru.a(_S.a,(function(){return r.e(189).then(r.bind(null,1073))}));var kS=function(e){Object(f.a)(r,e);var t=Object(p.a)(r);function r(){var e;return Object(c.a)(this,r),(e=t.apply(this,arguments)).output=0,e.overlayMode=0,e.atmosphere=!1,e.receiveShadows=!1,e.slicePlaneEnabled=!1,e.backfaceCullingEnabled=!1,e.stencilEnabled=!1,e.textureFadingEnabled=!1,e.hasBackgroundColor=!1,e.useGrid=!1,e.renderOccluded=!1,e.ssrEnabled=!1,e.tileBorders=!1,e.screenSizePerspective=!1,e}return r}(iu.a);Object(b.a)([Object(iu.b)({count:8})],kS.prototype,"output",void 0),Object(b.a)([Object(iu.b)({count:3})],kS.prototype,"overlayMode",void 0),Object(b.a)([Object(iu.b)()],kS.prototype,"atmosphere",void 0),Object(b.a)([Object(iu.b)()],kS.prototype,"receiveShadows",void 0),Object(b.a)([Object(iu.b)()],kS.prototype,"slicePlaneEnabled",void 0),Object(b.a)([Object(iu.b)()],kS.prototype,"backfaceCullingEnabled",void 0),Object(b.a)([Object(iu.b)()],kS.prototype,"stencilEnabled",void 0),Object(b.a)([Object(iu.b)()],kS.prototype,"textureFadingEnabled",void 0),Object(b.a)([Object(iu.b)()],kS.prototype,"hasBackgroundColor",void 0),Object(b.a)([Object(iu.b)()],kS.prototype,"useGrid",void 0),Object(b.a)([Object(iu.b)()],kS.prototype,"renderOccluded",void 0),Object(b.a)([Object(iu.b)()],kS.prototype,"ssrEnabled",void 0),Object(b.a)([Object(iu.b)()],kS.prototype,"tileBorders",void 0),Object(b.a)([Object(iu.b)()],kS.prototype,"screenSizePerspective",void 0);var SS=Object(Eg.h)(),TS=Object($l.e)(),CS=function e(){Object(c.a)(this,e),this.extent=Object($l.e)(),this.minLevel=0,this.maxLevel=0,this.callback=null},MS=function(e){Object(f.a)(r,e);var t=Object(p.a)(r);function r(e){var n;return Object(c.a)(this,r),(n=t.call(this,e)).type="Terrain",n.isGround=!0,n.tileSize=256,n.rctx=null,n._isTransparent=!1,n.renderDataPool=new mO.a(kk),n._patchGroups=new zy.a({allocator:function(e){return e||{root:null,origin:null,patches:new zy.a}},deallocator:function(e){return e.root=null,e.origin=null,e.patches.clear(),e}}),n.patchGroupsDirty=!0,n.patchGroupsMap=new Map,n.tileIterator=new Vx.b,n.highestVisibleLODTile=null,n.visible=!0,n._opaque=!0,n._skirtScale=1,n._velvetOverground=!0,n.castShadows=!0,n._ssrEnabled=!1,n.emptyTex=null,n.tileRenderer=null,n.tileBackgroundInitialized=!1,n.tileBackgroundUpdating=!1,n.stencilEnabledLayerExtents=[],n.numTrianglesRendered=0,n.numTilesRendered=0,n.numTilesCulled=0,n.numOriginsRendered=0,n.clippingExtent=null,n.overlayOpacity=1,n.needsHighlight=!1,n.renderOccludedFlags=1,n.visibleScaleRangeQueries=new zy.a({initialSize:10}),n.visibleScaleRangeQueriesInvPtr=0,n.visibleScaleRangeQueryQueue=new zy.a({initialSize:30}),n.visibleScaleRangeQueryPool=new mO.a(CS),n}return Object(l.a)(r,[{key:"isGlobal",get:function(){return 1===this.stage.viewingMode}},{key:"initialize",value:function(){this.stage.addRenderPlugin([2,7,9],this)}},{key:"destroy",value:function(){this.stage.removeRenderPlugin(this),wx.clear(),Sx.clear()}},{key:"updating",get:function(){return!this.tileBackgroundInitialized||this.tileBackgroundUpdating}},{key:"canRender",get:function(){return this.visible&&!!this.rootTiles&&this.tileBackgroundInitialized&&!this.renderingDisabled}},{key:"renderingDisabled",set:function(e){this._set("renderingDisabled",!!e),this.setNeedsRender()}},{key:"opaque",get:function(){return this._opaque&&!this.shaderTechniqueConfig.slicePlaneEnabled},set:function(e){this._opaque!==e&&(this._opaque=e,this.setNeedsRender())}},{key:"needsLinearDepth",get:function(){return this.overlayRenderer.hasWater}},{key:"isTransparent",get:function(){return this._isTransparent},set:function(e){this._isTransparent!==e&&(this._isTransparent=e,this.setNeedsRender())}},{key:"skirtScale",get:function(){return this._skirtScale},set:function(e){e!==this._skirtScale&&(this._skirtScale=e,this.setNeedsRender())}},{key:"renderPatchBorders",get:function(){return!!this.shaderTechniqueConfig.tileBorders},set:function(e){this.shaderTechniqueConfig.tileBorders!==e&&(this.shaderTechniqueConfig.tileBorders=e,this.setNeedsRender(),this.notifyChange("renderPatchBorders"))}},{key:"cullBackFaces",get:function(){return this.shaderTechniqueConfig.backfaceCullingEnabled},set:function(e){this.shaderTechniqueConfig.backfaceCullingEnabled!==e&&(this.shaderTechniqueConfig.backfaceCullingEnabled=e,this.notifyChange("cullBackFaces"),this.setNeedsRender())}},{key:"renderOrder",set:function(e){this._set("renderOrder",e),this.setNeedsRender()}},{key:"velvetOverground",set:function(e){this._velvetOverground!==e&&(this._velvetOverground=e,this.setNeedsRender())}},{key:"intersectionHandlerId",get:function(){return qw.b}},{key:"slicePlane",get:function(){return this.shaderTechniqueConfig.slicePlaneEnabled},set:function(e){this.shaderTechniqueConfig.slicePlaneEnabled!==e&&(this.shaderTechniqueConfig.slicePlaneEnabled=e,this.setNeedsRender())}},{key:"textureFadingEnabled",set:function(e){this.shaderTechniqueConfig.textureFadingEnabled!==e&&(this.shaderTechniqueConfig.textureFadingEnabled=e,this.setNeedsRender())}},{key:"setDebugScreenSizePerspective",value:function(e){this.shaderTechniqueConfig.screenSizePerspective!==e&&(this.shaderTechniqueConfig.screenSizePerspective=e,this.setNeedsRender())}},{key:"setRootTiles",value:function(e){this.rootTiles=e,this.setNeedsRender()}},{key:"setNeedsHighlight",value:function(e){this.needsHighlight=e,this.setNeedsRender()}},{key:"setRenderOccludedOverlay",value:function(e){this.renderOccludedFlags=e?sx.c:1,this.setNeedsRender()}},{key:"setStencilEnabledLayerExtents",value:function(e){this.stencilEnabledLayerExtents=e,this.setNeedsRender()}},{key:"setTileSize",value:function(e){this.tileSize=e,this.tileRenderer&&(this.tileRenderer.tileSize=e),this.setNeedsRender()}},{key:"loadTile",value:function(e){e.renderData||(e.renderData=this.renderDataPool.acquire(),e.renderData.init(e),e.renderData.localOrigin=this._getLocalOriginOfTile(e)),this.updateTileGeometry(e),this.updateTileTexture(e)}},{key:"queryVisibleLevelRange",value:function(e,t,r,n){var i=this.visibleScaleRangeQueryPool.acquire();Object(Su.c)(i.extent,e),i.minLevel=t||-Number.MAX_VALUE,i.maxLevel=null!=r?r:Number.MAX_VALUE,i.callback=n,this.visibleScaleRangeQueryQueue.push(i),this.setNeedsRender()}},{key:"updateTileTexture",value:function(e){this.tileRenderer&&this.tileBackgroundInitialized&&(this.tileRenderer.updateTileTexture(e),this.setNeedsRender(),e.resetPendingUpdate(64))}},{key:"updateTileGeometry",value:function(e){var t,r=Object(i.a)(e.layerInfo[0]);try{for(r.s();!(t=r.n()).done;){t.value.pendingUpdates&=-33}}catch(n){r.e(n)}finally{r.f()}e.resetPendingUpdate(32),e.renderData.updateGeometry(this.rctx,this.wireframe)&&this.setNeedsRender()}},{key:"unloadTile",value:function(e){e.renderData&&(e.renderData.releaseGeometry()&&this.setNeedsRender(),this.renderDataPool.release(e.renderData),e.renderData.clear(),e.renderData=null,e.setMemoryDirty(),this.setNeedsRender())}},{key:"_getLocalOriginOfTile",value:function(e){var t=Math.max(0,7*Math.floor((e.lij[0]-3)/7));if(this.isGlobal&&0===t)return X.b;for(;e.parent&&e.lij[0]>t;)e=e.parent;return e.centerAtSeaLevel}},{key:"setVisibility",value:function(e){this.visible=e,this.setNeedsRender()}},{key:"getStats",value:function(){return{numTilesRendered:this.numTilesRendered,numTilesCulled:this.numTilesCulled,numTrianglesRendered:this.numTrianglesRendered,numOriginsRendered:this.numOriginsRendered}}},{key:"wireframe",set:function(e){var t=this;this._get("wireframe")!==e&&(this._set("wireframe",e),this.allTiles.forAll((function(r){var n;return null==(n=r.renderData)?void 0:n.updateGeometry(t.rctx,e)})),this.setNeedsRender())}},{key:"setNeedsRender",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;this.patchGroupsDirty=!0,this.context.requestRender(e)}},{key:"setTileBackground",value:function(e){this.tileBackground=e,this._updateTileBackground()}},{key:"initializeRenderContext",value:function(e){this.context=e,this.rctx=e.renderContext.rctx,this.shaderTechniques=e.shaderTechniqueRep,this.shaderTechniqueConfig=new kS,this.tileRenderer=new vS(this.rctx,this.tileSize,this.shaderTechniques),this.tileBackground&&this._updateTileBackground(),this.emptyTex=Object(Gu.c)(this.rctx)}},{key:"uninitializeRenderContext",value:function(){null!=this.emptyTex&&(this.emptyTex.dispose(),this.emptyTex=null),this.tileRenderer&&(this.tileRenderer.dispose(),this.tileRenderer=null)}},{key:"intersect",value:function(e,t,r,n){var i=this;if(this.rootTiles&&(!e.options.selectOpaqueTerrainOnly||!e.options.selectionMode||this._opaque)){var a=IS,o=DS;Object(Yl.l)(a,n,r),Object(Yl.y)(o,1/a[0],1/a[1],1/a[2]);var s,c=e.results.min,l=e.results.max,u=e.results.ground,d=0===e.options.store,h=!!e.results.ground.target,f=Object(qw.e)(e.verticalOffset),p=this.clippingExtent;this.allTiles.forAll((function(b){if(!(null===b.renderData||h&&i._useStencilForTile(b))){if(e.options.invisibleTerrain){if(!b.visible&&p&&!b.intersectsExtent(p))return}else if(!b.visible)return;var v=b.renderData.geometryInfo;Object(Eg.B)(SS,v.boundingBox);var m=b.renderData.localOrigin;Object(I.j)(f)&&(f.localOrigin=m,f.applyToAabb(SS));var y=-i._skirtScale*v.skirtLength;if(0!==y){var g=b.up;Object(Eg.p)(SS,y*g[0],y*g[1],y*g[2])}var O=SS;Object(Yl.l)(FS,r,m);var j=d&&null!=c.dist?c.dist:1/0;if(Object(jx.g)(O,FS,o,e.tolerance,j)){var _=function(e,t,r,n){e.set(void 0,Object(Vx.i)(t),r,n,Kl.a,void 0),e.intersector=zS,e.target={type:"external",metadata:{tile:t}}},w=function(i,o){if(i>=0&&(e.options.backfacesTerrain||Object(Yl.j)(o,a)<0)&&(e.options.invisibleTerrain||!e.options.selectionMode||null==t||t(r,n,i))){if((null==u.dist||i<u.dist)&&_(u,b,i,o),e.options.isFiltered)return;2===e.options.store&&(Object(I.i)(s)?(s=new __.a(e.ray),_(s,b,i,o),e.results.all.push(s)):i<s.dist&&_(s,b,i,o)),(null==c.dist||i<c.dist)&&_(c,b,i,o),0!==e.options.store&&(null==l.dist||i>l.dist)&&_(l,b,i,o)}},x=LS;Object(Yl.l)(x,n,m);var k=v.indices,S=v.vertexAttributes,T={data:S.getField("position",Ok.u).typedBuffer,size:3,stride:S.stride/4},C=v.numWithoutSkirtIndices/3;if(Object(jx.j)(FS,x,0,C,k,T,null,f,w),0!==y){var M=i.isGlobal?function(e){return Object(Yl.g)(e,e,y/Object(Yl.r)(Object(Yl.h)(e,e,m)))}:function(e){return Object(Yl.y)(e,0,0,y)},P=k.length/3;!function(e,t,r,n,i,a,o,s,c){var l=a.position,u=a.uv0,d=e[0],h=e[1],f=e[2],p=t[0]-d,b=t[1]-h,v=t[2]-f;n*=3;for(var m=r*=3;m<n;m+=3){var y,g,O,j,_,w,x=i[m],k=i[m+1],S=i[m+2],T=l.get(x,0),C=l.get(x,1),M=l.get(x,2),P=l.get(k,0),A=l.get(k,1),E=l.get(k,2),R=l.get(S,0),D=l.get(S,1),F=l.get(S,2);u.get(x,0)>=2&&(Object(Yl.y)(Fx,T,C,M),o(Fx),T+=Fx[0],C+=Fx[1],M+=Fx[2]),u.get(k,0)>=2&&(Object(Yl.y)(Fx,P,A,E),o(Fx),P+=Fx[0],A+=Fx[1],E+=Fx[2]),u.get(S,0)>=2&&(Object(Yl.y)(Fx,R,D,F),o(Fx),R+=Fx[0],D+=Fx[1],F+=Fx[2]),Object(I.j)(s)&&(y=s.applyToVertex(T,C,M),T=(g=Object(ue.a)(y,3))[0],C=g[1],M=g[2],O=s.applyToVertex(P,A,E),P=(j=Object(ue.a)(O,3))[0],A=j[1],E=j[2],_=s.applyToVertex(R,D,F),R=(w=Object(ue.a)(_,3))[0],D=w[1],F=w[2]);var L=P-T,z=A-C,V=E-M,N=R-T,U=D-C,B=F-M,G=b*B-U*v,q=v*N-B*p,H=p*U-N*b,W=L*G+z*q+V*H;if(!(Math.abs(W)<=Number.EPSILON)){var Q=d-T,Z=h-C,X=f-M,Y=Q*G+Z*q+X*H;if(W>0){if(Y<0||Y>W)continue}else if(Y>0||Y<W)continue;var $=Z*V-z*X,J=X*L-V*Q,K=Q*z-L*Z,ee=p*$+b*J+v*K;if(W>0){if(ee<0||Y+ee>W)continue}else if(ee>0||Y+ee<W)continue;var te=(N*$+U*J+B*K)/W;te>=0&&c(te,Object(jx.d)(L,z,V,N,U,B,Lx))}}}(FS,x,C,P,k,S,M,f,w)}}}}))}}},{key:"prepareRender",value:function(){this.overlayOpacity<1&&this.updateOverlayOpacity()}},{key:"render",value:function(e){if(9===e.slot){if(0==(e.renderOccludedMask&sx.c))return!1}else{var t=this.opaque?2:7;if(e.slot!==t)return!1}var r=e.pass,n=1===e.scenelightingData.globalFactor,i=this._updatePatchGroups();switch(r){case 0:var a=e.shadowMap&&e.shadowMap.enabled;this.shaderTechniqueConfig.receiveShadows!==a&&(this.shaderTechniqueConfig.receiveShadows=a);var o=this.overlayRenderer.isEmpty()?0:this.overlayRenderer.hasWater?2:1;this.shaderTechniqueConfig.overlayMode!==o&&(this.shaderTechniqueConfig.overlayMode=o);var s=9===e.slot?3:1;this._renderMaterialPass(e,0,i,s);break;case 4:case 6:this.castShadows&&n&&this._renderAuxiliaryPass(e,3,i,0);break;case 2:this.isTransparent&&this.overlayRenderer.isEmpty()||this._renderAuxiliaryPass(e,1,i,0);break;case 3:this._renderAuxiliaryPass(e,2,i,0);break;case 5:this.needsHighlight&&(this._renderAuxiliaryPass(e,4,i,2),e.rctx.clearSafe(256))}return 0!==this.visibleScaleRangeQueryQueue.length&&this.setNeedsRender(),!0}},{key:"_renderMaterialPass",value:function(e,t,r,n){var i=this,a=e.rctx,o=e.camera;this._ssrEnabled=e.ssrParams.ssrEnabled,this._setTerrainTechnique(t,3===n);var s=this.shaderTechnique.program;a.useProgram(s),0!==this.shaderTechniqueConfig.overlayMode&&1===n&&e.ssrParams&&Object(jS.b)(s,e.ssrParams),e.shadowMap.bind(s),e.ssaoHelper.bind(s),this._bindOverlayData(s,n),s.setUniformMatrix4fv("viewNormal",o.viewInverseTransposeMatrix),Object(fu.c)(s,o.projectionMatrix),e.scenelightingData.setUniforms(s,!0);var c=o.viewMatrix;Object(Yl.y)(RS,c[12],c[13],c[14]),Object(Yl.t)(RS,RS),s.setUniform3fv("viewDirection",RS),this.numTilesRendered=0,this.numTilesCulled=0,this.numTrianglesRendered=0,this.numOriginsRendered=0,this._prepareScaleRangeQueries(),this.opaque?this._renderPatchGroups(e,s,r,n):e.offscreenRenderingHelper.renderToTargets((function(){return i._renderPatchGroups(e,s,r,n)}),e.offscreenRenderingHelper.tmpColor,e.offscreenRenderingHelper.mainDepth,[0,0,0,0]),this._processScaleRangeQueries()}},{key:"_renderAuxiliaryPass",value:function(e,t,r,n){this._setTerrainTechnique(t,3===n);var i=e.rctx,a=this.shaderTechnique.program;if(i.useProgram(a),5===e.pass){var o=e.offscreenRenderingHelper;a.bindTexture(o.depthTexture,"depthTex"),a.setUniform4f("highlightViewportPixelSz",0,0,1/o.width,1/o.height)}else a.setUniformMatrix4fv("viewNormal",e.camera.viewInverseTransposeMatrix),2!==e.pass&&4!==e.pass&&6!==e.pass||a.setUniform2fv("nearFar",e.camera.nearFar);this._renderPatchGroupsAuxiliary(e,a,r,n)}},{key:"_updateTileBackground",value:function(){var e=this;if(this.tileRenderer){this.tileBackgroundUpdating=!0;var t=function(){e.tileBackgroundInitialized=!0,e.tileBackgroundUpdating=!1,e.shaderTechniqueConfig.useGrid=e.tileRenderer.backgroundIsGrid,e.shaderTechniqueConfig.hasBackgroundColor=!e.tileRenderer.backgroundIsGrid&&!!Object(I.j)(e.tileRenderer.backgroundColor),e.allTiles.forAll((function(t){return e.tileRenderer.updateTileTexture(t)})),e.setNeedsRender()};if("string"==typeof this.tileBackground){var r=this.tileBackground;Object(eu.a)(r).then((function(n){r===e.tileBackground&&e.tileRenderer&&(e.tileRenderer.setBackground(n,e.tileBackground===Ps.a),t())}))}else{var n=this.tileBackground?Il.a.toUnitRGBA(this.tileBackground):[0,0,0,0];this.tileRenderer.setBackground(n,!1),t()}}}},{key:"_updatePatchGroups",value:function(){var e=this,t=this._patchGroups;if(!this.patchGroupsDirty)return t;if(this.highestVisibleLODTile=null,this._renderCollectOrigins(t),0!==this.renderOrder){for(var r=0;r<t.length;r++)Object(Vx.g)(this.renderOrder,t.data[r].patches);t.sort((function(t,r){return function(e,t,r){return 0===e.patches.length?-r:0===t.patches.length?r:Object(Vx.c)(e.patches.data[0],t.patches.data[0],r)}(t,r,e.renderOrder)}))}return this.patchGroupsDirty=!1,t}},{key:"_renderCollectOrigins",value:function(e){var t=this.rootTiles,r=this.isGlobal;e.clear();var n,a=Object(i.a)(t);try{for(a.s();!(n=a.n()).done;){var o=n.value,s=e.pushNew();s.root=o,s.origin=r?X.b:o.centerAtSeaLevel,s.patches.clear(),this._renderCollectOriginsForRoot(e,s)}}catch(c){a.e(c)}finally{a.f()}e.filterInPlace((function(e){return e.patches.length>0}))}},{key:"_renderCollectOriginsForRoot",value:function(e,t){var r=this.tileIterator;r.resetOne(t.root);var n=this.patchGroupsMap;for(n.clear(),n.set(t.origin,t);!r.done;){var i=r.next(),a=i.renderData;if(!a||i.visible){if(i.lij[0]%7==0){var o=e.pushNew();o.root=i,o.origin=i.centerAtSeaLevel,n.set(i.centerAtSeaLevel,o),o.patches.clear()}if(i.rendered){if(a){var s=n.get(a.localOrigin);s&&s.patches.push(i),(!this.highestVisibleLODTile||i.vlevel>this.highestVisibleLODTile.vlevel)&&(this.highestVisibleLODTile=i),r.skipSubtree()}}else this.numTilesCulled++}else this.numTilesCulled++,r.skipSubtree()}}},{key:"_scaleQueriesForTile",value:function(e){for(var t=e.extent,r=e.lij[0],n=0;n<this.visibleScaleRangeQueriesInvPtr;){var i=this.visibleScaleRangeQueries.data[n],a=i.extent;r>=i.minLevel&&r<=i.maxLevel&&a[0]<=t[2]&&a[2]>=t[0]&&a[1]<=t[3]&&a[3]>=t[1]?(this.visibleScaleRangeQueries.swapElements(n,this.visibleScaleRangeQueriesInvPtr-1),this.visibleScaleRangeQueriesInvPtr--):n++}}},{key:"_useStencilForTile",value:function(e){var t,r=Object(i.a)(this.stencilEnabledLayerExtents);try{for(r.s();!(t=r.n()).done;){var n=t.value;if(e.intersectsExtent(n))return!0}}catch(a){r.e(a)}finally{r.f()}return!1}},{key:"_renderPatchGroupsAuxiliary",value:function(e,t,r,n){this.shaderTechnique.bindPipelineState(e.rctx);var i=this.stencilEnabledLayerExtents.length>0;t.setUniformMatrix4fv("proj",e.camera.projectionMatrix),t.setUniform1f("skirtScale",this._skirtScale),0!==n&&this._bindOverlayData(t,n);for(var a=0;a<r.length;a++){var o=r.data[a];this._bindPatchGroupData(t,o,e.camera.eye,e.camera.viewMatrix);for(var s=0;s<o.patches.length;s++)this._renderPatch(e.rctx,t,o.patches.data[s],4,i,n)}e.rctx.bindVAO(null)}},{key:"_renderPatchGroups",value:function(e,t,r,n){var i=e.rctx,a=e.camera,o=a.viewMatrix;if(this.shaderTechnique.bindPipelineState(i),this.shaderTechniqueConfig.screenSizePerspective&&this.pointsOfInterest){var s=Object(Xy.d)(this.stage.viewingMode,this.ellipsoidRadius),c=this.pointsOfInterest.centerOnSurfaceFrequent.distance;s.update({distance:c,fovY:a.fovY}),Object(jx.a)(s,t,"screenSizePerspective")}var l=this.stencilEnabledLayerExtents.length>0,u=3===n;u&&(t.bindTexture(this.emptyTex,"tex"),t.setUniform1f("blend",1),t.setUniform4fv("texOffsetAndScale",$l.b));var d=Object(I.j)(this.tileRenderer.backgroundColor)?this.tileRenderer.backgroundColor:$l.b;this.shaderTechniqueConfig.hasBackgroundColor&&t.setUniform4fv("backgroundColor",d);var h=u?0:this._skirtScale;t.setUniform1f("skirtScale",h);var f=this.wireframe?1:4;this.shaderTechniqueConfig.textureFadingEnabled&&t.bindTexture(this.emptyTex,"texNext");for(var p=0;p<r.length;p++){var b=r.data[p],v=b.patches;this._bindPatchGroupData(t,b,a.eye,o);var m=e.sliceHelper&&e.sliceHelper.plane;Object(OS.b)(t,this.shaderTechnique.configuration,m,b.origin),e.shadowMap&&e.shadowMap.bindView(t,b.origin),this.numOriginsRendered++;for(var y=0;y<v.length;y++){var g=v.data[y],O=g.renderData.textureReference;if(!Object(I.i)(O)){if(!u){this._scaleQueriesForTile(g),AS(g.renderData.geometryInfo.uvOffsetAndScale,O.offsetAndScale,TS),t.setUniform4fv("texOffsetAndScale",TS),t.bindTexture(O.texture.texture,"tex");var j=g.renderData.textureFadeFactor,_=j<1?g.renderData.nextTextureReference:null;this.shaderTechniqueConfig.textureFadingEnabled&&Object(I.j)(_)&&j<1?(AS(g.renderData.geometryInfo.uvOffsetAndScale,_.offsetAndScale,TS),t.setUniform1f("textureFadeFactor",j),t.setUniform4fv("nextTexOffsetAndScale",TS),t.bindTexture(_.texture.texture,"texNext")):t.setUniform1f("textureFadeFactor",1),g.renderData.textureIsFading&&this.setNeedsRender(),t.setUniform1f("opacity",g.renderData.opacity),t.setUniform1i("compositeBackground",g.renderData.compositeBackgroundInShader?1:0),t.setUniform1f("textureOpacity",g.renderData.layerOpacity),t.setUniform1f("baseOpacity",g.renderData.baseOpacity)}var w=this._renderPatch(i,t,g,f,l,n);g.renderOrder=this.numTilesRendered,this.numTilesRendered++,this.numTrianglesRendered+=w/3}}}i.bindVAO(null)}},{key:"_renderPatch",value:function(e,t,r,n,i,a){if(Object(I.i)(r.renderData.vao.indexBuffer))return 0;0!==a&&this._bindOverlayPatchData(t,r.renderData.overlay),i&&(this._useStencilForTile(r)?this.stencilShaderTechnique.bindPipelineState(e):this.shaderTechnique.bindPipelineState(e));var o=0===this._skirtScale?r.renderData.geometryInfo.numWithoutSkirtIndices:r.renderData.vao.indexBuffer.size;return e.bindVAO(r.renderData.vao),t.assertCompatibleVertexAttributeLocations(r.renderData.vao),e.drawElements(n,o,r.renderData.vao.indexBuffer.indexType,0),o}},{key:"_bindPatchGroupData",value:function(e,t,r,n){e.setUniform3fv("origin",t.origin),Object(Jl.t)(ES,n,t.origin),e.setUniformMatrix4fv("view",ES),e.setUniform3f("camPos",r[0]-t.origin[0],r[1]-t.origin[1],r[2]-t.origin[2])}},{key:"_bindOverlayData",value:function(e,t){if(0!==this.shaderTechniqueConfig.overlayMode){e.setUniform1f("overlayOpacity",this.overlayOpacity);var r=this.overlayRenderer.overlays;if(r.length>0){var n=r[0],i=n.getColorTexture(t);if(e.bindTexture(Object(I.j)(i)?i:this.emptyTex,"ovColorTex"),2===this.shaderTechniqueConfig.overlayMode){var a=n.getNormalTexture(t);e.bindTexture(Object(I.j)(a)?a:this.emptyTex,"ovWaterTex")}}}}},{key:"_bindOverlayPatchData",value:function(e,t){e.setUniform4fv("overlayTexOffset",t.offsets),e.setUniform4fv("overlayTexScale",t.scales)}},{key:"_setTerrainTechnique",value:function(e,t){this.shaderTechniqueConfig.output=e,0===e&&(this.shaderTechniqueConfig.atmosphere=this.isGlobal&&this._velvetOverground,this.shaderTechniqueConfig.ssrEnabled=this._ssrEnabled),this.shaderTechniqueConfig.renderOccluded=t,this.shaderTechniqueConfig.stencilEnabled=!1,this.shaderTechnique=this.shaderTechniques.releaseAndAcquire(xS,this.shaderTechniqueConfig,this.shaderTechnique),this.shaderTechniqueConfig.stencilEnabled=!0,this.stencilShaderTechnique=this.shaderTechniques.releaseAndAcquire(xS,this.shaderTechniqueConfig,this.stencilShaderTechnique)}},{key:"_prepareScaleRangeQueries",value:function(){for(var e=this.visibleScaleRangeQueries,t=this.visibleScaleRangeQueryQueue;e.length<e.data.length&&t.length>0;){var r=t.pop();e.push(r)}this.visibleScaleRangeQueriesInvPtr=e.length}},{key:"_processScaleRangeQueries",value:function(){for(var e=this.visibleScaleRangeQueries,t=this.visibleScaleRangeQueryPool,r=0;r<e.length;r++){var n=e.data[r];t.release(n),n.callback(r>=this.visibleScaleRangeQueriesInvPtr),n.callback=null}e.clear()}},{key:"test",get:function(){return{tileRenderer:this.tileRenderer}}}]),r}(de.a);Object(b.a)([Object(y.b)()],MS.prototype,"tileBackgroundInitialized",void 0),Object(b.a)([Object(y.b)()],MS.prototype,"tileBackgroundUpdating",void 0),Object(b.a)([Object(y.b)({constructOnly:!0})],MS.prototype,"overlayRenderer",void 0),Object(b.a)([Object(y.b)({constructOnly:!0})],MS.prototype,"stage",void 0),Object(b.a)([Object(y.b)({readOnly:!0})],MS.prototype,"isGlobal",null),Object(b.a)([Object(y.b)({constructOnly:!0})],MS.prototype,"updateOverlayOpacity",void 0),Object(b.a)([Object(y.b)({constructOnly:!0})],MS.prototype,"allTiles",void 0),Object(b.a)([Object(y.b)({constructOnly:!0})],MS.prototype,"ellipsoidRadius",void 0),Object(b.a)([Object(y.b)({readOnly:!0})],MS.prototype,"updating",null),Object(b.a)([Object(y.b)({value:!1})],MS.prototype,"renderingDisabled",null),Object(b.a)([Object(y.b)()],MS.prototype,"renderPatchBorders",null),Object(b.a)([Object(y.b)()],MS.prototype,"cullBackFaces",null),Object(b.a)([Object(y.b)({value:1})],MS.prototype,"renderOrder",null),Object(b.a)([Object(y.b)()],MS.prototype,"wireframe",null);var PS=MS=Object(b.a)([Object(w.a)("esri.views.3d.terrain.TerrainRenderer")],MS);function AS(e,t,r){var n=e[0]*t[2]+t[0],i=e[1]*t[3]+t[1],a=e[2]*t[2],o=e[3]*t[3];Object(Su.l)(r,n,i,a,o)}var ES=Object(Kl.d)(),RS=Object(X.e)(),IS=Object(X.e)(),DS=Object(X.e)(),FS=Object(X.e)(),LS=Object(X.e)(),zS="TerrainRenderer",VS=PS,NS=function e(){Object(c.a)(this,e),this.numNodes=0,this.numLeaves=0,this.numVisible=0,this.numRendered=0,this.numSplit=0,this.numMerged=0,this.numRenderedPerLevel=new Array,this.numLoadedPerLevel=new Array},US=function(){function e(){Object(c.a)(this,e),this.offset=Object(ku.b)(),this.scale=0,this.tile=null}return Object(l.a)(e,[{key:"init",value:function(e,t,r,n){this.tile=e,this.offset[0]=t,this.offset[1]=r,this.scale=n}},{key:"dispose",value:function(){this.tile=null,this.offset[0]=0,this.offset[1]=0,this.scale=0}}]),e}(),BS=j.a.getLogger("esri.views.3d.terrain.TerrainSurface"),GS=function(e){Object(f.a)(n,e);var t=Object(p.a)(n);function n(e){var r;return Object(c.a)(this,n),(r=t.call(this,e))._elevationBounds=new rx,r._rootExtent=Object(K.k)(),r._iteratorPool=new mO.a(Vx.b,(function(e){return e.remove=function(){return r._iteratorPool.release(e)}})),r._postorderIterator=new Vx.a,r._hasPendingUpdates=!1,r._pendingUpdates=0,r._asyncWorkItems=0,r._allTilesDirty=!0,r._allTilesSorted=!0,r._visible=!1,r._usedMemory=QS,r._performanceInfo=new NS,r._viewChanged=!1,r._inFrameTask=!1,r._viewChangeUpdateDirty=!1,r._overlayOpacity=1,r._eyePosRenderSR=Object(X.e)(),r._eyePosSurfaceSR=Object(X.e)(),r._splitLimits=new tk,r._snapLevel=1/0,r._frustum=Object(yO.c)(),r._viewProjectionMatrix=Object(Kl.d)(),r._layerViews=[new Array,new Array],r._layerIndexByUid=[new Map,new Map],r._basemapLayerViewHandles=new Map,r._handles=new oe.a,r._watchUpdatingTracking=new fe.a,r._allTiles=new zy.a,r._upsampleInfoPool=new mO.a(US),r._getElevationData={spatialReference:null,rootTiles:null},r._maxNumUpdating=1,r.maxTextureScale=1.2,r.rootTiles=null,r.backgroundImage=Ps.a,r.backgroundColor=null,r._layerViewsDirty=!1,r}return Object(l.a)(n,[{key:"initialize",value:function(){var e=this;this._lercDecoder=Object(Jw.a)(this.view.resourceController),this._tilePool=this.view.state.isLocal?new mO.a(uk):new mO.a(dk);var t=this.view.resourceController.memoryController;this._upsampleMapCache=t.getMemCache("esri.views.3d.terrain.upsample",(function(e){return e.unloadMapData()})),this._elevationQueryCache=new $w(t.getMemCache("elevation-query")),this._set("overlayManager",new fx({surface:this})),this._handles.add([this.watch("overlayManager.hasHighlights",(function(t){return e._renderer.setNeedsHighlight(t)})),this.watch("overlayManager.rendersOccluded",(function(t){return e._renderer.setRenderOccludedOverlay(t)}))],"overlayManager"),this._renderer=new VS({overlayRenderer:this.overlayManager.renderer,ellipsoidRadius:Object(J.e)(this.view.spatialReference).radius,stage:this.view._stage,updateOverlayOpacity:function(){return e.updateOverlayOpacity()},allTiles:this._allTiles}),this._handles.add([Object(W.a)(this,"baseOpacity",(function(t){e._handleLayerViewChanges(),e._updateBaseOpacity(t)}),!0),Object(W.a)(this,"_background",(function(){e._handleLayerViewChanges(),e._renderer.setTileBackground(e._background)}),!0),this.view.watch("pointsOfInterest",(function(t){e._renderer.pointsOfInterest=t,e._watchUpdatingTracking.removeAll(),t&&e._watchUpdatingTracking.add(t.focus,"renderLocation",(function(){return function(){return e._allTilesSorted=!1}}))})),Object(W.a)(Vy.a,"TERRAIN_TILE_TREE_SHOW_TILES",(function(t){t&&!e._treeDebugger?r.e(145).then(r.bind(null,1070)).then((function(t){var r=t.TerrainTileTree3DDebugger;!e._treeDebugger&&Vy.a.TERRAIN_TILE_TREE_SHOW_TILES&&(e._treeDebugger=new r({view:e.view}))})):t||!e._treeDebugger||Vy.a.TERRAIN_TILE_TREE_SHOW_TILES||(e._treeDebugger.destroy(),e._treeDebugger=null)}))]);var n={layers:this.view.map.allLayers,layerViews:this.view.allLayerViews,spatialReference:this.view.spatialReference};this.extentHelper=function(e,t){return 1===e?new bk(t):new vk(t)}(this.viewingMode,n),this._handles.add(Object(W.a)(this.extentHelper,"stencilEnabledExtents",(function(t){return e._renderer.setStencilEnabledLayerExtents(t)})),"extentHelper");var i=this.view.defaultsFromMap?new Vs.a({getCollections:function(){var t,r,n;return null==(t=e.view)||null==(r=t.defaultsFromMap)||null==(n=r.mapCollectionPaths)?void 0:n.map((function(t){return e.view.map.get(t)}))},getChildrenFunction:function(e){return e&&"layers"in e?e.layers:null}}):this.view.map.allLayers,a=new gk({layers:i,extentHelper:this.extentHelper,viewingMode:this.viewingMode,viewSpatialReference:this.view.spatialReference});this._set("tilingSchemeLogic",a),this._handles.add([this.tilingSchemeLogic.watch("tilingScheme",(function(){return e._updateTilingSchemeAndExtent()}),!0),this.tilingSchemeLogic.watch("extent",(function(){return e._updateTilingSchemeAndExtent()}),!0)],"tilingSchemeLogic"),this._updateTilingSchemeAndExtent(),this._elevationDataRequester=this.view.resourceController.createStreamDataRequester(0),this._mapDataRequester=this.view.resourceController.createStreamDataRequester(1);var o=this.view.resourceController.scheduler;this._frameTask=o.registerTask(Og.b.TERRAIN_SURFACE,this),this.view.resourceController.memoryController.events.on("quality-changed",(function(){return e._viewChangeUpdate()})),this._handles.add([this.view.on("resize",(function(){return e._viewChangeUpdate()})),this.view.watch("state.camera",(function(){return e._viewChangeUpdate()}),!0),this.view.watch("state.contentCamera",(function(){return e.view.state.fixedContentCamera&&e._viewChangeUpdate()}),!0),this.view.watch("qualitySettings.tiledSurface.lodBias",(function(){return e._viewChangeUpdate()})),Object(W.a)(this.view,"qualitySettings.tiledSurface.textureFadeDuration",(function(t){return e._renderer.textureFadingEnabled=t>0})),this.view.watch("lodSnapping",(function(){return e._viewChangeUpdate()})),this.view.watch("clippingArea",(function(){return e._clippingChanged()}))]),this._handles.add(this.view.allLayerViews.on("after-changes",(function(){return e._layerViewsDirty=!0}))),this._layerViewsDirty=!0,this._handleLayerViewChanges(),this._updateClippingExtent(),this.notifyChange("extent")}},{key:"destroy",value:function(){var e=this;this._frameTask.remove(),this._handles.destroy(),this._watchUpdatingTracking.destroy(),this._lercDecoder=Object(I.q)(this._lercDecoder),this._removeAllTiles(),this._upsampleMapCache=Object(I.e)(this._upsampleMapCache),this._elevationQueryCache=Object(I.e)(this._elevationQueryCache),this._set("tilingSchemeLogic",Object(I.e)(this.tilingSchemeLogic)),this.extentHelper=Object(I.e)(this.extentHelper),this._basemapLayerViewHandles.forEach((function(t,r){return e._unregisterTiledLayerView(r)})),this._elevationDataRequester=null,this._mapDataRequester=null,this._set("overlayManager",Object(I.e)(this.overlayManager)),this._tilePool=Object(I.e)(this._tilePool),lk.prune(),this._treeDebugger&&(this._treeDebugger.destroy(),this._treeDebugger=null),this._renderer=Object(I.e)(this._renderer),this._iteratorPool=Object(I.e)(this._iteratorPool),this._set("view",null),this._upsampleInfoPool=Object(I.e)(this._upsampleInfoPool),Object(Kw.b)(),Xx.size>0&&(console.log("".concat(Xx.size," live TilePerLayerInfo allocations:")),Xx.forEach((function(e){return console.log(e,"\n")})))}},{key:"renderer",get:function(){return this._renderer}},{key:"frustum",get:function(){return this._frustum}},{key:"snapLevel",get:function(){var e,t,r=null==(e=this.view.pointsOfInterest)||null==(t=e.contentCameraOnSurface)?void 0:t.scale;if(r){var n=this.view.state.contentCamera,i=Vv(this.view,n.eye,n.viewForward,n.up).tilt;i>90&&(i=180-i);var a=2*Math.pow(i/90,2),o=Xv(this.view,r)-a;Math.abs(this._snapLevel-o)>.25&&(Math.round(o)!==Math.round(this._snapLevel)&&(this._viewChanged=!0),this._snapLevel=o)}return Math.round(this._snapLevel)}},{key:"lodSnapping",get:function(){return this.view.qualitySettings.tiledSurface.reduceTileLevelDifferences?1:0}},{key:"upsampleInfoPool",get:function(){return this._upsampleInfoPool}},{key:"upsampleMapCache",get:function(){return this._upsampleMapCache}},{key:"elevationQueryCache",get:function(){return this._elevationQueryCache}},{key:"mapTileRequester",get:function(){return this._mapDataRequester}},{key:"extent",get:function(){return Object(I.t)(this._clippingExtent,this._rootExtent)}},{key:"updating",get:function(){return this._hasPendingUpdates||(this._maxNumUpdating=1),!!((this._watchUpdatingTracking.updating||this._hasPendingUpdates||this._viewChanged||this._allTilesDirty||this._asyncWorkItems>0||!this._allTilesSorted||this._renderer.updating||this._layerViewsDirty)&&this.ready&&!this.suspended||this.overlayManager.updating||this._frameTask.updating)}},{key:"updatingProgressValue",get:function(){return this._maxNumUpdating=Math.max(this._pendingUpdates,this._maxNumUpdating),1-this._pendingUpdates/this._maxNumUpdating}},{key:"viewingMode",get:function(){return this.view.state.viewingMode}},{key:"ready",get:function(){return!!this.rootTiles}},{key:"renderOrder",set:function(e){this._renderer.renderOrder=e,this._set("renderOrder",e)}},{key:"skirtScale",get:function(){return this._renderer.skirtScale},set:function(e){this._renderer.skirtScale=e}},{key:"spatialReference",get:function(){var e,t;return null!=(e=null==(t=this.tilingScheme)?void 0:t.spatialReference)?e:null}},{key:"_background",get:function(){return null!=this.backgroundColor?this.backgroundColor:this.backgroundImage}},{key:"slicePlaneEnabled",set:function(e){var t,r;this._renderer.slicePlane=e,this._set("slicePlaneEnabled",e),null==(t=this.view)||null==(r=t._stage)||r.renderView.setRenderParameters({opaqueTerrain:this.opaque})}},{key:"velvetOverground",set:function(e){e!==this.velvetOverground&&(this._renderer.velvetOverground=e),this._set("velvetOverground",e)}},{key:"visible",set:function(e){e!==this._visible&&(this._visible=e,this._renderer.setVisibility(e),this.suspended=!e)}},{key:"opaque",get:function(){return this._renderer.opaque}},{key:"suspended",set:function(e){this._set("suspended",e),this._viewChangeUpdate()}},{key:"intersect",value:function(e,t,r,n){this._renderer.intersect(e,t,r,n)}},{key:"getElevation",value:function(e,t,r,n){var i=ZS,a=this.getTileWithElevation(e,t,r,n,i);return Object(I.i)(a)?null:nx.sample(i[0],i[1],a.renderData.geometryState.samplerData)}},{key:"getTileWithElevation",value:function(e,t,r,n){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:ZS,o=this._getElevationData.rootTiles;if(!o||!o.length)return null;if(0===o[0].layerInfo[0].length)return null;if(a[0]=e,a[1]=t,a[2]=r,!Object($.z)(a,n,a,this._getElevationData.spatialReference))return BS.error("TerrainSurface.getElevation(): could not project given point to tiling scheme coordinate system"),null;var s,c=Object(i.a)(o);try{for(c.s();!(s=c.n()).done;){var l=s.value;if(l.containsPoint(a)){for(;l&&!l.rendered&&!l.isLeaf;){var u=0;a[0]>.5*(l.extent[0]+l.extent[2])&&(u+=1),a[1]<.5*(l.extent[1]+l.extent[3])&&(u+=2),l=l.children[u]}var d=l.renderData;return d&&d.geometryState&&d.geometryState.samplerData?l:null}}}catch(h){c.e(h)}finally{c.f()}return null}},{key:"elevationBounds",get:function(){return this._elevationBounds}},{key:"getScale",value:function(e){if(this.tilingScheme){if(!Object($.u)(e,ZS,this.spatialReference))return BS.error("TerrainSurface.getElevation(): could not project given point to tiling scheme coordinate system"),null;var t=this.rootTiles;if(t){var r,n=Object(i.a)(t);try{for(n.s();!(r=n.n()).done;){var a=r.value;if(a.containsPoint(ZS)){for(;null!=a.children[0];){var o=0;ZS[0]>a.children[0].extent[2]&&(o+=1),ZS[1]<a.children[0].extent[1]&&(o+=2),a=a.children[o]}return this._getLodBiasCorrectedScale(a.level)}}}catch(s){n.e(s)}finally{n.f()}}}return 1e100}},{key:"queryVisibleScaleRange",value:function(e,t,r,n){var i=t?this.tilingScheme.levelAtScale(t):0,a=r?this.tilingScheme.levelAtScale(r):1/0,o=this.lodBias;this._renderer.queryVisibleLevelRange(e,i+o,a+o,n)}},{key:"_updateBaseOpacity",value:function(e){var t=this._renderer.opaque;this._renderer.opaque=e>=1,this._renderer.isTransparent=this._allTransparentSurfaceLayers();var r,n,i=t!==this._renderer.opaque;i&&(null==(r=this.view)||null==(n=r._stage)||n.renderView.setRenderParameters({opaqueTerrain:this.opaque})),this._updateTileTextures(i)}},{key:"_updateTilingSchemeAndExtent",value:function(){var e=this.tilingSchemeLogic.extent,t=e&&!Object(K.n)(e,this._dataExtent);t&&(Object(I.j)(this._dataExtent)?Object(K.y)(this._dataExtent,e):this._dataExtent=Object(K.k)(e));var r,n=this.tilingSchemeLogic.tilingScheme,i=n!==this.tilingScheme;i&&(Object(aw.s)(!!n,"tiling scheme cannot be reset to undefined"),this.tilingScheme&&this._removeAllTiles(),this._set("tilingScheme",n),this._updateClippingExtent(),n&&(this._updateTiledLayers(),this._renderer.setTileSize(n.pixelSize),this.overlayManager.setSpatialReference(n.spatialReference)),this._getElevationData.spatialReference=null!=(r=null==n?void 0:n.spatialReference)?r:null),(t||i)&&this._updateRootTiles()}},{key:"_acquireTile",value:function(e,t,r,n){var i=this._tilePool.acquire();return YS[0]=e,YS[1]=t,YS[2]=r,i.init(YS,n,this),i}},{key:"_updateRootTiles",value:function(){var e=this,t=this._clippingExtent||this._dataExtent,r=this.tilingScheme;if(!Object(I.i)(t)&&r){var n=XS,i=r.rootTilesInExtent(t,n,5*Ps.i),a=function(t){var r=e._acquireTile(0,t[1],t[2],null);return 2===r.shouldSplit(e._splitLimits,e._eyePosRenderSR,e.lodSnapping)&&r.setPendingUpdate(2),e._loadTile(r),r};if(this.rootTiles){if(i.length>Ps.i)return void BS.warn(Ps.k);var o=this.rootTiles.map((function(e){return e.lij})),s=Object(Fs.d)(o,i,HS);if(s.removed.length>0||s.added.length>0){var c=this.rootTiles.filter((function(t){return!(s.removed.findIndex(HS.bind(null,t.lij))>-1)||(e._purgeTile(t),!1)}));s.added.forEach((function(e){return c.push(a(e))})),this._setRootTiles(c)}}else i.length>Ps.i&&(BS.warn(Ps.l),i=r.rootTilesInExtent(t,n,Ps.i)),this._setRootTiles(i.map((function(e){return a(e)})));Object(K.n)(n,this._rootExtent)||(this._rootExtent=Object(K.k)(n),this._hasFixedExtent()||this.notifyChange("extent")),this.visible=!0,this._viewChangeUpdate(),this.overlayManager.setOverlayPlacementDirty(),this.notifyChange("ready")}}},{key:"_setRootTiles",value:function(e){if(this._set("rootTiles",e),this._allTiles.clear(),e){var t=this._iteratorPool.acquire();for(t.reset(e);!t.done;)this._allTiles.push(t.next());t.remove()}this._getElevationData.rootTiles=e,this._renderer.setRootTiles(this.rootTiles),this._updateTileVisibility(e)}},{key:"_runViewChangeUpdateIfDirty",value:function(){this._viewChangeUpdateDirty&&(this._viewChangeUpdateDirty=!1,this._viewChangeUpdate())}},{key:"_viewChangeUpdate",value:function(){this.view&&!this.suspended&&this.tilingScheme&&this._visible&&(this._inFrameTask?this._viewChangeUpdateDirty=!0:(this._viewChangeUpdateDirty=!1,this._updateViewDependentParameters(),this._updateSkirts(),this.updateOverlayOpacity(),this._updateTileVisibility(this.rootTiles)))}},{key:"_updateClippingStatus",value:function(e){e.updateClippingStatus(this._clippingExtent)&&e.resetPendingUpdate(32)&&this._updateTileGeometry(e)}},{key:"_updateTileVisibility",value:function(e){if(e){var t=this._iteratorPool.acquire();t.reset(e);for(var r=Object(Vx.f)(e),n=r?this._elevationBounds.min:1/0,i=r?this._elevationBounds.max:-1/0;!t.done;){var a=t.next();this._updateClippingStatus(a),a.updateVisibility(),a.setPendingUpdate(16),a.loadable?(a.updateScreenDepth(this._viewProjectionMatrix),a.renderData&&(n=Math.min(a.elevationBounds[0],n),i=Math.max(a.elevationBounds[1],i))):t.skipSubtree()}t.remove(),this._viewChanged=!0,this._allTilesDirty=!0,isFinite(n)&&isFinite(i)&&(this._elevationBounds.min===n&&this._elevationBounds.max===i||(this._elevationBounds.min=n,this._elevationBounds.max=i,this.emit("elevation-bounds-change",null)))}}},{key:"_updateViewDependentParameters",value:function(){var e=this.view.state.camera,t=this.view.state.contentCamera,r=Math.tan(.5*t.fovX),n=Math.tan(.5*t.fovY),i=this.tilingScheme.pixelSize,a=Math.pow(2,-this.lodBias)*e.pixelRatio;this._splitLimits.aboveGround=e.aboveGround,this._splitLimits.fovX=r,this._splitLimits.fovY=n,this._splitLimits.relativeWidthLimit=i/e.width*this.maxTextureScale*a,this._splitLimits.relativeHeightLimit=i/e.height*this.maxTextureScale*a,this._splitLimits.maxLod=this.tilingScheme.getMaxLod(),this._splitLimits.angledSplitBias=this.view.qualitySettings.tiledSurface.angledSplitBias,this.view.state.fixedContentCamera?(Object(I.i)(this._splitLimits.frustum)&&(this._splitLimits.frustum=Object(yO.c)()),Object(yO.b)(t.frustum,this._splitLimits.frustum)):this._splitLimits.frustum=null,Object(yO.b)(e.frustum,this._frustum),Object(Jl.m)(this._viewProjectionMatrix,t.projectionMatrix,t.viewMatrix),Object(Yl.m)(this._eyePosRenderSR,t.eye),Object($.z)(e.eye,this.view.renderSpatialReference,this._eyePosSurfaceSR,this.spatialReference)}},{key:"_updateSkirts",value:function(){var e=this.view.state.camera,t=this.view.state.constraints.collision.enabled?0:1.11*e.near;this.skirtScale=Object(aw.b)(this,this._eyePosSurfaceSR,t)}},{key:"_updateRenderData",value:function(e){e.rendered&&!e.shouldLoad&&(WS(e)?this._loadChildren(e):function(e){return e.isLeaf&&e.parent&&e.parent.shouldLoad}(e)&&this._loadParent(e))}},{key:"_updateTileGeometry",value:function(e){e.updateVisibility(),this._renderer.updateTileGeometry(e),this._elevationUpdate(e),this._usedMemory=QS}},{key:"_elevationUpdate",value:function(e){JS.spatialReference=this.spatialReference,JS.tile=e,JS.extent=e.extent,this.emit("elevation-change",JS),Object(K.h)(e.extent,this._eyePosSurfaceSR)&&this._updateSkirts()}},{key:"running",get:function(){return this.updating&&this.ready&&!this.suspended}},{key:"runTask",value:function(e){var t=this;this._handleLayerViewChanges(e),this._frameTask.processQueue(e),this._inFrameTask=!0,this._pendingUpdates=0,this._hasPendingUpdates=!1,this._updateTileStatus(e),this._sortTiles(e);var r=!this.view.state.fixedContentCamera;this._mergeAndSplit(e,r),e.run((function(){return t._updateElevation(e)})),e.run((function(){return t._updateTextures(e)})),r||this._mergeAndSplit(e,!0),this._inFrameTask=!1,this._runViewChangeUpdateIfDirty(),e.done&&this.requestUpdate(),this.notifyChange("updatingProgressValue")}},{key:"_updateTileStatus",value:function(e){if(this._viewChanged&&this.rootTiles&&!e.done){this._viewChanged=!1;var t=this._iteratorPool.acquire();for(t.reset(this.rootTiles);!t.done;){var r=t.next();if(r.loadable){var n=r.shouldSplit(this._splitLimits,this._eyePosRenderSR,this.lodSnapping);if(2===n){r.resetPendingUpdate(8),r.isLeaf&&(r.setPendingUpdate(2),t.skipSubtree());continue}r.resetPendingUpdate(2)&&r.updateAgentSuspension(),4===n&&r.updateAgents(0)}if(t.skipSubtree(),!r.isLeaf){r.setPendingUpdate(8),r.resetPendingUpdate(2);var i=this._iteratorPool.acquire();i.resetOne(r);for(var a=i.next();!i.done;a=i.next())this._updateClippingStatus(a),a.updateVisibility(),a.loadable&&a.updateScreenDepth(this._viewProjectionMatrix);i.remove()}}t.remove(),this.requestUpdate(),e.madeProgress()}}},{key:"_sortTiles",value:function(e){e.done||this._allTilesSorted||(Object(Vx.h)(this._allTiles,this.view.pointsOfInterest.focus.renderLocation),this._allTilesSorted=!0,this._treeDebugger&&this._treeDebugger.update(),e.madeProgress())}},{key:"_mergeAndSplit",value:function(e,t){var r=this;if(!this.suspended&&this._allTilesDirty&&!e.done){this._allTilesDirty=!1,this.requestUpdate();for(var n=0;!e.done;){var i=!1;n=0;var a=!this._allTiles.some((function(a){if(n+=a.usedMemory,a.resetPendingUpdate(8)){if(!t)return a.setPendingUpdate(8),e.done;r._mergeTile(a),i=!0,e.madeProgress()}else a.resetPendingUpdate(2)&&(r._splitTile(a),i=!0,e.madeProgress());return a.resetPendingUpdate(16)&&(r._updateRenderData(a),e.madeProgress()),e.done}));if(i&&(this._allTilesSorted=!1,this._allTilesDirty=!0),a){if(this._usedMemory=n,!i)break}else this._allTilesDirty=!0}0===n&&(this._allTilesDirty=!0),this._sortTiles(e)}}},{key:"_updateElevation",value:function(e){var t=this;return this._allTiles.some((function(r){return r.resetPendingUpdate(32)&&(t._updateTileGeometry(r),r.resetPendingUpdate(64)&&(t._renderer.updateTileTexture(r),t._usedMemory=QS),e.madeProgress()),e.done})),e.hasProgressed}},{key:"_updateTextures",value:function(e){var t=this;return this._allTiles.some((function(r){return r.resetPendingUpdate(64)&&(t._renderer.updateTileTexture(r),t._usedMemory=QS,e.madeProgress()),e.done})),e.hasProgressed}},{key:"_updateClippingExtent",value:function(){if(!this.spatialReference)return!1;var e=Object(K.k)(),t=null;return Object(GO.b)(this.view.clippingArea,e,this.spatialReference)&&(t=e),!Object(K.n)(t,this._clippingExtent)&&(this._clippingExtent=t,this._renderer.clippingExtent=t,this.notifyChange("extent"),this.updateTileOverlayParams(),this.overlayManager.setOverlayPlacementDirty(),!0)}},{key:"_clippingChanged",value:function(){this._updateClippingExtent()&&this._updateRootTiles()}},{key:"lodBias",get:function(){var e=this.view.resourceController.memoryController.memoryFactor;return this.view.qualitySettings.tiledSurface.lodBias-(1-e)*Ps.g}},{key:"_getLodBiasCorrectedScale",value:function(e){var t=this.tilingScheme.levels,r=Object(m.e)(e-this.lodBias,0,t.length-1),n=r-Math.floor(r);return t[Math.floor(r)].scale*(1-n)+t[Math.ceil(r)].scale*n}},{key:"_removeAllTiles",value:function(){var e=this;this.rootTiles&&(this.rootTiles.forEach((function(t){return e._purgeTile(t)})),this._setRootTiles(null),this.notifyChange("ready")),this._allTiles.clear(),this.visible=!1}},{key:"_purgeChildTiles",value:function(e){if(e.isLeaf)return!1;var t=this._purgeTile(e.children[0]);return t=this._purgeTile(e.children[1])||t,t=this._purgeTile(e.children[2])||t,t=this._purgeTile(e.children[3])||t,e.unsetChildren(),t}},{key:"_purgeTile",value:function(e){var t=this._purgeChildTiles(e)||e.rendered;return this._allTiles.removeUnordered(e),e.unload(this._renderer),this._tilePool.release(e),t}},{key:"_splitTile",value:function(e){Object(aw.s)(e.isLeaf,"tile that is already split should not be split again!");var t=e.level+1,r=2*e.lij[1],n=2*e.lij[2];e.setChildren(this._createTile(t,r,n,e),this._createTile(t,r,n+1,e),this._createTile(t,r+1,n,e),this._createTile(t,r+1,n+1,e)),e.setPendingUpdate(16),e.updateAgentSuspension(),this._allTiles.pushArray(e.children),this._allTilesDirty=!0,this._emitTileScaleChange(e,t),++this._performanceInfo.numSplit}},{key:"_emitTileScaleChange",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.level;KS.spatialReference=this.spatialReference,KS.extent=e.extent,KS.scale=this._getLodBiasCorrectedScale(t),this.emit("scale-change",KS)}},{key:"_createTile",value:function(e,t,r,n){Object(aw.s)(!!n,"_createTile sanity check");var i=this._acquireTile(e,t,r,n);return i.updateClippingStatus(this._clippingExtent),i.loadable&&(i.updateScreenDepth(this._viewProjectionMatrix),2===i.shouldSplit(this._splitLimits,this._eyePosRenderSR,this.lodSnapping)&&i.setPendingUpdate(2)),i}},{key:"_mergeTile",value:function(e){Object(aw.s)(!e.hasPendingUpdate(2),"_mergeTile sanity check"),this._purgeChildTiles(e)&&(Object(aw.s)(!e.renderData,"_mergeTile sanity check"),this._loadTile(e)),this._allTilesDirty=!0,++this._performanceInfo.numMerged,this._emitTileScaleChange(e)}},{key:"_loadChildren",value:function(e){Object(aw.s)(e.rendered,"parent should be rendered"),e.unload(this._renderer),this._loadTile(e.children[0]),this._loadTile(e.children[1]),this._loadTile(e.children[2]),this._loadTile(e.children[3])}},{key:"_loadParent",value:function(e){var t=e.parent;this._unloadChildren(t),this._loadTile(t)}},{key:"_unloadChildren",value:function(e){e.isLeaf||(this._unloadChildren(e.children[0]),e.children[0].unload(this._renderer),this._unloadChildren(e.children[1]),e.children[1].unload(this._renderer),this._unloadChildren(e.children[2]),e.children[2].unload(this._renderer),this._unloadChildren(e.children[3]),e.children[3].unload(this._renderer))}},{key:"_loadTile",value:function(e){e.load(this._renderer),e.setPendingUpdate(16),this.requestUpdate(),this.overlayManager&&this.overlayManager.hasOverlays&&this.overlayManager.setTileParameters(e),this._elevationUpdate(e)}},{key:"_elevationDataArrived",value:function(e,t,r){var n=new nx(e.lij,e.extent,r);e.dataArrived(t,0,n);var i=[e],a=e.level,o=this._iteratorPool.acquire();for(o.reset(i);!o.done;){var s=o.next();s.findElevationBoundsForLayer(t,a),s.computeElevationBounds()}o.remove(),this._updateTileVisibility(i)}},{key:"_handleLayerViewChanges",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Og.d;if(this._layerViewsDirty){this._layerViewsDirty=!1;var r,n=!1,a=new Set,o=-1,s=Object(i.a)(this.view.allLayerViews.items);try{for(s.s();!(r=s.n()).done;){var c=r.value;if(a.add(c.uid),Object(aw.j)(c))if(this._basemapLayerViewHandles.has(c.uid)){var l=this.layerClassFromLayerView(c),u=this._layerIndexByUid[l].get(c.uid);u<o&&(n=!0),o=u}else this._registerTiledLayerView(c),c.layer.loaded&&(n=!0)}}catch(d){s.e(d)}finally{s.f()}this._basemapLayerViewHandles.forEach((function(t,r){a.has(r)||(e._unregisterTiledLayerView(r),n=!0)})),n&&this._updateTiledLayers(),this._renderer.isTransparent=this._allTransparentSurfaceLayers(),t.madeProgress()}}},{key:"_allTransparentSurfaceLayers",value:function(){var e,t=0===this.view.map.ground.opacity,r=Object(i.a)(this.view.allLayerViews.items);try{for(r.s();!(e=r.n()).done;){var n=e.value;if(Object(aw.j)(n)&&!Object(aw.e)(n)&&!Object(ne.b)(n.layer)&&0!==n.fullOpacity)return t=!1}}catch(a){r.e(a)}finally{r.f()}return t}},{key:"layerClassFromLayerView",value:function(e){return Object(aw.e)(e)?0:1}},{key:"_registerTiledLayerView",value:function(e){var t=this,r=[],n=this.layerClassFromLayerView(e);r.push(e.watch("suspended",(function(){return t._updateTiledLayers()}))),r.push(e.watch("fullOpacity",(function(){return t._updateTileTextures(!1)}))),r.push(e.layer.watch("scaleRangeId",(function(){return t._restartAllAgents(n)}))),e.on("data-changed",(function(){var r=t._layerIndexByUid[n].get(e.uid);null!=r&&t._invalidateLayerData(r,n)})),this._basemapLayerViewHandles.set(e.uid,r)}},{key:"_unregisterTiledLayerView",value:function(e){var t=this._basemapLayerViewHandles.get(e);if(t){for(var r=0;r<t.length;r++)t[r].remove();this._basemapLayerViewHandles.delete(e)}}},{key:"_updateTiledLayers",value:function(){var e=this;if(this.tilingScheme&&!this.view.suspended){var t=this.view.allLayerViews,r=[[],[]],n=null,a=Object(K.m)();t.forEach((function(t){var i=t.layer;if(i&&!t.suspended&&Object(aw.j)(t)){var o=t.fullExtent;if(o)if(e.tilingScheme.compatibleWith(t.tileInfo)){Object(K.o)(a,o);var s=e.layerClassFromLayerView(t);if(1===s){var c=t.displayLevelRange;c.maxLevel!==1/0&&(null===n||c.maxLevel>n)&&(n=c.maxLevel)}r[s].push(t)}else BS.warn("Terrain: tiling scheme of layer "+i.id+" is incompatible with other tiled layers, will not be drawn");else BS.warn("Terrain: Map or elevation layer does not have fullExtent: "+i.id)}}));var o,s=Object(i.a)(Ps.f);try{for(s.s();!(o=s.n()).done;){var c=o.value,l=this._layerViews[c],u=r[c];u.reverse();var d=u.length,h=l.length!==d,f=new Array(d),p=new Array(l.length);this._layerIndexByUid[c].clear();for(var b=0;b<d;b++){var v=u[b].uid;this._layerIndexByUid[c].set(v,b);var m=l.indexOf(u[b]);f[b]=m,b!==m&&(h=!0),m>-1&&(p[m]=b)}if(h){var y=this._postorderIterator;for(y.reset(this.rootTiles);!y.done;)y.next().modifyLayers(p,f,c);this._layerViews[c]=u,this._restartAllAgents(c),this._updateTileVisibility(this.rootTiles)}}}catch(g){s.e(g)}finally{s.f()}this.tilingScheme.ensureMaxLod(n)&&this._viewChangeUpdate()}}},{key:"_restartAllAgents",value:function(e){var t=this._postorderIterator;for(t.reset(this.rootTiles);!t.done;){var r=t.next();r.restartAgents(e),0===e&&r.computeElevationBounds()}}},{key:"_hasFixedExtent",value:function(){return!!this._clippingExtent}},{key:"layerViewByIndex",value:function(e,t){return this._layerViews[t][e]}},{key:"numLayers",value:function(e){return this._layerViews[e].length}},{key:"_updateTileTextures",value:function(e){var t=this;this._allTiles.forAll((function(r){r.updateAgents(1),e?t.renderer.updateTileTexture(r):r.updateRenderData(1)})),this._renderer.isTransparent=this._allTransparentSurfaceLayers()}},{key:"_invalidateLayerData",value:function(e,t){this._allTiles.forAll((function(r){return r.removeLayerAgent(e,t)})),this._allTiles.forAll((function(r){return r.invalidateLayerData(e,t)}))}},{key:"setTileTreeDirty",value:function(){this._allTilesDirty=!0}},{key:"requestRender",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;this.renderer.setNeedsRender(e)}},{key:"requestUpdate",value:function(){1==++this._pendingUpdates&&(this._hasPendingUpdates=!0)}},{key:"requestTileData",value:function(e,t,r,n){var i=this,a=this.layerViewByIndex(t,r),o=a.layer;return!o.tilemapCache||Object(aw.n)(a)?this._requestTileData(e,r,a,n):(++this._asyncWorkItems,o.tilemapCache.fetchAvailability(e.lij[0],e.lij[1],e.lij[2],Object(ie.a)(Object(ie.a)({},n),{},{timeout:6e3})).then((function(){return--i._asyncWorkItems})).catch((function(t){throw--i._asyncWorkItems,Object(q.n)(t)||i._dataMissing(e,r,a,{notInTilemap:!0}),t})).then((function(){return i._frameTask.schedule((function(){return i._requestTileData(e,r,a,n)}),n.signal)})))}},{key:"_requestTileData",value:function(e,t,r,n){return 0===t?this._requestElevationTileData(e,r,n):this._requestMapTileData(e,r,n)}},{key:"_requestElevationTileData",value:function(e,t,r){var n=this;if(Object(aw.e)(t)){var i=function(i){if(--n._asyncWorkItems,!Object(q.o)(r)){var a=n._layerIndexByUid[0].get(t.uid);null!=a?(n._usedMemory=QS,n.requestUpdate(),n._elevationDataArrived(e,a,i)):BS.warn("TerrainSurface: received data from unknown layer %d %s",0,e.lij.toString())}},a=function(r){--n._asyncWorkItems,Object(q.n)(r)||(n._dataMissing(e,0,t,r),n.requestUpdate())};if(++this._asyncWorkItems,Object(aw.r)(t.layer))return t.layer.fetchTile(e.lij[0],e.lij[1],e.lij[2],{noDataValue:Ps.c,signal:r.signal}).then((function(e){if(Object(q.o)(r))return BS.warnOnce("A call to fetchTile resolved even though the request was aborted. fetchTile should not resolve if options.signal.aborted is true."),void a(Object(q.f)());n._frameTask.schedule((function(){return i(e)}),r.signal)}),a);var o=t.getTileUrl(e.lij[0],e.lij[1],e.lij[2]);return this._elevationDataRequester.request(o,"binary",r).then((function(e){return n._lercDecoder.decode(e,{noDataValue:Ps.c},r.signal)})).then((function(e){i({values:e.pixelData,width:e.width,height:e.height,noDataValue:e.noDataValue,minValue:e.minValue,maxValue:e.maxValue})}),a)}Object(aw.s)(!1,"_requestElevationTileData can only be called for elevation layer views")}},{key:"_requestMapTileData",value:function(e,t,r){var n=this;if(t instanceof ex.default)return Promise.reject();++this._asyncWorkItems;var i=function(i,a){--n._asyncWorkItems,Object(aw.p)(a),Object(q.o)(r)||(n._dataMissing(e,1,t,i),n.requestUpdate())},a=function(e){return function(t){return i(t,e)}},o=function(i){return n._frameTask.schedule((function(){--n._asyncWorkItems,n.requestUpdate(),Object(q.o)(r)?Object(aw.p)(i):n._mapTileDataArrived(e,t,i)}),r.signal,a(i)).catch(a(i))},s=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return n._frameTask.schedule((function(){return i(e,t)})).catch(a(t))};if(Object(aw.n)(t)){var c=t.schemaHelper.getLevelRowColumn(e.lij);return t.fetchTile(c[0],c[1],c[2],r).then(o,s)}if(Object(aw.f)(t))return t.fetchTile(e.lij[0],e.lij[1],e.lij[2],r).then(o,s);if(Object(aw.l)(t)&&Object(aw.r)(t.layer))return t.layer.fetchTile(e.lij[0],e.lij[1],e.lij[2],r).then((function(e){if(Object(q.o)(r))return BS.warnOnce("A call to fetchTile resolved even though the request was aborted. fetchTile should not resolve if options.signal.aborted is true."),void s(Object(q.f)());o(e)}),s);var l=t.getTileUrl(e.lij[0],e.lij[1],e.lij[2]);(function(e){return null!=e.refreshInterval})(t)&&t.refreshTimestamp&&(l+="".concat(l.indexOf("?")>-1?"&":"?","_ts=").concat(t.refreshTimestamp));var u=t.hasMixedImageFormats?"image+type":"image";return this._mapDataRequester.request(l,u,r).then(o,s)}},{key:"_mapTileDataArrived",value:function(e,t,r){var n=this._layerIndexByUid[1].get(t.uid);null!=n?e.dataArrived(n,1,r):(Object(aw.p)(r),BS.warn("TerrainSurface: received data from unknown layer"))}},{key:"_dataMissing",value:function(e,t,r,n){var i=this._layerIndexByUid[t].get(r.uid);null!=i?e.dataMissing(i,t,n):BS.warn("TerrainSurface: received data from unknown layer")}},{key:"updateTileOverlayParams",value:function(){var e=this;this.rootTiles&&this.overlayManager&&(this._allTiles.forAll((function(t){t.renderData&&e.overlayManager.setTileParameters(t)})),this._renderer.setNeedsRender())}},{key:"updateOverlayOpacity",value:function(){if(this.overlayManager){var e=this._eyePosSurfaceSR[2],t=this.overlayManager.computeOpacity(e);this._overlayOpacity!==t&&(this._overlayOpacity=t,this._renderer.overlayOpacity=t,this._renderer.setNeedsRender())}}},{key:"performanceInfo",get:function(){var e=this._performanceInfo;return e.numNodes=this._allTiles.length,e.numLeaves=e.numVisible=e.numRendered=e.numLoadedPerLevel.length=e.numRenderedPerLevel.length=0,this._allTiles.forAll((function(t){t.isLeaf&&e.numLeaves++;var r=t.level;t.renderData&&(e.numLoadedPerLevel[r]=(e.numLoadedPerLevel[r]||0)+1),t.visible&&(e.numVisible++,t.rendered&&(e.numRenderedPerLevel[r]=(e.numRenderedPerLevel[r]||0)+1,e.numRendered++))})),e}},{key:"getUsedMemory",value:function(){var e=this;return this.tilingScheme?(this._usedMemory===QS&&(this._usedMemory=0,this._allTiles.forAll((function(t){return e._usedMemory+=t.usedMemory}))),this._usedMemory):0}},{key:"getUsedMemoryForLayerView",value:function(e){var t=0,r=this.layerClassFromLayerView(e),n=this._layerIndexByUid[r].get(e.uid);return this._allTiles.forAll((function(e){return t+=e.getUsedMemoryForLayer(r,n)})),t}},{key:"getTile",value:function(e){if(Object(I.i)(e))return null;var t=e.split("/").map((function(e){return+e}));if(0===t[0])return this.rootTiles.find((function(e){return e.lij[1]===t[1]&&e.lij[2]===t[2]}));var r,n=Math.pow(2,t[0]),i=Math.floor(t[1]/n),a=Math.floor(t[2]/n);if(this.rootTiles.some((function(e){return e.lij[1]===i&&e.lij[2]===a&&(r=e,!0)})),r){for(var o=1<<t[0]-1;r.lij[0]<t[0];){var s=t[1]&o?2:0;if((t[2]&o)>0&&s++,!r.children[s])return null;r=r.children[s],o>>=1}return Object(aw.s)(r.lij[0]===t[0]&&r.lij[1]===t[1]&&r.lij[2]===t[2],"not the right tile?"),r}return null}},{key:"test",get:function(){var e=this;return{renderer:e._renderer,lercDecoder:e._lercDecoder,forceReload:function(){e._mergeTile(e.rootTiles[0]),e._viewChangeUpdate()},getTiles:function(){return e._allTiles.toArray()},getRenderedTiles:function(){return $S.clear(),e._allTiles.forAll((function(e){e.visible&&e.rendered&&$S.push(e)})),Object(Vx.g)(e.renderOrder,$S),$S.toArray()}}}}]),n}(Ii.a.EventedMixin(de.a));Object(b.a)([Object(y.b)()],GS.prototype,"_renderer",void 0),Object(b.a)([Object(y.b)()],GS.prototype,"_hasPendingUpdates",void 0),Object(b.a)([Object(y.b)()],GS.prototype,"_asyncWorkItems",void 0),Object(b.a)([Object(y.b)()],GS.prototype,"_allTilesDirty",void 0),Object(b.a)([Object(y.b)()],GS.prototype,"_allTilesSorted",void 0),Object(b.a)([Object(y.b)()],GS.prototype,"_viewChanged",void 0),Object(b.a)([Object(y.b)({readOnly:!0})],GS.prototype,"_watchUpdatingTracking",void 0),Object(b.a)([Object(y.b)()],GS.prototype,"_frameTask",void 0),Object(b.a)([Object(y.b)({readOnly:!0})],GS.prototype,"snapLevel",null),Object(b.a)([Object(y.b)({readOnly:!0})],GS.prototype,"lodSnapping",null),Object(b.a)([Object(y.b)({constructOnly:!0})],GS.prototype,"view",void 0),Object(b.a)([Object(ye.a)("_renderer.cullBackFaces")],GS.prototype,"cullBackFaces",void 0),Object(b.a)([Object(y.b)({readOnly:!0,dependsOn:[]})],GS.prototype,"extent",null),Object(b.a)([Object(y.b)({readOnly:!0})],GS.prototype,"updating",null),Object(b.a)([Object(y.b)(tx.a)],GS.prototype,"updatingProgress",void 0),Object(b.a)([Object(y.b)({readOnly:!0})],GS.prototype,"updatingProgressValue",null),Object(b.a)([Object(y.b)()],GS.prototype,"_maxNumUpdating",void 0),Object(b.a)([Object(y.b)({aliasOf:"view.map.ground.opacity"})],GS.prototype,"baseOpacity",void 0),Object(b.a)([Object(y.b)({readOnly:!0})],GS.prototype,"overlayManager",void 0),Object(b.a)([Object(y.b)({readOnly:!0})],GS.prototype,"viewingMode",null),Object(b.a)([Object(y.b)()],GS.prototype,"maxTextureScale",void 0),Object(b.a)([Object(y.b)({readOnly:!0})],GS.prototype,"ready",null),Object(b.a)([Object(y.b)({value:1})],GS.prototype,"renderOrder",null),Object(b.a)([Object(y.b)({readOnly:!0})],GS.prototype,"rootTiles",void 0),Object(b.a)([Object(y.b)({readOnly:!0})],GS.prototype,"spatialReference",null),Object(b.a)([Object(y.b)()],GS.prototype,"backgroundImage",void 0),Object(b.a)([Object(y.b)({type:Il.a,aliasOf:"view.map.ground.surfaceColor"})],GS.prototype,"backgroundColor",void 0),Object(b.a)([Object(y.b)()],GS.prototype,"_background",null),Object(b.a)([Object(y.b)({value:!1})],GS.prototype,"slicePlaneEnabled",null),Object(b.a)([Object(y.b)({readOnly:!0})],GS.prototype,"tilingScheme",void 0),Object(b.a)([Object(y.b)({readOnly:!0,aliasOf:"tilingSchemeLogic.tilingSchemeLocked"})],GS.prototype,"tilingSchemeLocked",void 0),Object(b.a)([Object(y.b)({readOnly:!0,aliasOf:"tilingSchemeLogic.tilingSchemeDone"})],GS.prototype,"tilingSchemeDone",void 0),Object(b.a)([Object(y.b)({readOnly:!0})],GS.prototype,"tilingSchemeLogic",void 0),Object(b.a)([Object(y.b)({value:!0})],GS.prototype,"velvetOverground",null),Object(b.a)([Object(ye.a)("_renderer.wireframe")],GS.prototype,"wireframe",void 0),Object(b.a)([Object(y.b)({value:!1})],GS.prototype,"suspended",null),Object(b.a)([Object(y.b)({readOnly:!0,aliasOf:"view.qualitySettings.tiledSurface.textureFadeDuration"})],GS.prototype,"textureFadeDuration",void 0),Object(b.a)([Object(y.b)()],GS.prototype,"_layerViewsDirty",void 0),Object(b.a)([Object(ye.a)("_renderer.renderPatchBorders")],GS.prototype,"renderPatchBorders",void 0),Object(b.a)([Object(ye.a)("_renderer.renderingDisabled")],GS.prototype,"renderingDisabled",void 0);var qS=GS=Object(b.a)([Object(w.a)("esri.views.3d.terrain.TerrainSurface")],GS);function HS(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]}function WS(e){return!e.isLeaf&&(e.children[0].shouldLoad||e.children[1].shouldLoad||e.children[2].shouldLoad||e.children[3].shouldLoad||WS(e.children[0])||WS(e.children[1])||WS(e.children[2])||WS(e.children[3]))}var QS=-1,ZS=Object($l.e)(),XS=Object(K.k)(),YS=[0,0,0],$S=new zy.a,JS={spatialReference:null,tile:null,extent:null,context:"ground"},KS={spatialReference:null,extent:null,scale:0},eT=qS,tT=r(119),rT=r(398),nT=r(336),iT=function(e){Object(f.a)(r,e);var t=Object(p.a)(r);function r(e){var n;return Object(c.a)(this,r),(n=t.call(this,e))._residentGeomRecords=new Map,n._dirtyGeomRecords=new Map,n.dirty=!1,n}return Object(l.a)(r,[{key:"commit",value:function(e){var t=this;this.dirty=!1,this._dirtyGeomRecords.forEach((function(r,n){return t.commitLayer(n,e)}))}},{key:"commitLayer",value:function(e,t){var r=this,n=this._dirtyGeomRecords.get(e);n&&(n.forEach((function(n,i){var a=r._ensureGeomRecord(e,i);n.forEach((function(e,n){var o=e[0],s=e[1],c=e[2],l=!1;if(2&s){var u=a.get(n);if(u){var d=u[1];if(4&c){var h=r.model.getObject(i);r.model.updateRenderGeometryTransformation(h,o,d)&&(l=!0)}l||t.updates.push({renderGeometry:d,updateType:c})}else Object(qu.a)(!1,"ModelDirtySet.getAddRemoveListFilteredByLayers: invalid update")}if(4&s||l){var f=a.get(n);f?(t.removes.push(f[1]),a.delete(n),f[0].disposed&&nT.a.pool.release(f[0])):4===s&&Object(qu.a)(!1,"ModelDirtySet.getAddRemoveListFilteredByLayers: invalid remove")}if(1&s||l){var p=r.model.getObject(i),b=r.model.getRenderGeometry(p,o),v=[o,b];t.adds.push(b),a.set(n,v)}})),0===a.size&&r._residentGeomRecords.get(e).delete(i)})),0===this._residentGeomRecords.get(e).size&&this._residentGeomRecords.delete(e),this._dirtyGeomRecords.delete(e))}},{key:"getResidentRenderGeometries",value:function(e,t){var r=this._residentGeomRecords.get(e);r&&r.forEach((function(e){return e.forEach((function(e){return t.push(e[1])}))}))}},{key:"_objectStateChanged",value:function(e,t){var r,n=Object(i.a)(t.geometryRecords);try{for(n.s();!(r=n.n()).done;){var a=r.value;this._updateOrCreateDirtyRecord(t,a,null,2,0,0,2,5,e)}}catch(o){n.e(o)}finally{n.f()}}},{key:"visibilityChanged",value:function(e){this._objectStateChanged(1,e)}},{key:"highlightChanged",value:function(e){this._objectStateChanged(8,e)}},{key:"occlusionChanged",value:function(e){this._objectStateChanged(16,e)}},{key:"vertexAttrsUpdated",value:function(e){this._updateOrCreateDirtyRecord(e.object,e.record,null,2,0,0,2,5,2)}},{key:"layerAdded",value:function(e){var t=this;e.objects.forAll((function(r){return t._layerObjectAdded(e,r)}))}},{key:"layerRemoved",value:function(e){var t=this;e.objects.forAll((function(r){return t._layerObjectRemoved(e,r)}))}},{key:"layerObjectAdded",value:function(e){this._layerObjectAdded(e.layer,e.object)}},{key:"_layerObjectAdded",value:function(e,t){for(var r=e.id,n=t.geometryRecords,i=0;i<n.length;i++)this._objectGeometryAdded(t,n[i],r)}},{key:"layerObjectRemoved",value:function(e){this._layerObjectRemoved(e.layer,e.object)}},{key:"layerObjectsAdded",value:function(e){var t,r=Object(i.a)(e.objects);try{for(r.s();!(t=r.n()).done;){var n=t.value;this._layerObjectAdded(e.layer,n)}}catch(a){r.e(a)}finally{r.f()}}},{key:"layerObjectsRemoved",value:function(e){var t,r=Object(i.a)(e.objects);try{for(r.s();!(t=r.n()).done;){var n=t.value;this._layerObjectRemoved(e.layer,n)}}catch(a){r.e(a)}finally{r.f()}}},{key:"_layerObjectRemoved",value:function(e,t){for(var r=e.id,n=t.geometryRecords,i=0;i<n.length;i++)this._objectGeometryRemoved(t,n[i],r)}},{key:"shaderTransformationChanged",value:function(e){var t=this,r=this._residentGeomRecords.get(e.id);r&&r.forEach((function(e,r){var n=t.model.getObject(r);n&&n.hasVolativeTransformation()&&e.forEach((function(e){e[1].shaderTransformationChanged()}))}))}},{key:"objectTransformation",value:function(e){var t=this,r=this._getParentLayerId(e),n=e.id;this._ensureGeomRecord(r,n).forEach((function(n){t._updateOrCreateDirtyRecord(e,n[0],r,2,0,0,2,5,4)}))}},{key:"objectGeometryAdded",value:function(e){this._objectGeometryAdded(e.object,e.record)}},{key:"_objectGeometryAdded",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;this._updateOrCreateDirtyRecord(e,t,r,1,4,0,0,0)}},{key:"objectGeometryRemoved",value:function(e){this._objectGeometryRemoved(e.object,e.record)}},{key:"_objectGeometryRemoved",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;this._updateOrCreateDirtyRecord(e,t,r,4,1,2,0,0)}},{key:"_updateOrCreateDirtyRecord",value:function(e,t,r,n,i,a,o,s,c){r=Object(I.t)(r,this._getParentLayerId(e));var l=e.id,u=t.id,d=this._ensureDirtyRecord(r,l),h=d.get(u);if(h){var f=h[1];f&i?(d.delete(u),h[0].disposed&&nT.a.pool.release(h[0])):f&a?(h[1]=n,h[2]=c):f&o?h[2]|=c:f&s||Object(qu.a)(!1,"ModelDirtySet.objectGeometryAdded: inconsistent state")}else d.set(u,[t,n,c]);this.dirty=this._hasDirtyGeometryRecords}},{key:"_ensureGeomRecord",value:function(e,t){var r=this._residentGeomRecords.get(e);r||(r=new Map,this._residentGeomRecords.set(e,r));var n=r.get(t);return n||(n=new Map,r.set(t,n)),n}},{key:"_hasDirtyGeometryRecords",get:function(){return Object(Qs.b)(this._dirtyGeomRecords,(function(e){return Object(Qs.b)(e,(function(e){return e&&e.size>0}))}))}},{key:"_ensureDirtyRecord",value:function(e,t){var r=this._dirtyGeomRecords.get(e);r||(r=new Map,this._dirtyGeomRecords.set(e,r));var n=r.get(t);return n||(n=new Map,r.set(t,n)),n}},{key:"_getParentLayerId",value:function(e){return Object(I.j)(e.parentLayer)?e.parentLayer.id:$g.a}},{key:"formatDebugInfo",value:function(){var e=["ADD","UPD",void 0,"REM"],t="";return this._dirtyGeomRecords.forEach((function(r,n){r.forEach((function(r,i){t.length>0&&(t+="\n"),t+=n+"."+i;var a=[];r.forEach((function(e){var t=e[1];a[t]||(a[t]=[]),a[t].push(e[0].geometry.id)}));for(var o=0;o<a.length;o++)if(a[o]){t+=" "+e[o-1]+": ";for(var s=0;s<a[o].length;s++)t+=a[o][s]+", "}}))})),t}},{key:"test",get:function(){var e=this;return{get residentLayerCount(){return e._residentGeomRecords.size},get residentObjectCount(){return Array.from(e._residentGeomRecords.values()).reduce((function(e,t){return e+t.size}),0)}}}}]),r}(de.a);Object(b.a)([Object(y.b)({constructOnly:!0})],iT.prototype,"model",void 0),Object(b.a)([Object(y.b)()],iT.prototype,"dirty",void 0);var aT=iT=Object(b.a)([Object(w.a)("esri.views.3d.webgl-engine.lib.ModelDirtySet")],iT),oT=r(262),sT=qu.a,cT=qu.h,lT=function(e){Object(f.a)(r,e);var t=Object(p.a)(r);function r(){var e;return Object(c.a)(this,r),(e=t.call(this)).dirtySet=new aT({model:Object(u.a)(e)}),e._id2origin=new Map,e._content=new Map,e}return Object(l.a)(r,[{key:"getObject",value:function(e){return this._content.get(e)}},{key:"add",value:function(e){var t=e.id;sT(!this._content.has(t),"Model/Stage already contains object to be added"),this._content.set(t,e),Object(iO.b)(e)&&this.dirtySet.layerAdded(e)}},{key:"remove",value:function(e){sT(this._content.has(e.id),"Model/Stage doesn't contain object to be removed"),this._content.delete(e.id),e.unload(),Object(iO.b)(e)&&this.dirtySet.layerRemoved(e)}},{key:"addMany",value:function(e){var t,r=Object(i.a)(e);try{for(r.s();!(t=r.n()).done;){var n=t.value;sT(!this._content.has(n.id),"Model/Stage already contains object to be added"),this._content.set(n.id,n)}}catch(a){r.e(a)}finally{r.f()}}},{key:"removeMany",value:function(e){var t,r=Object(i.a)(e);try{for(r.s();!(t=r.n()).done;){var n=t.value;sT(this._content.has(n.id),"Model/Stage doesn't contain object to be removed"),this._content.delete(n.id),n.unload()}}catch(a){r.e(a)}finally{r.f()}}},{key:"forEachOfType",value:function(e,t){this._content.forEach((function(r){r.type===e&&t(r)}))}},{key:"_getOrigin",value:function(e){var t=0,r=10*e[3]/1e4;r>1&&(t=Math.ceil(cT(r,2)));var n=1e4*Math.pow(2,t),i=Math.round(e[0]/n),a=Math.round(e[1]/n),o=Math.round(e[2]/n),s=t+"_"+i+"_"+a+"_"+o,c=this._id2origin.get(s);return null==c&&(c=Object(cx.a)(i*n,a*n,o*n,s),this._id2origin.set(s,c)),c}},{key:"getRenderGeometry",value:function(e,t){var r=t.geometry,n=t.material,i=t.id,a=t.shaderTransformation,o=t.origin,s=t.instanceParameters,c=new oT.a(r,n,null,null,i,r.boundingInfo,a,e.castShadow);return c.updateTransformation((function(r){return e.getCombinedStaticTransformation(t,r)})),c.origin=o||this._getOrigin(c.boundingSphere),c.instanceParameters=s,c}},{key:"updateRenderGeometryTransformation",value:function(e,t,r){r.updateTransformation((function(r){return e.getCombinedStaticTransformation(t,r)}));var n=this._getOrigin(r.boundingSphere);return r.origin!==n}},{key:"getStats",value:function(){for(var e={},t=Array.from(this._content.values()),r=function(r){e[r]=t.filter((function(e){return e.type===r})).length},n=0;n<5;++n)r(n);return{contentTypes:e,dirtySet:this.dirtySet.formatDebugInfo()}}},{key:"test",get:function(){return{content:Array.from(this._content.values())}}}]),r}(de.a);Object(b.a)([Object(y.b)({constructOnly:!0})],lT.prototype,"dirtySet",void 0),lT=Object(b.a)([Object(w.a)("esri.views.3d.webgl-engine.parts.Model")],lT);var uT=r(424),dT=r(414),hT=r(94),fT=function(){function e(t){Object(c.a)(this,e),this._totalCount=t,this._indexRanges=[0,t]}return Object(l.a)(e,[{key:"componentCount",value:function(){for(var e=this._indexRanges,t=0,r=0;r<e.length;r+=2)t+=e[r+1];return t}},{key:"reset",value:function(e){"all"===e||e.length===this._totalCount?this._indexRanges=[0,this._totalCount]:this._indexRanges=function(e){var t=new Array;if(0===e.length)return t;for(var r=e[0],n=1,i=1;i<e.length;i++){var a=e[i];r+n===a?n+=1:(t.push(r),t.push(n),r=a,n=1)}return t.push(r),t.push(n),t}(e)}},{key:"forEachComponent",value:function(e){for(var t=this._indexRanges,r=0;r<t.length;r+=2)for(var n=t[r],i=n+t[r+1],a=n;a<i;a++)if(!e(a))return!1;return!0}},{key:"forEachComponentRange",value:function(e){for(var t=this._indexRanges,r=0;r<t.length;r+=2){var n=t[r];if(!e(n,n+t[r+1]))return!1}return!0}},{key:"computeOffsetRanges",value:function(e){for(var t=new Array(this._indexRanges.length),r=this._indexRanges,n=0;n<r.length;n+=2){var i=r[n],a=i+r[n+1],o=e[i],s=e[a];t[n]=o,t[n+1]=s-o}return t}}]),e}();var pT=function(e){Object(f.a)(r,e);var t=Object(p.a)(r);function r(e,n){var i;Object(c.a)(this,r),(i=t.call(this)).pickability=null,i.highlightCounts=null,i.cachedGeometryRanges=null,i.cachedHighlightRanges=null,i.cachedDefaultRanges=null,i.offsets=Object(hT.m)(n);var a=i.count;i.visibility=new fT(a),i.materialDataBuffer=e.getBuffer(a),i.materialDataIndices=new Uint16Array(a);for(var o=0;o<a;o++)i.materialDataIndices[o]=i.materialDataBuffer.acquireIndex();return i}return Object(l.a)(r,[{key:"dispose",value:function(){Object(d.a)(Object(h.a)(r.prototype),"dispose",this).call(this);for(var e=0;e<this.count;e++)this.materialDataBuffer.releaseIndex(this.materialDataIndices[e])}},{key:"count",get:function(){return this.offsets.length-1}},{key:"geometryRanges",get:function(){return Object(I.i)(this.cachedGeometryRanges)&&(this.cachedGeometryRanges=this.visibility.computeOffsetRanges(this.offsets)),this.cachedGeometryRanges}},{key:"highlightRanges",get:function(){return Object(I.i)(this.highlightCounts)?null:(this.updateCachedHighlightRanges(),this.cachedHighlightRanges)}},{key:"defaultShadowMapRanges",get:function(){return Object(I.i)(this.highlightCounts)?this.geometryRanges:(this.updateCachedHighlightRanges(),this.cachedDefaultRanges)}},{key:"highlightsDirty",value:function(){this.cachedHighlightRanges=null,this.cachedDefaultRanges=null}},{key:"visibilityDirty",value:function(){this.cachedGeometryRanges=null,this.highlightsDirty()}},{key:"updateCachedHighlightRanges",value:function(){if((Object(I.i)(this.cachedHighlightRanges)||Object(I.i)(this.cachedDefaultRanges))&&Object(I.j)(this.highlightCounts)){var e=function(e,t,r){var n=[],i=[],a=r.length,o=r.length;return t.forEachComponent((function(t){return e[t]>0?(a!==t-1&&(n.length&&n.push(r[a+1]-n[n.length-1]),n.push(r[t])),a=t):(o!==t-1&&(i.length&&i.push(r[o+1]-i[i.length-1]),i.push(r[t])),o=t),!0})),n.length&&n.push(r[a+1]-n[n.length-1]),i.length&&i.push(r[o+1]-i[i.length-1]),{highlightRanges:n,defaultRanges:i}}(this.highlightCounts,this.visibility,this.offsets),t=e.highlightRanges,r=e.defaultRanges;this.cachedHighlightRanges=t,this.cachedDefaultRanges=r}}}]),r}(tT.a);var bT=function(e){Object(f.a)(r,e);var t=Object(p.a)(r);function r(){var e;return Object(c.a)(this,r),(e=t.apply(this,arguments))._bucket=null,e._bucketIndex=0,e}return Object(l.a)(r,[{key:"bucketKey",get:function(){return this._bucket.key}}]),r}(tT.a),vT=function(){function e(){Object(c.a)(this,e),this._buckets=new Map}return Object(l.a)(e,[{key:"add",value:function(e,t){var r=this._getBucket(e);t._bucket=r,t._bucketIndex=r.count,r.data.push(t),++r.statistics.added}},{key:"remove",value:function(e){++e._bucket.statistics.removed;var t=e._bucket.data,r=t[t.length-1];t[e._bucketIndex]=r,r._bucketIndex=e._bucketIndex,t.pop(),e._bucket=null,e._bucketIndex=0}},{key:"updateKey",value:function(e,t){this.remove(e),this.add(t,e)}},{key:"getBucket",value:function(e){return this._getBucket(e).data}},{key:"getPerformanceInfo",value:function(e){return this._getBucket(e).statistics}},{key:"forEach",value:function(e){this._buckets.forEach((function(t){return e(t.data,t.key)}))}},{key:"count",get:function(){var e=0;return this._buckets.forEach((function(t){return e+=t.count})),e}},{key:"_getBucket",value:function(e){var t=this._buckets.get(e);if(t)return t;var r=new mT(e);return this._buckets.set(e,r),r}}]),e}(),mT=function(){function e(t){Object(c.a)(this,e),this.key=t,this.data=new Array,this.statistics={added:0,removed:0}}return Object(l.a)(e,[{key:"count",get:function(){return this.data.length}}]),e}(),yT=function(e){Object(f.a)(r,e);var t=Object(p.a)(r);function r(){return Object(c.a)(this,r),t.apply(this,arguments)}return Object(l.a)(r,[{key:"visible",get:function(){return!!(1&this.bucketKey)}}]),r}(bT);Object(b.a)([Object(tT.c)()],yT.prototype,"renderable",void 0),Object(b.a)([Object(tT.c)()],yT.prototype,"components",void 0);var gT=yT,OT=1e-6;var jT=function e(t,r,n,i,a){Object(c.a)(this,e),this.aabb=t,this.axis=r,this.d=n,this.midStartIndex=i,this.rightStartIndex=a},_T=function(){function e(t,r,n,i){var a=this;Object(c.a)(this,e),this.globalTriangleVertexIndices=t,this.firstTriangleIndex=r,this.positionAttribute=i,this.bspNodeTree=new Array,this.vertexPositionBuffer=i.data,this.vertexPositionStride=i.stride;var o=n-r,s=o<=ST?new Uint16Array(o):new Uint32Array(o);this.indices=s;for(var l=0;l<o;++l)s[l]=l;var u=function(e,t,r,n,i){for(var a=r-t,o=new Float32Array(6*a),s=0;s<a;++s)for(var c=3*(s+t),l=e[c+0]*i,u=e[c+1]*i,d=e[c+2]*i,h=0;h<3;++h){var f=n[l+h],p=n[u+h],b=n[d+h];o[6*s+h]=Math.min(f,p,b),o[6*s+3+h]=Math.max(f,p,b)}return o}(t,r,n,i.data,i.stride);(function e(t,r,n){var i=function(e,t,r,n){if(n<=r)return Object(Eg.t)(NaN,NaN,NaN,NaN,NaN,NaN);for(var i=6*e[r],a=0;a<3;++a)xT[a]=t[i+0+a],kT[a]=t[i+3+a];for(var o=r+1;o<n;++o)for(var s=6*e[o],c=0;c<3;++c)xT[c]=Math.min(xT[c],t[s+0+c]),kT[c]=Math.max(kT[c],t[s+3+c]);return Object(Eg.t)(xT[0],xT[1],xT[2],kT[0],kT[1],kT[2])}(s,u,t,r),o=r-t;if(o<=20){var c=new jT(i,void 0,0,t,r);return a.bspNodeTree.push(c),c}var l=function(e){var t=e[3]-e[0],r=e[4]-e[1],n=e[5]-e[2],i=t>r?t>n?0:r>n?1:2:r>n?1:n>t?2:0;return{axis:i,midValue:(e[i]+e[i+3])/2}}(i),d=l.axis,h=l.midValue,f=function(e,t,r,n,i,a){for(var o=r,s=n;o<s;){var c=e[o];t[6*c+i+3]<=a?++o:(--s,e[o]=e[s],e[s]=c)}var l=o;for(s=n;l<s;){var u=e[s-1];t[6*u+i]>=a?--s:(e[s-1]=e[l],e[l]=u,++l)}return{next:o,mid:l}}(s,u,t,r,d,h),p=function(t,r){if(!(n>15)){var i=r-t;return i<20||i>=.8*o?void 0:e(t,r,n+1)}},b=new jT(i,d,h,f.next,f.mid);return a.bspNodeTree.push(b),b.leftNode=p(t,f.next),b.rightNode=p(f.mid,r),b})(0,o,0),this.triangleVertexIndices=function(e,t,r,n){for(var i=n-r,a=0,o=r;o<n;++o)for(var s=0;s<3;++s)a=Math.max(t[3*o+s],a);for(var c=a<=ST?new Uint16Array(3*i):new Uint32Array(3*i),l=0;l<i;++l)for(var u=3*(e[l]+r),d=0;d<3;++d){var h=t[u+d];c[3*l+d]=h}return c}(s,t,r,n)}return Object(l.a)(e,[{key:"intersectRayTriangleRange",value:function(t,r){if(!(t>=r)){for(var n=this.triangleVertexIndices,i=this.positionAttribute.data,a=this.positionAttribute.stride,o=this.rayOrigin,s=o[0],c=o[1],l=o[2],u=this.rayDirection,d=u[0],h=u[1],f=u[2],p=t,b=3*t;p<r;++p){var v=n[b]*a,m=i[v],y=i[v+1],g=i[v+2],O=n[b+1]*a,j=i[O],_=i[O+1],w=i[O+2],x=n[b+2]*a;b+=3;var k=j-m,S=_-y,T=w-g,C=i[x]-m,M=i[x+1]-y,P=i[x+2]-g,A=h*P-M*f,E=f*C-P*d,R=d*M-C*h,I=k*A+S*E+T*R;if(!(Math.abs(I)<=Number.EPSILON)){var D=s-m,F=c-y,L=l-g,z=D*A+F*E+L*R;if(I>0){if(z<0||z>I)continue}else if(z>0||z<I)continue;var V=F*T-S*L,N=L*k-T*D,U=D*S-k*F,B=d*V+h*N+f*U;if(I>0){if(B<0||z+B>I)continue}else if(B>0||z+B<I)continue;var G=(C*V+M*N+P*U)/I;if(G>=0){var q=this.indices[p]+this.firstTriangleIndex,H=Object(jx.d)(k,S,T,C,M,P,wT);this.callback(G,H,q)}}}e.numFacesTested+=r-t}}},{key:"intersectRay",value:function(t,r){e.numFacesTested=0;var n=Object(X.g)(t.r0[0],t.r0[1],t.r0[2]),i=function(e,t){var r=Object(X.e)();return Object(Yl.C)(r,e,t),r}(Object(X.g)(t.r1[0],t.r1[1],t.r1[2]),n);if(!(Object(Yl.v)(i)<OT)){this.rayOrigin=n,this.rayDirection=i;var a=this.triangleVertexIndices.length/3;this.callback=r;var o=this.bspNodeTree[0];this.intersectRayBSP(o,0,a)}}},{key:"intersectRayBSP",value:function(e,t,r){var n=this.rayOrigin,i=this.rayDirection;if(function(e,t,r){for(var n=t,i=r,a=0,o=1/0,s=0;s<3;++s){var c=e[s];if(n[s]<c){if(i[s]<=OT)return!1;var l=(c-n[s])/i[s];a=Math.max(a,l)}else if(i[s]<=-1e-6){var u=(c-n[s])/i[s];o=Math.min(o,u)}if(a>=o)return!1;var d=e[s+3];if(n[s]>d){if(i[s]>=-1e-6)return!1;var h=(d-n[s])/i[s];a=Math.max(a,h)}else if(i[s]>=OT){var f=(d-n[s])/i[s];o=Math.min(o,f)}if(a>=o)return!1}return!0}(e.aabb,n,i)){var a=e.axis,o=e.d;if(n[a]<o||i[a]<0){var s=t,c=e.midStartIndex;if(s<c){var l=e.leftNode;void 0!==l?this.intersectRayBSP(l,s,c):this.intersectRayTriangleRange(s,c)}}if(this.intersectRayTriangleRange(e.midStartIndex,e.rightStartIndex),n[a]>o||i[a]>0){var u=e.rightStartIndex,d=r;if(u<d){var h=e.rightNode;void 0!==h?this.intersectRayBSP(h,u,d):this.intersectRayTriangleRange(u,d)}}}}}]),e}();_T.numFacesTested=0;var wT=Object(X.e)(),xT=Object(X.g)(1/0,1/0,1/0),kT=Object(X.g)(-1/0,-1/0,-1/0);var ST=65535;function TT(e,t,r,n){if(r>=t)return e;null==e&&(e=function(){return{isVisibleBit:!(!(arguments.length>0&&void 0!==arguments[0])||arguments[0]),data:new Uint32Array(0)}}());var i=e.isVisibleBit,a=e.data,o=MT(a),s=r/o|0,c=r-o*s,l=(t-1)/o|0,u=a,d=n===i;if(!(r<u.length*o)&&d){var h=s+1,f=Math.ceil(1.5*u.length),p=l+1,b=Math.max(h,f);b=Math.min(b,p),(a=new Uint32Array(b)).set(u)}return s<a.length&&(a[s]=function(e,t,r){return e&~(1<<t)|(r?1:0)<<t}(a[s],c,d)),e.data=a,e}function CT(e,t){if(null==e)return!0;var r=e.isVisibleBit,n=e.data,i=MT(n);return t<n.length*i?function(e,t,r,n){var i=r/n|0,a=r-i*n;return function(e,t){return 0!=(e&1<<t)}(t[i],a)===e}(r,n,t,i):!e.isVisibleBit}function MT(e){return 8*e.BYTES_PER_ELEMENT}var PT=r(150),AT=function(){function e(t,r){Object(c.a)(this,e),this._indices=Object(I.j)(t.indices)?t.indices:Object(PT.d)(t.positions.length/3),this._positions=new Ok.u(t.positions),this._components=r,this._componentIntersectionData=new Array(r.count)}return Object(l.a)(e,[{key:"getComponentAabb",value:function(e,t){if(Object(I.j)(this._perComponentAabbs)){for(var r=0;r<6;r++)t[r]=this._perComponentAabbs[6*e+r];return t}return this._computePerComponentAabbs(),this.getComponentAabb(e,t)}},{key:"getComponentPositions",value:function(e,t){t.indices=this._indices,t.data=this._positions.typedBuffer,t.stride=this._positions.typedBufferStride,t.startIndex=this._components.offsets[e],t.endIndex=this._components.offsets[e+1]}},{key:"intersect",value:function(e,t,r,n,i,a){var o=this,s={data:this._positions.typedBuffer,stride:this._positions.typedBufferStride,size:3},c=this._indices,l=this._components.offsets,u=Object(jx.c)(e,t,ET);this._components.visibility.forEachComponent((function(d){if(!CT(o._components.pickability,d))return!0;var h=o.getComponentAabb(d,RT);if(Object(I.j)(i)&&i.applyToAabb(h),!Object(jx.f)(h,e,u,r))return!0;var f=l[d]/3,p=l[d+1]/3,b=function(e,t,r){a(d,e,Object(Yl.z)(t,t,n),r)},v=p-f;return Object(I.i)(i)&&v>40?(null==o._componentIntersectionData[d]&&(o._componentIntersectionData[d]=new _T(o._indices,f,p,s)),o._componentIntersectionData[d].intersectRay({r0:e,r1:t},b)):Object(jx.j)(e,t,f,p,c,s,void 0,i,b),!0}))}},{key:"_computePerComponentAabbs",value:function(){var e=this._components.count;this._perComponentAabbs=new Float32Array(6*e);for(var t=0;t<e;t++)this._computeAABB(t)}},{key:"_computeAABB",value:function(e){for(var t=this._indices,r=this._positions,n=this._components.offsets,i=n[e],a=n[e+1],o=[0,0,0],s=[1/0,1/0,1/0],c=[-1/0,-1/0,-1/0],l=i;l<a;l++){var u=t[l];r.getVec(u,o),Object(Yl.a)(s,s,o),Object(Yl.b)(c,c,o)}var d=6*e;this._perComponentAabbs[d++]=s[0],this._perComponentAabbs[d++]=s[1],this._perComponentAabbs[d++]=s[2],this._perComponentAabbs[d++]=c[0],this._perComponentAabbs[d++]=c[1],this._perComponentAabbs[d]=c[2]}},{key:"positions",get:function(){return this._positions}},{key:"indices",get:function(){return this._indices}}]),e}(),ET=Object(X.e)(),RT=Object(Eg.h)(),IT=AT,DT=function(){function e(t,r,n,i){Object(c.a)(this,e),this.material=t,this.drawParameters=r,this.geometry=n,this.meta=i}return Object(l.a)(e,[{key:"dispose",value:function(){this.material.dispose(),this.geometry.dispose()}}]),e}(),FT=function(e){Object(f.a)(r,e);var t=Object(p.a)(r);function r(e,n,i,a){var o;return Object(c.a)(this,r),(o=t.call(this)).primitiveType=n,o.parameters=i,o.indexed=a,o.vao=e,o}return r}(tT.a);function LT(e){return e?zT(e,1/0,-1/0):function(e,t){return{near:e,far:t}}(1/0,-1/0)}function zT(e,t,r){return e.near=t,e.far=r,e}function VT(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e;return r.near=Math.min(e.near,t.near),r.far=Math.max(e.far,t.far),r}function NT(e,t){return e.near<=t&&t<=e.far}Object(b.a)([Object(tT.c)()],FT.prototype,"vao",void 0);var UT={near:0,far:0};function BT(e,t){for(var r=LT(),n=e.eye,i=e.frustum,a=e.viewForward,o=0;o<t.length;o++){var s=t[o].obb,c=Object(Yl.j)(Object(Yl.C)(nC,s.center,n),a),l=Object(dT.k)(s,a);if(!NT(r,c-l)||!NT(r,c+l)){var u=eC(s,i);if(-1!==u)if(0!==u){var d=GT.pushNew();d.near=c-l,d.far=c+l,d.mask=u,d.object=t[o]}else qT.far=c+l,qT.near=c-l,VT(r,qT)}}for(var h=function(e){var t=GT.data[e];if(NT(r,t.near)&&NT(r,t.far))return"continue";qT.far=t.far,qT.near=1/0,0===function(e,t,r,n){Object(bp.b)(rC,e.quaternion),Object(Yl.C)(nC,t,e.center),Object(Yl.w)(nC,nC,rC);var i=8*((nC[0]<-e.halfSize[0]?-1:nC[0]>e.halfSize[0]?1:0)+3*(nC[1]<-e.halfSize[1]?-1:nC[1]>e.halfSize[1]?1:0)+9*(nC[2]<-e.halfSize[2]?-1:nC[2]>e.halfSize[2]?1:0)+13),a=JT[i];if(0===a)return a;Object(Tf.h)(tC,e.quaternion),Object(Tf.d)(tC,tC,e.halfSize);var o=function(t,r){var n=JT[i+r+1];return Object(Yl.y)(t,((1&n)<<1)-1,(2&n)-1,((4&n)>>1)-1),Object(Yl.z)(t,t,tC),Object(Yl.h)(t,e.center,t)};return r.length=0,$T(r,o(iC,0)),$T(r,o(aC,1)),$T(r,o(nC,2)),$T(r,o(oC,3)),n(r),1===a||(r.length=0,$T(r,iC),$T(r,oC),$T(r,o(nC,4)),$T(r,o(sC,5)),n(r),2===a||(r.length=0,$T(r,iC),$T(r,sC),$T(r,o(nC,6)),$T(r,aC),n(r))),a}(t.object.obb,n,QT,(function(e){for(var r=ZT,o=0;o<KT&&e.length>0;o++)if(0!=(t.mask&1<<o)){XT(i[o],e,r);var s=e;e=r,r=s}for(var c=0;c<e.length;c+=3){Object(Yl.y)(HT,e.data[c+0],e.data[c+1],e.data[c+2]);var l=Object(Yl.j)(Object(Yl.C)(HT,HT,n),a);qT.near=Math.min(qT.near,l)}}))&&(qT.near=0),VT(r,qT)},f=0;f<GT.length;f++)h(f);return GT.length=0,r}var GT=new zy.a({allocator:function(e){return e||{near:1/0,far:-1/0,mask:0,object:null}},deallocator:function(e){return e.object=null,e}}),qT=LT(),HT=Object(X.e)(),WT=Object(X.e)(),QT=new zy.a({deallocator:null}),ZT=new zy.a({deallocator:null});function XT(e,t,r){r.length=0;var n=t.length-3;YT(HT,t,n);var i=Object(Rp.w)(e,HT);i<=0&&(r.push(HT[0]),r.push(HT[1]),r.push(HT[2]));for(var a=0,o=i;a<n;a+=3){YT(WT,t,a);var s=Object(Rp.w)(e,WT);o*s<0&&(Object(Yl.k)(HT,WT,HT,s/(s-o)),$T(r,HT)),s<=0&&$T(r,WT),o=s,Object(Yl.m)(HT,WT)}o*i<0&&(YT(WT,t,n),Object(Yl.k)(HT,WT,HT,i/(i-o)),$T(r,HT))}function YT(e,t,r){return Object(Yl.y)(e,t.data[r+0],t.data[r+1],t.data[r+2])}function $T(e,t){e.push(t[0]),e.push(t[1]),e.push(t[2])}var JT=function(){var e=new Int8Array(216),t=0,r=function(r){for(var n=0;n<r.length;n++)e[t+n]=r[n];t+=8};return r([3,0,6,2,3,1,5,4]),r([2,0,2,3,1,5,4,0]),r([3,1,0,2,3,7,5,4]),r([2,0,1,3,2,6,4,0]),r([1,0,1,3,2,0,0,0]),r([2,1,5,7,3,2,0,0]),r([3,2,0,1,3,7,6,4]),r([2,2,0,1,3,7,6,0]),r([3,3,0,1,5,7,6,2]),r([2,0,1,5,4,6,2,0]),r([1,0,1,5,4,0,0,0]),r([2,1,3,7,5,4,0,0]),r([1,0,2,6,4,0,0,0]),r([0,0,0,0,0,0,0,0]),r([1,1,3,7,5,0,0,0]),r([2,2,3,7,6,4,0,0]),r([1,2,3,7,6,0,0,0]),r([2,3,1,5,7,6,2,0]),r([3,4,0,1,5,7,6,2]),r([2,5,7,6,4,0,1,0]),r([3,5,0,1,3,7,6,4]),r([2,4,5,7,6,2,0,0]),r([1,4,5,7,6,0,0,0]),r([2,5,1,3,7,6,4,0]),r([3,6,0,2,3,7,5,4]),r([2,6,2,3,7,5,4,0]),r([3,7,6,2,3,1,5,4]),e}(),KT=4;function eC(e,t){for(var r=0,n=0;n<KT;n++){var i=Object(dT.g)(e,t[n]);if(i>0)return-1;0===i&&(r|=1<<n)}return r}var tC=Object(Cf.b)(),rC=Object(vp.b)(),nC=Object(X.e)(),iC=Object(X.e)(),aC=Object(X.e)(),oC=Object(X.e)(),sC=Object(X.e)(),cC=function(){function e(t){Object(c.a)(this,e),this._objects=t}return Object(l.a)(e,[{key:"submit",value:function(e,t){this._objects.preSubmit(t);for(var r=this._objects.visibleObjects,n=0;n<r.length;n++){var i=r[n];i.renderable.material.submit(e,i)}}},{key:"queryShadowCasterDepthRange",value:function(e){return this._objects.visibleObjects.length?BT(e,this._objects.visibleObjects):null}}]),e}(),lC=r(602),uC=r(73),dC=r(465),hC=r(145),fC=r(109),pC=r(274),bC=r(228),vC=r(89),mC=function(e){Object(f.a)(r,e);var t=Object(p.a)(r);function r(){return Object(c.a)(this,r),t.apply(this,arguments)}return Object(l.a)(r,[{key:"bindPass",value:function(e){var t=this.program;hC.a.bindViewProjTransform(t,e.viewTransform),Object(OS.b)(this.program,this.configuration,e.slicePlane),0===e.identifier&&(void 0!==e.ssrParams&&Object(jS.b)(this.program,e.ssrParams),t.setUniformMatrix3fv("uTransformNormal_ViewFromGlobal",e.transformNormal_ViewFromGlobal),2===e.subPass&&t.setUniform2fv("cameraNearFar",e.cameraNearFar),0===e.subPass&&e.lighting.setUniforms(this.program,e.integratedMesh)),1===e.identifier&&this.program.setUniform2fv("cameraNearFar",e.cameraNearFar)}},{key:"bindMaterial",value:function(e,t){var r=this.program;r.setUniform4fv("uBaseColor",e.baseColor),r.setUniform1f("uObjectOpacity",e.objectOpacity),r.setUniform1f("textureAlphaCutoff",e.alphaCutoff),1===e.componentParameters.type?e.componentParameters.texture.bind(r,"uComponentColorTex","uComponentColorTexInvDim"):(r.setUniform4fv("uExternalColor",e.componentParameters.externalColor),r.setUniform1i("uExternalColorMixMode",e.componentParameters.externalColorMixMode)),Object(I.j)(e.baseColorTexture)&&e.baseColorTexture.bind(r,"uBaseColorTexture","uBaseColorTextureSize"),0!==this.configuration.output&&7!==this.configuration.output||(Object(pC.c)(this.program,e,this.configuration.isSchematic),Object(I.j)(e.metallicRoughnessTexture)&&e.metallicRoughnessTexture.bind(r,"texMetallicRoughness","texMetallicRoughnessSize"),Object(I.j)(e.emissionTexture)&&e.emissionTexture.bind(r,"texEmission","texEmissionSize"),Object(I.j)(e.occlusionTexture)&&e.occlusionTexture.bind(r,"texOcclusion","texOcclusionSize"),Object(I.j)(e.normalTexture)&&e.normalTexture.bind(r,"normalTexture","normalTextureSize")),e.isIntegratedMesh&&(0===t.identifier&&0===t.subPass?(r.bindTexture(e.overlayColor,"ovColorTex"),r.bindTexture(e.overlayNormal,"ovNormalTex")):2===t.identifier&&r.bindTexture(e.overlayHighlight,"ovColorTex"),r.setUniform1f("overlayOpacity",1)),2===t.identifier&&Object(fC.b)(this.program,t),0===t.identifier&&0===t.subPass&&(t.ambientOcclusionEnabled&&t.bindAmbientOcclusion(r),t.shadowsEnabled&&t.bindShadowMap(r)),0!==t.identifier||0!==t.subPass&&1!==t.subPass||!t.multipassTerrainParams.multipassTerrainEnabled||(this.program.setUniform2fv("cameraNearFar",t.cameraNearFar),r.setUniform2fv("inverseViewport",t.inverseViewport),t.multipassTerrainParams.terrainLinearDepthTexture&&r.bindTexture(t.multipassTerrainParams.terrainLinearDepthTexture,"terrainDepthTexture"))}},{key:"bindDraw",value:function(e,t){if(hC.a.bindModelTransform(this.program,e),this.program.setUniformMatrix3fv("uTransformNormal_GlobalFromModel",e.transformNormal_GlobalFromModel),this.program.rebindTextures(),t.isIntegratedMesh){var r=t.overlayTexScale,n=t.overlayTexOffset;this.program.setUniform4fv("overlayTexOffset",[e.toMapSpace[0]*r[0]+n[0],e.toMapSpace[1]*r[1]+n[1],e.toMapSpace[0]*r[2]+n[2],e.toMapSpace[1]*r[3]+n[3]]),this.program.setUniform4fv("overlayTexScale",[e.toMapSpace[2]*r[0],e.toMapSpace[3]*r[1],e.toMapSpace[2]*r[2],e.toMapSpace[3]*r[3]])}}},{key:"initializeProgram",value:function(e){var t=r.shader.get(),n=this.configuration,i=t.build({multipassTerrainEnabled:n.multipassTerrainEnabled,cullAboveGround:n.cullAboveGround,OITEnabled:0===n.transparencyPassType,output:n.output,normalType:0===n.integratedMeshMode?n.hasNormals?1:3:2,attributeColor:n.hasVertexColors,attributeTextureCoordinates:n.vertexTextureCoordinates,componentData:n.componentData,alphaDiscardMode:n.alphaDiscardMode,baseColorTexture:n.baseColorTexture,doubleSidedMode:n.doubleSidedMode,receiveAmbientOcclusion:n.receiveAmbientOcclusion,receiveShadows:n.receiveShadows,slicePlaneEnabled:n.slicePlaneEnabled,sliceHighlightDisabled:!1,sliceEnabledForVertexPrograms:!1,viewingMode:e.viewingMode,vertexDiscardMode:n.vertexDiscardMode,pbrMode:3===n.integratedMeshMode?4:n.usePBR?n.isSchematic?2:1:0,hasMetalnessAndRoughnessTexture:n.hasMetalnessAndRoughnessTexture,hasEmissionTexture:n.hasEmissionTexture,hasOcclusionTexture:n.hasOcclusionTexture,hasNormalTexture:n.hasNormalTexture,vertexTangents:!1,supportsTextureAtlas:!0,doublePrecisionRequiresObfuscation:Object(bC.b)(e.rctx),overlayEnabled:2===n.integratedMeshMode||3===n.integratedMeshMode,ssrEnabled:n.ssrEnabled,highStepCount:!1,ellipsoidMode:n.ellipsoidMode});return new ou.a(e.rctx,i,t.attributeLocations)}},{key:"setPipelineState",value:function(e){var t=this.configuration,r=0!==t.integratedMeshMode,n=3===e,i=2===e;return Object(su.g)({blending:0!==t.output&&7!==t.output||!t.blendingEnabled?null:n?vC.f:Object(vC.a)(e),culling:Object(su.c)(t.cullFace),depthTest:{func:Object(vC.b)(e)},depthWrite:n||i?su.e:null,colorWrite:su.d,stencilWrite:r||t.sceneHasOcludees?wS.j:null,stencilTest:r?Object(wS.d)(1):t.sceneHasOcludees?wS.e:null,polygonOffset:n||i?t.polygonOffsetEnabled?{factor:2,units:2}:null:vC.d})}},{key:"initializePipeline",value:function(){return this.setPipelineState(this.configuration.transparencyPassType)}}]),r}(nu.a);mC.shader=new ru.a(dC.a,(function(){return r.e(186).then(r.bind(null,1074))}));var yC=function(e){Object(f.a)(r,e);var t=Object(p.a)(r);function r(){var e;return Object(c.a)(this,r),(e=t.apply(this,arguments)).transformNormal_GlobalFromModel=Object(Cf.b)(),e.toMapSpace=Object($l.e)(),e}return r}(hC.a.ModelTransform),gC=function(e){Object(f.a)(r,e);var t=Object(p.a)(r);function r(){var e;return Object(c.a)(this,r),(e=t.apply(this,arguments)).output=0,e.hasVertexColors=!1,e.hasNormals=!1,e.vertexTextureCoordinates=0,e.componentData=0,e.slicePlaneEnabled=!1,e.cullFace=2,e.baseColorTexture=!1,e.receiveAmbientOcclusion=!0,e.receiveShadows=!0,e.vertexDiscardMode=0,e.doubleSidedMode=2,e.blendingEnabled=!0,e.alphaDiscardMode=1,e.integratedMeshMode=0,e.ssrEnabled=!1,e.polygonOffsetEnabled=!1,e.usePBR=!1,e.isSchematic=!1,e.hasMetalnessAndRoughnessTexture=!1,e.hasEmissionTexture=!1,e.hasOcclusionTexture=!1,e.hasNormalTexture=!1,e.sceneHasOcludees=!1,e.transparencyPassType=3,e.ellipsoidMode=1,e.multipassTerrainEnabled=!1,e.cullAboveGround=!1,e}return r}(iu.a);Object(b.a)([Object(iu.b)({count:8})],gC.prototype,"output",void 0),Object(b.a)([Object(iu.b)()],gC.prototype,"hasVertexColors",void 0),Object(b.a)([Object(iu.b)()],gC.prototype,"hasNormals",void 0),Object(b.a)([Object(iu.b)({count:3})],gC.prototype,"vertexTextureCoordinates",void 0),Object(b.a)([Object(iu.b)({count:2})],gC.prototype,"componentData",void 0),Object(b.a)([Object(iu.b)()],gC.prototype,"slicePlaneEnabled",void 0),Object(b.a)([Object(iu.b)({count:3})],gC.prototype,"cullFace",void 0),Object(b.a)([Object(iu.b)()],gC.prototype,"baseColorTexture",void 0),Object(b.a)([Object(iu.b)()],gC.prototype,"receiveAmbientOcclusion",void 0),Object(b.a)([Object(iu.b)()],gC.prototype,"receiveShadows",void 0),Object(b.a)([Object(iu.b)({count:3})],gC.prototype,"vertexDiscardMode",void 0),Object(b.a)([Object(iu.b)({count:3})],gC.prototype,"doubleSidedMode",void 0),Object(b.a)([Object(iu.b)()],gC.prototype,"blendingEnabled",void 0),Object(b.a)([Object(iu.b)({count:4})],gC.prototype,"alphaDiscardMode",void 0),Object(b.a)([Object(iu.b)({count:4})],gC.prototype,"integratedMeshMode",void 0),Object(b.a)([Object(iu.b)()],gC.prototype,"ssrEnabled",void 0),Object(b.a)([Object(iu.b)()],gC.prototype,"polygonOffsetEnabled",void 0),Object(b.a)([Object(iu.b)()],gC.prototype,"usePBR",void 0),Object(b.a)([Object(iu.b)()],gC.prototype,"isSchematic",void 0),Object(b.a)([Object(iu.b)()],gC.prototype,"hasMetalnessAndRoughnessTexture",void 0),Object(b.a)([Object(iu.b)()],gC.prototype,"hasEmissionTexture",void 0),Object(b.a)([Object(iu.b)()],gC.prototype,"hasOcclusionTexture",void 0),Object(b.a)([Object(iu.b)()],gC.prototype,"hasNormalTexture",void 0),Object(b.a)([Object(iu.b)()],gC.prototype,"sceneHasOcludees",void 0),Object(b.a)([Object(iu.b)({count:4})],gC.prototype,"transparencyPassType",void 0),Object(b.a)([Object(iu.b)({count:4})],gC.prototype,"ellipsoidMode",void 0),Object(b.a)([Object(iu.b)()],gC.prototype,"multipassTerrainEnabled",void 0),Object(b.a)([Object(iu.b)()],gC.prototype,"cullAboveGround",void 0);var OC=function(){function e(){Object(c.a)(this,e),this._dirty=!0}return Object(l.a)(e,[{key:"_setDirty",value:function(){this._dirty=!0}},{key:"_setClean",value:function(){if(this._dirty=!1,null!=this._parameterBlocks){var e,t=Object(i.a)(this._parameterBlocks);try{for(t.s();!(e=t.n()).done;){this[e.value]._setClean()}}catch(r){t.e(r)}finally{t.f()}}}},{key:"dirty",get:function(){return this._dirty||this._checkParameterBlocksDirty()}},{key:"_checkParameterBlocksDirty",value:function(){if(null==this._parameterBlocks)return!1;var e,t=Object(i.a)(this._parameterBlocks);try{for(t.s();!(e=t.n()).done;){if(this[e.value].dirty)return!0}}catch(r){t.e(r)}finally{t.f()}return!1}}]),e}(),jC=function(){function e(){Object(c.a)(this,e),this._dirty=!0}return Object(l.a)(e,[{key:"_setDirty",value:function(){this._dirty=!0}},{key:"_setClean",value:function(){this._dirty=!1}},{key:"dirty",get:function(){return this._dirty}}]),e}();function _C(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(t,r){var n,i=null!=(n=t._parameterCount)?n:0;if(t._parameterCount=i+1,e.vectorOps){var a=e.vectorOps;Object.defineProperty(t,r,{get:function(){return this[i]},set:function(e){var t=this[i];if(null==t)this[i]=e;else{if(a.equals(t,e))return;a.copy(t,e)}this._setDirty()}})}else Object.defineProperty(t,r,{get:function(){return this[i]},set:function(t){this[i]!==t&&(e.dispose&&this[i]&&this[i].dispose(),this[i]=t,this._setDirty())}})}}function wC(){return function(e,t){var r,n=null!=(r=e._parameterCount)?r:0;e._parameterCount=n+1,e._parameterBlocks=e._parameterBlocks||[],e._parameterBlocks.push(n),Object.defineProperty(e,t,{get:function(){return this[n]},set:function(e){this[n]!==e&&(this[n]=e,this._setDirty())}})}}var xC=r(110),kC=function(e){Object(f.a)(r,e);var t=Object(p.a)(r);function r(){var e;return Object(c.a)(this,r),(e=t.apply(this,arguments)).baseColor=Object(F_.c)(1,1,1,1),e.usePBR=!1,e.hasParametersFromSource=!1,e.mrrFactors=Object(uC.d)(1,1,.5),e.emissiveFactor=Object(uC.d)(0,0,0),e.baseColorTexture=null,e.metallicRoughnessTexture=null,e.emissionTexture=null,e.occlusionTexture=null,e.normalTexture=null,e.overlayTexOffset=Object($l.g)(-1,-1,-1,-1),e.overlayTexScale=Object($l.g)(0,0,0,0),e.overlayColor=null,e.overlayHighlight=null,e.overlayNormal=null,e.objectOpacity=1,e.commonMaterialParameters=new SC,e.componentParameters=new TC,e.alphaCutoff=xC.b,e.alphaDiscardMode=1,e.isIntegratedMesh=!1,e.polygonOffsetEnabled=!1,e.ellipsoidMode=1,e.sceneHasOcludees=!1,e._techniqueConfig=new gC,e}return Object(l.a)(r,[{key:"dispose",value:function(){this._technique=Object(I.q)(this._technique),this.baseColorTexture=null,this.metallicRoughnessTexture=null,this.emissionTexture=null,this.occlusionTexture=null,this.normalTexture=null}},{key:"getTechnique",value:function(e,t,r){var n=this._techniqueConfig;if(n.hasVertexColors=r.colors,n.hasNormals=r.normals,n.vertexTextureCoordinates=r.textureCoordinates,n.usePBR=this.usePBR,n.hasMetalnessAndRoughnessTexture=Object(I.j)(this.metallicRoughnessTexture),n.hasEmissionTexture=Object(I.j)(this.emissionTexture),n.hasOcclusionTexture=Object(I.j)(this.occlusionTexture),n.hasNormalTexture=Object(I.j)(this.normalTexture),n.transparencyPassType=0===t.identifier&&null!=t.transparencyPassType?t.transparencyPassType:3,n.multipassTerrainEnabled=0===t.identifier&&null!=t.multipassTerrainParams&&t.multipassTerrainParams.multipassTerrainEnabled,n.cullAboveGround=0===t.identifier&&null!=t.multipassTerrainParams&&t.multipassTerrainParams.cullAboveGround,n.ellipsoidMode=this.ellipsoidMode,this.dirty){n.componentData=this.componentParameters.type,n.cullFace=this.commonMaterialParameters.cullFace,n.doubleSidedMode=this.commonMaterialParameters.doubleSided?1:0,n.baseColorTexture=Object(I.j)(this.baseColorTexture),n.isSchematic=this.hasParametersFromSource&&!Object(I.j)(this.baseColorTexture);var i=this._computeWhichMaterialPass();n.blendingEnabled=1===i||2===i,n.alphaDiscardMode=this.alphaDiscardMode,n.integratedMeshMode=this.isIntegratedMesh?this.overlayColor?this.overlayNormal?3:2:1:0,n.polygonOffsetEnabled=this.polygonOffsetEnabled,this._setClean()}return n.slicePlaneEnabled=t.slicePlaneEnabled&&this.commonMaterialParameters.slicePlaneEnabled,1===t.identifier?(n.output=3,n.vertexDiscardMode=0):2===t.identifier?(n.output=4,n.vertexDiscardMode=0):(2===this._computeWhichMaterialPass()?n.vertexDiscardMode=t.transparent?2:1:n.vertexDiscardMode=0,n.output=function(e){switch(e){case 0:return 0;case 1:return 7;case 2:return 1;case 3:return 2;case 4:return 8}}(t.subPass),1===t.subPass&&(n.sceneHasOcludees=t.sceneHasOcludees),0===t.subPass?(n.receiveAmbientOcclusion=t.ambientOcclusionEnabled,n.sceneHasOcludees=t.sceneHasOcludees,n.receiveShadows=t.shadowsEnabled,n.ssrEnabled=t.ssrParams.ssrEnabled):(n.receiveAmbientOcclusion=!1,n.receiveShadows=!1)),this._technique=e.releaseAndAcquire(mC,n,this._technique),this._technique}},{key:"submit",value:function(e,t){if(0!==this.objectOpacity){var r=t.renderable.geometry,n=t.components,i=t.renderable.drawParameters,a=t.renderable.meta.cameraDepthSquared,o=n.geometryRanges,s=n.highlightRanges,c=n.defaultShadowMapRanges;switch(this._computeWhichMaterialPass()){case 0:e.materialOpaque.submitDraw(this,r,o,i,a);break;case 1:e.materialTransparent.submitDraw(this,r,o,i,a);break;case 2:e.materialOpaque.submitDraw(this,r,o,i,a),e.materialTransparent.submitDraw(this,r,o,i,a);break;case 3:e.materialIntegratedMesh.submitDraw(this,r,o,i,a),this.overlayHighlight&&e.highlightIntegratedMesh.submitDraw(this,r,o,i,a)}Object(I.j)(e.shadowMap)&&2!==this.componentParameters.castShadows&&e.shadowMap.submitDraw(this,r,o,i,a),Object(I.j)(e.highlight)&&Object(I.j)(s)&&e.highlight.submitDraw(this,r,s,i,a),Object(I.j)(e.highlightShadowMap)&&2!==this.componentParameters.castShadows&&Object(I.j)(s)&&e.highlightShadowMap.submitDraw(this,r,s,i,a),Object(I.j)(e.defaultShadowMap)&&2!==this.componentParameters.castShadows&&Object(I.j)(c)&&e.defaultShadowMap.submitDraw(this,r,c,i,a)}}},{key:"attributeLocations",get:function(){return dC.b}},{key:"_computeWhichMaterialPass",value:function(){return this.isIntegratedMesh?3:this.objectOpacity<1?1:0===this.componentParameters.opaqueOverride?0:this.baseColor[3]<1||0===this.alphaDiscardMode||3===this.alphaDiscardMode?1:2===this.componentParameters.transparent?0:0===this.componentParameters.transparent?1:2}}]),r}(OC);Object(b.a)([_C({vectorOps:Su.n})],kC.prototype,"baseColor",void 0),Object(b.a)([_C()],kC.prototype,"usePBR",void 0),Object(b.a)([_C()],kC.prototype,"hasParametersFromSource",void 0),Object(b.a)([_C({vectorOps:Yl.c})],kC.prototype,"mrrFactors",void 0),Object(b.a)([_C({vectorOps:Yl.c})],kC.prototype,"emissiveFactor",void 0),Object(b.a)([_C({dispose:!0})],kC.prototype,"baseColorTexture",void 0),Object(b.a)([_C({dispose:!0})],kC.prototype,"metallicRoughnessTexture",void 0),Object(b.a)([_C({dispose:!0})],kC.prototype,"emissionTexture",void 0),Object(b.a)([_C({dispose:!0})],kC.prototype,"occlusionTexture",void 0),Object(b.a)([_C({dispose:!0})],kC.prototype,"normalTexture",void 0),Object(b.a)([_C({vectorOps:{equals:Su.g,copy:Su.c}})],kC.prototype,"overlayTexOffset",void 0),Object(b.a)([_C({vectorOps:{equals:Su.g,copy:Su.c}})],kC.prototype,"overlayTexScale",void 0),Object(b.a)([_C()],kC.prototype,"overlayColor",void 0),Object(b.a)([_C()],kC.prototype,"overlayHighlight",void 0),Object(b.a)([_C()],kC.prototype,"overlayNormal",void 0),Object(b.a)([_C()],kC.prototype,"objectOpacity",void 0),Object(b.a)([wC()],kC.prototype,"commonMaterialParameters",void 0),Object(b.a)([wC()],kC.prototype,"componentParameters",void 0),Object(b.a)([_C()],kC.prototype,"alphaCutoff",void 0),Object(b.a)([_C()],kC.prototype,"alphaDiscardMode",void 0),Object(b.a)([_C()],kC.prototype,"isIntegratedMesh",void 0),Object(b.a)([_C()],kC.prototype,"polygonOffsetEnabled",void 0),Object(b.a)([_C()],kC.prototype,"ellipsoidMode",void 0),Object(b.a)([_C()],kC.prototype,"sceneHasOcludees",void 0);var SC=function(e){Object(f.a)(r,e);var t=Object(p.a)(r);function r(){var e;return Object(c.a)(this,r),(e=t.apply(this,arguments)).doubleSided=!1,e.cullFace=2,e.slicePlaneEnabled=!0,e}return r}(jC);Object(b.a)([_C()],SC.prototype,"doubleSided",void 0),Object(b.a)([_C()],SC.prototype,"cullFace",void 0),Object(b.a)([_C()],SC.prototype,"slicePlaneEnabled",void 0);var TC=function(e){Object(f.a)(r,e);var t=Object(p.a)(r);function r(){var e;return Object(c.a)(this,r),(e=t.apply(this,arguments)).externalColor=Object(F_.c)(1,1,1,1),e.externalColorMixMode=1,e.castShadows=0,e}return Object(l.a)(r,[{key:"transparent",get:function(){return this.externalColor[3]<1?0:2}},{key:"opaqueOverride",get:function(){return 3===this.externalColorMixMode&&1===this.externalColor[3]?0:2}},{key:"visible",get:function(){return this.externalColor[3]>0?0:2}},{key:"type",get:function(){return 0}}]),r}(jC);Object(b.a)([_C({vectorOps:Su.n})],TC.prototype,"externalColor",void 0),Object(b.a)([_C()],TC.prototype,"externalColorMixMode",void 0),Object(b.a)([_C()],TC.prototype,"castShadows",void 0);var CC=function(e){Object(f.a)(r,e);var t=Object(p.a)(r);function r(){var e;return Object(c.a)(this,r),(e=t.apply(this,arguments)).texture=null,e.transparent=2,e.opaqueOverride=2,e.castShadows=2,e}return Object(l.a)(r,[{key:"type",get:function(){return 1}}]),r}(jC);Object(b.a)([_C()],CC.prototype,"texture",void 0),Object(b.a)([_C()],CC.prototype,"transparent",void 0),Object(b.a)([_C()],CC.prototype,"opaqueOverride",void 0),Object(b.a)([_C()],CC.prototype,"castShadows",void 0);var MC=function(){function e(t){Object(c.a)(this,e),this._low=Object(uC.c)(),this._high=Object(uC.c)(),t&&this.set(t)}return Object(l.a)(e,[{key:"low",get:function(){return this._low}},{key:"high",get:function(){return this._high}},{key:"set",value:function(e){var t=this._low,r=this._high;Object(Yl.m)(t,e),Object(Yl.C)(r,e,t)}},{key:"setElements",value:function(e,t,r){Object(Yl.y)(PC,e,t,r),this.set(PC)}},{key:"get",value:function(e){return Object(Yl.h)(e,this._low,this._high)}},{key:"getLowScaled",value:function(e){return Object(Yl.g)(e,this._low,1)}}]),e}(),PC=Object(X.e)(),AC=function(){function e(t){Object(c.a)(this,e),this.maxCount=t,this._nextIndex=0,this.recycledIndices=[]}return Object(l.a)(e,[{key:"activeCount",get:function(){return this._nextIndex-this.recycledIndices.length}},{key:"availableCount",get:function(){return this.recycledIndices.length+this.maxCount-this._nextIndex}},{key:"acquire",value:function(){return this.recycledIndices.length>0?this.recycledIndices.pop():this.availableCount?this._nextIndex++:void 0}},{key:"release",value:function(e){this.recycledIndices.push(e)}}]),e}(),EC=function(){function e(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;Object(c.a)(this,e),this.rctx=t,this.fieldCount=r,this.textureWidth=4096,this.dirty=!0,this.texture=new vu.a(this.rctx,{target:3553,pixelFormat:6408,dataType:5121,samplingMode:9728,wrapMode:33071,width:this.textureWidth,height:1,flipped:!1}),this.data=new Ok.J(new ArrayBuffer(4*this.textureWidth))}return Object(l.a)(e,[{key:"dispose",value:function(){this.texture.dispose(),this.texture=void 0,this.data=void 0}},{key:"setData",value:function(e,t,r,n,i,a){var o=e*this.fieldCount+t;this.dirty=!0,this.data.set(o,0,r),this.data.set(o,1,n),this.data.set(o,2,i),this.data.set(o,3,a)}},{key:"setDataElement",value:function(e,t,r,n){var i=e*this.fieldCount+t;this.dirty=!0,this.data.set(i,r,n)}},{key:"resizeToFit",value:function(e){var t=e*this.fieldCount;if(t>=this.data.count){var r=Math.ceil((t+1)/this.textureWidth)*this.textureWidth,n=new Ok.J(new ArrayBuffer(4*r));n.typedBuffer.set(this.data.typedBuffer),this.data=n}}},{key:"updateTexture",value:function(){if(this.dirty){var e=this.texture.descriptor.width,t=this.texture.descriptor.height;this.data.count>e*t&&this.texture.resize(e,this.data.count/e),this.texture.setData(this.data.typedBuffer),this.dirty=!1}}},{key:"bind",value:function(e,t,r){e.bindTexture(this.texture,t),e.setUniform2f(r,1/this.texture.descriptor.width,1/this.texture.descriptor.height)}}]),e}(),RC=65536,IC=function(){function e(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;Object(c.a)(this,e),this.textureBuffer=new EC(t,r),this.indexManager=new AC(RC)}return Object(l.a)(e,[{key:"dispose",value:function(){this.textureBuffer.dispose(),this.textureBuffer=void 0}},{key:"availableCount",get:function(){return this.indexManager.availableCount}},{key:"activeCount",get:function(){return this.indexManager.activeCount}},{key:"acquireIndex",value:function(){var e=this.indexManager.acquire();return this.textureBuffer.resizeToFit(e),e}},{key:"releaseIndex",value:function(e){this.indexManager.release(e)}}]),e}(),DC=function(){function e(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;Object(c.a)(this,e),this.rctx=t,this.fieldCount=r,this.buffers=[]}return Object(l.a)(e,[{key:"garbageCollect",value:function(){this.buffers=this.buffers.filter((function(e){return 0!==e.activeCount||(e.dispose(),!1)}))}},{key:"destroy",value:function(){this.buffers.forEach((function(e){return e.dispose()})),this.buffers=[]}},{key:"getBuffer",value:function(e){var t,r=Object(i.a)(this.buffers);try{for(r.s();!(t=r.n()).done;){var n=t.value;if(n.availableCount>=e)return n}}catch(o){r.e(o)}finally{r.f()}if(e>RC)return null;var a=new IC(this.rctx,this.fieldCount);return this.buffers.push(a),a}},{key:"updateTextures",value:function(){var e,t=Object(i.a)(this.buffers);try{for(t.s();!(e=t.n()).done;){e.value.textureBuffer.updateTexture()}}catch(r){t.e(r)}finally{t.f()}}}]),e}(),FC=j.a.getLogger("esri.views.3d.webgl-engine.collections.Component.ComponentObjectCollection"),LC=function(){function e(t){Object(c.a)(this,e),this._renderManager=t,this._objects=new vT,this._renderSubmit=new cC(this),this._renderManager.register(this._renderSubmit),this._componentBufferManager=new DC(t.rctx)}return Object(l.a)(e,[{key:"dispose",value:function(){Object(qu.a)(0===this._objects.count,"ObjectCollection should be empty upon disposal"),this._componentBufferManager.destroy()}},{key:"createObject",value:function(e){var t=new gT;return t.toMapSpace=e.toMapSpace.slice(),t.transform=e.transform,t.obb=Object(dT.b)(e.obb),t.components=new pT(this._componentBufferManager,e.geometry.componentOffsets),t.renderable=this._createRenderable(e,t.components),t.intersectionGeometry=new IT(e.geometry.positionData,t.components),this._objects.add(e.visible?1:0,t),t}},{key:"destroyObject",value:function(e){var t=e;this._objects.remove(t),t.dispose(),this._notifyDirty()}},{key:"setObjectVisibility",value:function(e,t){var r=e;if(t!==r.visible){var n=t?1|r.bucketKey:-2&r.bucketKey;this._objects.updateKey(r,n),this._notifyDirty()}}},{key:"preSubmit",value:function(e){var t=e.camera.eye;this._objects.forEach((function(e,r){1&r&&e.forEach((function(e){var r=Object(Yl.n)(t,e.obb.center);e.renderable.meta.cameraDepthSquared=r}))}))}},{key:"getMaterial",value:function(e){return e.renderable.material}},{key:"updateMaterial",value:function(e,t){var r=e.renderable.material;t(r),r.dirty&&this._notifyDirty()}},{key:"setAllComponentVisibilities",value:function(e,t){var r=e;r.components.visibility.reset(t),r.components.visibilityDirty(),this._notifyDirty()}},{key:"forEachVisibleComponent",value:function(e,t){return e.components.visibility.forEachComponent(t)}},{key:"getComponentCount",value:function(e){var t=e,r=t.components.visibility.componentCount();return{visible:r,invisible:t.components.count-r}}},{key:"setComponentData",value:function(e,t){var r=e,n=r.renderable.material;if("function"==typeof t){for(var i=r.components,a=i.materialDataBuffer,o=i.materialDataIndices,s={castShadows:!0,pickable:!0,externalColor:Object(F_.b)(),externalColorMixMode:1},c=a.textureBuffer,l=new Uint8Array(4),u=new Uint32Array(l.buffer),d=0,h=0,f=0,p=!1,b=0,v=0;v<i.count;v++)t(v,s),d+=+(s.externalColor[3]<1),h+=+(3===s.externalColorMixMode&&1===s.externalColor[3]),f+=+s.castShadows,Object(uT.a)(s.externalColor,s.externalColorMixMode,l),l[2]=254&l[2]|+s.castShadows,c.setData(o[v],0,l[0],l[1],l[2],l[3]),p=p||v>0&&b!==u[0],b=u[0],s.pickable!==CT(i.pickability,v)&&(i.pickability=TT(i.pickability,i.count,v,s.pickable));p?(n.componentParameters=new CC,n.componentParameters.castShadows=VC(f,i.count),n.componentParameters.transparent=VC(d,i.count),n.componentParameters.opaqueOverride=VC(h,i.count),n.componentParameters.texture=c,c.updateTexture()):(n.componentParameters=new TC,n.componentParameters.castShadows=s.castShadows?0:2,n.componentParameters.externalColor=s.externalColor,n.componentParameters.externalColorMixMode=s.externalColorMixMode)}else n.componentParameters=new TC,n.componentParameters.castShadows=t.castShadows?0:2,n.componentParameters.externalColor=t.externalColor,n.componentParameters.externalColorMixMode=t.externalColorMixMode;this._notifyDirty()}},{key:"getComponentAabb",value:function(e,t,r){return e.intersectionGeometry.getComponentAabb(t,r)}},{key:"getComponentObb",value:function(e){return e.obb}},{key:"getObjectTransform",value:function(e){return e.transform}},{key:"getComponentPositions",value:function(e,t,r){return e.intersectionGeometry.getComponentPositions(t,r)}},{key:"intersect",value:function(e,t,r,n,i,a){var o=e;Object(I.j)(i)&&(i.localOrigin=o.transform.position);var s=Object(Tf.e)(NC,o.transform.rotationScale);Object(Yl.C)(UC,t,o.transform.position),Object(Yl.C)(BC,r,o.transform.position),Object(Yl.z)(UC,UC,s),Object(Yl.z)(BC,BC,s);var c=Object(Tf.n)(NC,s);return o.intersectionGeometry.intersect(UC,BC,n,c,i,a)}},{key:"addEdges",value:function(e,t,r,n){var i=e,a=i.intersectionGeometry,o=a.indices,s=a.positions,c=i.components.offsets;return t.addComponentObject(e,i.transform,i.obb.center,s,o,c,r,n)}},{key:"addComponentHighlight",value:function(e,t){var r=e.components;Object(I.i)(r.highlightCounts)&&(r.highlightCounts=new Uint32Array(r.count+1)),0===r.highlightCounts[t]++&&(r.highlightsDirty(),this._notifyDirty()),r.highlightCounts[r.count]++}},{key:"removeComponentHighlight",value:function(e,t){var r=e.components;if(Object(I.i)(r.highlightCounts))FC.warn("Removing non-existing highlight.");else{var n=r.highlightCounts[t],i=r.highlightCounts[r.count];if(0!==n){if(n>1)return r.highlightCounts[t]=n-1,void(r.highlightCounts[r.count]=i-1);r.highlightCounts[t]=0,r.highlightsDirty(),this._notifyDirty(),1===i?r.highlightCounts=null:r.highlightCounts[r.count]=i-1}else FC.warn("Removing non-existing highlight.")}}},{key:"clearHighlights",value:function(e){var t=e.components;Object(I.j)(t.highlightCounts)&&(t.highlightCounts=null,t.highlightsDirty(),this._notifyDirty())}},{key:"getObjectGPUMemoryUsage",value:function(e){return e.renderable.meta.gpuMemoryEstimate}},{key:"visibleObjects",get:function(){return this._objects.getBucket(1)}},{key:"performanceInfo",get:function(){var e=this._objects.getPerformanceInfo(1);return{shown:e.added,hidden:e.removed}}},{key:"_createRenderable",value:function(e,t){for(var r=this._renderManager.rctx,n=e.geometry,i=n.vertices.layoutParameters,a=bu.a.createVertex(r,35044,n.vertices.data),o=Object(I.c)(n.indices,(function(e){return bu.a.createIndex(r,35044,e)})),s=Object(du.a)(Object(lC.a)(i)),c=new Uint16Array(n.vertices.count),l=0;l<t.count;l++){var u=t.offsets[l],d=t.offsets[l+1],h=t.materialDataIndices[l];if(Object(I.j)(n.indices))for(var f=u;f<d;f++)c[n.indices[f]]=h;else for(var p=u;p<d;p++)c[p]=h}var b=bu.a.createVertex(r,35044,c.buffer),v=new MC(e.transform.position),m=Object(Ek.a)(e.transform.rotationScale);Object(Tf.e)(m,m),Object(Tf.n)(m,m);var y=new yC;Object(Yl.m)(y.worldFromModel_TL,v.low),Object(Yl.m)(y.worldFromModel_TH,v.high),Object(Tf.g)(y.worldFromModel_RS,e.transform.rotationScale),Object(Tf.g)(y.transformNormal_GlobalFromModel,m),Object(Su.c)(y.toMapSpace,e.toMapSpace);var g=new kC,O=new yu.a(r,g.attributeLocations,{data:s,componentIndices:zC},{data:a,componentIndices:b},Object(I.s)(o)),j=new FT(O,4,i,Object(I.j)(o)),_={cameraDepthSquared:.5,gpuMemoryEstimate:a.byteSize+b.byteSize+(Object(I.j)(o)?o.byteSize:0)};return new DT(g,y,j,_)}},{key:"_notifyDirty",value:function(){this._renderManager.notifyDirty()}}]),e}(),zC=Object(du.a)(Object(hu.a)().u16("componentIndex"));function VC(e,t){return e===t?0:0===e?2:1}var NC=Object(Ek.b)(),UC=Object(X.e)(),BC=Object(X.e)(),GC=r(523),qC=r(627),HC=function(e){Object(f.a)(r,e);var t=Object(p.a)(r);function r(){return Object(c.a)(this,r),t.apply(this,arguments)}return Object(l.a)(r,[{key:"initializeProgram",value:function(e){var t=r.shader.get().build(this.configuration);return new ou.a(e.rctx,t,au.a)}},{key:"initializePipeline",value:function(){if(1===this.configuration.function)return Object(su.g)({colorWrite:{r:!1,g:!0,b:!1,a:!1}});switch(this.configuration.alphaMode){case 0:return Object(su.g)({colorWrite:su.d});case 1:return Object(su.g)({blending:Object(su.h)(770,1,771,771),colorWrite:su.d});default:return Object(su.g)({blending:Object(su.i)(1,771),colorWrite:su.d})}}}]),r}(nu.a);HC.shader=new ru.a(qC.a,(function(){return r.e(196).then(r.bind(null,1075))}));var WC=function(e){Object(f.a)(r,e);var t=Object(p.a)(r);function r(){var e;return Object(c.a)(this,r),(e=t.apply(this,arguments)).function=0,e.alphaMode=0,e.hasOpacityFactor=!1,e}return r}(iu.a);Object(b.a)([Object(iu.b)({count:4})],WC.prototype,"function",void 0),Object(b.a)([Object(iu.b)({count:3})],WC.prototype,"alphaMode",void 0),Object(b.a)([Object(iu.b)()],WC.prototype,"hasOpacityFactor",void 0);var QC=function(){function e(t,r){Object(c.a)(this,e),this._rctx=t,this._techniqueRepository=r}return Object(l.a)(e,[{key:"dispose",value:function(){this._vao=Object(I.f)(this._vao)}},{key:"compositeTransparent",value:function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,i=this._rctx;ZC.alphaMode=1,ZC.function=2,ZC.hasOpacityFactor=1!==n;var a=this._techniqueRepository.acquire(HC,ZC);i.useProgram(a.program),a.bindPipelineState(i),a.program.bindTexture(e,"colorTexture"),a.program.bindTexture(t,"alphaTexture"),a.program.bindTexture(r,"frontFaceTexture");var o=this.ensureVAO();i.bindVAO(o),i.drawArrays(5,0,Object(mu.f)(o,"geometry")),a.release()}},{key:"compositeSpecial",value:function(e,t){this.composite(e,0,1,t)}},{key:"composite",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,a=this._rctx;ZC.alphaMode=t,ZC.function=n,ZC.hasOpacityFactor=1!==r;var o=this._techniqueRepository.acquire(HC,ZC);a.useProgram(o.program),o.bindPipelineState(a),o.program.bindTexture(e,"tex"),ZC.hasOpacityFactor&&o.program.setUniform1f("opacity",r),3===n&&o.program.setUniform1i("overlayIdx",i);var s=this.ensureVAO();a.bindVAO(s),a.drawArrays(5,0,Object(mu.f)(s,"geometry")),o.release()}},{key:"ensureVAO",value:function(){return Object(I.i)(this._vao)&&(this._vao=Object(Gu.d)(this._rctx)),this._vao}}]),e}(),ZC=new WC,XC=QC;function YC(e,t,r){return Object(qu.n)(t,e)*(r[1]-r[0])+r[0]}function $C(e,t,r){if(t.size<1e4)return dM.compute(e,t);var n=LT();return r.forAll((function(t){t.isVisible&&VT(n,function(e,t){if(!t.isVisible)return;var r=LT(),n=t.getSpatialQueryAccelerator();return Object(I.j)(n)?function(e,t,r){var n=t.eye,i=t.viewForward,a=t.frustum,o=function(e){return e.isVisible},s=r.objectCount;if(s<500)zT(lM,t.near,Math.min(e.near,t.far)),r.forEachInDepthRange(n,i,1,lM,(function(r,n){JC(e,t,r),lM.far=e.near,n.setRange(lM)}),a,o),zT(lM,Math.max(e.far,t.near),t.far),r.forEachInDepthRange(n,i,-1,lM,(function(r,n){JC(e,t,r),lM.near=e.far,n.setRange(lM)}),a,o);else{var c=Math.max(Math.min(s,500),Math.ceil(.1*s)),l=r.findClosest(i,1,a,o,c),u=r.findClosest(i,-1,a,o,c);l&&u&&(eM(e,t,l.boundingVolumeWorldSpace.bounds),eM(e,t,u.boundingVolumeWorldSpace.bounds))}}(r,e,n):function(e,t,r){uM.clear(),r.forAll((function(e){e.isVisible&&0!==e.getNumGeometryRecords()&&uM.add(e)})),uM.empty||(uM.sort(t),zT(lM,t.near,Math.min(e.near,t.far)),uM.forEachInDepthRange(lM,1,(function(r,n){n<e.near&&JC(e,t,r)})),zT(lM,Math.max(e.far,t.near),t.far),uM.forEachInDepthRange(lM,-1,(function(t,r,n){e.far=Math.max(e.far,n)})))}(r,e,t.objects),r}(e,t))})),n}function JC(e,t,r){if(r.isVisible&&Object(yO.j)(t.frustum,r.boundingVolumeWorldSpace.bounds)){var n=r.transformation,i=cM;r.geometryRecords.forEach((function(r){Object(Jl.m)(i,n,r.getShaderTransformation());var a=Object(T.i)(i);KC(e,t,r.geometry.boundingInfo,i,a)}))}}function KC(e,t,r,n,i){if(!Object(I.i)(r)){var a=t.eye,o=t.viewForward;Object(Yl.s)(sM,r.center,n);var s=o[0]*(sM[0]-a[0])+o[1]*(sM[1]-a[1])+o[2]*(sM[2]-a[2]);if(sM[3]=r.radius*i,!(s-sM[3]>e.near&&s+sM[3]<e.far)&&Object(yO.j)(t.frustum,sM))if(r.radius>100&&r.getChildren())for(var c=r.getChildren(),l=0;l<8;++l)c[l]&&KC(e,t,c[l],n,i);else hM.unionDepthRangeWithAABB(e,t.viewProjectionMatrix,n,r.bbMin,r.bbMax)}}function eM(e,t,r){var n=t.eye,i=t.viewForward,a=(r[0]-n[0])*i[0]+(r[1]-n[1])*i[1]+(r[2]-n[2])*i[2];e.near=Math.min(e.near,a-r[3]),e.far=Math.max(e.far,a+r[3])}var tM,rM,nM=function(){function e(){Object(c.a)(this,e),this._items=new zy.a({allocator:function(e){return e||{obj:null,distance:0,near:0,far:0}},deallocator:function(e){return e.obj=null,e.distance=0,e.near=0,e.far=0,e}})}return Object(l.a)(e,[{key:"length",get:function(){return this._items.length}},{key:"empty",get:function(){return 0===this._items.length}},{key:"clear",value:function(){this._items.clear()}},{key:"add",value:function(e){this._items.pushNew().obj=e}},{key:"sort",value:function(e){var t=e.eye,r=e.viewForward;this._items.forAll((function(e){var n=e.obj.boundingVolumeWorldSpace.bounds,i=(n[0]-t[0])*r[0]+(n[1]-t[1])*r[1]+(n[2]-t[2])*r[2];e.distance=i,e.near=i-n[3],e.far=i+n[3]})),this._items.sort((function(e,t){return e.distance-t.distance}))}},{key:"forEachInDepthRange",value:function(e,t,r){if(1===t)for(var n=0;n<this._items.length;++n){var i=this._items.data[n];i.far<e.near||i.near>e.far||r(i.obj,i.near,i.far)}else for(var a=this._items.length-1;a>=0;--a){var o=this._items.data[a];o.far<e.near||o.near>e.far||r(o.obj,o.near,o.far)}}}]),e}(),iM=function(){function e(){Object(c.a)(this,e),this.view=Object(Kl.d)(),this.viewProj=Object(Kl.d)(),this.frustum=Object(yO.c)(),this.geometries=[],this.near=[],this.far=[],this.nearCandidates=[],this.farCandidates=[],this.range={near:0,far:0},this.looseRange={near:0,far:0}}return Object(l.a)(e,[{key:"compute",value:function(e,t){var r=this;this.reset(),Object(Jl.d)(this.view,e.viewMatrix),Object(Jl.m)(this.viewProj,e.projectionMatrix,this.view),Object(yO.b)(e.frustum,this.frustum);var n=this.view,i=n[2],a=n[6],o=n[10],s=n[14],c=this.range,l=0;if(t.forEach((function(e){if(e.instanceParameters.visible&&e.castShadow){var t;e.hasShaderTransformation?(e.computeBoundingSphere(e.getShaderTransformation(),sM,1),t=sM):t=e.boundingSphere;var n=i*t[0]+a*t[1]+o*t[2]+s,c=n-t[3],u=n+t[3];r.geometries[l]=e,r.near[l]=-u,r.far[l]=-c,++l}})),0===this.geometries.length)return c;for(var u=0;u<this.geometries.length;++u)this.near[u]>c.far&&(c.far=this.near[u]),this.near[u]>2&&this.far[u]<c.near&&(c.near=this.far[u]);var d=this.looseRange;d.near=Math.max(.5*c.near,2),d.far=2*c.far;for(var h=0,f=0,p=0;p<this.geometries.length;++p)this.near[p]<c.near&&(this.near[p]>=d.near?c.near=this.near[p]:this.nearCandidates[h++]=p),this.far[p]>c.far&&(this.far[p]<=d.far?c.far=this.far[p]:this.farCandidates[f++]=p);if(0===this.nearCandidates.length&&0===this.farCandidates.length)return c;this.nearCandidates.sort((function(e,t){return r.near[e]<r.near[t]?-1:r.near[e]>r.near[t]?1:0})),this.farCandidates.sort((function(e,t){return r.far[e]<r.far[t]?1:r.far[e]>r.far[t]?-1:0}));for(var b=0;b<this.nearCandidates.length;++b){var v=this.nearCandidates[b];if(this.near[v]<c.near){var m=this.geometries[v],y=m.boundingInfo;this.includeNearBoundingInfoRec(y,m.getShaderTransformation())}}for(var g=0;g<this.farCandidates.length;++g){var O=this.farCandidates[g];if(this.far[O]>c.far){var j=this.geometries[O],_=j.boundingInfo;this.includeFarBoundingInfoRec(_,j.getShaderTransformation())}}return c}},{key:"reset",value:function(){this.geometries.length=0,this.near.length=0,this.far.length=0,this.nearCandidates.length=0,this.farCandidates.length=0,this.range.near=Number.MAX_VALUE,this.range.far=-Number.MAX_VALUE}},{key:"includeNearBoundingInfoRec",value:function(e,t){if(!Object(I.i)(e)){var r=e.getCenter();Object(Yl.s)(sM,r,t);var n=Object(T.i)(t),i=sM[0],a=sM[1],o=sM[2],s=e.getBSRadius()*n,c=this.frustum;if(!(c[0][0]*i+c[0][1]*a+c[0][2]*o+c[0][3]>s||c[1][0]*i+c[1][1]*a+c[1][2]*o+c[1][3]>s||c[2][0]*i+c[2][1]*a+c[2][2]*o+c[2][3]>s||c[3][0]*i+c[3][1]*a+c[3][2]*o+c[3][3]>s)){var l=this.view[2]*i+this.view[6]*a+this.view[10]*o+this.view[14],u=l+s;if(!(-(l-s)<2||-u>=this.range.near))if(-u>this.looseRange.near)this.range.near=-u;else{if(s>100){var d=e.getChildren();if(void 0!==d){for(var h=0;h<8;++h)void 0!==d[h]&&this.includeNearBoundingInfoRec(d[h],t);return}}hM.unionDepthRangeWithAABB(this.range,this.viewProj,t,e.getBBMin(),e.getBBMax())}}}}},{key:"includeFarBoundingInfoRec",value:function(e,t){if(!Object(I.i)(e)){var r=e.getBSRadius(),n=e.getCenter();Object(Yl.s)(sM,n,t);var i=Object(T.i)(t),a=sM[0],o=sM[1],s=sM[2];r*=i;var c=this.frustum;if(!(c[0][0]*a+c[0][1]*o+c[0][2]*s+c[0][3]>r||c[1][0]*a+c[1][1]*o+c[1][2]*s+c[1][3]>r||c[2][0]*a+c[2][1]*o+c[2][2]*s+c[2][3]>r||c[3][0]*a+c[3][1]*o+c[3][2]*s+c[3][3]>r)){var l=this.view[2]*a+this.view[6]*o+this.view[10]*s+this.view[14]-r;if(!(-l<=this.range.far))if(-l<this.looseRange.far)this.range.far=-l;else{if(r>100){var u=e.getChildren();if(void 0!==u){for(var d=0;d<8;++d)void 0!==u[d]&&this.includeFarBoundingInfoRec(u[d],t);return}}hM.unionDepthRangeWithAABB(this.range,this.viewProj,t,e.getBBMin(),e.getBBMax())}}}}}]),e}(),aM=function(){function e(){Object(c.a)(this,e),this.modelViewProj=Object(Kl.d)(),this.clipPosition=[Object($l.e)(),Object($l.e)(),Object($l.e)(),Object($l.e)(),Object($l.e)(),Object($l.e)(),Object($l.e)(),Object($l.e)()]}return Object(l.a)(e,[{key:"unionDepthRangeWithAABB",value:function(e,t,r,n,i){var a=this.modelViewProj;Object(Jl.m)(a,t,r);for(var o=!1,s=0;s<8;++s){var c=this.clipPosition[s],l=0===s||3===s||4===s||7===s?n[0]:i[0],u=0===s||1===s||4===s||5===s?n[1]:i[1],d=s<4?n[2]:i[2];c[0]=a[0]*l+a[4]*u+a[8]*d+a[12],c[1]=a[1]*l+a[5]*u+a[9]*d+a[13],c[2]=a[2]*l+a[6]*u+a[10]*d+a[14],c[3]=a[3]*l+a[7]*u+a[11]*d+a[15]}for(var h=0;h<12;++h){for(var f=this.clipPosition[oM[h][0]],p=this.clipPosition[oM[h][1]],b=this.clipPosition[oM[h][2]],v=this.clipTriangle(f,p,b),m=!0,y=0;y<v.length;++y)if(v[y][3]>=2){m=!1;break}if(!m){o=!0;for(var g=0;g<v.length;++g){var O=v[g][3];O<e.near&&(e.near=O),O>e.far&&(e.far=O)}}}return o}},{key:"inside",value:function(e,t){return 0===t?e[0]>=-e[3]:1===t?e[1]>=-e[3]:2===t?e[0]<=e[3]:3===t?e[1]<=e[3]:void Object(qu.a)(!1)}},{key:"intersect",value:function(e,t,r){var n=0;return 0===r?n=(-e[3]-e[0])/(t[0]-e[0]+t[3]-e[3]):1===r?n=(-e[3]-e[1])/(t[1]-e[1]+t[3]-e[3]):2===r?n=(e[3]-e[0])/(t[0]-e[0]-t[3]+e[3]):3===r&&(n=(e[3]-e[1])/(t[1]-e[1]-t[3]+e[3])),Object(Su.j)(Object($l.e)(),e,t,n)}},{key:"clipTriangle",value:function(e,t,r){for(var n=[e,t,r],i=0;i<4;++i){var a=n;n=[];for(var o=0;o<a.length;++o){var s=a[o],c=a[(o+1)%a.length];this.inside(c,i)?(this.inside(s,i)||n.push(this.intersect(s,c,i)),n.push(c)):this.inside(s,i)&&n.push(this.intersect(s,c,i))}}return n}}]),e}(),oM=[[0,1,3],[2,3,1],[1,5,2],[6,2,5],[5,4,6],[7,6,4],[4,0,7],[3,7,0],[3,2,7],[6,7,2],[4,5,0],[1,0,5]],sM=Object(Nd.c)(),cM=Object(Kl.d)(),lM=LT(),uM=new nM,dM=new iM,hM=new aM,fM=r(544),pM=r(12),bM=r(11),vM=r(87);function mM(e){return yM.apply(this,arguments)}function yM(){return(yM=Object(s.a)(o.a.mark((function e(t){var n,i,a,s,c;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=r.e(217).then(r.bind(null,1076)),i=r.e(218).then(r.bind(null,1077)),e.t0=eu.a,e.next=5,n;case 5:return e.t1=e.sent.default,e.t2={signal:t},a=(0,e.t0)(e.t1,e.t2),e.t3=eu.a,e.next=11,i;case 11:return e.t4=e.sent.default,e.t5={signal:t},s=(0,e.t3)(e.t4,e.t5),e.next=16,a;case 16:return e.t6=e.sent,e.next=19,s;case 19:return e.t7=e.sent,c={mask:e.t6,overlay:e.t7},e.abrupt("return",(Object(q.x)(t),c));case 22:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var gM=function(e){Object(f.a)(r,e);var t=Object(p.a)(r);function r(){var e;return Object(c.a)(this,r),(e=t.apply(this,arguments))._handles=new oe.a,e._magnifier=null,e._imageSources=null,e._imageLoadTask=null,e._resources=null,e.events=new Ii.a,e.attributeLocations=new Map([["position",0]]),e.tmpScreenPoint=Object(Z.f)(),e.tmpRenderPoint=Object(Z.c)(),e}return Object(l.a)(r,[{key:"updating",get:function(){return Object(I.i)(this._imageSources)&&Object(I.j)(this._imageLoadTask)&&!this._imageLoadTask.task.finished}},{key:"magnifier",get:function(){return this._magnifier},set:function(e){var t=this;if(e!==this._magnifier){this._handles.removeAll(),this._magnifier=e;var r=function(){t.updateResourceLoading(),t.events.emit("request-render")};Object(I.j)(this._magnifier)&&this._handles.add(this._magnifier.watch("version",r)),r()}}},{key:"enabled",get:function(){return Object(I.j)(this._validMagnifier)}},{key:"_validMagnifier",get:function(){return Object(I.j)(this._magnifier)&&this._magnifier.visible&&Object(I.j)(this._magnifier.position)&&this._magnifier.size>0?this._magnifier:null}},{key:"factor",get:function(){return Object(I.j)(this._magnifier)&&this._magnifier.factor||1}},{key:"dispose",value:function(){this._magnifier=null,this._handles.destroy(),Object(I.j)(this._imageLoadTask)&&(this._imageLoadTask.task.abort(),this._imageLoadTask=null),this.disposeResources()}},{key:"render",value:function(e,t){var r=this._validMagnifier;if(!Object(I.i)(r)){var n=t.camera.pixelRatio,i=Math.ceil(n*r.size);if(this.updateResources(e,i),!Object(I.i)(this._resources)){var a=this._resources.program;e.useProgram(a);var o=this._resources.textures,s=Math.ceil(1/this.factor*i);o.input.resize(s,s);var c=t.camera.fullWidth,l=t.camera.fullHeight;Object(Z.i)(r.position,this.tmpScreenPoint);var u=t.camera.screenToRender(this.tmpScreenPoint,this.tmpRenderPoint),d=.5*s,h=.5*s;u[0]=Object(m.e)(u[0],d,c-d-1),u[1]=Object(m.e)(u[1],h,l-h-1);var f=Math.floor(u[0]-d),p=Math.floor(u[1]-h);a.bindTexture(o.input,"textureInput"),e.gl.copyTexImage2D(o.input.descriptor.target,0,o.input.descriptor.pixelFormat,f,p,s,s,0);var b=r.offset.x*n,v=r.offset.y*n,y=(u[0]+b)/c*2-1,g=(u[1]-v)/l*2-1,O=i/c*2,j=i/l*2;e.bindVAO(this._resources.vao),a.bindTexture(o.overlay,"textureOverlay"),a.bindTexture(o.mask,"textureMask"),a.setUniform4f("drawPosition",y,g,O,j),a.setUniform1i("maskEnabled",r.maskEnabled?1:0),a.setUniform1i("overlayEnabled",r.overlayEnabled?1:0),e.setPipelineState(this._resources.pipelineState),e.drawArrays(5,0,4)}}}},{key:"updateResourceLoading",value:function(){var e=this,t=this._validMagnifier;if(!Object(I.i)(t)){var r=t.maskUrl,n=t.overlayUrl;!Object(I.j)(this._imageLoadTask)||this._imageLoadTask.maskUrl===r&&this._imageLoadTask.overlayUrl===n||(this._imageLoadTask.task.abort(),this._imageLoadTask=null,this._imageSources=null),Object(I.j)(this._imageSources)||Object(I.j)(this._imageLoadTask)||(this._imageLoadTask={maskUrl:r,overlayUrl:n,task:Object(q.i)(function(){var t=Object(s.a)(o.a.mark((function t(i){var a,s,c;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=Object(I.i)(r)||Object(I.i)(n)?mM(i):null,s=Object(I.j)(r)?Object(eu.a)(r,{signal:i}):a.then((function(e){return e.mask})),c=Object(I.j)(n)?Object(eu.a)(n,{signal:i}):a.then((function(e){return e.overlay})),t.next=3,s;case 3:return t.t0=t.sent,t.next=6,c;case 6:t.t1=t.sent,e._imageSources={mask:t.t0,overlay:t.t1},e.disposeResources(),e.events.emit("request-render");case 10:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())},this._imageLoadTask.task.promise.then((function(){return e.notifyChange("updating")}),(function(){return e.notifyChange("updating")})))}}},{key:"updateResources",value:function(e,t){if(this.enabled)if(Object(I.j)(this._resources)){if(this._resources.textures.size!==t){var r=this.createTextureResources(e,t);if(Object(I.i)(r))return void this.disposeResources();this.disposeTextureResources(this._resources.textures),this._resources.textures=r}}else{var n=this.createTextureResources(e,t);Object(I.i)(n)||(this._resources={textures:n,program:this.createProgram(e),vao:Object(Gu.d)(e,bS.a,this.attributeLocations,0,1),pipelineState:Object(su.g)({blending:Object(su.i)(1,771),depthTest:null,depthWrite:null,colorWrite:su.d})})}else this.disposeResources()}},{key:"disposeResources",value:function(){Object(I.i)(this._resources)||(this.disposeTextureResources(this._resources.textures),this._resources.program.dispose(),this._resources.vao.dispose(),this._resources=null)}},{key:"disposeTextureResources",value:function(e){e.mask.dispose(),e.overlay.dispose(),e.input.dispose()}},{key:"createTextureResources",value:function(e,t){if(Object(I.i)(this._imageSources))return null;this._imageSources.overlay.width=t,this._imageSources.overlay.height=t,this._imageSources.mask.width=t,this._imageSources.mask.height=t;var r=new vu.a(e,{target:3553,pixelFormat:6408,internalFormat:6408,dataType:5121,wrapMode:33071,samplingMode:9729,flipped:!0,preMultiplyAlpha:!Object(cw.x)(this._imageSources.overlay.src)||!Object(uw.b)(e).svgAlwaysPremultipliesAlpha},this._imageSources.overlay),n=new vu.a(e,{target:3553,pixelFormat:6406,internalFormat:6406,dataType:5121,wrapMode:33071,samplingMode:9729,flipped:!0},this._imageSources.mask);return{input:new vu.a(e,{target:3553,pixelFormat:6408,internalFormat:6408,dataType:5121,wrapMode:33071,samplingMode:9729,flipped:!1}),mask:n,overlay:r,size:t}}},{key:"createProgram",value:function(e){var t=function(){var e=new vM.a;return e.attributes.add("position","vec2"),e.vertex.uniforms.add("proj","mat4"),e.vertex.uniforms.add("drawPosition","vec4"),e.varyings.add("vUV","vec2"),e.vertex.code.add(Object(bM.a)(tM||(tM=Object(pM.a)(["void main(void) {\nvUV = position;\ngl_Position = vec4(drawPosition.xy + vec2(position - 0.5) * drawPosition.zw, 0.0, 1.0);\n}"])))),e.fragment.uniforms.add("textureInput","sampler2D"),e.fragment.uniforms.add("textureMask","sampler2D"),e.fragment.uniforms.add("textureOverlay","sampler2D"),e.fragment.uniforms.add("maskEnabled","bool"),e.fragment.uniforms.add("overlayEnabled","bool"),e.fragment.code.add(Object(bM.a)(rM||(rM=Object(pM.a)(["const float barrelFactor = 1.1;\nvec2 barrel(vec2 uv) {\nvec2 uvn = uv * 2.0 - 1.0;\nif (uvn.x == 0.0 && uvn.y == 0.0) {\nreturn vec2(0.5, 0.5);\n}\nfloat theta = atan(uvn.y, uvn.x);\nfloat r = pow(length(uvn), barrelFactor);\nreturn r * vec2(cos(theta), sin(theta)) * 0.5 + 0.5;\n}\nvoid main() {\nfloat mask = maskEnabled ? texture2D(textureMask, vUV).a : 1.0;\nvec4 inputColor = texture2D(textureInput, barrel(vUV)) * mask;\nvec4 overlayColor = overlayEnabled ? texture2D(textureOverlay, vUV) : vec4(0);\ngl_FragColor = overlayColor + (1.0 - overlayColor.a) * inputColor;\n}"])))),e}();return new ou.a(e,t,this.attributeLocations)}}]),r}(de.a);Object(b.a)([Object(y.b)()],gM.prototype,"_imageSources",void 0),Object(b.a)([Object(y.b)()],gM.prototype,"_imageLoadTask",void 0),Object(b.a)([Object(y.b)({readOnly:!0})],gM.prototype,"updating",null),gM=Object(b.a)([Object(w.a)("esri/views/3d/webgl-engine/lib/MagnifierHelper")],gM);var OM=function(){function e(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.9;Object(c.a)(this,e),this._alpha=.9,this._startTime=0,this._count=0,this._sum=0,this._smooth=0,this._min=0,this._max=0,this._name=t,this._alpha=r,this.reset()}return Object(l.a)(e,[{key:"reset",value:function(){this._count=0,this._sum=0,this._smooth=0,this._min=1/0,this._max=0}},{key:"name",get:function(){return this._name}},{key:"count",get:function(){return this._count}},{key:"average",get:function(){return this._count>0?this._sum/this._count:0}},{key:"smooth",get:function(){return this._smooth}},{key:"min",get:function(){return this._min}},{key:"max",get:function(){return this._max}},{key:"begin",value:function(){this._startTime=performance.now()}},{key:"end",value:function(){var e=performance.now()-this._startTime;this._count+=1,this._sum+=e,this._smooth=this._alpha*e+(1-this._alpha)*this._smooth,this._min=Math.min(this._min,e),this._max=Math.max(this._max,e)}},{key:"toJSON",value:function(){return{name:this.name,count:this.count,average:this.average,smooth:this.smooth,min:this.min,max:this.max}}}]),e}();!function(e){var t={},r={};function n(r){return r in t||(t[r]=new e(r)),t[r]}function i(e){console.log(n(e).toJSON())}e.get=n,e.begin=function(e){n(e).begin()},e.end=function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];n(e).end();var a=performance.now();t&&(!(e in r)||a>=r[e]+1e3)&&(i(e),r[e]=a)},e.log=i,e.logAll=function(){for(var e in t)i(e)}}(OM||(OM={}));var jM=OM,_M=function e(){Object(c.a)(this,e),this.identifier=0,this.transparent=!1,this.integratedMesh=!1,this.viewTransform=new hC.a.ViewProjectionTransform,this.transformNormal_ViewFromGlobal=Object(Cf.b)(),this.cameraNearFar=Object(ku.b)(),this.inverseViewport=Object(ku.b)(),this.slicePlane=Object(ee.b)(),this.slicePlaneEnabled=!0,this.ambientOcclusionEnabled=!0,this.shadowsEnabled=!0,this.sceneHasOcludees=!1,this.transparencyPassType=3},wM=function e(){Object(c.a)(this,e),this.identifier=1,this.viewTransform=new hC.a.ViewProjectionTransform,this.cameraNearFar=Object(ku.b)(),this.slicePlane=Object(ee.b)()},xM=function e(){Object(c.a)(this,e),this.identifier=2,this.viewTransform=new hC.a.ViewProjectionTransform,this.slicePlane=Object(ee.b)(),this.inverseViewport=Object(ku.b)(),this.viewport=Object($l.e)()},kM=function(){function e(t,r){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;Object(c.a)(this,e),this._rctx=t,this._techniqueRepository=r,this._sorting=n,this._draws=new zy.a({initialSize:32,allocator:function(e){return e||{material:null,geometry:null,geometryRanges:null,bindDrawParams:null,depthSquaredHint:0,indexType:0}}}),this._passBoundTechniques=new Set,this._previouslyBoundMaterials=new Map,this._previouslyBoundDraw=new Map}return Object(l.a)(e,[{key:"submitDraw",value:function(e,t,r,n,i){var a=this._draws.pushNew();a.geometry=t,a.geometryRanges=r,a.material=e,a.bindDrawParams=n,a.depthSquaredHint=i,a.indexType=t.indexed?Object(I.s)(t.vao.indexBuffer).indexType:0}},{key:"dispatch",value:function(e){var t=this._rctx;this._passBoundTechniques.clear(),this._previouslyBoundMaterials.clear(),this._previouslyBoundDraw.clear();for(var r=null,n=this._draws.length,i=0;i<n;i++){var a=this._draws.data[i],o=a.geometry,s=a.material.getTechnique(this._techniqueRepository,e,o.parameters);s===r&&3===s.configuration.transparencyPassType||(t.useProgram(s.program),t.setPipelineState(s.pipeline),r=s),this._passBoundTechniques.has(s)||(s.bindPass(e),this._passBoundTechniques.add(s)),t.bindVAO(o.vao),this._previouslyBoundMaterials.get(s)!==a.material&&(s.bindMaterial(a.material,e),this._previouslyBoundMaterials.set(s,a.material)),this._previouslyBoundDraw.get(s)!==a.bindDrawParams&&(s.bindDraw(a.bindDrawParams,a.material,e),this._previouslyBoundDraw.set(s,a.bindDrawParams));var c=a.geometryRanges,l=c.length;if(0!==a.indexType)for(var u=SM.get(a.indexType),d=0;d<l;d+=2){var h=c[d],f=c[d+1];t.drawElements(o.primitiveType,f,a.indexType,h*u)}else for(var p=0;p<l;p+=2){var b=c[p],v=c[p+1];t.drawArrays(o.primitiveType,b,v)}}}},{key:"prepareSubmit",value:function(){this._draws.clear()}},{key:"finishSubmit",value:function(){var e=0===this._sorting?1:-1;this._draws.sort((function(t,r){var n=e*(t.depthSquaredHint-r.depthSquaredHint);return 0!==n?n:t.geometry.vao.size-r.geometry.vao.size}))}},{key:"count",get:function(){return this._draws.length}}]),e}(),SM=new Map;SM.set(5121,1),SM.set(5123,2),SM.set(5125,4);var TM=function(){function e(t,r){Object(c.a)(this,e),this.rctx=t,this.shaderTechniqueRepository=r,this.canRender=!0,this._materialPassParams=new _M,this._shadowPassParams=new wM,this._highlightPassParams=new xM,this._systems=new Set,this._passes=new Array,this._shadowMapPass=this._registerPass(new kM(t,this.shaderTechniqueRepository)),this.passes={materialOpaque:this._registerPass(new kM(t,this.shaderTechniqueRepository)),materialTransparent:this._registerPass(new kM(t,this.shaderTechniqueRepository,1)),materialIntegratedMesh:this._registerPass(new kM(t,this.shaderTechniqueRepository)),shadowMap:this._shadowMapPass,highlight:this._registerPass(new kM(t,this.shaderTechniqueRepository)),highlightIntegratedMesh:this._registerPass(new kM(t,this.shaderTechniqueRepository)),highlightShadowMap:this._registerPass(new kM(t,this.shaderTechniqueRepository)),defaultShadowMap:this._registerPass(new kM(t,this.shaderTechniqueRepository))}}return Object(l.a)(e,[{key:"register",value:function(e){this._systems.add(e)}},{key:"prepareRender",value:function(e){var t=this;0!==this._systems.size&&(this._passes.forEach((function(e){return e.prepareSubmit()})),this._systems.forEach((function(r){return r.submit(t.passes,{camera:e})})),this._passes.forEach((function(e){return e.finishSubmit()})),this.shaderTechniqueRepository.frameUpdate())}},{key:"render",value:function(e){if(0===this._systems.size)return!1;if(4===e.slot)switch(this._configure(e),e.pass){case 0:this._materialPassParams.subPass=0,this._configureMaterialColorPass(e),this.passes.materialOpaque.dispatch(this._materialPassParams);break;case 2:this._materialPassParams.subPass=2,this.passes.materialOpaque.dispatch(this._materialPassParams);break;case 3:this._materialPassParams.subPass=3,this.passes.materialOpaque.dispatch(this._materialPassParams);break;case 5:this.passes.highlight.dispatch(this._highlightPassParams);break;case 4:this._shadowMapPass.dispatch(this._shadowPassParams);break;case 7:Object(I.j)(this.passes.highlightShadowMap)&&this.passes.highlightShadowMap.dispatch(this._shadowPassParams);break;case 6:Object(I.j)(this.passes.defaultShadowMap)&&this.passes.defaultShadowMap.dispatch(this._shadowPassParams)}if(6===e.slot)switch(this._configure(e),e.pass){case 0:this._materialPassParams.subPass=0,this._configureMaterialColorPass(e),this.passes.materialTransparent.dispatch(this._materialPassParams);break;case 1:this._materialPassParams.subPass=1,this._configureMaterialColorPass(e),this.passes.materialTransparent.dispatch(this._materialPassParams);break;case 2:this._materialPassParams.subPass=2,this.passes.materialTransparent.dispatch(this._materialPassParams);break;case 3:this._materialPassParams.subPass=3,this.passes.materialTransparent.dispatch(this._materialPassParams)}if(1===e.slot)switch(this._configure(e),e.pass){case 0:this._materialPassParams.subPass=0,this._configureMaterialColorPass(e),this._materialPassParams.ssrParams=e.ssrParams,this.passes.materialIntegratedMesh.dispatch(this._materialPassParams);break;case 2:this._materialPassParams.subPass=2,this.passes.materialIntegratedMesh.dispatch(this._materialPassParams);break;case 3:this._materialPassParams.subPass=3,this.passes.materialIntegratedMesh.dispatch(this._materialPassParams);break;case 5:this.passes.highlightIntegratedMesh.dispatch(this._highlightPassParams)}return!0}},{key:"notifyDirty",value:function(){this.context.requestRender()}},{key:"slots",value:function(){return[4,6,1]}},{key:"initializeRenderContext",value:function(e){this.context=e}},{key:"uninitializeRenderContext",value:function(){}},{key:"queryDepthRange",value:function(e){var t={near:1/0,far:-1/0};return this._systems.forEach((function(r){var n=r.queryShadowCasterDepthRange(e);Object(I.j)(n)&&VT(t,n,t)})),t}},{key:"shadowCastingEnabled",get:function(){return Object(I.j)(this.passes.shadowMap)},set:function(e){e?(this._materialPassParams.shadowsEnabled=!0,this.passes.shadowMap=this._shadowMapPass):(this._materialPassParams.shadowsEnabled=!1,this.passes.shadowMap=null)}},{key:"screenSpaceReflectionsEnabled",get:function(){return Object(I.j)(this._materialPassParams.ssrParams.ssrEnabled)},set:function(e){this._materialPassParams.ssrParams.ssrEnabled=!!e}},{key:"_configureMaterialColorPass",value:function(e){var t=this;this._materialPassParams.bindShadowMap=function(r){e.shadowMap.bind(r);var n=t._materialPassParams.viewTransform;Object(Yl.h)(CM,n.worldFromView_TL,n.worldFromView_TH),e.shadowMap.bindView(r,CM)},this._materialPassParams.bindAmbientOcclusion=function(t){return e.ssaoHelper.bind(t)},this._materialPassParams.ambientOcclusionEnabled=!!e.ssaoHelper&&e.ssaoHelper.ready,this._materialPassParams.sceneHasOcludees=e.hasOccludees}},{key:"_configure",value:function(e){var t=4===e.pass||7===e.pass||6===e.pass?this._shadowPassParams:5===e.pass?this._highlightPassParams:this._materialPassParams;this._updateParameters(e,t)}},{key:"_updateParameters",value:function(e,t){var r=e.camera,n=r.viewInverseTransposeMatrix;Object(Yl.y)(CM,n[3],n[7],n[11]),PM.set(CM),Object(Yl.m)(t.viewTransform.worldFromView_TH,PM.high),Object(Yl.m)(t.viewTransform.worldFromView_TL,PM.low),Object(Tf.f)(t.viewTransform.viewFromCameraRelative_RS,r.viewMatrix),Object(Jl.d)(t.viewTransform.projFromView,r.projectionMatrix),0===t.identifier?(this._materialPassParams.transparent=6===e.slot,this._materialPassParams.integratedMesh=1===e.slot,this._materialPassParams.lighting=e.scenelightingData,Object(Tf.n)(MM,t.viewTransform.viewFromCameraRelative_RS),Object(Tf.e)(t.transformNormal_ViewFromGlobal,MM),Object(xu.r)(t.cameraNearFar,r.near,r.far)):1===t.identifier?Object(xu.r)(t.cameraNearFar,r.near,r.far):2===t.identifier&&(t.highlightDepthTexture=e.highlightDepthTexture,Object(Su.c)(t.viewport,r.fullViewport)),0!==t.identifier&&2!==t.identifier||(t.inverseViewport[0]=1/r.fullViewport[2],t.inverseViewport[1]=1/r.fullViewport[3]),Object(ee.e)(e.sliceHelper.plane,t.slicePlane),Object(Yl.l)(t.slicePlane.origin,t.slicePlane.origin,CM),t.slicePlaneEnabled=e.sliceHelper.isEnabled,this._materialPassParams.transparencyPassType=e.transparencyPassType,this._materialPassParams.multipassTerrainParams=e.multipassTerrainParams}},{key:"_registerPass",value:function(e){return this._passes.push(e),e}},{key:"needsHighlight",get:function(){return this.passes.highlight.count>0||this.passes.highlightIntegratedMesh.count>0}}]),e}(),CM=Object(X.e)(),MM=Object(Cf.b)(),PM=new MC,AM=r(520),EM=r(628),RM=function(e){Object(f.a)(r,e);var t=Object(p.a)(r);function r(){return Object(c.a)(this,r),t.apply(this,arguments)}return Object(l.a)(r,[{key:"initializeProgram",value:function(e){var t=r.shader.get().build(this.configuration);return new ou.a(e.rctx,t,au.a)}},{key:"bindApplyPass",value:function(e){this.program.setUniform4fv("color",e.color),this.program.setUniform4fv("haloColor",e.haloColor),this.program.setUniform1f("outlineSize",8.6),this.program.setUniform1f("blurSize",.4),this.program.setUniform4f("opacities",e.haloOpacity,e.haloOpacityOccluded,e.fillOpacity,e.fillOpacityOccluded)}},{key:"initializePipeline",value:function(){return 1===this.configuration.highlightStage?Object(su.g)({blending:Object(su.h)(770,1,771,771),colorWrite:su.d}):Object(su.g)({colorWrite:su.d})}},{key:"primitiveType",get:function(){return this.configuration.gridOptimization?4:5}}]),r}(nu.a);RM.shader=new ru.a(EM.a,(function(){return r.e(199).then(r.bind(null,1078))}));var IM=function(e){Object(f.a)(r,e);var t=Object(p.a)(r);function r(){var e;return Object(c.a)(this,r),(e=t.apply(this,arguments)).highlightStage=0,e.gridOptimization=!1,e}return r}(iu.a);Object(b.a)([Object(iu.b)({count:3})],IM.prototype,"highlightStage",void 0),Object(b.a)([Object(iu.b)()],IM.prototype,"gridOptimization",void 0);var DM=function(){function e(t,r){Object(c.a)(this,e),this._techniqueRep=t,this._rctx=r,this.viewportToRestore=Object($l.e)(),this.defaultOptions={color:Object(F_.c)(1,0,1,1),haloColor:Object(F_.c)(1,0,1,1),haloOpacity:1,fillOpacity:.2,haloOpacityOccluded:.25,fillOpacityOccluded:.05,shadowColor:Object(F_.c)(1,0,1,1),shadowOpacity:.15,occludedShadowOpacity:.075},this._grid={coverageMipmap:null,vao:null,verticalCellCount:0,horizontalCellCount:0,cellPixelSize:0,mipmapLevels:0,viewportWidth:0,viewportHeight:0}}return Object(l.a)(e,[{key:"assertResources",value:function(){if(!this.quadVAO){this.quadVAO=Object(Gu.d)(this._rctx);var e={colorTarget:0,depthStencilTarget:0,width:0,height:0},t={target:3553,pixelFormat:6408,dataType:5121,samplingMode:9729,wrapMode:33071,width:0,height:0};this.blur0Fbo=new Sk.a(this._rctx,e,t),this.blur1Fbo=new Sk.a(this._rctx,e,t);var r=new IM;r.highlightStage=0,r.gridOptimization=!1,this.blurTechnique=this._techniqueRep.acquire(RM,r),r.highlightStage=0,r.gridOptimization=!0,this.blurGridTechnique=this._techniqueRep.acquire(RM,r),r.highlightStage=1,r.gridOptimization=!1,this.applyTechnique=this._techniqueRep.acquire(RM,r),r.highlightStage=1,r.gridOptimization=!0,this.applyGridTechnique=this._techniqueRep.acquire(RM,r),r.highlightStage=2,r.gridOptimization=!1,this.downsampleTechnique=this._techniqueRep.acquire(RM,r)}}},{key:"dispose",value:function(){if(this._grid.coverageMipmap)for(var e=1;e<this._grid.coverageMipmap.length;e++)this._grid.coverageMipmap[e].dispose();this._grid.vao&&this._grid.vao.dispose(!0),this.quadVAO&&(this.quadVAO.dispose(!0),this.quadVAO=null),this.blur0Fbo=Object(I.f)(this.blur0Fbo),this.blur1Fbo=Object(I.f)(this.blur1Fbo)}},{key:"profilingCallback",get:function(){return Vy.a.HIGHLIGHTS_PROFILE_TO_CONSOLE?function(e){return console.log(e)}:null}},{key:"setDefaultOptions",value:function(e){this.defaultOptions=e}},{key:"render",value:function(e,t,r){var n=e.pixelRatio,i=Vy.a.HIGHLIGHTS_GRID_OPTIMIZATION_ENABLED,a=this._rctx;this.assertResources(),Object(Su.c)(this.viewportToRestore,e.fullViewport);var o=e.fullWidth,s=e.fullHeight,c=Math.ceil(o/n),l=Math.ceil(s/n);this.blur0Fbo.resize(c,l),this.blur1Fbo.resize(c,l),a.bindVAO(this.quadVAO);var u=null,d=i?this.blurGridTechnique:this.blurTechnique;d.bindPipelineState(a),a.useProgram(d.program),i?(this._gridUpdateResources(t,32),this._gridComputeMipmap(),u=this._grid.vao,d.program.bindTexture(this._grid.coverageMipmap[this._grid.mipmapLevels].colorTexture,"coverageTex")):u=this.quadVAO,a.bindVAO(u),a.bindFramebuffer(this.blur0Fbo),a.setViewport(0,0,c,l),a.setClearColor(0,0,0,0),a.clear(16384),d.program.bindTexture(t.colorTexture,"tex"),d.program.setUniform2f("blurSize",1/c,0),a.drawArrays(d.primitiveType,0,Object(mu.f)(u,"geometry")),a.bindFramebuffer(this.blur1Fbo),a.clear(16384),d.program.bindTexture(this.blur0Fbo.colorTexture,"tex"),d.program.setUniform2f("blurSize",0,1/l),a.drawArrays(d.primitiveType,0,Object(mu.f)(u,"geometry"));var h=i?this.applyGridTechnique:this.applyTechnique;if(a.bindFramebuffer(r),h.bindPipelineState(a),a.setViewport(this.viewportToRestore[0],this.viewportToRestore[1],this.viewportToRestore[2],this.viewportToRestore[3]),a.useProgram(h.program),h.program.bindTexture(this.blur1Fbo.colorTexture,"tex"),h.program.bindTexture(t.colorTexture,"origin"),i){var f=this._grid.coverageMipmap[this._grid.mipmapLevels].colorTexture;h.program.bindTexture(f,"coverageTex")}h.bindApplyPass(this.defaultOptions),a.drawArrays(h.primitiveType,0,Object(mu.f)(u,"geometry")),a.bindVAO(null)}},{key:"_gridUpdateResources",value:function(e,t){var r=this._rctx,n=this._grid,i=!1;if(null===n.coverageMipmap&&(n.coverageMipmap=[e],i=!0),n.viewportWidth===e.width&&n.viewportHeight===e.height||(i=!0,n.viewportWidth=e.width,n.viewportHeight=e.height),n.coverageMipmap[0]=e,n.cellPixelSize!==t&&(n.cellPixelSize=t,i=!0),i){for(var a=1;a<n.coverageMipmap.length;a++)n.coverageMipmap[a].dispose();n.mipmapLevels=Math.ceil(Math.log(n.cellPixelSize)*Math.LOG2E),n.coverageMipmap.length=n.mipmapLevels+1;for(var o=0;o<n.mipmapLevels;o++){var s=n.coverageMipmap[o],c={target:3553,pixelFormat:6407,dataType:33635,samplingMode:9729,wrapMode:33071,width:Math.ceil(s.width/2),height:Math.ceil(s.height/2)},l={colorTarget:0,depthStencilTarget:0,width:Math.ceil(s.width/2),height:Math.ceil(s.height/2)};n.coverageMipmap[o+1]=new Sk.a(r,l,c)}}var u=Math.ceil(e.height/n.cellPixelSize),d=Math.ceil(e.width/n.cellPixelSize);if(!n.vao||n.verticalCellCount!==u||n.horizontalCellCount!==d){n.verticalCellCount=u,n.horizontalCellCount=d;for(var h=u+1,f=d+1,p=1/u,b=1/d,v=new Float32Array(24*h*f),m=0,y=0;y<h;y++)for(var g=0;g<f;g++)v[m+0]=(g-.5)*b*2-1,v[m+1]=(y-.5)*p*2-1,v[m+2]=g*b,v[m+3]=y*p,v[m+4]=(g+.5)*b*2-1,v[m+5]=(y-.5)*p*2-1,v[m+6]=g*b,v[m+7]=y*p,v[m+8]=(g-.5)*b*2-1,v[m+9]=(y+.5)*p*2-1,v[m+10]=g*b,v[m+11]=y*p,v[m+12]=(g-.5)*b*2-1,v[m+13]=(y+.5)*p*2-1,v[m+14]=g*b,v[m+15]=y*p,v[m+16]=(g+.5)*b*2-1,v[m+17]=(y-.5)*p*2-1,v[m+18]=g*b,v[m+19]=y*p,v[m+20]=(g+.5)*b*2-1,v[m+21]=(y+.5)*p*2-1,v[m+22]=g*b,v[m+23]=y*p,m+=24;n.vao&&n.vao.dispose(!0),n.vao=new yu.a(r,au.a,{geometry:bS.b},{geometry:bu.a.createVertex(r,35044,v)})}}},{key:"_gridComputeMipmap",value:function(){var e=this._rctx,t=this._grid,r=this.downsampleTechnique.program;this.downsampleTechnique.bindPipelineState(e),e.bindVAO(this.quadVAO),e.useProgram(r);for(var n=0;n<t.mipmapLevels;n++){e.bindFramebuffer(t.coverageMipmap[n+1]),r.bindTexture(t.coverageMipmap[n].colorTexture,"tex");var i=t.coverageMipmap[n+1].width,a=t.coverageMipmap[n+1].height;r.setUniform2f("invFramebufferDim",1/i,1/a),e.setViewport(0,0,i,a),e.drawArrays(5,0,Object(mu.f)(this.quadVAO,"geometry"))}}},{key:"getGpuMemoryUsage",value:function(){var e=(Object(I.j)(this.blur0Fbo)?this.blur0Fbo.gpuMemoryUsage:0)+(Object(I.j)(this.blur1Fbo)?this.blur1Fbo.gpuMemoryUsage:0);if(this._grid.coverageMipmap){var t,r=Object(i.a)(this._grid.coverageMipmap);try{for(r.s();!(t=r.n()).done;){e+=t.value.gpuMemoryUsage}}catch(n){r.e(n)}finally{r.f()}}return e}},{key:"test",get:function(){return{coverage:this._grid.coverageMipmap,blur:[this.blur0Fbo,this.blur1Fbo]}}}]),e}(),FM=r(116),LM=r(366),zM={dataType:5121,internalFormat:6408},VM={},NM=function(){function e(t){Object(c.a)(this,e),this.rctx=t,this._activeTargets=new Set,this._depthTextures=new Map,this._depthBuffers=new Map,this._colorTextures=new Map,this._framebuffers=new Map,this._nextId=1,this.depthTextureSupported=t.capabilities.depthTexture}return Object(l.a)(e,[{key:"dispose",value:function(){this._depthBuffers.forEach((function(e){return e.dispose()})),this._depthBuffers.clear(),this._depthTextures.forEach((function(e){return e.dispose()})),this._depthTextures.clear(),this._colorTextures.forEach((function(e){return e.dispose()})),this._colorTextures.clear(),this._framebuffers.forEach((function(e){return e.dispose()})),this._framebuffers.clear()}},{key:"disposeTargetResource",value:function(e){var t=e.id;this._activeTargets.has(t)&&(this._activeTargets.delete(t),this.disposeWithFramebuffers(this._depthTextures,t),this.disposeWithFramebuffers(this._depthBuffers,t),this.disposeWithFramebuffers(this._colorTextures,t))}},{key:"disposeWithFramebuffers",value:function(e,t){var r=this,n=e.get(t);n&&(this._framebuffers.forEach((function(e,t){e.colorAttachment!==n&&e.depthStencilAttachment!==n||(e.detachAll(),e.dispose(),r._framebuffers.delete(t))})),n.dispose(),e.delete(t))}},{key:"getDepthTexture",value:function(e,t){if(this.depthTextureSupported){var r=this._depthTextures.get(e.id);return r&&(r.descriptor.width===t.width&&r.descriptor.height===t.height||(r.dispose(),r=void 0)),r||(r=new vu.a(this.rctx,{target:3553,pixelFormat:34041,dataType:34042,samplingMode:9728,wrapMode:33071,width:t.width,height:t.height}),this._depthTextures.set(e.id,r),this._activeTargets.add(e.id)),r}}},{key:"getAllocatedDepthTexture",value:function(e){return this._depthTextures.get(e.id)}},{key:"getDepthBuffer",value:function(e,t){if(!this.depthTextureSupported){var r=this._depthBuffers.get(e.id);return r?r.descriptor.width===t.width&&r.descriptor.height===t.height||r.resize(t.width,t.height):(r=new LM.a(this.rctx,Object(ie.a)({internalFormat:34041},t)),this._depthBuffers.set(e.id,r),this._activeTargets.add(e.id)),r}}},{key:"getColorTexture",value:function(e,t){var r=this._colorTextures.get(e.id);return r&&(r.descriptor.width===t.width&&r.descriptor.height===t.height||(r.dispose(),r=void 0)),r||(r=new vu.a(this.rctx,{target:3553,pixelFormat:6408,internalFormat:e.internalFormat,dataType:e.dataType,samplingMode:null!=e.samplingMode?e.samplingMode:9729,wrapMode:33071,width:t.width,height:t.height}),this._colorTextures.set(e.id,r),this._activeTargets.add(e.id)),r}},{key:"getAllocatedColorTexture",value:function(e){return this._colorTextures.get(e.id)}},{key:"registerDepthTarget",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(ie.a)(Object(ie.a)({id:this._nextId++},VM),e)}},{key:"registerColorTarget",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(ie.a)(Object(ie.a)({id:this._nextId++},zM),e)}},{key:"getFramebuffer",value:function(e,t,r){var n=this.getKey(t,r),i=this._framebuffers.get(n),a=this.getColorTexture(t,e);if(this.depthTextureSupported){var o=r?this.getDepthTexture(r,e):void 0;return i?((i.width!==e.width||i.height!==e.height||i.colorTexture!==a||i.depthStencilTexture!==o)&&(i.detachAll(),i.resize(e.width,e.height),i.attachColorTexture(a),i.attachDepthStencilTexture(o)),i):(i=r?new Sk.a(this.rctx,{colorTarget:0,depthStencilTarget:4},a,o):new Sk.a(this.rctx,{colorTarget:0,depthStencilTarget:0},a),this._framebuffers.set(n,i),i)}var s=r?this.getDepthBuffer(r,e):void 0;return i?((i.width!==e.width||i.height!==e.height||i.colorTexture!==a)&&(i.detachAll(),i.resize(e.width,e.height),i.attachColorTexture(a),i.attachDepthStencilBuffer(s)),i):(i=new Sk.a(this.rctx,{colorTarget:0,depthStencilTarget:r?3:0},a,s),this._framebuffers.set(n,i),i)}},{key:"getKey",value:function(e,t){return"".concat(e.id,"_").concat(t?t.id:"X","_").concat(e.name).concat(t?"_"+t.name:"")}},{key:"getGpuMemoryUsage",value:function(){var e=0,t=new Set,r=function(r){t.has(r)||(t.add(r),e+=Object(mu.c)(r))};return this._depthTextures.forEach(r),this._colorTextures.forEach(r),this._depthBuffers.forEach(r),e}}]),e}(),UM=function(){function e(t,r){Object(c.a)(this,e),this._rctx=t,this._compositingHelper=r,this._currentRenderTarget=0,this.dimensions={width:4,height:4},this._needLastFrameColorTexture=!1,this._background={type:"color",color:[0,0,0,1]};var n=this._rctx,i="webgl2"===n.webglVersion;this.renderTargetHelper=new NM(n);var a=this.renderTargetHelper;this.mainColorTarget0=a.registerColorTarget({name:"mainColorTarget0"}),this.mainColorTarget1=a.registerColorTarget({name:"mainColorTarget1"}),this.frontFaceTarget=a.registerColorTarget({name:"frontFaceTarget"});var o=function(e){return a.registerColorTarget({name:e,dataType:5126,internalFormat:i?34836:6408,samplingMode:9728})};this.colorFloatTarget=o("colorFloatTarget"),this.alphaFloatTarget=o("alphaFloatTarget"),this.mainDepth=a.registerDepthTarget({name:"mainDepth"}),this.linearDepth=a.registerColorTarget({name:"linearDepth",samplingMode:9728}),this.terrainLinearDepth=a.registerColorTarget({name:"terrainLinearDepth"}),this.geometryLinearDepth=a.registerColorTarget({name:"geometryLinearDepth"}),this.normal=a.registerColorTarget({name:"normal"}),this.highlight=a.registerColorTarget({name:"highlight",internalFormat:i?32854:6408,dataType:32819}),this.hudVisibility=a.registerColorTarget({name:"hudVisibility",internalFormat:i?32854:6408,dataType:32819}),this.tmpColor=a.registerColorTarget({name:"tmpColor"}),this.tmpDepth=a.registerDepthTarget({name:"tmpDepth"}),this.hudColor=a.registerColorTarget({name:"hudColor"})}return Object(l.a)(e,[{key:"dispose",value:function(){this.renderTargetHelper.dispose()}},{key:"width",get:function(){return this.dimensions.width}},{key:"height",get:function(){return this.dimensions.height}},{key:"background",get:function(){return this._background},set:function(e){this._background=e}},{key:"currentColorTarget",get:function(){return 0===this._currentRenderTarget?this.mainColorTarget0:this.mainColorTarget1}},{key:"previousColorTarget",get:function(){return 0===this._currentRenderTarget?this.mainColorTarget1:this.mainColorTarget0}},{key:"currentRenderTarget",get:function(){return this._currentRenderTarget}},{key:"framebuffer",get:function(){return this.getFramebuffer(this.currentColorTarget,this.mainDepth)}},{key:"getFramebuffer",value:function(e,t){return this.renderTargetHelper.getFramebuffer(this.dimensions,e,t)}},{key:"colorTexture",get:function(){return this.renderTargetHelper.getAllocatedColorTexture(this.currentColorTarget)}},{key:"depthTexture",get:function(){return this.renderTargetHelper.getAllocatedDepthTexture(this.mainDepth)}},{key:"linearDepthTexture",get:function(){return this.renderTargetHelper.getAllocatedColorTexture(this.linearDepth)}},{key:"terrainLinearDepthTexture",get:function(){return this.renderTargetHelper.getAllocatedColorTexture(this.terrainLinearDepth)}},{key:"geometryLinearDepthTexture",get:function(){return this.renderTargetHelper.getAllocatedColorTexture(this.geometryLinearDepth)}},{key:"lastFrameColorTexture",get:function(){return this.renderTargetHelper.getAllocatedColorTexture(this.previousColorTarget)}},{key:"normalTexture",get:function(){return this.renderTargetHelper.getAllocatedColorTexture(this.normal)}},{key:"highlightTexture",get:function(){return this.renderTargetHelper.getAllocatedColorTexture(this.highlight)}},{key:"hudVisibilityTexture",get:function(){return this.getColorTexture(this.hudVisibility)}},{key:"tmpColorTexture",get:function(){return this.getColorTexture(this.tmpColor)}},{key:"hudColorTexture",get:function(){return this.getColorTexture(this.hudColor)}},{key:"mainColorTexture",get:function(){return this.getColorTexture(this.currentColorTarget)}},{key:"advanceCurrentRenderTarget",value:function(){this._currentRenderTarget=0===this._currentRenderTarget&&this._needLastFrameColorTexture?1:0}},{key:"initializeFrame",value:function(e){var t=this._rctx;this.dimensions.width=e.fullWidth,this.dimensions.height=e.fullHeight,this.bindTarget(this.currentColorTarget,this.mainDepth),t.setClearStencil(0);var r=this._background.color;t.setClearColor(r[0]*r[3],r[1]*r[3],r[2]*r[3],r[3]),t.clearSafe(17664)}},{key:"composite",value:function(){this._compositingHelper.composite(this.colorTexture,0)}},{key:"renderTmpAndCompositeToMain",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this.renderToTargets(e,this.tmpColor,r?this.tmpDepth:this.mainDepth,BM),this._compositingHelper.composite(this.getColorTexture(this.tmpColor),t)}},{key:"renderHUDVisibility",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.renderToTargets(e,this.hudVisibility,t?this.tmpDepth:this.mainDepth,GM)}},{key:"compositeTransparentTerrainOntoHUDVisibility",value:function(){var e=this;this.renderToTargets((function(){e._compositingHelper.compositeSpecial(e.getColorTexture(e.tmpColor),1)}),this.hudVisibility,this.tmpDepth)}},{key:"renderOITPass",value:function(e,t,r){var n,i;switch(t){case 0:n=this.colorFloatTarget,i=[0,0,0,0];break;case 1:n=this.alphaFloatTarget,i=[1,1,1,1];break;case 2:n=this.frontFaceTarget,i=[0,0,0,0]}r?this.renderToTargets(e,n,this.tmpDepth,i,!0,!0):this.renderToTargets(e,n,this.mainDepth,i,!1)}},{key:"compositeTransparentTerrainOntoMain",value:function(){this.bindFramebuffer(),this._compositingHelper.composite(this.getColorTexture(this.tmpColor),2)}},{key:"compositeOccludedOntoMain",value:function(e){this.bindFramebuffer(),this._compositingHelper.composite(this.getColorTexture(this.tmpColor),2,e)}},{key:"compositeTransparentOntoOpaque",value:function(e){e?(this.bindTarget(this.hudColor,this.tmpDepth),this._rctx.setClearColor(0,0,0,1e-13),this._rctx.clearSafe(16384)):this.bindFramebuffer(),this._compositingHelper.compositeTransparent(this.getColorTexture(this.colorFloatTarget),this.getColorTexture(this.alphaFloatTarget),this.getColorTexture(this.frontFaceTarget))}},{key:"bindFramebuffer",value:function(){this._rctx.bindFramebuffer(this.framebuffer)}},{key:"renderDepthDetached",value:function(e){this.bindTarget(this.currentColorTarget),e(),this.bindTarget(this.currentColorTarget,this.mainDepth)}},{key:"disposeTarget",value:function(e){this.renderTargetHelper.disposeTargetResource(e)}},{key:"needLastFrameColorTexture",get:function(){return this._needLastFrameColorTexture},set:function(e){!e&&this._needLastFrameColorTexture&&(this._currentRenderTarget=0,this.disposeTarget(this.mainColorTarget1)),this._needLastFrameColorTexture=e}},{key:"renderToTargets",value:function(e,t,r,n){var i=arguments.length>4&&void 0!==arguments[4]&&arguments[4],a=arguments.length>5&&void 0!==arguments[5]&&arguments[5],o=this._rctx,s=this.bindTarget(t,r),c=0;if(n){var l=1e-13,u=Math.max(l,n[3]);o.setClearColor(n[0],n[1],n[2],u),c|=16384}return i&&(c|=256),!1===a?a=0:(!0===a&&(a=255),c|=1024),c&&o.clearSafe(c,a),e(),o.gl.flush(),this.bindTarget(this.currentColorTarget,this.mainDepth),s}},{key:"bindTarget",value:function(e,t){var r=this.renderTargetHelper.getFramebuffer(this.dimensions,e,t);return this._rctx.bindFramebuffer(r),r}},{key:"getColorTexture",value:function(e){return this.renderTargetHelper.getColorTexture(e,this.dimensions)}},{key:"getGpuMemoryUsage",value:function(){var e=0;return this.renderTargetHelper&&(e+=this.renderTargetHelper.getGpuMemoryUsage()),e}}]),e}(),BM=[0,0,0,0],GM=[0,1,0,1],qM=r(526),HM=r(527),WM=function(){function e(t){Object(c.a)(this,e),this.context=t,this.renderPlugins=new Array,this.slots=[];for(var r=0;r<23;++r)this.slots[r]=[]}return Object(l.a)(e,[{key:"add",value:function(e,t){var r=this,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=t.initializeRenderContext(this.context,n),a=function(){r.renderPlugins.push(t);for(var n=0;n<e.length;++n){var i=e[n];r.slots[i].push(t)}r.context.requestRender()};if(Object(q.p)(i))return i.then(a);a()}},{key:"remove",value:function(e){var t=this.renderPlugins.length;this.renderPlugins=this.renderPlugins.filter((function(t){return t!==e})),Object(qu.a)(this.renderPlugins.length<t,"Removing non-added render plugin");for(var r=0;r<this.slots.length;++r)this.slots[r]=this.slots[r].filter((function(t){return t!==e}));e.uninitializeRenderContext(),this.context.requestRender()}},{key:"prepareRender",value:function(e,t){var r,n=Object(i.a)(this.renderPlugins);try{for(n.s();!(r=n.n()).done;){var a=r.value;a.prepareRender&&a.prepareRender(e,t)}}catch(o){n.e(o)}finally{n.f()}}},{key:"render",value:function(){var e,t=this.slots[this.context.renderContext.slot],r=!1,n=Object(i.a)(t);try{for(n.s();!(e=n.n()).done;){var a=e.value;a.canRender&&a.render(this.context.renderContext)&&(r=!0)}}catch(o){n.e(o)}finally{n.f()}return r}},{key:"queryDepthRange",value:function(e){var t=QM;t.near=1/0,t.far=-1/0;var r,n=Object(i.a)(this.renderPlugins);try{for(n.s();!(r=n.n()).done;){var a=r.value;if(a.queryDepthRange){var o=a.queryDepthRange(e);o&&VT(t,o,t)}}}catch(s){n.e(s)}finally{n.f()}return t}},{key:"needsHighlight",get:function(){return this.renderPlugins.some((function(e){return e.needsHighlight}))}},{key:"needsLinearDepth",get:function(){return this.renderPlugins.some((function(e){return e.needsLinearDepth}))}},{key:"needsLaserlineWithContrastControl",get:function(){var e=this.slots[17];return!!e&&e.length>0}},{key:"renderOccludedFlags",get:function(){var e=0;return this.renderPlugins.forEach((function(t){t.renderOccludedFlags&&(e|=t.renderOccludedFlags)})),e}}]),e}(),QM={near:0,far:0},ZM=r(300),XM=r(466),YM=function(e){Object(f.a)(r,e);var t=Object(p.a)(r);function r(){return Object(c.a)(this,r),t.apply(this,arguments)}return Object(l.a)(r,[{key:"initializeProgram",value:function(e){var t=r.shader.get().build(this.configuration);return new ou.a(e.rctx,t,au.a)}},{key:"initializePipeline",value:function(e){return 0===this.configuration.pass?Object(su.g)({blending:Object(su.h)(1,1,1,1),colorWrite:su.d,depthTest:null,depthWrite:null}):1===this.configuration.pass||2===this.configuration.pass?Object(su.g)({blending:vC.f,colorWrite:su.d,depthTest:null,depthWrite:null}):Object(su.g)({})}},{key:"bindPass",value:function(e){if(0===this.configuration.pass||2===this.configuration.pass){var t=e;this.program.bindTexture(t.linearDepthTexture,"depthMap"),t.shadowMap.bind(this.program),t.shadowMap.bindView(this.program,t.camera.center),this.program.setUniform2fv("nearFar",t.camera.nearFar),this.program.setUniformMatrix4fv("inverseView",t.inverseView),this.program.setUniform4fv("projInfo",t.projInfo),this.program.setUniform2fv("zScale",t.zScale)}else if(1===this.configuration.pass){var r=e;if(this.program.bindTexture(r.shadowAccumulationMap,"shadowAccumulationMap"),this.program.setUniform1f("sampleScale",r.sampleScale),this.program.setUniform1f("opacityFromElevation",r.opacityFromElevation),0===this.configuration.visualization){var n=e;this.program.bindTexture(n.colorRamp,"colorRamp"),this.program.setUniform1f("rampSize",n.rampSize),this.configuration.bandsEnabled&&this.program.setUniform1f("bandSize",n.bandSize)}else if(1===this.configuration.visualization){var i=e;this.program.setUniform1f("threshold",i.threshold),this.program.setUniform4fv("colors",i.colors)}}}},{key:"primitiveType",get:function(){return 5}}]),r}(nu.a);YM.shader=new ru.a(XM.a,(function(){return r.e(211).then(r.bind(null,1079))}));var $M=function(e){Object(f.a)(r,e);var t=Object(p.a)(r);function r(){var e;return Object(c.a)(this,r),(e=t.apply(this,arguments)).pass=0,e.visualization=0,e.bandsEnabled=!1,e}return r}(iu.a);Object(b.a)([Object(iu.b)({count:3})],$M.prototype,"pass",void 0),Object(b.a)([Object(iu.b)()],$M.prototype,"visualization",void 0),Object(b.a)([Object(iu.b)()],$M.prototype,"bandsEnabled",void 0);var JM=[Object($l.g)(.01,0,.25,0),Object($l.g)(.01,0,.25,1)],KM=1/512,eP=function(){function e(t,r,n,i){Object(c.a)(this,e),this._techniqueRep=t,this._rctx=r,this._shadowAccumulator=n,this._requestRender=i,this._enabled=!1,this._vao=Object(Gu.d)(r),this._visualizationConfig=new $M,this._visualizationConfig.pass=1,this._visualizationConfig.visualization=0,this._visualizeAccumulationTechnique=t.acquire(YM,this._visualizationConfig);var a={target:3553,pixelFormat:6408,dataType:5121,samplingMode:9729,wrapMode:33071,width:JM.length,height:1};this._colorRampTexture=new vu.a(this._rctx,a,tP(JM)),this._visualizationParams={shadowAccumulationMap:this._accumulationTexture,sampleScale:0,colorRamp:this._colorRampTexture,rampSize:a.width,threshold:.5,bandSize:.1,colors:Object(Fs.f)([Object($l.g)(0,1,0,.5),Object($l.g)(1,0,0,.5)]),opacityFromElevation:1}}return Object(l.a)(e,[{key:"dispose",value:function(){this._stop(),this._vao=Object(I.f)(this._vao),this._visualizeAccumulationTechnique=Object(I.f)(this._visualizeAccumulationTechnique),this._colorRampTexture=Object(I.f)(this._colorRampTexture),this._shadowAccumulator=null}},{key:"render",value:function(){this._isRenderingVisualization&&(this._sampleScale=1/this._computedSamples,this._rctx.bindVAO(this._vao),this._rctx.useProgram(this._visualizeAccumulationTechnique.program),this._visualizeAccumulationTechnique.bindPipelineState(this._rctx),this._visualizeAccumulationTechnique.bindPass(this._visualizationParams),this._rctx.drawArrays(this._visualizeAccumulationTechnique.primitiveType,0,Object(mu.f)(this._vao,"geometry")))}},{key:"setOptions",value:function(e){void 0!==e.enabled&&this._setEnabled(e.enabled),void 0!==e.gradientColorRamp&&this._setColorRamp(e.gradientColorRamp),void 0!==e.threshold&&(this._threshold=e.threshold),void 0!==e.thresholdColors&&this._setThresholdColors(e.thresholdColors),void 0!==e.visualization&&(this._visualization=e.visualization),void 0!==e.bandSize&&(this._bandSize=e.bandSize),void 0!==e.bandsEnabled&&(this._bandsEnabled=e.bandsEnabled)}},{key:"opacityFromElevation",get:function(){return this._visualizationParams.opacityFromElevation},set:function(e){this._visualizationParams.opacityFromElevation=e}},{key:"_isRenderingVisualization",get:function(){return this._enabled&&this._computedSamples>0&&this.opacityFromElevation>KM}},{key:"_computedSamples",get:function(){return this._shadowAccumulator.computedSamples}},{key:"_accumulationTexture",get:function(){return this._shadowAccumulator.accumulationTexture}},{key:"_sampleScale",get:function(){return this._visualizationParams.sampleScale},set:function(e){this._visualizationParams.sampleScale=e}},{key:"_threshold",get:function(){return this._visualizationParams.threshold},set:function(e){this._threshold!==e&&(this._visualizationParams.threshold=e,this._requestRenderIfRunning())}},{key:"_visualization",get:function(){return this._visualizationConfig.visualization},set:function(e){if(e!==this._visualization){var t=this._visualizationConfig;t.visualization=e,this._visualizeAccumulationTechnique=this._techniqueRep.releaseAndAcquire(YM,t,this._visualizeAccumulationTechnique),this._requestRenderIfRunning()}}},{key:"_bandSize",get:function(){return this._visualizationParams.bandSize},set:function(e){e!==this._bandSize&&(this._visualizationParams.bandSize=e,this._requestRenderIfRunning())}},{key:"_bandsEnabled",get:function(){return this._visualizationConfig.bandsEnabled},set:function(e){if(e!==this._bandsEnabled){var t=this._visualizationConfig;t.bandsEnabled=e,this._visualizeAccumulationTechnique=this._techniqueRep.releaseAndAcquire(YM,t,this._visualizeAccumulationTechnique),this._requestRenderIfRunning()}}},{key:"_setColorRamp",value:function(e){var t=e.length,r=tP(e);this._colorRampTexture.resize(t,1),this._colorRampTexture.setData(r),this._visualizationParams.rampSize=t,this._requestRenderIfRunning()}},{key:"_setThresholdColors",value:function(e){var t=this._visualizationParams.colors,r=Object(Fs.f)(e);Object(Fs.e)(t,r)||(this._visualizationParams.colors=r,this._requestRenderIfRunning())}},{key:"_setEnabled",value:function(e){e!==this._enabled&&(e?this._start():this._stop())}},{key:"_requestRenderIfRunning",value:function(){this._enabled&&this._requestRender()}},{key:"_start",value:function(){this._enabled=!0,this._requestRender()}},{key:"_stop",value:function(){this._enabled=!1,this._requestRender()}}]),e}();function tP(e){for(var t=e.length,r=new Uint8Array(4*t),n=0;n<t;++n){var i=e[n];r[4*n+0]=255*i[0],r[4*n+1]=255*i[1],r[4*n+2]=255*i[2],r[4*n+3]=255*i[3]}return r}for(var rP=function e(){Object(c.a)(this,e),this.camera=new zf.a,this.lightMat=Object(Kl.d)()},nP=function(){function e(t,r){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;Object(c.a)(this,e),this.rctx=t,this.viewingMode=r,this._enabled=!1,this._snapshots=new Array,this.textureSize=0,this.maxTextureSize=0,this.numCascades=1,this.maxNumCascades=4,this.splitSchemeLambda=0,this.warp=!0,this.cascadeDistances=[0,0,0,0,0],this.cascades=[],this.maxTextureSize=this.rctx.parameters.maxTextureSize;for(var i=0;i<4;++i)this.cascades.push(new rP);this.snapshotCount=n}return Object(l.a)(e,[{key:"dispose",value:function(){this.discardDepthTexture(),this.discardAllSnapshots()}},{key:"maxCascades",get:function(){return this.maxNumCascades},set:function(e){this.maxNumCascades=Object(m.e)(Math.floor(e),1,4)}},{key:"enabled",get:function(){return this._enabled},set:function(e){this._enabled=e,e||(this.discardDepthTexture(),this.discardAllSnapshots())}},{key:"snapshotCount",get:function(){return this._snapshots.length},set:function(e){var t=this._snapshots.length;if(e>t){var r=e-t;this._snapshots.length=e;for(var n=0;n<r;++n)this._snapshots[t+n]=null}else if(e<this.snapshotCount){for(var i=t-e,a=0;a<i;++a)this.discardSnapshot(e+a);this._snapshots.length=e}}},{key:"getSnapshot",value:function(e){return this.enabled?this._snapshots[e]:null}},{key:"getCascades",value:function(){for(var e=0;e<this.numCascades;++e)gP[e]=this.cascades[e];return gP.length=this.numCascades,gP}},{key:"start",value:function(e,t,r){Object(qu.a)(this.enabled),this.textureSize=this.computeTextureSize(e.fullWidth,e.fullHeight),this.ensureDepthTexture();var n=this.clampNearFar(r),i=n.near,a=n.far;this.computeCascadeDistances(a,i),this.setupMatrices(e,t);for(var o=e.viewMatrix,s=e.projectionMatrix,c=0;c<this.numCascades;++c)this.constructCascade(c,s,o,t);this.lastOrigin=null,this.clear()}},{key:"finish",value:function(e){Object(qu.a)(this.enabled),this.rctx.bindFramebuffer(e)}},{key:"bind",value:function(e){this.enabled?(this._depthTextureUnit=e.bindTexture(this._depthTexture,"uShadowMapTex"),e.setUniform1f("uDepthHalfPixelSz",.5/this.textureSize),e.setUniform1i("uShadowMapNum",this.numCascades),e.setUniform4f("uShadowMapDistance",this.cascadeDistances[0],this.numCascades>1?this.cascadeDistances[1]:1/0,this.numCascades>2?this.cascadeDistances[2]:1/0,this.numCascades>3?this.cascadeDistances[3]:1/0)):e.setUniform1f("uDepthHalfPixelSz",-1)}},{key:"bindView",value:function(e,t){if(this.enabled){var r=this.lastOrigin;if(!r||r[0]!==t[0]||r[1]!==t[1]||r[2]!==t[2]){this.lastOrigin=this.lastOrigin||Object(X.e)(),Object(Yl.m)(this.lastOrigin,t);for(var n=0;n<this.numCascades;++n){Object(Jl.t)(OP,this.cascades[n].lightMat,t);for(var i=0;i<16;++i)jP[16*n+i]=OP[i]}}e.setUniformMatrix4fv("uShadowMapMatrix",jP)}}},{key:"takeCascadeSnapshotTo",value:function(e,t){Object(qu.a)(this.enabled),this.ensureSnapshot(t),this._bindFbo();var r=this.rctx,n=r.bindTexture(this._snapshots[t],vu.a.TEXTURE_UNIT_FOR_UPDATES);r.gl.copyTexSubImage2D(3553,0,e.camera.viewport[0],e.camera.viewport[1],e.camera.viewport[0],e.camera.viewport[1],e.camera.viewport[2],e.camera.viewport[3]),r.bindTexture(n,vu.a.TEXTURE_UNIT_FOR_UPDATES)}},{key:"clear",value:function(){var e=this.rctx;this._bindFbo(),e.setClearColor(1,1,1,1),e.clearSafe(16640)}},{key:"computeTextureSize",value:function(e,t){var r=.5*Math.log(e*e+t*t)*Math.LOG2E,n=Math.pow(2,Math.round(r+.35));return Math.min(this.maxTextureSize,2*n)}},{key:"ensureDepthTexture",value:function(){if(null==this._depthTexture||this._depthTexture.descriptor.width!==this.textureSize){this.discardDepthTexture();var e={target:3553,pixelFormat:6408,dataType:5121,wrapMode:33071,samplingMode:9728,flipped:!0,width:this.textureSize,height:this.textureSize};this._depthTexture=new vu.a(this.rctx,e),this.fbo=new Sk.a(this.rctx,{colorTarget:0,depthStencilTarget:1,width:this.textureSize,height:this.textureSize},this._depthTexture)}}},{key:"ensureSnapshot",value:function(e){var t=this._snapshots[e];if(!Object(I.j)(t)||t.descriptor.width!==this.textureSize){this.discardSnapshot(e);var r={target:3553,pixelFormat:6408,dataType:5121,wrapMode:33071,samplingMode:9728,flipped:!0,width:this.textureSize,height:this.textureSize};this._snapshots[e]=new vu.a(this.rctx,r)}}},{key:"discardDepthTexture",value:function(){this.fbo=Object(I.f)(this.fbo),this._depthTexture=Object(I.f)(this._depthTexture)}},{key:"discardSnapshot",value:function(e){this._snapshots[e]=Object(I.f)(this._snapshots[e])}},{key:"discardAllSnapshots",value:function(){for(var e=0;e<this.snapshotCount;++e)this.discardSnapshot(e)}},{key:"_bindFbo",value:function(){var e=this.rctx;Object(I.j)(this._depthTextureUnit)&&(e.bindTexture(null,this._depthTextureUnit),this._depthTextureUnit=null),e.bindFramebuffer(this.fbo)}},{key:"constructCascade",value:function(e,t,r,n){var i=this.cascades[e],a=-this.cascadeDistances[e],o=-this.cascadeDistances[e+1],s=(t[10]*a+t[14])/Math.abs(t[11]*a+t[15]),c=(t[10]*o+t[14])/Math.abs(t[11]*o+t[15]);Object(qu.a)(s<c);for(var l=0;l<8;++l){Object(Su.l)(sP,l%4==0||l%4==3?-1:1,l%4==0||l%4==1?-1:1,l<4?s:c,1),Object(Su.m)(cP[l],sP,oP);for(var u=0;u<3;++u)cP[l][u]/=cP[l][3]}Object(Yl.u)(yP,cP[0]),Object(Jl.t)(iP,mP,yP),i.camera.viewMatrix=iP;for(var d=0;d<8;++d)Object(Yl.s)(cP[d],cP[d],i.camera.viewMatrix);Object(Yl.m)(uP,cP[0]),Object(Yl.m)(dP,cP[0]);for(var h=1;h<8;++h)for(var f=0;f<3;++f)uP[f]=Math.min(uP[f],cP[h][f]),dP[f]=Math.max(dP[f],cP[h][f]);uP[2]-=200,dP[2]+=200,i.camera.near=-dP[2],i.camera.far=-uP[2],this.warp?this.constructTrapezoidalProjection(r,n,i):this.constructOrthogonalProjection(i),Object(Jl.m)(i.lightMat,i.camera.projectionMatrix,i.camera.viewMatrix);var p=this.textureSize/2;i.camera.viewport[0]=e%2==0?0:p,i.camera.viewport[1]=0===Math.floor(e/2)?0:p,i.camera.viewport[2]=p,i.camera.viewport[3]=p}},{key:"constructOrthogonalProjection",value:function(e){Object(Jl.o)(e.camera.projectionMatrix,uP[0],dP[0],uP[1],dP[1],e.camera.near,e.camera.far)}},{key:"constructTrapezoidalProjection",value:function(e,t,r){var n=1/cP[0][3],i=1/cP[4][3];Object(qu.a)(n<i);var a=n+Math.sqrt(n*i),o=Math.sin(Object(m.b)(e[2]*t[0]+e[6]*t[1]+e[10]*t[2]));(function(e,t,r,n,i,a,o,s){Object(xu.r)(_P,0,0);for(var c=0;c<4;++c)Object(xu.i)(_P,_P,e[c]);Object(xu.b)(_P,_P,.25),Object(xu.r)(wP,0,0);for(var l=4;l<8;++l)Object(xu.i)(wP,wP,e[l]);Object(xu.b)(wP,wP,.25),Object(xu.m)(xP[0],e[4],e[5],.5),Object(xu.m)(xP[1],e[5],e[6],.5),Object(xu.m)(xP[2],e[6],e[7],.5),Object(xu.m)(xP[3],e[7],e[4],.5);for(var u=0,d=Object(xu.j)(xP[0],_P),h=1;h<4;++h){var f=Object(xu.j)(xP[h],_P);f<d&&(d=f,u=h)}Object(xu.a)(kP,xP[u],e[u+4]);var p,b,v=kP[0];kP[0]=-kP[1],kP[1]=v,Object(xu.a)(SP,wP,_P),Object(xu.h)(SP,kP)<0&&Object(xu.n)(kP,kP),Object(xu.m)(kP,kP,SP,r),Object(xu.f)(kP,kP),p=b=Object(xu.h)(Object(xu.a)(TP,e[0],_P),kP);for(var m=1;m<8;++m){var y=Object(xu.h)(Object(xu.a)(TP,e[m],_P),kP);y<p?p=y:y>b&&(b=y)}Object(xu.c)(n,_P),Object(xu.b)(TP,kP,p-t),Object(xu.i)(n,n,TP);for(var g=-1,O=1,j=0,_=0,w=0;w<8;++w){Object(xu.a)(CP,e[w],n),Object(xu.f)(CP,CP);var x=kP[0]*CP[1]-kP[1]*CP[0];x>0?x>g&&(g=x,j=w):x<O&&(O=x,_=w)}Object(qu.o)(g>0,"leftArea"),Object(qu.o)(O<0,"rightArea"),Object(xu.b)(MP,kP,p),Object(xu.i)(MP,MP,_P),Object(xu.b)(PP,kP,b),Object(xu.i)(PP,PP,_P),AP[0]=-kP[1],AP[1]=kP[0];var k=Object(qu.l)(n,e[_],PP,Object(xu.i)(TP,PP,AP),1,i),S=Object(qu.l)(n,e[j],PP,TP,1,a),T=Object(qu.l)(n,e[j],MP,Object(xu.i)(TP,MP,AP),1,o),C=Object(qu.l)(n,e[_],MP,TP,1,s);Object(qu.o)(k,"rayRay"),Object(qu.o)(S,"rayRay"),Object(qu.o)(T,"rayRay"),Object(qu.o)(C,"rayRay")})(cP,a/=o,o,hP,fP,pP,bP,vP),function(e,t,r,n,i){Object(xu.a)(DP,r,n),Object(xu.b)(DP,DP,.5),FP[0]=DP[0],FP[1]=DP[1],FP[2]=0,FP[3]=DP[1],FP[4]=-DP[0],FP[5]=0,FP[6]=DP[0]*DP[0]+DP[1]*DP[1],FP[7]=DP[0]*DP[1]-DP[1]*DP[0],FP[8]=1,FP[EP(0,2)]=-Object(xu.h)(IP(FP,0),e),FP[EP(1,2)]=-Object(xu.h)(IP(FP,1),e);var a=Object(xu.h)(IP(FP,0),r)+FP[EP(0,2)],o=Object(xu.h)(IP(FP,1),r)+FP[EP(1,2)],s=Object(xu.h)(IP(FP,0),n)+FP[EP(0,2)],c=Object(xu.h)(IP(FP,1),n)+FP[EP(1,2)];a=-(a+s)/(o+c),FP[EP(0,0)]+=FP[EP(1,0)]*a,FP[EP(0,1)]+=FP[EP(1,1)]*a,FP[EP(0,2)]+=FP[EP(1,2)]*a,a=1/(Object(xu.h)(IP(FP,0),r)+FP[EP(0,2)]),o=1/(Object(xu.h)(IP(FP,1),r)+FP[EP(1,2)]),FP[EP(0,0)]*=a,FP[EP(0,1)]*=a,FP[EP(0,2)]*=a,FP[EP(1,0)]*=o,FP[EP(1,1)]*=o,FP[EP(1,2)]*=o,FP[EP(2,0)]=FP[EP(1,0)],FP[EP(2,1)]=FP[EP(1,1)],FP[EP(2,2)]=FP[EP(1,2)],FP[EP(1,2)]+=1,a=Object(xu.h)(IP(FP,1),t)+FP[EP(1,2)],o=Object(xu.h)(IP(FP,2),t)+FP[EP(2,2)],s=Object(xu.h)(IP(FP,1),r)+FP[EP(1,2)],c=Object(xu.h)(IP(FP,2),r)+FP[EP(2,2)],a=-.5*(a/o+s/c),FP[EP(1,0)]+=FP[EP(2,0)]*a,FP[EP(1,1)]+=FP[EP(2,1)]*a,FP[EP(1,2)]+=FP[EP(2,2)]*a,a=Object(xu.h)(IP(FP,1),t)+FP[EP(1,2)],o=Object(xu.h)(IP(FP,2),t)+FP[EP(2,2)],s=-o/a,FP[EP(1,0)]*=s,FP[EP(1,1)]*=s,FP[EP(1,2)]*=s,i[0]=FP[0],i[1]=FP[1],i[2]=0,i[3]=FP[2],i[4]=FP[3],i[5]=FP[4],i[6]=0,i[7]=FP[5],i[8]=0,i[9]=0,i[10]=1,i[11]=0,i[12]=FP[6],i[13]=FP[7],i[14]=0,i[15]=FP[8]}(hP,fP,bP,vP,r.camera.projectionMatrix),r.camera.projectionMatrix[10]=2/(uP[2]-dP[2]),r.camera.projectionMatrix[14]=-(uP[2]+dP[2])/(uP[2]-dP[2])}},{key:"setupMatrices",value:function(e,t){Object(Jl.m)(aP,e.projectionMatrix,e.viewMatrix),Object(Jl.a)(oP,aP);var r=1===this.viewingMode?e.eye:Object(Yl.y)(yP,0,0,1);Object(Jl.l)(mP,[0,0,0],[-t[0],-t[1],-t[2]],r)}},{key:"clampNearFar",value:function(e){var t=e.near,r=e.far;return t<2&&(t=2),r<2&&(r=2),t>=r&&(t=2,r=4),{near:t,far:r}}},{key:"computeCascadeDistances",value:function(e,t){this.numCascades=Math.min(1+Math.floor(Object(qu.h)(e/t,4)),this.maxNumCascades);for(var r=(e-t)/this.numCascades,n=Math.pow(e/t,1/this.numCascades),i=t,a=t,o=0;o<this.numCascades+1;++o)this.cascadeDistances[o]=Object(m.m)(i,a,this.splitSchemeLambda),i*=n,a+=r}},{key:"getGpuMemoryUsage",value:function(){var e,t;return this._snapshots.reduce((function(e,t){return e+Object(mu.c)(t)}),null!=(e=null==(t=this.fbo)?void 0:t.gpuMemoryUsage)?e:0)}},{key:"test",get:function(){var e=this;return{maxNumCascades:this.maxNumCascades,cascades:this.cascades,textureSize:this.textureSize,depthTexture:this._depthTexture,set splitSchemeLambda(t){e.splitSchemeLambda=t},get splitSchemeLambda(){return e.splitSchemeLambda},set warp(t){e.warp=t},get warp(){return e.warp}}}}]),e}(),iP=Object(Kl.d)(),aP=Object(Kl.d)(),oP=Object(Kl.d)(),sP=Object($l.e)(),cP=[],lP=0;lP<8;++lP)cP.push(Object($l.e)());var uP=Object(X.e)(),dP=Object(X.e)(),hP=Object(ku.b)(),fP=Object(ku.b)(),pP=Object(ku.b)(),bP=Object(ku.b)(),vP=Object(ku.b)(),mP=Object(Kl.d)(),yP=Object(X.e)(),gP=[],OP=Object(Kl.d)(),jP=new Float32Array(64),_P=Object(ku.b)(),wP=Object(ku.b)(),xP=[Object(ku.b)(),Object(ku.b)(),Object(ku.b)(),Object(ku.b)()],kP=Object(ku.b)(),SP=Object(ku.b)(),TP=Object(ku.b)(),CP=Object(ku.b)(),MP=Object(ku.b)(),PP=Object(ku.b)(),AP=Object(ku.b)();function EP(e,t){return 3*t+e}var RP=Object(ku.b)();function IP(e,t){return Object(xu.r)(RP,e[t],e[t+3]),RP}var DP=Object(ku.b)(),FP=Object(Cf.b)();var LP=nP,zP=function(){function e(t,r,n,i,a,o){var s=this;Object(c.a)(this,e),this._rctx=t,this._stage=n,this._prepareForShadowMapPass=i,this._renderToShadowMap=a,this._requestRender=o,this._progress=0,this._sampleCount=0,this._cachedCamera=new zf.a,this._contentCamera=new zf.a,this._enabled=!1,this._cachedLightDirections=[],this._depthRange=UT,this._previewing=!1,this._handles=new oe.a,this._cameraForcedForScreenshot=!1,this._shadowMap=new LP(t,n.viewingMode),this._shadowMap.enabled=!0,this._vao=Object(Gu.d)(t);var l={rctx:t,viewingMode:n.viewingMode},u=new $M;u.pass=0,this._accumulationTechnique=new YM(l,u);this._fbo=new Sk.a(t,{colorTarget:0,depthStencilTarget:0,width:0,height:0},{target:3553,pixelFormat:6408,dataType:5121,samplingMode:9729,wrapMode:33071,width:0,height:0}),this._accumulationParams={camera:this._cachedCamera,linearDepthTexture:null,shadowMap:this._shadowMap,inverseView:Object(Kl.d)(),projInfo:Object($l.e)(),zScale:Object(ku.b)()},this._accumulationRenderer=new eP(r,t,this,o);var d=this._stage.resourceController.scheduler;this._handles.add(d.registerTask(Og.b.SHADOW_ACCUMULATOR,this)),this._handles.add(Object(ZM.d)((function(){return n.renderView}),(function(t){s._handles.remove(e.renderViewHandleKey),Object(I.i)(t)||s._handles.add(t.events.on("force-camera-for-screenshot",(function(){return s._cameraForcedForScreenshot=!0})),e.renderViewHandleKey)})))}return Object(l.a)(e,[{key:"computedSamples",get:function(){return this._progress}},{key:"accumulationTexture",get:function(){return this._fbo.colorTexture}},{key:"running",get:function(){return this._isRefining&&this._canAccumulate}},{key:"isAccumulating",get:function(){return this._isPreviewing||this._isRefining}},{key:"_isRefining",get:function(){return this._isActive&&!this._isDoneAccumulating&&!this._previewing}},{key:"_isPreviewing",get:function(){return this._isActive&&this._previewing}},{key:"_isActive",get:function(){return this._enabled&&this._sampleCount>0}},{key:"_canAccumulate",get:function(){return null!==this._accumulationParams.linearDepthTexture&&this._depthRange!==UT&&this._opacityFromElevation>KM}},{key:"_isDoneAccumulating",get:function(){return this._progress>=this._sampleCount}},{key:"_lightDirections",get:function(){return this._cachedLightDirections},set:function(e){var t=this._cachedLightDirections;if(!Object(Fs.e)(t,e,Yl.F)){var r=e.length;t.length=r,this._sampleCount=Math.min(XM.c,r);for(var n=0;n<r;++n){var i=e[n],a=t[n]||Object(X.e)();Object(Yl.m)(a,i),t[n]=a}this._invalidate()}}},{key:"_projInfo",get:function(){return this._accumulationParams.projInfo}},{key:"_zScale",get:function(){return this._accumulationParams.zScale}},{key:"_inverseView",get:function(){return this._accumulationParams.inverseView}},{key:"_opacityFromElevation",get:function(){return this._accumulationRenderer.opacityFromElevation},set:function(e){this._accumulationRenderer.opacityFromElevation=e}},{key:"runTask",value:function(e){for(this._prepareForShadowMapPass(this._cachedCamera,this._contentCamera);!e.done&&!this._isDoneAccumulating;)this._accumulateShadow(),e.madeProgress();this._requestRender()}},{key:"accumulateFixedSamples",value:function(){if(this.isAccumulating&&this._canAccumulate){(this._previewing||0===this._progress||this._cameraForcedForScreenshot)&&this._clear();for(var t=this._cameraForcedForScreenshot?this._sampleCount:Math.min(e.previewSamples,this._sampleCount-this._progress),r=0;r<t;++r)this._accumulateShadow();this._cameraForcedForScreenshot=!1}}},{key:"render",value:function(){this._accumulationRenderer.render()}},{key:"dispose",value:function(){this._stop(),this._handles.destroy(),this._accumulationRenderer=Object(I.f)(this._accumulationRenderer),this._shadowMap=Object(I.f)(this._shadowMap),this._fbo=Object(I.f)(this._fbo),this._vao=Object(I.f)(this._vao),this._accumulationTechnique=Object(I.f)(this._accumulationTechnique),this._cachedLightDirections.length=0,this._sampleCount=0}},{key:"setOptions",value:function(e){void 0!==e.enabled&&this._setEnabled(e.enabled),void 0!==e.previewing&&this.setPreviewing(e.previewing),void 0!==e.lightDirections&&this.setLightDirections(e.lightDirections),this._accumulationRenderer.setOptions(e)}},{key:"setPreviewing",value:function(e){this._previewing!==e&&(this._previewing=e,this._requestRenderIfEnabled())}},{key:"setLightDirections",value:function(e){this._lightDirections=e}},{key:"setAccumulationDependencies",value:function(e,t,r,n){this._accumulationParams.linearDepthTexture=e,this._depthRange=t,this._updateCamera(r),this._contentCamera=n}},{key:"readAccumulatedShadow",value:function(e,t){if(!this._isActive||this._progress<1||e<0||e>this._fbo.width||t<0||t>this._fbo.height)return 0;var r=VP;return this._fbo.readPixels(e,t,1,1,6408,5121,r),r[0]/this._progress}},{key:"_start",value:function(){this._progress=0,this._enabled=!0}},{key:"_stop",value:function(){this._enabled=!1}},{key:"_invalidate",value:function(){this._progress=0,this._requestRenderIfEnabled()}},{key:"_clear",value:function(){this._rctx.bindFramebuffer(this._fbo),this._rctx.setClearColor(0,0,0,0),this._rctx.clearSafe(16384),this._progress=0}},{key:"_accumulateShadow",value:function(){var e=this._lightDirections[this._progress],t=this._cachedCamera;this._renderToShadowMap(this._shadowMap,e,t,this._depthRange),this._rctx.bindFramebuffer(this._fbo),this._rctx.useProgram(this._accumulationTechnique.program),this._accumulationTechnique.bindPipelineState(this._rctx),this._accumulationTechnique.bindPass(this._accumulationParams),this._rctx.bindVAO(this._vao),this._rctx.drawArrays(this._accumulationTechnique.primitiveType,0,Object(mu.f)(this._vao,"geometry")),this._progress++}},{key:"_updateCamera",value:function(e){if(!e.equals(this._cachedCamera)){var t=e.fullWidth,r=e.fullHeight,n=e.projectionMatrix,i=e.viewMatrix,a=e.center;this._cachedCamera.copyFrom(e),this._fbo.resize(t,r),Object(qu.f)(n,t,r,this._projInfo,this._zScale),Object(Jl.t)(this._inverseView,i,a),Object(Jl.a)(this._inverseView,this._inverseView),this._opacityFromElevation=1-Object(m.u)(4e4,5e4,e.relativeElevation)}}},{key:"_setEnabled",value:function(e){e!==this._enabled&&(e?this._start():this._stop())}},{key:"_requestRenderIfEnabled",value:function(){this._enabled&&this._requestRender()}}]),e}();zP.previewSamples=6,zP.renderViewHandleKey="renderView";var VP=new Uint8Array(4),NP=r(629),UP=function(e){Object(f.a)(r,e);var t=Object(p.a)(r);function r(){var e;return Object(c.a)(this,r),(e=t.apply(this,arguments)).opacityElevation=1,e.dayNightTerminator=1,e.highlightShadowMapSlot=0,e.defaultSnapshotSlot=1,e}return Object(l.a)(r,[{key:"initializeProgram",value:function(e){var t=r.shader.get();this._viewingMode=e.viewingMode;var n=t.build({highlightedThreshold:.99999,selfShadowThreshold:.025});return new ou.a(e.rctx,n,au.a)}},{key:"initializePipeline",value:function(e){return Object(su.g)({blending:Object(su.h)(770,1,771,771),colorWrite:su.d,depthTest:null,depthWrite:null})}},{key:"bindPass",value:function(e,t){this.opacityElevation=1-Object(m.u)(4e4,5e4,t.camera.relativeElevation);var r=1===this._viewingMode?Object(Yl.t)(BP,t.camera.center):Object(Yl.y)(BP,0,0,1),n=Object(Yl.j)(r,t.lighting.lightingMainDirection);this.dayNightTerminator=Object(m.u)(0,1,Object(m.e)(30*n,0,1)),this.program.bindTexture(t.linearDepthTexture,"depthMap"),this.program.bindTexture(t.highlightColorTexture,"highlightMap"),Object(Yl.s)(GP,t.lighting.lightingMainDirection,t.camera.viewInverseTransposeMatrix),Object(Yl.t)(GP,GP),Object(qu.f)(t.camera.projectionMatrix,t.camera.fullWidth,t.camera.fullHeight,HP,qP),Object(Jl.t)(WP,t.camera.viewMatrix,t.camera.center),Object(Jl.a)(WP,WP),this.program.setUniform4fv("color",e.shadowColor),this.program.setUniform1f("opacity",e.shadowOpacity),this.program.setUniform1f("occludedOpacity",e.occludedShadowOpacity),this.program.setUniform1f("terminationFactor",this.opacityElevation*this.dayNightTerminator),this.program.setUniform2fv("nearFar",t.camera.nearFar),this.program.setUniformMatrix4fv("inverseView",WP),this.program.setUniform4fv("projInfo",HP),this.program.setUniform2fv("zScale",qP),this.program.setUniform3fv("lightingMainDirectionView",GP),this.program.setUniform2f("texelSize",1/t.linearDepthTexture.descriptor.width,1/t.linearDepthTexture.descriptor.height),t.shadowMap.bind(this.program),t.shadowMap.bindView(this.program,t.camera.center);var i=t.shadowMap.getSnapshot(this.highlightShadowMapSlot);Object(I.j)(i)&&this.program.bindTexture(i,"highlightDepthTex"),i=t.shadowMap.getSnapshot(this.defaultSnapshotSlot),Object(I.j)(i)&&this.program.bindTexture(i,"defaultDepthTex")}},{key:"primitiveType",get:function(){return 5}}]),r}(nu.a);UP.shader=new ru.a(NP.a,(function(){return r.e(212).then(r.bind(null,1080))}));var BP=Object(X.e)(),GP=Object(X.e)(),qP=Object(ku.b)(),HP=Object($l.e)(),WP=Object(Kl.d)(),QP=function(){function e(t,r){Object(c.a)(this,e),this._rctx=t,this._maxOpacity=1,this._defaultOptions={shadowColor:Object(F_.c)(1,0,1,1),shadowOpacity:.2,occludedShadowOpacity:.1},this._technique=new UP({rctx:t,viewingMode:r},null),this._vao=Object(Gu.d)(this._rctx)}return Object(l.a)(e,[{key:"render",value:function(e,t){e.shadowMap.enabled&&e.linearDepthTexture&&this.isVisible&&(this._rctx.bindFramebuffer(t),this._rctx.useProgram(this._technique.program),this._technique.bindPipelineState(this._rctx),this._technique.bindPass(this._defaultOptions,e),this._rctx.bindVAO(this._vao),this._rctx.drawArrays(this._technique.primitiveType,0,Object(mu.f)(this._vao,"geometry")))}},{key:"getGpuMemoryUsage",value:function(){return this._vao?this._vao.size:0}},{key:"setDefaultOptions",value:function(e){this._defaultOptions=e,this._updateMaxOpacity()}},{key:"highlightShadowMapSlot",get:function(){return this._technique.highlightShadowMapSlot}},{key:"defaultSnapshotSlot",get:function(){return this._technique.defaultSnapshotSlot}},{key:"dispose",value:function(){this._vao=Object(I.f)(this._vao),this._technique=Object(I.f)(this._technique)}},{key:"isVisible",get:function(){return this._maxOpacity*this._technique.opacityElevation*this._technique.dayNightTerminator>=.001953125}},{key:"_updateMaxOpacity",value:function(){var e=this._defaultOptions,t=e.shadowColor,r=Math.max(e.shadowOpacity,e.occludedShadowOpacity);this._maxOpacity=r*t[3]}}]),e}(),ZP=Object(ee.b)(),XP=function(){function e(){Object(c.a)(this,e),this._worldPlane=ZP}return Object(l.a)(e,[{key:"isEnabled",get:function(){return this.plane!==ZP}},{key:"plane",get:function(){return this._worldPlane},set:function(e){this._worldPlane=e||ZP}}]),e}(),YP=r(630),$P=function(e){Object(f.a)(r,e);var t=Object(p.a)(r);function r(){return Object(c.a)(this,r),t.apply(this,arguments)}return Object(l.a)(r,[{key:"initializeProgram",value:function(e){var t=r.shader.get(),n=this.configuration,i=t.build({output:n.output,threshold:.05,localConstrastAdaption:2,maxSearchSteps:8,maxDistanceAreaTex:16});return new ou.a(e.rctx,i,au.a)}},{key:"initializePipeline",value:function(){return Object(su.g)({colorWrite:su.d})}}]),r}(nu.a);$P.shader=new ru.a(YP.a,(function(){return r.e(208).then(r.bind(null,1082))}));var JP=function(e){Object(f.a)(r,e);var t=Object(p.a)(r);function r(){var e;return Object(c.a)(this,r),(e=t.apply(this,arguments)).output=0,e}return r}(iu.a);Object(b.a)([Object(iu.b)({count:3})],JP.prototype,"output",void 0);var KP=function(){function e(t,r){Object(c.a)(this,e),this.rctx=t,this._techniqueRep=r,this.resourceLoadingPromise=null,this.isEnabled=!1}return Object(l.a)(e,[{key:"loadResources",value:function(e){var t=this;if(!this.data||!this.textureArea||!this.textureSearch){var r=this.resourceLoadingPromise||this.loadDataModule().then((function(){return t.loadTextures()}));return e&&r.then(e),this.resourceLoadingPromise||(this.resourceLoadingPromise=r,r.then((function(){return t.resourceLoadingPromise=null}))),!1}return!0}},{key:"loadDataModule",value:function(){var e=this;return this.data?Promise.resolve():r.e(193).then(r.bind(null,1081)).then((function(t){e.data=t}))}},{key:"loadTextures",value:function(){var e=this;return Promise.all([this.loadTextureFromBase64(this.data.areaTexture,9729,6407),this.loadTextureFromBase64(this.data.searchTexure,9728,6409)]).then((function(t){var r=Object(ue.a)(t,2),n=r[0],i=r[1];e.textureArea=n,e.textureSearch=i}))}},{key:"isLoadingResources",get:function(){return null!=this.resourceLoadingPromise}},{key:"enable",value:function(){var e=this;if(this.isEnabled)return!0;if(!this._edgeDetectTechnique||!this._blendWeights||!this._blur){var t=new JP,r=function(t,r){return e._techniqueRep.releaseAndAcquire($P,t,r)};t.output=0,this._edgeDetectTechnique=r(t,this._edgeDetectTechnique),t.output=1,this._blendWeights=r(t,this._blendWeights),t.output=2,this._blur=r(t,this._blur)}return!!this.loadResources()&&(this.vao=Object(Gu.e)(this.rctx),this.edges=new Sk.a(this.rctx,{colorTarget:0,depthStencilTarget:0},{target:3553,pixelFormat:6407,dataType:5121,samplingMode:9729,wrapMode:33071,width:4,height:4}),this.blend=new Sk.a(this.rctx,{colorTarget:0,depthStencilTarget:0},{target:3553,pixelFormat:6408,dataType:5121,samplingMode:9729,wrapMode:33071,width:4,height:4}),this.isEnabled=!0,!0)}},{key:"disable",value:function(){this.isEnabled&&(this.vao.dispose(),this.vao=null,this.textureArea.dispose(),this.textureArea=null,this.textureSearch.dispose(),this.textureSearch=null,this.blend.dispose(),this.blend=null,this.edges.dispose(),this.edges=null,this.isEnabled=!1)}},{key:"render",value:function(e){this.enable();var t=this.rctx,r=t.getBoundFramebufferObject(),n={x:0,y:0,width:e.colorTexture.descriptor.width,height:e.colorTexture.descriptor.height};t.bindVAO(this.vao),t.setPipelineState(this._edgeDetectTechnique.pipeline),t.setViewport(n.x,n.y,n.width,n.height),this.edges.resize(n.width,n.height),t.bindFramebuffer(this.edges),t.setClearColor(0,0,0,1),t.clear(16384),t.useProgram(this._edgeDetectTechnique.program),this._edgeDetectTechnique.program.bindTexture(e.colorTexture,"tColor"),this._edgeDetectTechnique.program.setUniform4f("uResolution",1/n.width,1/n.height,n.width,n.height),t.drawArrays(4,0,3),this.blend.resize(n.width,n.height),t.bindFramebuffer(this.blend),t.setClearColor(0,0,1,1),t.clear(16384),t.useProgram(this._blendWeights.program),this._blendWeights.program.setUniform4f("uResolution",1/n.width,1/n.height,n.width,n.height),this._blendWeights.program.bindTexture(this.textureSearch,"tSearch"),this._blendWeights.program.bindTexture(this.textureArea,"tArea"),this._blendWeights.program.bindTexture(this.edges.colorTexture,"tEdges"),t.drawArrays(4,0,3),t.bindFramebuffer(r),t.setClearColor(0,1,0,1),t.clear(16384),t.useProgram(this._blur.program),this._blur.program.setUniform4f("uResolution",1/n.width,1/n.height,n.width,n.height),this._blur.program.bindTexture(e.colorTexture,"tColor"),this._blur.program.bindTexture(this.blend.colorTexture,"tBlendWeights"),t.drawArrays(4,0,3)}},{key:"loadTextureFromBase64",value:function(e,t,r){var n=new vu.a(this.rctx,{pixelFormat:r,dataType:5121,wrapMode:33071,samplingMode:t},null);return Object(eu.a)(e).then((function(e){return n.resize(e.width,e.height),n.setData(e),n}))}}]),e}(),eA=r(631),tA=function(e){Object(f.a)(r,e);var t=Object(p.a)(r);function r(){return Object(c.a)(this,r),t.apply(this,arguments)}return Object(l.a)(r,[{key:"initializeProgram",value:function(e){var t=r.shader.get(),n=this.configuration,i=3===n.samples?64:2===n.samples?32:1===n.samples?16:8,a=t.build({output:n.output,samples:i,radius:4});return new ou.a(e.rctx,a,au.a)}},{key:"initializePipeline",value:function(){return Object(su.g)({colorWrite:su.d})}}]),r}(nu.a);tA.shader=new ru.a(eA.a,(function(){return r.e(209).then(r.bind(null,1084))}));var rA=function(e){Object(f.a)(r,e);var t=Object(p.a)(r);function r(){var e;return Object(c.a)(this,r),(e=t.apply(this,arguments)).output=0,e.samples=3,e}return r}(iu.a);Object(b.a)([Object(iu.b)({count:2})],rA.prototype,"output",void 0),Object(b.a)([Object(iu.b)()],rA.prototype,"samples",void 0);var nA=function(){function e(t,r,n){Object(c.a)(this,e),this._techniqueRep=t,this._rctx=r,this._requestRender=n,this._enabled=!1,this._ssaoTechniqueConfig=new rA,this.quadVAO=null,this._BLUR_F=2,this._attenuation=.5,this._radius=3,this._samples=16,this._viewportToRestore=Object($l.e)()}return Object(l.a)(e,[{key:"dispose",value:function(){this.quadVAO=Object(I.f)(this.quadVAO)}},{key:"enabled",get:function(){return this._enabled},set:function(e){e?this._enable():this._disable()}},{key:"attenuation",get:function(){return this._attenuation},set:function(e){this._attenuation=e}},{key:"radius",get:function(){return this._radius},set:function(e){this._radius=e}},{key:"samples",get:function(){return this._samples},set:function(e){this._samples=e,this._enabled&&this._selectPrograms()}},{key:"ready",get:function(){return this.enabled&&Object(I.j)(this._noiseTexture)&&Object(I.j)(this._ssaoFBO)&&Object(I.j)(this._blur0FBO)&&Object(I.j)(this._blur1FBO)}},{key:"computeSSAO",value:function(e,t,r){if(!(!this.enabled||Object(I.i)(this._noiseTexture)||Object(I.i)(this._ssaoFBO)||Object(I.i)(this._blur0FBO)||Object(I.i)(this._blur1FBO))){var n=this._rctx,i=e.fullViewport,a=i[2],o=i[3],s=a/this._BLUR_F,c=o/this._BLUR_F;this._ssaoFBO.resize(a,o),this._blur0FBO.resize(s,c),this._blur1FBO.resize(s,c);var l=1*a,u=1*o;Object(Su.c)(this._viewportToRestore,e.fullViewport),n.bindFramebuffer(this._ssaoFBO),n.setViewport(0,0,a,o);var d=this._ssaoTechnique.program;n.useProgram(d),n.setPipelineState(this._ssaoTechnique.pipeline),d.setUniform2f("rnmScale",a/this._noiseTexture.descriptor.width,o/this._noiseTexture.descriptor.height),d.setUniform3fv("pSphere",this._samples<=8?this._data.random8:this._samples<=16?this._data.random16:this._samples<=32?this._data.random32:this._data.random64);var h=this._data.minDiscrepancy,f=this._samples<h.length?h[this._samples]:5779;d.setUniform1f("numSpiralTurns",f);var p=aA,b=iA;Object(qu.f)(e.projectionMatrix,e.fullWidth,e.fullHeight,p,b),d.setUniform4fv("projInfo",p),d.setUniform2fv("zScale",b),d.setUniform2f("nearFar",e.near,e.far);var v=1/e.computeRenderPixelSizeAtDist(1);d.setUniform1f("projScale",1*v),d.setUniform2f("screenDimensions",l,u);var m=Object(Yl.o)(e.eye,e.center),y=20*e.computeRenderPixelSizeAtDist(m);y=Math.max(.1,y),d.setUniform1f("radius",y),d.setUniform1f("intensity",4*this._attenuation/Math.pow(y,6)),d.bindTexture(this._noiseTexture,"rnm"),d.bindTexture(r,"normalMap"),d.bindTexture(t,"depthMap"),Object(I.i)(this.quadVAO)&&(this.quadVAO=Object(Gu.d)(this._rctx));var g=this.quadVAO;n.bindVAO(g),n.drawArrays(5,0,Object(mu.f)(g,"geometry"));var O=this._blurTechnique.program;n.useProgram(O),O.bindTexture(this._ssaoFBO.colorTexture,"tex"),O.bindTexture(r,"normalMap"),O.bindTexture(t,"depthMap"),n.setViewport(0,0,l/this._BLUR_F,u/this._BLUR_F),n.bindFramebuffer(this._blur0FBO),O.setUniform2f("screenDimensions",l,u),O.setUniform2f("blurSize",0,1*this._BLUR_F/u),O.setUniform1i("radius",4),O.setUniform1f("g_BlurFalloff",.08),O.setUniform2f("nearFar",e.near,e.far),m>5e4&&(v=Math.max(0,v-(m-5e4))),O.setUniform1f("projScale",v),O.setUniform2f("zScale",1,0),n.drawArrays(5,0,Object(mu.f)(g,"geometry")),O.setUniform2f("blurSize",1*this._BLUR_F/l,0),n.bindFramebuffer(this._blur1FBO),O.bindTexture(this._blur0FBO.colorTexture,"tex"),n.drawArrays(5,0,Object(mu.f)(g,"geometry")),n.setViewport(this._viewportToRestore[0],this._viewportToRestore[1],this._viewportToRestore[2],this._viewportToRestore[3])}}},{key:"bind",value:function(e){this.enabled&&Object(I.j)(this._blur1FBO)&&Object(I.j)(this._ssaoFBO)?(e.bindTexture(this._blur1FBO.colorTexture,"ssaoTex"),e.setUniform4f("viewportPixelSz",this._viewportToRestore[0],this._viewportToRestore[1],1/this._ssaoFBO.width,1/this._ssaoFBO.height)):e.setUniform4f("viewportPixelSz",-1,-1,-1,-1)}},{key:"_selectPrograms",value:function(){var e=this._samples<=8?0:this._samples<=16?1:this._samples<=32?2:3;this._ssaoTechniqueConfig.samples=e,this._ssaoTechniqueConfig.output=0,this._ssaoTechnique=this._techniqueRep.releaseAndAcquire(tA,this._ssaoTechniqueConfig,this._ssaoTechnique),this._ssaoTechniqueConfig.output=1,this._blurTechnique=this._techniqueRep.releaseAndAcquire(tA,this._ssaoTechniqueConfig,this._blurTechnique)}},{key:"_enable",value:function(){var e=this;this.enabled||(this._enabled=!0,this._loadResources((function(){e._enabled&&e._initialize()})))}},{key:"_loadResources",value:function(e){var t=this;this._data?e():r.e(192).then(r.bind(null,1083)).then((function(r){t._data=r,e()}))}},{key:"_initialize",value:function(){var e=this,t={target:3553,pixelFormat:6408,dataType:5121,samplingMode:9729,wrapMode:33071,width:0,height:0},r={colorTarget:0,depthStencilTarget:0};Object(eu.a)(this._data.noiseTexture).then((function(n){e._enabled&&(e._ssaoFBO=new Sk.a(e._rctx,r,t),e._blur0FBO=new Sk.a(e._rctx,r,t),e._blur1FBO=new Sk.a(e._rctx,r,t),e._noiseTexture=new vu.a(e._rctx,{target:3553,pixelFormat:6408,dataType:5121,hasMipmap:!0,width:n.width,height:n.height},n),e._requestRender())})),this._selectPrograms()}},{key:"_disable",value:function(){this._enabled=!1,this._noiseTexture=Object(I.f)(this._noiseTexture),this._blur1FBO=Object(I.f)(this._blur1FBO),this._blur0FBO=Object(I.f)(this._blur0FBO),this._ssaoFBO=Object(I.f)(this._ssaoFBO)}},{key:"gpuMemoryUsage",get:function(){return(Object(I.j)(this._blur0FBO)?this._blur0FBO.gpuMemoryUsage:0)+(Object(I.j)(this._blur1FBO)?this._blur1FBO.gpuMemoryUsage:0)+(Object(I.j)(this._ssaoFBO)?this._ssaoFBO.gpuMemoryUsage:0)}},{key:"test",get:function(){return{ssao:this._ssaoFBO,blur:this._blur1FBO}}}]),e}(),iA=Object(ku.b)(),aA=Object($l.e)(),oA=nA,sA=r(374),cA=r(490);var lA=function(){function e(t){Object(c.a)(this,e),this.factory=t,this.originData=new Map}return Object(l.a)(e,[{key:"acquire",value:function(e){return this.register(this.factory.getOrigin(e))}},{key:"register",value:function(e){var t=this.originData.get(e.id);return t?(t.refCount++,t.origin):(this.originData.set(e.id,{refCount:1,viewMatrix:Object(Kl.d)(),origin:e}),e)}},{key:"release",value:function(e){var t=this.originData.get(e.id);t&&(t.refCount--,0===t.refCount&&this.originData.delete(e.id))}},{key:"updateViewMatrices",value:function(e){this.originData.forEach((function(t){Object(Jl.d)(t.viewMatrix,e),function(e,t){var r=t,n=e[0],i=e[1],a=e[2];r[12]+=n*r[0]+i*r[4]+a*r[8],r[13]+=n*r[1]+i*r[5]+a*r[9],r[14]+=n*r[2]+i*r[6]+a*r[10],r[14]+=n*r[3]+i*r[7]+a*r[11]}(t.origin.vec3,t.viewMatrix)}))}},{key:"getViewMatrix",value:function(e){return this.originData.get(e.id).viewMatrix}}]),e}(),uA=r(163),dA=r(170),hA=r(409),fA=r(112),pA=r(632),bA=function(e){Object(f.a)(r,e);var t=Object(p.a)(r);function r(){return Object(c.a)(this,r),t.apply(this,arguments)}return Object(l.a)(r,[{key:"bindPass",value:function(e){var t=this.program,r=e.edgeRenderParameters,n=e.bindParameters;hC.a.bindViewProjTransform(t,r.viewProjectionTransform),t.setUniformMatrix3fv("uTransformNormal_ViewFromGlobal",r.transformNormal_ViewFromGlobal),t.setUniformMatrix4fv("uProj",n.camera.projectionMatrix),t.setUniform2f("uDepthBias",.5,-4e-4),t.setUniform2f("uPixelToNDC",2/n.camera.fullViewport[2],2/n.camera.fullViewport[3]),t.setUniform2f("uNDCToPixel",n.camera.fullViewport[2]/2,n.camera.fullViewport[3]/2),t.setUniform1f("uDistanceFalloffFactor",r.distanceFalloffFactor),t.setUniform2f("uViewportDimInv",1/n.camera.fullViewport[2],1/n.camera.fullViewport[3]),t.setUniform1f("uPixelRatio",n.camera.pixelRatio||1)}},{key:"initializeProgram",value:function(e){var t=r.shader.get(),n=this.configuration,i=t.build({slicePlaneEnabled:n.slicePlaneEnabled,sliceHighlightDisabled:!1,sliceEnabledForVertexPrograms:!1,silhouette:n.silhouette,legacy:n.legacy,antialiasing:n.antialiasing,mode:n.mode,doublePrecisionRequiresObfuscation:n.doublePrecisionRequiresObfuscation,multipassTerrainEnabled:n.multipassTerrainEnabled,cullAboveGround:n.cullAboveGround});return new ou.a(e.rctx,i,dA.b)}},{key:"initializePipeline",value:function(e){var t=e.rctx.capabilities.blendMinMax;return Object(su.g)(t?{blending:Object(su.h)(1,1,0,1,32774,t.MAX),depthTest:{func:515},colorWrite:su.d}:{depthTest:{func:515},depthWrite:su.e,colorWrite:su.d})}}]),r}(nu.a);bA.shader=new ru.a(pA.a,(function(){return r.e(215).then(r.bind(null,1085))})),function(e){var t=function(e){Object(f.a)(r,e);var t=Object(p.a)(r);function r(){var e;return Object(c.a)(this,r),(e=t.apply(this,arguments)).slicePlaneEnabled=!1,e.silhouette=!1,e.legacy=!1,e.antialiasing=!1,e.mode=0,e.doublePrecisionRequiresObfuscation=!1,e.multipassTerrainEnabled=!1,e.cullAboveGround=!1,e}return r}(iu.a);Object(b.a)([Object(iu.b)()],t.prototype,"slicePlaneEnabled",void 0),Object(b.a)([Object(iu.b)()],t.prototype,"silhouette",void 0),Object(b.a)([Object(iu.b)()],t.prototype,"legacy",void 0),Object(b.a)([Object(iu.b)()],t.prototype,"antialiasing",void 0),Object(b.a)([Object(iu.b)({count:3})],t.prototype,"mode",void 0),Object(b.a)([Object(iu.b)()],t.prototype,"doublePrecisionRequiresObfuscation",void 0),Object(b.a)([Object(iu.b)()],t.prototype,"multipassTerrainEnabled",void 0),Object(b.a)([Object(iu.b)()],t.prototype,"cullAboveGround",void 0),e.Configuration=t}(bA||(bA={}));var vA={type:"uber",slicePlaneEnabled:!1,sliceHighlightDisabled:!1,strokesTexture:null,legacy:!0},mA=function(){function e(){Object(c.a)(this,e),this._value=0}return Object(l.a)(e,[{key:"value",get:function(){return this._value}},{key:"increment",value:function(){this._value++}},{key:"decrement",value:function(){this._value--}}]),e}(),yA={solid:0,sketch:1,uber:2},gA=function(){function e(t,r,n){Object(c.a)(this,e),this.rctx=t,this.shaderTechniqueRepository=r,this.config=new bA.Configuration,this.technique=null,this.refCount=new mA,this.renderables=new Set,this.sortedRenderables={1:{1:new zy.a,2:new zy.a},2:{1:new zy.a,2:new zy.a}},this.renderablesDirty=!1,this.settings=Object(ie.a)(Object(ie.a)({},vA),n),this.key=e.getKey(this.settings.type,this.settings.slicePlaneEnabled,this.settings.legacy);var i=this.settings.strokesTexture.variants;this.writerSettings={variants:i,reducedPrecision:Vy.a.DISABLE_ELEVATION_ALIGNERS_ITERATIVE_UPDATES},this.config.legacy=this.settings.legacy,this.config.mode=yA[this.settings.type],this.config.silhouette=!1,this.config.antialiasing=!!this.rctx.capabilities.blendMinMax,this.config.slicePlaneEnabled=this.settings.slicePlaneEnabled,this.config.doublePrecisionRequiresObfuscation=Object(bC.b)(t)}return Object(l.a)(e,[{key:"dispose",value:function(){this.technique=Object(I.q)(this.technique)}},{key:"addRenderable",value:function(e){this.renderables.add(e),this.renderablesDirty=!0}},{key:"removeRenderable",value:function(e){this.renderables.delete(e),this.renderablesDirty=!0}},{key:"setRenderablesDirty",value:function(){this.renderablesDirty=!0}},{key:"forEachRenderable",value:function(e,t){this.renderablesDirty&&this.sortRenderables(),this.sortedRenderables[t][1].forAll(e),this.sortedRenderables[t][2].forAll(e)}},{key:"setMultipassParameters",value:function(e){this.config.multipassTerrainEnabled=!!e.multipassTerrainEnabled&&e.multipassTerrainEnabled,this.config.cullAboveGround=!!e.cullAboveGround&&e.cullAboveGround}},{key:"bindRegularEdges",value:function(e,t){this.setMultipassParameters(e),this.config.silhouette=!1,this.technique=this.shaderTechniqueRepository.releaseAndAcquire(bA,this.config,this.technique),this.technique.bindPass({bindParameters:e,edgeRenderParameters:t}),this.rctx.setPipelineState(this.technique.pipeline),this.rctx.useProgram(this.technique.program)}},{key:"bindSilhouetteEdges",value:function(e,t){this.setMultipassParameters(e),this.config.silhouette=!0,this.technique=this.shaderTechniqueRepository.releaseAndAcquire(bA,this.config,this.technique),this.technique.bindPass({bindParameters:e,edgeRenderParameters:t}),this.rctx.setPipelineState(this.technique.pipeline),this.rctx.useProgram(this.technique.program)}},{key:"renderRegularEdges",value:function(e,t,r){this.render(e,e.regular.vao,t,r)}},{key:"renderSilhouetteEdges",value:function(e,t,r){this.render(e,e.silhouette.vao,t,r)}},{key:"render",value:function(e,t,r,n){this.setUniforms(e,r),this.rctx.bindVAO(t),this.rctx.capabilities.instancing.drawArraysInstanced(6,0,4,n)}},{key:"setUniforms",value:function(e,t){var r=this.technique.program;if(e.components.buffer.textureBuffer.bind(r,OA,jA),t.multipassTerrainEnabled&&(r.setUniform2fv("cameraNearFar",t.camera.nearFar),r.setUniform2fv("inverseViewport",t.inverseViewport),Object(fA.a)(r,t)),"origin"in e.transform)r.setUniformMatrix4fv("uView",t.localViewMatrixForEdges),r.setUniformMatrix4fv("uModel",e.transform.modelMatrix),Object(OS.b)(r,this.settings,t.slicePlane,e.transform.origin.vec3);else{var n=new MC(e.transform.position),i=Object(Tf.n)(_A,Object(Tf.e)(_A,e.transform.rotationScale)),a=new yC;Object(Yl.m)(a.worldFromModel_TL,n.low),Object(Yl.m)(a.worldFromModel_TH,n.high),Object(Tf.g)(a.worldFromModel_RS,e.transform.rotationScale),Object(Tf.g)(a.transformNormal_GlobalFromModel,i),hC.a.bindModelTransform(r,a),r.setUniformMatrix3fv("uTransformNormal_GlobalFromModel",a.transformNormal_GlobalFromModel);var o=t.camera.viewInverseTransposeMatrix,s=Object(Yl.y)(wA,o[3],o[7],o[11]);Object(OS.b)(r,this.settings,t.slicePlane,s)}"uber"!==this.settings.type&&"sketch"!==this.settings.type||this.setSketchUniforms(r),r.setUniform1f("uWorldLineRadiusPerDistance",Math.tan(t.camera.fovY/2)/(t.camera.fullViewport[3]/2))}},{key:"setSketchUniforms",value:function(e){var t=this.settings.strokesTexture,r=t.texture;Object(I.i)(r)||(e.bindTexture(r,"uStrokesTexture"),e.setUniform2f("uStrokesTextureScale",1/r.descriptor.width,1/r.descriptor.height),e.setUniform1f("uStrokesLog2Resolution",Object(m.n)(t.resolution)),e.setUniform1f("uStrokesNormalizationScale",t.normalizationScale),e.setUniform1f("uStrokesAmplitude",t.amplitude),e.setUniform1f("uStrokeVariants",t.variants))}},{key:"sortRenderables",value:function(){var e=this;this.renderablesDirty=!1,this.sortedRenderables[1][1].clear(),this.sortedRenderables[1][2].clear(),this.sortedRenderables[2][1].clear(),this.sortedRenderables[2][2].clear(),this.renderables.forEach((function(t){0!==t.objectTransparency&&0!==t.edgeTransparency&&e.sortedRenderables[t.objectTransparency][t.edgeTransparency].push(t)}));var t=function(e,t){return"origin"in e.transform&&"origin"in t.transform?e.transform.origin.id<t.transform.origin.id?-1:e.transform.origin.id>t.transform.origin.id?1:0:0};this.sortedRenderables[1][1].sort(t),this.sortedRenderables[1][2].sort(t),this.sortedRenderables[2][1].sort(t),this.sortedRenderables[2][2].sort(t)}}],[{key:"getKey",value:function(e,t,r){return"edges-t:".concat(e,":").concat(t,":").concat(r)}}]),e}(),OA="uComponentDataTex",jA="uComponentDataTexInvDim",_A=Object(Ek.b)(),wA=Object(X.e)(),xA=r(452),kA=r(410),SA=r(681),TA=function(e){Object(f.a)(r,e);var t=Object(p.a)(r);function r(e){return Object(c.a)(this,r),t.call(this,"EdgeProcessingWorker","wrappedWork",e)}return Object(l.a)(r,[{key:"process",value:function(){var e=Object(s.a)(o.a.mark((function e(t,r,n){var i,a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!n){e.next=2;break}return e.abrupt("return",Object(SA.work)(t));case 2:return i=this._packInput(t),e.next=5,this.invoke(i,r);case 5:return a=e.sent,e.abrupt("return",this._unpackOutput(a));case 7:case"end":return e.stop()}}),e,this)})));return function(t,r,n){return e.apply(this,arguments)}}()},{key:"getTransferList",value:function(e){return[e.dataBuffer]}},{key:"_packInput",value:function(e){return{dataBuffer:e.data.buffer,writerSettings:e.writerSettings,skipDeduplicate:e.skipDeduplicate,indicesBuffer:e.indices.buffer,indicesType:Object(hT.j)(e.indices)?"Uint32Array":"Uint16Array",indicesLength:e.indicesLength}}},{key:"_unpackOutput",value:function(e){return{regular:{instancesData:Object(kA.b)(e.regular.instancesData),lodInfo:{lengths:new Float32Array(e.regular.lodInfo.lengths)}},silhouette:{instancesData:Object(kA.b)(e.silhouette.instancesData),lodInfo:{lengths:new Float32Array(e.silhouette.lodInfo.lengths)}},averageEdgeLength:e.averageEdgeLength}}}]),r}(xA.a);function CA(e){var t,r=RA.resolution,n=r/2,a=new Uint8Array(4*r*r),o=4*r*n,s=RA.amplitude,c=2*s,l=4*r,u=Object(m.n)(r)+1,d=RA.strokes.length,h=(u-1)*d*l,f=Object(i.a)(RA.strokes);try{for(f.s();!(t=f.n()).done;){for(var p=t.value,b=p.distance,v=p.pressure,y=b,g=v,O=h,j=0;j<u;j++){0!==j&&(y=MA(y,0),g=MA(g,1));for(var _=0;_<RA.resolution;_++){var w=.5+(y?y[_%y.length]/c:0),x=g?g[_%g.length]:1;Object(qu.i)(w,a,O),Object(qu.i)(x,a,O+o),O+=4}O-=l*(d+1)}h+=l}}catch(S){f.e(S)}finally{f.f()}var k=new vu.a(e,{pixelFormat:6408,dataType:5121,hasMipmap:!1,samplingMode:9729,width:r,height:r,wrapMode:10497},a);return new EA(r,c,s,d,k)}function MA(e,t){if(!e)return null;for(var r=e.length/2,n=PA*r,i=new Array(r),a=0,o=1===t,s=0;s<e.length;s+=2){var c=(e[s]+e[s+1])/2;i[a++]=o?Math.min(n,1-(1-c)*AA):Math.min(n,c*AA)}return i}var PA=.1,AA=.5,EA=function(){function e(t,r,n,i,a){Object(c.a)(this,e),this.resolution=t,this.normalizationScale=r,this.amplitude=n,this.variants=i,this.texture=a}return Object(l.a)(e,[{key:"dispose",value:function(){this.texture=Object(I.f)(this.texture)}}]),e}(),RA={amplitude:8,resolution:256,strokes:[{distance:[-1.59027,-1.59426,-1.59674,-1.59766,-1.59702,-1.59479,-1.59095,-1.5855,-1.57843,-1.56973,-1.55942,-1.5475,-1.53398,-1.5189,-1.50226,-1.4841,-1.46446,-1.44337,-1.42088,-1.39703,-1.37188,-1.34547,-1.31786,-1.28912,-1.2593,-1.22847,-1.19668,-1.16402,-1.13053,-1.09629,-1.06137,-1.02582,-.98972,-.95313,-.91611,-.87872,-.84102,-.80306,-.76488,-.72654,-.68807,-.64952,-.61092,-.57232,-.53375,-.49527,-.45692,-.41874,-.38078,-.34309,-.3057,-.26867,-.23204,-.19585,-.16015,-.12497,-.09036,-.05634,-.02296,.00977,.04183,.07321,.10389,.13386,.16313,.19169,.21956,.24672,.27321,.299,.32413,.34858,.37237,.3955,.41798,.43981,.461,.48154,.50145,.52073,.53939,.55744,.57488,.5917,.6079,.62347,.63837,.65259,.66609,.67885,.69083,.70201,.71235,.72183,.73042,.73812,.7449,.75076,.7557,.75973,.76284,.76507,.76642,.76692,.76659,.76545,.76352,.76083,.7574,.75324,.74837,.74279,.73652,.72959,.72199,.71377,.70493,.69553,.68558,.67515,.66426,.65298,.64135,.62944,.6173,.60499,.59257,.58008,.56759,.55513,.54275,.5305,.51842,.50654,.4949,.48353,.47246,.4617,.45128,.44121,.43149,.42213,.41313,.40448,.39617,.38818,.3805,.37309,.36594,.35902,.35229,.34572,.33927,.33292,.32663,.32035,.31407,.30774,.30135,.29486,.28824,.28148,.27454,.26739,.26002,.25241,.24454,.23639,.22796,.21922,.21016,.20076,.19098,.18082,.17023,.1592,.14768,.13566,.1231,.10996,.09624,.08188,.06688,.05121,.03485,.01778,0,-.0185,-.03771,-.05763,-.07824,-.09952,-.12144,-.14396,-.16706,-.19069,-.21481,-.23938,-.26436,-.28971,-.31539,-.34136,-.36759,-.39404,-.42067,-.44746,-.47437,-.50136,-.52839,-.55544,-.58248,-.60948,-.63642,-.66329,-.6901,-.71684,-.74352,-.77015,-.79675,-.82332,-.84988,-.87644,-.90301,-.92958,-.95615,-.98272,-1.00926,-1.03575,-1.06217,-1.08847,-1.11463,-1.1406,-1.16633,-1.19178,-1.2169,-1.24164,-1.26595,-1.28979,-1.31312,-1.3359,-1.35809,-1.37963,-1.4005,-1.42064,-1.44,-1.45853,-1.47616,-1.49285,-1.50853,-1.52313,-1.53659,-1.54886,-1.55986,-1.56955,-1.57788,-1.5848],pressure:[-.01365,-.00206,.01025,.02327,.03696,.05129,.06619,.08163,.09755,.11393,.1307,.14784,.16531,.18308,.20111,.21938,.23786,.25651,.2753,.29419,.31315,.33215,.35115,.37015,.38913,.40806,.42694,.44576,.46449,.48313,.50167,.5201,.53839,.55653,.57448,.59222,.60971,.62692,.6438,.66033,.67648,.69221,.70753,.72242,.73688,.75093,.76456,.77779,.79063,.80309,.81517,.82686,.83817,.84911,.85967,.86987,.87972,.88924,.89845,.90734,.91594,.92425,.93229,.94005,.94754,.95475,.96166,.96826,.97451,.9804,.98588,.99092,.99549,.99957,.99685,.99381,.99131,.98936,.98796,.98711,.98681,.98706,.98787,.98923,.99113,.99357,.99654,1,.99607,.99171,.98695,.98181,.97634,.97057,.96452,.95824,.95175,.94506,.93818,.93113,.92389,.91647,.90887,.90109,.89314,.88501,.87672,.86831,.85978,.85119,.84256,.83393,.82533,.8168,.80836,.80002,.79181,.78374,.77582,.7681,.76059,.75331,.74629,.73955,.73311,.72697,.72116,.71568,.71054,.70572,.70121,.697,.69304,.68931,.68576,.68236,.67905,.67582,.67262,.66941,.66619,.66291,.65957,.65613,.65259,.64892,.6451,.6411,.6369,.63248,.62783,.62295,.61783,.61247,.60688,.60104,.59498,.58868,.58216,.57542,.56845,.56125,.5538,.5461,.53813,.52986,.52129,.51239,.50316,.49359,.4837,.47349,.46299,.45223,.44124,.43005,.41869,.40719,.39557,.38386,.37207,.36023,.34836,.33648,.32464,.31287,.30119,.28963,.27822,.26698,.25594,.2451,.23448,.22409,.21391,.20394,.19415,.18452,.17503,.16565,.15636,.14713,.13794,.1288,.11968,.11058,.10151,.09247,.08346,.07447,.06552,.05659,.0477,.03885,.03007,.02137,.01278,.00433,-.00393,-.012,-.01983,-.02738,-.03463,-.04155,-.0481,-.05429,-.0601,-.06553,-.07057,-.07524,-.07954,-.08347,-.08703,-.09022,-.09303,-.09544,-.09744,-.09898,-.10004,-.10059,-.1006,-.10005,-.09892,-.0972,-.09487,-.09192,-.08833,-.08409,-.07918,-.07357,-.06724,-.06019,-.0524,-.04386,-.03455,-.02448]},{distance:[-3.46259,-3.47131,-3.47668,-3.47863,-3.47712,-3.4721,-3.46352,-3.45138,-3.43566,-3.41635,-3.39347,-3.36704,-3.33709,-3.30368,-3.26684,-3.22667,-3.18322,-3.1366,-3.08689,-3.0342,-2.97865,-2.92036,-2.85946,-2.79607,-2.73034,-2.66241,-2.59242,-2.52052,-2.44686,-2.37159,-2.29485,-2.2168,-2.13757,-2.05731,-1.97616,-1.89426,-1.81174,-1.72875,-1.64543,-1.56191,-1.47833,-1.39483,-1.3115,-1.22847,-1.14581,-1.06361,-.98193,-.90083,-.82036,-.74054,-.66141,-.583,-.50532,-.4284,-.35228,-.277,-.20261,-.12916,-.05672,.01463,.08485,.15384,.22153,.28784,.35269,.41602,.47776,.53787,.59629,.653,.70799,.76123,.81274,.86253,.9106,.95698,1.0017,1.04477,1.0862,1.126,1.16415,1.20065,1.23546,1.26857,1.29994,1.32953,1.35731,1.38321,1.40719,1.42921,1.44922,1.46719,1.48309,1.49691,1.50862,1.51825,1.52581,1.53133,1.53486,1.53644,1.53616,1.53409,1.53031,1.52493,1.51803,1.50972,1.50009,1.48924,1.47725,1.46421,1.45019,1.43527,1.4195,1.40295,1.38568,1.36778,1.34929,1.3303,1.31087,1.29108,1.27099,1.25066,1.23018,1.2096,1.18898,1.16838,1.14785,1.12745,1.10721,1.08719,1.06741,1.04791,1.02871,1.00986,.99136,.97324,.95551,.93819,.92127,.90476,.88866,.87296,.85767,.84277,.82823,.81406,.80022,.7867,.77346,.76049,.74774,.73519,.72278,.71049,.69827,.68606,.67381,.66145,.64893,.63618,.62313,.60973,.5959,.5816,.56675,.5513,.53516,.51826,.50053,.4819,.46231,.44169,.42002,.39725,.37336,.34834,.32219,.2949,.2665,.23698,.20638,.17469,.14193,.10809,.07316,.03714,0,-.03827,-.07772,-.11836,-.16022,-.20332,-.24768,-.29332,-.34024,-.38844,-.43788,-.48854,-.54036,-.59329,-.64724,-.70211,-.75782,-.81425,-.87128,-.92881,-.98674,-1.04498,-1.10346,-1.1621,-1.22086,-1.27969,-1.33854,-1.3974,-1.45625,-1.51511,-1.57396,-1.63283,-1.69173,-1.75067,-1.80968,-1.86875,-1.9279,-1.98712,-2.04639,-2.10568,-2.16495,-2.22416,-2.28322,-2.34208,-2.40063,-2.4588,-2.51647,-2.57354,-2.62989,-2.68543,-2.74002,-2.79357,-2.84597,-2.89711,-2.94689,-2.99521,-3.04195,-3.087,-3.13023,-3.17152,-3.21075,-3.24779,-3.28252,-3.3148,-3.34451,-3.37154,-3.39577,-3.41709,-3.43539,-3.45059],pressure:[.87183,.87151,.87129,.87118,.87117,.87128,.87149,.87182,.87225,.8728,.87347,.87424,.87513,.87613,.87723,.87845,.87978,.88122,.88276,.88441,.88616,.88801,.88996,.892,.89414,.89637,.89868,.90108,.90356,.90611,.90874,.91144,.91421,.91704,.91993,.92287,.92587,.92892,.93201,.93514,.93831,.94151,.94474,.94799,.95126,.95456,.95786,.96118,.9645,.96783,.97116,.97448,.9778,.98111,.98441,.9877,.99096,.99421,.99742,.99938,.99622,.9931,.99001,.98697,.98397,.98101,.97811,.97526,.97246,.96972,.96703,.96441,.96185,.95935,.95691,.95455,.95225,.95002,.94786,.94577,.94376,.94182,.93995,.93817,.93646,.93483,.93328,.93181,.93042,.92911,.92788,.92673,.92566,.92467,.92376,.92293,.92217,.92149,.92088,.92034,.91987,.91947,.91913,.91886,.91864,.91849,.91838,.91833,.91834,.91839,.91849,.91863,.91883,.91907,.91935,.91968,.92005,.92046,.92092,.92142,.92195,.92253,.92314,.9238,.92449,.92521,.92598,.92677,.9276,.92847,.92936,.93029,.93125,.93224,.93325,.9343,.93537,.93646,.93758,.93872,.93988,.94106,.94225,.94346,.94469,.94593,.94718,.94844,.94971,.95098,.95226,.95354,.95482,.9561,.95738,.95867,.95995,.96122,.9625,.96377,.96504,.9663,.96757,.96883,.97009,.97135,.97261,.97387,.97513,.9764,.97767,.97895,.98023,.98153,.98284,.98416,.98549,.98684,.98821,.9896,.99101,.99244,.99389,.99537,.99688,.99842,1,.99839,.99675,.99508,.99336,.99161,.98982,.98799,.98613,.98422,.98228,.98029,.97827,.97622,.97414,.97202,.96987,.9677,.96551,.9633,.96107,.95882,.95656,.9543,.95202,.94975,.94747,.94519,.94292,.94065,.93838,.93613,.93388,.93164,.92941,.9272,.92499,.9228,.92062,.91846,.91631,.91418,.91207,.90998,.90792,.90588,.90387,.90189,.89995,.89804,.89617,.89434,.89256,.89083,.88914,.88752,.88595,.88443,.88299,.88161,.8803,.87907,.87791,.87683,.87584,.87494,.87412,.8734,.87278,.87225]},{distance:[.39335,.43437,.47737,.52234,.56923,.61801,.66864,.72109,.7753,.83123,.88882,.94801,1.00875,1.07097,1.13461,1.1996,1.26586,1.33333,1.40193,1.47158,1.54221,1.61373,1.68607,1.75913,1.83284,1.90711,1.98186,2.05699,2.13243,2.20809,2.28387,2.35971,2.4355,2.51117,2.58663,2.66179,2.73658,2.81092,2.88473,2.95792,3.03043,3.10217,3.17308,3.24309,3.31211,3.3801,3.44697,3.51267,3.57712,3.64028,3.70208,3.76247,3.8214,3.87881,3.93467,3.98892,4.04152,4.09244,4.14164,4.18908,4.23474,4.27859,4.32061,4.36077,4.39905,4.43544,4.46992,4.50249,4.53314,4.56185,4.58864,4.61349,4.63642,4.65745,4.67657,4.69381,4.7092,4.72274,4.73447,4.74441,4.75259,4.75903,4.76376,4.76682,4.76822,4.768,4.76618,4.76279,4.75786,4.75142,4.74348,4.73409,4.72326,4.71102,4.69739,4.68241,4.6661,4.64849,4.6296,4.60948,4.58816,4.56567,4.54204,4.51732,4.49154,4.46473,4.43694,4.4082,4.37854,4.348,4.31662,4.28443,4.25145,4.21773,4.1833,4.14819,4.11243,4.07606,4.03912,4.00162,3.96361,3.92512,3.88618,3.84683,3.80708,3.76697,3.72653,3.68579,3.64478,3.60351,3.56202,3.52033,3.47845,3.43642,3.39425,3.35196,3.30957,3.2671,3.22455,3.18196,3.13933,3.09668,3.05402,3.01136,2.96873,2.92613,2.88357,2.84108,2.79865,2.75631,2.71407,2.67195,2.62994,2.58807,2.54634,2.50477,2.46338,2.42216,2.38114,2.34032,2.29971,2.25933,2.21916,2.17923,2.13954,2.10008,2.06087,2.02189,1.98316,1.94468,1.90644,1.86845,1.83069,1.79316,1.75586,1.71877,1.68189,1.6452,1.60868,1.57232,1.53611,1.50004,1.46407,1.4282,1.39241,1.35668,1.321,1.28535,1.24972,1.2141,1.17849,1.14286,1.10723,1.07158,1.03593,1.00028,.96464,.92902,.89344,.85793,.8225,.78719,.75203,.71705,.68231,.64784,.61369,.57991,.54656,.51368,.48134,.44959,.41849,.3881,.35848,.32967,.30174,.27474,.24872,.22373,.19982,.17702,.15539,.13497,.11579,.09791,.08137,.06621,.05248,.04022,.02948,.02029,.01271,.00677,.00252,0,-76e-5,27e-5,.00314,.00788,.01451,.02307,.03357,.04604,.0605,.07697,.09546,.11599,.13858,.16322,.18992,.21869,.24952,.28241,.31735,.35434],pressure:[.95248,.95236,.95228,.95223,.95222,.95224,.95231,.95241,.95256,.95274,.95296,.95322,.95352,.95385,.95423,.95465,.9551,.9556,.95613,.9567,.95731,.95796,.95864,.95936,.96012,.96091,.96173,.96259,.96348,.9644,.96535,.96633,.96734,.96838,.96944,.97053,.97164,.97277,.97393,.9751,.97629,.9775,.97873,.97997,.98122,.98249,.98376,.98505,.98634,.98763,.98893,.99023,.99154,.99284,.99414,.99544,.99673,.99802,.9993,.99942,.99816,.99691,.99568,.99445,.99324,.99205,.99087,.98972,.98858,.98746,.98636,.98528,.98423,.9832,.98219,.98121,.98025,.97931,.9784,.97752,.97666,.97582,.97501,.97423,.97347,.97274,.97203,.97135,.9707,.97007,.96948,.9689,.96836,.96784,.96735,.96689,.96646,.96605,.96567,.96533,.965,.96471,.96445,.96421,.964,.96382,.96367,.96355,.96346,.96339,.96335,.96334,.96336,.9634,.96348,.96358,.9637,.96385,.96403,.96423,.96446,.96471,.96499,.96529,.96561,.96595,.96631,.96669,.96709,.96751,.96795,.9684,.96887,.96935,.96984,.97035,.97087,.9714,.97194,.97249,.97304,.97361,.97418,.97476,.97534,.97592,.97651,.97711,.9777,.9783,.9789,.9795,.9801,.9807,.9813,.9819,.9825,.98309,.98369,.98428,.98486,.98545,.98603,.98661,.98718,.98775,.98832,.98888,.98944,.99,.99056,.99112,.99167,.99223,.99279,.99335,.99392,.99449,.99507,.99565,.99624,.99684,.99745,.99807,.9987,.99934,1,.99933,.99866,.99797,.99727,.99656,.99583,.9951,.99435,.99359,.99283,.99205,.99126,.99046,.98966,.98885,.98803,.9872,.98637,.98554,.9847,.98387,.98303,.98219,.98134,.9805,.97967,.97883,.978,.97717,.97634,.97552,.97471,.97389,.97309,.97229,.9715,.97071,.96993,.96915,.96838,.96762,.96687,.96612,.96539,.96466,.96395,.96324,.96255,.96187,.9612,.96055,.95991,.95929,.95869,.95811,.95754,.957,.95648,.95599,.95552,.95508,.95467,.95428,.95393,.9536,.95331,.95305,.95283,.95264]},{distance:[2.85606,2.86149,2.86432,2.8645,2.862,2.85686,2.84912,2.83886,2.82618,2.81117,2.79393,2.77456,2.75314,2.72975,2.70447,2.67734,2.64844,2.61784,2.58564,2.55196,2.5169,2.48057,2.44305,2.40438,2.36462,2.32383,2.28208,2.23943,2.19591,2.15153,2.10628,2.06016,2.01321,1.96548,1.91702,1.86793,1.8183,1.76829,1.71803,1.66767,1.61737,1.56726,1.51746,1.46803,1.41902,1.37044,1.32228,1.27452,1.22716,1.18023,1.13376,1.08781,1.04244,.99769,.95357,.91003,.86701,.82447,.78238,.74069,.69938,.65836,.61758,.57699,.53656,.49627,.45611,.41611,.37632,.33683,.29776,.25924,.22141,.18441,.14839,.11346,.07972,.04727,.01619,-.01348,-.0417,-.0684,-.09351,-.11698,-.13875,-.1588,-.17713,-.19381,-.20889,-.22242,-.23444,-.24501,-.25421,-.26216,-.26897,-.27473,-.27951,-.28336,-.28631,-.28836,-.28948,-.28963,-.28873,-.28673,-.28355,-.27916,-.27354,-.26673,-.25878,-.2498,-.23992,-.22929,-.21802,-.20623,-.19398,-.18134,-.16836,-.1551,-.14163,-.12809,-.11461,-.1013,-.08826,-.07557,-.06335,-.0517,-.04077,-.03065,-.02143,-.01321,-.00606,0,.00496,.00888,.01181,.01385,.01511,.0157,.01574,.01533,.01458,.01358,.0124,.01112,.00979,.00851,.00738,.0065,.006,.00596,.00646,.00754,.00924,.01161,.01471,.01858,.02323,.02865,.03481,.04169,.0493,.05765,.06677,.07671,.08754,.09934,.11222,.12628,.14159,.15823,.17624,.19561,.21632,.23828,.26142,.28563,.31083,.33696,.36397,.39185,.42057,.4501,.48036,.51125,.54264,.5744,.60646,.63871,.67105,.70337,.73556,.76751,.79918,.83048,.86139,.8919,.92202,.95184,.98144,1.01094,1.04045,1.0701,1.10002,1.13029,1.16103,1.1923,1.22416,1.25664,1.28979,1.32364,1.35824,1.39363,1.42985,1.4669,1.50475,1.54332,1.58252,1.62227,1.6625,1.70312,1.744,1.78501,1.82598,1.8668,1.90734,1.94754,1.98732,2.02666,2.06555,2.10402,2.1421,2.17985,2.2173,2.25448,2.29139,2.328,2.36424,2.4,2.43515,2.46955,2.50309,2.53565,2.56717,2.59761,2.62692,2.65505,2.68191,2.7074,2.73138,2.75375,2.7744,2.79324,2.81017,2.82504,2.83772,2.8481],pressure:[.22758,.23641,.24578,.25568,.26609,.27699,.28835,.30016,.31237,.32495,.33789,.35113,.36466,.37843,.39241,.40658,.4209,.43535,.44989,.4645,.47916,.49385,.50853,.5232,.53784,.55243,.56696,.58141,.59578,.61004,.62419,.63821,.65209,.6658,.67934,.69268,.70582,.71873,.73139,.7438,.75594,.76779,.77935,.79061,.80156,.81221,.82254,.83258,.84231,.85176,.86091,.86978,.87837,.88669,.89473,.9025,.91,.91725,.92425,.931,.93752,.9438,.94985,.95566,.96124,.96658,.97168,.97652,.98109,.98539,.98939,.99309,.99646,.99949,.99783,.99552,.99361,.99209,.99098,.99029,.99003,.99019,.99079,.99181,.99324,.9951,.99735,1,.99698,.99361,.98992,.98592,.98163,.97709,.97231,.96731,.96212,.95676,.95122,.94554,.93973,.93378,.92773,.92157,.91532,.90899,.90258,.89612,.88961,.88308,.87653,.87,.8635,.85705,.85068,.8444,.83823,.83219,.82628,.82052,.81493,.80952,.8043,.79929,.7945,.78994,.78561,.78151,.77765,.77402,.77062,.76742,.76443,.76161,.75896,.75645,.75406,.75175,.74951,.7473,.74511,.74289,.74064,.73833,.73592,.73341,.73078,.728,.72507,.72197,.71869,.71522,.71156,.70769,.70363,.69936,.69489,.69021,.68533,.68023,.67492,.66939,.66363,.65765,.65145,.64501,.63833,.63143,.62428,.61691,.60931,.60148,.59344,.58521,.57679,.5682,.55948,.55063,.54167,.53264,.52354,.51439,.50522,.49603,.48686,.47773,.46865,.45964,.45072,.44192,.43324,.42469,.41629,.40804,.39994,.392,.3842,.37655,.36903,.36164,.35437,.3472,.34012,.33312,.3262,.31933,.31251,.30574,.299,.2923,.28563,.27899,.27239,.26583,.25933,.25288,.24652,.24025,.2341,.22808,.22221,.21653,.21104,.20576,.20072,.19592,.19138,.18712,.18313,.17943,.17602,.17292,.17013,.16766,.16551,.16369,.16222,.1611,.16036,.16001,.16007,.16055,.16148,.16286,.16471,.16705,.16988,.17321,.17706,.18144,.18636,.19182,.19785,.20443,.21158,.2193]},{distance:[-2.31317,-2.3191,-2.32189,-2.32154,-2.31811,-2.31174,-2.30254,-2.29062,-2.27609,-2.25904,-2.23954,-2.21767,-2.19355,-2.16732,-2.13907,-2.10885,-2.07672,-2.04268,-2.00677,-1.96911,-1.92985,-1.88914,-1.84713,-1.80397,-1.75979,-1.71467,-1.66864,-1.62171,-1.57395,-1.52546,-1.47625,-1.42628,-1.3755,-1.32384,-1.27131,-1.218,-1.16408,-1.10972,-1.05508,-1.00031,-.94551,-.89077,-.83615,-.7817,-.72757,-.6739,-.62076,-.56821,-.51625,-.46484,-.41397,-.36366,-.314,-.26506,-.21689,-.16957,-.12316,-.07766,-.03301,.01085,.05399,.09643,.13827,.17967,.22079,.26176,.30265,.34342,.38397,.42414,.46381,.50285,.54115,.57863,.61524,.65093,.6856,.71914,.75153,.78275,.81283,.84182,.86972,.89651,.92208,.94634,.96919,.99052,1.01025,1.02835,1.04484,1.05976,1.07309,1.08479,1.09492,1.1036,1.11096,1.11714,1.12224,1.12627,1.12916,1.13083,1.13125,1.13036,1.12816,1.12466,1.11992,1.11397,1.10677,1.09827,1.08849,1.07746,1.06527,1.05203,1.03786,1.02283,1.00695,.99025,.97279,.9546,.93573,.9163,.8965,.8765,.85647,.83652,.81687,.79775,.77939,.76199,.74568,.73049,.71635,.70316,.69082,.67925,.66834,.65804,.64831,.63911,.63032,.62184,.61363,.60564,.59788,.59036,.58308,.57597,.5689,.56177,.55447,.5469,.53896,.53062,.5219,.51283,.5034,.49355,.48335,.47287,.46223,.45154,.44085,.43012,.41923,.40805,.39648,.38441,.37176,.35849,.34458,.32999,.31461,.29833,.28109,.26288,.2437,.22361,.20265,.18082,.15807,.13434,.1096,.0838,.0569,.02894,0,-.0298,-.0604,-.09173,-.12364,-.15594,-.18843,-.22092,-.25331,-.28559,-.31781,-.35006,-.38244,-.41502,-.44785,-.48098,-.5144,-.54811,-.58218,-.61666,-.65153,-.68677,-.72232,-.75807,-.79397,-.83002,-.86628,-.90281,-.93968,-.97693,-1.01465,-1.05282,-1.09139,-1.13031,-1.16956,-1.20917,-1.24905,-1.28907,-1.32908,-1.36891,-1.40844,-1.44765,-1.48658,-1.52527,-1.56376,-1.60206,-1.64016,-1.67801,-1.71552,-1.75264,-1.78936,-1.8257,-1.86161,-1.89702,-1.93182,-1.96584,-1.99894,-2.03102,-2.06203,-2.0919,-2.12056,-2.14794,-2.17397,-2.19852,-2.22138,-2.24235,-2.26129,-2.27805,-2.29243,-2.30422],pressure:[.9681,.97424,.98046,.98674,.99309,.9995,.99404,.98754,.981,.97444,.96785,.96124,.95462,.94801,.94139,.93479,.92822,.92167,.91515,.90868,.90225,.89589,.88959,.88336,.87722,.87115,.86519,.85932,.85356,.84792,.84239,.83699,.83173,.8266,.82162,.81679,.81211,.80759,.80324,.79906,.79505,.79121,.78756,.78409,.78081,.77771,.77481,.77211,.76959,.76728,.76516,.76324,.76153,.76001,.75869,.75757,.75665,.75593,.7554,.75507,.75493,.75498,.75523,.75565,.75627,.75706,.75803,.75917,.76049,.76197,.76361,.76541,.76737,.76947,.77172,.77409,.7766,.77923,.78198,.78484,.7878,.79086,.79401,.79724,.80055,.80394,.8074,.81092,.8145,.81813,.82182,.82556,.82934,.83317,.83703,.84093,.84487,.84884,.85284,.85687,.86094,.86503,.86915,.87329,.87746,.88166,.88587,.89011,.89436,.89863,.90291,.9072,.91149,.91579,.92009,.92438,.92867,.93295,.9372,.94144,.94566,.94985,.954,.95812,.96219,.96623,.97021,.97415,.97802,.98184,.9856,.9893,.99293,.9965,1,.99657,.9932,.98991,.98668,.98352,.98042,.97738,.9744,.97148,.9686,.96577,.96298,.96023,.95751,.95482,.95214,.94949,.94684,.9442,.94156,.93892,.93627,.93361,.93094,.92825,.92555,.92284,.9201,.91735,.91458,.91179,.90899,.90616,.90332,.90047,.8976,.89472,.89183,.88893,.88603,.88314,.88024,.87735,.87448,.87162,.86878,.86597,.86319,.86044,.85774,.85508,.85247,.84993,.84744,.84503,.84269,.84042,.83825,.83616,.83417,.83227,.83048,.8288,.82724,.82578,.82445,.82324,.82215,.82119,.82037,.81967,.81911,.81868,.81839,.81824,.81823,.81835,.81862,.81903,.81957,.82026,.82109,.82206,.82317,.82443,.82583,.82737,.82906,.83089,.83287,.83499,.83726,.83968,.84223,.84494,.84778,.85077,.8539,.85717,.86058,.86412,.86781,.87163,.87559,.87968,.88391,.88826,.89275,.89737,.90211,.90698,.91198,.91709,.92233,.92768,.93315,.93873,.94441,.95019,.95607,.96205]},{distance:[4.72925,4.81721,4.9037,4.98859,5.07177,5.15311,5.23249,5.3098,5.38491,5.45772,5.52811,5.59598,5.66122,5.72375,5.78346,5.84028,5.8941,5.94486,5.99248,6.03689,6.07803,6.11584,6.15028,6.18128,6.20882,6.23285,6.25336,6.27031,6.28369,6.29348,6.29969,6.3023,6.30133,6.29678,6.28867,6.27703,6.26187,6.24324,6.22116,6.19567,6.16683,6.13468,6.09928,6.06068,6.01896,5.97417,5.92639,5.87569,5.82217,5.76589,5.70696,5.64545,5.58147,5.5151,5.44644,5.37559,5.30265,5.2277,5.15085,5.0722,4.99184,4.90987,4.82639,4.74151,4.65533,4.56794,4.47945,4.38996,4.29959,4.20843,4.11658,4.02416,3.93125,3.83796,3.74437,3.65057,3.55666,3.46272,3.36884,3.27509,3.18155,3.08831,2.99545,2.90303,2.81114,2.71984,2.62922,2.53933,2.45026,2.36207,2.27484,2.18862,2.10349,2.01951,1.93675,1.85528,1.77515,1.69644,1.61919,1.54348,1.46935,1.39685,1.32605,1.25698,1.18967,1.12417,1.06049,.99863,.93862,.88044,.82408,.76953,.71676,.66574,.61644,.56882,.52282,.47841,.43553,.39413,.35414,.31551,.27817,.24206,.20712,.17328,.14048,.10866,.07776,.04772,.01848,-.00999,-.03776,-.06487,-.09134,-.11721,-.14251,-.16725,-.19144,-.21509,-.2382,-.26076,-.28275,-.30416,-.32496,-.34511,-.36459,-.38334,-.40134,-.41852,-.43485,-.45026,-.46471,-.47815,-.49052,-.50179,-.51189,-.52081,-.52849,-.5349,-.54003,-.54383,-.54627,-.54734,-.54702,-.54528,-.54211,-.53752,-.53149,-.52403,-.51515,-.50487,-.4932,-.48015,-.46575,-.45001,-.43297,-.41463,-.39503,-.37419,-.35213,-.32887,-.30443,-.27885,-.25214,-.22432,-.19541,-.16544,-.13442,-.10235,-.06926,-.03514,0,.03616,.07336,.11159,.15088,.19125,.23272,.27531,.31906,.36401,.41019,.45764,.5064,.55651,.60802,.66096,.71538,.77129,.82874,.88776,.94836,1.01056,1.07438,1.13982,1.20687,1.27554,1.34581,1.41766,1.49107,1.56599,1.64239,1.72025,1.79951,1.88013,1.96209,2.04532,2.12979,2.21546,2.30226,2.39017,2.47911,2.56905,2.65991,2.75164,2.84416,2.93742,3.03133,3.12582,3.2208,3.31619,3.41191,3.50785,3.60393,3.70006,3.79612,3.89202,3.98765,4.08291,4.17767,4.27182,4.36525,4.45783,4.54944,4.63995],pressure:[.30942,.30838,.30765,.30724,.30715,.30738,.30795,.30884,.31007,.31164,.31354,.31578,.31837,.32129,.32455,.32815,.33209,.33636,.34097,.34591,.35117,.35675,.36265,.36887,.37539,.38221,.38933,.39674,.40442,.41238,.4206,.42907,.43779,.44675,.45593,.46533,.47493,.48473,.49471,.50486,.51517,.52563,.53623,.54694,.55777,.5687,.57971,.59079,.60194,.61313,.62435,.6356,.64686,.65811,.66935,.68056,.69174,.70286,.71391,.72489,.73579,.74659,.75728,.76785,.7783,.7886,.79876,.80877,.81861,.82827,.83776,.84706,.85617,.86507,.87378,.88227,.89056,.89863,.90649,.91412,.92153,.92872,.93568,.94241,.94892,.95519,.96122,.96702,.97258,.97791,.98299,.98783,.99242,.99677,.99911,.99525,.99164,.98827,.98515,.98228,.97966,.97728,.97514,.97324,.97159,.97017,.96898,.96801,.96727,.96674,.96641,.96629,.96635,.96661,.96703,.96762,.96838,.96928,.97032,.97149,.97279,.9742,.97572,.97734,.97905,.98085,.98273,.98468,.98669,.98877,.99091,.99311,.99535,.99765,1,.9976,.99516,.99267,.99014,.98755,.98491,.98222,.97947,.97666,.97378,.97083,.96781,.96471,.96153,.95826,.9549,.95144,.94787,.9442,.94042,.93651,.93249,.92834,.92407,.91966,.91512,.91045,.90564,.90069,.8956,.89037,.885,.87949,.87384,.86806,.86214,.85608,.84988,.84356,.83711,.83053,.82383,.81702,.81009,.80306,.79594,.78872,.78141,.77403,.76657,.75905,.75148,.74385,.73619,.72849,.72076,.71302,.70526,.69749,.68972,.68195,.67419,.66644,.65871,.65099,.64329,.63561,.62795,.62032,.61271,.60512,.59755,.59001,.58248,.57497,.56749,.56002,.55256,.54512,.5377,.5303,.52291,.51554,.50819,.50087,.49358,.48632,.4791,.47192,.4648,.45773,.45072,.44378,.43692,.43015,.42346,.41687,.41039,.40403,.39779,.39168,.38571,.37989,.37423,.36873,.36342,.35828,.35335,.34862,.34409,.3398,.33573,.3319,.32831,.32498,.32192,.31912,.3166,.31436,.31242,.31077]}]};function IA(e){var t,r=null,n=Object(i.a)(e);try{for(n.s();!(t=n.n()).done;){var a=t.value,o=a.type;if(LA(a))if(Object(I.i)(r))r=o;else if(r!==o)return"uber"}}catch(s){n.e(s)}finally{n.f()}return Object(I.j)(r)?r:"solid"}function DA(e){var t,r=0,n=Object(i.a)(e);try{for(n.s();!(t=n.n()).done;){var a=t.value.material;if(LA(a)){if(a.color[3]*a.opacity<1)return 1;r=2}}}catch(o){n.e(o)}finally{n.f()}return r}function FA(e){var t,r=0,n=Object(i.a)(e);try{for(n.s();!(t=n.n()).done;){var a=t.value.material;if(LA(a)){switch(a.objectTransparency){case 1:case 0:return 1;case 2:if(a.opacity<1)return 1}r=2}}}catch(o){n.e(o)}finally{n.f()}return r}function LA(e){return e.size*e.color[3]*e.opacity>0}function zA(e,t,r,n){return r*(n/e)*2*Math.tan(.5*t)}function VA(e,t,r){return e.length-function(e,t){var r=Object(Fs.b)(e,t,!0);return-1===r?t<e[0]?0:e.length:r}(e,t*r.minimumEdgeLength)}function NA(e,t,r,n){for(var i=0;i<e.length;i++){var a=e[i].index,o=t[i],s=t[i+1];if(n)for(var c=o;c<s;c++){var l=n[c];r.set(l,a)}else for(var u=o;u<s;u++)r.set(u,a)}}var UA=j.a.getLogger("esri.views.3d.webgl-engine.lib.edgeRendering.EdgeView"),BA=function(e){Object(f.a)(r,e);var t=Object(p.a)(r);function r(e){var n;return Object(c.a)(this,r),(n=t.call(this,e)).updatingHandles=new fe.a,n.perObjectData=new Map,n.renderers=new Map,n.numberOfRenderedEdges=0,n.gpuMemoryUsage=0,n.workerAbort=Object(q.e)(),n.tmpModelPosition=Object(X.e)(),n.tmpCameraPosition=Object(X.e)(),n.localOrigins=new lA(new cA.a(e.renderSR)),n}return Object(l.a)(r,[{key:"initialize",value:function(){this.worker=new TA(this.schedule),this.componentColorManager=new DC(this.rctx,2);for(var e=dA.e.createBuffer(4),t=0;t<4;t++)e.sideness.set(t,0,0===t||3===t?0:1),e.sideness.set(t,1,0===t||1===t?0:1);this.verticesBufferObject=bu.a.createVertex(this.rctx,35044,e.buffer)}},{key:"destroy",value:function(){var e=this;this.destroyed||(this.perObjectData.forEach((function(t){return e._discardObjectEntry(t)})),this.perObjectData.clear(),this.strokesTexture=Object(I.f)(this.strokesTexture),this.componentColorManager=Object(I.e)(this.componentColorManager),this.workerAbort.abort(),this.worker.destroy(),this.verticesBufferObject=Object(I.f)(this.verticesBufferObject),this.renderers.clear(),this.updatingHandles.destroy())}},{key:"updating",get:function(){return this.updatingHandles.updating}},{key:"usedMemory",get:function(){return this.gpuMemoryUsage}},{key:"numberOfRenderedPrimitives",get:function(){return this.numberOfRenderedEdges}},{key:"shouldRender",value:function(){return this.renderers.size>0}},{key:"addComponentObject",value:function(){var e=Object(s.a)(o.a.mark((function e(t,r,n,i,a,s,c,l){var u,d;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.hasObject(t)){e.next=2;break}return e.abrupt("return");case 2:return d=new qA(new Promise((function(e){return u=e})),n),this.perObjectData.set(t,d),e.next=6,this.updatingHandles.addPromise(this.addComponentGeometry(r,d,i,a,s,c,l));case 6:this.setNeedsRender(),u();case 8:case"end":return e.stop()}}),e,this)})));return function(t,r,n,i,a,o,s,c){return e.apply(this,arguments)}}()},{key:"addOrUpdateObject3D",value:function(){var e=Object(s.a)(o.a.mark((function e(t,r,n,i){var a,s,c,l,u,d,h;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.destroyed){e.next=2;break}return e.abrupt("return",void UA.warn("Attempt to add an object to a destroyed instance"));case 2:if(a=this.perObjectData.get(t),c=new qA(new Promise((function(e){return s=e}))),this.perObjectData.set(t,c),l=new Array,n.mergeGeometries&&t.geometries.length>1&&GA(t))l.push(this.addObjectMergedGeometries(t,c,r,n,i));else for(u=0;u<t.geometries.length;u++)d=t.geometries[u],(h=t.geometryRecords[u]).material.supportsEdges&&l.push(this.addGeometry(t,c,d,h,r[0],n,i));return e.next=9,this.updatingHandles.addPromise(Promise.all(l));case 9:this._discardObjectEntry(a),this.setNeedsRender(),s();case 12:case"end":return e.stop()}}),e,this)})));return function(t,r,n,i){return e.apply(this,arguments)}}()},{key:"_discardObjectEntry",value:function(e){var t=this;e&&(e.renderables.length&&(e.renderables.forEach((function(e){return t.removeRenderable(e)})),this.setNeedsRender()),e.loaded=null)}},{key:"hasObject",value:function(e){return this.perObjectData.has(e)}},{key:"updateAllComponentOpacities",value:function(){var e=Object(s.a)(o.a.mark((function e(t,r){var n,i=this;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=r instanceof Array?function(e){return r[e]}:function(){return r},e.next=3,this.updatingHandles.addPromise(this.getObjectEntry(t));case 3:e.sent.renderables.forEach((function(e){for(var t=e.components.meta.length,r=0;r<t;r++){var a=n(r),o=e.components.meta[r],s=o.index;o.material.opacity=a,e.components.buffer.textureBuffer.setDataElement(s,1,3,255*a)}i.updateTransparency(e)})),this.setNeedsRender();case 5:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"updateAllComponentMaterials",value:function(){var e=Object(s.a)(o.a.mark((function e(t,r,n,i){var a,s,c,l,u=this;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t instanceof uA.a,s=!!n.slicePlaneEnabled,c=IA(r),l=gA.getKey(c,s,a),e.next=3,this.updatingHandles.addPromise(this.getObjectEntry(t));case 3:e.sent.renderables.forEach((function(e){if(l!==e.rendererKey){var t=u.renderers.get(e.rendererKey),n=u.acquireRenderer(c,s,a);t.removeRenderable(e),t.refCount.decrement(),e.rendererKey=l,n.addRenderable(e)}for(var o=0;o<r.length;o++)e.components.meta[o].material=r[o];i&&u.updateComponentBuffer(e.components),u.updateTransparency(e)})),this.setNeedsRender();case 5:case"end":return e.stop()}}),e,this)})));return function(t,r,n,i){return e.apply(this,arguments)}}()},{key:"updateObjectVisibility",value:function(){var e=Object(s.a)(o.a.mark((function e(t,r){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.updatingHandles.addPromise(this.getObjectEntry(t));case 2:e.sent.renderables.forEach((function(e){return e.visible=r})),this.setNeedsRender();case 4:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"removeObject",value:function(e){var t=this.perObjectData.get(e);t&&(this.perObjectData.delete(e),this._discardObjectEntry(t))}},{key:"getObjectEntry",value:function(){var e=Object(s.a)(o.a.mark((function e(t){var r;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=this.perObjectData.get(t)){e.next=3;break}throw"no object";case 3:return e.next=5,r.loaded;case 5:return e.abrupt("return",r);case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"removeAll",value:function(){var e=this;this.perObjectData.forEach((function(t,r){return e.removeObject(r)}))}},{key:"render",value:function(e,t){var r=this;if(!Object(I.i)(this.componentColorManager)){this.localOrigins.updateViewMatrices(e.camera.viewMatrix);var n=e.camera.viewInverseTransposeMatrix,i=Object(X.e)(),a=new MC,o=new hC.a.ViewProjectionTransform,s=Object(Cf.b)();Object(Yl.y)(i,n[3],n[7],n[11]),a.set(i),Object(Yl.m)(o.worldFromView_TH,a.high),Object(Yl.m)(o.worldFromView_TL,a.low),Object(Tf.f)(o.viewFromCameraRelative_RS,e.camera.viewMatrix),Object(Jl.d)(o.projFromView,e.camera.projectionMatrix);var c=Object(Cf.b)();Object(Tf.n)(c,o.viewFromCameraRelative_RS),Object(Tf.e)(s,c);var l=0,u=0;if(this.renderers.forEach((function(e){0===e.refCount.value?(r.renderers.delete(e.key),e.dispose()):e.forEachRenderable((function(e){l+=e.statistics.averageEdgeLength,u++}),t)})),this.componentColorManager.garbageCollect(),this.componentColorManager.updateTextures(),0!==u){var d={distanceFalloffFactor:40*l/u,minimumEdgeLength:zA(e.camera.fullViewport[3],e.camera.fovY,1,3.5*e.camera.pixelRatio),transparency:t,viewProjectionTransform:o,transformNormal_ViewFromGlobal:s};this.updateObjectCameraDistances(e),this.numberOfRenderedEdges=0,this.renderers.forEach((function(t){r.renderRegularEdges(t,e,d),r.renderSilhouetteEdges(t,e,d)}))}}}},{key:"updateTransparency",value:function(e){var t=DA(e.components.meta),r=FA(e.components.meta);t===e.edgeTransparency&&r===e.objectTransparency||(e.edgeTransparency=t,e.objectTransparency=r,this.renderers.get(e.rendererKey).setRenderablesDirty())}},{key:"computeModelTransformWithLocalOrigin",value:function(e,t,r){if(e.getCombinedStaticTransformation(t,r),Object(I.j)(t.origin))this.localOrigins.register(t.origin);else{var n=Object(Yl.y)(this.tmpModelPosition,r[12],r[13],r[14]);t.origin=this.localOrigins.acquire(n)}return function(e,t){var r=t,n=-e[0],i=-e[1],a=-e[2],o=r[3],s=r[7],c=r[11],l=r[15];r[0]+=o*n,r[1]+=o*i,r[2]+=o*a,r[4]+=s*n,r[5]+=s*i,r[6]+=s*a,r[8]+=c*n,r[9]+=c*i,r[10]+=c*a,r[12]+=l*n,r[13]+=l*i,r[14]+=l*a}(t.origin.vec3,r),t.origin}},{key:"updateComponentBuffer",value:function(e){for(var t=e.meta,r=e.buffer,n=0;n<t.length;n++){var i=t[n].material,a=t[n].index,o=Object(m.e)(Math.round(8*i.size),0,255),s=Object(m.e)(i.extensionLength,-128,127)+128,c="solid"===i.type?0:1,l=255*i.opacity,u=i.color,d=255*u[0],h=255*u[1],f=255*u[2],p=255*u[3];r.textureBuffer.setData(a,0,d,h,f,p),r.textureBuffer.setData(a,1,o,s,c,l)}}},{key:"createComponentBuffers",value:function(e){if(Object(I.i)(this.componentColorManager))return null;for(var t=new Array,r=this.componentColorManager.getBuffer(e.length),n=0;n<e.length;n++){var i=e[n],a=r.acquireIndex();t.push({index:a,material:i})}var o={meta:t,buffer:r};return this.updateComponentBuffer(o),o}},{key:"extractEdges",value:function(e,t,r,n,i){var a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:i.length;return this.worker.process({data:t,indices:i,indicesLength:a,writerSettings:e,skipDeduplicate:r},this.workerAbort.signal,n)}},{key:"createEdgeResources",value:function(e){var t={};if(Object(I.i)(this.verticesBufferObject))return t;if(e.regular.lodInfo.lengths.length>0){var r=new yu.a(this.rctx,dA.b,{vertices:dA.f,instances:hA.a.glLayout},{vertices:this.verticesBufferObject,instances:bu.a.createVertex(this.rctx,35044,e.regular.instancesData.buffer)});t.regular={vao:r,lod:e.regular.lodInfo}}if(e.silhouette.lodInfo.lengths.length>0){var n=new yu.a(this.rctx,dA.b,{vertices:dA.f,instances:hA.b.glLayout},{vertices:this.verticesBufferObject,instances:bu.a.createVertex(this.rctx,35044,e.silhouette.instancesData.buffer)});t.silhouette={vao:n,lod:e.silhouette.lodInfo}}return t}},{key:"addGeometry",value:function(){var e=Object(s.a)(o.a.mark((function e(t,r,n,i,a,s,c){var l,u,d,h;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return l=n.vertexAttributes.get("position"),u=n.indices.get("position"),d=Object(Kl.d)(),h={position:l,indices:u,modelTransform:d,origin:this.computeModelTransformWithLocalOrigin(t,i,d)},e.abrupt("return",this.addPositionData(r,h,n.edgeIndicesLength,a,s,c));case 2:case"end":return e.stop()}}),e,this)})));return function(t,r,n,i,a,o,s){return e.apply(this,arguments)}}()},{key:"addPositionData",value:function(){var e=Object(s.a)(o.a.mark((function e(t,r,n,i,a){var s,c,l,u,d,h,f,p,b,v,m,y,g,O,j,_,w=arguments;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s=w.length>5&&void 0!==w[5]&&w[5],null!=t.loaded){e.next=3;break}return e.abrupt("return");case 3:if(c=this.createComponentBuffers([i]),!(Object(I.i)(c)||n<=0)){e.next=6;break}return e.abrupt("return");case 6:for(l=this.acquireRenderer(i.type,!!a.slicePlaneEnabled),u=r.modelTransform,d=r.origin,h=r.indices,f=r.position,p=f.data.length/f.size,b=dA.a.createBuffer(p),v=0;v<p;v++)b.position.set(v,0,f.data[v*f.size+0]),b.position.set(v,1,f.data[v*f.size+1]),b.position.set(v,2,f.data[v*f.size+2]);return NA(c.meta,[0,b.componentIndex.count],b.componentIndex),e.next=11,this.updatingHandles.addPromise(this.extractEdges(l.writerSettings,b,!1,s,h,n));case 11:if(m=e.sent,null!=t.loaded){e.next=14;break}return e.abrupt("return");case 14:y=this.createEdgeResources(m),g=y.regular,O=y.silhouette,j=(g?g.vao.size:0)+(O?O.vao.size:0),_={regular:g,silhouette:O,transform:{modelMatrix:u,origin:d},statistics:{gpuMemoryUsage:j,averageEdgeLength:m.averageEdgeLength},components:c,visible:!0,edgeTransparency:DA(c.meta),objectTransparency:FA(c.meta),distanceToCamera:0,rendererKey:l.key},t.renderables.push(_),l.addRenderable(_),this.gpuMemoryUsage+=j;case 16:case"end":return e.stop()}}),e,this)})));return function(t,r,n,i,a){return e.apply(this,arguments)}}()},{key:"addComponentGeometry",value:function(){var e=Object(s.a)(o.a.mark((function e(t,r,n,i,a,s,c){var l,u,d,h,f,p,b,v,m,y,g;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=r.loaded){e.next=2;break}return e.abrupt("return");case 2:if(l=this.createComponentBuffers(s),!Object(I.i)(l)){e.next=5;break}return e.abrupt("return");case 5:return u=IA(s),d=this.acquireRenderer(u,c.slicePlaneEnabled||!1,!1),h=dA.a.createBuffer(n.count),Object(sA.a)(h.position,n),NA(l.meta,a,h.componentIndex,i),!0,f=d.writerSettings,e.next=11,this.updatingHandles.addPromise(this.extractEdges(f,h,true,!1,i));case 11:if(p=e.sent,null!=r.loaded){e.next=14;break}return e.abrupt("return");case 14:b=this.createEdgeResources(p),v=b.regular,m=b.silhouette,y=(v?v.vao.size:0)+(m?m.vao.size:0),g={regular:v,silhouette:m,transform:t,statistics:{gpuMemoryUsage:y,averageEdgeLength:p.averageEdgeLength},components:l,visible:!0,edgeTransparency:DA(l.meta),objectTransparency:FA(l.meta),distanceToCamera:0,rendererKey:d.key},r.renderables.push(g),d.addRenderable(g),this.gpuMemoryUsage+=y;case 16:case"end":return e.stop()}}),e,this)})));return function(t,r,n,i,a,o,s){return e.apply(this,arguments)}}()},{key:"addObjectMergedGeometries",value:function(){var e=Object(s.a)(o.a.mark((function e(t,r,n,i,a){var s,c,l,u,d,h,f,p,b,v,m,y,g,O,j,_,w,x,k,S,T,C,M;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:s=new Map,c=0,l=null,u=null,d=0;case 3:if(!(d<t.geometries.length)){e.next=13;break}if(h=t.geometries[d],(f=t.geometryRecords[d]).material.supportsEdges){e.next=7;break}return e.abrupt("continue",10);case 7:!u&&f.origin&&(u=f),p=h.indices.get("position"),c+=h.edgeIndicesLength,null!=l&&l!==Uint16Array||(l=Object(hT.i)(p)?Uint16Array:Uint32Array);case 10:d++,e.next=3;break;case 13:b=c?new l(c):null,v=[],m=0,y=0;case 16:if(!(y<t.geometries.length)){e.next=27;break}if(g=t.geometries[y],t.geometryRecords[y].material.supportsEdges){e.next=20;break}return e.abrupt("continue",24);case 20:if(O=g.vertexAttributes.get("position"),j=g.indices.get("position"),null==(_=s.get(O.data))){for(_=v.length/3,w=0;w<O.data.length;w+=O.size)v.push(O.data[w+0]),v.push(O.data[w+1]),v.push(O.data[w+2]);s.set(O.data,_)}if(j)for(x=0;x<g.edgeIndicesLength;x++)b[m++]=_+j[x];case 24:y++,e.next=16;break;case 27:for(k=u||t.geometryRecords[0],S=Object(Kl.d)(),T=this.computeModelTransformWithLocalOrigin(t,k,S),C=0;C<t.geometryRecords.length;C++)t.geometryRecords[C].origin=T;return M={position:{data:v,size:3},indices:b,modelTransform:S,origin:T},e.next=32,this.updatingHandles.addPromise(this.addPositionData(r,M,b.length,n[0],i,a));case 32:case"end":return e.stop()}}),e,this)})));return function(t,r,n,i,a){return e.apply(this,arguments)}}()},{key:"acquireRenderer",value:function(e,t){var r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n=gA.getKey(e,t,r),i=this.renderers.get(n);return Object(I.i)(this.strokesTexture)&&(this.strokesTexture=CA(this.rctx)),i||(i=new gA(this.rctx,this.techniqueRepository,{type:e,slicePlaneEnabled:t,strokesTexture:this.strokesTexture,legacy:r}),this.renderers.set(n,i)),i.refCount.increment(),i}},{key:"removeRenderable",value:function(e){!function(e){e.regular&&(e.regular.vao.vertexBuffers.instances.dispose(),e.regular.vao.dispose(!1),e.regular.vao=null),e.silhouette&&(e.silhouette.vao.vertexBuffers.instances.dispose(),e.silhouette.vao.dispose(!1),e.silhouette.vao=null)}(e);var t=this.renderers.get(e.rendererKey);if(t){t.removeRenderable(e),t.refCount.decrement(),"origin"in e.transform&&this.localOrigins.release(e.transform.origin),this.gpuMemoryUsage-=e.statistics.gpuMemoryUsage;var r,n=Object(i.a)(e.components.meta);try{for(n.s();!(r=n.n()).done;){var a=r.value;e.components.buffer.releaseIndex(a.index)}}catch(o){n.e(o)}finally{n.f()}}}},{key:"updateObjectCameraDistances",value:function(e){var t=this,r=e.camera.viewInverseTransposeMatrix;Object(Yl.y)(this.tmpCameraPosition,r[3],r[7],r[11]),this.perObjectData.forEach((function(e,r){var n=Object(I.j)(e.center)?e.center:Object(Nd.g)(r.boundingVolumeWorldSpace.bounds),i=Object(Yl.o)(n,t.tmpCameraPosition);e.renderables.forEach((function(e){return e.distanceToCamera=i}))}))}},{key:"renderRegularEdges",value:function(e,t,r){var n=this;e.bindRegularEdges(t,r);var i=r.transparency;e.forEachRenderable((function(i){if(i.visible&&i.regular){var a=VA(i.regular.lod.lengths,i.distanceToCamera,r);"origin"in i.transform&&(t.localViewMatrixForEdges=n.localOrigins.getViewMatrix(i.transform.origin)),e.renderRegularEdges(i,t,a),n.numberOfRenderedEdges+=a}}),i)}},{key:"renderSilhouetteEdges",value:function(e,t,r){var n=this;e.bindSilhouetteEdges(t,r);var i=r.transparency;e.forEachRenderable((function(i){if(i.visible&&i.silhouette){var a=VA(i.silhouette.lod.lengths,i.distanceToCamera,r);"origin"in i.transform&&(t.localViewMatrixForEdges=n.localOrigins.getViewMatrix(i.transform.origin)),e.renderSilhouetteEdges(i,t,a),n.numberOfRenderedEdges+=a}}),i)}}]),r}(de.a);function GA(e){for(var t=null,r=null,n=0;n<e.geometries.length;n++){var i,a=e.geometryRecords[n];if(a.material.supportsEdges){if(t){if(!Object(Fs.e)(t,a.transformation))return!1}else t=a.transformation;if(!r&&Object(I.j)(a.origin))r=a;else if(Object(I.j)(null==(i=r)?void 0:i.origin)&&Object(I.j)(a.origin)&&r.origin.id!==a.origin.id)return!1}}return!0}Object(b.a)([Object(y.b)({constructOnly:!0})],BA.prototype,"rctx",void 0),Object(b.a)([Object(y.b)({constructOnly:!0})],BA.prototype,"renderSR",void 0),Object(b.a)([Object(y.b)({constructOnly:!0})],BA.prototype,"techniqueRepository",void 0),Object(b.a)([Object(y.b)({constructOnly:!0})],BA.prototype,"setNeedsRender",void 0),Object(b.a)([Object(y.b)({constructOnly:!0})],BA.prototype,"schedule",void 0),Object(b.a)([Object(y.b)({readOnly:!0})],BA.prototype,"updatingHandles",void 0),Object(b.a)([Object(y.b)({readOnly:!0})],BA.prototype,"updating",null),BA=Object(b.a)([Object(w.a)("esri.views.3d.webgl-engine.lib.edgeRendering.EdgeView")],BA);var qA=function e(t){var r=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;Object(c.a)(this,e),this.center=n,this.renderables=new Array,this.loaded=t,this.loaded.then((function(){null!=r.loaded&&(r.loaded=!0)}))},HA=r(540),WA=r(539),QA=r(441),ZA=r(530),XA=function(){function e(t,r,n,i,a,o,s,l,u){var d=this;Object(c.a)(this,e),this._materialRep=t,this._shaderTechniqueRepository=n,this._rctx=i,this._compositingHelper=a,this._magnifierHelper=o,this.requestRender=s,this._stage=u,this._materialRenderers=new Map,this._hasHighlights=!1,this._hasOccludees=!1,this._hasWater=!1,this._hasOverlayWater=!1,this._content=new Map,this._isRendering=!1,this._fallbackDepthStencilTexture=null,this.performanceInfo=new QA.a,this._antialiasing=1,this._oitEnabled=!1,this._multipassTerrain=!0,this._opaqueTerrain=!0,this._lighting=new HA.a,this._handles=new oe.a,this.renderHiddenTransparentEdges=function(){},this._smaaPass=new KP(this._rctx,n),this._oitEnabled=this._hasOITSupport,this.requestRender(),this._offscreenRendering=new UM(this._rctx,this._compositingHelper),this._sliceHelper=new XP,this._shadowMap=new LP(this._rctx,u.viewingMode,2),this._ssaoHelper=new oA(n,this._rctx,(function(){return d.requestRender()})),this._highlightHelper=new DM(n,this._rctx),this._shadowHighlightHelper=new QP(this._rctx,u.viewingMode),this._shadowAccumulator=new zP(this._rctx,n,u,(function(e,t){d.renderPassManager.shadowCastingEnabled=!0,d._renderPlugins.prepareRender(e,t),d.renderPassManager.shadowCastingEnabled=d._shadowMap.enabled}),(function(e,t,r,n){e.start(r,t,n),d.renderShadowCascades(4,e),r.setGLViewport(d._rctx),d.ensureCameraBindParameters(r)}),(function(){return d.requestRender()})),this._bindParameters={slot:null,camera:null,inverseViewport:Object(ku.b)(),shadowMap:this._shadowMap,shadowMappingEnabled:this._shadowMap.enabled,ssaoHelper:this._ssaoHelper,ssaoEnabled:this._ssaoHelper.enabled,origin:null,screenToWorldRatio:null,screenToWorldRatioGlobalWM:null,slicePlane:this._sliceHelper.plane,highlightDepthTexture:null,hasOccludees:!1,linearDepthTexture:null,terrainLinearDepthTexture:null,geometryLinearDepthTexture:null,multipassTerrainEnabled:!1,multipassGeometryEnabled:!1,cullAboveGround:!1,lastFrameColorTexture:null,reprojectionMat:null,ssrEnabled:!1,lighting:this._lighting,highlightColorTexture:null},this._renderContext=new qM.b(this._rctx,this._offscreenRendering,this._lighting,this._shadowMap,this._ssaoHelper,this._sliceHelper),this._renderContext.multipassTerrainParams={camera:null,multipassTerrainEnabled:!1,cullAboveGround:!1,terrainLinearDepthTexture:null},this._renderContext.multipassGeometryParams={multipassGeometryEnabled:!1,geometryLinearDepthTexture:null},this._renderContext.ssrParams={camera:null,linearDepthTexture:null,lastFrameColorTexture:null,reprojectionMat:null,ssrEnabled:!1},this._renderPlugins=new WM({renderContext:this._renderContext,shaderTechniqueRep:n,textureRep:r,materialRep:this._materialRep,requestRender:this.requestRender,schedule:l}),this.renderPassManager=new TM(this._rctx,this._shaderTechniqueRepository),this._renderPlugins.add(this.renderPassManager.slots(),this.renderPassManager),this._handles.add([Object(W.a)(Vy.a,"EDGES_SHOW_HIDDEN_TRANSPARENT_EDGES",(function(e){d.renderHiddenTransparentEdges=e?function(){return d.renderEdges(1)}:function(){},d.requestRender()})),Object(W.a)(this._stage,"camera",(function(){return d.requestRender()}),!0)])}return Object(l.a)(e,[{key:"hasWater",get:function(){return this._hasWater||this._hasOverlayWater}},{key:"hasWaterReflection",get:function(){return this.hasWater&&this._waterReflectionEnabled}},{key:"dispose",value:function(){this._handles.destroy(),this._smaaPass.disable(),this._materialRenderers.forEach((function(e){return e.dispose()})),this._materialRenderers.clear(),this._edgeView=Object(I.e)(this._edgeView),this._offscreenRendering.dispose(),this._fallbackDepthStencilTexture=Object(I.f)(this._fallbackDepthStencilTexture),this._shadowMap.enabled=!1,this._shadowMap.dispose(),this._ssaoHelper.enabled=!1,this._ssaoHelper.dispose(),this._highlightHelper.dispose(),this._shadowHighlightHelper.dispose(),this._shadowAccumulator.dispose(),AM.a.prune(),this._content.clear()}},{key:"updating",get:function(){return 1===this._antialiasing&&this._smaaPass.isLoadingResources||Object(I.j)(this._edgeView)&&this._edgeView.updating||this._shadowAccumulator.running||!this.isCameraFinal}},{key:"ensureEdgeView",value:function(){var e=this;return Object(I.i)(this._edgeView)&&(this._edgeView=new BA({rctx:this._rctx,renderSR:this._stage.renderSR,techniqueRepository:this._shaderTechniqueRepository,setNeedsRender:function(){return e.requestRender()},schedule:function(t){return e._stage.resourceController.schedule(t)}}),this._handles.add(this._edgeView.watch("updating",(function(){return e.requestRender()}),!0)),this.requestRender()),this._edgeView}},{key:"edgeView",get:function(){return this._edgeView}},{key:"isCameraFinal",get:function(){return null===this._bindParameters.reprojectionMat||Object(Jl.f)(this._bindParameters.reprojectionMat,rE)}},{key:"hasShadowsEnabled",get:function(){var e;return!(null==(e=this._shadowMap)||!e.enabled)}},{key:"setRenderParameters",value:function(e){var t=this.renderPassManager,r=this._shadowMap,n=this._ssaoHelper;void 0!==e.screenSpaceReflectionsEnabled&&t.screenSpaceReflectionsEnabled!==e.screenSpaceReflectionsEnabled&&(t.screenSpaceReflectionsEnabled=e.screenSpaceReflectionsEnabled,this.requestRender()),void 0===e.shadowMap||r.enabled===e.shadowMap&&t.shadowCastingEnabled===e.shadowMap||(r.enabled=e.shadowMap,t.shadowCastingEnabled=e.shadowMap,this.requestRender()),void 0!==e.shadowMapMaxCascades&&r.maxCascades!==e.shadowMapMaxCascades&&(r.maxCascades=e.shadowMapMaxCascades,this.requestRender()),void 0!==e.ssao&&n.enabled!==e.ssao&&(n.enabled=e.ssao,this.requestRender()),void 0!==e.ssaoAttenuation&&n.attenuation!==e.ssaoAttenuation&&(n.attenuation=e.ssaoAttenuation,this.requestRender()),void 0!==e.ssaoRadius&&n.radius!==e.ssaoRadius&&(n.radius=e.ssaoRadius,this.requestRender()),void 0!==e.ssaoSamples&&n.samples!==e.ssaoSamples&&(n.samples=e.ssaoSamples,this.requestRender()),e.background&&this._offscreenRendering.background!==e.background&&(this._offscreenRendering.background=e.background,this.requestRender());var i=e.antialiasingEnabled?1:0;void 0!==e.antialiasingEnabled&&this._antialiasing!==i&&(this._antialiasing=i,this.requestRender()),void 0!==e.highQualityTransparency&&this._multipassTerrain!==e.highQualityTransparency&&(this._multipassTerrain=e.highQualityTransparency,this._oitEnabled=e.highQualityTransparency&&this._hasOITSupport,this.requestRender()),void 0!==e.defaultHighlightOptions&&(this._highlightHelper.setDefaultOptions(e.defaultHighlightOptions),this._shadowHighlightHelper.setDefaultOptions(e.defaultHighlightOptions),this.requestRender()),void 0!==e.slicePlane&&this._sliceHelper.plane!==e.slicePlane&&(this._sliceHelper.plane=Object(I.s)(e.slicePlane),this.requestRender());var a=this._rctx.parameters.maxTextureImageUnits>=10&&e.waterReflectionEnabled;void 0!==e.waterReflectionEnabled&&this._waterReflectionEnabled!==a&&(this._waterReflectionEnabled=a,this.requestRender()),void 0!==e.opaqueTerrain&&this._opaqueTerrain!==e.opaqueTerrain&&(this._opaqueTerrain=e.opaqueTerrain,this.requestRender()),void 0!==e.hasOverlayWater&&this._hasOverlayWater!==e.hasOverlayWater&&(this._hasOverlayWater=e.hasOverlayWater,this.requestRender()),void 0!==e.shadowAccumulationOptions&&this._shadowAccumulator.setOptions(e.shadowAccumulationOptions)}},{key:"hasSlicePlane",get:function(){return!!this._sliceHelper.plane}},{key:"renderPlugins",get:function(){return this._renderPlugins}},{key:"_hasOITSupport",get:function(){return this._rctx.capabilities.textureFloat&&this._rctx.capabilities.textureFloat.textureFloat&&this._rctx.capabilities.colorBufferFloat&&this._rctx.capabilities.colorBufferFloat.textureFloat}},{key:"modify",value:function(e){var t=this;this._isRendering&&console.warn("Renderer.modify called while rendering");var r=e.adds,n=e.removes,i=e.updates;if(0!==r.length||0!==n.length||0!==i.length){n.forAll((function(e){var r=e.id;return t._content.delete(r)})),r.forAll((function(e){return t._content.set(e.id,e)}));var a=Object(HM.a)(e),o=!1;a.forEach((function(e,r){var n=t._materialRenderers.get(r);if(!n){if(!(e.adds.length>0))return;n=new WA.a(t._rctx,t._materialRep,r),t._materialRenderers.set(r,n)}n.modify(e),n.isEmpty&&(o=!0)})),o&&this._materialRenderers.forEach((function(e,r){e.isEmpty&&(t._materialRenderers.delete(r),e.dispose())})),this._hasHighlights=Object(Qs.b)(this._materialRenderers,(function(e){return e.hasHighlights})),this._hasOccludees=Object(Qs.b)(this._materialRenderers,(function(e){return e.hasOccludees})),this._hasWater=Object(Qs.b)(this._materialRenderers,(function(e){return e.hasWater})),this.requestRender()}}},{key:"updateLogic",value:function(e){var t=!1;return this._materialRenderers.forEach((function(r){r.updateLogic&&(t=r.updateLogic(e)||t)})),t}},{key:"updateLightSources",value:function(e,t,r){this._lighting.groundLightingFactor=t,this._lighting.globalFactor=r,this._lighting.set(e)}},{key:"render",value:function(e,t,r,n){var i=this;this._isRendering=!0,this.performanceInfo.prerender(this._rctx),this._bindParameters.lighting=this._lighting,this._renderContext.hasOccludees=this._hasOccludees,this._renderContext.transparencyPassType=3,this._bindParameters.transparencyPassType=3;var a=this._offscreenRendering;a.needLastFrameColorTexture=this.hasWaterReflection,a.advanceCurrentRenderTarget();var o=this._sliceHelper.plane;n&&(this._sliceHelper.plane=null),this._rctx.bindFramebuffer(e),t.setGLViewport(this._rctx),this.needsShadowAccumulation&&(this.renderPassManager.shadowCastingEnabled=!0),this._renderPlugins.prepareRender(t,r),this.performanceInfo.advance(0);var s=this.computeDepthRange(t);this.renderShadowMap(e,t,this._lighting.lightingMainDirection,s),this.performanceInfo.advance(1),a.initializeFrame(t),this.ensureBindParameters(t),this.renderLinearDepth(),this.performanceInfo.advance(2),this.accumulateShadows(s,t,r),this.renderNormal(),this.performanceInfo.advance(3),this.ensureBindParametersSSR(),this._ssaoHelper.computeSSAO(t,a.linearDepthTexture,a.normalTexture),this.performanceInfo.advance(4),this.performanceInfo.stats.reset(),this._renderContext.pass=0,a.bindFramebuffer(),this.renderSlot(0),this.renderOpaqueGeometry(),this.performanceInfo.advance(5);var c=this._multipassTerrain&&!this._opaqueTerrain;this.renderTerrainLinearDepth(c),this.setMultipassFlags(c),this.setTerrainCulling(c),this.renderEdges(2),this.performanceInfo.advance(6),this.renderHiddenTransparentEdges(),this._oitEnabled?this.renderOrderIndependentTransparency((function(){return i.renderTransparentGeometry()}),!1):this.renderTransparentGeometry(),this.performanceInfo.advance(7),this.renderGeometryLinearDepth(c);var l={hudVisibility:!1,transparentTerrain:!1};l.hudVisibility=this.renderHUDVisibility(),c||this.renderInternalSlot(20),this.performanceInfo.advance(9),this.renderEdges(1,c),this.performanceInfo.advance(8),l.transparentTerrain=this.renderTransparentTerrain(),l.transparentTerrain&&l.hudVisibility&&(c?this.renderLineCallouts(0):a.compositeTransparentTerrainOntoHUDVisibility(),this.renderHUD(0,a.framebuffer),this.performanceInfo.advance(16)),this.performanceInfo.advance(10),this.setTerrainCulling(!1),l.transparentTerrain&&(a.compositeTransparentTerrainOntoMain(),c&&(this.renderEdges(2),this.performanceInfo.advance(6),this._oitEnabled?this.renderOrderIndependentTransparency((function(){return i.renderTransparentGeometry()}),!1):this.renderTransparentGeometry(),this.performanceInfo.advance(7),this.renderEdges(1),this.performanceInfo.advance(8))),c&&this.renderLineCallouts(1),this.setMultipassFlags(!1),this._shadowAccumulator.render(),a.renderToTargets((function(){i.renderInternalSlot(8),i.renderSlot(15),i.renderSlot(16)}),a.currentColorTarget,a.mainDepth),this.performanceInfo.advance(11),this._renderPlugins.needsLaserlineWithContrastControl&&a.renderTmpAndCompositeToMain((function(){i.renderSlot(17)}),2),this.performanceInfo.advance(12),this.renderOccluded(),this.performanceInfo.advance(13);var u=!n&&this._magnifierHelper.enabled,d=u&&Object(I.i)(e)?this._offscreenRendering.getFramebuffer(this._offscreenRendering.tmpColor,this._offscreenRendering.tmpDepth):e;this._rctx.bindFramebuffer(d),this.renderAntiAliasing(this._antialiasing,this._offscreenRendering.colorTexture)||this._compositingHelper.composite(this._offscreenRendering.colorTexture,0),this.performanceInfo.advance(14),this.renderHUD(1,d),this.performanceInfo.advance(17),this.renderHighlights(d,this._bindParameters),this.performanceInfo.advance(15),u&&this._magnifierHelper.render(this._rctx,this._bindParameters),d!==e&&(this._rctx.bindFramebuffer(e),this._compositingHelper.composite(this._offscreenRendering.tmpColorTexture,0)),this._renderContext.lastFrameCamera.copyFrom(this._renderContext.camera),this._sliceHelper.plane=o,this._isRendering=!1,this.onPostRender&&this.onPostRender(),this.performanceInfo.postrender()}},{key:"readDepthPixels",value:function(e,t,r,n,i,a){var o=this._offscreenRendering.bindTarget(this._offscreenRendering.linearDepth,this._offscreenRendering.tmpDepth);if(!this._needsLinearDepth){this.ensureBindParameters(e),this._renderContext.camera.setGLViewport(this._rctx),this._rctx.setClearColor(0,0,0,0);this._rctx.clearSafe(17664),this.renderGeometryAndTransparentTerrainPass(2)}o.readPixels(t,r,n,i,6408,5121,a)}},{key:"readAccumulatedShadow",value:function(e,t){return this._shadowAccumulator.readAccumulatedShadow(e,t)}},{key:"setMultipassFlags",value:function(e){this._renderContext.multipassTerrainParams.multipassTerrainEnabled=this._bindParameters.multipassTerrainEnabled=e,this._renderContext.multipassGeometryParams.multipassGeometryEnabled=this._bindParameters.multipassGeometryEnabled=e}},{key:"setTerrainCulling",value:function(e){this._renderContext.multipassTerrainParams.cullAboveGround=this._bindParameters.cullAboveGround=e}},{key:"renderSlot",value:function(e){return this._renderContext.slot=e,this._renderPlugins.render()}},{key:"renderEdges",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this._edgeView;Object(I.j)(n)&&n.shouldRender()&&this._offscreenRendering.renderTmpAndCompositeToMain((function(){return n.render(t._bindParameters,e)}),1,r)}},{key:"renderShadowMap",value:function(e,t,r,n){var i=this,a=this._shadowMap;if(a.enabled){if(Vy.a.ENABLE_PROFILE_DEPTH_RANGE&&jM.begin("depthRange"),Vy.a.ENABLE_PROFILE_DEPTH_RANGE&&jM.end("depthRange"),a.start(t,r,n),this.needsShadowHighlight){var o=this._shadowHighlightHelper;this.renderShadowCascades(7,this._shadowMap,(function(e){return a.takeCascadeSnapshotTo(e,o.highlightShadowMapSlot)})),a.clear(),this.renderShadowCascades(6,this._shadowMap,(function(e){a.takeCascadeSnapshotTo(e,o.defaultSnapshotSlot),i.renderGeometryAndTransparentTerrainPass(7)}))}else this.renderShadowCascades(4);a.finish(e),t.setGLViewport(this._rctx)}}},{key:"renderShadowCascades",value:function(e){var t,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this._shadowMap,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(e){},a=Object(i.a)(r.getCascades());try{for(a.s();!(t=a.n()).done;){var o=t.value;o.camera.setGLViewport(this._rctx),this.ensureCameraBindParameters(o.camera),this.renderGeometryAndTransparentTerrainPass(e),n(o)}}catch(s){a.e(s)}finally{a.f()}}},{key:"_needsLinearDepth",get:function(){return this._ssaoHelper.enabled||this._renderPlugins.needsLinearDepth||this._hasWater&&this._waterReflectionEnabled||this.needsShadowHighlight||this.needsShadowAccumulation}},{key:"renderLinearDepth",value:function(){var e=this;this._needsLinearDepth?this._offscreenRendering.renderToTargets((function(){return e.renderGeometryAndTransparentTerrainPass(2)}),this._offscreenRendering.linearDepth,this._offscreenRendering.tmpDepth,[0,0,0,0],!0,!0):this._offscreenRendering.disposeTarget(this._offscreenRendering.linearDepth),this._renderContext.ssrParams.linearDepthTexture=this._bindParameters.linearDepthTexture=this._offscreenRendering.linearDepthTexture}},{key:"renderTerrainLinearDepth",value:function(e){var t=this;if(e){var r=this._renderContext.pass;this._renderContext.pass=2,this._offscreenRendering.renderToTargets((function(){return t.renderTransparentTerrain()}),this._offscreenRendering.terrainLinearDepth,this._offscreenRendering.tmpDepth,[-1e10,-1e10,-1e10,1],!0,!0),this._renderContext.pass=r}else this._offscreenRendering.disposeTarget(this._offscreenRendering.terrainLinearDepth);this._renderContext.multipassTerrainParams.terrainLinearDepthTexture=this._bindParameters.terrainLinearDepthTexture=this._offscreenRendering.terrainLinearDepthTexture}},{key:"renderGeometryLinearDepth",value:function(e){var t=this;if(e){var r=this._renderContext.pass;this._offscreenRendering.renderToTargets((function(){return t.renderGeometryPass(2)}),this._offscreenRendering.geometryLinearDepth,this._offscreenRendering.tmpDepth,[1,1,1,1],!0,!0),this._renderContext.pass=r}else this._offscreenRendering.disposeTarget(this._offscreenRendering.geometryLinearDepth);this._renderContext.multipassGeometryParams.geometryLinearDepthTexture=this._bindParameters.geometryLinearDepthTexture=this._offscreenRendering.geometryLinearDepthTexture}},{key:"needsNormal",get:function(){return this._ssaoHelper.enabled}},{key:"renderNormal",value:function(){var e=this;this.needsNormal?this._offscreenRendering.renderToTargets((function(){e.renderGeometryAndTransparentTerrainPass(3)}),this._offscreenRendering.normal,this._offscreenRendering.tmpDepth,[0,0,0,0],!0,!0):this._offscreenRendering.disposeTarget(this._offscreenRendering.normal)}},{key:"needsDepthRange",get:function(){return this._shadowMap.enabled||this.needsShadowAccumulation}},{key:"computeDepthRange",value:function(e){if(!this.needsDepthRange)return UT;var t=$C(e,this._content,this._stage.layers);return VT(t,this.renderPlugins.queryDepthRange(e)),t.near=Math.max(e.near,t.near),t.far=Math.min(e.far,t.far),t}},{key:"renderGeometryAndTransparentTerrainPass",value:function(e){this._renderContext.pass=e,this.renderGeometryPass(e),this.renderTransparentTerrain()}},{key:"renderGeometryPass",value:function(e){this._renderContext.pass=e,this.renderOpaqueGeometry(),this.renderTransparentGeometry()}},{key:"renderOpaqueGeometry",value:function(){this.renderSlot(1),this.renderSlot(2),this.renderInternalSlot(3),this.renderSlot(4),this.renderSlot(14)}},{key:"renderTransparentGeometry",value:function(){this.renderInternalSlot(5),this.renderSlot(6)}},{key:"renderTransparentTerrain",value:function(){return this.renderSlot(7)}},{key:"renderHUDVisibility",value:function(){var e=this,t=!1;return this._renderContext.offscreenRenderingHelper&&this._renderContext.offscreenRenderingHelper.renderHUDVisibility((function(){e._bindParameters.hudVisibilityTexture=e._renderContext.offscreenRenderingHelper?e._renderContext.offscreenRenderingHelper.hudVisibilityTexture:null,t=e.renderInternalSlot(12)}),this._multipassTerrain&&!this._opaqueTerrain),t}},{key:"renderLineCallouts",value:function(e){var t=this;this._bindParameters.renderTransparentlyOccludedHUD=e,0===e?this._offscreenRendering.renderToTargets((function(){return t.renderInternalSlot(20)}),this._offscreenRendering.currentColorTarget,this._offscreenRendering.tmpDepth,void 0,!0,!0):this.renderInternalSlot(20)}},{key:"renderHUD",value:function(e,t){var r=this;this._oitEnabled?(this.renderOrderIndependentTransparency((function(){return r.renderHUDElements(e)}),!0),this._rctx.bindFramebuffer(t),this._compositingHelper.composite(this._offscreenRendering.hudColorTexture,2)):0===e?this._offscreenRendering.renderToTargets((function(){return r.renderHUDElements(0)}),this._offscreenRendering.currentColorTarget,this._offscreenRendering.tmpDepth,void 0,!0,!0):this.renderHUDElements(e)}},{key:"renderHUDElements",value:function(e){this._bindParameters.renderTransparentlyOccludedHUD=e,this.renderInternalSlot(21),this.renderInternalSlot(18),this.renderInternalSlot(19)}},{key:"needsHighlight",get:function(){return this._hasHighlights||this._renderPlugins.needsHighlight}},{key:"needsShadowHighlight",get:function(){return this._shadowMap.enabled&&this._shadowHighlightHelper.isVisible&&this.needsHighlight}},{key:"renderHighlights",value:function(e,t){var r=this;if(this.needsHighlight){var n=this._highlightHelper,i=n.profilingCallback&&Object(ZA.a)(this._renderContext.rctx);this._renderContext.highlightDepthTexture=t.highlightDepthTexture;var a=this._offscreenRendering.renderToTargets((function(){r.renderGeometryAndTransparentTerrainPass(5),r._rctx.clearSafe(256),r.renderHUDElements(2)}),this._offscreenRendering.highlight,this._offscreenRendering.tmpDepth,[0,0,0,0],!0,!0);this._bindParameters.highlightColorTexture=a.colorTexture,this.needsShadowHighlight&&this._shadowHighlightHelper.render(t,e),n.render(this._renderContext.camera,a,e),Object(I.j)(i)&&n.profilingCallback&&i.stop((function(e){n.profilingCallback&&n.profilingCallback(e)}))}else this._offscreenRendering.disposeTarget(this._offscreenRendering.highlight)}},{key:"needsShadowAccumulation",get:function(){return this._shadowAccumulator.isAccumulating}},{key:"accumulateShadows",value:function(e,t,r){this.needsShadowAccumulation&&(this._shadowAccumulator.setAccumulationDependencies(this._offscreenRendering.linearDepthTexture,e,t,r),this._shadowAccumulator.accumulateFixedSamples(),this.renderPassManager.shadowCastingEnabled=this._shadowMap.enabled)}},{key:"renderOrderIndependentTransparency",value:function(e,t){var r=this,n=function(n){r._renderContext.transparencyPassType=n,r._bindParameters.transparencyPassType=r._renderContext.transparencyPassType,r._offscreenRendering.renderOITPass((function(){return e()}),n,t)},i=this._renderContext.pass;this._renderContext.pass=1,n(1),this._renderContext.pass=0,n(0),n(2),this._offscreenRendering.compositeTransparentOntoOpaque(t),this._renderContext.transparencyPassType=3,this._bindParameters.transparencyPassType=this._renderContext.transparencyPassType,this._renderContext.pass=i}},{key:"renderOccluded",value:function(){var e=this,t=0;this._materialRenderers.forEach((function(e,r){r&&r.isVisible()&&8===r.renderOccluded&&(t|=r.renderOccluded,$A.push(r))}));var r=this._offscreenRendering,n=function(e,n,i,a,o){0!=(t&n)&&(r.renderToTargets(i,r.tmpColor,r.mainDepth,[0,0,0,0],a,o),r.compositeOccludedOntoMain(e))};0!==$A.length&&(this.renderInternalSlot(10,$A),n(.5,8,(function(){return e.renderInternalSlot(11,$A)}),!1,!1),$A.length=0),this._materialRenderers.forEach((function(e,r){r&&r.isVisible()&&(4===r.renderOccluded||2===r.renderOccluded||16===r.renderOccluded)&&(t|=r.renderOccluded,YA.push(r))}));var i=this._renderPlugins.renderOccludedFlags;if(t|=i){var a=function(t){e._renderContext.renderOccludedMask=t,i>1&&e.renderSlot(9),e.renderInternalSlot(3,YA),e.renderInternalSlot(5,YA),e.renderInternalSlot(8,YA),e._renderContext.resetRenderOccludedMask()};this._renderContext.pass=0,n(.5,4,(function(){return a(4)}),!0,2),n(.5,2,(function(){return a(2)}),!0,2),n(1,16,(function(){return a(16)}),!0,2),YA.length=0}}},{key:"renderAntiAliasing",value:function(e,t){var r=this;if(1===e){if(this._smaaPass.loadResources((function(){return r.requestRender()})),this._smaaPass.enable())return this._smaaPass.render({colorTexture:t}),!0}else this._smaaPass.disable();return!1}},{key:"ensureCameraBindParameters",value:function(e){this._renderContext.camera=e,this._bindParameters.camera=this._renderContext.camera,this._bindParameters.inverseViewport[0]=1/this._renderContext.camera.fullViewport[2],this._bindParameters.inverseViewport[1]=1/this._renderContext.camera.fullViewport[3]}},{key:"ensureBindParameters",value:function(e){var t;this.ensureCameraBindParameters(e);var r=this._renderContext.offscreenRenderingHelper;this._bindParameters.shadowMap=this._renderContext.shadowMap,this._bindParameters.shadowMappingEnabled=this._renderContext.shadowMap.enabled,this._bindParameters.ssaoHelper=this._renderContext.ssaoHelper,this._bindParameters.ssaoEnabled=this._renderContext.ssaoHelper.enabled,this._bindParameters.slicePlane=this._renderContext.sliceHelper.plane,this._bindParameters.hasOccludees=this._renderContext.hasOccludees,this._renderContext.multipassTerrainParams.camera=this._renderContext.camera,this._bindParameters.hudVisibilityTexture=r.hudVisibilityTexture,this._bindParameters.highlightDepthTexture=null!=(t=r.depthTexture)?t:this.getFallbackDepthTexture()}},{key:"ensureBindParametersSSR",value:function(){this.hasWaterReflection?(this._renderContext.lastFrameCamera.equals(this._renderContext.camera)?this._renderContext.ssrParams.reprojectionMat=this._bindParameters.reprojectionMat=rE:(Object(Jl.t)(JA,this._renderContext.lastFrameCamera.viewMatrix,this._bindParameters.origin?this._bindParameters.origin:[0,0,0]),Object(Jl.t)(eE,this._renderContext.camera.viewMatrix,this._bindParameters.origin?this._bindParameters.origin:[0,0,0]),Object(Jl.a)(eE,eE),Object(Jl.a)(KA,this._renderContext.camera.projectionMatrix),Object(Jl.m)(tE,eE,KA),Object(Jl.m)(tE,JA,tE),Object(Jl.m)(tE,this._renderContext.lastFrameCamera.projectionMatrix,tE),this._renderContext.ssrParams.reprojectionMat=this._bindParameters.reprojectionMat=tE),this._renderContext.ssrParams.camera=this._renderContext.camera,this._renderContext.ssrParams.lastFrameColorTexture=this._bindParameters.lastFrameColorTexture=this._offscreenRendering.lastFrameColorTexture):this._renderContext.ssrParams.lastFrameColorTexture=this._bindParameters.lastFrameColorTexture=null,this._renderContext.ssrParams.ssrEnabled=this._bindParameters.ssrEnabled=this.hasWaterReflection}},{key:"renderInternalSlot",value:function(e,t){var r=this,n=0===this._renderContext.pass?this.performanceInfo.stats:null,i=!1;return this._bindParameters.slot=e,Object(I.j)(t)?t.forEach((function(t){if(Object(FM.c)(t,r._renderContext)){var n=r._materialRenderers.get(t);Object(I.j)(n)&&(i=n.render(e,r._renderContext.pass,r._bindParameters)||i)}})):this._materialRenderers.forEach((function(t,a){Object(FM.c)(a,r._renderContext)&&(i=t.render(e,r._renderContext.pass,r._bindParameters,n)||i)})),i}},{key:"getFallbackDepthTexture",value:function(){return this._fallbackDepthStencilTexture||(this._fallbackDepthStencilTexture=Object(Gu.b)(this._rctx)),this._fallbackDepthStencilTexture}},{key:"getGpuMemoryUsage",value:function(){return{offscreen:this._offscreenRendering?this._offscreenRendering.getGpuMemoryUsage():0,highlights:(this._highlightHelper?this._highlightHelper.getGpuMemoryUsage():0)+(this._shadowHighlightHelper?this._shadowHighlightHelper.getGpuMemoryUsage():0),shadows:this._shadowMap?this._shadowMap.getGpuMemoryUsage():0,ssao:this._ssaoHelper?this._ssaoHelper.gpuMemoryUsage:0}}},{key:"test",get:function(){var e=this;return{antialiasing:this._antialiasing,offscreen:this._offscreenRendering,shadowMap:this._shadowMap,ssao:this._ssaoHelper,highlight:this._highlightHelper,lighting:this._lighting,materialRenderers:this._materialRenderers,oitEnabled:this._oitEnabled,shadowHighlights:this._shadowHighlightHelper,getFramebufferTexture:function(t){var r;switch(t){case 0:return e._offscreenRendering.colorTexture;case 1:return e._offscreenRendering.linearDepthTexture;case 2:return e._offscreenRendering.normalTexture;case 3:return null==(r=e._shadowMap)?void 0:r.test.depthTexture;case 4:return e._offscreenRendering.hudVisibilityTexture;case 5:return e._offscreenRendering.highlightTexture}}}}}]),e}(),YA=[],$A=[],JA=Object(Kl.d)(),KA=Object(Kl.d)(),eE=Object(Kl.d)(),tE=Object(Kl.d)(),rE=Object(Kl.d)(),nE=XA,iE=r(408),aE=j.a.getLogger("esri.views.3d.webgl-engine.lib.TextureRepository"),oE=function(){function e(t,r,n){Object(c.a)(this,e),this._stage=t,this._rctx=n,this._idToRefCountedTexture=new Map,this._loadingCount=0,this._frameUpdates=new Map,this._fallbackTextureData=new Uint8Array(256),this._fallbackTextureTransparentData=new Uint8Array(256),this.events=new Ii.a,this._textureTechnique=r.acquire(iE.a,new iE.b);for(var i=0;i<this._fallbackTextureData.length;++i)this._fallbackTextureData[i]=255,this._fallbackTextureTransparentData[i]=(i+1)%4!=0?255:0;this._fallbackTextureDesc={target:3553,pixelFormat:6408,dataType:5121,samplingMode:9728,width:8,height:8,maxAnisotropy:this._rctx.parameters.maxMaxAnisotropy},this._frameTask=t.resourceController.scheduler.registerTask(Og.b.TEXTURE_UNLOAD)}return Object(l.a)(e,[{key:"dispose",value:function(){this._frameTask.remove(),Object(I.j)(this._fallbackTexture)&&(this._fallbackTexture.dispose(),this._fallbackTexture=null),Object(I.j)(this._fallbackTextureTransparent)&&(this._fallbackTextureTransparent.dispose(),this._fallbackTextureTransparent=null),this._stage.forEachOfType(4,(function(e){return e.unload()}))}},{key:"updating",get:function(){return this.loadingCount>0||this._frameTask.updating}},{key:"acquire",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2?arguments[2]:void 0,n=this._getOrCreateRef(e,t,r);return n.ref(),n}},{key:"update",value:function(){var e=this,t=!1;this._frameUpdates.forEach((function(r){var n=r.texture.frameUpdate(e._rctx,e._textureTechnique,r.previousToken);n>=0&&n!==r.previousToken&&(r.previousToken=n,t=!0)})),t&&this.events.emit("changed",0)}},{key:"_getOrCreateRef",value:function(e,t,r){return this._idToRefCountedTexture.get(e)||this._createNewRef(e,t,r)}},{key:"_createNewRef",value:function(e,t,r){var n=this,i=this._stage.getObject(e);Object(qu.a)(void 0!==i);var a=i.events.on("unloaded",(function(){a.remove(),n._onTextureUnloaded(e)})),o=new sE;this._idToRefCountedTexture.set(e,o);var s=i.load(this._rctx,this._textureTechnique);this._loadingCount++;var c=function(t){return n._loadingCount--,n._updateGLTexture(o,t),r&&r(o),i.requiresFrameUpdates&&n._frameUpdates.set(e,{texture:i,previousToken:-1}),o};return Object(q.q)(s)?(this._updateGLTexture(o,t?this.fallbackTextureTransparent:this.fallbackTexture),s.then(c,(function(e){n._loadingCount--,Object(q.n)(e)||aE.error(e)}))):c(s),o}},{key:"_updateGLTexture",value:function(e,t){e.glTexture=t,this.events.emit("changed",1)}},{key:"release",value:function(e){var t=this._idToRefCountedTexture.get(e);if(t&&(t.unref(),t.isUnreferenced)){var r=this._stage.getObject(e);this._frameTask.schedule((function(){t.isUnreferenced&&r.unload()}))}}},{key:"getTexture",value:function(e){return this._stage.getObject(e)}},{key:"loadingCount",get:function(){return this._loadingCount}},{key:"_onTextureUnloaded",value:function(e){this._idToRefCountedTexture.delete(e),this._frameUpdates.delete(e)}},{key:"fallbackTexture",get:function(){return Object(I.i)(this._fallbackTexture)&&(this._fallbackTexture=new vu.a(this._rctx,this._fallbackTextureDesc,this._fallbackTextureData)),this._fallbackTexture}},{key:"fallbackTextureTransparent",get:function(){return Object(I.i)(this._fallbackTextureTransparent)&&(this._fallbackTextureTransparent=new vu.a(this._rctx,this._fallbackTextureDesc,this._fallbackTextureTransparentData)),this._fallbackTextureTransparent}}]),e}(),sE=function(){function e(){Object(c.a)(this,e),this._refCount=0,this.glTexture=null}return Object(l.a)(e,[{key:"isUnreferenced",get:function(){return 0===this._refCount}},{key:"ref",value:function(){++this._refCount}},{key:"unref",value:function(){0!==this._refCount?--this._refCount:aE.error("Cannot dereference texture that has no references!")}}]),e}(),cE=r(531),lE=j.a.getLogger("esri.views.3d.webgl-engine.materials.internal.waterMaterialUtils"),uE=function(e){Object(f.a)(r,e);var t=Object(p.a)(r);function r(){var e;return Object(c.a)(this,r),(e=t.apply(this,arguments))._data=new Array,e.loadingState=0,e}return Object(l.a)(r,[{key:"dispose",value:function(){this.loadingState=0,this._data.forEach((function(e){return e.dispose()})),this._data.length=0}},{key:"updating",get:function(){return 1===this.loadingState}},{key:"ready",get:function(){return 2===this.loadingState}},{key:"loadTextures",value:function(e){var t=this,r=[Object(_t.b)("esri/images/materials/water/normals.jpg"),Object(_t.b)("esri/images/materials/water/perturbation.jpg")];this.loadingState=1,Promise.all(r.map((function(e){return Object(eu.a)(e)}))).then((function(r){r.forEach((function(r){return t._data.push(new vu.a(e,{target:3553,pixelFormat:6408,dataType:5121,wrapMode:10497,samplingMode:9987,hasMipmap:!0,maxAnisotropy:8,width:r.width,height:r.height},r))})),t.loadingState=2})).catch((function(e){lE.error("Failed to load textures for water material.",e),t.loadingState=0}))}},{key:"bind",value:function(e){this._data.length>=2&&(e.bindTexture(this._data[0],"texWaveNormal"),e.bindTexture(this._data[1],"texWavePerturbation"))}}]),r}(de.a);Object(b.a)([Object(y.b)()],uE.prototype,"loadingState",void 0),Object(b.a)([Object(y.b)({type:Boolean,readOnly:!0})],uE.prototype,"updating",null),uE=Object(b.a)([Object(w.a)("esri.views.3d.webgl-engine.materials.internal.WaterTextureRepository")],uE);var dE,hE=r(270),fE=function(e){Object(f.a)(r,e);var t=Object(p.a)(r);function r(e,n,i){var a,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,s=arguments.length>4?arguments[4]:void 0,l=!(arguments.length>5&&void 0!==arguments[5])||arguments[5];return Object(c.a)(this,r),(a=t.call(this))._rctx=e,a._renderScene=n,a._requestRenderScene=i,a._renderOverlay=o,a.forceCameraHook=s,a.supersample=l,a._screenshotQueue=[],a}return Object(l.a)(r,[{key:"dispose",value:function(){this._rctx=null}},{key:"takeScreenshot",value:function(e){this._requestRenderScene();var t=Object(q.h)();return this._screenshotQueue.push({settings:e,resolver:t}),t.promise}},{key:"update",value:function(e){if(0!==this._screenshotQueue.length){var t,r=Object(i.a)(this._screenshotQueue);try{for(r.s();!(t=r.n()).done;){var n=t.value;if(this.isDisposed)n.resolver.reject();else{var a=Object(ie.a)(Object(ie.a)({},n.settings),{},{pixelRatio:n.settings.pixelRatio*e.viewCamera.pixelRatio}),o=this._ensureScreenshotEncodeCanvas(),s=this._renderScreenshot(e,a),c=Object(hE.b)(s,a,o,{flipY:!0,premultipliedAlpha:!0});n.resolver(c)}}}catch(l){r.e(l)}finally{r.f()}this._screenshotQueue=[]}}},{key:"_renderScreenshotOverlay",value:function(e,t,r){if(Object(I.i)(this._renderOverlay))return t;e.width=t.width,e.height=t.height;var n=e.getContext("2d"),i=r.pixelRatio;return n.save(),n.translate(0,t.height),n.scale(1,-1),r.region&&n.translate(-r.region.x,-r.region.y),n.scale(i,i),t=this._renderOverlay(e,t),n.restore(),t}},{key:"_readbackScreenshot",value:function(e){return e.resample?this._readbackScreenshotResampled(e):this._readbackScreenshotImmediate(e)}},{key:"_readbackScreenshotResampled",value:function(e){var t=e.framebufferWidth,r=e.framebufferHeight,n=e.region,i=e.resample,a=this._ensureScreenshotEncodeCanvas(),o=Object(hE.a)(t,r,a);this._rctx.gl.readPixels(0,0,t,r,6408,5121,new Uint8Array(o.data.buffer)),o=this._renderScreenshotOverlay(a,o,Object(ie.a)(Object(ie.a)({},e),{},{region:null}));var s=Object(hE.a)(n.width,n.height,a);return Object(hE.c)(o,s,!0,i.region.x,r-(i.region.y+i.region.height),i.region.width,i.region.height)}},{key:"_readbackScreenshotImmediate",value:function(e){var t=e.framebufferHeight,r=e.region,n=this._ensureScreenshotEncodeCanvas(),i=Object(hE.a)(r.width,r.height,n);return this._rctx.gl.readPixels(r.x,t-(r.y+r.height),r.width,r.height,6408,5121,new Uint8Array(i.data.buffer)),this._renderScreenshotOverlay(n,i,e)}},{key:"_renderScreenshot",value:function(e,t){var r=null,n=e.viewCamera,i=t.framebufferWidth,a=t.framebufferHeight,o=!1,s=t.disableDecorations&&e.frameHasDecorations,c=i!==n.fullWidth||a!==n.fullHeight,l=t.ignorePadding&&n.pixelRatio!==t.pixelRatio,u=c||s||l;if(u){var d=n.clone();if(t.ignorePadding){for(var h=Object($l.f)(d.padding),f=0;f<4;f++)h[f]=Math.round(h[f]/d.pixelRatio*t.pixelRatio);d.padding=h}d.fullWidth=i,d.fullHeight=a,d.pixelRatio=t.pixelRatio;var p=n.fovX-d.fovX,b=n.fovY-d.fovY;p<0&&p<b?d.fovX=n.fovX:b<0&&b<p&&(d.fovY=n.fovY),this.forceCameraHook(d),o=!0,r=new Sk.a(this._rctx,{width:d.fullWidth,height:d.fullHeight,colorTarget:0,depthStencilTarget:3}),this._renderScene(r,d,t.disableDecorations)}var v=this._readbackScreenshot(t);if(u&&!this._rctx.contextAttributes.alpha)for(var m=3;m<v.data.length;m+=4)v.data[m]=255;return r&&r.dispose(),this._rctx.bindFramebuffer(null),o&&this.forceCameraHook(n),v}},{key:"_ensureScreenshotEncodeCanvas",value:function(){return this._screenshotEncodeCanvas||(this._screenshotEncodeCanvas=document.createElement("canvas")),this._screenshotEncodeCanvas}}]),r}(tT.a),pE=r(411),bE=j.a.getLogger("esri.views.3d.webgl-engine.parts.View"),vE=function(e){Object(f.a)(r,e);var t=Object(p.a)(r);function r(e){var n;return Object(c.a)(this,r),(n=t.call(this,{})).events=new Ii.a,n.waterTextureRepository=new uE,n._magnifierHelper=new gM,n._componentObjectCollection=null,n._needsUpdate=!0,n._needsRender=!0,n._idleSuspend=!0,n._needsWaterReflectionUpdate=!1,n._logicUpdateLast=0,n._container=e.container,n._initializeContext(e.options),Object(W.a)(n.waterTextureRepository,"loadingState",(function(){return n.setNeedsRender()})),n._magnifierHelper.events.on("request-render",(function(){return n.setNeedsRender()})),n._stippleTextureRepository=new cE.a(n._rctx),n._shaderTechniqueRepository=new GC.a({rctx:n._rctx,viewingMode:e.viewingMode,stippleTextureRepository:n._stippleTextureRepository,waterTextureRepository:n.waterTextureRepository}),n._textureRepository=new oE(e,n._shaderTechniqueRepository,n._rctx),n._textureRepository.events.on("changed",(function(e){return n.setNeedsRender(e)})),n._materialRepository=new fM.a(n._textureRepository,n._shaderTechniqueRepository,(function(){return n.setNeedsRender()})),n._compositingHelper=new XC(n._rctx,n._shaderTechniqueRepository),n._renderer=new nE(n._materialRepository,n._textureRepository,n._shaderTechniqueRepository,n._rctx,n._compositingHelper,n._magnifierHelper,(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return n.setNeedsRender(e)}),(function(t,r){return e.schedule(t,r)}),e),n._screenshotManager=new fE(n._rctx,(function(e,t,r){return n._renderer.render(e,t,t,r)}),(function(){return n.setNeedsRender()}),e.options.screenshot.renderOverlay,(function(e){return n.events.emit("force-camera-for-screenshot",e)})),n._registerFrameTask(e),n}return Object(l.a)(r,[{key:"normalizeCtorArgs",value:function(){return{}}},{key:"dispose",value:function(){this._container.contains(this._canvas)&&this._container.removeChild(this._canvas),this._frameTask&&(this._frameTask.remove(),this._frameTask=null),this._shaderTechniqueRepository.dispose(),this._shaderTechniqueRepository=null,Object(uw.a)(this._rctx),Object(d.a)(Object(h.a)(r.prototype),"dispose",this).call(this),this._tmpDepthBuffer=null,this._rctx=null}},{key:"performanceInfo",get:function(){var e=this._rctx.gl;return{renderer:this._renderer.performanceInfo,textureMemory:void 0!==e.getUsedTextureMemory?e.getUsedTextureMemory():void 0,renderbufferMemory:void 0!==e.getUsedRenderbufferMemory?e.getUsedRenderbufferMemory():void 0,VBOMemory:void 0!==e.getUsedVBOMemory?e.getUsedVBOMemory():void 0}}},{key:"setNeedsRender",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;1===e?this._needsUpdate||(this._needsUpdate=!0,this.notifyChange("updating")):this._needsRender=!0}},{key:"needsUpdate",get:function(){return this._needsUpdate}},{key:"updating",get:function(){return this.evaluateUpdating()}},{key:"evaluateUpdating",value:function(){return this.needsUpdate||this._needsWaterReflectionUpdate||this._renderer.updating||this._textureRepository.updating||this.waterTextureRepository.updating||this._magnifierHelper.updating}},{key:"ensureEdgeView",value:function(){return this._renderer.ensureEdgeView()}},{key:"edgeView",get:function(){return this._renderer.edgeView}},{key:"textureRepository",get:function(){return this._textureRepository}},{key:"compositingHelper",get:function(){return this._compositingHelper}},{key:"magnifier",set:function(e){this._magnifierHelper.magnifier=e}},{key:"updateLightSources",value:function(e,t,r){this._renderer.updateLightSources(e,t,r),this.setNeedsRender()}},{key:"setRenderParameters",value:function(e){void 0!==e.idleSuspend&&this._idleSuspend!==!!e.idleSuspend&&(this._idleSuspend=!!e.idleSuspend,this.setNeedsRender()),this._renderer.setRenderParameters(e)}},{key:"renderingContext",get:function(){return this._rctx}},{key:"has",value:function(e){switch(e){case 0:return!!this._rctx.capabilities.compressedTextureETC;case 1:return!!this._rctx.capabilities.compressedTextureS3TC;case 2:return!!this._rctx.capabilities.shaderTextureLOD;case 3:return this._renderer.hasShadowsEnabled;default:return!1}}},{key:"modify",value:function(e){this._renderer.modify(e),e.clear()}},{key:"canvas",get:function(){return this._canvas}},{key:"takeScreenshot",value:function(e){return this._screenshotManager.takeScreenshot(e)}},{key:"readAccumulatedShadow",value:function(e){return this._renderer.readAccumulatedShadow(e[0],e[1])}},{key:"getMinimalDepthForArea",value:function(e,t,r,n){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:n,a=r.constrainWindowSize(e,t,n*r.pixelRatio,i*r.pixelRatio),o=this._ensureDepthBuffer(a);this._renderer.readDepthPixels(r,a[0],a[1],a[2],a[3],o);for(var s=Number.MAX_VALUE,c=0;c<a[2]*a[3];c++){var l=YC(4*c,o,r.nearFar);s>l&&l!==r.nearFar[0]&&l!==r.nearFar[1]&&(s=l)}return s===Number.MAX_VALUE?void 0:s}},{key:"_ensureDepthBuffer",value:function(e){var t=4*e[2]*e[3];return(Object(I.i)(this._tmpDepthBuffer)||this._tmpDepthBuffer.byteLength<t)&&(this._tmpDepthBuffer=new Uint8Array(t)),this._tmpDepthBuffer}},{key:"renderPlugins",get:function(){return this._renderer.renderPlugins}},{key:"test",get:function(){return{renderer:this._renderer}}},{key:"getGpuMemoryUsage",value:function(){return this._renderer.getGpuMemoryUsage()}},{key:"hotReloadShaders",value:function(){var e=Object(s.a)(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return ux(),e.next=3,this._shaderTechniqueRepository.hotReload();case 3:this.setNeedsRender();case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"_registerFrameTask",value:function(e){var t=this,r=e.state,n={viewCamera:r.camera,frameHasDecorations:!1},i=!1,a={preRender:function(n){i=t.evaluateUpdating(),e.processSyncLayers();var a=Object(Vd.a)(n.time-t._logicUpdateLast);if(a>ix){var o={camera:r.camera,dt:a};t._logicUpdateLast=n.time,t._renderer.updateLogic(o)&&t.setNeedsRender(0)}},render:function(){if((t.needsUpdate||t._needsRender||!t._idleSuspend||!t._renderer.isCameraFinal||t._needsWaterReflectionUpdate)&&r.camera.fullWidth>0&&r.camera.fullHeight>0){var e=t._needsUpdate&&t._idleSuspend&&t._renderer.isCameraFinal;t._needsRender=!1,t._needsUpdate=!1,t._needsWaterReflectionUpdate=!1,t._renderer.render(null,r.camera,r.contentCamera,!1),e&&t._renderer.hasWaterReflection&&(t.setNeedsRender(0),t._needsWaterReflectionUpdate=!0)}},postRender:function(){i===t.updating&&i===t.evaluateUpdating()||t.notifyChange("updating")},update:function(){n.viewCamera=r.camera,n.frameHasDecorations=t._renderer.hasSlicePlane||t._magnifierHelper.enabled,t._textureRepository.update(),t._screenshotManager.update(n)}};this._frameTask=Object(H.a)(a)}},{key:"_initializeContext",value:function(e){this._canvas=e.canvas,this._canvas||(this._canvas=document.createElement("canvas")),this._canvas.setAttribute("style","width: 100%; height:100%; display:block;");var t={alpha:e.alpha||!1,premultipliedAlpha:!0,antialias:!1,depth:!0,stencil:null==e.stencil||e.stencil,powerPreference:"high-performance"},r=Object(pE.b)(this._canvas,t,e.renderContext),n={disabledExtensions:e.deactivatedWebGLExtensions||{},debugWebGLExtensions:e.debugWebGLExtensions||{},maxAnisotropy:8};this._rctx=new Tk.a(r,n),Object(uw.b)(this._rctx),this._loadShaderOnlyExtensions(this._rctx),!e.alpha&&this._rctx.contextAttributes.alpha&&bE.error("WebGL context has alpha channel even though no alpha channel was requested"),!this._rctx.contextAttributes.alpha&&Object(g.a)("safari")>=11&&(this._container.style.backgroundColor="black"),this._container.appendChild(this._canvas)}},{key:"_loadShaderOnlyExtensions",value:function(e){var t=e.capabilities;t.enable("standardDerivatives"),t.enable("shaderTextureLOD"),t.enable("textureFloat")}},{key:"componentObjectCollection",get:function(){return Object(I.i)(this._componentObjectCollection)&&(this._componentObjectCollection=new LC(this._renderer.renderPassManager)),this._componentObjectCollection},set:function(e){this._componentObjectCollection=e}}]),r}(Object(tT.b)(de.a));Object(b.a)([Object(y.b)({type:Boolean,readOnly:!0})],vE.prototype,"updating",null),Object(b.a)([Object(tT.c)()],vE.prototype,"_rctx",void 0),Object(b.a)([Object(tT.c)()],vE.prototype,"_container",void 0),Object(b.a)([Object(tT.c)()],vE.prototype,"_canvas",void 0),Object(b.a)([Object(tT.c)()],vE.prototype,"_stippleTextureRepository",void 0),Object(b.a)([Object(tT.c)(),Object(y.b)()],vE.prototype,"waterTextureRepository",void 0),Object(b.a)([Object(tT.c)(),Object(y.b)()],vE.prototype,"_magnifierHelper",void 0),Object(b.a)([Object(tT.c)(),Object(y.b)()],vE.prototype,"_textureRepository",void 0),Object(b.a)([Object(tT.c)()],vE.prototype,"_compositingHelper",void 0),Object(b.a)([Object(tT.c)()],vE.prototype,"_renderer",void 0),Object(b.a)([Object(tT.c)()],vE.prototype,"_screenshotManager",void 0),Object(b.a)([Object(tT.c)()],vE.prototype,"componentObjectCollection",null),Object(b.a)([Object(tT.c)()],vE.prototype,"_componentObjectCollection",void 0),vE=Object(b.a)([Object(w.a)("esri.views.3d.webgl-engine.parts.RenderView")],vE);var mE=dE=function(e){Object(f.a)(r,e);var t=Object(p.a)(r);function r(e){var n;return Object(c.a)(this,r),(n=t.call(this,e))._handles=new oe.a,n._model=new lT,n._layers=new zy.a,n._changeSet=new rT.a,n._layerSyncSet=new Set,n}return Object(l.a)(r,[{key:"initialize",value:function(){this._set("renderView",new vE(this)),this._frameTask=this.resourceController.scheduler.registerTask(Og.b.STAGE,this),this._handles.add(this._frameTask)}},{key:"destroy",value:function(){nT.a.pool.prune(0),this._handles.destroy(),this.dispose()}},{key:"viewingMode",get:function(){return this.state.viewingMode}},{key:"updating",get:function(){return this._model.dirtySet.dirty||this.renderView.updating}},{key:"add",value:function(e){this._model.add(e),Object(iO.b)(e)&&(e.attachStage(this),this._addLayer(e)),this.renderView.setNeedsRender()}},{key:"remove",value:function(e){Object(I.i)(e)||(this.renderView.setNeedsRender(),this._model.remove(e),Object(iO.b)(e)&&(this._removeLayer(e),e.detachStage()))}},{key:"addMany",value:function(e){Object(I.j)(e)&&(this._model.addMany(e),this.renderView.setNeedsRender())}},{key:"removeMany",value:function(e){Object(I.j)(e)&&(this._model.removeMany(e),this.renderView.setNeedsRender())}},{key:"forEachOfType",value:function(e,t){this._model.forEachOfType(e,t)}},{key:"handleEvent",value:function(e,t){this.destroyed||(this._model.dirtySet[e](t),this.renderView.setNeedsRender())}},{key:"running",get:function(){return this._model.dirtySet.dirty}},{key:"runTask",value:function(e){this._frameTask.processQueue(e),e.done||this._commit()}},{key:"_commit",value:function(){var e=this._model.dirtySet;dE.DebugSettings.logDirtySet&&console.log("Dirty set: "+e.formatDebugInfo()),e.commit(this._changeSet),dE.DebugSettings.logDirtySet&&(console.log("RGs add: "+this._changeSet.adds.map((function(e){return e.id}))),console.log("RGs remove: "+this._changeSet.removes.map((function(e){return e.id})))),this._layerSyncSet.clear(),this.renderView.modify(this._changeSet),this.renderView.setNeedsRender()}},{key:"schedule",value:function(e,t){return this._frameTask.schedule(e,t)}},{key:"syncLayer",value:function(e){this._layerSyncSet.add(e),this.renderView.setNeedsRender()}},{key:"processSyncLayers",value:function(){var e=this,t=this._model.dirtySet;this._layers.forAll((function(r){(e._layerSyncSet.has(r.id)||1===r.updatePolicy)&&(t.commitLayer(r.id,e._changeSet),e._layerSyncSet.delete(r.id))}));var r,n=Object(i.a)(this._layerSyncSet);try{for(n.s();!(r=n.n()).done;){var a=r.value;t.commitLayer(a,this._changeSet)}}catch(o){n.e(o)}finally{n.f()}this._layerSyncSet.clear(),this.renderView.modify(this._changeSet)}},{key:"getObject",value:function(e){return this._model.getObject(e)}},{key:"layers",get:function(){return this._layers}},{key:"_addLayer",value:function(e){this._layers.some((function(t){return t===e}))||this._layers.push(e)}},{key:"_removeLayer",value:function(e){this._commit(),null!=this._layers.removeUnordered(e)&&(this._model.dirtySet.getResidentRenderGeometries(e.id,this._changeSet.removes),this.renderView.modify(this._changeSet))}},{key:"addRenderPlugin",value:function(e,t,r){var n=this,i=this.renderView.renderPlugins.add(e,t,r),a=function(){T_(t)&&n.sceneIntersectionHelper.addIntersectionHandler(t)};if(Object(q.p)(i))return i.then(a);a()}},{key:"removeRenderPlugin",value:function(e){T_(e)&&this.sceneIntersectionHelper.removeIntersectionHandler(e),this.renderView.renderPlugins.remove(e)}},{key:"performanceInfo",get:function(){return{renderView:this.renderView.performanceInfo,model:this._model.getStats()}}},{key:"test",get:function(){var e=this;return{getCount:function(t){return e._model.test.content.filter((function(e){return e.type===t})).length},stopAnimations:function(t){return e._model.test.content.filter((function(e){return 3===e.type})).forEach((function(e){return Object(I.c)(e.animation,(function(e){return e.stopAtTime(t)}))}))},model:e._model}}}]),r}(Object(tT.b)(de.a));mE.DebugSettings={endFrameContentValidation:!1,logDirtySet:!1},Object(b.a)([Object(y.b)({constructOnly:!0})],mE.prototype,"resourceController",void 0),Object(b.a)([Object(y.b)({constructOnly:!0})],mE.prototype,"options",void 0),Object(b.a)([Object(y.b)({constructOnly:!0})],mE.prototype,"state",void 0),Object(b.a)([Object(y.b)({constructOnly:!0})],mE.prototype,"sceneIntersectionHelper",void 0),Object(b.a)([Object(y.b)({readOnly:!0})],mE.prototype,"viewingMode",null),Object(b.a)([Object(y.b)({constructOnly:!0})],mE.prototype,"container",void 0),Object(b.a)([Object(y.b)({constructOnly:!0})],mE.prototype,"renderSR",void 0),Object(b.a)([Object(y.b)({constructOnly:!0})],mE.prototype,"_handles",void 0),Object(b.a)([Object(y.b)({readOnly:!0})],mE.prototype,"updating",null),Object(b.a)([Object(y.b)({constructOnly:!0})],mE.prototype,"_model",void 0),Object(b.a)([Object(tT.c)(),Object(y.b)()],mE.prototype,"renderView",void 0),mE=dE=Object(b.a)([Object(w.a)("esri.views.3d.webgl-engine.Stage")],mE);var yE=r(446);function gE(){return(gE=Object(s.a)(o.a.mark((function e(t,r){var n,i,a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("2d"!==t.type){e.next=2;break}return e.abrupt("return",t.hitTest(r));case 2:return e.next=4,t.hitTest(r);case 4:return n=e.sent,i=n.results[0],a=n.results.findIndex((function(e){return e.distance!==i.distance})),e.abrupt("return",(-1!==a&&(n.results=n.results.slice(0,a)),n));case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var OE=r(633),jE={checkMajorWebPerformanceCaveat:!0};function _E(e){e=Object(ie.a)(Object(ie.a)({},jE),e);var t=Object(OE.a)();return t.available?e.checkMajorWebPerformanceCaveat&&t.majorPerformanceCaveat?new U.a("webgl:major-performance-caveat-detected","Your WebGL implementation doesn't seem to support hardware accelerated rendering. Check your browser settings or if your GPU is in a blocklist."):t.supportsHighPrecisionFragment?t.supportsVertexShaderSamplers?t.supportsElementIndexUint?t.supportsStandardDerivatives?t.supportsInstancedArrays?null:new U.a("webgl:instanced-arrays-required","WebGL support for instanced rendering is required but not supported."):new U.a("webgl:standard-derivatives-required","WebGL support for standard derivatives is required but not supported."):new U.a("webgl:element-index-uint-required","WebGL support for uint vertex indices is required but not supported."):new U.a("webgl:vertex-shader-samplers-required","WebGL support for vertex shader samplers is required but not supported."):new U.a("webgl:high-precision-fragment-required","WebGL support for high precision fragment shaders is required but not supported."):new U.a("webgl:required","WebGL is required but not supported.")}var wE="esri-component",xE=function(e){Object(f.a)(r,e);var t=Object(p.a)(r);function r(){var e;return Object(c.a)(this,r),(e=t.apply(this,arguments)).widget=null,e}return Object(l.a)(r,[{key:"destroy",value:function(){this.widget&&this.widget.destroy(),this.node=null}},{key:"id",get:function(){return this.get("widget.id")||this.get("node.id")}},{key:"node",set:function(e){var t=this._get("node");e!==t&&(e&&e.classList.add(wE),t&&t.classList.remove(wE),this._set("node",e))}},{key:"castNode",value:function(e){return e?"string"==typeof e||function(e){return e&&"nodeType"in e}(e)?(this._set("widget",null),Object(N.a)(e)):(function(e){return e&&"function"==typeof e.render}(e)&&!e.domNode&&(e.domNode=document.createElement("div")),this._set("widget",e),e.domNode):(this._set("widget",null),null)}}]),r}(de.a);Object(b.a)([Object(y.b)({dependsOn:[]})],xE.prototype,"id",null),Object(b.a)([Object(y.b)()],xE.prototype,"node",null),Object(b.a)([Object(O.a)("node")],xE.prototype,"castNode",null),Object(b.a)([Object(y.b)({readOnly:!0})],xE.prototype,"widget",void 0);var kE=xE=Object(b.a)([Object(w.a)("esri.views.ui.Component")],xE),SE={left:0,top:0,bottom:0,right:0},TE={bottom:30,top:15,right:15,left:15},CE="manual",ME="esri-ui",PE="esri-ui-corner",AE="esri-ui-inner-container",EE="esri-ui-manual-container",RE="esri-ui-corner-container",IE="esri-ui-top-left",DE="esri-ui-top-right",FE="esri-ui-bottom-left",LE="esri-ui-bottom-right";function zE(e){return"object"!=typeof e||e instanceof kE||"declaredClass"in e||!("component"in e||"index"in e||"position"in e)?null:e}function VE(e,t){var r=t.top,n=t.bottom,i=t.left,a=t.right;e.style.top=r,e.style.bottom=n,e.style.left=i,e.style.right=a}var NE=function(e){Object(f.a)(r,e);var t=Object(p.a)(r);function r(e){var n;return Object(c.a)(this,r),(n=t.call(this,e))._cornerNameToContainerLookup={},n._positionNameToContainerLookup={},n._components=new Array,n._componentToKey=new Map,n._handles=new oe.a,n.view=null,n._initContainers(),n}return Object(l.a)(r,[{key:"initialize",value:function(){this._handles.add([Object(W.a)(this,"view.padding, container",this._applyViewPadding.bind(this)),Object(W.a)(this,"padding",this._applyUIPadding.bind(this))])}},{key:"destroy",value:function(){this.container=null;var e,t=Object(i.a)(this._components);try{for(t.s();!(e=t.n()).done;){e.value.destroy()}}catch(r){t.e(r)}finally{t.f()}this._components.length=0,this._handles.destroy(),this._componentToKey.clear()}},{key:"container",set:function(e){var t=this._get("container");e!==t&&(e&&(e.classList.add(ME),e.classList.add(Object(wt.d)()),this._attachContainers(e)),t&&(t.classList.remove(ME),VE(t,{top:"",bottom:"",left:"",right:""}),Object(N.b)(t)),this._set("container",e))}},{key:"height",get:function(){var e=this.get("view.height")||0;if(0===e)return e;var t=this._getViewPadding(),r=t.top+t.bottom;return Math.max(e-r,0)}},{key:"padding",get:function(){return this._get("padding")},set:function(e){e?this._override("padding",e):this._clearOverride("padding")}},{key:"castPadding",value:function(e){return"number"==typeof e?{bottom:e,top:e,right:e,left:e}:Object(ie.a)(Object(ie.a)({},TE),e)}},{key:"width",get:function(){var e=this.get("view.width")||0;if(0===e)return e;var t=this._getViewPadding(),r=t.left+t.right;return Math.max(e-r,0)}},{key:"add",value:function(e,t){var r,n,i,a,o=this;if(Array.isArray(e))e.forEach((function(e){return o.add(e,t)}));else{var s=zE(e);s&&(i=(r=s).index,t=r.position,e=r.component,a=r.key),t&&"object"==typeof t&&(i=(n=t).index,a=n.key,t=n.position),!e||t&&!this._isValidPosition(t)||this._add(e,t,i,a)}}},{key:"remove",value:function(e,t){var r=this;if(e){if(Array.isArray(e))return e.map((function(e){return r.remove(e,t)}));var n=this._find(e);if(n){var i=this._componentToKey;if(i.has(e)&&i.get(e)!==t)return;var a=this._components.indexOf(n);return n.node.parentNode&&n.node.parentNode.removeChild(n.node),this._componentToKey.delete(e),this._components.splice(a,1)[0]}}}},{key:"empty",value:function(e){var t=this;return Array.isArray(e)?e.map((function(e){return t.empty(e)})).reduce((function(e,t){return e.concat(t)})):(e=e||CE)===CE?Array.prototype.slice.call(this._manualContainer.children).filter((function(e){return!e.classList.contains(PE)})).map((function(e){return t.remove(e)})):this._isValidPosition(e)?Array.prototype.slice.call(this._cornerNameToContainerLookup[e].children).map(this.remove,this):null}},{key:"move",value:function(e,t){var r=this;if(Array.isArray(e)&&e.forEach((function(e){return r.move(e,t)})),e){var n,i=zE(e)||zE(t);if(i&&(n=i.index,t=i.position,e=i.component||e),!t||this._isValidPosition(t)){var a=this.remove(e);a&&this.add(a,{position:t,index:n})}}}},{key:"find",value:function(e){if(!e)return null;var t=this._findById(e);return t&&(t.widget||t.node)}},{key:"getPosition",value:function(e){for(var t in this._positionNameToContainerLookup)if(this._positionNameToContainerLookup[t].contains(e))return t;return null}},{key:"_add",value:function(e,t,r,n){e instanceof kE||(e=new kE({node:e})),this._place({component:e,position:t,index:r}),this._components.push(e),n&&this._componentToKey.set(e,n)}},{key:"_find",value:function(e){return e?e instanceof kE?this._findByComponent(e):"string"==typeof e?this._findById(e):this._findByNode(e.domNode||e):null}},{key:"_getViewPadding",value:function(){return this.get("view.padding")||SE}},{key:"_attachContainers",value:function(e){e.appendChild(this._innerContainer),e.appendChild(this._manualContainer)}},{key:"_initContainers",value:function(){var e=document.createElement("div");e.classList.add(AE),e.classList.add(RE);var t=document.createElement("div");t.classList.add(AE),t.classList.add(EE);var r=document.createElement("div");r.classList.add(IE),r.classList.add(PE),e.appendChild(r);var n=document.createElement("div");n.classList.add(DE),n.classList.add(PE),e.appendChild(n);var i=document.createElement("div");i.classList.add(FE),i.classList.add(PE),e.appendChild(i);var a=document.createElement("div");a.classList.add(LE),a.classList.add(PE),e.appendChild(a),this._innerContainer=e,this._manualContainer=t;var o=Object(wt.h)();this._cornerNameToContainerLookup={"top-left":r,"top-right":n,"bottom-left":i,"bottom-right":a,"top-leading":o?n:r,"top-trailing":o?r:n,"bottom-leading":o?a:i,"bottom-trailing":o?i:a},this._positionNameToContainerLookup=Object(ie.a)({manual:t},this._cornerNameToContainerLookup)}},{key:"_isValidPosition",value:function(e){return!!this._positionNameToContainerLookup[e]}},{key:"_place",value:function(e){var t=e.component,r=e.position||CE,n=e.index,i=this._positionNameToContainerLookup[r],a=n>-1;if(function(e){return e&&!e._started&&"function"==typeof e.postMixInProperties&&"function"==typeof e.buildRendering&&"function"==typeof e.postCreate&&"function"==typeof e.startup}(t.widget)&&t.widget.startup(),a){var o=Array.prototype.slice.call(i.children);0!==n?n>=o.length?i.appendChild(t.node):Object(N.c)(t.node,o[n]):i.firstChild?Object(N.c)(t.node,i.firstChild):i.appendChild(t.node)}else i.appendChild(t.node)}},{key:"_applyViewPadding",value:function(){var e=this.container;e&&VE(e,this._toPxPosition(this._getViewPadding()))}},{key:"_applyUIPadding",value:function(){var e=this._innerContainer;e&&VE(e,this._toPxPosition(this.padding))}},{key:"_toPxPosition",value:function(e){return{top:this._toPxUnit(e.top),left:this._toPxUnit(e.left),right:this._toPxUnit(e.right),bottom:this._toPxUnit(e.bottom)}}},{key:"_toPxUnit",value:function(e){return 0===e?"0":e+"px"}},{key:"_findByComponent",value:function(e){var t,r=null;return this._components.some((function(n){return(t=n===e)&&(r=n),t})),r}},{key:"_findById",value:function(e){var t,r=null;return this._components.some((function(n){return(t=n.id===e)&&(r=n),t})),r}},{key:"_findByNode",value:function(e){var t,r=null;return this._components.some((function(n){return(t=n.node===e)&&(r=n),t})),r}}]),r}(Ii.a.EventedAccessor);Object(b.a)([Object(y.b)()],NE.prototype,"container",null),Object(b.a)([Object(y.b)()],NE.prototype,"height",null),Object(b.a)([Object(y.b)({value:TE})],NE.prototype,"padding",null),Object(b.a)([Object(O.a)("padding")],NE.prototype,"castPadding",null),Object(b.a)([Object(y.b)()],NE.prototype,"view",void 0),Object(b.a)([Object(y.b)()],NE.prototype,"width",null);var UE=NE=Object(b.a)([Object(w.a)("esri.views.ui.UI")],NE);function BE(e,t){return e&&"copyright"in e&&(!t||"function"==typeof e.originOf&&"user"===e.originOf("copyright"))}function GE(e,t,r){r&&t&&(e.find((function(e){return e.layerView===t&&e.text===r}))||e.push({text:r,layerView:t}))}function qE(e){return"bing-maps"===e.type}var HE=[],WE=function(e){Object(f.a)(r,e);var t=Object(p.a)(r);function r(e){var n;return Object(c.a)(this,r),(n=t.call(this,e)).clear=function(){n._fetchedAttributionData.clear(),n._pendingAttributions.clear(),n.handles.remove("suspension"),n.notifyChange("state")},n._pendingAttributions=new Set,n._fetchedAttributionData=new Map,n.items=new V.a,n.view=null,n._allLayerViewsChange=function(e){n.handles.remove("suspension");var t=n.get("view.allLayerViews");t&&n.handles.add(t.map((function(e){return e.watch(["suspended","attributionVisible"],n._updateAttributionItems)})),"suspension"),e&&e.removed&&e.removed.forEach((function(e){n._pendingAttributions.delete(e),n._fetchedAttributionData.delete(e)})),n._updateAttributionItems()},n._updateAttributionItems=function(){var e=n.get("view.allLayerViews");HE.length=0,e?(e.forEach((function(e){if(!e.suspended&&e.get("layer.attributionVisible")){var t=e.layer;if(BE(t,"user"))GE(HE,e,t.copyright);else if(t.hasAttributionData){if(n._fetchedAttributionData.has(e)){var r=n._fetchedAttributionData.get(e);return void(r?GE(HE,e,n._getDynamicAttribution(r,n.view,t)):BE(t)&&GE(HE,e,t.copyright))}n._fetchAttributionData(e)}else{var i=t.get("portalItem.accessInformation");GE(HE,e,i||t.copyright)}}})),function(e,t){return e.length!==t.length||e.some((function(e,r){return e.text!==t[r].text}))}(n.items,HE)&&(n.items.removeAll(),n.items.addMany(HE)),HE.length=0,n.notifyChange("state")):n.clear()},n.handles.add([Object(W.b)(Object(u.a)(n),"view.allLayerViews","change",n._allLayerViewsChange,n._allLayerViewsChange,n.clear),Object(W.k)(Object(u.a)(n),"view.stationary",(function(){return n._updateAttributionItems()}))]),n}return Object(l.a)(r,[{key:"destroy",value:function(){this.view=null,this._fetchedAttributionData.clear(),this._pendingAttributions.clear(),this.items.removeAll()}},{key:"state",get:function(){return this.get("view.ready")?this._pendingAttributions.size>0?"loading":"ready":"disabled"}},{key:"_fetchAttributionData",value:function(){var e=Object(s.a)(o.a.mark((function e(t){var r,n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._pendingAttributions.has(t)){e.next=2;break}return e.abrupt("return");case 2:return this._pendingAttributions.add(t),e.next=5,Object(wg.d)(t.layer.fetchAttributionData());case 5:r=e.sent,this._pendingAttributions.has(t)&&(n=r.ok?this._createContributionIndex(r.value,qE(t.layer)):null,this._pendingAttributions.delete(t),this._fetchedAttributionData.set(t,n)),this._updateAttributionItems();case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_createContributionIndex",value:function(e,t){var r=e.contributors,n={};if(!r)return n;for(var a=0;a<r.length;a++){var o=r[a],s=o.coverageAreas;if(!s)return;var c,l=Object(i.a)(s);try{for(l.s();!(c=l.n()).done;)for(var u=c.value,d=u.bbox,h=u.zoomMin-(t&&u.zoomMin?1:0),f=u.zoomMax-(t&&u.zoomMax?1:0),p={xmin:d[1],ymin:d[0],xmax:d[3],ymax:d[2],spatialReference:Gs.a.WGS84},b={extent:Object(re.b)(p),attribution:o.attribution||"",score:null!=u.score?u.score:100,id:a},v=h;v<=f;v++)n[v]=n[v]||[],n[v].push(b)}catch(m){l.e(m)}finally{l.f()}}return n.maxKey=Math.max.apply(null,Object.keys(n)),n}},{key:"_getDynamicAttribution",value:function(e,t,r){var n=t.extent,i=t.scale,a=r.tileInfo.scaleToZoom(i);if(a=Math.min(e.maxKey,Math.round(a)),!n||null==a||a<=-1)return"";var o=e[a],s=Object(re.d)(n.center.clone().normalize(),t.spatialReference),c={};return o?o.filter((function(e){var t=!c[e.id]&&s&&Object(Ts.e)(e.extent,s);return t&&(c[e.id]=!0),t})).sort((function(e,t){return t.score-e.score||e.objectId-t.objectId})).map((function(e){return e.attribution})).join(", "):""}}]),r}(je.a);Object(b.a)([Object(y.b)({readOnly:!0,type:V.a})],WE.prototype,"items",void 0),Object(b.a)([Object(y.b)({readOnly:!0})],WE.prototype,"state",null),Object(b.a)([Object(y.b)()],WE.prototype,"view",void 0);var QE=WE=Object(b.a)([Object(w.a)("esri.widgets.Attribution.AttributionViewModel")],WE),ZE="esri-attribution esri-widget",XE="esri-widget__anchor",YE="esri-attribution__powered-by",$E="esri-attribution__sources",JE="esri-attribution--open",KE="esri-attribution__sources--open",eR="esri-attribution__link",tR="esri-icon-description",rR="esri-interactive",nR=function(e){Object(f.a)(r,e);var t=Object(p.a)(r);function r(e,n){var i;return Object(c.a)(this,r),(i=t.call(this,e,n))._isOpen=!1,i._attributionTextOverflowed=!1,i._prevSourceNodeHeight=0,i.iconClass=tR,i.itemDelimiter=" | ",i.label=void 0,i.messages=null,i.view=null,i.viewModel=new QE,i}return Object(l.a)(r,[{key:"initialize",value:function(){var e=this;this.own(Object(W.b)(this,"viewModel.items","change",(function(){return e.scheduleRender()})))}},{key:"attributionText",get:function(){return this.viewModel.items.reduce((function(e,t){return-1===e.indexOf(t.text)&&e.push(t.text),e}),[]).join(this.itemDelimiter)}},{key:"render",value:function(){var e=Object(ve.a)({},JE,this._isOpen);return Object(kt.a)("div",{bind:this,class:this.classes(ZE,e),onclick:this._toggleState,onkeydown:this._toggleState},this.renderSourcesNode(),this.renderPoweredBy())}},{key:"renderPoweredBy",value:function(){return Object(kt.a)("div",{class:YE},"Powered by"," ",Object(kt.a)("a",{class:this.classes(eR,XE),href:"http://www.esri.com/",target:"_blank",rel:"noreferrer"},"Esri"))}},{key:"renderSourcesNode",value:function(){var e,t=this._isOpen,r=this._isInteractive(),n=r?0:-1,i=this.attributionText,a=r?"button":void 0,o=(e={},Object(ve.a)(e,KE,t),Object(ve.a)(e,rR,r),e);return Object(kt.a)("div",{afterCreate:this._afterSourcesNodeCreate,afterUpdate:this._afterSourcesNodeUpdate,bind:this,class:this.classes($E,o),innerHTML:i,role:a,tabIndex:n})}},{key:"_afterSourcesNodeCreate",value:function(e){this._prevSourceNodeHeight=e.clientWidth}},{key:"_afterSourcesNodeUpdate",value:function(e){var t=!1,r=e.clientHeight,n=e.clientWidth,i=e.scrollWidth>=n,a=this._attributionTextOverflowed!==i;if(this._attributionTextOverflowed=i,a&&(t=!0),this._isOpen){var o=r<this._prevSourceNodeHeight;this._prevSourceNodeHeight=r,o&&(this._isOpen=!1,t=!0)}t&&this.scheduleRender()}},{key:"_toggleState",value:function(){this._isInteractive()&&(this._isOpen=!this._isOpen)}},{key:"_isInteractive",value:function(){return this._isOpen||this._attributionTextOverflowed}}]),r}(ge.a);Object(b.a)([Object(y.b)({readOnly:!0,dependsOn:["viewModel.items.length","itemDelimiter"]})],nR.prototype,"attributionText",null),Object(b.a)([Object(y.b)()],nR.prototype,"iconClass",void 0),Object(b.a)([Object(y.b)()],nR.prototype,"itemDelimiter",void 0),Object(b.a)([Object(y.b)({aliasOf:{source:"messages.widgetLabel",overridable:!0}})],nR.prototype,"label",void 0),Object(b.a)([Object(y.b)(),Object(xt.a)("esri/widgets/Attribution/t9n/Attribution")],nR.prototype,"messages",void 0),Object(b.a)([Object(ye.a)("viewModel.view")],nR.prototype,"view",void 0),Object(b.a)([Object(y.b)({type:QE})],nR.prototype,"viewModel",void 0),Object(b.a)([Object(Na.a)()],nR.prototype,"_toggleState",null);var iR=nR=Object(b.a)([Object(w.a)("esri.widgets.Attribution")],nR),aR=function(e){Object(f.a)(r,e);var t=Object(p.a)(r);function r(e){var n;return Object(c.a)(this,r),(n=t.call(this,e))._handles=new oe.a,n.orientation={x:0,y:0,z:0},n.view=null,n._updateForCamera=n._updateForCamera.bind(Object(u.a)(n)),n._updateForRotation=n._updateForRotation.bind(Object(u.a)(n)),n._updateRotationWatcher=n._updateRotationWatcher.bind(Object(u.a)(n)),n}return Object(l.a)(r,[{key:"initialize",value:function(){this._handles.add(Object(W.a)(this,"view",this._updateRotationWatcher))}},{key:"destroy",value:function(){this._handles.destroy(),this._handles=null,this.view=null}},{key:"canShowNorth",get:function(){var e=this.get("view.spatialReference");return!(!e||!e.isWebMercator&&!e.isGeographic)}},{key:"state",get:function(){return this.get("view.ready")?this.canShowNorth?"compass":"rotation":"disabled"}},{key:"reset",value:function(){if(this.get("view.ready")){var e={};"2d"===this.view.type?e.rotation=0:e.heading=0,this.callGoTo({target:e})}}},{key:"_updateForRotation",value:function(e){null!=e&&(this.orientation={z:e})}},{key:"_updateForCamera",value:function(e){if(e){var t=-e.heading;this.orientation={x:0,y:0,z:t}}}},{key:"_updateRotationWatcher",value:function(e){this._handles.removeAll(),e&&("2d"===e.type?this._handles.add(Object(W.a)(this,"view.rotation",this._updateForRotation)):this._handles.add(Object(W.a)(this,"view.camera",this._updateForCamera)))}}]),r}(Ra(de.a));Object(b.a)([Object(y.b)({readOnly:!0})],aR.prototype,"canShowNorth",null),Object(b.a)([Object(y.b)()],aR.prototype,"orientation",void 0),Object(b.a)([Object(y.b)({readOnly:!0})],aR.prototype,"state",null),Object(b.a)([Object(y.b)()],aR.prototype,"view",void 0);var oR=aR=Object(b.a)([Object(w.a)("esri.widgets.CompassViewModel")],aR),sR="esri-compass esri-widget--button esri-widget",cR="esri-icon-font-fallback-text",lR="esri-compass__icon",uR="esri-icon-dial",dR="esri-icon-compass",hR="esri-icon-locate-circled",fR="esri-interactive",pR="esri-disabled",bR=function(e){Object(f.a)(r,e);var t=Object(p.a)(r);function r(e,n){var i;return Object(c.a)(this,r),(i=t.call(this,e,n)).goToOverride=null,i.iconClass=hR,i.label=void 0,i.messages=null,i.view=null,i.viewModel=new oR,i}return Object(l.a)(r,[{key:"reset",value:function(){return this.viewModel.reset()}},{key:"render",value:function(){var e,t,r=this.viewModel,n=r.orientation,i=r.state,a="disabled"===i,o="compass"===("rotation"===i?"rotation":"compass"),s=a?-1:0,c=(e={},Object(ve.a)(e,pR,a),Object(ve.a)(e,fR,!a),e),l=(t={},Object(ve.a)(t,dR,o),Object(ve.a)(t,uR,!o),t),u=this.messages;return Object(kt.a)("div",{bind:this,class:this.classes(sR,c),onclick:this._reset,onkeydown:this._reset,role:"button",tabIndex:s,"aria-label":u.reset,title:u.reset},Object(kt.a)("span",{"aria-hidden":"true",class:this.classes(lR,l),styles:this._toRotationTransform(n)}),Object(kt.a)("span",{class:cR},u.reset))}},{key:"_reset",value:function(){this.viewModel.reset()}},{key:"_toRotationTransform",value:function(e){return{transform:"rotateZ(".concat(e.z,"deg)")}}}]),r}(ge.a);Object(b.a)([Object(ye.a)("viewModel.goToOverride")],bR.prototype,"goToOverride",void 0),Object(b.a)([Object(y.b)()],bR.prototype,"iconClass",void 0),Object(b.a)([Object(y.b)({aliasOf:{source:"messages.widgetLabel",overridable:!0}})],bR.prototype,"label",void 0),Object(b.a)([Object(y.b)(),Object(xt.a)("esri/widgets/Compass/t9n/Compass")],bR.prototype,"messages",void 0),Object(b.a)([Object(ye.a)("viewModel.view")],bR.prototype,"view",void 0),Object(b.a)([Object(y.b)({type:oR})],bR.prototype,"viewModel",void 0),Object(b.a)([Object(Na.a)()],bR.prototype,"_reset",null);var vR=bR=Object(b.a)([Object(w.a)("esri.widgets.Compass")],bR),mR=function(e){Object(f.a)(r,e);var t=Object(p.a)(r);function r(e){var n;return Object(c.a)(this,r),(n=t.call(this,e))._handles=new oe.a,n.navigationMode="pan",n.view=null,n}return Object(l.a)(r,[{key:"initialize",value:function(){this._handles.add(Object(W.f)(this,"view.inputManager",this._setNavigationMode.bind(this)))}},{key:"destroy",value:function(){this._handles.destroy(),this._handles=null,this.view=null}},{key:"state",get:function(){return this.get("view.ready")&&"3d"===this.view.type?"ready":"disabled"}},{key:"toggle",value:function(){"disabled"!==this.state&&(this.navigationMode="pan"!==this.navigationMode?"pan":"rotate",this._setNavigationMode())}},{key:"_setNavigationMode",value:function(){this.get("view.inputManager").primaryDragAction="pan"===this.navigationMode?"pan":"rotate"}}]),r}(de.a);Object(b.a)([Object(y.b)({readOnly:!0})],mR.prototype,"state",null),Object(b.a)([Object(y.b)()],mR.prototype,"navigationMode",void 0),Object(b.a)([Object(y.b)()],mR.prototype,"view",void 0);var yR=mR=Object(b.a)([Object(w.a)("esri.widgets.NavigationToggleViewModel")],mR),gR="esri-navigation-toggle esri-widget",OR="esri-navigation-toggle__button esri-widget--button",jR="esri-navigation-toggle__button--active",_R="esri-navigation-toggle__button--pan",wR="esri-navigation-toggle__button--rotate",xR="esri-navigation-toggle--horizontal",kR="esri-icon-rotate",SR="esri-icon-pan",TR="esri-icon-pan2",CR="esri-disabled",MR=function(e){Object(f.a)(r,e);var t=Object(p.a)(r);function r(e,n){var i;return Object(c.a)(this,r),(i=t.call(this,e,n)).iconClass=TR,i.label=void 0,i.messages=null,i.view=null,i.viewModel=new yR,i}return Object(l.a)(r,[{key:"layout",set:function(e){"horizontal"!==e&&(e="vertical"),this._set("layout",e)}},{key:"toggle",value:function(){return this.viewModel.toggle()}},{key:"render",value:function(){var e,t="disabled"===this.get("viewModel.state"),r="pan"===this.get("viewModel.navigationMode"),n=(e={},Object(ve.a)(e,CR,t),Object(ve.a)(e,xR,"horizontal"===this.layout),e),i=Object(ve.a)({},jR,r),a=Object(ve.a)({},jR,!r),o=t?-1:0,s=this.messages.toggle;return Object(kt.a)("div",{bind:this,class:this.classes(gR,n),onclick:this._toggle,onkeydown:this._toggle,tabIndex:o,"aria-label":s,title:s},Object(kt.a)("div",{class:this.classes(OR,_R,i)},Object(kt.a)("span",{class:SR})),Object(kt.a)("div",{class:this.classes(OR,wR,a)},Object(kt.a)("span",{class:kR})))}},{key:"_toggle",value:function(){this.toggle()}}]),r}(ge.a);Object(b.a)([Object(y.b)()],MR.prototype,"iconClass",void 0),Object(b.a)([Object(y.b)({aliasOf:{source:"messages.widgetLabel",overridable:!0}})],MR.prototype,"label",void 0),Object(b.a)([Object(y.b)({value:"vertical"})],MR.prototype,"layout",null),Object(b.a)([Object(y.b)(),Object(xt.a)("esri/widgets/NavigationToggle/t9n/NavigationToggle")],MR.prototype,"messages",void 0),Object(b.a)([Object(ye.a)("viewModel.view")],MR.prototype,"view",void 0),Object(b.a)([Object(y.b)({type:yR})],MR.prototype,"viewModel",void 0),Object(b.a)([Object(Na.a)()],MR.prototype,"_toggle",null);var PR=MR=Object(b.a)([Object(w.a)("esri.widgets.NavigationToggle")],MR),AR="esri-widget--button esri-widget",ER="esri-disabled",RR="esri-interactive",IR="esri-icon-font-fallback-text",DR="esri-icon",FR=function(e){Object(f.a)(r,e);var t=Object(p.a)(r);function r(){var e;return Object(c.a)(this,r),(e=t.apply(this,arguments)).enabled=!0,e.iconClass="",e.title="",e}return Object(l.a)(r,[{key:"render",value:function(){var e,t=this.enabled?0:-1,r=(e={},Object(ve.a)(e,ER,!this.enabled),Object(ve.a)(e,RR,this.enabled),e),n=Object(ve.a)({},this.iconClass,!!this.iconClass);return Object(kt.a)("div",{bind:this,class:this.classes(AR,r),onclick:this._triggerAction,onkeydown:this._triggerAction,role:"button",tabIndex:t,title:this.title},Object(kt.a)("span",{"aria-hidden":"true",role:"presentation",class:this.classes(DR,n)}),Object(kt.a)("span",{class:IR},this.title))}},{key:"_triggerAction",value:function(){this.action.call(this)}}]),r}(ge.a);Object(b.a)([Object(y.b)()],FR.prototype,"action",void 0),Object(b.a)([Object(y.b)()],FR.prototype,"enabled",void 0),Object(b.a)([Object(y.b)()],FR.prototype,"iconClass",void 0),Object(b.a)([Object(y.b)()],FR.prototype,"title",void 0),Object(b.a)([Object(Na.a)()],FR.prototype,"_triggerAction",null);var LR=FR=Object(b.a)([Object(w.a)("esri.widgets.IconButton")],FR),zR=function(e){Object(f.a)(r,e);var t=Object(p.a)(r);function r(){return Object(c.a)(this,r),t.apply(this,arguments)}return Object(l.a)(r,[{key:"canZoomIn",get:function(){if(!this.get("view.ready"))return!1;var e=this.get("view.animation.target.scale")||this.get("view.scale"),t=this.get("view.constraints.effectiveMaxScale");return 0===t||e>t}},{key:"canZoomOut",get:function(){if(!this.get("view.ready"))return!1;var e=this.get("view.animation.target.scale")||this.get("view.scale"),t=this.get("view.constraints.effectiveMinScale");return 0===t||e<t}}]),r}(de.a);Object(b.a)([Object(y.b)({readOnly:!0})],zR.prototype,"canZoomIn",null),Object(b.a)([Object(y.b)({readOnly:!0})],zR.prototype,"canZoomOut",null),Object(b.a)([Object(y.b)()],zR.prototype,"view",void 0);var VR=zR=Object(b.a)([Object(w.a)("esri.widgets.Zoom.ZoomConditions2D")],zR),NR=function(e){Object(f.a)(r,e);var t=Object(p.a)(r);function r(){return Object(c.a)(this,r),t.apply(this,arguments)}return Object(l.a)(r,[{key:"canZoomIn",get:function(){return!!this.get("view.ready")}},{key:"canZoomOut",get:function(){return!!this.get("view.ready")}}]),r}(de.a);Object(b.a)([Object(y.b)({readOnly:!0})],NR.prototype,"canZoomIn",null),Object(b.a)([Object(y.b)({readOnly:!0})],NR.prototype,"canZoomOut",null),Object(b.a)([Object(y.b)()],NR.prototype,"view",void 0);var UR=NR=Object(b.a)([Object(w.a)("esri.widgets.Zoom.ZoomConditions3D")],NR),BR=function(e){Object(f.a)(r,e);var t=Object(p.a)(r);function r(e){var n;return Object(c.a)(this,r),(n=t.call(this,e)).canZoomIn=!1,n.canZoomOut=!1,n}return Object(l.a)(r,[{key:"destroy",value:function(){this.view=null}},{key:"state",get:function(){return this.get("view.ready")?"ready":"disabled"}},{key:"view",set:function(e){e?"2d"===e.type?this._zoomConditions=new VR({view:e}):"3d"===e.type&&(this._zoomConditions=new UR({view:e})):this._zoomConditions=null,this._set("view",e)}},{key:"zoomIn",value:function(){if(this.canZoomIn){var e=this.view;"2d"===e.type?e.mapViewNavigation.zoomIn():Object(q.m)(e.goTo({zoomFactor:2}))}}},{key:"zoomOut",value:function(){if(this.canZoomOut){var e=this.view;"2d"===e.type?e.mapViewNavigation.zoomOut():Object(q.m)(e.goTo({zoomFactor:.5}))}}}]),r}(de.a);Object(b.a)([Object(y.b)()],BR.prototype,"_zoomConditions",void 0),Object(b.a)([Object(y.b)({aliasOf:"_zoomConditions.canZoomIn",readOnly:!0})],BR.prototype,"canZoomIn",void 0),Object(b.a)([Object(y.b)({aliasOf:"_zoomConditions.canZoomOut",readOnly:!0})],BR.prototype,"canZoomOut",void 0),Object(b.a)([Object(y.b)({readOnly:!0})],BR.prototype,"state",null),Object(b.a)([Object(y.b)()],BR.prototype,"view",null);var GR=BR=Object(b.a)([Object(w.a)("esri.widgets.Zoom.ZoomViewModel")],BR),qR="esri-zoom esri-widget",HR="esri-zoom--horizontal",WR="esri-icon-plus",QR="esri-icon-minus",ZR="esri-icon-zoom-in-magnifying-glass",XR=function(e){Object(f.a)(r,e);var t=Object(p.a)(r);function r(e,n){var i;return Object(c.a)(this,r),(i=t.call(this,e,n)).iconClass=ZR,i.label=void 0,i.messages=null,i.view=null,i.viewModel=new GR,i}return Object(l.a)(r,[{key:"initialize",value:function(){this._zoomInButton=new LR({action:this.zoomIn.bind(this),iconClass:WR}),this._zoomOutButton=new LR({action:this.zoomOut.bind(this),iconClass:QR})}},{key:"destroy",value:function(){this._zoomInButton.destroy(),this._zoomOutButton.destroy(),this._zoomInButton=null,this._zoomOutButton=null}},{key:"layout",set:function(e){"horizontal"!==e&&(e="vertical"),this._set("layout",e)}},{key:"render",value:function(){var e=this.viewModel,t=Object(ve.a)({},HR,"horizontal"===this.layout);return this._zoomInButton.enabled="ready"===e.state&&e.canZoomIn,this._zoomOutButton.enabled="ready"===e.state&&e.canZoomOut,this._zoomInButton.title=this.messages.zoomIn,this._zoomOutButton.title=this.messages.zoomOut,Object(kt.a)("div",{class:this.classes(qR,t)},this._zoomInButton.render(),this._zoomOutButton.render())}},{key:"zoomIn",value:function(){return this.viewModel.zoomIn()}},{key:"zoomOut",value:function(){return this.viewModel.zoomOut()}}]),r}(ge.a);Object(b.a)([Object(y.b)()],XR.prototype,"iconClass",void 0),Object(b.a)([Object(y.b)({aliasOf:{source:"messages.widgetLabel",overridable:!0}})],XR.prototype,"label",void 0),Object(b.a)([Object(y.b)({value:"vertical"})],XR.prototype,"layout",null),Object(b.a)([Object(y.b)(),Object(xt.a)("esri/widgets/Zoom/t9n/Zoom")],XR.prototype,"messages",void 0),Object(b.a)([Object(ye.a)("viewModel.view")],XR.prototype,"view",void 0),Object(b.a)([Object(y.b)({type:GR})],XR.prototype,"viewModel",void 0);var YR=XR=Object(b.a)([Object(w.a)("esri.widgets.Zoom")],XR),$R="esri.views.ui.DefaultUI";j.a.getLogger($R);var JR=function(e){Object(f.a)(r,e);var t=Object(p.a)(r);function r(e){var n;return Object(c.a)(this,r),(n=t.call(this,e))._defaultPositionLookup={attribution:"manual",compass:"top-leading","navigation-toggle":"top-leading",zoom:"top-leading"},n.components=[],n}return Object(l.a)(r,[{key:"initialize",value:function(){this._handles.add([Object(W.a)(this,"components",this._componentsWatcher.bind(this)),Object(W.a)(this,"view",this._updateViewAwareWidgets.bind(this))])}},{key:"_add",value:function(e,t,n,i){if("string"==typeof e&&this._defaultPositionLookup[e]){if(this._find(e))return;e=this._createComponent(e)}Object(d.a)(Object(h.a)(r.prototype),"_add",this).call(this,e,t,n,i)}},{key:"_removeComponents",value:function(e){var t=this;e.forEach((function(e){var r=t._find(e);r&&(t.remove(r),r.destroy())}))}},{key:"_updateViewAwareWidgets",value:function(e){var t=this;this.components.forEach((function(r){var n=t._find(r),i=n&&n.widget;(function(e){return e&&void 0!==e.view})(i)&&(i.view=e)}))}},{key:"_componentsWatcher",value:function(e,t){this._removeComponents(t),this._addComponents(e),this._adjustPadding(e)}},{key:"_adjustPadding",value:function(e){if(-1===e.indexOf("attribution")&&!this._isOverridden("padding")){var t=this.padding.top;this.padding=t}}},{key:"_addComponents",value:function(e){var t=this;this.initialized&&e.forEach((function(e){return t.add(t._createComponent(e),t._defaultPositionLookup[e])}))}},{key:"_createComponent",value:function(e){var t=this._createWidget(e);if(t)return new kE({id:e,node:t})}},{key:"_createWidget",value:function(e){return"attribution"===e?this._createAttribution():"compass"===e?this._createCompass():"navigation-toggle"===e?this._createNavigationToggle():"zoom"===e?this._createZoom():void 0}},{key:"_createAttribution",value:function(){return new iR({view:this.view})}},{key:"_createCompass",value:function(){return new vR({view:this.view})}},{key:"_createNavigationToggle",value:function(){return new PR({view:this.view})}},{key:"_createZoom",value:function(){return new YR({view:this.view})}}]),r}(UE);Object(b.a)([Object(y.b)()],JR.prototype,"components",void 0);var KR=function(e){Object(f.a)(r,e);var t=Object(p.a)(r);function r(e){var n;return Object(c.a)(this,r),(n=t.call(this,e)).components=["attribution","zoom","navigation-toggle","compass"],n}return r}(JR=Object(b.a)([Object(w.a)($R)],JR));Object(b.a)([Object(y.b)()],KR.prototype,"components",void 0);var eI=KR=Object(b.a)([Object(w.a)("esri.views.ui.3d.DefaultUI3D")],KR),tI=j.a.getLogger("esri.views.SceneView"),rI=function(e){Object(f.a)(n,e);var t=Object(p.a)(n);function n(e){var r;Object(c.a)(this,n),(r=t.call(this,e))._clippingArea=null,r._userClippingArea=null,r._initialDefaultSpatialReference=null,r._defaults={},r._externallySet={environment:!1},r._createGraphicsViewController=null,r._resolveWhenReady=[],r.propertiesPool=new $O.a({slicePlane:ee.a},Object(u.a)(r)),r._resourceController=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){return performance.now()};return new tw.ResourceController({view:e,now:t})}(Object(u.a)(r)),r._defaultToMapOptions={include:new Set},r._defaultHitTestOptions={exclude:new Set},r.deconflictor=new jg({view:Object(u.a)(r)}),r.labeler=new oO({view:Object(u.a)(r),deconflictor:r.deconflictor.labels}),r.sharedSymbolResources=null,r.basemapTerrain=null,r.elevationProvider=null,r.camera=null,r.canvas=null,r.center=null,r.constraints=new Ol,r.environmentManager=new zd,r.extent=null,r.floors=new V.a,r.windowDevicePixelRatio=1,r.fullOpacity=1,r.graphicsView=null,r.groundView=null,r.navigating=!1,r.map=null,r.screenSizePerspectiveEnabled=!0,r.state=new nj,r.scale=null,r.spatialReference=null,r.isHeightModelInfoRequired=!0,r.alphaCompositingEnabled=!1,r.supersampleScreenhotsEnabled=!0,r.type="3d",r.ui=new eI,r._numUpdating=0,r._lastUpdateTime=0,r.updatingProgress=.5,r.viewpoint=null,r.zoom=null,r.highlightOptions=new z_,Object(Q.a)(),e&&e.environment||(r._defaults.environment=new Xl,r.environment=r._defaults.environment);var i=function(e){Object(I.j)(e)&&4===e.type||(r.notifyChange("dataExtent"),r.updatingChanged(),r.map&&r.map.allLayers.forEach(function(){var e=Object(s.a)(o.a.mark((function e(t){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.when();case 3:e.next=7;break;case 5:e.prev=5,e.t0=e.catch(0);case 7:r.updatingChanged();case 8:case"end":return e.stop()}}),e,null,[[0,5]])})));return function(t){return e.apply(this,arguments)}}()))};r.handles.add([Object(W.b)(Object(u.a)(r),"map.allLayers","after-changes",i,i,i,!0),r.allLayerViews.on("after-changes",(function(e){return r._updateUpdatingMonitors(e)})),r.watch("map",(function(e){e&&e.load&&e.load().catch((function(){}))}))]),r.inputManager=new Ly({view:Object(u.a)(r)});return r.stateManager=new j_({view:Object(u.a)(r),updateDevicePixelRatio:function(){var e=window.devicePixelRatio;e!==r.windowDevicePixelRatio&&(r.windowDevicePixelRatio=e,r.notifyChange("pixelRatio"))}}),r}return Object(l.a)(n,[{key:"initialize",value:function(){var e=this;this.groundView=new Ds({view:this}),this._updateUpdatingMonitors();var t=function(){return e._updateDefaultToMapOptions()};this.handles.add(Object(W.b)(this,"map.allLayers","after-changes",t,t,t)),this.updatingHandles.add(this.qualitySettings,"memoryLimit",(function(t){e.resourceController&&(e.resourceController.memoryController.maxMemory=t)}),2),this.updatingHandles.add(this.qualitySettings,"additionalCacheMemory",(function(t){e.resourceController&&(e.resourceController.memoryController.additionalCacheMemory=t)}),2),this.updatingHandles.add(this.qualitySettings,"frameRate",(function(e){return Object(H.c)(e>0?1e3/Math.ceil(e):0)}),2),this.updatingHandles.add(Vy.a,"SCENEVIEW_LOCKING_LOG",(function(t){return e.defaultsFromMap.logDebugInformation=t}),2),this.updatingHandles.add(this,"map.ground",t,3),this.updatingHandles.add(this,"map.ground.opacity",(function(){return e._updateDefaultHitTestOptions()}),3),this.handles.add(this.watch("spatialReference",(function(){return e.notifyChange("clippingArea")}),!0))}},{key:"destroy",value:function(){this.destroyed||(this.invalidate(),this.activeTool=null,this.layerViewManager.clear(),this._exitSurface(),this._disposeGraphicsView(),this.sharedSymbolResources&&(this.sharedSymbolResources.destroy(),this.sharedSymbolResources=null),this.labeler.destroy(),this._set("labeler",null),this.deconflictor.destroy(),this._set("deconflictor",null),this._resourceController.destroy(),this._resourceController=null,this.stateManager.destroy(),this._set("stateManager",null),this.inputManager.destroy(),this._set("inputManager",null),this.propertiesPool.destroy(),this.handles.remove("updatingMonitors"),this.environmentManager.destroy(),this._set("environmentManager",null),this.groundView.destroy(),this.groundView=null)}},{key:"renderSpatialReference",get:function(){return this.renderCoordsHelper&&this.renderCoordsHelper.spatialReference}},{key:"basemapSpatialReference",get:function(){return this.basemapTerrain&&this.basemapTerrain.spatialReference}},{key:"installContentCameraReset",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{sticky:!1};return this.stateManager.installContentCameraReset(e)}},{key:"clippingArea",get:function(){if("global"===this.viewingMode)return null;var e=this._userClippingArea||this.get("map.clippingArea");if(!this._userClippingArea&&!this.get("map.clippingEnabled")||!e)return this._clippingArea=null,null;if(!(e instanceof Bs.a))return tI.error("#clippingArea","only clippingArea geometries of type Extent are supported"),this._clippingArea;if(this.spatialReference){if(!Object(re.a)(e.spatialReference,this.spatialReference))return tI.error("#clippingArea","setting clippingArea with incompatible SpatialReference"),this._clippingArea;e=Object(re.d)(e,this.spatialReference)}return this._clippingArea&&e&&this._clippingArea.equals(e)?this._clippingArea:(this._clippingArea=e,e)},set:function(e){this.ready&&"global"===this.viewingMode&&e?tI.error("#clippingArea=","Clipping area is only supported in local viewingMode"):(this._userClippingArea=e,this.notifyChange("clippingArea"))}},{key:"dataExtent",get:function(){var e,t=this.spatialReference||Gs.a.WGS84,r=this.clippingArea;r&&(r=Object(re.d)(r,t));var n=function(n){var i=Object(re.d)(n,t);i&&(r&&!(i=i.intersection(r))||(Object(I.j)(e)?e.union(i):e=i))},i=this.basemapTerrain;if(i&&i.spatialReference&&n(new Bs.a({xmin:i.extent[0],ymin:i.extent[1],zmin:0,xmax:i.extent[2],ymax:i.extent[3],zmax:0,spatialReference:i.spatialReference})),this.map){this.map.allLayers.forEach((function(e){return function(e){!e.fullExtent||"graphics"===e.type&&e.internal||n(e.fullExtent)}(e)}))}return Object(I.i)(e)?new Bs.a({xmin:0,ymin:0,zmin:0,xmax:0,ymax:0,zmax:0,spatialReference:t}):(e.hasZ?(e.zmin=Math.min(0,e.zmin),e.zmax=Math.max(0,e.zmax)):(e.zmin=0,e.zmax=0),e)}},{key:"environment",set:function(e){e!==this._defaults.environment&&(this._externallySet.environment=!0),this._set("environment",e)}},{key:"castEnvironment",value:function(e){return e?e instanceof Xl?e:e instanceof Ql?null!=this.environment?this.environment.cloneWithWebsceneEnvironment(e):Xl.fromWebsceneEnvironment(e):Object(k.m)(Xl,e):new Xl}},{key:"pixelRatio",get:function(){return Math.min(this.windowDevicePixelRatio,this.maximumPixelRatio)},set:function(e){Object(I.j)(e)?this._override("pixelRatio",e):this._clearOverride("pixelRatio")}},{key:"maximumPixelRatio",get:function(){var e=1/0,t=this.qualitySettings,r=t.maximumPixelRatio,n=t.maximumRenderResolution;if(null!=r&&(e=Math.min(e,r)),null!=n){var i=n/Math.max(this.width,this.height);e=Math.min(e,i)}return e},set:function(e){Object(I.j)(e)?this._override("maximumPixelRatio",e):this._clearOverride("maximumPixelRatio")}},{key:"groundExtent",get:function(){var e=this._get("basemapTerrain");if(e&&e.spatialReference){var t=e.extent;return new Bs.a({xmin:t[0],ymin:t[1],xmax:t[2],ymax:t[3],spatialReference:e.spatialReference})}var r=this.spatialReference||Gs.a.WGS84;return new Bs.a({spatialReference:r})}},{key:"initialExtentRequired",get:function(){return this.stateManager&&!this.stateManager.hasInitialView}},{key:"interacting",get:function(){return this.navigating||Object(I.j)(this.activeTool)}},{key:"stationary",get:function(){return!this.animation&&!this.resizing&&(Object(I.i)(this.state)||this.state.stationary)}},{key:"qualityProfile",get:function(){return this._get("qualityProfile")||D_.getDefaultProfile()},set:function(e){D_.isValidProfile(e)&&(D_.apply(e,this.qualitySettings),this._set("qualityProfile",e))}},{key:"slicePlane",set:function(e){if(this._stage.renderView.setRenderParameters({slicePlane:e}),Object(I.i)(e))this._set("slicePlane",null);else{var t=this.propertiesPool.get("slicePlane");Object(ee.d)(e,t),this._set("slicePlane",t)}}},{key:"resolution",get:function(){return null!=this.spatialReference?Object(te.a)(this.scale,this.spatialReference):0}},{key:"heightModelInfo",get:function(){var e=this.getDefaultHeightModelInfo();return null!=e?Y.a.deriveUnitFromSR(e,this.spatialReference):null}},{key:"updating",get:function(){var e,t,r,n=0,i=this.layerViewManager.updating,a=i?this.layerViewManager.updatingRemaining:0;this.allLayerViews.forEach((function(e){if(e.isFulfilled()){if(e.updating){if(i=!0,e.suspended||Object(aw.j)(e))return;++a,n+="updatingProgress"in e?e.updatingProgress:.5}}else++a}));for(var o=0,s=[this.graphicsView,this.basemapView,this._resourceController,this._stage,this.featureTiles,this.pointsOfInterest,this.environmentManager,this.overlay,this.featureTreeDebugger,this.toolViewManager];o<s.length;o++){var c=s[o];if(Object(I.j)(c)&&c.updating){a+=.1,n+=.05}}for(var l=0,u=[this.deconflictor,this.labeler,this.basemapTerrain];l<u.length;l++){var d=u[l];Object(I.j)(d)&&d.updating&&(++a,n+=d.updatingProgress)}if((i=!!(i||a>0||this.updatingHandles.updating||!this.ready||!this.stationary||this._createGraphicsViewController||null!=(e=this.inputManager)&&e.hasPendingInputs||null!=(t=this.map)&&null!=(r=t.allLayers)&&r.some((function(e){return!e.isFulfilled()}))))?(this._numUpdating=Math.max(a,this._numUpdating),n+=this._numUpdating-a):this._numUpdating=0,this._numUpdating>0?n/=this._numUpdating:n=i?0:1,this._get("updatingProgress")!==n){var h=this._resourceController.scheduler.now;if(n<1){var f=Math.min((h-this._lastUpdateTime)/2e3,1);n=this.updatingProgress*(1-f)+n*f}this._set("updatingProgress",n),this._lastUpdateTime=i&&n<1?h:0}return i}},{key:"viewingMode",get:function(){var e=this.get("map.initialViewProperties.viewingMode");if(e)return e;var t=this.spatialReference;return!t||_v(t,"global")?"global":"local"},set:function(e){this.ready?tI.error("#viewingMode","viewingMode cannot be set once view is ready"):["local","global"].indexOf(e)>=0?this._override("viewingMode",e):void 0===e&&this._clearOverride("viewingMode")}},{key:"resourceController",get:function(){return this._resourceController}},{key:"performanceInfo",get:function(){return new sw(this)}},{key:"on",value:function(e,t,r,i){return this.viewEvents.on(e,t,r,i)||Object(d.a)(Object(h.a)(n.prototype),"on",this).call(this,e,t)}},{key:"hasEventListener",value:function(e){return Object(d.a)(Object(h.a)(n.prototype),"hasEventListener",this).call(this,e)||this.viewEvents.hasHandler(e)}},{key:"toMap",value:function(e,t){if(!this.ready)return tI.error("#toMap()","Scene view cannot be used before it is ready"),null;var r=t?this.externalToInternalIntersectOptions(t):this._defaultToMapOptions,n=Object(I.j)(r.graphics)&&(Object(I.j)(r.graphics.include)||Object(I.j)(r.graphics.exclude)),a=pc(e)?fc(this,e):e,o=Object(Z.i)(a);r.enableDraped=r.include&&!r.include.has(qw.b)||r.exclude&&r.exclude.has(qw.b);var s=this.sceneIntersectionHelper,c=new fh.a(this.state.viewingMode);if(c.options.selectionMode=!0,c.options.store=n?2:0,s.intersectIntersectorScreen(o,c,r),n){var l,u=Object(i.a)(c.results.all);try{for(u.s();!(l=u.n()).done;){var d=l.value,h=Object(yE.a)(d,this);if(Object(I.i)(h))return this._intersectResultToMapPoint(d);if(this._testGraphicUidFilter(r.graphics,h))return this._intersectResultToMapPoint(d)}}catch(f){u.e(f)}finally{u.f()}return null}return this._intersectResultToMapPoint(c.results.min)}},{key:"toScreen",value:function(e){if(!this.ready)return tI.error("#toScreen()","Scene view cannot be used before it is ready"),null;var t=Object(I.t)(null==e.z&&Object(Ms.b)(this.elevationProvider,e),0);return Object($.u)(e,aI,this.renderSpatialReference,t),this.state.camera.projectToScreen(aI,oI),Object(Z.e)(oI[0],oI[1])}},{key:"pixelSizeAt",value:function(e){return this.ready?e?(Object($.u)(e,aI,this.renderSpatialReference),this.state.camera.computeScreenPixelSizeAt(aI)):0:(tI.error("#pixelSizeAt()","Scene view cannot be used before it is ready"),null)}},{key:"overlayPixelSizeInMapUnits",value:function(e){var t=this.basemapTerrain.overlayManager;return t?t.overlayPixelSizeInMapUnits(e):1}},{key:"hitTest",value:function(e,t){if(!this.ready)return tI.error("#hitTest()","Scene view cannot be used before it is ready"),null;var r=pc(e)?fc(this,e):e,n=Object(Z.f)(r.x,r.y),i=t?this.externalToInternalIntersectOptions(t):this._defaultHitTestOptions;i.requiresGroundFeedback=!0,i.enableDraped=!0;var a=new fh.a(this.state.viewingMode);a.options.selectionMode=!0,a.options.store=2,this.sceneIntersectionHelper.intersectIntersectorScreen(n,a,i);var o=this._intersectResultsToHits(a.results.all,i.graphics),s=a.results.ground,c=Object(yE.b)(s,this),l=Object(I.j)(c)&&"type"in c&&"integrated-mesh"===c.type?c:null,u={screenPoint:r,results:o,ground:{mapPoint:this._intersectResultToMapPoint(s),distance:s.hasIntersectionPoint?s.distanceInRenderSpace:0,layer:l}};return Vy.a.SCENEVIEW_HITTEST_RETURN_INTERSECTOR&&(u.intersector=a),Promise.resolve(u)}},{key:"popupHitTest",value:function(e){return function(e,t){return gE.apply(this,arguments)}(this,e).then((function(t){var r=t.results,n=t.ground,i=null;return!(0===r.length||Math.abs(r[0].distance-n.distance)<1e-5)||n.layer&&"integrated-mesh"===n.layer.type||(i=n.mapPoint),{results:r,screenPoint:e,mapPoint:i}}))}},{key:"goTo",value:function(e,t){return this.updatingHandles.addPromise(this.stateManager.goTo(e,t))}},{key:"whenLayerView",value:function(e){return Object(d.a)(Object(h.a)(n.prototype),"whenLayerView",this).call(this,e)}},{key:"takeScreenshot",value:function(e){var t=this;return this.whenReady().then((function(){var r=Object(hE.e)(e,t);return r.pixelRatio/=t.pixelRatio,t._stage.renderView.takeScreenshot(Object(hE.d)(r,t.supersampleScreenhotsEnabled,t.padding))}))}},{key:"addUpdatingPromise",value:function(e){return this.updatingHandles.addPromise(e)}},{key:"importLayerView",value:function(e){return tl(e)}},{key:"hasLayerViewModule",value:function(e){return el(e)}},{key:"forceDOMReadyCycle",value:function(){this.forceReadyCycle()}},{key:"getDefaultSpatialReference",value:function(){return this.get("map.initialViewProperties.spatialReference")||this.get("defaultsFromMap.spatialReference")||this.get("defaultsFromMap.isSpatialReferenceDone")&&this._initialDefaultSpatialReference||null}},{key:"validate",value:function(){var e=Object(s.a)(o.a.mark((function e(){var t;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=_E(),Object(g.a)("safari")&&Object(g.a)("safari")<9&&(t=new U.a("sceneview:browser-not-supported","This browser is not supported by SceneView (Safari < 9)",{type:"safari",requiredVersion:9,detectedVersion:Object(g.a)("safari")})),!Object(I.j)(t)){e.next=3;break}throw tI.warn("#validate()",t.message),t;case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"isSpatialReferenceSupported",value:function(e,t,r){var n=e.isGeographic,i=e.isWebMercator,a=_v(e,"global"),o="local"===this.viewingMode,s=!(!this._isOverridden("viewingMode")&&!this.get("map.initialViewProperties.viewingMode"));if(s){if(o&&n)return r?r("Layer ".concat(t.id," is ignored because it is GCS and viewing mode is local")):tI.warnOnce("Geographic coordinate systems are not supported in local viewing mode."),!1;if(!o&&!a)return r?r("Layer ".concat(t.id," is ignored because its spatial reference is not supported in global viewing mode")):tI.warnOnce("Spatial reference defined on view not supported in global viewing mode."),!1}else if(n&&!a)return r?r("Layer ".concat(t.id," is ignored because its spatial reference is geographic but unsupported")):tI.warnOnce("Spatial reference is geographic but not supported."),!1;if(t)if(Object(ne.c)(t)){var c;if(s)c=null!=Object(aw.d)(t,e,Yc(this.viewingMode)).tileInfo;else{var l=Object(aw.d)(t,e,1);null==l.tileInfo&&(null!=(l=Object(aw.d)(t,e,2)).tileInfo&&i&&!this.ready&&(this.viewingMode="local")),c=null!=l.tileInfo}if(!c)return r&&r("Layer ".concat(t.id," is ignored because it is tiled but\n            its tiling scheme is not supported or compatible with the viewing mode")),!1}else if((e.isWGS84||i)&&!o)return null==this._initialDefaultSpatialReference&&(this._initialDefaultSpatialReference=e),s||this.ready||(this.viewingMode="global",r&&r("Viewing mode locked to global due to reprojectable layer ".concat(t.id))),r&&r("Layer ".concat(t.id," is ignored because it supports server-side reprojection")),!1;return!0}},{key:"whenReady",value:function(){var e=this;return new Promise((function(t){e.ready?t(e):e._resolveWhenReady.push(t)}))}},{key:"computeMapPointFromVec3d",value:function(e,t){var r=this.spatialReference||Gs.a.WGS84;return Object($.z)(e,this.renderSpatialReference,e,r)||(r=Gs.a.WGS84,Object($.z)(e,this.renderSpatialReference,e,r)),t?(t.x=e[0],t.y=e[1],t.z=e[2],t.spatialReference=r):t=new S.a(e,r),t}},{key:"trackGraphicState",value:function(e){if(!e.graphic)return tI.error("trackGraphicState","GraphicState.graphic must not be null or undefined to start tracking"),null;var t=this.getViewForGraphic(e.graphic),r=null,n=!1,i=function(t){!n&&Object(I.j)(t)&&"graphics3d"in t&&t.graphics3d&&t.graphics3d.graphicsCore&&(r=t.graphics3d.graphicsCore.trackGraphicState(e))};return Object(I.j)(t)?i(t):this.whenViewForGraphic(e.graphic,{waitForLayer:!0}).then((function(e){return i(e)}),(function(){})).catch((function(){})),{remove:function(){n=!0,Object(I.j)(r)&&(r.remove(),r=null)}}}},{key:"highlight",value:function(e){var t=this;if(Array.isArray(e))return Object(G.a)(e.map((function(e){return t.highlight(e)})));if(V.a.isCollection(e))return Object(G.a)(e.toArray().map((function(e){return t.highlight(e)})));var r=this.getViewForGraphic(e);return r&&"highlight"in r?r.highlight(e):Object(G.b)()}},{key:"maskOccludee",value:function(e){if(!e)return tI.error("maskOccludee","GraphicState.graphic must not be null or undefined to mask an occludee"),null;var t=this.getViewForGraphic(e),r=null,n=!1,i=function(t){!n&&Object(I.j)(t)&&"graphics3d"in t&&Object(ba.c)(t)&&(r=t.maskOccludee(e))};return Object(I.j)(t)?i(t):this.whenViewForGraphic(e,{waitForLayer:!0}).then((function(e){return i(e)}),(function(){})).catch((function(){})),{remove:function(){n=!0,Object(I.j)(r)&&(r.remove(),r=null)}}}},{key:"getViewForGraphic",value:function(e){return e.layer===this.graphics?this.graphicsView:e.layer?this.allLayerViews.find((function(t){return t.layer===e.layer})):null}},{key:"graphicChanged",value:function(e){Object(I.j)(this.graphicsView)&&this.graphicsView.graphicChanged(e)}},{key:"whenViewForGraphic",value:function(){var e=Object(s.a)(o.a.mark((function e(t,r){var n=this;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.layer!==this){e.next=4;break}return e.next=3,Object(W.j)(this,"graphicsView");case 3:return e.abrupt("return",this.graphicsView);case 4:if(t.layer&&this.map){e.next=6;break}throw new U.a("no-view-for-graphic");case 6:return e.abrupt("return",r&&r.waitForLayer&&!this.map.allLayers.includes(t.layer)?new Promise((function(e,r){var i=n.map.allLayers.on("change",(function(a){-1!==a.added.indexOf(t.layer)&&(i.remove(),n.whenLayerView(t.layer).then(e,r))}))})):this.whenLayerView(t.layer));case 7:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"externalToInternalIntersectOptions",value:function(e){var t=this._externalToInternalRenderItems(e.include,0),r=this._externalToInternalRenderItems(e.exclude,1);return{include:t.layerUids,exclude:r.layerUids,graphics:{include:t.graphicUids,exclude:r.graphicUids}}}},{key:"_intersectResultToMapPoint",value:function(e,t){return e.getIntersectionPoint(aI)?(t=this.computeMapPointFromVec3d(aI,t),"TerrainRenderer"===e.intersector&&this.basemapTerrain&&(t.z=Object(I.t)(Object(Ms.b)(this.basemapTerrain,t),0)),t):null}},{key:"_intersectResultsToHits",value:function(e,t){for(var r=new Array,n=null,i=0;i<e.length;i++){var a=e[i],o=Object(yE.b)(a,this);if(Object(I.j)(o)&&(o===this.map.ground||"type"in o&&"integrated-mesh"===o.type))break;var s=Object(yE.a)(a,this);if(Object(I.j)(s)){if(Object(I.i)(n)&&i!==e.length-1&&(n=new Set),Object(I.j)(n)){var c=this._getGraphicFilterUid(s);if(n.has(c))continue;n.add(c)}if(this._testGraphicUidFilter(t,s)){var l=this._intersectResultToMapPoint(a),u=a.distanceInRenderSpace;r.push({graphic:s,mapPoint:l,distance:u})}}}return r}},{key:"_getGraphicFilterUid",value:function(e){if(e.layer&&"objectIdField"in e.layer){var t=e.attributes[e.layer.objectIdField];if(t)return"o-".concat(e.layer.id,"-").concat(t)}return"u-".concat(e.uid)}},{key:"_testGraphicUidFilter",value:function(e,t){var r=this._getGraphicFilterUid(t);return Object(I.i)(e)||(Object(I.i)(e.include)||e.include.has(r))&&(Object(I.i)(e.exclude)||!e.exclude.has(r))}},{key:"_externalToInternalRenderItems",value:function(e,t){var r=this,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{layerUids:null,graphicUids:null};return e?(e instanceof E.a?(iI(n,this._getGraphicFilterUid(e)),0===t&&(Object(I.j)(this.graphicsView)&&e.layer===this?nI(n,this.graphicsView.graphics3d.layer.id):e.layer&&nI(n,e.layer.uid))):"forEach"in e?e.forEach((function(e){Array.isArray(e)?r._externalToInternalRenderItems(e,t,n):V.a.isCollection(e)?e===r.graphics&&Object(I.j)(r.graphicsView)?nI(n,r.graphicsView.graphics3d.layer.id):r._externalToInternalRenderItems(e,t,n):e instanceof R.a?e===r.map.ground&&nI(n,qw.b):r._externalToInternalRenderItems(e,t,n)})):nI(n,e.uid),n):n}},{key:"_initBasemapTerrain",value:function(){this._set("basemapTerrain",new eT({view:this})),this._set("elevationProvider",new A_({view:this})),this.elevationProvider.register("ground",this.basemapTerrain)}},{key:"_exitBasemapTerrain",value:function(){this.basemapTerrain&&(this.elevationProvider.unregister(this.basemapTerrain),this.elevationProvider.destroy(),this._set("elevationProvider",null),this.basemapTerrain.destroy(),this._set("basemapTerrain",null))}},{key:"_initGlobe",value:function(){var e=this;this._initCoordinateSystem(),this.state.createInitialCamera(),this._initBasemapTerrain(),this._set("pointsOfInterest",new Yw({view:this})),this._set("featureTiles",new XO({renderCoordsHelper:this.renderCoordsHelper,cameraOnSurface:this.pointsOfInterest.contentCameraOnSurface,focus:this.pointsOfInterest.focus,tilingSchemeOwner:this.basemapTerrain,viewState:this.state,scheduler:this._resourceController.scheduler,terrain:this.basemapTerrain}));var t=function(){var t=e.basemapTerrain&&e.basemapTerrain.extent;if(e.clippingArea||t)if(t&&e.basemapTerrain.spatialReference){var r=Object(K.z)(e.basemapTerrain.extent,e.basemapTerrain.spatialReference);e.clippingArea?e.featureTiles.filterExtent=r.intersection(e.clippingArea):e.featureTiles.filterExtent=r}else e.featureTiles.filterExtent=e.clippingArea;else e.featureTiles.filterExtent=null};this.handles.add([this.updatingHandles.add(Vy.a,"FEATURE_TILE_TREE_SHOW_TILES",(function(t){t&&e.featureTiles&&!e.featureTreeDebugger?e.updatingHandles.addPromise(r.e(144).then(r.bind(null,988))).then((function(t){var r=t.FeatureTileTree3DDebugger;!e.featureTreeDebugger&&Vy.a.FEATURE_TILE_TREE_SHOW_TILES&&(e.featureTreeDebugger=new r({view:e}))})):t||!e.featureTreeDebugger||Vy.a.FEATURE_TILE_TREE_SHOW_TILES||(e.featureTreeDebugger.destroy(),e.featureTreeDebugger=null)}),3),this.updatingHandles.add(this,"clippingArea",t,3),this.updatingHandles.add(this,"basemapTerrain.extent",t,3)],"feature-tiles"),this.stateManager.init()}},{key:"_exitGlobe",value:function(){this.state&&(this.stateManager.deinit(),this.handles.remove("render-coords-helper"),this.handles.remove("feature-tiles"),this.featureTiles.destroy(),this._set("featureTiles",null),this.pointsOfInterest.destroy(),this._set("pointsOfInterest",null),this._exitBasemapTerrain(),this.state.exit(),this._exitCoordinateSystem())}},{key:"_initCoordinateSystem",value:function(){var e=this;if(this.spatialReference){var t=this.spatialReference;this.mapCoordsHelper&&this.mapCoordsHelper.spatialReference.equals(t)||this._set("mapCoordsHelper",new U_(this.map,t));var r=this.state.isGlobal,n=r?Object(J.g)(t):t;n!==this.renderSpatialReference&&(this._set("renderCoordsHelper",Y_.create(this.state.viewingMode,n)),r||this.handles.add(this.watch("basemapTerrain.extent",(function(t){0===t[0]&&0===t[1]&&0===t[2]&&0===t[3]||(e.renderCoordsHelper.extent=t)}),!0),"render-coords-helper"),this.sceneIntersectionHelper&&this.sceneIntersectionHelper.setTolerance(fh.a.DEFAULT_TOLERANCE/this.renderCoordsHelper.unitInMeters))}else this._set("mapCoordsHelper",null),this._set("renderCoordsHelper",null)}},{key:"_exitCoordinateSystem",value:function(){this.mapCoordsHelper&&(this.handles.remove("render-coords-helper"),this._set("renderCoordsHelper",null),this._set("mapCoordsHelper",null))}},{key:"updatingChanged",value:function(){this.notifyChange("updating")}},{key:"_updateUpdatingMonitors",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;Object(I.j)(t)&&4===t.type||(this.handles.remove("updatingMonitors"),this.allLayerViews.forEach((function(t){t.destroyed||(e.handles.add([t.watch(["updating","updatingProgress"],(function(){return e.updatingChanged()}),!0)],"updatingMonitors"),t.when((function(){return e.updatingChanged()}),(function(){return e.updatingChanged()})))})),this.updatingChanged())}},{key:"_renderScreenshotOverlay",value:function(e,t){if(!this.overlay||!this.overlay.hasVisibleItems)return t;var r=e.getContext("2d");return r.putImageData(t,0,0),this.overlay.renderCanvas(e),r.getImageData(0,0,t.width,t.height)}},{key:"_initStage",value:function(){var e=this,t={renderContext:this.renderContext,deactivatedWebGLExtensions:this.deactivatedWebGLExtensions,debugWebGLExtensions:this.debugWebGLExtensions,alpha:this.alphaCompositingEnabled,canvas:this.renderCanvas,screenshot:{renderOverlay:function(t,r){return e._renderScreenshotOverlay(t,r)}}},r=new w_(this.state.viewingMode,{forEachLayer:function(t){return e._stage.layers.forAll(t)}},this);this._set("sceneIntersectionHelper",r);var n=Object(N.a)(this.surface),i=this.resourceController,a=this.state,o=this.renderSpatialReference;this._stage=new mE({resourceController:i,container:n,options:t,state:a,sceneIntersectionHelper:r,renderSR:o}),this._lostWebGLContextHandle=Object(B.c)(this._stage.renderView.canvas,"webglcontextlost",(function(){return e.fatalError=new U.a("webgl-context-lost")})),this.handles.add([this.updatingHandles.add(this.qualitySettings,"antialiasingEnabled",(function(){e._stage.renderView.setRenderParameters({antialiasingEnabled:e.qualitySettings.antialiasingEnabled})}),2),this.updatingHandles.add(this.qualitySettings,"highQualityTransparency",(function(){e._stage.renderView.setRenderParameters({highQualityTransparency:e.qualitySettings.highQualityTransparency})}),2),Object(W.a)(this,"magnifier",(function(t){return e._stage.renderView.magnifier=t}),!0)],"stage");for(var s=function(){e._stage.renderView.setRenderParameters({defaultHighlightOptions:z_.toEngineOptions(e.highlightOptions)})},c=0,l=["highlightOptions","highlightOptions.color","highlightOptions.haloColor","highlightOptions.haloOpacity","highlightOptions.fillOpacity","highlightOptions.shadowOpacity","highlightOptions.shadowColor","highlightOptions.shadowDifference"];c<l.length;c++){var u=l[c];this.handles.add(this.updatingHandles.add(this,u,s),"stage")}s(),this.renderCoordsHelper&&this.sceneIntersectionHelper.setTolerance(fh.a.DEFAULT_TOLERANCE/this.renderCoordsHelper.unitInMeters),this._set("canvas",this._stage.renderView.canvas)}},{key:"_exitStage",value:function(){this._set("sceneIntersectionHelper",null),this._stage.destroy(),this._stage=null,this._lostWebGLContextHandle.remove(),this._lostWebGLContextHandle=null,this.handles.remove("stage"),this._set("canvas",null)}},{key:"_initSurface",value:function(e){this._exitSurface(),this.state.init(e,this.spatialReference),this._initStage(),this._initGlobe(),this.sharedSymbolResources=new hw({view:this,viewingMode:e,resourceController:this._resourceController,pointsOfInterest:this.pointsOfInterest,viewState:this.state,objectResourceCache:new fO})}},{key:"_exitSurface",value:function(){this.sharedSymbolResources&&(this.sharedSymbolResources.objectResourceCache.destroy(),this.sharedSymbolResources.destroy(),this.sharedSymbolResources=null,this._exitGlobe(),this._exitStage())}},{key:"_createGraphicsViewIfNeeded",value:function(){var e=this;if(!this.graphicsView&&!this._createGraphicsViewController&&0!==this.graphics.length){this.handles.remove("graphics-view"),this._createGraphicsViewController=Object(q.e)();var t=function(){e._createGraphicsViewController=null,e.updatingChanged()};this._createGraphicsViewAsync(this._createGraphicsViewController.signal).then(t,t),this.updatingChanged()}}},{key:"_createGraphicsViewAsync",value:function(){var e=Object(s.a)(o.a.mark((function e(t){var n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([r.e(3),r.e(26),r.e(181)]).then(r.bind(null,1183));case 2:return n=e.sent.default,Object(q.x)(t),e.next=6,Object(W.l)(this.basemapTerrain,"ready",t);case 6:this._set("graphicsView",new n({view:this}));case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_disposeGraphicsView",value:function(){this._createGraphicsViewController&&(this._createGraphicsViewController.abort(),this._createGraphicsViewController=null),this.handles.remove("graphics-view"),Object(I.j)(this.graphicsView)&&(this.handles.remove(this.graphicsView.graphics3d.layer.id),this.graphicsView.destroy(),this._set("graphicsView",null))}},{key:"_startup",value:function(){var e=this,t=Yc(this.viewingMode);if(1===t&&(this._clippingArea=null),this._set("ready",!0),this._initSurface(t),this.handles.add(Object(W.b)(this,"graphics","after-changes",(function(){return e._createGraphicsViewIfNeeded()})),"graphics-view"),this._createGraphicsViewIfNeeded(),!this._externallySet.environment){var r=this.get("map.initialViewProperties.environment");r&&(this.environment=r)}this.labeler.setup(),this.environmentManager.connectView(this),this.inputManager.connect();var n=this._resolveWhenReady;this._resolveWhenReady=[],n.forEach((function(t){return t(e)}))}},{key:"_teardown",value:function(){this._initialDefaultSpatialReference=null,this.inputManager.disconnect(),this.environmentManager.disconnectView(),this.labeler.dispose(),this._disposeGraphicsView(),this.handles.remove("graphics-view"),this._exitSurface(),this._set("ready",!1)}},{key:"_updateDefaultToMapOptions",value:function(){if(this._defaultToMapOptions.include.clear(),this.map){this.map.ground&&this._defaultToMapOptions.include.add(qw.b);var e,t=Object(i.a)(this.map.allLayers.items);try{for(t.s();!(e=t.n()).done;){var r=e.value;"integrated-mesh"===r.type&&this._defaultToMapOptions.include.add(r.uid)}}catch(n){t.e(n)}finally{t.f()}}}},{key:"_updateDefaultHitTestOptions",value:function(){if(this._defaultHitTestOptions.exclude.clear(),this.map){this.map.ground&&this.map.ground.opacity<1&&this._defaultHitTestOptions.exclude.add(qw.b);var e,t=Object(i.a)(this.map.allLayers.items);try{for(t.s();!(e=t.n()).done;){var r=e.value;"integrated-mesh"===r.type&&r.opacity<1&&this._defaultToMapOptions.exclude.add(r.uid)}}catch(n){t.e(n)}finally{t.f()}}}}]),n}(function(e){var t=function(e){Object(f.a)(r,e);var t=Object(p.a)(r);function r(){var e;Object(c.a)(this,r);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return(e=t.call.apply(t,[this].concat(i)))._breakpointsHandles=new oe.a,e.orientation=null,e.widthBreakpoint=null,e.heightBreakpoint=null,e.breakpoints=ce,e}return Object(l.a)(r,[{key:"initialize",value:function(){this._breakpointsHandles.add(Object(W.a)(this,["breakpoints","size"],this._updateClassNames))}},{key:"destroy",value:function(){this.destroyed||(this._removeActiveClassNames(),this._breakpointsHandles.destroy(),this._breakpointsHandles=null)}},{key:"breakpoints",set:function(e){if(e!==this._get("breakpoints")){var t=function(e){var t=e;return t&&t.xsmall<t.small&&t.small<t.medium&&t.medium<t.large}(e);if(!t){var r=JSON.stringify(ce,null,2);console.warn("provided breakpoints are not valid, using defaults:"+r)}e=t?e:ce,this._set("breakpoints",Object(ie.a)({},e))}}},{key:"_updateClassNames",value:function(){if(this.container){var e,t=ae.a.acquire(),r=ae.a.acquire(),n=!1;for(e in se){var i=this[e],a=se[e].getValue({viewSize:this.size,breakpoints:this.breakpoints});i!==a&&(n=!0,this[e]=a,le(e,i).forEach((function(e){return r.push(e)})),le(e,a).forEach((function(e){return t.push(e)})))}n&&(this._applyClassNameChanges(t,r),ae.a.release(t),ae.a.release(r))}}},{key:"_applyClassNameChanges",value:function(e,t){var r=this.container;r&&(t.forEach((function(e){return r.classList.remove(e)})),e.forEach((function(e){return r.classList.add(e)})))}},{key:"_removeActiveClassNames",value:function(){var e,t=this.container;if(t)for(e in se)le(e,this[e]).forEach((function(e){return t.classList.remove(e)}))}}]),r}(e);return Object(b.a)([Object(y.b)()],t.prototype,"breakpoints",null),Object(b.a)([Object(y.b)()],t.prototype,"orientation",void 0),Object(b.a)([Object(y.b)()],t.prototype,"widthBreakpoint",void 0),Object(b.a)([Object(y.b)()],t.prototype,"heightBreakpoint",void 0),t=Object(b.a)([Object(w.a)("esri.views.BreakpointsOwner")],t)}(function(e){var t=function(e){Object(f.a)(r,e);var t=Object(p.a)(r);function r(){var e;Object(c.a)(this,r);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return(e=t.call.apply(t,[this].concat(i)))._freqInfo={freq:ks,time:Ss},e._overlayRenderTaskHandle=null,e.height=0,e.position=null,e.resizing=!1,e.root=null,e.surface=null,e.suspended=!0,e.ui=null,e.userContent=null,e.width=0,e.widthBreakpoint=null,e.handles.add([e.watch("cursor",(function(t){var r=e.surface;r&&r.setAttribute("data-cursor",t)})),e.watch("interacting",(function(t){var r=e.surface;r&&r.setAttribute("data-interacting",t.toString())}))]),e}return Object(l.a)(r,[{key:"initialize",value:function(){var e=this;this.handles.add(this.watch("ui",(function(t,r){return e._handleUIChange(t,r)}))),this._wireUI(this.ui),this.handles.add([this.on("focus",(function(){return e.notifyChange("focused")})),this.on("blur",(function(){return e.notifyChange("focused")}))])}},{key:"destroy",value:function(){this.destroyed||(this.ui&&(this.ui.destroy(),this.ui=null),this.popup&&!this.popup.destroyed&&this.popup.destroy(),this.container=null)}},{key:"container",set:function(e){var t=this,r=this._get("container");if(r!==e){var n="dom-size";if(this.handles.remove(n),this._stopMeasuring(),r&&(r.classList.remove("esri-view"),this._overlayRenderTaskHandle&&(this._overlayRenderTaskHandle.remove(),this._overlayRenderTaskHandle=null),this.overlay.destroy(),this._set("overlay",null),xs(this.root),this._set("root",null),Object(N.d)(this.userContent,r),xs(this.userContent),this._set("userContent",null)),e){e.classList.add("esri-view");var i=document.createElement("div");i.className="esri-view-user-storage",Object(N.d)(e,i),e.appendChild(i),this._set("userContent",i);var a=document.createElement("div");a.className="esri-view-root",e.insertBefore(a,e.firstChild),this._set("root",a);var o=document.createElement("div");o.className="esri-view-surface",o.setAttribute("role","application"),o.tabIndex=0,a.appendChild(o),this._set("surface",o);var s=new be;a.appendChild(s.surface),this._set("overlay",s),s.watch("needsRender",(function(e){e&&!t._overlayRenderTaskHandle?t._overlayRenderTaskHandle=Object(H.a)({render:function(){t.overlay.render()}}):t._overlayRenderTaskHandle&&(t._overlayRenderTaskHandle.remove(),t._overlayRenderTaskHandle=null)})),this.forceDOMReadyCycle(),this.handles.add(Object(W.a)(this,"size",(function(e){var t=Object(ue.a)(e,2),r=t[0],n=t[1],i="esri-view-surface--inset-outline";r>=document.body.clientWidth||n>=document.body.clientHeight?o.classList.add(i):o.classList.remove(i)})),n),this._set("container",e),this._startMeasuring()}else this._set("width",0),this._set("height",0),this._set("position",null),this._set("suspended",!0),this._set("surface",null),this._set("container",null)}}},{key:"focused",get:function(){var e=document.activeElement===this.surface;return document.hasFocus()&&e}},{key:"popup",get:function(){return this._get("popup")||new _s({view:this})},set:function(e){var t=this._get("popup");t&&t!==e&&t.destroy(),this._set("popup",e)}},{key:"size",get:function(){return[this.width,this.height]}},{key:"blur",value:function(){this.surface&&this.surface.blur()}},{key:"focus",value:function(){this.surface&&this.surface.focus()}},{key:"pageToContainer",value:function(e,t,r){var n=this.position;return e-=n[0],t-=n[1],r?(r[0]=e,r[1]=t):r=[e,t],r}},{key:"containerToPage",value:function(e,t,r){var n=this.position;return e+=n[0],t+=n[1],r?(r[0]=e,r[1]=t):r=[e,t],r}},{key:"_handleUIChange",value:function(e,t){t&&(this.handles.remove("ui"),t.destroy()),e&&this._wireUI(e),this._set("ui",e)}},{key:"_wireUI",value:function(e){this.handles.remove("ui"),e&&(e.view=this,this.handles.add([Object(W.a)(this,"root",(function(t){e.container=t?function(e){var t=document.createElement("div");return e.appendChild(t),t}(t):null})),Object(W.a)(this,"popup",(function(t,r){var n="popup";r&&e.remove(r,n),t&&(t.view=e.view,e.add(t,{key:n,position:"manual"}))}))],"ui"))}},{key:"_stopMeasuring",value:function(){this.handles.remove("measuring"),this._get("resizing")&&this._set("resizing",!1)}},{key:"_startMeasuring",value:function(){var e=this,t=this._freqInfo;t.freq=ks,t.time=Ss,this.handles.add([function(){var e=function(){t.freq=ks,t.time=Ss};return window.addEventListener("resize",e),{remove:function(){window.removeEventListener("resize",e)}}}(),Object(H.a)({prepare:function(t){var r=e._measure(),n=e._freqInfo;if(n.time+=t.deltaTime,r&&(n.freq=ks,e._get("resizing")||e._set("resizing",!0)),!(n.time<n.freq)){n.time=0;var i=e._position();n.freq=i||r?ks:Math.min(Ss,2*n.freq),!r&&n.freq>=512&&e._get("resizing")&&e._set("resizing",!1)}}})],"measuring"),this._measure(),this._position()}},{key:"_measure",value:function(){var e=this.container,t=e?e.clientWidth:0,r=e?e.clientHeight:0;if(0===t||0===r)return this.suspended||this._set("suspended",!0),!1;var n=this.width,i=this.height;return t===n&&r===i?(this.suspended&&this._set("suspended",!1),!1):(this._set("width",t),this._set("height",r),this.suspended&&this._set("suspended",!1),this.emit("resize",{oldWidth:n,oldHeight:i,width:t,height:r}),!0)}},{key:"_position",value:function(){var e=this.container,t=this.position,r=function(e){var t=(e.ownerDocument||window.document).defaultView,r=e.getBoundingClientRect();return ws[0]=r.left+t.pageXOffset,ws[1]=r.top+t.pageYOffset,ws}(e);return(!t||r[0]!==t[0]||r[1]!==t[1])&&(this._set("position",[r[0],r[1]]),!0)}},{key:"forceDOMReadyCycle",value:function(){}}]),r}(e);return Object(b.a)([Object(y.b)({value:null,cast:function(e){return Object(N.a)(e)}})],t.prototype,"container",null),Object(b.a)([Object(y.b)({readOnly:!0})],t.prototype,"focused",null),Object(b.a)([Object(y.b)({readOnly:!0})],t.prototype,"height",void 0),Object(b.a)([Object(y.b)({type:_s})],t.prototype,"popup",null),Object(b.a)([Object(y.b)({type:be})],t.prototype,"overlay",void 0),Object(b.a)([Object(y.b)({readOnly:!0})],t.prototype,"position",void 0),Object(b.a)([Object(y.b)({readOnly:!0})],t.prototype,"resizing",void 0),Object(b.a)([Object(y.b)({readOnly:!0})],t.prototype,"root",void 0),Object(b.a)([Object(y.b)({value:null,readOnly:!0})],t.prototype,"size",null),Object(b.a)([Object(y.b)({readOnly:!0})],t.prototype,"surface",void 0),Object(b.a)([Object(y.b)({readOnly:!0})],t.prototype,"suspended",void 0),Object(b.a)([Object(y.b)()],t.prototype,"ui",void 0),Object(b.a)([Object(y.b)({readOnly:!0})],t.prototype,"userContent",void 0),Object(b.a)([Object(y.b)({readOnly:!0})],t.prototype,"width",void 0),Object(b.a)([Object(y.b)()],t.prototype,"widthBreakpoint",void 0),t=Object(b.a)([Object(w.a)("esri.views.DOMContainer")],t)}(function(e){var t=function(e){Object(f.a)(r,e);var t=Object(p.a)(r);function r(){return Object(c.a)(this,r),t.apply(this,arguments)}return Object(l.a)(r,[{key:"fetchPopupFeatures",value:function(){var e=Object(s.a)(o.a.mark((function e(t,r){var n,i,a,s,c,l,u,d;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.when();case 2:return e.next=4,this._prepareFetchPopupFeatures(t,r);case 4:return n=e.sent,i=n.location,a=n.queryArea,s=n.layerViewsAndGraphics,c=n.clientOnlyGraphics,l=Promise.resolve(c),u=this._queryLayerPopupFeatures({queryArea:a,layerViewsAndGraphics:s,options:r}),d=u.map((function(e){return e.promise})),e.abrupt("return",{location:i,clientOnlyGraphics:c,allGraphicsPromise:Object(q.l)([l].concat(Object(xe.a)(d))).then(Fs.f),promisesPerLayerView:u});case 13:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"_queryLayerPopupFeatures",value:function(e){var t=e.queryArea,r=e.layerViewsAndGraphics,n=e.options;return r.map((function(e){var r=e.layerView,i={clientGraphics:e.graphics,event:Object(I.j)(n)?n.event:null,signal:Object(I.j)(n)?n.signal:null,defaultPopupTemplateEnabled:!!Object(I.j)(n)&&!!n.defaultPopupTemplateEnabled},a=r.fetchPopupFeatures(t,i);return{layerView:r,promise:a}}))}},{key:"_isValidPopupGraphic",value:function(e,t){return e&&!!e.getEffectivePopupTemplate(Object(I.j)(t)&&t.defaultPopupTemplateEnabled)}},{key:"_prepareFetchPopupFeatures",value:function(){var e=Object(s.a)(o.a.mark((function e(t,r){var n,i,a,s,c,l,u,d;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._popupHitTestGraphics(t,r);case 2:return n=e.sent,i=n.clientGraphics,a=n.queryArea,s=n.location,c=this._getFetchPopupLayerViews(),l=this._graphicsPerFetchPopupLayerView(i,c),u=l.layerViewsAndGraphics,d=l.clientOnlyGraphics,e.abrupt("return",{clientOnlyGraphics:d,layerViewsAndGraphics:u,queryArea:a,location:s});case 11:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"_popupHitTestGraphics",value:function(){var e=Object(s.a)(o.a.mark((function e(t,r){var n,i,a,s,c,l=this;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.popupHitTest(t);case 2:return n=e.sent,i=n.results,a=n.mapPoint,s=i.filter((function(e){return l._isValidPopupGraphic(e.graphic,r)})),c=s.length?s[0].mapPoint:null,e.abrupt("return",{clientGraphics:s.map((function(e){return e.graphic})),queryArea:a,location:a||c});case 8:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"_getFetchPopupLayerViews",value:function(){var e=this,t=[];return this.allLayerViews.forEach((function(r){e._isValidPopupLayerView(r)&&t.push(r)})),Object(I.j)(this.graphicsView)&&this._isValidPopupLayerView(this.graphicsView)&&t.push(this.graphicsView),t.reverse()}},{key:"_isValidPopupLayerView",value:function(e){return Object(I.j)(e)&&(!("layer"in e)||!e.suspended)&&"fetchPopupFeatures"in e}},{key:"_graphicsPerFetchPopupLayerView",value:function(e,t){var r,n=[],a=new Map,o=t.map((function(e){var t=[];return"layer"in e?a.set(e.layer,t):a.set(e.graphics,t),{layerView:e,graphics:t}})),s=Object(i.a)(e);try{for(s.s();!(r=s.n()).done;){var c=r.value,l=a.get(c.layer)||a.get(c.sourceLayer)||null;l?l.push(c):n.push(c)}}catch(u){s.e(u)}finally{s.f()}return{layerViewsAndGraphics:o,clientOnlyGraphics:n}}}]),r}(e);return t=Object(b.a)([Object(w.a)("esri.views.PopupView")],t)}(Qc))));function nI(e,t){e.layerUids||(e.layerUids=new Set),e.layerUids.add(t)}function iI(e,t){e.graphicUids||(e.graphicUids=new Set),e.graphicUids.add(t)}Object(b.a)([Object(y.b)()],rI.prototype,"_resourceController",void 0),Object(b.a)([Object(y.b)()],rI.prototype,"_stage",void 0),Object(b.a)([Object(y.b)({readOnly:!0})],rI.prototype,"deconflictor",void 0),Object(b.a)([Object(y.b)({readOnly:!0})],rI.prototype,"labeler",void 0),Object(b.a)([Object(y.b)({type:Xc,readOnly:!0,aliasOf:"state.animation"})],rI.prototype,"animation",void 0),Object(b.a)([Object(y.b)({readOnly:!0})],rI.prototype,"basemapTerrain",void 0),Object(b.a)([Object(y.b)({readOnly:!0})],rI.prototype,"elevationProvider",void 0),Object(b.a)([Object(y.b)({type:P,aliasOf:"stateManager.camera"})],rI.prototype,"camera",void 0),Object(b.a)([Object(y.b)({type:P,aliasOf:"stateManager.contentCamera"})],rI.prototype,"contentCamera",void 0),Object(b.a)([Object(y.b)({readOnly:!0})],rI.prototype,"canvas",void 0),Object(b.a)([Object(y.b)({type:S.a,aliasOf:"stateManager.center"})],rI.prototype,"center",void 0),Object(b.a)([Object(y.b)({type:Bs.a,dependsOn:["map.clippingArea?","map.clippingEnabled?","viewingMode"]})],rI.prototype,"clippingArea",null),Object(b.a)([Object(y.b)({type:Ol})],rI.prototype,"constraints",void 0),Object(b.a)([Object(y.b)({type:Bs.a,dependsOn:["basemapTerrain.extent","clippingArea","map"],readOnly:!0})],rI.prototype,"dataExtent",null),Object(b.a)([Object(y.b)({value:null,type:Xl})],rI.prototype,"environment",null),Object(b.a)([Object(O.a)("environment")],rI.prototype,"castEnvironment",null),Object(b.a)([Object(y.b)({readOnly:!0})],rI.prototype,"environmentManager",void 0),Object(b.a)([Object(y.b)({type:Bs.a,aliasOf:"stateManager.extent"})],rI.prototype,"extent",void 0),Object(b.a)([Object(y.b)()],rI.prototype,"floors",void 0),Object(b.a)([Object(y.b)({readOnly:!0,aliasOf:"stateManager.screenCenter"})],rI.prototype,"screenCenter",void 0),Object(b.a)([Object(y.b)({type:Number})],rI.prototype,"pixelRatio",null),Object(b.a)([Object(y.b)({type:Number,dependsOn:["qualitySettings.maximumPixelRatio","qualitySettings.maximumRenderResolution","size"]})],rI.prototype,"maximumPixelRatio",null),Object(b.a)([Object(y.b)({aliasOf:"stateManager.frustum"})],rI.prototype,"frustum",void 0),Object(b.a)([Object(y.b)({type:Number,readOnly:!0})],rI.prototype,"fullOpacity",void 0),Object(b.a)([Object(y.b)({readOnly:!0})],rI.prototype,"graphicsView",void 0),Object(b.a)([Object(y.b)({type:Bs.a,dependsOn:["basemapTerrain.extent"],readOnly:!0})],rI.prototype,"groundExtent",null),Object(b.a)([Object(y.b)()],rI.prototype,"groundView",void 0),Object(b.a)([Object(y.b)({type:Boolean})],rI.prototype,"initialExtentRequired",null),Object(b.a)([Object(y.b)({type:Boolean,readOnly:!0})],rI.prototype,"interacting",null),Object(b.a)([Object(y.b)()],rI.prototype,"stationary",null),Object(b.a)([Object(y.b)({aliasOf:"state.navigating"})],rI.prototype,"navigating",void 0),Object(b.a)([Object(y.b)()],rI.prototype,"map",void 0),Object(b.a)([Object(y.b)({readOnly:!0})],rI.prototype,"mapCoordsHelper",void 0),Object(b.a)([Object(y.b)({aliasOf:"stateManager.padding"})],rI.prototype,"padding",void 0),Object(b.a)([Object(y.b)({type:Yw,readOnly:!0})],rI.prototype,"pointsOfInterest",void 0),Object(b.a)([Object(y.b)({type:XO,readOnly:!0})],rI.prototype,"featureTiles",void 0),Object(b.a)([Object(y.b)()],rI.prototype,"featureTreeDebugger",void 0),Object(b.a)([Object(y.b)({type:Boolean})],rI.prototype,"screenSizePerspectiveEnabled",void 0),Object(b.a)([Object(y.b)({constructOnly:!0})],rI.prototype,"deactivatedWebGLExtensions",void 0),Object(b.a)([Object(y.b)({constructOnly:!0})],rI.prototype,"debugWebGLExtensions",void 0),Object(b.a)([Object(y.b)({constructOnly:!0})],rI.prototype,"renderCanvas",void 0),Object(b.a)([Object(y.b)({constructOnly:!0})],rI.prototype,"state",void 0),Object(b.a)([Object(y.b)({readOnly:!0})],rI.prototype,"inputManager",void 0),Object(b.a)([Object(y.b)({readOnly:!0})],rI.prototype,"stateManager",void 0),Object(b.a)([Object(y.b)({type:["low","medium","high"]})],rI.prototype,"qualityProfile",null),Object(b.a)([Object(y.b)({type:Z_,get:function(){var e=this._get("qualitySettings");return e||(e=new Z_,D_.apply(this.qualityProfile,e)),e}})],rI.prototype,"qualitySettings",void 0),Object(b.a)([Object(y.b)()],rI.prototype,"slicePlane",null),Object(b.a)([Object(y.b)({dependsOn:["viewingMode"]})],rI.prototype,"preconditionsReady",void 0),Object(b.a)([Object(y.b)({readOnly:!0})],rI.prototype,"renderCoordsHelper",void 0),Object(b.a)([Object(y.b)({readOnly:!0})],rI.prototype,"sceneIntersectionHelper",void 0),Object(b.a)([Object(y.b)({type:Number,dependsOn:["scale","spatialReference"],readOnly:!0})],rI.prototype,"resolution",null),Object(b.a)([Object(y.b)({type:Number,aliasOf:"stateManager.scale"})],rI.prototype,"scale",void 0),Object(b.a)([Object(y.b)({dependsOn:[]})],rI.prototype,"heightModelInfo",null),Object(b.a)([Object(y.b)({dependsOn:["map.initialViewProperties?.spatialReference","defaultsFromMap.isSpatialReferenceDone"]})],rI.prototype,"spatialReference",void 0),Object(b.a)([Object(y.b)({type:Boolean,constructOnly:!0})],rI.prototype,"alphaCompositingEnabled",void 0),Object(b.a)([Object(y.b)({type:Boolean})],rI.prototype,"supersampleScreenhotsEnabled",void 0),Object(b.a)([Object(y.b)({readOnly:!0})],rI.prototype,"type",void 0),Object(b.a)([Object(y.b)({type:eI})],rI.prototype,"ui",void 0),Object(b.a)([Object(y.b)({type:Boolean,readOnly:!0,dependsOn:["graphicsView.updating","basemapView.updating","basemapTerrain.updating","layerViewManager.updating","layerViewManager.updatingRemaining","_resourceController.updating","_stage.updating","featureTiles.updating","pointsOfInterest.updating","environmentManager.updating","overlay.updating","updatingHandles.updating","featureTreeDebugger.updating","labeler.updating","deconflictor.updating","ready","stationary","inputManager.hasPendingInputs","toolViewManager.updating"]})],rI.prototype,"updating",null),Object(b.a)([Object(y.b)({type:Number,readOnly:!0,dependsOn:["updating"]})],rI.prototype,"updatingProgress",void 0),Object(b.a)([Object(y.b)({type:["global","local"],dependsOn:["map.initialViewProperties?.viewingMode","spatialReference"]})],rI.prototype,"viewingMode",null),Object(b.a)([Object(y.b)({type:z,aliasOf:"stateManager.viewpoint"})],rI.prototype,"viewpoint",void 0),Object(b.a)([Object(y.b)({type:Number,aliasOf:"stateManager.zoom"})],rI.prototype,"zoom",void 0),Object(b.a)([Object(y.b)({type:z_})],rI.prototype,"highlightOptions",void 0),rI=Object(b.a)([Object(w.a)("esri.views.SceneView")],rI);var aI=Object(X.e)(),oI=Object(Z.f)(),sI=rI;t.a=sI},function(e,t,r){"use strict";r.r(t),r.d(t,"work",(function(){return T})),r.d(t,"wrappedWork",(function(){return k}));var n=r(8),i=r.n(n),a=r(16),o=r(522);function s(e,t,r){for(var n=t/3,i=new Uint32Array(r+1),a=new Uint32Array(r+1),o=function(e,t){e<t?i[e+1]++:a[t+1]++},s=0;s<n;s++){var c=e[3*s],l=e[3*s+1],u=e[3*s+2];o(c,l),o(l,u),o(u,c)}for(var d=0,h=0,f=0;f<r;f++){var p=i[f+1],b=a[f+1];i[f+1]=d,a[f+1]=h,d+=p,h+=b}for(var v=new Uint32Array(6*n),m=i[r],y=function(e,t,r){if(e<t){var n=i[e+1]++;v[2*n]=t,v[2*n+1]=r}else{var o=a[t+1]++;v[2*m+2*o]=e,v[2*m+2*o+1]=r}},g=0;g<n;g++){var O=e[3*g],j=e[3*g+1],_=e[3*g+2];y(O,j,g),y(j,_,g),y(_,O,g)}for(var w=function(e,t){for(var r=2*e,n=t-e,i=1;i<n;i++){for(var a=v[r+2*i],o=v[r+2*i+1],s=i-1;s>=0&&v[r+2*s]>a;s--)v[r+2*s+2]=v[r+2*s],v[r+2*s+3]=v[r+2*s+1];v[r+2*s+2]=a,v[r+2*s+3]=o}},x=0;x<r;x++)w(i[x],i[x+1]),w(m+a[x],m+a[x+1]);for(var k=new Int32Array(3*n),S=function(t,r){return t===e[3*r]?0:t===e[3*r+1]?1:t===e[3*r+2]?2:-1},T=function(e,t){var r=S(e,t);k[3*t+r]=-1},C=function(e,t,r,n){var i=S(e,t);k[3*t+i]=n;var a=S(r,n);k[3*n+a]=t},M=0;M<r;M++){for(var P=i[M],A=i[M+1],E=a[M],R=a[M+1];P<A&&E<R;){var I=v[2*P],D=v[2*m+2*E];I===D?(C(M,v[2*P+1],D,v[2*m+2*E+1]),P++,E++):I<D?(T(M,v[2*P+1]),P++):(T(D,v[2*m+2*E+1]),E++)}for(;P<A;)T(M,v[2*P+1]),P++;for(;E<R;)T(v[2*m+2*E],v[2*m+2*E+1]),E++}return k}var c=r(410),l=r(170),u=r(409),d=r(101),h=r(20),f=r(94),p=r(4),b=r(9),v=-1;function m(e,t){return e.cosAngle<t}function y(e,t){return e.cosAngle>t}function g(e,t){var r=Object(h.b)(e.cosAngle),n=_.fwd,i=_.ortho;return Object(p.x)(n,e.position1,e.position0),r*(Object(p.j)(Object(p.i)(i,e.faceNormal0,e.faceNormal1),n)>0?-1:1)>t}function O(e){for(var t=e.faces.length/3,r=e.faces,n=e.neighbors,i=0,a=0;a<t;a++){var o=n[3*a+0],s=n[3*a+1],c=n[3*a+2],l=r[3*a+0],u=r[3*a+1],d=r[3*a+2];i+=o===v||l<u?1:0,i+=s===v||u<d?1:0,i+=c===v||d<l?1:0}for(var h=new Int32Array(4*i),f=0,p=0;p<t;p++){var b=n[3*p+0],m=n[3*p+1],y=n[3*p+2],g=r[3*p+0],O=r[3*p+1],j=r[3*p+2];(b===v||g<O)&&(h[f++]=g,h[f++]=O,h[f++]=p,h[f++]=b),(m===v||O<j)&&(h[f++]=O,h[f++]=j,h[f++]=p,h[f++]=m),(y===v||j<g)&&(h[f++]=j,h[f++]=g,h[f++]=p,h[f++]=y)}return h}function j(e){for(var t=e.faces.length/3,r=e.vertices.position,n=e.faces,i=w.v0,a=w.v1,o=w.v2,s=new Float32Array(3*t),c=0;c<t;c++){var l=n[3*c+0],u=n[3*c+1],d=n[3*c+2];r.getVec(l,i),r.getVec(u,a),r.getVec(d,o),Object(p.l)(a,a,i),Object(p.l)(o,o,i),Object(p.i)(i,a,o),Object(p.t)(i,i),s[3*c+0]=i[0],s[3*c+1]=i[1],s[3*c+2]=i[2]}return s}var _={edge:{position0:Object(b.e)(),position1:Object(b.e)(),faceNormal0:Object(b.e)(),faceNormal1:Object(b.e)(),componentIndex:0,cosAngle:0},ortho:Object(b.e)(),fwd:Object(b.e)()},w={v0:Object(b.e)(),v1:Object(b.e)(),v2:Object(b.e)()},x={anglePlanar:4,angleSignificantEdge:35};function k(e){return S.apply(this,arguments)}function S(){return(S=Object(a.a)(i.a.mark((function e(t){var r,n,a;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=C(t),n=T(r),a=[r.data.buffer],e.abrupt("return",{result:M(n,a),transferList:a});case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function T(e){var t=function(e,t,r,n){if(t)return{faces:r,facesLength:n,neighbors:s(r,n,e.count),vertices:e};var i=Object(o.a)(e.buffer,e.stride/4,{originalIndices:r,originalIndicesLength:n}),a=s(i.indices,n,i.uniqueCount);return{faces:i.indices,facesLength:i.indices.length,neighbors:a,vertices:l.a.createView(i.buffer)}}(e.data,e.skipDeduplicate,e.indices,e.indicesLength);return P.updateSettings(e.writerSettings),A.updateSettings(e.writerSettings),function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:x,i=e.vertices.position,a=e.vertices.componentIndex,o=Object(h.g)(n.anglePlanar),s=Object(h.g)(n.angleSignificantEdge),c=Math.cos(s),l=Math.cos(o),u=_.edge,b=u.position0,w=u.position1,k=u.faceNormal0,S=u.faceNormal1,T=j(e),C=O(e),M=C.length/4,P=t.allocate(M),A=0,E=M,R=r.allocate(E),I=0,D=0,F=0,L=Object(d.i)(0,M),z=new Float32Array(M);Object(f.b)(z,(function(e,t,r){i.getVec(C[4*t+0],b),i.getVec(C[4*t+1],w),r[t]=Object(p.o)(b,w)})),L.sort((function(e,t){return z[t]-z[e]}));for(var V=new Array,N=new Array,U=0;U<M;U++){var B=L[U],G=z[B],q=C[4*B+0],H=C[4*B+1],W=C[4*B+2],Q=C[4*B+3],Z=Q===v;if(i.getVec(q,b),i.getVec(H,w),Z)Object(p.y)(k,T[3*W+0],T[3*W+1],T[3*W+2]),Object(p.m)(S,k),u.componentIndex=a.get(q),u.cosAngle=Object(p.j)(k,S);else{if(Object(p.y)(k,T[3*W+0],T[3*W+1],T[3*W+2]),Object(p.y)(S,T[3*Q+0],T[3*Q+1],T[3*Q+2]),u.componentIndex=a.get(q),u.cosAngle=Object(p.j)(k,S),y(u,l))continue;u.cosAngle<-.9999&&Object(p.m)(S,k)}D+=G,F++,Z||m(u,c)?(t.write(P,A++,u),V.push(G)):g(u,o)&&(r.write(R,I++,u),N.push(G))}var X=new Float32Array(V.reverse()),Y=new Float32Array(N.reverse());return{regular:{instancesData:t.trim(P,A),lodInfo:{lengths:X}},silhouette:{instancesData:r.trim(R,I),lodInfo:{lengths:Y}},averageEdgeLength:D/F}}(t,P,A)}function C(e){return{data:l.a.createView(e.dataBuffer),indices:"Uint32Array"===e.indicesType?new Uint32Array(e.indicesBuffer):"Uint16Array"===e.indicesType?new Uint16Array(e.indicesBuffer):void 0,indicesLength:e.indicesLength,writerSettings:e.writerSettings,skipDeduplicate:e.skipDeduplicate}}function M(e,t){return t.push(e.regular.lodInfo.lengths.buffer),t.push(e.silhouette.lodInfo.lengths.buffer),{regular:{instancesData:Object(c.a)(e.regular.instancesData,t),lodInfo:{lengths:e.regular.lodInfo.lengths.buffer}},silhouette:{instancesData:Object(c.a)(e.silhouette.instancesData,t),lodInfo:{lengths:e.silhouette.lodInfo.lengths.buffer}},averageEdgeLength:e.averageEdgeLength}}var P=new u.a,A=new u.b},function(e,t){var r;r=function(){return this}();try{r=r||new Function("return this")()}catch(n){"object"===typeof window&&(r=window)}e.exports=r},,,function(e,t,r){"use strict";var n=r(556),i=60103,a=60106;t.Fragment=60107,t.StrictMode=60108,t.Profiler=60114;var o=60109,s=60110,c=60112;t.Suspense=60113;var l=60115,u=60116;if("function"===typeof Symbol&&Symbol.for){var d=Symbol.for;i=d("react.element"),a=d("react.portal"),t.Fragment=d("react.fragment"),t.StrictMode=d("react.strict_mode"),t.Profiler=d("react.profiler"),o=d("react.provider"),s=d("react.context"),c=d("react.forward_ref"),t.Suspense=d("react.suspense"),l=d("react.memo"),u=d("react.lazy")}var h="function"===typeof Symbol&&Symbol.iterator;function f(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var p={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},b={};function v(e,t,r){this.props=e,this.context=t,this.refs=b,this.updater=r||p}function m(){}function y(e,t,r){this.props=e,this.context=t,this.refs=b,this.updater=r||p}v.prototype.isReactComponent={},v.prototype.setState=function(e,t){if("object"!==typeof e&&"function"!==typeof e&&null!=e)throw Error(f(85));this.updater.enqueueSetState(this,e,t,"setState")},v.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},m.prototype=v.prototype;var g=y.prototype=new m;g.constructor=y,n(g,v.prototype),g.isPureReactComponent=!0;var O={current:null},j=Object.prototype.hasOwnProperty,_={key:!0,ref:!0,__self:!0,__source:!0};function w(e,t,r){var n,a={},o=null,s=null;if(null!=t)for(n in void 0!==t.ref&&(s=t.ref),void 0!==t.key&&(o=""+t.key),t)j.call(t,n)&&!_.hasOwnProperty(n)&&(a[n]=t[n]);var c=arguments.length-2;if(1===c)a.children=r;else if(1<c){for(var l=Array(c),u=0;u<c;u++)l[u]=arguments[u+2];a.children=l}if(e&&e.defaultProps)for(n in c=e.defaultProps)void 0===a[n]&&(a[n]=c[n]);return{$$typeof:i,type:e,key:o,ref:s,props:a,_owner:O.current}}function x(e){return"object"===typeof e&&null!==e&&e.$$typeof===i}var k=/\/+/g;function S(e,t){return"object"===typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,(function(e){return t[e]}))}(""+e.key):t.toString(36)}function T(e,t,r,n,o){var s=typeof e;"undefined"!==s&&"boolean"!==s||(e=null);var c=!1;if(null===e)c=!0;else switch(s){case"string":case"number":c=!0;break;case"object":switch(e.$$typeof){case i:case a:c=!0}}if(c)return o=o(c=e),e=""===n?"."+S(c,0):n,Array.isArray(o)?(r="",null!=e&&(r=e.replace(k,"$&/")+"/"),T(o,t,r,"",(function(e){return e}))):null!=o&&(x(o)&&(o=function(e,t){return{$$typeof:i,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}(o,r+(!o.key||c&&c.key===o.key?"":(""+o.key).replace(k,"$&/")+"/")+e)),t.push(o)),1;if(c=0,n=""===n?".":n+":",Array.isArray(e))for(var l=0;l<e.length;l++){var u=n+S(s=e[l],l);c+=T(s,t,r,u,o)}else if("function"===typeof(u=function(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=h&&e[h]||e["@@iterator"])?e:null}(e)))for(e=u.call(e),l=0;!(s=e.next()).done;)c+=T(s=s.value,t,r,u=n+S(s,l++),o);else if("object"===s)throw t=""+e,Error(f(31,"[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t));return c}function C(e,t,r){if(null==e)return e;var n=[],i=0;return T(e,n,"","",(function(e){return t.call(r,e,i++)})),n}function M(e){if(-1===e._status){var t=e._result;t=t(),e._status=0,e._result=t,t.then((function(t){0===e._status&&(t=t.default,e._status=1,e._result=t)}),(function(t){0===e._status&&(e._status=2,e._result=t)}))}if(1===e._status)return e._result;throw e._result}var P={current:null};function A(){var e=P.current;if(null===e)throw Error(f(321));return e}var E={ReactCurrentDispatcher:P,ReactCurrentBatchConfig:{transition:0},ReactCurrentOwner:O,IsSomeRendererActing:{current:!1},assign:n};t.Children={map:C,forEach:function(e,t,r){C(e,(function(){t.apply(this,arguments)}),r)},count:function(e){var t=0;return C(e,(function(){t++})),t},toArray:function(e){return C(e,(function(e){return e}))||[]},only:function(e){if(!x(e))throw Error(f(143));return e}},t.Component=v,t.PureComponent=y,t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=E,t.cloneElement=function(e,t,r){if(null===e||void 0===e)throw Error(f(267,e));var a=n({},e.props),o=e.key,s=e.ref,c=e._owner;if(null!=t){if(void 0!==t.ref&&(s=t.ref,c=O.current),void 0!==t.key&&(o=""+t.key),e.type&&e.type.defaultProps)var l=e.type.defaultProps;for(u in t)j.call(t,u)&&!_.hasOwnProperty(u)&&(a[u]=void 0===t[u]&&void 0!==l?l[u]:t[u])}var u=arguments.length-2;if(1===u)a.children=r;else if(1<u){l=Array(u);for(var d=0;d<u;d++)l[d]=arguments[d+2];a.children=l}return{$$typeof:i,type:e.type,key:o,ref:s,props:a,_owner:c}},t.createContext=function(e,t){return void 0===t&&(t=null),(e={$$typeof:s,_calculateChangedBits:t,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null}).Provider={$$typeof:o,_context:e},e.Consumer=e},t.createElement=w,t.createFactory=function(e){var t=w.bind(null,e);return t.type=e,t},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:c,render:e}},t.isValidElement=x,t.lazy=function(e){return{$$typeof:u,_payload:{_status:-1,_result:e},_init:M}},t.memo=function(e,t){return{$$typeof:l,type:e,compare:void 0===t?null:t}},t.useCallback=function(e,t){return A().useCallback(e,t)},t.useContext=function(e,t){return A().useContext(e,t)},t.useDebugValue=function(){},t.useEffect=function(e,t){return A().useEffect(e,t)},t.useImperativeHandle=function(e,t,r){return A().useImperativeHandle(e,t,r)},t.useLayoutEffect=function(e,t){return A().useLayoutEffect(e,t)},t.useMemo=function(e,t){return A().useMemo(e,t)},t.useReducer=function(e,t,r){return A().useReducer(e,t,r)},t.useRef=function(e){return A().useRef(e)},t.useState=function(e){return A().useState(e)},t.version="17.0.2"},function(e,t,r){"use strict";var n=r(225),i=r(556),a=r(687);function o(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}if(!n)throw Error(o(227));var s=new Set,c={};function l(e,t){u(e,t),u(e+"Capture",t)}function u(e,t){for(c[e]=t,e=0;e<t.length;e++)s.add(t[e])}var d=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement),h=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,f=Object.prototype.hasOwnProperty,p={},b={};function v(e,t,r,n,i,a,o){this.acceptsBooleans=2===t||3===t||4===t,this.attributeName=n,this.attributeNamespace=i,this.mustUseProperty=r,this.propertyName=e,this.type=t,this.sanitizeURL=a,this.removeEmptyString=o}var m={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach((function(e){m[e]=new v(e,0,!1,e,null,!1,!1)})),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach((function(e){var t=e[0];m[t]=new v(t,1,!1,e[1],null,!1,!1)})),["contentEditable","draggable","spellCheck","value"].forEach((function(e){m[e]=new v(e,2,!1,e.toLowerCase(),null,!1,!1)})),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach((function(e){m[e]=new v(e,2,!1,e,null,!1,!1)})),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach((function(e){m[e]=new v(e,3,!1,e.toLowerCase(),null,!1,!1)})),["checked","multiple","muted","selected"].forEach((function(e){m[e]=new v(e,3,!0,e,null,!1,!1)})),["capture","download"].forEach((function(e){m[e]=new v(e,4,!1,e,null,!1,!1)})),["cols","rows","size","span"].forEach((function(e){m[e]=new v(e,6,!1,e,null,!1,!1)})),["rowSpan","start"].forEach((function(e){m[e]=new v(e,5,!1,e.toLowerCase(),null,!1,!1)}));var y=/[\-:]([a-z])/g;function g(e){return e[1].toUpperCase()}function O(e,t,r,n){var i=m.hasOwnProperty(t)?m[t]:null;(null!==i?0===i.type:!n&&(2<t.length&&("o"===t[0]||"O"===t[0])&&("n"===t[1]||"N"===t[1])))||(function(e,t,r,n){if(null===t||"undefined"===typeof t||function(e,t,r,n){if(null!==r&&0===r.type)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return!n&&(null!==r?!r.acceptsBooleans:"data-"!==(e=e.toLowerCase().slice(0,5))&&"aria-"!==e);default:return!1}}(e,t,r,n))return!0;if(n)return!1;if(null!==r)switch(r.type){case 3:return!t;case 4:return!1===t;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}(t,r,i,n)&&(r=null),n||null===i?function(e){return!!f.call(b,e)||!f.call(p,e)&&(h.test(e)?b[e]=!0:(p[e]=!0,!1))}(t)&&(null===r?e.removeAttribute(t):e.setAttribute(t,""+r)):i.mustUseProperty?e[i.propertyName]=null===r?3!==i.type&&"":r:(t=i.attributeName,n=i.attributeNamespace,null===r?e.removeAttribute(t):(r=3===(i=i.type)||4===i&&!0===r?"":""+r,n?e.setAttributeNS(n,t,r):e.setAttribute(t,r))))}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach((function(e){var t=e.replace(y,g);m[t]=new v(t,1,!1,e,null,!1,!1)})),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach((function(e){var t=e.replace(y,g);m[t]=new v(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)})),["xml:base","xml:lang","xml:space"].forEach((function(e){var t=e.replace(y,g);m[t]=new v(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)})),["tabIndex","crossOrigin"].forEach((function(e){m[e]=new v(e,1,!1,e.toLowerCase(),null,!1,!1)})),m.xlinkHref=new v("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach((function(e){m[e]=new v(e,1,!1,e.toLowerCase(),null,!0,!0)}));var j=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,_=60103,w=60106,x=60107,k=60108,S=60114,T=60109,C=60110,M=60112,P=60113,A=60120,E=60115,R=60116,I=60121,D=60128,F=60129,L=60130,z=60131;if("function"===typeof Symbol&&Symbol.for){var V=Symbol.for;_=V("react.element"),w=V("react.portal"),x=V("react.fragment"),k=V("react.strict_mode"),S=V("react.profiler"),T=V("react.provider"),C=V("react.context"),M=V("react.forward_ref"),P=V("react.suspense"),A=V("react.suspense_list"),E=V("react.memo"),R=V("react.lazy"),I=V("react.block"),V("react.scope"),D=V("react.opaque.id"),F=V("react.debug_trace_mode"),L=V("react.offscreen"),z=V("react.legacy_hidden")}var N,U="function"===typeof Symbol&&Symbol.iterator;function B(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=U&&e[U]||e["@@iterator"])?e:null}function G(e){if(void 0===N)try{throw Error()}catch(r){var t=r.stack.trim().match(/\n( *(at )?)/);N=t&&t[1]||""}return"\n"+N+e}var q=!1;function H(e,t){if(!e||q)return"";q=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),"object"===typeof Reflect&&Reflect.construct){try{Reflect.construct(t,[])}catch(c){var n=c}Reflect.construct(e,[],t)}else{try{t.call()}catch(c){n=c}e.call(t.prototype)}else{try{throw Error()}catch(c){n=c}e()}}catch(c){if(c&&n&&"string"===typeof c.stack){for(var i=c.stack.split("\n"),a=n.stack.split("\n"),o=i.length-1,s=a.length-1;1<=o&&0<=s&&i[o]!==a[s];)s--;for(;1<=o&&0<=s;o--,s--)if(i[o]!==a[s]){if(1!==o||1!==s)do{if(o--,0>--s||i[o]!==a[s])return"\n"+i[o].replace(" at new "," at ")}while(1<=o&&0<=s);break}}}finally{q=!1,Error.prepareStackTrace=r}return(e=e?e.displayName||e.name:"")?G(e):""}function W(e){switch(e.tag){case 5:return G(e.type);case 16:return G("Lazy");case 13:return G("Suspense");case 19:return G("SuspenseList");case 0:case 2:case 15:return e=H(e.type,!1);case 11:return e=H(e.type.render,!1);case 22:return e=H(e.type._render,!1);case 1:return e=H(e.type,!0);default:return""}}function Q(e){if(null==e)return null;if("function"===typeof e)return e.displayName||e.name||null;if("string"===typeof e)return e;switch(e){case x:return"Fragment";case w:return"Portal";case S:return"Profiler";case k:return"StrictMode";case P:return"Suspense";case A:return"SuspenseList"}if("object"===typeof e)switch(e.$$typeof){case C:return(e.displayName||"Context")+".Consumer";case T:return(e._context.displayName||"Context")+".Provider";case M:var t=e.render;return t=t.displayName||t.name||"",e.displayName||(""!==t?"ForwardRef("+t+")":"ForwardRef");case E:return Q(e.type);case I:return Q(e._render);case R:t=e._payload,e=e._init;try{return Q(e(t))}catch(r){}}return null}function Z(e){switch(typeof e){case"boolean":case"number":case"object":case"string":case"undefined":return e;default:return""}}function X(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function Y(e){e._valueTracker||(e._valueTracker=function(e){var t=X(e)?"checked":"value",r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),n=""+e[t];if(!e.hasOwnProperty(t)&&"undefined"!==typeof r&&"function"===typeof r.get&&"function"===typeof r.set){var i=r.get,a=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return i.call(this)},set:function(e){n=""+e,a.call(this,e)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(e){n=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e))}function $(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),n="";return e&&(n=X(e)?e.checked?"true":"false":e.value),(e=n)!==r&&(t.setValue(e),!0)}function J(e){if("undefined"===typeof(e=e||("undefined"!==typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}function K(e,t){var r=t.checked;return i({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=r?r:e._wrapperState.initialChecked})}function ee(e,t){var r=null==t.defaultValue?"":t.defaultValue,n=null!=t.checked?t.checked:t.defaultChecked;r=Z(null!=t.value?t.value:r),e._wrapperState={initialChecked:n,initialValue:r,controlled:"checkbox"===t.type||"radio"===t.type?null!=t.checked:null!=t.value}}function te(e,t){null!=(t=t.checked)&&O(e,"checked",t,!1)}function re(e,t){te(e,t);var r=Z(t.value),n=t.type;if(null!=r)"number"===n?(0===r&&""===e.value||e.value!=r)&&(e.value=""+r):e.value!==""+r&&(e.value=""+r);else if("submit"===n||"reset"===n)return void e.removeAttribute("value");t.hasOwnProperty("value")?ie(e,t.type,r):t.hasOwnProperty("defaultValue")&&ie(e,t.type,Z(t.defaultValue)),null==t.checked&&null!=t.defaultChecked&&(e.defaultChecked=!!t.defaultChecked)}function ne(e,t,r){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var n=t.type;if(!("submit"!==n&&"reset"!==n||void 0!==t.value&&null!==t.value))return;t=""+e._wrapperState.initialValue,r||t===e.value||(e.value=t),e.defaultValue=t}""!==(r=e.name)&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,""!==r&&(e.name=r)}function ie(e,t,r){"number"===t&&J(e.ownerDocument)===e||(null==r?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+r&&(e.defaultValue=""+r))}function ae(e,t){return e=i({children:void 0},t),(t=function(e){var t="";return n.Children.forEach(e,(function(e){null!=e&&(t+=e)})),t}(t.children))&&(e.children=t),e}function oe(e,t,r,n){if(e=e.options,t){t={};for(var i=0;i<r.length;i++)t["$"+r[i]]=!0;for(r=0;r<e.length;r++)i=t.hasOwnProperty("$"+e[r].value),e[r].selected!==i&&(e[r].selected=i),i&&n&&(e[r].defaultSelected=!0)}else{for(r=""+Z(r),t=null,i=0;i<e.length;i++){if(e[i].value===r)return e[i].selected=!0,void(n&&(e[i].defaultSelected=!0));null!==t||e[i].disabled||(t=e[i])}null!==t&&(t.selected=!0)}}function se(e,t){if(null!=t.dangerouslySetInnerHTML)throw Error(o(91));return i({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function ce(e,t){var r=t.value;if(null==r){if(r=t.children,t=t.defaultValue,null!=r){if(null!=t)throw Error(o(92));if(Array.isArray(r)){if(!(1>=r.length))throw Error(o(93));r=r[0]}t=r}null==t&&(t=""),r=t}e._wrapperState={initialValue:Z(r)}}function le(e,t){var r=Z(t.value),n=Z(t.defaultValue);null!=r&&((r=""+r)!==e.value&&(e.value=r),null==t.defaultValue&&e.defaultValue!==r&&(e.defaultValue=r)),null!=n&&(e.defaultValue=""+n)}function ue(e){var t=e.textContent;t===e._wrapperState.initialValue&&""!==t&&null!==t&&(e.value=t)}var de="http://www.w3.org/1999/xhtml",he="http://www.w3.org/2000/svg";function fe(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function pe(e,t){return null==e||"http://www.w3.org/1999/xhtml"===e?fe(t):"http://www.w3.org/2000/svg"===e&&"foreignObject"===t?"http://www.w3.org/1999/xhtml":e}var be,ve,me=(ve=function(e,t){if(e.namespaceURI!==he||"innerHTML"in e)e.innerHTML=t;else{for((be=be||document.createElement("div")).innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=be.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}},"undefined"!==typeof MSApp&&MSApp.execUnsafeLocalFunction?function(e,t,r,n){MSApp.execUnsafeLocalFunction((function(){return ve(e,t)}))}:ve);function ye(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&3===r.nodeType)return void(r.nodeValue=t)}e.textContent=t}var ge={animationIterationCount:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Oe=["Webkit","ms","Moz","O"];function je(e,t,r){return null==t||"boolean"===typeof t||""===t?"":r||"number"!==typeof t||0===t||ge.hasOwnProperty(e)&&ge[e]?(""+t).trim():t+"px"}function _e(e,t){for(var r in e=e.style,t)if(t.hasOwnProperty(r)){var n=0===r.indexOf("--"),i=je(r,t[r],n);"float"===r&&(r="cssFloat"),n?e.setProperty(r,i):e[r]=i}}Object.keys(ge).forEach((function(e){Oe.forEach((function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),ge[t]=ge[e]}))}));var we=i({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function xe(e,t){if(t){if(we[e]&&(null!=t.children||null!=t.dangerouslySetInnerHTML))throw Error(o(137,e));if(null!=t.dangerouslySetInnerHTML){if(null!=t.children)throw Error(o(60));if("object"!==typeof t.dangerouslySetInnerHTML||!("__html"in t.dangerouslySetInnerHTML))throw Error(o(61))}if(null!=t.style&&"object"!==typeof t.style)throw Error(o(62))}}function ke(e,t){if(-1===e.indexOf("-"))return"string"===typeof t.is;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}function Se(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var Te=null,Ce=null,Me=null;function Pe(e){if(e=ei(e)){if("function"!==typeof Te)throw Error(o(280));var t=e.stateNode;t&&(t=ri(t),Te(e.stateNode,e.type,t))}}function Ae(e){Ce?Me?Me.push(e):Me=[e]:Ce=e}function Ee(){if(Ce){var e=Ce,t=Me;if(Me=Ce=null,Pe(e),t)for(e=0;e<t.length;e++)Pe(t[e])}}function Re(e,t){return e(t)}function Ie(e,t,r,n,i){return e(t,r,n,i)}function De(){}var Fe=Re,Le=!1,ze=!1;function Ve(){null===Ce&&null===Me||(De(),Ee())}function Ne(e,t){var r=e.stateNode;if(null===r)return null;var n=ri(r);if(null===n)return null;r=n[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(n=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!n;break e;default:e=!1}if(e)return null;if(r&&"function"!==typeof r)throw Error(o(231,t,typeof r));return r}var Ue=!1;if(d)try{var Be={};Object.defineProperty(Be,"passive",{get:function(){Ue=!0}}),window.addEventListener("test",Be,Be),window.removeEventListener("test",Be,Be)}catch(ve){Ue=!1}function Ge(e,t,r,n,i,a,o,s,c){var l=Array.prototype.slice.call(arguments,3);try{t.apply(r,l)}catch(u){this.onError(u)}}var qe=!1,He=null,We=!1,Qe=null,Ze={onError:function(e){qe=!0,He=e}};function Xe(e,t,r,n,i,a,o,s,c){qe=!1,He=null,Ge.apply(Ze,arguments)}function Ye(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{0!==(1026&(t=e).flags)&&(r=t.return),e=t.return}while(e)}return 3===t.tag?r:null}function $e(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function Je(e){if(Ye(e)!==e)throw Error(o(188))}function Ke(e){if(!(e=function(e){var t=e.alternate;if(!t){if(null===(t=Ye(e)))throw Error(o(188));return t!==e?null:e}for(var r=e,n=t;;){var i=r.return;if(null===i)break;var a=i.alternate;if(null===a){if(null!==(n=i.return)){r=n;continue}break}if(i.child===a.child){for(a=i.child;a;){if(a===r)return Je(i),e;if(a===n)return Je(i),t;a=a.sibling}throw Error(o(188))}if(r.return!==n.return)r=i,n=a;else{for(var s=!1,c=i.child;c;){if(c===r){s=!0,r=i,n=a;break}if(c===n){s=!0,n=i,r=a;break}c=c.sibling}if(!s){for(c=a.child;c;){if(c===r){s=!0,r=a,n=i;break}if(c===n){s=!0,n=a,r=i;break}c=c.sibling}if(!s)throw Error(o(189))}}if(r.alternate!==n)throw Error(o(190))}if(3!==r.tag)throw Error(o(188));return r.stateNode.current===r?e:t}(e)))return null;for(var t=e;;){if(5===t.tag||6===t.tag)return t;if(t.child)t.child.return=t,t=t.child;else{if(t===e)break;for(;!t.sibling;){if(!t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}}return null}function et(e,t){for(var r=e.alternate;null!==t;){if(t===e||t===r)return!0;t=t.return}return!1}var tt,rt,nt,it,at=!1,ot=[],st=null,ct=null,lt=null,ut=new Map,dt=new Map,ht=[],ft="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function pt(e,t,r,n,i){return{blockedOn:e,domEventName:t,eventSystemFlags:16|r,nativeEvent:i,targetContainers:[n]}}function bt(e,t){switch(e){case"focusin":case"focusout":st=null;break;case"dragenter":case"dragleave":ct=null;break;case"mouseover":case"mouseout":lt=null;break;case"pointerover":case"pointerout":ut.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":dt.delete(t.pointerId)}}function vt(e,t,r,n,i,a){return null===e||e.nativeEvent!==a?(e=pt(t,r,n,i,a),null!==t&&(null!==(t=ei(t))&&rt(t)),e):(e.eventSystemFlags|=n,t=e.targetContainers,null!==i&&-1===t.indexOf(i)&&t.push(i),e)}function mt(e){var t=Kn(e.target);if(null!==t){var r=Ye(t);if(null!==r)if(13===(t=r.tag)){if(null!==(t=$e(r)))return e.blockedOn=t,void it(e.lanePriority,(function(){a.unstable_runWithPriority(e.priority,(function(){nt(r)}))}))}else if(3===t&&r.stateNode.hydrate)return void(e.blockedOn=3===r.tag?r.stateNode.containerInfo:null)}e.blockedOn=null}function yt(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var r=Kt(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(null!==r)return null!==(t=ei(r))&&rt(t),e.blockedOn=r,!1;t.shift()}return!0}function gt(e,t,r){yt(e)&&r.delete(t)}function Ot(){for(at=!1;0<ot.length;){var e=ot[0];if(null!==e.blockedOn){null!==(e=ei(e.blockedOn))&&tt(e);break}for(var t=e.targetContainers;0<t.length;){var r=Kt(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(null!==r){e.blockedOn=r;break}t.shift()}null===e.blockedOn&&ot.shift()}null!==st&&yt(st)&&(st=null),null!==ct&&yt(ct)&&(ct=null),null!==lt&&yt(lt)&&(lt=null),ut.forEach(gt),dt.forEach(gt)}function jt(e,t){e.blockedOn===t&&(e.blockedOn=null,at||(at=!0,a.unstable_scheduleCallback(a.unstable_NormalPriority,Ot)))}function _t(e){function t(t){return jt(t,e)}if(0<ot.length){jt(ot[0],e);for(var r=1;r<ot.length;r++){var n=ot[r];n.blockedOn===e&&(n.blockedOn=null)}}for(null!==st&&jt(st,e),null!==ct&&jt(ct,e),null!==lt&&jt(lt,e),ut.forEach(t),dt.forEach(t),r=0;r<ht.length;r++)(n=ht[r]).blockedOn===e&&(n.blockedOn=null);for(;0<ht.length&&null===(r=ht[0]).blockedOn;)mt(r),null===r.blockedOn&&ht.shift()}function wt(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}var xt={animationend:wt("Animation","AnimationEnd"),animationiteration:wt("Animation","AnimationIteration"),animationstart:wt("Animation","AnimationStart"),transitionend:wt("Transition","TransitionEnd")},kt={},St={};function Tt(e){if(kt[e])return kt[e];if(!xt[e])return e;var t,r=xt[e];for(t in r)if(r.hasOwnProperty(t)&&t in St)return kt[e]=r[t];return e}d&&(St=document.createElement("div").style,"AnimationEvent"in window||(delete xt.animationend.animation,delete xt.animationiteration.animation,delete xt.animationstart.animation),"TransitionEvent"in window||delete xt.transitionend.transition);var Ct=Tt("animationend"),Mt=Tt("animationiteration"),Pt=Tt("animationstart"),At=Tt("transitionend"),Et=new Map,Rt=new Map,It=["abort","abort",Ct,"animationEnd",Mt,"animationIteration",Pt,"animationStart","canplay","canPlay","canplaythrough","canPlayThrough","durationchange","durationChange","emptied","emptied","encrypted","encrypted","ended","ended","error","error","gotpointercapture","gotPointerCapture","load","load","loadeddata","loadedData","loadedmetadata","loadedMetadata","loadstart","loadStart","lostpointercapture","lostPointerCapture","playing","playing","progress","progress","seeking","seeking","stalled","stalled","suspend","suspend","timeupdate","timeUpdate",At,"transitionEnd","waiting","waiting"];function Dt(e,t){for(var r=0;r<e.length;r+=2){var n=e[r],i=e[r+1];i="on"+(i[0].toUpperCase()+i.slice(1)),Rt.set(n,t),Et.set(n,i),l(i,[n])}}(0,a.unstable_now)();var Ft=8;function Lt(e){if(0!==(1&e))return Ft=15,1;if(0!==(2&e))return Ft=14,2;if(0!==(4&e))return Ft=13,4;var t=24&e;return 0!==t?(Ft=12,t):0!==(32&e)?(Ft=11,32):0!==(t=192&e)?(Ft=10,t):0!==(256&e)?(Ft=9,256):0!==(t=3584&e)?(Ft=8,t):0!==(4096&e)?(Ft=7,4096):0!==(t=4186112&e)?(Ft=6,t):0!==(t=62914560&e)?(Ft=5,t):67108864&e?(Ft=4,67108864):0!==(134217728&e)?(Ft=3,134217728):0!==(t=805306368&e)?(Ft=2,t):0!==(1073741824&e)?(Ft=1,1073741824):(Ft=8,e)}function zt(e,t){var r=e.pendingLanes;if(0===r)return Ft=0;var n=0,i=0,a=e.expiredLanes,o=e.suspendedLanes,s=e.pingedLanes;if(0!==a)n=a,i=Ft=15;else if(0!==(a=134217727&r)){var c=a&~o;0!==c?(n=Lt(c),i=Ft):0!==(s&=a)&&(n=Lt(s),i=Ft)}else 0!==(a=r&~o)?(n=Lt(a),i=Ft):0!==s&&(n=Lt(s),i=Ft);if(0===n)return 0;if(n=r&((0>(n=31-qt(n))?0:1<<n)<<1)-1,0!==t&&t!==n&&0===(t&o)){if(Lt(t),i<=Ft)return t;Ft=i}if(0!==(t=e.entangledLanes))for(e=e.entanglements,t&=n;0<t;)i=1<<(r=31-qt(t)),n|=e[r],t&=~i;return n}function Vt(e){return 0!==(e=-1073741825&e.pendingLanes)?e:1073741824&e?1073741824:0}function Nt(e,t){switch(e){case 15:return 1;case 14:return 2;case 12:return 0===(e=Ut(24&~t))?Nt(10,t):e;case 10:return 0===(e=Ut(192&~t))?Nt(8,t):e;case 8:return 0===(e=Ut(3584&~t))&&(0===(e=Ut(4186112&~t))&&(e=512)),e;case 2:return 0===(t=Ut(805306368&~t))&&(t=268435456),t}throw Error(o(358,e))}function Ut(e){return e&-e}function Bt(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function Gt(e,t,r){e.pendingLanes|=t;var n=t-1;e.suspendedLanes&=n,e.pingedLanes&=n,(e=e.eventTimes)[t=31-qt(t)]=r}var qt=Math.clz32?Math.clz32:function(e){return 0===e?32:31-(Ht(e)/Wt|0)|0},Ht=Math.log,Wt=Math.LN2;var Qt=a.unstable_UserBlockingPriority,Zt=a.unstable_runWithPriority,Xt=!0;function Yt(e,t,r,n){Le||De();var i=Jt,a=Le;Le=!0;try{Ie(i,e,t,r,n)}finally{(Le=a)||Ve()}}function $t(e,t,r,n){Zt(Qt,Jt.bind(null,e,t,r,n))}function Jt(e,t,r,n){var i;if(Xt)if((i=0===(4&t))&&0<ot.length&&-1<ft.indexOf(e))e=pt(null,e,t,r,n),ot.push(e);else{var a=Kt(e,t,r,n);if(null===a)i&&bt(e,n);else{if(i){if(-1<ft.indexOf(e))return e=pt(a,e,t,r,n),void ot.push(e);if(function(e,t,r,n,i){switch(t){case"focusin":return st=vt(st,e,t,r,n,i),!0;case"dragenter":return ct=vt(ct,e,t,r,n,i),!0;case"mouseover":return lt=vt(lt,e,t,r,n,i),!0;case"pointerover":var a=i.pointerId;return ut.set(a,vt(ut.get(a)||null,e,t,r,n,i)),!0;case"gotpointercapture":return a=i.pointerId,dt.set(a,vt(dt.get(a)||null,e,t,r,n,i)),!0}return!1}(a,e,t,r,n))return;bt(e,n)}En(e,t,n,null,r)}}}function Kt(e,t,r,n){var i=Se(n);if(null!==(i=Kn(i))){var a=Ye(i);if(null===a)i=null;else{var o=a.tag;if(13===o){if(null!==(i=$e(a)))return i;i=null}else if(3===o){if(a.stateNode.hydrate)return 3===a.tag?a.stateNode.containerInfo:null;i=null}else a!==i&&(i=null)}}return En(e,t,n,i,r),null}var er=null,tr=null,rr=null;function nr(){if(rr)return rr;var e,t,r=tr,n=r.length,i="value"in er?er.value:er.textContent,a=i.length;for(e=0;e<n&&r[e]===i[e];e++);var o=n-e;for(t=1;t<=o&&r[n-t]===i[a-t];t++);return rr=i.slice(e,1<t?1-t:void 0)}function ir(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function ar(){return!0}function or(){return!1}function sr(e){function t(t,r,n,i,a){for(var o in this._reactName=t,this._targetInst=n,this.type=r,this.nativeEvent=i,this.target=a,this.currentTarget=null,e)e.hasOwnProperty(o)&&(t=e[o],this[o]=t?t(i):i[o]);return this.isDefaultPrevented=(null!=i.defaultPrevented?i.defaultPrevented:!1===i.returnValue)?ar:or,this.isPropagationStopped=or,this}return i(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!==typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=ar)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!==typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=ar)},persist:function(){},isPersistent:ar}),t}var cr,lr,ur,dr={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},hr=sr(dr),fr=i({},dr,{view:0,detail:0}),pr=sr(fr),br=i({},fr,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Sr,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==ur&&(ur&&"mousemove"===e.type?(cr=e.screenX-ur.screenX,lr=e.screenY-ur.screenY):lr=cr=0,ur=e),cr)},movementY:function(e){return"movementY"in e?e.movementY:lr}}),vr=sr(br),mr=sr(i({},br,{dataTransfer:0})),yr=sr(i({},fr,{relatedTarget:0})),gr=sr(i({},dr,{animationName:0,elapsedTime:0,pseudoElement:0})),Or=sr(i({},dr,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}})),jr=sr(i({},dr,{data:0})),_r={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},wr={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},xr={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function kr(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=xr[e])&&!!t[e]}function Sr(){return kr}var Tr=sr(i({},fr,{key:function(e){if(e.key){var t=_r[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=ir(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?wr[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Sr,charCode:function(e){return"keypress"===e.type?ir(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?ir(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}})),Cr=sr(i({},br,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),Mr=sr(i({},fr,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Sr})),Pr=sr(i({},dr,{propertyName:0,elapsedTime:0,pseudoElement:0})),Ar=sr(i({},br,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0})),Er=[9,13,27,32],Rr=d&&"CompositionEvent"in window,Ir=null;d&&"documentMode"in document&&(Ir=document.documentMode);var Dr=d&&"TextEvent"in window&&!Ir,Fr=d&&(!Rr||Ir&&8<Ir&&11>=Ir),Lr=String.fromCharCode(32),zr=!1;function Vr(e,t){switch(e){case"keyup":return-1!==Er.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Nr(e){return"object"===typeof(e=e.detail)&&"data"in e?e.data:null}var Ur=!1;var Br={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Gr(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!Br[e.type]:"textarea"===t}function qr(e,t,r,n){Ae(n),0<(t=In(t,"onChange")).length&&(r=new hr("onChange","change",null,r,n),e.push({event:r,listeners:t}))}var Hr=null,Wr=null;function Qr(e){Sn(e,0)}function Zr(e){if($(ti(e)))return e}function Xr(e,t){if("change"===e)return t}var Yr=!1;if(d){var $r;if(d){var Jr="oninput"in document;if(!Jr){var Kr=document.createElement("div");Kr.setAttribute("oninput","return;"),Jr="function"===typeof Kr.oninput}$r=Jr}else $r=!1;Yr=$r&&(!document.documentMode||9<document.documentMode)}function en(){Hr&&(Hr.detachEvent("onpropertychange",tn),Wr=Hr=null)}function tn(e){if("value"===e.propertyName&&Zr(Wr)){var t=[];if(qr(t,Wr,e,Se(e)),e=Qr,Le)e(t);else{Le=!0;try{Re(e,t)}finally{Le=!1,Ve()}}}}function rn(e,t,r){"focusin"===e?(en(),Wr=r,(Hr=t).attachEvent("onpropertychange",tn)):"focusout"===e&&en()}function nn(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return Zr(Wr)}function an(e,t){if("click"===e)return Zr(t)}function on(e,t){if("input"===e||"change"===e)return Zr(t)}var sn="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t},cn=Object.prototype.hasOwnProperty;function ln(e,t){if(sn(e,t))return!0;if("object"!==typeof e||null===e||"object"!==typeof t||null===t)return!1;var r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++)if(!cn.call(t,r[n])||!sn(e[r[n]],t[r[n]]))return!1;return!0}function un(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function dn(e,t){var r,n=un(e);for(e=0;n;){if(3===n.nodeType){if(r=e+n.textContent.length,e<=t&&r>=t)return{node:n,offset:t-e};e=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=un(n)}}function hn(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?hn(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function fn(){for(var e=window,t=J();t instanceof e.HTMLIFrameElement;){try{var r="string"===typeof t.contentWindow.location.href}catch(n){r=!1}if(!r)break;t=J((e=t.contentWindow).document)}return t}function pn(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}var bn=d&&"documentMode"in document&&11>=document.documentMode,vn=null,mn=null,yn=null,gn=!1;function On(e,t,r){var n=r.window===r?r.document:9===r.nodeType?r:r.ownerDocument;gn||null==vn||vn!==J(n)||("selectionStart"in(n=vn)&&pn(n)?n={start:n.selectionStart,end:n.selectionEnd}:n={anchorNode:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset},yn&&ln(yn,n)||(yn=n,0<(n=In(mn,"onSelect")).length&&(t=new hr("onSelect","select",null,t,r),e.push({event:t,listeners:n}),t.target=vn)))}Dt("cancel cancel click click close close contextmenu contextMenu copy copy cut cut auxclick auxClick dblclick doubleClick dragend dragEnd dragstart dragStart drop drop focusin focus focusout blur input input invalid invalid keydown keyDown keypress keyPress keyup keyUp mousedown mouseDown mouseup mouseUp paste paste pause pause play play pointercancel pointerCancel pointerdown pointerDown pointerup pointerUp ratechange rateChange reset reset seeked seeked submit submit touchcancel touchCancel touchend touchEnd touchstart touchStart volumechange volumeChange".split(" "),0),Dt("drag drag dragenter dragEnter dragexit dragExit dragleave dragLeave dragover dragOver mousemove mouseMove mouseout mouseOut mouseover mouseOver pointermove pointerMove pointerout pointerOut pointerover pointerOver scroll scroll toggle toggle touchmove touchMove wheel wheel".split(" "),1),Dt(It,2);for(var jn="change selectionchange textInput compositionstart compositionend compositionupdate".split(" "),_n=0;_n<jn.length;_n++)Rt.set(jn[_n],0);u("onMouseEnter",["mouseout","mouseover"]),u("onMouseLeave",["mouseout","mouseover"]),u("onPointerEnter",["pointerout","pointerover"]),u("onPointerLeave",["pointerout","pointerover"]),l("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),l("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),l("onBeforeInput",["compositionend","keypress","textInput","paste"]),l("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var wn="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),xn=new Set("cancel close invalid load scroll toggle".split(" ").concat(wn));function kn(e,t,r){var n=e.type||"unknown-event";e.currentTarget=r,function(e,t,r,n,i,a,s,c,l){if(Xe.apply(this,arguments),qe){if(!qe)throw Error(o(198));var u=He;qe=!1,He=null,We||(We=!0,Qe=u)}}(n,t,void 0,e),e.currentTarget=null}function Sn(e,t){t=0!==(4&t);for(var r=0;r<e.length;r++){var n=e[r],i=n.event;n=n.listeners;e:{var a=void 0;if(t)for(var o=n.length-1;0<=o;o--){var s=n[o],c=s.instance,l=s.currentTarget;if(s=s.listener,c!==a&&i.isPropagationStopped())break e;kn(i,s,l),a=c}else for(o=0;o<n.length;o++){if(c=(s=n[o]).instance,l=s.currentTarget,s=s.listener,c!==a&&i.isPropagationStopped())break e;kn(i,s,l),a=c}}}if(We)throw e=Qe,We=!1,Qe=null,e}function Tn(e,t){var r=ni(t),n=e+"__bubble";r.has(n)||(An(t,e,2,!1),r.add(n))}var Cn="_reactListening"+Math.random().toString(36).slice(2);function Mn(e){e[Cn]||(e[Cn]=!0,s.forEach((function(t){xn.has(t)||Pn(t,!1,e,null),Pn(t,!0,e,null)})))}function Pn(e,t,r,n){var i=4<arguments.length&&void 0!==arguments[4]?arguments[4]:0,a=r;if("selectionchange"===e&&9!==r.nodeType&&(a=r.ownerDocument),null!==n&&!t&&xn.has(e)){if("scroll"!==e)return;i|=2,a=n}var o=ni(a),s=e+"__"+(t?"capture":"bubble");o.has(s)||(t&&(i|=4),An(a,e,i,t),o.add(s))}function An(e,t,r,n){var i=Rt.get(t);switch(void 0===i?2:i){case 0:i=Yt;break;case 1:i=$t;break;default:i=Jt}r=i.bind(null,t,r,e),i=void 0,!Ue||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(i=!0),n?void 0!==i?e.addEventListener(t,r,{capture:!0,passive:i}):e.addEventListener(t,r,!0):void 0!==i?e.addEventListener(t,r,{passive:i}):e.addEventListener(t,r,!1)}function En(e,t,r,n,i){var a=n;if(0===(1&t)&&0===(2&t)&&null!==n)e:for(;;){if(null===n)return;var o=n.tag;if(3===o||4===o){var s=n.stateNode.containerInfo;if(s===i||8===s.nodeType&&s.parentNode===i)break;if(4===o)for(o=n.return;null!==o;){var c=o.tag;if((3===c||4===c)&&((c=o.stateNode.containerInfo)===i||8===c.nodeType&&c.parentNode===i))return;o=o.return}for(;null!==s;){if(null===(o=Kn(s)))return;if(5===(c=o.tag)||6===c){n=a=o;continue e}s=s.parentNode}}n=n.return}!function(e,t,r){if(ze)return e(t,r);ze=!0;try{Fe(e,t,r)}finally{ze=!1,Ve()}}((function(){var n=a,i=Se(r),o=[];e:{var s=Et.get(e);if(void 0!==s){var c=hr,l=e;switch(e){case"keypress":if(0===ir(r))break e;case"keydown":case"keyup":c=Tr;break;case"focusin":l="focus",c=yr;break;case"focusout":l="blur",c=yr;break;case"beforeblur":case"afterblur":c=yr;break;case"click":if(2===r.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":c=vr;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":c=mr;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":c=Mr;break;case Ct:case Mt:case Pt:c=gr;break;case At:c=Pr;break;case"scroll":c=pr;break;case"wheel":c=Ar;break;case"copy":case"cut":case"paste":c=Or;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":c=Cr}var u=0!==(4&t),d=!u&&"scroll"===e,h=u?null!==s?s+"Capture":null:s;u=[];for(var f,p=n;null!==p;){var b=(f=p).stateNode;if(5===f.tag&&null!==b&&(f=b,null!==h&&(null!=(b=Ne(p,h))&&u.push(Rn(p,b,f)))),d)break;p=p.return}0<u.length&&(s=new c(s,l,null,r,i),o.push({event:s,listeners:u}))}}if(0===(7&t)){if(c="mouseout"===e||"pointerout"===e,(!(s="mouseover"===e||"pointerover"===e)||0!==(16&t)||!(l=r.relatedTarget||r.fromElement)||!Kn(l)&&!l[$n])&&(c||s)&&(s=i.window===i?i:(s=i.ownerDocument)?s.defaultView||s.parentWindow:window,c?(c=n,null!==(l=(l=r.relatedTarget||r.toElement)?Kn(l):null)&&(l!==(d=Ye(l))||5!==l.tag&&6!==l.tag)&&(l=null)):(c=null,l=n),c!==l)){if(u=vr,b="onMouseLeave",h="onMouseEnter",p="mouse","pointerout"!==e&&"pointerover"!==e||(u=Cr,b="onPointerLeave",h="onPointerEnter",p="pointer"),d=null==c?s:ti(c),f=null==l?s:ti(l),(s=new u(b,p+"leave",c,r,i)).target=d,s.relatedTarget=f,b=null,Kn(i)===n&&((u=new u(h,p+"enter",l,r,i)).target=f,u.relatedTarget=d,b=u),d=b,c&&l)e:{for(h=l,p=0,f=u=c;f;f=Dn(f))p++;for(f=0,b=h;b;b=Dn(b))f++;for(;0<p-f;)u=Dn(u),p--;for(;0<f-p;)h=Dn(h),f--;for(;p--;){if(u===h||null!==h&&u===h.alternate)break e;u=Dn(u),h=Dn(h)}u=null}else u=null;null!==c&&Fn(o,s,c,u,!1),null!==l&&null!==d&&Fn(o,d,l,u,!0)}if("select"===(c=(s=n?ti(n):window).nodeName&&s.nodeName.toLowerCase())||"input"===c&&"file"===s.type)var v=Xr;else if(Gr(s))if(Yr)v=on;else{v=nn;var m=rn}else(c=s.nodeName)&&"input"===c.toLowerCase()&&("checkbox"===s.type||"radio"===s.type)&&(v=an);switch(v&&(v=v(e,n))?qr(o,v,r,i):(m&&m(e,s,n),"focusout"===e&&(m=s._wrapperState)&&m.controlled&&"number"===s.type&&ie(s,"number",s.value)),m=n?ti(n):window,e){case"focusin":(Gr(m)||"true"===m.contentEditable)&&(vn=m,mn=n,yn=null);break;case"focusout":yn=mn=vn=null;break;case"mousedown":gn=!0;break;case"contextmenu":case"mouseup":case"dragend":gn=!1,On(o,r,i);break;case"selectionchange":if(bn)break;case"keydown":case"keyup":On(o,r,i)}var y;if(Rr)e:{switch(e){case"compositionstart":var g="onCompositionStart";break e;case"compositionend":g="onCompositionEnd";break e;case"compositionupdate":g="onCompositionUpdate";break e}g=void 0}else Ur?Vr(e,r)&&(g="onCompositionEnd"):"keydown"===e&&229===r.keyCode&&(g="onCompositionStart");g&&(Fr&&"ko"!==r.locale&&(Ur||"onCompositionStart"!==g?"onCompositionEnd"===g&&Ur&&(y=nr()):(tr="value"in(er=i)?er.value:er.textContent,Ur=!0)),0<(m=In(n,g)).length&&(g=new jr(g,e,null,r,i),o.push({event:g,listeners:m}),y?g.data=y:null!==(y=Nr(r))&&(g.data=y))),(y=Dr?function(e,t){switch(e){case"compositionend":return Nr(t);case"keypress":return 32!==t.which?null:(zr=!0,Lr);case"textInput":return(e=t.data)===Lr&&zr?null:e;default:return null}}(e,r):function(e,t){if(Ur)return"compositionend"===e||!Rr&&Vr(e,t)?(e=nr(),rr=tr=er=null,Ur=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Fr&&"ko"!==t.locale?null:t.data;default:return null}}(e,r))&&(0<(n=In(n,"onBeforeInput")).length&&(i=new jr("onBeforeInput","beforeinput",null,r,i),o.push({event:i,listeners:n}),i.data=y))}Sn(o,t)}))}function Rn(e,t,r){return{instance:e,listener:t,currentTarget:r}}function In(e,t){for(var r=t+"Capture",n=[];null!==e;){var i=e,a=i.stateNode;5===i.tag&&null!==a&&(i=a,null!=(a=Ne(e,r))&&n.unshift(Rn(e,a,i)),null!=(a=Ne(e,t))&&n.push(Rn(e,a,i))),e=e.return}return n}function Dn(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag);return e||null}function Fn(e,t,r,n,i){for(var a=t._reactName,o=[];null!==r&&r!==n;){var s=r,c=s.alternate,l=s.stateNode;if(null!==c&&c===n)break;5===s.tag&&null!==l&&(s=l,i?null!=(c=Ne(r,a))&&o.unshift(Rn(r,c,s)):i||null!=(c=Ne(r,a))&&o.push(Rn(r,c,s))),r=r.return}0!==o.length&&e.push({event:t,listeners:o})}function Ln(){}var zn=null,Vn=null;function Nn(e,t){switch(e){case"button":case"input":case"select":case"textarea":return!!t.autoFocus}return!1}function Un(e,t){return"textarea"===e||"option"===e||"noscript"===e||"string"===typeof t.children||"number"===typeof t.children||"object"===typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var Bn="function"===typeof setTimeout?setTimeout:void 0,Gn="function"===typeof clearTimeout?clearTimeout:void 0;function qn(e){1===e.nodeType?e.textContent="":9===e.nodeType&&(null!=(e=e.body)&&(e.textContent=""))}function Hn(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break}return e}function Wn(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var r=e.data;if("$"===r||"$!"===r||"$?"===r){if(0===t)return e;t--}else"/$"===r&&t++}e=e.previousSibling}return null}var Qn=0;var Zn=Math.random().toString(36).slice(2),Xn="__reactFiber$"+Zn,Yn="__reactProps$"+Zn,$n="__reactContainer$"+Zn,Jn="__reactEvents$"+Zn;function Kn(e){var t=e[Xn];if(t)return t;for(var r=e.parentNode;r;){if(t=r[$n]||r[Xn]){if(r=t.alternate,null!==t.child||null!==r&&null!==r.child)for(e=Wn(e);null!==e;){if(r=e[Xn])return r;e=Wn(e)}return t}r=(e=r).parentNode}return null}function ei(e){return!(e=e[Xn]||e[$n])||5!==e.tag&&6!==e.tag&&13!==e.tag&&3!==e.tag?null:e}function ti(e){if(5===e.tag||6===e.tag)return e.stateNode;throw Error(o(33))}function ri(e){return e[Yn]||null}function ni(e){var t=e[Jn];return void 0===t&&(t=e[Jn]=new Set),t}var ii=[],ai=-1;function oi(e){return{current:e}}function si(e){0>ai||(e.current=ii[ai],ii[ai]=null,ai--)}function ci(e,t){ai++,ii[ai]=e.current,e.current=t}var li={},ui=oi(li),di=oi(!1),hi=li;function fi(e,t){var r=e.type.contextTypes;if(!r)return li;var n=e.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===t)return n.__reactInternalMemoizedMaskedChildContext;var i,a={};for(i in r)a[i]=t[i];return n&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=a),a}function pi(e){return null!==(e=e.childContextTypes)&&void 0!==e}function bi(){si(di),si(ui)}function vi(e,t,r){if(ui.current!==li)throw Error(o(168));ci(ui,t),ci(di,r)}function mi(e,t,r){var n=e.stateNode;if(e=t.childContextTypes,"function"!==typeof n.getChildContext)return r;for(var a in n=n.getChildContext())if(!(a in e))throw Error(o(108,Q(t)||"Unknown",a));return i({},r,n)}function yi(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||li,hi=ui.current,ci(ui,e),ci(di,di.current),!0}function gi(e,t,r){var n=e.stateNode;if(!n)throw Error(o(169));r?(e=mi(e,t,hi),n.__reactInternalMemoizedMergedChildContext=e,si(di),si(ui),ci(ui,e)):si(di),ci(di,r)}var Oi=null,ji=null,_i=a.unstable_runWithPriority,wi=a.unstable_scheduleCallback,xi=a.unstable_cancelCallback,ki=a.unstable_shouldYield,Si=a.unstable_requestPaint,Ti=a.unstable_now,Ci=a.unstable_getCurrentPriorityLevel,Mi=a.unstable_ImmediatePriority,Pi=a.unstable_UserBlockingPriority,Ai=a.unstable_NormalPriority,Ei=a.unstable_LowPriority,Ri=a.unstable_IdlePriority,Ii={},Di=void 0!==Si?Si:function(){},Fi=null,Li=null,zi=!1,Vi=Ti(),Ni=1e4>Vi?Ti:function(){return Ti()-Vi};function Ui(){switch(Ci()){case Mi:return 99;case Pi:return 98;case Ai:return 97;case Ei:return 96;case Ri:return 95;default:throw Error(o(332))}}function Bi(e){switch(e){case 99:return Mi;case 98:return Pi;case 97:return Ai;case 96:return Ei;case 95:return Ri;default:throw Error(o(332))}}function Gi(e,t){return e=Bi(e),_i(e,t)}function qi(e,t,r){return e=Bi(e),wi(e,t,r)}function Hi(){if(null!==Li){var e=Li;Li=null,xi(e)}Wi()}function Wi(){if(!zi&&null!==Fi){zi=!0;var e=0;try{var t=Fi;Gi(99,(function(){for(;e<t.length;e++){var r=t[e];do{r=r(!0)}while(null!==r)}})),Fi=null}catch(r){throw null!==Fi&&(Fi=Fi.slice(e+1)),wi(Mi,Hi),r}finally{zi=!1}}}var Qi=j.ReactCurrentBatchConfig;function Zi(e,t){if(e&&e.defaultProps){for(var r in t=i({},t),e=e.defaultProps)void 0===t[r]&&(t[r]=e[r]);return t}return t}var Xi=oi(null),Yi=null,$i=null,Ji=null;function Ki(){Ji=$i=Yi=null}function ea(e){var t=Xi.current;si(Xi),e.type._context._currentValue=t}function ta(e,t){for(;null!==e;){var r=e.alternate;if((e.childLanes&t)===t){if(null===r||(r.childLanes&t)===t)break;r.childLanes|=t}else e.childLanes|=t,null!==r&&(r.childLanes|=t);e=e.return}}function ra(e,t){Yi=e,Ji=$i=null,null!==(e=e.dependencies)&&null!==e.firstContext&&(0!==(e.lanes&t)&&(Io=!0),e.firstContext=null)}function na(e,t){if(Ji!==e&&!1!==t&&0!==t)if("number"===typeof t&&1073741823!==t||(Ji=e,t=1073741823),t={context:e,observedBits:t,next:null},null===$i){if(null===Yi)throw Error(o(308));$i=t,Yi.dependencies={lanes:0,firstContext:t,responders:null}}else $i=$i.next=t;return e._currentValue}var ia=!1;function aa(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null},effects:null}}function oa(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function sa(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function ca(e,t){if(null!==(e=e.updateQueue)){var r=(e=e.shared).pending;null===r?t.next=t:(t.next=r.next,r.next=t),e.pending=t}}function la(e,t){var r=e.updateQueue,n=e.alternate;if(null!==n&&r===(n=n.updateQueue)){var i=null,a=null;if(null!==(r=r.firstBaseUpdate)){do{var o={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};null===a?i=a=o:a=a.next=o,r=r.next}while(null!==r);null===a?i=a=t:a=a.next=t}else i=a=t;return r={baseState:n.baseState,firstBaseUpdate:i,lastBaseUpdate:a,shared:n.shared,effects:n.effects},void(e.updateQueue=r)}null===(e=r.lastBaseUpdate)?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}function ua(e,t,r,n){var a=e.updateQueue;ia=!1;var o=a.firstBaseUpdate,s=a.lastBaseUpdate,c=a.shared.pending;if(null!==c){a.shared.pending=null;var l=c,u=l.next;l.next=null,null===s?o=u:s.next=u,s=l;var d=e.alternate;if(null!==d){var h=(d=d.updateQueue).lastBaseUpdate;h!==s&&(null===h?d.firstBaseUpdate=u:h.next=u,d.lastBaseUpdate=l)}}if(null!==o){for(h=a.baseState,s=0,d=u=l=null;;){c=o.lane;var f=o.eventTime;if((n&c)===c){null!==d&&(d=d.next={eventTime:f,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var p=e,b=o;switch(c=t,f=r,b.tag){case 1:if("function"===typeof(p=b.payload)){h=p.call(f,h,c);break e}h=p;break e;case 3:p.flags=-4097&p.flags|64;case 0:if(null===(c="function"===typeof(p=b.payload)?p.call(f,h,c):p)||void 0===c)break e;h=i({},h,c);break e;case 2:ia=!0}}null!==o.callback&&(e.flags|=32,null===(c=a.effects)?a.effects=[o]:c.push(o))}else f={eventTime:f,lane:c,tag:o.tag,payload:o.payload,callback:o.callback,next:null},null===d?(u=d=f,l=h):d=d.next=f,s|=c;if(null===(o=o.next)){if(null===(c=a.shared.pending))break;o=c.next,c.next=null,a.lastBaseUpdate=c,a.shared.pending=null}}null===d&&(l=h),a.baseState=l,a.firstBaseUpdate=u,a.lastBaseUpdate=d,zs|=s,e.lanes=s,e.memoizedState=h}}function da(e,t,r){if(e=t.effects,t.effects=null,null!==e)for(t=0;t<e.length;t++){var n=e[t],i=n.callback;if(null!==i){if(n.callback=null,n=r,"function"!==typeof i)throw Error(o(191,i));i.call(n)}}}var ha=(new n.Component).refs;function fa(e,t,r,n){r=null===(r=r(n,t=e.memoizedState))||void 0===r?t:i({},t,r),e.memoizedState=r,0===e.lanes&&(e.updateQueue.baseState=r)}var pa={isMounted:function(e){return!!(e=e._reactInternals)&&Ye(e)===e},enqueueSetState:function(e,t,r){e=e._reactInternals;var n=lc(),i=uc(e),a=sa(n,i);a.payload=t,void 0!==r&&null!==r&&(a.callback=r),ca(e,a),dc(e,i,n)},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var n=lc(),i=uc(e),a=sa(n,i);a.tag=1,a.payload=t,void 0!==r&&null!==r&&(a.callback=r),ca(e,a),dc(e,i,n)},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=lc(),n=uc(e),i=sa(r,n);i.tag=2,void 0!==t&&null!==t&&(i.callback=t),ca(e,i),dc(e,n,r)}};function ba(e,t,r,n,i,a,o){return"function"===typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(n,a,o):!t.prototype||!t.prototype.isPureReactComponent||(!ln(r,n)||!ln(i,a))}function va(e,t,r){var n=!1,i=li,a=t.contextType;return"object"===typeof a&&null!==a?a=na(a):(i=pi(t)?hi:ui.current,a=(n=null!==(n=t.contextTypes)&&void 0!==n)?fi(e,i):li),t=new t(r,a),e.memoizedState=null!==t.state&&void 0!==t.state?t.state:null,t.updater=pa,e.stateNode=t,t._reactInternals=e,n&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=i,e.__reactInternalMemoizedMaskedChildContext=a),t}function ma(e,t,r,n){e=t.state,"function"===typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(r,n),"function"===typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(r,n),t.state!==e&&pa.enqueueReplaceState(t,t.state,null)}function ya(e,t,r,n){var i=e.stateNode;i.props=r,i.state=e.memoizedState,i.refs=ha,aa(e);var a=t.contextType;"object"===typeof a&&null!==a?i.context=na(a):(a=pi(t)?hi:ui.current,i.context=fi(e,a)),ua(e,r,i,n),i.state=e.memoizedState,"function"===typeof(a=t.getDerivedStateFromProps)&&(fa(e,t,a,r),i.state=e.memoizedState),"function"===typeof t.getDerivedStateFromProps||"function"===typeof i.getSnapshotBeforeUpdate||"function"!==typeof i.UNSAFE_componentWillMount&&"function"!==typeof i.componentWillMount||(t=i.state,"function"===typeof i.componentWillMount&&i.componentWillMount(),"function"===typeof i.UNSAFE_componentWillMount&&i.UNSAFE_componentWillMount(),t!==i.state&&pa.enqueueReplaceState(i,i.state,null),ua(e,r,i,n),i.state=e.memoizedState),"function"===typeof i.componentDidMount&&(e.flags|=4)}var ga=Array.isArray;function Oa(e,t,r){if(null!==(e=r.ref)&&"function"!==typeof e&&"object"!==typeof e){if(r._owner){if(r=r._owner){if(1!==r.tag)throw Error(o(309));var n=r.stateNode}if(!n)throw Error(o(147,e));var i=""+e;return null!==t&&null!==t.ref&&"function"===typeof t.ref&&t.ref._stringRef===i?t.ref:((t=function(e){var t=n.refs;t===ha&&(t=n.refs={}),null===e?delete t[i]:t[i]=e})._stringRef=i,t)}if("string"!==typeof e)throw Error(o(284));if(!r._owner)throw Error(o(290,e))}return e}function ja(e,t){if("textarea"!==e.type)throw Error(o(31,"[object Object]"===Object.prototype.toString.call(t)?"object with keys {"+Object.keys(t).join(", ")+"}":t))}function _a(e){function t(t,r){if(e){var n=t.lastEffect;null!==n?(n.nextEffect=r,t.lastEffect=r):t.firstEffect=t.lastEffect=r,r.nextEffect=null,r.flags=8}}function r(r,n){if(!e)return null;for(;null!==n;)t(r,n),n=n.sibling;return null}function n(e,t){for(e=new Map;null!==t;)null!==t.key?e.set(t.key,t):e.set(t.index,t),t=t.sibling;return e}function i(e,t){return(e=Gc(e,t)).index=0,e.sibling=null,e}function a(t,r,n){return t.index=n,e?null!==(n=t.alternate)?(n=n.index)<r?(t.flags=2,r):n:(t.flags=2,r):r}function s(t){return e&&null===t.alternate&&(t.flags=2),t}function c(e,t,r,n){return null===t||6!==t.tag?((t=Qc(r,e.mode,n)).return=e,t):((t=i(t,r)).return=e,t)}function l(e,t,r,n){return null!==t&&t.elementType===r.type?((n=i(t,r.props)).ref=Oa(e,t,r),n.return=e,n):((n=qc(r.type,r.key,r.props,null,e.mode,n)).ref=Oa(e,t,r),n.return=e,n)}function u(e,t,r,n){return null===t||4!==t.tag||t.stateNode.containerInfo!==r.containerInfo||t.stateNode.implementation!==r.implementation?((t=Zc(r,e.mode,n)).return=e,t):((t=i(t,r.children||[])).return=e,t)}function d(e,t,r,n,a){return null===t||7!==t.tag?((t=Hc(r,e.mode,n,a)).return=e,t):((t=i(t,r)).return=e,t)}function h(e,t,r){if("string"===typeof t||"number"===typeof t)return(t=Qc(""+t,e.mode,r)).return=e,t;if("object"===typeof t&&null!==t){switch(t.$$typeof){case _:return(r=qc(t.type,t.key,t.props,null,e.mode,r)).ref=Oa(e,null,t),r.return=e,r;case w:return(t=Zc(t,e.mode,r)).return=e,t}if(ga(t)||B(t))return(t=Hc(t,e.mode,r,null)).return=e,t;ja(e,t)}return null}function f(e,t,r,n){var i=null!==t?t.key:null;if("string"===typeof r||"number"===typeof r)return null!==i?null:c(e,t,""+r,n);if("object"===typeof r&&null!==r){switch(r.$$typeof){case _:return r.key===i?r.type===x?d(e,t,r.props.children,n,i):l(e,t,r,n):null;case w:return r.key===i?u(e,t,r,n):null}if(ga(r)||B(r))return null!==i?null:d(e,t,r,n,null);ja(e,r)}return null}function p(e,t,r,n,i){if("string"===typeof n||"number"===typeof n)return c(t,e=e.get(r)||null,""+n,i);if("object"===typeof n&&null!==n){switch(n.$$typeof){case _:return e=e.get(null===n.key?r:n.key)||null,n.type===x?d(t,e,n.props.children,i,n.key):l(t,e,n,i);case w:return u(t,e=e.get(null===n.key?r:n.key)||null,n,i)}if(ga(n)||B(n))return d(t,e=e.get(r)||null,n,i,null);ja(t,n)}return null}function b(i,o,s,c){for(var l=null,u=null,d=o,b=o=0,v=null;null!==d&&b<s.length;b++){d.index>b?(v=d,d=null):v=d.sibling;var m=f(i,d,s[b],c);if(null===m){null===d&&(d=v);break}e&&d&&null===m.alternate&&t(i,d),o=a(m,o,b),null===u?l=m:u.sibling=m,u=m,d=v}if(b===s.length)return r(i,d),l;if(null===d){for(;b<s.length;b++)null!==(d=h(i,s[b],c))&&(o=a(d,o,b),null===u?l=d:u.sibling=d,u=d);return l}for(d=n(i,d);b<s.length;b++)null!==(v=p(d,i,b,s[b],c))&&(e&&null!==v.alternate&&d.delete(null===v.key?b:v.key),o=a(v,o,b),null===u?l=v:u.sibling=v,u=v);return e&&d.forEach((function(e){return t(i,e)})),l}function v(i,s,c,l){var u=B(c);if("function"!==typeof u)throw Error(o(150));if(null==(c=u.call(c)))throw Error(o(151));for(var d=u=null,b=s,v=s=0,m=null,y=c.next();null!==b&&!y.done;v++,y=c.next()){b.index>v?(m=b,b=null):m=b.sibling;var g=f(i,b,y.value,l);if(null===g){null===b&&(b=m);break}e&&b&&null===g.alternate&&t(i,b),s=a(g,s,v),null===d?u=g:d.sibling=g,d=g,b=m}if(y.done)return r(i,b),u;if(null===b){for(;!y.done;v++,y=c.next())null!==(y=h(i,y.value,l))&&(s=a(y,s,v),null===d?u=y:d.sibling=y,d=y);return u}for(b=n(i,b);!y.done;v++,y=c.next())null!==(y=p(b,i,v,y.value,l))&&(e&&null!==y.alternate&&b.delete(null===y.key?v:y.key),s=a(y,s,v),null===d?u=y:d.sibling=y,d=y);return e&&b.forEach((function(e){return t(i,e)})),u}return function(e,n,a,c){var l="object"===typeof a&&null!==a&&a.type===x&&null===a.key;l&&(a=a.props.children);var u="object"===typeof a&&null!==a;if(u)switch(a.$$typeof){case _:e:{for(u=a.key,l=n;null!==l;){if(l.key===u){switch(l.tag){case 7:if(a.type===x){r(e,l.sibling),(n=i(l,a.props.children)).return=e,e=n;break e}break;default:if(l.elementType===a.type){r(e,l.sibling),(n=i(l,a.props)).ref=Oa(e,l,a),n.return=e,e=n;break e}}r(e,l);break}t(e,l),l=l.sibling}a.type===x?((n=Hc(a.props.children,e.mode,c,a.key)).return=e,e=n):((c=qc(a.type,a.key,a.props,null,e.mode,c)).ref=Oa(e,n,a),c.return=e,e=c)}return s(e);case w:e:{for(l=a.key;null!==n;){if(n.key===l){if(4===n.tag&&n.stateNode.containerInfo===a.containerInfo&&n.stateNode.implementation===a.implementation){r(e,n.sibling),(n=i(n,a.children||[])).return=e,e=n;break e}r(e,n);break}t(e,n),n=n.sibling}(n=Zc(a,e.mode,c)).return=e,e=n}return s(e)}if("string"===typeof a||"number"===typeof a)return a=""+a,null!==n&&6===n.tag?(r(e,n.sibling),(n=i(n,a)).return=e,e=n):(r(e,n),(n=Qc(a,e.mode,c)).return=e,e=n),s(e);if(ga(a))return b(e,n,a,c);if(B(a))return v(e,n,a,c);if(u&&ja(e,a),"undefined"===typeof a&&!l)switch(e.tag){case 1:case 22:case 0:case 11:case 15:throw Error(o(152,Q(e.type)||"Component"))}return r(e,n)}}var wa=_a(!0),xa=_a(!1),ka={},Sa=oi(ka),Ta=oi(ka),Ca=oi(ka);function Ma(e){if(e===ka)throw Error(o(174));return e}function Pa(e,t){switch(ci(Ca,t),ci(Ta,e),ci(Sa,ka),e=t.nodeType){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:pe(null,"");break;default:t=pe(t=(e=8===e?t.parentNode:t).namespaceURI||null,e=e.tagName)}si(Sa),ci(Sa,t)}function Aa(){si(Sa),si(Ta),si(Ca)}function Ea(e){Ma(Ca.current);var t=Ma(Sa.current),r=pe(t,e.type);t!==r&&(ci(Ta,e),ci(Sa,r))}function Ra(e){Ta.current===e&&(si(Sa),si(Ta))}var Ia=oi(0);function Da(e){for(var t=e;null!==t;){if(13===t.tag){var r=t.memoizedState;if(null!==r&&(null===(r=r.dehydrated)||"$?"===r.data||"$!"===r.data))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(0!==(64&t.flags))return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var Fa=null,La=null,za=!1;function Va(e,t){var r=Uc(5,null,null,0);r.elementType="DELETED",r.type="DELETED",r.stateNode=t,r.return=e,r.flags=8,null!==e.lastEffect?(e.lastEffect.nextEffect=r,e.lastEffect=r):e.firstEffect=e.lastEffect=r}function Na(e,t){switch(e.tag){case 5:var r=e.type;return null!==(t=1!==t.nodeType||r.toLowerCase()!==t.nodeName.toLowerCase()?null:t)&&(e.stateNode=t,!0);case 6:return null!==(t=""===e.pendingProps||3!==t.nodeType?null:t)&&(e.stateNode=t,!0);case 13:default:return!1}}function Ua(e){if(za){var t=La;if(t){var r=t;if(!Na(e,t)){if(!(t=Hn(r.nextSibling))||!Na(e,t))return e.flags=-1025&e.flags|2,za=!1,void(Fa=e);Va(Fa,r)}Fa=e,La=Hn(t.firstChild)}else e.flags=-1025&e.flags|2,za=!1,Fa=e}}function Ba(e){for(e=e.return;null!==e&&5!==e.tag&&3!==e.tag&&13!==e.tag;)e=e.return;Fa=e}function Ga(e){if(e!==Fa)return!1;if(!za)return Ba(e),za=!0,!1;var t=e.type;if(5!==e.tag||"head"!==t&&"body"!==t&&!Un(t,e.memoizedProps))for(t=La;t;)Va(e,t),t=Hn(t.nextSibling);if(Ba(e),13===e.tag){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(o(317));e:{for(e=e.nextSibling,t=0;e;){if(8===e.nodeType){var r=e.data;if("/$"===r){if(0===t){La=Hn(e.nextSibling);break e}t--}else"$"!==r&&"$!"!==r&&"$?"!==r||t++}e=e.nextSibling}La=null}}else La=Fa?Hn(e.stateNode.nextSibling):null;return!0}function qa(){La=Fa=null,za=!1}var Ha=[];function Wa(){for(var e=0;e<Ha.length;e++)Ha[e]._workInProgressVersionPrimary=null;Ha.length=0}var Qa=j.ReactCurrentDispatcher,Za=j.ReactCurrentBatchConfig,Xa=0,Ya=null,$a=null,Ja=null,Ka=!1,eo=!1;function to(){throw Error(o(321))}function ro(e,t){if(null===t)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!sn(e[r],t[r]))return!1;return!0}function no(e,t,r,n,i,a){if(Xa=a,Ya=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,Qa.current=null===e||null===e.memoizedState?Po:Ao,e=r(n,i),eo){a=0;do{if(eo=!1,!(25>a))throw Error(o(301));a+=1,Ja=$a=null,t.updateQueue=null,Qa.current=Eo,e=r(n,i)}while(eo)}if(Qa.current=Mo,t=null!==$a&&null!==$a.next,Xa=0,Ja=$a=Ya=null,Ka=!1,t)throw Error(o(300));return e}function io(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===Ja?Ya.memoizedState=Ja=e:Ja=Ja.next=e,Ja}function ao(){if(null===$a){var e=Ya.alternate;e=null!==e?e.memoizedState:null}else e=$a.next;var t=null===Ja?Ya.memoizedState:Ja.next;if(null!==t)Ja=t,$a=e;else{if(null===e)throw Error(o(310));e={memoizedState:($a=e).memoizedState,baseState:$a.baseState,baseQueue:$a.baseQueue,queue:$a.queue,next:null},null===Ja?Ya.memoizedState=Ja=e:Ja=Ja.next=e}return Ja}function oo(e,t){return"function"===typeof t?t(e):t}function so(e){var t=ao(),r=t.queue;if(null===r)throw Error(o(311));r.lastRenderedReducer=e;var n=$a,i=n.baseQueue,a=r.pending;if(null!==a){if(null!==i){var s=i.next;i.next=a.next,a.next=s}n.baseQueue=i=a,r.pending=null}if(null!==i){i=i.next,n=n.baseState;var c=s=a=null,l=i;do{var u=l.lane;if((Xa&u)===u)null!==c&&(c=c.next={lane:0,action:l.action,eagerReducer:l.eagerReducer,eagerState:l.eagerState,next:null}),n=l.eagerReducer===e?l.eagerState:e(n,l.action);else{var d={lane:u,action:l.action,eagerReducer:l.eagerReducer,eagerState:l.eagerState,next:null};null===c?(s=c=d,a=n):c=c.next=d,Ya.lanes|=u,zs|=u}l=l.next}while(null!==l&&l!==i);null===c?a=n:c.next=s,sn(n,t.memoizedState)||(Io=!0),t.memoizedState=n,t.baseState=a,t.baseQueue=c,r.lastRenderedState=n}return[t.memoizedState,r.dispatch]}function co(e){var t=ao(),r=t.queue;if(null===r)throw Error(o(311));r.lastRenderedReducer=e;var n=r.dispatch,i=r.pending,a=t.memoizedState;if(null!==i){r.pending=null;var s=i=i.next;do{a=e(a,s.action),s=s.next}while(s!==i);sn(a,t.memoizedState)||(Io=!0),t.memoizedState=a,null===t.baseQueue&&(t.baseState=a),r.lastRenderedState=a}return[a,n]}function lo(e,t,r){var n=t._getVersion;n=n(t._source);var i=t._workInProgressVersionPrimary;if(null!==i?e=i===n:(e=e.mutableReadLanes,(e=(Xa&e)===e)&&(t._workInProgressVersionPrimary=n,Ha.push(t))),e)return r(t._source);throw Ha.push(t),Error(o(350))}function uo(e,t,r,n){var i=Ps;if(null===i)throw Error(o(349));var a=t._getVersion,s=a(t._source),c=Qa.current,l=c.useState((function(){return lo(i,t,r)})),u=l[1],d=l[0];l=Ja;var h=e.memoizedState,f=h.refs,p=f.getSnapshot,b=h.source;h=h.subscribe;var v=Ya;return e.memoizedState={refs:f,source:t,subscribe:n},c.useEffect((function(){f.getSnapshot=r,f.setSnapshot=u;var e=a(t._source);if(!sn(s,e)){e=r(t._source),sn(d,e)||(u(e),e=uc(v),i.mutableReadLanes|=e&i.pendingLanes),e=i.mutableReadLanes,i.entangledLanes|=e;for(var n=i.entanglements,o=e;0<o;){var c=31-qt(o),l=1<<c;n[c]|=e,o&=~l}}}),[r,t,n]),c.useEffect((function(){return n(t._source,(function(){var e=f.getSnapshot,r=f.setSnapshot;try{r(e(t._source));var n=uc(v);i.mutableReadLanes|=n&i.pendingLanes}catch(a){r((function(){throw a}))}}))}),[t,n]),sn(p,r)&&sn(b,t)&&sn(h,n)||((e={pending:null,dispatch:null,lastRenderedReducer:oo,lastRenderedState:d}).dispatch=u=Co.bind(null,Ya,e),l.queue=e,l.baseQueue=null,d=lo(i,t,r),l.memoizedState=l.baseState=d),d}function ho(e,t,r){return uo(ao(),e,t,r)}function fo(e){var t=io();return"function"===typeof e&&(e=e()),t.memoizedState=t.baseState=e,e=(e=t.queue={pending:null,dispatch:null,lastRenderedReducer:oo,lastRenderedState:e}).dispatch=Co.bind(null,Ya,e),[t.memoizedState,e]}function po(e,t,r,n){return e={tag:e,create:t,destroy:r,deps:n,next:null},null===(t=Ya.updateQueue)?(t={lastEffect:null},Ya.updateQueue=t,t.lastEffect=e.next=e):null===(r=t.lastEffect)?t.lastEffect=e.next=e:(n=r.next,r.next=e,e.next=n,t.lastEffect=e),e}function bo(e){return e={current:e},io().memoizedState=e}function vo(){return ao().memoizedState}function mo(e,t,r,n){var i=io();Ya.flags|=e,i.memoizedState=po(1|t,r,void 0,void 0===n?null:n)}function yo(e,t,r,n){var i=ao();n=void 0===n?null:n;var a=void 0;if(null!==$a){var o=$a.memoizedState;if(a=o.destroy,null!==n&&ro(n,o.deps))return void po(t,r,a,n)}Ya.flags|=e,i.memoizedState=po(1|t,r,a,n)}function go(e,t){return mo(516,4,e,t)}function Oo(e,t){return yo(516,4,e,t)}function jo(e,t){return yo(4,2,e,t)}function _o(e,t){return"function"===typeof t?(e=e(),t(e),function(){t(null)}):null!==t&&void 0!==t?(e=e(),t.current=e,function(){t.current=null}):void 0}function wo(e,t,r){return r=null!==r&&void 0!==r?r.concat([e]):null,yo(4,2,_o.bind(null,t,e),r)}function xo(){}function ko(e,t){var r=ao();t=void 0===t?null:t;var n=r.memoizedState;return null!==n&&null!==t&&ro(t,n[1])?n[0]:(r.memoizedState=[e,t],e)}function So(e,t){var r=ao();t=void 0===t?null:t;var n=r.memoizedState;return null!==n&&null!==t&&ro(t,n[1])?n[0]:(e=e(),r.memoizedState=[e,t],e)}function To(e,t){var r=Ui();Gi(98>r?98:r,(function(){e(!0)})),Gi(97<r?97:r,(function(){var r=Za.transition;Za.transition=1;try{e(!1),t()}finally{Za.transition=r}}))}function Co(e,t,r){var n=lc(),i=uc(e),a={lane:i,action:r,eagerReducer:null,eagerState:null,next:null},o=t.pending;if(null===o?a.next=a:(a.next=o.next,o.next=a),t.pending=a,o=e.alternate,e===Ya||null!==o&&o===Ya)eo=Ka=!0;else{if(0===e.lanes&&(null===o||0===o.lanes)&&null!==(o=t.lastRenderedReducer))try{var s=t.lastRenderedState,c=o(s,r);if(a.eagerReducer=o,a.eagerState=c,sn(c,s))return}catch(l){}dc(e,i,n)}}var Mo={readContext:na,useCallback:to,useContext:to,useEffect:to,useImperativeHandle:to,useLayoutEffect:to,useMemo:to,useReducer:to,useRef:to,useState:to,useDebugValue:to,useDeferredValue:to,useTransition:to,useMutableSource:to,useOpaqueIdentifier:to,unstable_isNewReconciler:!1},Po={readContext:na,useCallback:function(e,t){return io().memoizedState=[e,void 0===t?null:t],e},useContext:na,useEffect:go,useImperativeHandle:function(e,t,r){return r=null!==r&&void 0!==r?r.concat([e]):null,mo(4,2,_o.bind(null,t,e),r)},useLayoutEffect:function(e,t){return mo(4,2,e,t)},useMemo:function(e,t){var r=io();return t=void 0===t?null:t,e=e(),r.memoizedState=[e,t],e},useReducer:function(e,t,r){var n=io();return t=void 0!==r?r(t):t,n.memoizedState=n.baseState=t,e=(e=n.queue={pending:null,dispatch:null,lastRenderedReducer:e,lastRenderedState:t}).dispatch=Co.bind(null,Ya,e),[n.memoizedState,e]},useRef:bo,useState:fo,useDebugValue:xo,useDeferredValue:function(e){var t=fo(e),r=t[0],n=t[1];return go((function(){var t=Za.transition;Za.transition=1;try{n(e)}finally{Za.transition=t}}),[e]),r},useTransition:function(){var e=fo(!1),t=e[0];return bo(e=To.bind(null,e[1])),[e,t]},useMutableSource:function(e,t,r){var n=io();return n.memoizedState={refs:{getSnapshot:t,setSnapshot:null},source:e,subscribe:r},uo(n,e,t,r)},useOpaqueIdentifier:function(){if(za){var e=!1,t=function(e){return{$$typeof:D,toString:e,valueOf:e}}((function(){throw e||(e=!0,r("r:"+(Qn++).toString(36))),Error(o(355))})),r=fo(t)[1];return 0===(2&Ya.mode)&&(Ya.flags|=516,po(5,(function(){r("r:"+(Qn++).toString(36))}),void 0,null)),t}return fo(t="r:"+(Qn++).toString(36)),t},unstable_isNewReconciler:!1},Ao={readContext:na,useCallback:ko,useContext:na,useEffect:Oo,useImperativeHandle:wo,useLayoutEffect:jo,useMemo:So,useReducer:so,useRef:vo,useState:function(){return so(oo)},useDebugValue:xo,useDeferredValue:function(e){var t=so(oo),r=t[0],n=t[1];return Oo((function(){var t=Za.transition;Za.transition=1;try{n(e)}finally{Za.transition=t}}),[e]),r},useTransition:function(){var e=so(oo)[0];return[vo().current,e]},useMutableSource:ho,useOpaqueIdentifier:function(){return so(oo)[0]},unstable_isNewReconciler:!1},Eo={readContext:na,useCallback:ko,useContext:na,useEffect:Oo,useImperativeHandle:wo,useLayoutEffect:jo,useMemo:So,useReducer:co,useRef:vo,useState:function(){return co(oo)},useDebugValue:xo,useDeferredValue:function(e){var t=co(oo),r=t[0],n=t[1];return Oo((function(){var t=Za.transition;Za.transition=1;try{n(e)}finally{Za.transition=t}}),[e]),r},useTransition:function(){var e=co(oo)[0];return[vo().current,e]},useMutableSource:ho,useOpaqueIdentifier:function(){return co(oo)[0]},unstable_isNewReconciler:!1},Ro=j.ReactCurrentOwner,Io=!1;function Do(e,t,r,n){t.child=null===e?xa(t,null,r,n):wa(t,e.child,r,n)}function Fo(e,t,r,n,i){r=r.render;var a=t.ref;return ra(t,i),n=no(e,t,r,n,a,i),null===e||Io?(t.flags|=1,Do(e,t,n,i),t.child):(t.updateQueue=e.updateQueue,t.flags&=-517,e.lanes&=~i,rs(e,t,i))}function Lo(e,t,r,n,i,a){if(null===e){var o=r.type;return"function"!==typeof o||Bc(o)||void 0!==o.defaultProps||null!==r.compare||void 0!==r.defaultProps?((e=qc(r.type,null,n,t,t.mode,a)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=o,zo(e,t,o,n,i,a))}return o=e.child,0===(i&a)&&(i=o.memoizedProps,(r=null!==(r=r.compare)?r:ln)(i,n)&&e.ref===t.ref)?rs(e,t,a):(t.flags|=1,(e=Gc(o,n)).ref=t.ref,e.return=t,t.child=e)}function zo(e,t,r,n,i,a){if(null!==e&&ln(e.memoizedProps,n)&&e.ref===t.ref){if(Io=!1,0===(a&i))return t.lanes=e.lanes,rs(e,t,a);0!==(16384&e.flags)&&(Io=!0)}return Uo(e,t,r,n,a)}function Vo(e,t,r){var n=t.pendingProps,i=n.children,a=null!==e?e.memoizedState:null;if("hidden"===n.mode||"unstable-defer-without-hiding"===n.mode)if(0===(4&t.mode))t.memoizedState={baseLanes:0},gc(t,r);else{if(0===(1073741824&r))return e=null!==a?a.baseLanes|r:r,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e},gc(t,e),null;t.memoizedState={baseLanes:0},gc(t,null!==a?a.baseLanes:r)}else null!==a?(n=a.baseLanes|r,t.memoizedState=null):n=r,gc(t,n);return Do(e,t,i,r),t.child}function No(e,t){var r=t.ref;(null===e&&null!==r||null!==e&&e.ref!==r)&&(t.flags|=128)}function Uo(e,t,r,n,i){var a=pi(r)?hi:ui.current;return a=fi(t,a),ra(t,i),r=no(e,t,r,n,a,i),null===e||Io?(t.flags|=1,Do(e,t,r,i),t.child):(t.updateQueue=e.updateQueue,t.flags&=-517,e.lanes&=~i,rs(e,t,i))}function Bo(e,t,r,n,i){if(pi(r)){var a=!0;yi(t)}else a=!1;if(ra(t,i),null===t.stateNode)null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2),va(t,r,n),ya(t,r,n,i),n=!0;else if(null===e){var o=t.stateNode,s=t.memoizedProps;o.props=s;var c=o.context,l=r.contextType;"object"===typeof l&&null!==l?l=na(l):l=fi(t,l=pi(r)?hi:ui.current);var u=r.getDerivedStateFromProps,d="function"===typeof u||"function"===typeof o.getSnapshotBeforeUpdate;d||"function"!==typeof o.UNSAFE_componentWillReceiveProps&&"function"!==typeof o.componentWillReceiveProps||(s!==n||c!==l)&&ma(t,o,n,l),ia=!1;var h=t.memoizedState;o.state=h,ua(t,n,o,i),c=t.memoizedState,s!==n||h!==c||di.current||ia?("function"===typeof u&&(fa(t,r,u,n),c=t.memoizedState),(s=ia||ba(t,r,s,n,h,c,l))?(d||"function"!==typeof o.UNSAFE_componentWillMount&&"function"!==typeof o.componentWillMount||("function"===typeof o.componentWillMount&&o.componentWillMount(),"function"===typeof o.UNSAFE_componentWillMount&&o.UNSAFE_componentWillMount()),"function"===typeof o.componentDidMount&&(t.flags|=4)):("function"===typeof o.componentDidMount&&(t.flags|=4),t.memoizedProps=n,t.memoizedState=c),o.props=n,o.state=c,o.context=l,n=s):("function"===typeof o.componentDidMount&&(t.flags|=4),n=!1)}else{o=t.stateNode,oa(e,t),s=t.memoizedProps,l=t.type===t.elementType?s:Zi(t.type,s),o.props=l,d=t.pendingProps,h=o.context,"object"===typeof(c=r.contextType)&&null!==c?c=na(c):c=fi(t,c=pi(r)?hi:ui.current);var f=r.getDerivedStateFromProps;(u="function"===typeof f||"function"===typeof o.getSnapshotBeforeUpdate)||"function"!==typeof o.UNSAFE_componentWillReceiveProps&&"function"!==typeof o.componentWillReceiveProps||(s!==d||h!==c)&&ma(t,o,n,c),ia=!1,h=t.memoizedState,o.state=h,ua(t,n,o,i);var p=t.memoizedState;s!==d||h!==p||di.current||ia?("function"===typeof f&&(fa(t,r,f,n),p=t.memoizedState),(l=ia||ba(t,r,l,n,h,p,c))?(u||"function"!==typeof o.UNSAFE_componentWillUpdate&&"function"!==typeof o.componentWillUpdate||("function"===typeof o.componentWillUpdate&&o.componentWillUpdate(n,p,c),"function"===typeof o.UNSAFE_componentWillUpdate&&o.UNSAFE_componentWillUpdate(n,p,c)),"function"===typeof o.componentDidUpdate&&(t.flags|=4),"function"===typeof o.getSnapshotBeforeUpdate&&(t.flags|=256)):("function"!==typeof o.componentDidUpdate||s===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!==typeof o.getSnapshotBeforeUpdate||s===e.memoizedProps&&h===e.memoizedState||(t.flags|=256),t.memoizedProps=n,t.memoizedState=p),o.props=n,o.state=p,o.context=c,n=l):("function"!==typeof o.componentDidUpdate||s===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!==typeof o.getSnapshotBeforeUpdate||s===e.memoizedProps&&h===e.memoizedState||(t.flags|=256),n=!1)}return Go(e,t,r,n,a,i)}function Go(e,t,r,n,i,a){No(e,t);var o=0!==(64&t.flags);if(!n&&!o)return i&&gi(t,r,!1),rs(e,t,a);n=t.stateNode,Ro.current=t;var s=o&&"function"!==typeof r.getDerivedStateFromError?null:n.render();return t.flags|=1,null!==e&&o?(t.child=wa(t,e.child,null,a),t.child=wa(t,null,s,a)):Do(e,t,s,a),t.memoizedState=n.state,i&&gi(t,r,!0),t.child}function qo(e){var t=e.stateNode;t.pendingContext?vi(0,t.pendingContext,t.pendingContext!==t.context):t.context&&vi(0,t.context,!1),Pa(e,t.containerInfo)}var Ho,Wo,Qo,Zo={dehydrated:null,retryLane:0};function Xo(e,t,r){var n,i=t.pendingProps,a=Ia.current,o=!1;return(n=0!==(64&t.flags))||(n=(null===e||null!==e.memoizedState)&&0!==(2&a)),n?(o=!0,t.flags&=-65):null!==e&&null===e.memoizedState||void 0===i.fallback||!0===i.unstable_avoidThisFallback||(a|=1),ci(Ia,1&a),null===e?(void 0!==i.fallback&&Ua(t),e=i.children,a=i.fallback,o?(e=Yo(t,e,a,r),t.child.memoizedState={baseLanes:r},t.memoizedState=Zo,e):"number"===typeof i.unstable_expectedLoadTime?(e=Yo(t,e,a,r),t.child.memoizedState={baseLanes:r},t.memoizedState=Zo,t.lanes=33554432,e):((r=Wc({mode:"visible",children:e},t.mode,r,null)).return=t,t.child=r)):(e.memoizedState,o?(i=Jo(e,t,i.children,i.fallback,r),o=t.child,a=e.child.memoizedState,o.memoizedState=null===a?{baseLanes:r}:{baseLanes:a.baseLanes|r},o.childLanes=e.childLanes&~r,t.memoizedState=Zo,i):(r=$o(e,t,i.children,r),t.memoizedState=null,r))}function Yo(e,t,r,n){var i=e.mode,a=e.child;return t={mode:"hidden",children:t},0===(2&i)&&null!==a?(a.childLanes=0,a.pendingProps=t):a=Wc(t,i,0,null),r=Hc(r,i,n,null),a.return=e,r.return=e,a.sibling=r,e.child=a,r}function $o(e,t,r,n){var i=e.child;return e=i.sibling,r=Gc(i,{mode:"visible",children:r}),0===(2&t.mode)&&(r.lanes=n),r.return=t,r.sibling=null,null!==e&&(e.nextEffect=null,e.flags=8,t.firstEffect=t.lastEffect=e),t.child=r}function Jo(e,t,r,n,i){var a=t.mode,o=e.child;e=o.sibling;var s={mode:"hidden",children:r};return 0===(2&a)&&t.child!==o?((r=t.child).childLanes=0,r.pendingProps=s,null!==(o=r.lastEffect)?(t.firstEffect=r.firstEffect,t.lastEffect=o,o.nextEffect=null):t.firstEffect=t.lastEffect=null):r=Gc(o,s),null!==e?n=Gc(e,n):(n=Hc(n,a,i,null)).flags|=2,n.return=t,r.return=t,r.sibling=n,t.child=r,n}function Ko(e,t){e.lanes|=t;var r=e.alternate;null!==r&&(r.lanes|=t),ta(e.return,t)}function es(e,t,r,n,i,a){var o=e.memoizedState;null===o?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:i,lastEffect:a}:(o.isBackwards=t,o.rendering=null,o.renderingStartTime=0,o.last=n,o.tail=r,o.tailMode=i,o.lastEffect=a)}function ts(e,t,r){var n=t.pendingProps,i=n.revealOrder,a=n.tail;if(Do(e,t,n.children,r),0!==(2&(n=Ia.current)))n=1&n|2,t.flags|=64;else{if(null!==e&&0!==(64&e.flags))e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&Ko(e,r);else if(19===e.tag)Ko(e,r);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}n&=1}if(ci(Ia,n),0===(2&t.mode))t.memoizedState=null;else switch(i){case"forwards":for(r=t.child,i=null;null!==r;)null!==(e=r.alternate)&&null===Da(e)&&(i=r),r=r.sibling;null===(r=i)?(i=t.child,t.child=null):(i=r.sibling,r.sibling=null),es(t,!1,i,r,a,t.lastEffect);break;case"backwards":for(r=null,i=t.child,t.child=null;null!==i;){if(null!==(e=i.alternate)&&null===Da(e)){t.child=i;break}e=i.sibling,i.sibling=r,r=i,i=e}es(t,!0,r,null,a,t.lastEffect);break;case"together":es(t,!1,null,null,void 0,t.lastEffect);break;default:t.memoizedState=null}return t.child}function rs(e,t,r){if(null!==e&&(t.dependencies=e.dependencies),zs|=t.lanes,0!==(r&t.childLanes)){if(null!==e&&t.child!==e.child)throw Error(o(153));if(null!==t.child){for(r=Gc(e=t.child,e.pendingProps),t.child=r,r.return=t;null!==e.sibling;)e=e.sibling,(r=r.sibling=Gc(e,e.pendingProps)).return=t;r.sibling=null}return t.child}return null}function ns(e,t){if(!za)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;null!==t;)null!==t.alternate&&(r=t),t=t.sibling;null===r?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var n=null;null!==r;)null!==r.alternate&&(n=r),r=r.sibling;null===n?t||null===e.tail?e.tail=null:e.tail.sibling=null:n.sibling=null}}function is(e,t,r){var n=t.pendingProps;switch(t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return null;case 1:return pi(t.type)&&bi(),null;case 3:return Aa(),si(di),si(ui),Wa(),(n=t.stateNode).pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),null!==e&&null!==e.child||(Ga(t)?t.flags|=4:n.hydrate||(t.flags|=256)),null;case 5:Ra(t);var a=Ma(Ca.current);if(r=t.type,null!==e&&null!=t.stateNode)Wo(e,t,r,n),e.ref!==t.ref&&(t.flags|=128);else{if(!n){if(null===t.stateNode)throw Error(o(166));return null}if(e=Ma(Sa.current),Ga(t)){n=t.stateNode,r=t.type;var s=t.memoizedProps;switch(n[Xn]=t,n[Yn]=s,r){case"dialog":Tn("cancel",n),Tn("close",n);break;case"iframe":case"object":case"embed":Tn("load",n);break;case"video":case"audio":for(e=0;e<wn.length;e++)Tn(wn[e],n);break;case"source":Tn("error",n);break;case"img":case"image":case"link":Tn("error",n),Tn("load",n);break;case"details":Tn("toggle",n);break;case"input":ee(n,s),Tn("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!s.multiple},Tn("invalid",n);break;case"textarea":ce(n,s),Tn("invalid",n)}for(var l in xe(r,s),e=null,s)s.hasOwnProperty(l)&&(a=s[l],"children"===l?"string"===typeof a?n.textContent!==a&&(e=["children",a]):"number"===typeof a&&n.textContent!==""+a&&(e=["children",""+a]):c.hasOwnProperty(l)&&null!=a&&"onScroll"===l&&Tn("scroll",n));switch(r){case"input":Y(n),ne(n,s,!0);break;case"textarea":Y(n),ue(n);break;case"select":case"option":break;default:"function"===typeof s.onClick&&(n.onclick=Ln)}n=e,t.updateQueue=n,null!==n&&(t.flags|=4)}else{switch(l=9===a.nodeType?a:a.ownerDocument,e===de&&(e=fe(r)),e===de?"script"===r?((e=l.createElement("div")).innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):"string"===typeof n.is?e=l.createElement(r,{is:n.is}):(e=l.createElement(r),"select"===r&&(l=e,n.multiple?l.multiple=!0:n.size&&(l.size=n.size))):e=l.createElementNS(e,r),e[Xn]=t,e[Yn]=n,Ho(e,t),t.stateNode=e,l=ke(r,n),r){case"dialog":Tn("cancel",e),Tn("close",e),a=n;break;case"iframe":case"object":case"embed":Tn("load",e),a=n;break;case"video":case"audio":for(a=0;a<wn.length;a++)Tn(wn[a],e);a=n;break;case"source":Tn("error",e),a=n;break;case"img":case"image":case"link":Tn("error",e),Tn("load",e),a=n;break;case"details":Tn("toggle",e),a=n;break;case"input":ee(e,n),a=K(e,n),Tn("invalid",e);break;case"option":a=ae(e,n);break;case"select":e._wrapperState={wasMultiple:!!n.multiple},a=i({},n,{value:void 0}),Tn("invalid",e);break;case"textarea":ce(e,n),a=se(e,n),Tn("invalid",e);break;default:a=n}xe(r,a);var u=a;for(s in u)if(u.hasOwnProperty(s)){var d=u[s];"style"===s?_e(e,d):"dangerouslySetInnerHTML"===s?null!=(d=d?d.__html:void 0)&&me(e,d):"children"===s?"string"===typeof d?("textarea"!==r||""!==d)&&ye(e,d):"number"===typeof d&&ye(e,""+d):"suppressContentEditableWarning"!==s&&"suppressHydrationWarning"!==s&&"autoFocus"!==s&&(c.hasOwnProperty(s)?null!=d&&"onScroll"===s&&Tn("scroll",e):null!=d&&O(e,s,d,l))}switch(r){case"input":Y(e),ne(e,n,!1);break;case"textarea":Y(e),ue(e);break;case"option":null!=n.value&&e.setAttribute("value",""+Z(n.value));break;case"select":e.multiple=!!n.multiple,null!=(s=n.value)?oe(e,!!n.multiple,s,!1):null!=n.defaultValue&&oe(e,!!n.multiple,n.defaultValue,!0);break;default:"function"===typeof a.onClick&&(e.onclick=Ln)}Nn(r,n)&&(t.flags|=4)}null!==t.ref&&(t.flags|=128)}return null;case 6:if(e&&null!=t.stateNode)Qo(0,t,e.memoizedProps,n);else{if("string"!==typeof n&&null===t.stateNode)throw Error(o(166));r=Ma(Ca.current),Ma(Sa.current),Ga(t)?(n=t.stateNode,r=t.memoizedProps,n[Xn]=t,n.nodeValue!==r&&(t.flags|=4)):((n=(9===r.nodeType?r:r.ownerDocument).createTextNode(n))[Xn]=t,t.stateNode=n)}return null;case 13:return si(Ia),n=t.memoizedState,0!==(64&t.flags)?(t.lanes=r,t):(n=null!==n,r=!1,null===e?void 0!==t.memoizedProps.fallback&&Ga(t):r=null!==e.memoizedState,n&&!r&&0!==(2&t.mode)&&(null===e&&!0!==t.memoizedProps.unstable_avoidThisFallback||0!==(1&Ia.current)?0===Ds&&(Ds=3):(0!==Ds&&3!==Ds||(Ds=4),null===Ps||0===(134217727&zs)&&0===(134217727&Vs)||bc(Ps,Es))),(n||r)&&(t.flags|=4),null);case 4:return Aa(),null===e&&Mn(t.stateNode.containerInfo),null;case 10:return ea(t),null;case 17:return pi(t.type)&&bi(),null;case 19:if(si(Ia),null===(n=t.memoizedState))return null;if(s=0!==(64&t.flags),null===(l=n.rendering))if(s)ns(n,!1);else{if(0!==Ds||null!==e&&0!==(64&e.flags))for(e=t.child;null!==e;){if(null!==(l=Da(e))){for(t.flags|=64,ns(n,!1),null!==(s=l.updateQueue)&&(t.updateQueue=s,t.flags|=4),null===n.lastEffect&&(t.firstEffect=null),t.lastEffect=n.lastEffect,n=r,r=t.child;null!==r;)e=n,(s=r).flags&=2,s.nextEffect=null,s.firstEffect=null,s.lastEffect=null,null===(l=s.alternate)?(s.childLanes=0,s.lanes=e,s.child=null,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=l.childLanes,s.lanes=l.lanes,s.child=l.child,s.memoizedProps=l.memoizedProps,s.memoizedState=l.memoizedState,s.updateQueue=l.updateQueue,s.type=l.type,e=l.dependencies,s.dependencies=null===e?null:{lanes:e.lanes,firstContext:e.firstContext}),r=r.sibling;return ci(Ia,1&Ia.current|2),t.child}e=e.sibling}null!==n.tail&&Ni()>Gs&&(t.flags|=64,s=!0,ns(n,!1),t.lanes=33554432)}else{if(!s)if(null!==(e=Da(l))){if(t.flags|=64,s=!0,null!==(r=e.updateQueue)&&(t.updateQueue=r,t.flags|=4),ns(n,!0),null===n.tail&&"hidden"===n.tailMode&&!l.alternate&&!za)return null!==(t=t.lastEffect=n.lastEffect)&&(t.nextEffect=null),null}else 2*Ni()-n.renderingStartTime>Gs&&1073741824!==r&&(t.flags|=64,s=!0,ns(n,!1),t.lanes=33554432);n.isBackwards?(l.sibling=t.child,t.child=l):(null!==(r=n.last)?r.sibling=l:t.child=l,n.last=l)}return null!==n.tail?(r=n.tail,n.rendering=r,n.tail=r.sibling,n.lastEffect=t.lastEffect,n.renderingStartTime=Ni(),r.sibling=null,t=Ia.current,ci(Ia,s?1&t|2:1&t),r):null;case 23:case 24:return Oc(),null!==e&&null!==e.memoizedState!==(null!==t.memoizedState)&&"unstable-defer-without-hiding"!==n.mode&&(t.flags|=4),null}throw Error(o(156,t.tag))}function as(e){switch(e.tag){case 1:pi(e.type)&&bi();var t=e.flags;return 4096&t?(e.flags=-4097&t|64,e):null;case 3:if(Aa(),si(di),si(ui),Wa(),0!==(64&(t=e.flags)))throw Error(o(285));return e.flags=-4097&t|64,e;case 5:return Ra(e),null;case 13:return si(Ia),4096&(t=e.flags)?(e.flags=-4097&t|64,e):null;case 19:return si(Ia),null;case 4:return Aa(),null;case 10:return ea(e),null;case 23:case 24:return Oc(),null;default:return null}}function os(e,t){try{var r="",n=t;do{r+=W(n),n=n.return}while(n);var i=r}catch(a){i="\nError generating stack: "+a.message+"\n"+a.stack}return{value:e,source:t,stack:i}}function ss(e,t){try{console.error(t.value)}catch(r){setTimeout((function(){throw r}))}}Ho=function(e,t){for(var r=t.child;null!==r;){if(5===r.tag||6===r.tag)e.appendChild(r.stateNode);else if(4!==r.tag&&null!==r.child){r.child.return=r,r=r.child;continue}if(r===t)break;for(;null===r.sibling;){if(null===r.return||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}},Wo=function(e,t,r,n){var a=e.memoizedProps;if(a!==n){e=t.stateNode,Ma(Sa.current);var o,s=null;switch(r){case"input":a=K(e,a),n=K(e,n),s=[];break;case"option":a=ae(e,a),n=ae(e,n),s=[];break;case"select":a=i({},a,{value:void 0}),n=i({},n,{value:void 0}),s=[];break;case"textarea":a=se(e,a),n=se(e,n),s=[];break;default:"function"!==typeof a.onClick&&"function"===typeof n.onClick&&(e.onclick=Ln)}for(d in xe(r,n),r=null,a)if(!n.hasOwnProperty(d)&&a.hasOwnProperty(d)&&null!=a[d])if("style"===d){var l=a[d];for(o in l)l.hasOwnProperty(o)&&(r||(r={}),r[o]="")}else"dangerouslySetInnerHTML"!==d&&"children"!==d&&"suppressContentEditableWarning"!==d&&"suppressHydrationWarning"!==d&&"autoFocus"!==d&&(c.hasOwnProperty(d)?s||(s=[]):(s=s||[]).push(d,null));for(d in n){var u=n[d];if(l=null!=a?a[d]:void 0,n.hasOwnProperty(d)&&u!==l&&(null!=u||null!=l))if("style"===d)if(l){for(o in l)!l.hasOwnProperty(o)||u&&u.hasOwnProperty(o)||(r||(r={}),r[o]="");for(o in u)u.hasOwnProperty(o)&&l[o]!==u[o]&&(r||(r={}),r[o]=u[o])}else r||(s||(s=[]),s.push(d,r)),r=u;else"dangerouslySetInnerHTML"===d?(u=u?u.__html:void 0,l=l?l.__html:void 0,null!=u&&l!==u&&(s=s||[]).push(d,u)):"children"===d?"string"!==typeof u&&"number"!==typeof u||(s=s||[]).push(d,""+u):"suppressContentEditableWarning"!==d&&"suppressHydrationWarning"!==d&&(c.hasOwnProperty(d)?(null!=u&&"onScroll"===d&&Tn("scroll",e),s||l===u||(s=[])):"object"===typeof u&&null!==u&&u.$$typeof===D?u.toString():(s=s||[]).push(d,u))}r&&(s=s||[]).push("style",r);var d=s;(t.updateQueue=d)&&(t.flags|=4)}},Qo=function(e,t,r,n){r!==n&&(t.flags|=4)};var cs="function"===typeof WeakMap?WeakMap:Map;function ls(e,t,r){(r=sa(-1,r)).tag=3,r.payload={element:null};var n=t.value;return r.callback=function(){Qs||(Qs=!0,Zs=n),ss(0,t)},r}function us(e,t,r){(r=sa(-1,r)).tag=3;var n=e.type.getDerivedStateFromError;if("function"===typeof n){var i=t.value;r.payload=function(){return ss(0,t),n(i)}}var a=e.stateNode;return null!==a&&"function"===typeof a.componentDidCatch&&(r.callback=function(){"function"!==typeof n&&(null===Xs?Xs=new Set([this]):Xs.add(this),ss(0,t));var e=t.stack;this.componentDidCatch(t.value,{componentStack:null!==e?e:""})}),r}var ds="function"===typeof WeakSet?WeakSet:Set;function hs(e){var t=e.ref;if(null!==t)if("function"===typeof t)try{t(null)}catch(r){Lc(e,r)}else t.current=null}function fs(e,t){switch(t.tag){case 0:case 11:case 15:case 22:return;case 1:if(256&t.flags&&null!==e){var r=e.memoizedProps,n=e.memoizedState;t=(e=t.stateNode).getSnapshotBeforeUpdate(t.elementType===t.type?r:Zi(t.type,r),n),e.__reactInternalSnapshotBeforeUpdate=t}return;case 3:return void(256&t.flags&&qn(t.stateNode.containerInfo));case 5:case 6:case 4:case 17:return}throw Error(o(163))}function ps(e,t,r){switch(r.tag){case 0:case 11:case 15:case 22:if(null!==(t=null!==(t=r.updateQueue)?t.lastEffect:null)){e=t=t.next;do{if(3===(3&e.tag)){var n=e.create;e.destroy=n()}e=e.next}while(e!==t)}if(null!==(t=null!==(t=r.updateQueue)?t.lastEffect:null)){e=t=t.next;do{var i=e;n=i.next,0!==(4&(i=i.tag))&&0!==(1&i)&&(Ic(r,e),Rc(r,e)),e=n}while(e!==t)}return;case 1:return e=r.stateNode,4&r.flags&&(null===t?e.componentDidMount():(n=r.elementType===r.type?t.memoizedProps:Zi(r.type,t.memoizedProps),e.componentDidUpdate(n,t.memoizedState,e.__reactInternalSnapshotBeforeUpdate))),void(null!==(t=r.updateQueue)&&da(r,t,e));case 3:if(null!==(t=r.updateQueue)){if(e=null,null!==r.child)switch(r.child.tag){case 5:e=r.child.stateNode;break;case 1:e=r.child.stateNode}da(r,t,e)}return;case 5:return e=r.stateNode,void(null===t&&4&r.flags&&Nn(r.type,r.memoizedProps)&&e.focus());case 6:case 4:case 12:return;case 13:return void(null===r.memoizedState&&(r=r.alternate,null!==r&&(r=r.memoizedState,null!==r&&(r=r.dehydrated,null!==r&&_t(r)))));case 19:case 17:case 20:case 21:case 23:case 24:return}throw Error(o(163))}function bs(e,t){for(var r=e;;){if(5===r.tag){var n=r.stateNode;if(t)"function"===typeof(n=n.style).setProperty?n.setProperty("display","none","important"):n.display="none";else{n=r.stateNode;var i=r.memoizedProps.style;i=void 0!==i&&null!==i&&i.hasOwnProperty("display")?i.display:null,n.style.display=je("display",i)}}else if(6===r.tag)r.stateNode.nodeValue=t?"":r.memoizedProps;else if((23!==r.tag&&24!==r.tag||null===r.memoizedState||r===e)&&null!==r.child){r.child.return=r,r=r.child;continue}if(r===e)break;for(;null===r.sibling;){if(null===r.return||r.return===e)return;r=r.return}r.sibling.return=r.return,r=r.sibling}}function vs(e,t){if(ji&&"function"===typeof ji.onCommitFiberUnmount)try{ji.onCommitFiberUnmount(Oi,t)}catch(a){}switch(t.tag){case 0:case 11:case 14:case 15:case 22:if(null!==(e=t.updateQueue)&&null!==(e=e.lastEffect)){var r=e=e.next;do{var n=r,i=n.destroy;if(n=n.tag,void 0!==i)if(0!==(4&n))Ic(t,r);else{n=t;try{i()}catch(a){Lc(n,a)}}r=r.next}while(r!==e)}break;case 1:if(hs(t),"function"===typeof(e=t.stateNode).componentWillUnmount)try{e.props=t.memoizedProps,e.state=t.memoizedState,e.componentWillUnmount()}catch(a){Lc(t,a)}break;case 5:hs(t);break;case 4:_s(e,t)}}function ms(e){e.alternate=null,e.child=null,e.dependencies=null,e.firstEffect=null,e.lastEffect=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.return=null,e.updateQueue=null}function ys(e){return 5===e.tag||3===e.tag||4===e.tag}function gs(e){e:{for(var t=e.return;null!==t;){if(ys(t))break e;t=t.return}throw Error(o(160))}var r=t;switch(t=r.stateNode,r.tag){case 5:var n=!1;break;case 3:case 4:t=t.containerInfo,n=!0;break;default:throw Error(o(161))}16&r.flags&&(ye(t,""),r.flags&=-17);e:t:for(r=e;;){for(;null===r.sibling;){if(null===r.return||ys(r.return)){r=null;break e}r=r.return}for(r.sibling.return=r.return,r=r.sibling;5!==r.tag&&6!==r.tag&&18!==r.tag;){if(2&r.flags)continue t;if(null===r.child||4===r.tag)continue t;r.child.return=r,r=r.child}if(!(2&r.flags)){r=r.stateNode;break e}}n?Os(e,r,t):js(e,r,t)}function Os(e,t,r){var n=e.tag,i=5===n||6===n;if(i)e=i?e.stateNode:e.stateNode.instance,t?8===r.nodeType?r.parentNode.insertBefore(e,t):r.insertBefore(e,t):(8===r.nodeType?(t=r.parentNode).insertBefore(e,r):(t=r).appendChild(e),null!==(r=r._reactRootContainer)&&void 0!==r||null!==t.onclick||(t.onclick=Ln));else if(4!==n&&null!==(e=e.child))for(Os(e,t,r),e=e.sibling;null!==e;)Os(e,t,r),e=e.sibling}function js(e,t,r){var n=e.tag,i=5===n||6===n;if(i)e=i?e.stateNode:e.stateNode.instance,t?r.insertBefore(e,t):r.appendChild(e);else if(4!==n&&null!==(e=e.child))for(js(e,t,r),e=e.sibling;null!==e;)js(e,t,r),e=e.sibling}function _s(e,t){for(var r,n,i=t,a=!1;;){if(!a){a=i.return;e:for(;;){if(null===a)throw Error(o(160));switch(r=a.stateNode,a.tag){case 5:n=!1;break e;case 3:case 4:r=r.containerInfo,n=!0;break e}a=a.return}a=!0}if(5===i.tag||6===i.tag){e:for(var s=e,c=i,l=c;;)if(vs(s,l),null!==l.child&&4!==l.tag)l.child.return=l,l=l.child;else{if(l===c)break e;for(;null===l.sibling;){if(null===l.return||l.return===c)break e;l=l.return}l.sibling.return=l.return,l=l.sibling}n?(s=r,c=i.stateNode,8===s.nodeType?s.parentNode.removeChild(c):s.removeChild(c)):r.removeChild(i.stateNode)}else if(4===i.tag){if(null!==i.child){r=i.stateNode.containerInfo,n=!0,i.child.return=i,i=i.child;continue}}else if(vs(e,i),null!==i.child){i.child.return=i,i=i.child;continue}if(i===t)break;for(;null===i.sibling;){if(null===i.return||i.return===t)return;4===(i=i.return).tag&&(a=!1)}i.sibling.return=i.return,i=i.sibling}}function ws(e,t){switch(t.tag){case 0:case 11:case 14:case 15:case 22:var r=t.updateQueue;if(null!==(r=null!==r?r.lastEffect:null)){var n=r=r.next;do{3===(3&n.tag)&&(e=n.destroy,n.destroy=void 0,void 0!==e&&e()),n=n.next}while(n!==r)}return;case 1:return;case 5:if(null!=(r=t.stateNode)){n=t.memoizedProps;var i=null!==e?e.memoizedProps:n;e=t.type;var a=t.updateQueue;if(t.updateQueue=null,null!==a){for(r[Yn]=n,"input"===e&&"radio"===n.type&&null!=n.name&&te(r,n),ke(e,i),t=ke(e,n),i=0;i<a.length;i+=2){var s=a[i],c=a[i+1];"style"===s?_e(r,c):"dangerouslySetInnerHTML"===s?me(r,c):"children"===s?ye(r,c):O(r,s,c,t)}switch(e){case"input":re(r,n);break;case"textarea":le(r,n);break;case"select":e=r._wrapperState.wasMultiple,r._wrapperState.wasMultiple=!!n.multiple,null!=(a=n.value)?oe(r,!!n.multiple,a,!1):e!==!!n.multiple&&(null!=n.defaultValue?oe(r,!!n.multiple,n.defaultValue,!0):oe(r,!!n.multiple,n.multiple?[]:"",!1))}}}return;case 6:if(null===t.stateNode)throw Error(o(162));return void(t.stateNode.nodeValue=t.memoizedProps);case 3:return void((r=t.stateNode).hydrate&&(r.hydrate=!1,_t(r.containerInfo)));case 12:return;case 13:return null!==t.memoizedState&&(Bs=Ni(),bs(t.child,!0)),void xs(t);case 19:return void xs(t);case 17:return;case 23:case 24:return void bs(t,null!==t.memoizedState)}throw Error(o(163))}function xs(e){var t=e.updateQueue;if(null!==t){e.updateQueue=null;var r=e.stateNode;null===r&&(r=e.stateNode=new ds),t.forEach((function(t){var n=Vc.bind(null,e,t);r.has(t)||(r.add(t),t.then(n,n))}))}}function ks(e,t){return null!==e&&(null===(e=e.memoizedState)||null!==e.dehydrated)&&(null!==(t=t.memoizedState)&&null===t.dehydrated)}var Ss=Math.ceil,Ts=j.ReactCurrentDispatcher,Cs=j.ReactCurrentOwner,Ms=0,Ps=null,As=null,Es=0,Rs=0,Is=oi(0),Ds=0,Fs=null,Ls=0,zs=0,Vs=0,Ns=0,Us=null,Bs=0,Gs=1/0;function qs(){Gs=Ni()+500}var Hs,Ws=null,Qs=!1,Zs=null,Xs=null,Ys=!1,$s=null,Js=90,Ks=[],ec=[],tc=null,rc=0,nc=null,ic=-1,ac=0,oc=0,sc=null,cc=!1;function lc(){return 0!==(48&Ms)?Ni():-1!==ic?ic:ic=Ni()}function uc(e){if(0===(2&(e=e.mode)))return 1;if(0===(4&e))return 99===Ui()?1:2;if(0===ac&&(ac=Ls),0!==Qi.transition){0!==oc&&(oc=null!==Us?Us.pendingLanes:0),e=ac;var t=4186112&~oc;return 0===(t&=-t)&&(0===(t=(e=4186112&~e)&-e)&&(t=8192)),t}return e=Ui(),0!==(4&Ms)&&98===e?e=Nt(12,ac):e=Nt(e=function(e){switch(e){case 99:return 15;case 98:return 10;case 97:case 96:return 8;case 95:return 2;default:return 0}}(e),ac),e}function dc(e,t,r){if(50<rc)throw rc=0,nc=null,Error(o(185));if(null===(e=hc(e,t)))return null;Gt(e,t,r),e===Ps&&(Vs|=t,4===Ds&&bc(e,Es));var n=Ui();1===t?0!==(8&Ms)&&0===(48&Ms)?vc(e):(fc(e,r),0===Ms&&(qs(),Hi())):(0===(4&Ms)||98!==n&&99!==n||(null===tc?tc=new Set([e]):tc.add(e)),fc(e,r)),Us=e}function hc(e,t){e.lanes|=t;var r=e.alternate;for(null!==r&&(r.lanes|=t),r=e,e=e.return;null!==e;)e.childLanes|=t,null!==(r=e.alternate)&&(r.childLanes|=t),r=e,e=e.return;return 3===r.tag?r.stateNode:null}function fc(e,t){for(var r=e.callbackNode,n=e.suspendedLanes,i=e.pingedLanes,a=e.expirationTimes,s=e.pendingLanes;0<s;){var c=31-qt(s),l=1<<c,u=a[c];if(-1===u){if(0===(l&n)||0!==(l&i)){u=t,Lt(l);var d=Ft;a[c]=10<=d?u+250:6<=d?u+5e3:-1}}else u<=t&&(e.expiredLanes|=l);s&=~l}if(n=zt(e,e===Ps?Es:0),t=Ft,0===n)null!==r&&(r!==Ii&&xi(r),e.callbackNode=null,e.callbackPriority=0);else{if(null!==r){if(e.callbackPriority===t)return;r!==Ii&&xi(r)}15===t?(r=vc.bind(null,e),null===Fi?(Fi=[r],Li=wi(Mi,Wi)):Fi.push(r),r=Ii):14===t?r=qi(99,vc.bind(null,e)):r=qi(r=function(e){switch(e){case 15:case 14:return 99;case 13:case 12:case 11:case 10:return 98;case 9:case 8:case 7:case 6:case 4:case 5:return 97;case 3:case 2:case 1:return 95;case 0:return 90;default:throw Error(o(358,e))}}(t),pc.bind(null,e)),e.callbackPriority=t,e.callbackNode=r}}function pc(e){if(ic=-1,oc=ac=0,0!==(48&Ms))throw Error(o(327));var t=e.callbackNode;if(Ec()&&e.callbackNode!==t)return null;var r=zt(e,e===Ps?Es:0);if(0===r)return null;var n=r,i=Ms;Ms|=16;var a=wc();for(Ps===e&&Es===n||(qs(),jc(e,n));;)try{Sc();break}catch(c){_c(e,c)}if(Ki(),Ts.current=a,Ms=i,null!==As?n=0:(Ps=null,Es=0,n=Ds),0!==(Ls&Vs))jc(e,0);else if(0!==n){if(2===n&&(Ms|=64,e.hydrate&&(e.hydrate=!1,qn(e.containerInfo)),0!==(r=Vt(e))&&(n=xc(e,r))),1===n)throw t=Fs,jc(e,0),bc(e,r),fc(e,Ni()),t;switch(e.finishedWork=e.current.alternate,e.finishedLanes=r,n){case 0:case 1:throw Error(o(345));case 2:Mc(e);break;case 3:if(bc(e,r),(62914560&r)===r&&10<(n=Bs+500-Ni())){if(0!==zt(e,0))break;if(((i=e.suspendedLanes)&r)!==r){lc(),e.pingedLanes|=e.suspendedLanes&i;break}e.timeoutHandle=Bn(Mc.bind(null,e),n);break}Mc(e);break;case 4:if(bc(e,r),(4186112&r)===r)break;for(n=e.eventTimes,i=-1;0<r;){var s=31-qt(r);a=1<<s,(s=n[s])>i&&(i=s),r&=~a}if(r=i,10<(r=(120>(r=Ni()-r)?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*Ss(r/1960))-r)){e.timeoutHandle=Bn(Mc.bind(null,e),r);break}Mc(e);break;case 5:Mc(e);break;default:throw Error(o(329))}}return fc(e,Ni()),e.callbackNode===t?pc.bind(null,e):null}function bc(e,t){for(t&=~Ns,t&=~Vs,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var r=31-qt(t),n=1<<r;e[r]=-1,t&=~n}}function vc(e){if(0!==(48&Ms))throw Error(o(327));if(Ec(),e===Ps&&0!==(e.expiredLanes&Es)){var t=Es,r=xc(e,t);0!==(Ls&Vs)&&(r=xc(e,t=zt(e,t)))}else r=xc(e,t=zt(e,0));if(0!==e.tag&&2===r&&(Ms|=64,e.hydrate&&(e.hydrate=!1,qn(e.containerInfo)),0!==(t=Vt(e))&&(r=xc(e,t))),1===r)throw r=Fs,jc(e,0),bc(e,t),fc(e,Ni()),r;return e.finishedWork=e.current.alternate,e.finishedLanes=t,Mc(e),fc(e,Ni()),null}function mc(e,t){var r=Ms;Ms|=1;try{return e(t)}finally{0===(Ms=r)&&(qs(),Hi())}}function yc(e,t){var r=Ms;Ms&=-2,Ms|=8;try{return e(t)}finally{0===(Ms=r)&&(qs(),Hi())}}function gc(e,t){ci(Is,Rs),Rs|=t,Ls|=t}function Oc(){Rs=Is.current,si(Is)}function jc(e,t){e.finishedWork=null,e.finishedLanes=0;var r=e.timeoutHandle;if(-1!==r&&(e.timeoutHandle=-1,Gn(r)),null!==As)for(r=As.return;null!==r;){var n=r;switch(n.tag){case 1:null!==(n=n.type.childContextTypes)&&void 0!==n&&bi();break;case 3:Aa(),si(di),si(ui),Wa();break;case 5:Ra(n);break;case 4:Aa();break;case 13:case 19:si(Ia);break;case 10:ea(n);break;case 23:case 24:Oc()}r=r.return}Ps=e,As=Gc(e.current,null),Es=Rs=Ls=t,Ds=0,Fs=null,Ns=Vs=zs=0}function _c(e,t){for(;;){var r=As;try{if(Ki(),Qa.current=Mo,Ka){for(var n=Ya.memoizedState;null!==n;){var i=n.queue;null!==i&&(i.pending=null),n=n.next}Ka=!1}if(Xa=0,Ja=$a=Ya=null,eo=!1,Cs.current=null,null===r||null===r.return){Ds=1,Fs=t,As=null;break}e:{var a=e,o=r.return,s=r,c=t;if(t=Es,s.flags|=2048,s.firstEffect=s.lastEffect=null,null!==c&&"object"===typeof c&&"function"===typeof c.then){var l=c;if(0===(2&s.mode)){var u=s.alternate;u?(s.updateQueue=u.updateQueue,s.memoizedState=u.memoizedState,s.lanes=u.lanes):(s.updateQueue=null,s.memoizedState=null)}var d=0!==(1&Ia.current),h=o;do{var f;if(f=13===h.tag){var p=h.memoizedState;if(null!==p)f=null!==p.dehydrated;else{var b=h.memoizedProps;f=void 0!==b.fallback&&(!0!==b.unstable_avoidThisFallback||!d)}}if(f){var v=h.updateQueue;if(null===v){var m=new Set;m.add(l),h.updateQueue=m}else v.add(l);if(0===(2&h.mode)){if(h.flags|=64,s.flags|=16384,s.flags&=-2981,1===s.tag)if(null===s.alternate)s.tag=17;else{var y=sa(-1,1);y.tag=2,ca(s,y)}s.lanes|=1;break e}c=void 0,s=t;var g=a.pingCache;if(null===g?(g=a.pingCache=new cs,c=new Set,g.set(l,c)):void 0===(c=g.get(l))&&(c=new Set,g.set(l,c)),!c.has(s)){c.add(s);var O=zc.bind(null,a,l,s);l.then(O,O)}h.flags|=4096,h.lanes=t;break e}h=h.return}while(null!==h);c=Error((Q(s.type)||"A React component")+" suspended while rendering, but no fallback UI was specified.\n\nAdd a <Suspense fallback=...> component higher in the tree to provide a loading indicator or placeholder to display.")}5!==Ds&&(Ds=2),c=os(c,s),h=o;do{switch(h.tag){case 3:a=c,h.flags|=4096,t&=-t,h.lanes|=t,la(h,ls(0,a,t));break e;case 1:a=c;var j=h.type,_=h.stateNode;if(0===(64&h.flags)&&("function"===typeof j.getDerivedStateFromError||null!==_&&"function"===typeof _.componentDidCatch&&(null===Xs||!Xs.has(_)))){h.flags|=4096,t&=-t,h.lanes|=t,la(h,us(h,a,t));break e}}h=h.return}while(null!==h)}Cc(r)}catch(w){t=w,As===r&&null!==r&&(As=r=r.return);continue}break}}function wc(){var e=Ts.current;return Ts.current=Mo,null===e?Mo:e}function xc(e,t){var r=Ms;Ms|=16;var n=wc();for(Ps===e&&Es===t||jc(e,t);;)try{kc();break}catch(i){_c(e,i)}if(Ki(),Ms=r,Ts.current=n,null!==As)throw Error(o(261));return Ps=null,Es=0,Ds}function kc(){for(;null!==As;)Tc(As)}function Sc(){for(;null!==As&&!ki();)Tc(As)}function Tc(e){var t=Hs(e.alternate,e,Rs);e.memoizedProps=e.pendingProps,null===t?Cc(e):As=t,Cs.current=null}function Cc(e){var t=e;do{var r=t.alternate;if(e=t.return,0===(2048&t.flags)){if(null!==(r=is(r,t,Rs)))return void(As=r);if(24!==(r=t).tag&&23!==r.tag||null===r.memoizedState||0!==(1073741824&Rs)||0===(4&r.mode)){for(var n=0,i=r.child;null!==i;)n|=i.lanes|i.childLanes,i=i.sibling;r.childLanes=n}null!==e&&0===(2048&e.flags)&&(null===e.firstEffect&&(e.firstEffect=t.firstEffect),null!==t.lastEffect&&(null!==e.lastEffect&&(e.lastEffect.nextEffect=t.firstEffect),e.lastEffect=t.lastEffect),1<t.flags&&(null!==e.lastEffect?e.lastEffect.nextEffect=t:e.firstEffect=t,e.lastEffect=t))}else{if(null!==(r=as(t)))return r.flags&=2047,void(As=r);null!==e&&(e.firstEffect=e.lastEffect=null,e.flags|=2048)}if(null!==(t=t.sibling))return void(As=t);As=t=e}while(null!==t);0===Ds&&(Ds=5)}function Mc(e){var t=Ui();return Gi(99,Pc.bind(null,e,t)),null}function Pc(e,t){do{Ec()}while(null!==$s);if(0!==(48&Ms))throw Error(o(327));var r=e.finishedWork;if(null===r)return null;if(e.finishedWork=null,e.finishedLanes=0,r===e.current)throw Error(o(177));e.callbackNode=null;var n=r.lanes|r.childLanes,i=n,a=e.pendingLanes&~i;e.pendingLanes=i,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=i,e.mutableReadLanes&=i,e.entangledLanes&=i,i=e.entanglements;for(var s=e.eventTimes,c=e.expirationTimes;0<a;){var l=31-qt(a),u=1<<l;i[l]=0,s[l]=-1,c[l]=-1,a&=~u}if(null!==tc&&0===(24&n)&&tc.has(e)&&tc.delete(e),e===Ps&&(As=Ps=null,Es=0),1<r.flags?null!==r.lastEffect?(r.lastEffect.nextEffect=r,n=r.firstEffect):n=r:n=r.firstEffect,null!==n){if(i=Ms,Ms|=32,Cs.current=null,zn=Xt,pn(s=fn())){if("selectionStart"in s)c={start:s.selectionStart,end:s.selectionEnd};else e:if(c=(c=s.ownerDocument)&&c.defaultView||window,(u=c.getSelection&&c.getSelection())&&0!==u.rangeCount){c=u.anchorNode,a=u.anchorOffset,l=u.focusNode,u=u.focusOffset;try{c.nodeType,l.nodeType}catch(S){c=null;break e}var d=0,h=-1,f=-1,p=0,b=0,v=s,m=null;t:for(;;){for(var y;v!==c||0!==a&&3!==v.nodeType||(h=d+a),v!==l||0!==u&&3!==v.nodeType||(f=d+u),3===v.nodeType&&(d+=v.nodeValue.length),null!==(y=v.firstChild);)m=v,v=y;for(;;){if(v===s)break t;if(m===c&&++p===a&&(h=d),m===l&&++b===u&&(f=d),null!==(y=v.nextSibling))break;m=(v=m).parentNode}v=y}c=-1===h||-1===f?null:{start:h,end:f}}else c=null;c=c||{start:0,end:0}}else c=null;Vn={focusedElem:s,selectionRange:c},Xt=!1,sc=null,cc=!1,Ws=n;do{try{Ac()}catch(S){if(null===Ws)throw Error(o(330));Lc(Ws,S),Ws=Ws.nextEffect}}while(null!==Ws);sc=null,Ws=n;do{try{for(s=e;null!==Ws;){var g=Ws.flags;if(16&g&&ye(Ws.stateNode,""),128&g){var O=Ws.alternate;if(null!==O){var j=O.ref;null!==j&&("function"===typeof j?j(null):j.current=null)}}switch(1038&g){case 2:gs(Ws),Ws.flags&=-3;break;case 6:gs(Ws),Ws.flags&=-3,ws(Ws.alternate,Ws);break;case 1024:Ws.flags&=-1025;break;case 1028:Ws.flags&=-1025,ws(Ws.alternate,Ws);break;case 4:ws(Ws.alternate,Ws);break;case 8:_s(s,c=Ws);var _=c.alternate;ms(c),null!==_&&ms(_)}Ws=Ws.nextEffect}}catch(S){if(null===Ws)throw Error(o(330));Lc(Ws,S),Ws=Ws.nextEffect}}while(null!==Ws);if(j=Vn,O=fn(),g=j.focusedElem,s=j.selectionRange,O!==g&&g&&g.ownerDocument&&hn(g.ownerDocument.documentElement,g)){null!==s&&pn(g)&&(O=s.start,void 0===(j=s.end)&&(j=O),"selectionStart"in g?(g.selectionStart=O,g.selectionEnd=Math.min(j,g.value.length)):(j=(O=g.ownerDocument||document)&&O.defaultView||window).getSelection&&(j=j.getSelection(),c=g.textContent.length,_=Math.min(s.start,c),s=void 0===s.end?_:Math.min(s.end,c),!j.extend&&_>s&&(c=s,s=_,_=c),c=dn(g,_),a=dn(g,s),c&&a&&(1!==j.rangeCount||j.anchorNode!==c.node||j.anchorOffset!==c.offset||j.focusNode!==a.node||j.focusOffset!==a.offset)&&((O=O.createRange()).setStart(c.node,c.offset),j.removeAllRanges(),_>s?(j.addRange(O),j.extend(a.node,a.offset)):(O.setEnd(a.node,a.offset),j.addRange(O))))),O=[];for(j=g;j=j.parentNode;)1===j.nodeType&&O.push({element:j,left:j.scrollLeft,top:j.scrollTop});for("function"===typeof g.focus&&g.focus(),g=0;g<O.length;g++)(j=O[g]).element.scrollLeft=j.left,j.element.scrollTop=j.top}Xt=!!zn,Vn=zn=null,e.current=r,Ws=n;do{try{for(g=e;null!==Ws;){var w=Ws.flags;if(36&w&&ps(g,Ws.alternate,Ws),128&w){O=void 0;var x=Ws.ref;if(null!==x){var k=Ws.stateNode;switch(Ws.tag){case 5:O=k;break;default:O=k}"function"===typeof x?x(O):x.current=O}}Ws=Ws.nextEffect}}catch(S){if(null===Ws)throw Error(o(330));Lc(Ws,S),Ws=Ws.nextEffect}}while(null!==Ws);Ws=null,Di(),Ms=i}else e.current=r;if(Ys)Ys=!1,$s=e,Js=t;else for(Ws=n;null!==Ws;)t=Ws.nextEffect,Ws.nextEffect=null,8&Ws.flags&&((w=Ws).sibling=null,w.stateNode=null),Ws=t;if(0===(n=e.pendingLanes)&&(Xs=null),1===n?e===nc?rc++:(rc=0,nc=e):rc=0,r=r.stateNode,ji&&"function"===typeof ji.onCommitFiberRoot)try{ji.onCommitFiberRoot(Oi,r,void 0,64===(64&r.current.flags))}catch(S){}if(fc(e,Ni()),Qs)throw Qs=!1,e=Zs,Zs=null,e;return 0!==(8&Ms)||Hi(),null}function Ac(){for(;null!==Ws;){var e=Ws.alternate;cc||null===sc||(0!==(8&Ws.flags)?et(Ws,sc)&&(cc=!0):13===Ws.tag&&ks(e,Ws)&&et(Ws,sc)&&(cc=!0));var t=Ws.flags;0!==(256&t)&&fs(e,Ws),0===(512&t)||Ys||(Ys=!0,qi(97,(function(){return Ec(),null}))),Ws=Ws.nextEffect}}function Ec(){if(90!==Js){var e=97<Js?97:Js;return Js=90,Gi(e,Dc)}return!1}function Rc(e,t){Ks.push(t,e),Ys||(Ys=!0,qi(97,(function(){return Ec(),null})))}function Ic(e,t){ec.push(t,e),Ys||(Ys=!0,qi(97,(function(){return Ec(),null})))}function Dc(){if(null===$s)return!1;var e=$s;if($s=null,0!==(48&Ms))throw Error(o(331));var t=Ms;Ms|=32;var r=ec;ec=[];for(var n=0;n<r.length;n+=2){var i=r[n],a=r[n+1],s=i.destroy;if(i.destroy=void 0,"function"===typeof s)try{s()}catch(l){if(null===a)throw Error(o(330));Lc(a,l)}}for(r=Ks,Ks=[],n=0;n<r.length;n+=2){i=r[n],a=r[n+1];try{var c=i.create;i.destroy=c()}catch(l){if(null===a)throw Error(o(330));Lc(a,l)}}for(c=e.current.firstEffect;null!==c;)e=c.nextEffect,c.nextEffect=null,8&c.flags&&(c.sibling=null,c.stateNode=null),c=e;return Ms=t,Hi(),!0}function Fc(e,t,r){ca(e,t=ls(0,t=os(r,t),1)),t=lc(),null!==(e=hc(e,1))&&(Gt(e,1,t),fc(e,t))}function Lc(e,t){if(3===e.tag)Fc(e,e,t);else for(var r=e.return;null!==r;){if(3===r.tag){Fc(r,e,t);break}if(1===r.tag){var n=r.stateNode;if("function"===typeof r.type.getDerivedStateFromError||"function"===typeof n.componentDidCatch&&(null===Xs||!Xs.has(n))){var i=us(r,e=os(t,e),1);if(ca(r,i),i=lc(),null!==(r=hc(r,1)))Gt(r,1,i),fc(r,i);else if("function"===typeof n.componentDidCatch&&(null===Xs||!Xs.has(n)))try{n.componentDidCatch(t,e)}catch(a){}break}}r=r.return}}function zc(e,t,r){var n=e.pingCache;null!==n&&n.delete(t),t=lc(),e.pingedLanes|=e.suspendedLanes&r,Ps===e&&(Es&r)===r&&(4===Ds||3===Ds&&(62914560&Es)===Es&&500>Ni()-Bs?jc(e,0):Ns|=r),fc(e,t)}function Vc(e,t){var r=e.stateNode;null!==r&&r.delete(t),0===(t=0)&&(0===(2&(t=e.mode))?t=1:0===(4&t)?t=99===Ui()?1:2:(0===ac&&(ac=Ls),0===(t=Ut(62914560&~ac))&&(t=4194304))),r=lc(),null!==(e=hc(e,t))&&(Gt(e,t,r),fc(e,r))}function Nc(e,t,r,n){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.flags=0,this.lastEffect=this.firstEffect=this.nextEffect=null,this.childLanes=this.lanes=0,this.alternate=null}function Uc(e,t,r,n){return new Nc(e,t,r,n)}function Bc(e){return!(!(e=e.prototype)||!e.isReactComponent)}function Gc(e,t){var r=e.alternate;return null===r?((r=Uc(e.tag,t,e.key,e.mode)).elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.nextEffect=null,r.firstEffect=null,r.lastEffect=null),r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r}function qc(e,t,r,n,i,a){var s=2;if(n=e,"function"===typeof e)Bc(e)&&(s=1);else if("string"===typeof e)s=5;else e:switch(e){case x:return Hc(r.children,i,a,t);case F:s=8,i|=16;break;case k:s=8,i|=1;break;case S:return(e=Uc(12,r,t,8|i)).elementType=S,e.type=S,e.lanes=a,e;case P:return(e=Uc(13,r,t,i)).type=P,e.elementType=P,e.lanes=a,e;case A:return(e=Uc(19,r,t,i)).elementType=A,e.lanes=a,e;case L:return Wc(r,i,a,t);case z:return(e=Uc(24,r,t,i)).elementType=z,e.lanes=a,e;default:if("object"===typeof e&&null!==e)switch(e.$$typeof){case T:s=10;break e;case C:s=9;break e;case M:s=11;break e;case E:s=14;break e;case R:s=16,n=null;break e;case I:s=22;break e}throw Error(o(130,null==e?e:typeof e,""))}return(t=Uc(s,r,t,i)).elementType=e,t.type=n,t.lanes=a,t}function Hc(e,t,r,n){return(e=Uc(7,e,n,t)).lanes=r,e}function Wc(e,t,r,n){return(e=Uc(23,e,n,t)).elementType=L,e.lanes=r,e}function Qc(e,t,r){return(e=Uc(6,e,null,t)).lanes=r,e}function Zc(e,t,r){return(t=Uc(4,null!==e.children?e.children:[],e.key,t)).lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Xc(e,t,r){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.pendingContext=this.context=null,this.hydrate=r,this.callbackNode=null,this.callbackPriority=0,this.eventTimes=Bt(0),this.expirationTimes=Bt(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Bt(0),this.mutableSourceEagerHydrationData=null}function Yc(e,t,r){var n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:w,key:null==n?null:""+n,children:e,containerInfo:t,implementation:r}}function $c(e,t,r,n){var i=t.current,a=lc(),s=uc(i);e:if(r){t:{if(Ye(r=r._reactInternals)!==r||1!==r.tag)throw Error(o(170));var c=r;do{switch(c.tag){case 3:c=c.stateNode.context;break t;case 1:if(pi(c.type)){c=c.stateNode.__reactInternalMemoizedMergedChildContext;break t}}c=c.return}while(null!==c);throw Error(o(171))}if(1===r.tag){var l=r.type;if(pi(l)){r=mi(r,l,c);break e}}r=c}else r=li;return null===t.context?t.context=r:t.pendingContext=r,(t=sa(a,s)).payload={element:e},null!==(n=void 0===n?null:n)&&(t.callback=n),ca(i,t),dc(i,s,a),s}function Jc(e){if(!(e=e.current).child)return null;switch(e.child.tag){case 5:default:return e.child.stateNode}}function Kc(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var r=e.retryLane;e.retryLane=0!==r&&r<t?r:t}}function el(e,t){Kc(e,t),(e=e.alternate)&&Kc(e,t)}function tl(e,t,r){var n=null!=r&&null!=r.hydrationOptions&&r.hydrationOptions.mutableSources||null;if(r=new Xc(e,t,null!=r&&!0===r.hydrate),t=Uc(3,null,null,2===t?7:1===t?3:0),r.current=t,t.stateNode=r,aa(t),e[$n]=r.current,Mn(8===e.nodeType?e.parentNode:e),n)for(e=0;e<n.length;e++){var i=(t=n[e])._getVersion;i=i(t._source),null==r.mutableSourceEagerHydrationData?r.mutableSourceEagerHydrationData=[t,i]:r.mutableSourceEagerHydrationData.push(t,i)}this._internalRoot=r}function rl(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType&&(8!==e.nodeType||" react-mount-point-unstable "!==e.nodeValue))}function nl(e,t,r,n,i){var a=r._reactRootContainer;if(a){var o=a._internalRoot;if("function"===typeof i){var s=i;i=function(){var e=Jc(o);s.call(e)}}$c(t,o,e,i)}else{if(a=r._reactRootContainer=function(e,t){if(t||(t=!(!(t=e?9===e.nodeType?e.documentElement:e.firstChild:null)||1!==t.nodeType||!t.hasAttribute("data-reactroot"))),!t)for(var r;r=e.lastChild;)e.removeChild(r);return new tl(e,0,t?{hydrate:!0}:void 0)}(r,n),o=a._internalRoot,"function"===typeof i){var c=i;i=function(){var e=Jc(o);c.call(e)}}yc((function(){$c(t,o,e,i)}))}return Jc(o)}function il(e,t){var r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!rl(t))throw Error(o(200));return Yc(e,t,null,r)}Hs=function(e,t,r){var n=t.lanes;if(null!==e)if(e.memoizedProps!==t.pendingProps||di.current)Io=!0;else{if(0===(r&n)){switch(Io=!1,t.tag){case 3:qo(t),qa();break;case 5:Ea(t);break;case 1:pi(t.type)&&yi(t);break;case 4:Pa(t,t.stateNode.containerInfo);break;case 10:n=t.memoizedProps.value;var i=t.type._context;ci(Xi,i._currentValue),i._currentValue=n;break;case 13:if(null!==t.memoizedState)return 0!==(r&t.child.childLanes)?Xo(e,t,r):(ci(Ia,1&Ia.current),null!==(t=rs(e,t,r))?t.sibling:null);ci(Ia,1&Ia.current);break;case 19:if(n=0!==(r&t.childLanes),0!==(64&e.flags)){if(n)return ts(e,t,r);t.flags|=64}if(null!==(i=t.memoizedState)&&(i.rendering=null,i.tail=null,i.lastEffect=null),ci(Ia,Ia.current),n)break;return null;case 23:case 24:return t.lanes=0,Vo(e,t,r)}return rs(e,t,r)}Io=0!==(16384&e.flags)}else Io=!1;switch(t.lanes=0,t.tag){case 2:if(n=t.type,null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2),e=t.pendingProps,i=fi(t,ui.current),ra(t,r),i=no(null,t,n,e,i,r),t.flags|=1,"object"===typeof i&&null!==i&&"function"===typeof i.render&&void 0===i.$$typeof){if(t.tag=1,t.memoizedState=null,t.updateQueue=null,pi(n)){var a=!0;yi(t)}else a=!1;t.memoizedState=null!==i.state&&void 0!==i.state?i.state:null,aa(t);var s=n.getDerivedStateFromProps;"function"===typeof s&&fa(t,n,s,e),i.updater=pa,t.stateNode=i,i._reactInternals=t,ya(t,n,e,r),t=Go(null,t,n,!0,a,r)}else t.tag=0,Do(null,t,i,r),t=t.child;return t;case 16:i=t.elementType;e:{switch(null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2),e=t.pendingProps,i=(a=i._init)(i._payload),t.type=i,a=t.tag=function(e){if("function"===typeof e)return Bc(e)?1:0;if(void 0!==e&&null!==e){if((e=e.$$typeof)===M)return 11;if(e===E)return 14}return 2}(i),e=Zi(i,e),a){case 0:t=Uo(null,t,i,e,r);break e;case 1:t=Bo(null,t,i,e,r);break e;case 11:t=Fo(null,t,i,e,r);break e;case 14:t=Lo(null,t,i,Zi(i.type,e),n,r);break e}throw Error(o(306,i,""))}return t;case 0:return n=t.type,i=t.pendingProps,Uo(e,t,n,i=t.elementType===n?i:Zi(n,i),r);case 1:return n=t.type,i=t.pendingProps,Bo(e,t,n,i=t.elementType===n?i:Zi(n,i),r);case 3:if(qo(t),n=t.updateQueue,null===e||null===n)throw Error(o(282));if(n=t.pendingProps,i=null!==(i=t.memoizedState)?i.element:null,oa(e,t),ua(t,n,null,r),(n=t.memoizedState.element)===i)qa(),t=rs(e,t,r);else{if((a=(i=t.stateNode).hydrate)&&(La=Hn(t.stateNode.containerInfo.firstChild),Fa=t,a=za=!0),a){if(null!=(e=i.mutableSourceEagerHydrationData))for(i=0;i<e.length;i+=2)(a=e[i])._workInProgressVersionPrimary=e[i+1],Ha.push(a);for(r=xa(t,null,n,r),t.child=r;r;)r.flags=-3&r.flags|1024,r=r.sibling}else Do(e,t,n,r),qa();t=t.child}return t;case 5:return Ea(t),null===e&&Ua(t),n=t.type,i=t.pendingProps,a=null!==e?e.memoizedProps:null,s=i.children,Un(n,i)?s=null:null!==a&&Un(n,a)&&(t.flags|=16),No(e,t),Do(e,t,s,r),t.child;case 6:return null===e&&Ua(t),null;case 13:return Xo(e,t,r);case 4:return Pa(t,t.stateNode.containerInfo),n=t.pendingProps,null===e?t.child=wa(t,null,n,r):Do(e,t,n,r),t.child;case 11:return n=t.type,i=t.pendingProps,Fo(e,t,n,i=t.elementType===n?i:Zi(n,i),r);case 7:return Do(e,t,t.pendingProps,r),t.child;case 8:case 12:return Do(e,t,t.pendingProps.children,r),t.child;case 10:e:{n=t.type._context,i=t.pendingProps,s=t.memoizedProps,a=i.value;var c=t.type._context;if(ci(Xi,c._currentValue),c._currentValue=a,null!==s)if(c=s.value,0===(a=sn(c,a)?0:0|("function"===typeof n._calculateChangedBits?n._calculateChangedBits(c,a):1073741823))){if(s.children===i.children&&!di.current){t=rs(e,t,r);break e}}else for(null!==(c=t.child)&&(c.return=t);null!==c;){var l=c.dependencies;if(null!==l){s=c.child;for(var u=l.firstContext;null!==u;){if(u.context===n&&0!==(u.observedBits&a)){1===c.tag&&((u=sa(-1,r&-r)).tag=2,ca(c,u)),c.lanes|=r,null!==(u=c.alternate)&&(u.lanes|=r),ta(c.return,r),l.lanes|=r;break}u=u.next}}else s=10===c.tag&&c.type===t.type?null:c.child;if(null!==s)s.return=c;else for(s=c;null!==s;){if(s===t){s=null;break}if(null!==(c=s.sibling)){c.return=s.return,s=c;break}s=s.return}c=s}Do(e,t,i.children,r),t=t.child}return t;case 9:return i=t.type,n=(a=t.pendingProps).children,ra(t,r),n=n(i=na(i,a.unstable_observedBits)),t.flags|=1,Do(e,t,n,r),t.child;case 14:return a=Zi(i=t.type,t.pendingProps),Lo(e,t,i,a=Zi(i.type,a),n,r);case 15:return zo(e,t,t.type,t.pendingProps,n,r);case 17:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:Zi(n,i),null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2),t.tag=1,pi(n)?(e=!0,yi(t)):e=!1,ra(t,r),va(t,n,i),ya(t,n,i,r),Go(null,t,n,!0,e,r);case 19:return ts(e,t,r);case 23:case 24:return Vo(e,t,r)}throw Error(o(156,t.tag))},tl.prototype.render=function(e){$c(e,this._internalRoot,null,null)},tl.prototype.unmount=function(){var e=this._internalRoot,t=e.containerInfo;$c(null,e,null,(function(){t[$n]=null}))},tt=function(e){13===e.tag&&(dc(e,4,lc()),el(e,4))},rt=function(e){13===e.tag&&(dc(e,67108864,lc()),el(e,67108864))},nt=function(e){if(13===e.tag){var t=lc(),r=uc(e);dc(e,r,t),el(e,r)}},it=function(e,t){return t()},Te=function(e,t,r){switch(t){case"input":if(re(e,r),t=r.name,"radio"===r.type&&null!=t){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<r.length;t++){var n=r[t];if(n!==e&&n.form===e.form){var i=ri(n);if(!i)throw Error(o(90));$(n),re(n,i)}}}break;case"textarea":le(e,r);break;case"select":null!=(t=r.value)&&oe(e,!!r.multiple,t,!1)}},Re=mc,Ie=function(e,t,r,n,i){var a=Ms;Ms|=4;try{return Gi(98,e.bind(null,t,r,n,i))}finally{0===(Ms=a)&&(qs(),Hi())}},De=function(){0===(49&Ms)&&(function(){if(null!==tc){var e=tc;tc=null,e.forEach((function(e){e.expiredLanes|=24&e.pendingLanes,fc(e,Ni())}))}Hi()}(),Ec())},Fe=function(e,t){var r=Ms;Ms|=2;try{return e(t)}finally{0===(Ms=r)&&(qs(),Hi())}};var al={Events:[ei,ti,ri,Ae,Ee,Ec,{current:!1}]},ol={findFiberByHostInstance:Kn,bundleType:0,version:"17.0.2",rendererPackageName:"react-dom"},sl={bundleType:ol.bundleType,version:ol.version,rendererPackageName:ol.rendererPackageName,rendererConfig:ol.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:j.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return null===(e=Ke(e))?null:e.stateNode},findFiberByHostInstance:ol.findFiberByHostInstance||function(){return null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null};if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var cl=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!cl.isDisabled&&cl.supportsFiber)try{Oi=cl.inject(sl),ji=cl}catch(ve){}}t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=al,t.createPortal=il,t.findDOMNode=function(e){if(null==e)return null;if(1===e.nodeType)return e;var t=e._reactInternals;if(void 0===t){if("function"===typeof e.render)throw Error(o(188));throw Error(o(268,Object.keys(e)))}return e=null===(e=Ke(t))?null:e.stateNode},t.flushSync=function(e,t){var r=Ms;if(0!==(48&r))return e(t);Ms|=1;try{if(e)return Gi(99,e.bind(null,t))}finally{Ms=r,Hi()}},t.hydrate=function(e,t,r){if(!rl(t))throw Error(o(200));return nl(null,e,t,!0,r)},t.render=function(e,t,r){if(!rl(t))throw Error(o(200));return nl(null,e,t,!1,r)},t.unmountComponentAtNode=function(e){if(!rl(e))throw Error(o(40));return!!e._reactRootContainer&&(yc((function(){nl(null,null,e,!1,(function(){e._reactRootContainer=null,e[$n]=null}))})),!0)},t.unstable_batchedUpdates=mc,t.unstable_createPortal=function(e,t){return il(e,t,2<arguments.length&&void 0!==arguments[2]?arguments[2]:null)},t.unstable_renderSubtreeIntoContainer=function(e,t,r,n){if(!rl(r))throw Error(o(200));if(null==e||void 0===e._reactInternals)throw Error(o(38));return nl(e,t,r,!1,n)},t.version="17.0.2"},function(e,t,r){"use strict";e.exports=r(688)},function(e,t,r){"use strict";var n,i,a,o;if("object"===typeof performance&&"function"===typeof performance.now){var s=performance;t.unstable_now=function(){return s.now()}}else{var c=Date,l=c.now();t.unstable_now=function(){return c.now()-l}}if("undefined"===typeof window||"function"!==typeof MessageChannel){var u=null,d=null,h=function e(){if(null!==u)try{var r=t.unstable_now();u(!0,r),u=null}catch(n){throw setTimeout(e,0),n}};n=function(e){null!==u?setTimeout(n,0,e):(u=e,setTimeout(h,0))},i=function(e,t){d=setTimeout(e,t)},a=function(){clearTimeout(d)},t.unstable_shouldYield=function(){return!1},o=t.unstable_forceFrameRate=function(){}}else{var f=window.setTimeout,p=window.clearTimeout;if("undefined"!==typeof console){var b=window.cancelAnimationFrame;"function"!==typeof window.requestAnimationFrame&&console.error("This browser doesn't support requestAnimationFrame. Make sure that you load a polyfill in older browsers. https://reactjs.org/link/react-polyfills"),"function"!==typeof b&&console.error("This browser doesn't support cancelAnimationFrame. Make sure that you load a polyfill in older browsers. https://reactjs.org/link/react-polyfills")}var v=!1,m=null,y=-1,g=5,O=0;t.unstable_shouldYield=function(){return t.unstable_now()>=O},o=function(){},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):g=0<e?Math.floor(1e3/e):5};var j=new MessageChannel,_=j.port2;j.port1.onmessage=function(){if(null!==m){var e=t.unstable_now();O=e+g;try{m(!0,e)?_.postMessage(null):(v=!1,m=null)}catch(r){throw _.postMessage(null),r}}else v=!1},n=function(e){m=e,v||(v=!0,_.postMessage(null))},i=function(e,r){y=f((function(){e(t.unstable_now())}),r)},a=function(){p(y),y=-1}}function w(e,t){var r=e.length;e.push(t);e:for(;;){var n=r-1>>>1,i=e[n];if(!(void 0!==i&&0<S(i,t)))break e;e[n]=t,e[r]=i,r=n}}function x(e){return void 0===(e=e[0])?null:e}function k(e){var t=e[0];if(void 0!==t){var r=e.pop();if(r!==t){e[0]=r;e:for(var n=0,i=e.length;n<i;){var a=2*(n+1)-1,o=e[a],s=a+1,c=e[s];if(void 0!==o&&0>S(o,r))void 0!==c&&0>S(c,o)?(e[n]=c,e[s]=r,n=s):(e[n]=o,e[a]=r,n=a);else{if(!(void 0!==c&&0>S(c,r)))break e;e[n]=c,e[s]=r,n=s}}}return t}return null}function S(e,t){var r=e.sortIndex-t.sortIndex;return 0!==r?r:e.id-t.id}var T=[],C=[],M=1,P=null,A=3,E=!1,R=!1,I=!1;function D(e){for(var t=x(C);null!==t;){if(null===t.callback)k(C);else{if(!(t.startTime<=e))break;k(C),t.sortIndex=t.expirationTime,w(T,t)}t=x(C)}}function F(e){if(I=!1,D(e),!R)if(null!==x(T))R=!0,n(L);else{var t=x(C);null!==t&&i(F,t.startTime-e)}}function L(e,r){R=!1,I&&(I=!1,a()),E=!0;var n=A;try{for(D(r),P=x(T);null!==P&&(!(P.expirationTime>r)||e&&!t.unstable_shouldYield());){var o=P.callback;if("function"===typeof o){P.callback=null,A=P.priorityLevel;var s=o(P.expirationTime<=r);r=t.unstable_now(),"function"===typeof s?P.callback=s:P===x(T)&&k(T),D(r)}else k(T);P=x(T)}if(null!==P)var c=!0;else{var l=x(C);null!==l&&i(F,l.startTime-r),c=!1}return c}finally{P=null,A=n,E=!1}}var z=o;t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_continueExecution=function(){R||E||(R=!0,n(L))},t.unstable_getCurrentPriorityLevel=function(){return A},t.unstable_getFirstCallbackNode=function(){return x(T)},t.unstable_next=function(e){switch(A){case 1:case 2:case 3:var t=3;break;default:t=A}var r=A;A=t;try{return e()}finally{A=r}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=z,t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var r=A;A=e;try{return t()}finally{A=r}},t.unstable_scheduleCallback=function(e,r,o){var s=t.unstable_now();switch("object"===typeof o&&null!==o?o="number"===typeof(o=o.delay)&&0<o?s+o:s:o=s,e){case 1:var c=-1;break;case 2:c=250;break;case 5:c=1073741823;break;case 4:c=1e4;break;default:c=5e3}return e={id:M++,callback:r,priorityLevel:e,startTime:o,expirationTime:c=o+c,sortIndex:-1},o>s?(e.sortIndex=o,w(C,e),null===x(T)&&e===x(C)&&(I?a():I=!0,i(F,o-s))):(e.sortIndex=c,w(T,e),R||E||(R=!0,n(L))),e},t.unstable_wrapCallback=function(e){var t=A;return function(){var r=A;A=t;try{return e.apply(this,arguments)}finally{A=r}}}},,,,,function(e,t,r){"use strict";r(556);var n=r(225),i=60103;if(t.Fragment=60107,"function"===typeof Symbol&&Symbol.for){var a=Symbol.for;i=a("react.element"),t.Fragment=a("react.fragment")}var o=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,s=Object.prototype.hasOwnProperty,c={key:!0,ref:!0,__self:!0,__source:!0};function l(e,t,r){var n,a={},l=null,u=null;for(n in void 0!==r&&(l=""+r),void 0!==t.key&&(l=""+t.key),void 0!==t.ref&&(u=t.ref),t)s.call(t,n)&&!c.hasOwnProperty(n)&&(a[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps)void 0===a[n]&&(a[n]=t[n]);return{$$typeof:i,type:e,key:l,ref:u,props:a,_owner:o.current}}t.jsx=l,t.jsxs=l},,,,function(e,t,r){var n=function(e){"use strict";var t,r=Object.prototype,n=r.hasOwnProperty,i="function"===typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",o=i.asyncIterator||"@@asyncIterator",s=i.toStringTag||"@@toStringTag";function c(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{c({},"")}catch(A){c=function(e,t,r){return e[t]=r}}function l(e,t,r,n){var i=t&&t.prototype instanceof v?t:v,a=Object.create(i.prototype),o=new C(n||[]);return a._invoke=function(e,t,r){var n=d;return function(i,a){if(n===f)throw new Error("Generator is already running");if(n===p){if("throw"===i)throw a;return P()}for(r.method=i,r.arg=a;;){var o=r.delegate;if(o){var s=k(o,r);if(s){if(s===b)continue;return s}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(n===d)throw n=p,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n=f;var c=u(e,t,r);if("normal"===c.type){if(n=r.done?p:h,c.arg===b)continue;return{value:c.arg,done:r.done}}"throw"===c.type&&(n=p,r.method="throw",r.arg=c.arg)}}}(e,r,o),a}function u(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(A){return{type:"throw",arg:A}}}e.wrap=l;var d="suspendedStart",h="suspendedYield",f="executing",p="completed",b={};function v(){}function m(){}function y(){}var g={};c(g,a,(function(){return this}));var O=Object.getPrototypeOf,j=O&&O(O(M([])));j&&j!==r&&n.call(j,a)&&(g=j);var _=y.prototype=v.prototype=Object.create(g);function w(e){["next","throw","return"].forEach((function(t){c(e,t,(function(e){return this._invoke(t,e)}))}))}function x(e,t){function r(i,a,o,s){var c=u(e[i],e,a);if("throw"!==c.type){var l=c.arg,d=l.value;return d&&"object"===typeof d&&n.call(d,"__await")?t.resolve(d.__await).then((function(e){r("next",e,o,s)}),(function(e){r("throw",e,o,s)})):t.resolve(d).then((function(e){l.value=e,o(l)}),(function(e){return r("throw",e,o,s)}))}s(c.arg)}var i;this._invoke=function(e,n){function a(){return new t((function(t,i){r(e,n,t,i)}))}return i=i?i.then(a,a):a()}}function k(e,r){var n=e.iterator[r.method];if(n===t){if(r.delegate=null,"throw"===r.method){if(e.iterator.return&&(r.method="return",r.arg=t,k(e,r),"throw"===r.method))return b;r.method="throw",r.arg=new TypeError("The iterator does not provide a 'throw' method")}return b}var i=u(n,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,b;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,b):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,b)}function S(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function T(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function C(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(S,this),this.reset(!0)}function M(e){if(e){var r=e[a];if(r)return r.call(e);if("function"===typeof e.next)return e;if(!isNaN(e.length)){var i=-1,o=function r(){for(;++i<e.length;)if(n.call(e,i))return r.value=e[i],r.done=!1,r;return r.value=t,r.done=!0,r};return o.next=o}}return{next:P}}function P(){return{value:t,done:!0}}return m.prototype=y,c(_,"constructor",y),c(y,"constructor",m),m.displayName=c(y,s,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"===typeof e&&e.constructor;return!!t&&(t===m||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,y):(e.__proto__=y,c(e,s,"GeneratorFunction")),e.prototype=Object.create(_),e},e.awrap=function(e){return{__await:e}},w(x.prototype),c(x.prototype,o,(function(){return this})),e.AsyncIterator=x,e.async=function(t,r,n,i,a){void 0===a&&(a=Promise);var o=new x(l(t,r,n,i),a);return e.isGeneratorFunction(r)?o:o.next().then((function(e){return e.done?e.value:o.next()}))},w(_),c(_,s,"Generator"),c(_,a,(function(){return this})),c(_,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=[];for(var r in e)t.push(r);return t.reverse(),function r(){for(;t.length;){var n=t.pop();if(n in e)return r.value=n,r.done=!1,r}return r.done=!0,r}},e.values=M,C.prototype={constructor:C,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(T),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function i(n,i){return s.type="throw",s.arg=e,r.next=n,i&&(r.method="next",r.arg=t),!!i}for(var a=this.tryEntries.length-1;a>=0;--a){var o=this.tryEntries[a],s=o.completion;if("root"===o.tryLoc)return i("end");if(o.tryLoc<=this.prev){var c=n.call(o,"catchLoc"),l=n.call(o,"finallyLoc");if(c&&l){if(this.prev<o.catchLoc)return i(o.catchLoc,!0);if(this.prev<o.finallyLoc)return i(o.finallyLoc)}else if(c){if(this.prev<o.catchLoc)return i(o.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return i(o.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var a=i;break}}a&&("break"===e||"continue"===e)&&a.tryLoc<=t&&t<=a.finallyLoc&&(a=null);var o=a?a.completion:{};return o.type=e,o.arg=t,a?(this.method="next",this.next=a.finallyLoc,b):this.complete(o)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),b},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),T(r),b}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var i=n.arg;T(r)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:M(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),b}},e}(e.exports);try{regeneratorRuntime=n}catch(i){"object"===typeof globalThis?globalThis.regeneratorRuntime=n:Function("r","regeneratorRuntime = r")(n)}}]]);
//# sourceMappingURL=45.b1bcb2b4.chunk.js.map