(this.webpackJsonparcgis=this.webpackJsonparcgis||[]).push([[143],{1185:function(e,t,a){"use strict";a.r(t);var r=a(8),n=a.n(r),i=a(16),s=a(2),u=a(5),c=a(6),o=a(7),p=a(0),l=a(23),d=a(35),h=a(1),f=(a(17),a(18),a(15),a(10)),b=a(842),m=a(45),y=a(42),v=a(22),x=a(3),j=a(56),w=a(188),O=a(152),g=a(718),k=function(e){var t=function(e){Object(c.a)(a,e);var t=Object(o.a)(a);function a(){var e;return Object(s.a)(this,a),(e=t.apply(this,arguments)).view=null,e}return Object(u.a)(a,[{key:"fetchPopupFeatures",value:function(){var e=Object(i.a)(n.a.mark((function e(t,a){var r,i,s,u,c,o,p,l,d,h,f;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=this.layer,t){e.next=3;break}throw new v.a("imagerylayerview:fetchPopupFeatures","Nothing to fetch without area",{layer:r});case 3:if(i=r.popupEnabled,s=Object(g.a)(r,a),i&&Object(x.j)(s)){e.next=6;break}throw new v.a("imagerylayerview:fetchPopupFeatures","Missing required popupTemplate or popupEnabled",{popupEnabled:i,popupTemplate:s});case 6:return e.next=8,s.getRequiredFields();case 8:return u=e.sent,(c=new O.a).timeExtent=this.timeExtent,c.geometry=t,c.outFields=u,c.outSpatialReference=t.spatialReference,o=this.view.resolution,p="2d"===this.view.type?new j.a(o,o,this.view.spatialReference):new j.a(.5*o,.5*o,this.view.spatialReference),l=s.layerOptions||{returnTopmostRaster:!0,showNoDataRecords:!1},d=l.returnTopmostRaster,h=l.showNoDataRecords,f={returnDomainValues:!0,returnTopmostRaster:d,pixelSize:p,showNoDataRecords:h,signal:Object(x.j)(a)?a.signal:null},e.abrupt("return",r.queryVisibleRasters(c,f).then((function(e){return e})));case 13:case"end":return e.stop()}}),e,this)})));return function(t,a){return e.apply(this,arguments)}}()},{key:"canResume",value:function(){var e;return!!Object(m.a)(Object(y.a)(a.prototype),"canResume",this).call(this)&&(null==(e=this.timeExtent)||!e.isEmpty)}}]),a}(e);return Object(p.a)([Object(h.b)()],t.prototype,"layer",void 0),Object(p.a)([Object(h.b)()],t.prototype,"suspended",void 0),Object(p.a)([Object(h.b)(w.a)],t.prototype,"timeExtent",void 0),Object(p.a)([Object(h.b)()],t.prototype,"view",void 0),t=Object(p.a)([Object(f.a)("esri.views.layers.ImageryLayerView")],t)},R=function(e){Object(c.a)(a,e);var t=Object(o.a)(a);function a(){var e;return Object(s.a)(this,a),(e=t.apply(this,arguments)).type="imagery-3d",e.redrawDebounced=Object(l.j)(function(){var t=Object(i.a)(n.a.mark((function t(a){return n.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.redraw((function(t,a){return e._redrawImage(t,a)}),a);case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),2e3),e}return Object(u.a)(a,[{key:"initialize",value:function(){var e=this;this.handles.add([Object(d.j)(this.view.basemapTerrain,"ready",(function(){return e.initializeMaximumDataResolution()})),this.layer.on("redraw",(function(){return e.redrawDebounced()}))]),this.updatingHandles.add(this.layer,"exportImageServiceParameters.version",(function(){e.updatingHandles.addPromise(e.refreshDebounced())})),this.updatingHandles.add(this,"timeExtent",(function(){return e.updatingHandles.addPromise(e.refreshDebounced())}))}},{key:"initializeMaximumDataResolution",value:function(){var e=this.view.basemapTerrain.spatialReference,t=this.layer.fullExtent;t&&e.equals(t.spatialReference)&&(this.maximumDataResolution={x:this.layer.pixelSizeX,y:this.layer.pixelSizeY})}},{key:"getFetchOptions",value:function(){return{timeExtent:this.timeExtent}}},{key:"processResult",value:function(){var e=Object(i.a)(n.a.mark((function e(t,a,r){return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!a.imageElement){e.next=4;break}t.image=a.imageElement,e.next=8;break;case 4:return t.image=document.createElement("canvas"),t.pixelData=a.pixelData,e.next=8,this._redrawImage(t,r);case 8:case"end":return e.stop()}}),e,this)})));return function(t,a,r){return e.apply(this,arguments)}}()},{key:"_redrawImage",value:function(){var e=Object(i.a)(n.a.mark((function e(t,a){var r,i,s,u,c,o;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.image instanceof HTMLCanvasElement&&t.pixelData){e.next=2;break}return e.abrupt("return",Promise.reject());case 2:return r=t.image,i=r.getContext("2d"),e.next=6,this.layer.applyRenderer(t.pixelData,{signal:a});case 6:s=e.sent,u=this.layer.applyFilter(s),c=u.pixelBlock,r.width=c.width,r.height=c.height,(o=i.createImageData(c.width,c.height)).data.set(u.pixelBlock.getAsRGBA()),i.putImageData(o,0,0);case 12:case"end":return e.stop()}}),e,this)})));return function(t,a){return e.apply(this,arguments)}}()}]),a}(k(b.a)),E=R=Object(p.a)([Object(f.a)("esri.views.3d.layers.ImageryLayerView3D")],R);t.default=E},718:function(e,t,a){"use strict";a.d(t,"a",(function(){return l})),a.d(t,"b",(function(){return o}));var r=a(8),n=a.n(r),i=a(50),s=a(16),u=a(3),c=a(103);function o(e){return p.apply(this,arguments)}function p(){return(p=Object(s.a)(n.a.mark((function e(t){var a,r,s,o,p,l,d,h,f,b=arguments;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=b.length>1&&void 0!==b[1]?b[1]:t.popupTemplate,Object(u.j)(a)){e.next=3;break}return e.abrupt("return",[]);case 3:return e.next=5,a.getRequiredFields(t.fieldsIndex);case 5:if(r=e.sent,s=a.lastEditInfoEnabled,o=t.objectIdField,p=t.typeIdField,l=t.globalIdField,d=t.relationships,!r.includes("*")){e.next=13;break}return e.abrupt("return",["*"]);case 13:if(!s){e.next=19;break}return e.next=16,Object(c.m)(t);case 16:e.t0=e.sent,e.next=20;break;case 19:e.t0=[];case 20:return h=e.t0,f=Object(c.i)(t.fieldsIndex,[].concat(Object(i.a)(r),Object(i.a)(h))),e.abrupt("return",(p&&f.push(p),f&&o&&t.fieldsIndex.has(o)&&-1===f.indexOf(o)&&f.push(o),f&&l&&t.fieldsIndex.has(l)&&-1===f.indexOf(l)&&f.push(l),d&&d.forEach((function(e){var a=e.keyField;f&&a&&t.fieldsIndex.has(a)&&-1===f.indexOf(a)&&f.push(a)})),f));case 23:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function l(e,t){return e.popupTemplate?e.popupTemplate:Object(u.j)(t)&&t.defaultPopupTemplateEnabled&&Object(u.j)(e.defaultPopupTemplate)?e.defaultPopupTemplate:null}}}]);
//# sourceMappingURL=143.f6cd2249.chunk.js.map