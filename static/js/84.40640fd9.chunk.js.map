{"version":3,"sources":["../node_modules/@arcgis/core/views/layers/TileLayerView.js","../node_modules/@arcgis/core/views/3d/layers/TileLayerView3D.js","../node_modules/@arcgis/core/renderers/support/clickToleranceUtils.js","../node_modules/@arcgis/core/views/support/drapedUtils.js"],"names":["i","c","e","s","a","this","layer","Promise","reject","r","type","get","allSublayers","toArray","filter","minScale","t","maxScale","popupTemplate","popupEnabled","visible","o","map","createQuery","event","p","renderer","geometry","createFetchPopupFeaturesQueryGeometry","getRequiredFields","outFields","queryFeatures","features","then","concat","value","Boolean","prototype","arguments","tileInfo","format","lods","scale","length","levelRangeFromScaleRange","minLevel","maxLevel","originOf","fullExtent","addResolvingPromise","_addTilingSchemeMatchPromise","f","view","suspended","emit","l","m","n","readOnly","aliasOf","y","xoffset","Math","max","abs","yoffset","stops","size","maxSize","minSize","floor","pointerType","visualVariables","symbol","uniqueValueInfos","forEach","classBreakInfos","resolution","overlayPixelSizeInMapUnits","basemapSpatialReference","equals","spatialReference","x","xmin","min","ymin","xmax","ymax"],"mappings":"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","file":"static/js/84.40640fd9.chunk.js","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../chunks/tslib.es6.js\";import r from\"../../core/Error.js\";import{isSome as t}from\"../../core/maybe.js\";import{eachAlways as o}from\"../../core/promiseUtils.js\";import{property as s}from\"../../core/accessorSupport/decorators/property.js\";import\"../../core/has.js\";import\"../../core/accessorSupport/ensureType.js\";import\"../../core/Logger.js\";import{subclass as a}from\"../../core/accessorSupport/decorators/subclass.js\";import{calculateTolerance as p}from\"../../renderers/support/clickToleranceUtils.js\";const i=i=>{let c=class extends i{async fetchPopupFeatures(e,s){const{layer:a}=this;if(!e)return Promise.reject(new r(\"tilelayerview:fetchPopupFeatures\",\"Nothing to fetch without area\",{layer:a}));if(\"tile\"!==a.type)return Promise.reject(new r(\"tilelayerview:fetchPopupFeatures\",\"Layer type should be 'tile'\",{type:a.type}));const i=this.get(\"view.scale\"),c=a.allSublayers.toArray().filter((e=>{const r=0===e.minScale||i<=e.minScale,t=0===e.maxScale||i>=e.maxScale;return e.popupTemplate&&e.popupEnabled&&e.visible&&r&&t}));return o(c.map((async r=>{const o=r.createQuery(),a=t(s)?s.event:null,i=p({renderer:r.renderer,event:a});o.geometry=this.createFetchPopupFeaturesQueryGeometry(e,i),o.outFields=await r.popupTemplate.getRequiredFields();return(await r.queryFeatures(o)).features}))).then((e=>[].concat(...e.map((e=>e.value)).filter(Boolean))))}};return e([s()],c.prototype,\"layer\",void 0),c=e([a(\"esri.layers.mixins.TileLayerView\")],c),c};export default i;export{i as TileLayerView};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../../chunks/tslib.es6.js\";import r from\"../../../core/Error.js\";import{isNone as t}from\"../../../core/maybe.js\";import{property as o}from\"../../../core/accessorSupport/decorators/property.js\";import\"../../../core/has.js\";import\"../../../core/accessorSupport/ensureType.js\";import\"../../../core/Logger.js\";import{subclass as i}from\"../../../core/accessorSupport/decorators/subclass.js\";import{canProjectWithoutEngine as s}from\"../../../geometry/projection.js\";import{LayerView3D as a}from\"./LayerView3D.js\";import{TiledLayerView3D as l}from\"./TiledLayerView3D.js\";import n from\"../../layers/LayerView.js\";import{RefreshableLayerView as p}from\"../../layers/RefreshableLayerView.js\";import{TileLayerView as m}from\"../../layers/TileLayerView.js\";import{createQueryGeometry as f}from\"../../support/drapedUtils.js\";let c=class extends(p(l(m(a(n))))){constructor(){super(...arguments),this.type=\"tile-3d\"}get imageFormatIsOpaque(){return\"jpg\"===this.layer.tileInfo.format}get hasMixedImageFormats(){return\"mixed\"===this.layer.tileInfo.format}get dataLevelRange(){if(this.tileInfo){const e=this.tileInfo.lods,r=e[0].scale,t=e[e.length-1].scale;return this.levelRangeFromScaleRange(r,t)}return{minLevel:0,maxLevel:0}}initialize(){if(\"web-tile\"===this.layer.type){const e=this.layer.get(\"fullExtent.spatialReference\"),o=this.layer.get(\"tileInfo.spatialReference\");if(t(e)||t(o)||!s(e,o)){const e=\"defaults\"===this.layer.originOf(\"fullExtent\")||t(this.layer.fullExtent)?\"SceneView requires fullExtent to be specified by the user on WebTileLayer\":\"SceneView requires fullExtent to be specified in the same spatial reference as tileInfo on WebTileLayer\";this.addResolvingPromise(Promise.reject(new r(\"layerview:incompatible-fullextent\",e)))}}this._addTilingSchemeMatchPromise()}createFetchPopupFeaturesQueryGeometry(e,r){return f(e,r,this.view)}async doRefresh(e){this.suspended||this.emit(\"data-changed\")}};e([o({readOnly:!0})],c.prototype,\"imageFormatIsOpaque\",null),e([o({readOnly:!0})],c.prototype,\"hasMixedImageFormats\",null),e([o({aliasOf:\"layer.fullExtent\"})],c.prototype,\"fullExtent\",void 0),e([o()],c.prototype,\"layer\",void 0),e([o({aliasOf:\"layer.tileInfo\"})],c.prototype,\"tileInfo\",void 0),e([o({readOnly:!0})],c.prototype,\"dataLevelRange\",null),c=e([i(\"esri.views.3d.layers.TileLayerView3D\")],c);var y=c;export default y;\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nfunction t(t,e){return e?\"xoffset\"in e&&e.xoffset?Math.max(t,Math.abs(e.xoffset)):\"yoffset\"in e&&e.yoffset?Math.max(t,Math.abs(e.yoffset||0)):t:t}function e(t){let e=0,n=0;for(let r=0;r<t.length;r++){const s=t[r].size;\"number\"==typeof s&&(e+=s,n++)}return e/n}function n(t,n){return\"number\"==typeof t?t:t&&t.stops&&t.stops.length?e(t.stops):n}function r(t,e){if(!e)return t;const r=e.filter((t=>\"size\"===t.type)).map((e=>{const{maxSize:r,minSize:s}=e;return(n(r,t)+n(s,t))/2}));let s=0;const o=r.length;if(0===o)return t;for(let n=0;n<o;n++)s+=r[n];const f=Math.floor(s/o);return Math.max(f,t)}function s(e){const n=e&&e.renderer,s=\"touch\"===(e&&e.event&&e.event.pointerType)?9:6;if(!n)return s;const o=\"visualVariables\"in n?r(s,n.visualVariables):s;if(\"simple\"===n.type)return t(o,n.symbol);if(\"unique-value\"===n.type){let e=o;return n.uniqueValueInfos.forEach((n=>{e=t(e,n.symbol)})),e}if(\"class-breaks\"===n.type){let e=o;return n.classBreakInfos.forEach((n=>{e=t(e,n.symbol)})),e}return n.type,o}export{s as calculateTolerance};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport\"../../geometry.js\";import{isSome as e,isNone as t}from\"../../core/maybe.js\";import{getMetersPerUnitForSR as r}from\"../../core/unitUtils.js\";import{calculateTolerance as n}from\"../../renderers/support/clickToleranceUtils.js\";import i from\"../../geometry/Extent.js\";function a(t,n,a,o=new i){let s;if(\"2d\"===a.type)s=n*a.resolution;else if(\"3d\"===a.type){const i=a.overlayPixelSizeInMapUnits(t),o=a.basemapSpatialReference;s=e(o)&&!o.equals(a.spatialReference)?r(o)/r(a.spatialReference):n*i}const m=t.x-s,p=t.y-s,c=t.x+s,l=t.y+s,{spatialReference:f}=a;return o.xmin=Math.min(m,c),o.ymin=Math.min(p,l),o.xmax=Math.max(m,c),o.ymax=Math.max(p,l),o.spatialReference=f,o}function o(e,r,i){const o=i.toMap(e);if(t(o))return!1;return a(o,n(),i,s).intersects(r)}const s=new i;export{a as createQueryGeometry,o as intersectsDrapedGeometry};\n"],"sourceRoot":""}