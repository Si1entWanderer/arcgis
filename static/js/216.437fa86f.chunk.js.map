{"version":3,"sources":["../node_modules/@arcgis/core/views/layers/GroupLayerView.js"],"names":["o","e","type","layerViews","i","this","handles","add","on","_layerViewsChangeHandler","_layerViewsAfterChangesHandler","layer","watch","_visibilityModeHandler","_visibleHandler","target","added","toArray","removed","moved","_set","s","_get","some","updating","length","reduce","updatingProgress","_isOverridden","find","layers","_findLayerViewForLayer","visible","_hasLayerViewVisibleOverrides","_firstVisibleOnLayerOrder","getItemAt","forEach","remove","map","_layerViewVisibleHandler","_enforceVisibility","_updateUpdating","visibilityMode","_enforceExclusiveVisibility","notifyChange","l","t","cast","r","prototype","readOnly","h","a"],"mappings":"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","file":"static/js/216.437fa86f.chunk.js","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../chunks/tslib.es6.js\";import i from\"../../core/Collection.js\";import{referenceSetter as s,castForReferenceSetter as r}from\"../../core/collectionUtils.js\";import{property as t}from\"../../core/accessorSupport/decorators/property.js\";import\"../../core/has.js\";import\"../../core/accessorSupport/ensureType.js\";import\"../../core/Logger.js\";import{subclass as a}from\"../../core/accessorSupport/decorators/subclass.js\";import l from\"./LayerView.js\";let o=class extends l{constructor(e){super(e),this.type=\"group\",this.layerViews=new i}initialize(){this.handles.add([this.layerViews.on(\"change\",(e=>this._layerViewsChangeHandler(e))),this.layerViews.on(\"after-changes\",(()=>this._layerViewsAfterChangesHandler())),this.layer.watch(\"visibilityMode\",(()=>this._visibilityModeHandler()),!0),this.watch(\"visible\",(()=>this._visibleHandler()),!0)],\"grouplayerview\"),this._layerViewsChangeHandler({target:null,added:this.layerViews.toArray(),removed:[],moved:[]}),this._layerViewsAfterChangesHandler()}set layerViews(e){this._set(\"layerViews\",s(e,this._get(\"layerViews\")))}isUpdating(){return this.layerViews.some((e=>e.updating))}get updatingProgress(){return 0===this.layerViews.length?1:this.layerViews.reduce(((e,i)=>e+i.updatingProgress),0)/this.layerViews.length}_hasLayerViewVisibleOverrides(){return this.layerViews.some((e=>e._isOverridden(\"visible\")))}_findLayerViewForLayer(e){return e&&this.layerViews.find((i=>i.layer===e))}_firstVisibleOnLayerOrder(){const e=this.layer.layers.find((e=>{const i=this._findLayerViewForLayer(e);return i&&i.visible}));return e&&this._findLayerViewForLayer(e)}_enforceExclusiveVisibility(e){this._hasLayerViewVisibleOverrides()&&(e||!(e=this._firstVisibleOnLayerOrder())&&this.layerViews.length>0&&(e=this._findLayerViewForLayer(this.layer.layers.getItemAt(0))),this.layerViews.forEach((i=>{i.visible=i===e})))}_layerViewsChangeHandler(e){this.handles.remove(\"grouplayerview:visible\"),this.handles.add(this.layerViews.map((e=>e.watch(\"visible\",(i=>this._layerViewVisibleHandler(i,e)),!0))).toArray(),\"grouplayerview:visible\");const i=e.added[e.added.length-1];let s=null;i&&i.visible&&(s=i),this._enforceVisibility(s)}_layerViewsAfterChangesHandler(){this.handles.remove(\"grouplayerview:updating\"),this.handles.add(this.layerViews.map((e=>e.watch(\"updating\",(()=>this._updateUpdating()),!0))).toArray(),\"grouplayerview:updating\"),this._updateUpdating()}_enforceVisibility(e){if(this._hasLayerViewVisibleOverrides())switch(this.layer.visibilityMode){case\"inherited\":{const e=this.visible;this.layerViews.forEach((i=>{i.visible=e}));break}case\"exclusive\":this._enforceExclusiveVisibility(e)}}_visibilityModeHandler(){this._enforceVisibility()}_layerViewVisibleHandler(e,i){if(this._hasLayerViewVisibleOverrides())switch(this.layer.visibilityMode){case\"inherited\":e!==this.visible&&(i.visible=this.visible);break;case\"exclusive\":this._enforceExclusiveVisibility(e&&i)}}_visibleHandler(){var e;this._hasLayerViewVisibleOverrides()&&\"inherited\"===(null==(e=this.layer)?void 0:e.visibilityMode)&&this._enforceVisibility()}_updateUpdating(){this.notifyChange(\"updating\")}};e([t({cast:r})],o.prototype,\"layerViews\",null),e([t()],o.prototype,\"view\",void 0),e([t({readOnly:!0})],o.prototype,\"updatingProgress\",null),o=e([a(\"esri.views.layers.GroupLayerView\")],o);var h=o;export default h;\n"],"sourceRoot":""}