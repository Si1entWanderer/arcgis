(this.webpackJsonparcgis=this.webpackJsonparcgis||[]).push([[184],{1056:function(e,t,i){"use strict";i.r(t);var r=i(8),a=i.n(r),n=i(16),l=i(2),o=i(5),s=i(45),c=i(42),u=i(6),h=i(7),f=i(0),d=i(22),p=i(15),b=i(35),v=i(1),y=(i(17),i(18),i(10)),g=i(572),m=i(595),w=i(571),x=i(454),O=p.a.getLogger("esri.views.3d.layers.WMTSLayerView3d"),j=function(e){Object(u.a)(i,e);var t=Object(h.a)(i);function i(){var e;return Object(l.a)(this,i),(e=t.apply(this,arguments)).type="wmts-3d",e}return Object(o.a)(i,[{key:"hasMixedImageFormats",get:function(){return!0}},{key:"initialize",value:function(){var e=this,t=Object(b.l)(this.view,"basemapTerrain.tilingSchemeDone").then((function(){var t=function(){return new d.a("layerview:no-compatible-tiling-scheme","None of the tiling schemes supported by the service are compatible with the scene.")};if(!e.view.basemapTerrain.tilingSchemeLocked)throw t();var i,r=e.view.basemapTerrain.tilingScheme,a=e.layer.activeLayer;if(a&&a.tileMatrixSet){var n=(i=a.tileMatrixSet).tileInfo,l=e._getTileInfoSupportError(n,i.fullExtent)||e._getTileInfoCompatibilityError(n,r);if(l)throw l}else{if(!(i=e._getCompatibleTileMatrixSet()))throw t();a.tileMatrixSetId=i.id}e._set("tileInfo",i.tileInfo),e._set("fullExtent",i.fullExtent),e.layer.fullExtent=i.fullExtent}));this.addResolvingPromise(t),this.when((function(){return e._initialized()}))}},{key:"refresh",value:function(){this.emit("data-changed")}},{key:"canResume",value:function(){if(!Object(s.a)(Object(c.a)(i.prototype),"canResume",this).call(this))return!1;var e=this.layer.activeLayer.tileMatrixSet;return e&&!this._getTileInfoError(e.tileInfo,e.fullExtent)}},{key:"doRefresh",value:function(){var e=Object(n.a)(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.suspended||this.emit("data-changed");case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"_initialized",value:function(){var e=this;this.updatingHandles.add(this,"layer.activeLayer.styleId",(function(){return e.refresh()})),this.updatingHandles.add(this,"tileMatrixSet",(function(){return e.refresh()})),this.updatingHandles.add(this.layer,"activeLayer",(function(t){var i=t.tileMatrixSet;if(i){var r=e._getTileInfoError(i.tileInfo,i.fullExtent);r&&(O.error("The selected tile matrix set is not compatible with the view",r),i=null)}else(i=e._getCompatibleTileMatrixSet())?t.tileMatrixSetId=i.id:O.error("The layer does not provide a tiling scheme that is compatible with the view");e.notifyChange("suspended"),e.canResume()&&e.refresh()}))}},{key:"_getCompatibleTileMatrixSet",value:function(){var e=this;return this.layer.activeLayer.tileMatrixSets.find((function(t){var i=t.tileInfo;return!e._getTileInfoError(i,t.fullExtent)}))}},{key:"_getTileInfoError",value:function(e,t){return this._getTileInfoSupportError(e,t)||this._getTileInfoCompatibilityError(e,this.view.basemapTerrain.tilingScheme)}}]),i}(Object(x.a)(Object(m.a)(Object(g.a)(w.a))));Object(f.a)([Object(v.b)({readOnly:!0})],j.prototype,"hasMixedImageFormats",null),Object(f.a)([Object(v.b)()],j.prototype,"fullExtent",void 0),Object(f.a)([Object(v.b)()],j.prototype,"layer",void 0),Object(f.a)([Object(v.b)()],j.prototype,"suspended",void 0),Object(f.a)([Object(v.b)()],j.prototype,"tileInfo",void 0);var I=j=Object(f.a)([Object(y.a)("esri.views.3d.layers.WMTSLayerView3D")],j);t.default=I}}]);
//# sourceMappingURL=184.2961332f.chunk.js.map