{"version":3,"sources":["../node_modules/@arcgis/core/views/layers/ImageryTileLayerView.js","../node_modules/@arcgis/core/views/3d/layers/ImageryTileLayerView3D.js","../node_modules/@arcgis/core/views/layers/support/popupUtils.js","../node_modules/@arcgis/core/renderers/support/clickToleranceUtils.js","../node_modules/@arcgis/core/views/support/drapedUtils.js","../node_modules/@arcgis/core/layers/support/rasterFunctions/rasterProjectionHelper.js"],"names":["p","u","arguments","_rasterFieldPrefix","layer","view","fullExtent","tileInfo","datumTransformation","this","renderer","dynamicRangeAdjustment","e","o","a","s","Promise","reject","r","popupEnabled","n","l","i","popupTemplate","identify","value","f","length","type","hasStandardTime","map","getStandardTimeValue","join","ObjectId","_formatAttributeValue","m","rasterInfo","c","attributeTable","features","t","filter","attributes","Value","VALUE","String","hasOwnProperty","clone","sourceLayer","push","spatialReference","_set","resolve","fieldInfos","_getFieldInfo","format","trim","indexOf","_formatDelimitedString","_formatNumberFromString","toLowerCase","some","fieldName","replace","split","Number","isNaN","prototype","readOnly","y","isAlignedMapTile","increaseRasterJobHandlerUsage","updateFullExtent","addResolvingPromise","then","basemapTerrain","tilingScheme","compatibleWith","toTileInfo","updatingHandles","add","refresh","decreaseRasterJobHandlerUsage","document","createElement","getContext","size","width","height","clearRect","getImageData","lods","scale","levelRangeFromScaleRange","_canSymbolizeInWebGL","requestRawData","signal","requestAsImageElement","fetchTile","HTMLImageElement","d","pixelBlock","_blankTile","applyRenderer","h","symbolizerRenderer","symbolizer","rendererJSON","symbolizerParameters","generateWebGLParameters","_getSymbolizerOptions","transformGrid","isRendereredSource","interpolation","bandIds","lodAt","resolution","isGCS","isGeographic","x","JSON","stringify","lij","emit","suspended","supportsTextureFloat","canRenderInWebGL","getRequiredFields","fieldsIndex","lastEditInfoEnabled","objectIdField","typeIdField","globalIdField","relationships","includes","has","forEach","keyField","defaultPopupTemplateEnabled","defaultPopupTemplate","xoffset","Math","max","abs","yoffset","stops","maxSize","minSize","floor","event","pointerType","visualVariables","symbol","uniqueValueInfos","classBreakInfos","overlayPixelSizeInMapUnits","basemapSpatialReference","equals","xmin","min","ymin","xmax","ymax","isWGS84","isWebMercator","cols","rows","M","g","center","w","v","R","S","j","W","normalize","b","apply","wkid","N","z","storageInfo","origin","originX","halfWorldWidth","pyramidsInfo","nativePixelSize","extent","maximumPyramidLevel","blockWidth","pyramidScalingFactor","transform","ceil","round","resolutionX","datsetColumnCount","worldColumnCountFromOrigin","leftMargin","rightPadding","originColumnOffset","hasGCSSShiftTransform","G","inverseTransform","NaN","P","C","Float32Array","L","k","offsets","error","coefficients","spacing","pixelSize","pyramidResolutions","pyramidLevel","pyramidResolution","excessiveReading","log","LN2"],"mappings":"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","file":"static/js/27.60888de4.chunk.js","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../chunks/tslib.es6.js\";import t from\"../../Graphic.js\";import r from\"../../core/Error.js\";import{isSome as i}from\"../../core/maybe.js\";import{property as o}from\"../../core/accessorSupport/decorators/property.js\";import\"../../core/has.js\";import\"../../core/accessorSupport/ensureType.js\";import\"../../core/Logger.js\";import{subclass as s}from\"../../core/accessorSupport/decorators/subclass.js\";import{getDefaultDatumTransformationForDataset as a,projectExtent as n}from\"../../layers/support/rasterFunctions/rasterProjectionHelper.js\";import{getFetchPopupTemplate as l}from\"./support/popupUtils.js\";const p=p=>{let u=class extends p{constructor(){super(...arguments),this._rasterFieldPrefix=\"Raster.\",this.layer=null,this.view=null,this.fullExtent=null,this.tileInfo=null,this.datumTransformation=null}get hasTilingEffects(){return this.layer.renderer&&\"dynamicRangeAdjustment\"in this.layer.renderer&&this.layer.renderer.dynamicRangeAdjustment}async fetchPopupFeatures(e,o){const{layer:s}=this;if(!e)return Promise.reject(new r(\"imageryTileLayerView:fetchPopupFeatures\",\"Nothing to fetch without area\",{layer:s}));const{popupEnabled:a}=s,n=l(s,o);if(!a||!i(n))throw new r(\"imageryTileLayerView:fetchPopupFeatures\",\"Missing required popupTemplate or popupEnabled\",{popupEnabled:a,popupTemplate:n});const p=[],{value:u}=await s.identify(e);let f=\"\";if(u&&u.length){var m,c;f=\"imagery-tile\"===s.type&&s.hasStandardTime()&&null!=u[0]?u.map((e=>s.getStandardTimeValue(e))).join(\", \"):u.join(\", \");const e={ObjectId:0},r=\"Raster.ServicePixelValue\";e[r]=this._formatAttributeValue(f,r);const i=null==(m=s.rasterInfo)||null==(c=m.attributeTable)?void 0:c.features;if(i&&i.length>0){const t=i.filter((e=>{const t=e.attributes.value||e.attributes.Value||e.attributes.VALUE;return String(t)===f}));if(t.length>0){const r=t[0];if(r)for(const t in r.attributes)if(r.attributes.hasOwnProperty(t)){const i=this._rasterFieldPrefix+t;e[i]=this._formatAttributeValue(r.attributes[t],i)}}}const o=new t(this.fullExtent.clone(),null,e);o.layer=s,o.sourceLayer=o.layer,p.push(o)}return p}updateFullExtent(){const e=this.layer.tileInfo;let t;e&&e.spatialReference||(t=new r(\"layerview:tiling-information-missing\",\"The layer doesn't provide tiling information\",{layer:this.layer}));const i=a(this.layer.fullExtent,this.view.spatialReference,!1),o=n(this.layer.fullExtent,this.view.spatialReference,i);return null==o&&(t=new r(\"layerview:projection-not-supported\",\"The layer extent cannot be projected to the view's spatial reference\",{layer:this.layer})),this._set(\"fullExtent\",o),this.datumTransformation||(this.datumTransformation=a(this.layer.fullExtent,this.view.spatialReference,!0)),t?Promise.reject(t):Promise.resolve()}_formatAttributeValue(e,t){if(\"string\"==typeof e){const r=this.layer.popupTemplate&&this.layer.popupTemplate.fieldInfos,i=this._getFieldInfo(r,t),o=i&&i.format;if(o){let t,r;return e.trim().indexOf(\",\")>-1?(t=\",\",r=t+\" \",this._formatDelimitedString(e,t,r,o)):e.trim().indexOf(\" \")>-1?(t=r=\" \",this._formatDelimitedString(e,t,r,o)):this._formatNumberFromString(e,o)}}return e}_getFieldInfo(e,t){if(!e||!e.length||!t)return;const r=t.toLowerCase();let i;return e.some((e=>!(!e.fieldName||e.fieldName.toLowerCase()!==r&&e.fieldName.toLowerCase()!==r.replace(/ /g,\"_\"))&&(i=e,!0))),i}_formatDelimitedString(e,t,r,i){return e&&t&&r&&i?e.trim().split(t).map((e=>this._formatNumberFromString(e,i))).join(r):e}_formatNumberFromString(e,t){if(!e||!t)return e;const r=Number(e);return isNaN(r)?e:t.format(r)}};return e([o()],u.prototype,\"layer\",void 0),e([o()],u.prototype,\"view\",void 0),e([o()],u.prototype,\"fullExtent\",void 0),e([o()],u.prototype,\"tileInfo\",void 0),e([o({readOnly:!0})],u.prototype,\"hasTilingEffects\",null),u=e([s(\"esri.views.layers.ImageryTileLayerView\")],u),u};export default p;export{p as ImageryTileLayerView};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../../chunks/tslib.es6.js\";import{unwrap as r}from\"../../../core/maybe.js\";import{whenTrueOnce as t}from\"../../../core/watchUtils.js\";import{property as i}from\"../../../core/accessorSupport/decorators/property.js\";import\"../../../core/has.js\";import\"../../../core/accessorSupport/ensureType.js\";import\"../../../core/Logger.js\";import{subclass as s}from\"../../../core/accessorSupport/decorators/subclass.js\";import{LayerView3D as a}from\"./LayerView3D.js\";import{TiledLayerView3D as l}from\"./TiledLayerView3D.js\";import o from\"../terrain/RasterTile.js\";import{ImageryTileLayerView as n}from\"../../layers/ImageryTileLayerView.js\";import m from\"../../layers/LayerView.js\";import{RefreshableLayerView as d}from\"../../layers/RefreshableLayerView.js\";import{createQueryGeometry as h}from\"../../support/drapedUtils.js\";import p from\"../../webgl/capabilities.js\";let y=class extends(n(d(l(a(m))))){constructor(){super(...arguments),this.type=\"imagery-tile-3d\",this.isAlignedMapTile=!0}initialize(){this.layer.increaseRasterJobHandlerUsage();const e=this.updateFullExtent();this.addResolvingPromise(e);const r=t(this.view,\"basemapTerrain.tilingSchemeLocked\").then((()=>{const e=this.view.basemapTerrain.tilingScheme,{tileInfo:r}=this.layer,t=[\"png\",\"png24\",\"png32\",\"jpg\",\"mixed\"].indexOf(r.format)>-1&&e.compatibleWith(r);this.isAlignedMapTile=t;const i=t?r:e.toTileInfo();this._set(\"tileInfo\",i),this.updatingHandles.add(this,\"layer.renderer\",(()=>this.refresh())),this.updatingHandles.add(this,\"layer.interpolation\",(()=>this.refresh())),this.updatingHandles.add(this,\"layer.bandIds\",(()=>this.refresh())),this.updatingHandles.add(this,\"layer.multidimensionalDefinition\",(()=>this.refresh()))}));this.addResolvingPromise(r)}destroy(){this.layer.decreaseRasterJobHandlerUsage(),this.view=null}get _blankTile(){const e=document.createElement(\"canvas\"),r=e.getContext(\"2d\"),[t,i]=this.tileInfo.size;return e.width=t,e.height=i,r.clearRect(0,0,t,i),r.getImageData(0,0,t,i)}get imageFormatIsOpaque(){return\"jpg\"===this.layer.tileInfo.format}get hasMixedImageFormats(){return\"mixed\"===this.layer.tileInfo.format}get dataLevelRange(){const e=this.tileInfo.lods,r=this.layer.tileInfo.lods,t=e[0].scale,i=r[r.length-1].scale;return this.levelRangeFromScaleRange(t,i)}async fetchTile(e,t,i,s){const a=this.tileInfo,l=this._canSymbolizeInWebGL(),n={tileInfo:a,requestRawData:l,signal:r(s.signal),requestAsImageElement:this.isAlignedMapTile},m=await this.layer.fetchTile(e,t,i,n);if(m instanceof HTMLImageElement)return m;let d=m&&m.pixelBlock;if(!d)return this._blankTile;if(!l&&(d=await this.layer.applyRenderer(m),null==d))return this._blankTile;const h=new o([e,t,i],d,a.size[0],a.size[1]);return l?(h.symbolizerRenderer=this.layer.symbolizer.rendererJSON,h.symbolizerParameters=this.layer.symbolizer.generateWebGLParameters(this._getSymbolizerOptions(e)),h.transformGrid=m.transformGrid):h.isRendereredSource=!0,h.interpolation=this.layer.interpolation,h.bandIds=this.layer.bandIds,h}_getSymbolizerOptions(e){const r=this.tileInfo.lodAt(e).resolution;return{pixelBlock:null,isGCS:this.view.spatialReference.isGeographic,resolution:{x:r,y:r},bandIds:this.layer.bandIds}}ensureSymbolizerParameters(e){this._canSymbolizeInWebGL()&&JSON.stringify(e.symbolizerRenderer)!==JSON.stringify(this.layer.symbolizer.rendererJSON)&&(e.symbolizerParameters=this.layer.symbolizer.generateWebGLParameters(this._getSymbolizerOptions(e.lij[0])))}createFetchPopupFeaturesQueryGeometry(e,r){return h(e,r,this.view)}refresh(){this.emit(\"data-changed\")}async doRefresh(e){this.suspended||this.emit(\"data-changed\")}_canSymbolizeInWebGL(){return p().supportsTextureFloat&&this.layer.symbolizer.canRenderInWebGL}};e([i({readOnly:!0})],y.prototype,\"_blankTile\",null),e([i({readOnly:!0})],y.prototype,\"imageFormatIsOpaque\",null),e([i({readOnly:!0})],y.prototype,\"hasMixedImageFormats\",null),e([i({readOnly:!0})],y.prototype,\"dataLevelRange\",null),y=e([s(\"esri.views.3d.layers.ImageryTileLayerView3D\")],y);var c=y;export default c;\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport{isSome as e}from\"../../../core/maybe.js\";import{getFeatureEditFields as p,fixFields as l}from\"../../../layers/support/fieldUtils.js\";async function t(t,d=t.popupTemplate){if(!e(d))return[];const i=await d.getRequiredFields(t.fieldsIndex),{lastEditInfoEnabled:n}=d,{objectIdField:s,typeIdField:a,globalIdField:o,relationships:u}=t;if(i.includes(\"*\"))return[\"*\"];const f=n?await p(t):[],r=l(t.fieldsIndex,[...i,...f]);return a&&r.push(a),r&&s&&t.fieldsIndex.has(s)&&-1===r.indexOf(s)&&r.push(s),r&&o&&t.fieldsIndex.has(o)&&-1===r.indexOf(o)&&r.push(o),u&&u.forEach((e=>{const{keyField:p}=e;r&&p&&t.fieldsIndex.has(p)&&-1===r.indexOf(p)&&r.push(p)})),r}function d(p,l){return p.popupTemplate?p.popupTemplate:e(l)&&l.defaultPopupTemplateEnabled&&e(p.defaultPopupTemplate)?p.defaultPopupTemplate:null}export{d as getFetchPopupTemplate,t as getRequiredFields};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nfunction t(t,e){return e?\"xoffset\"in e&&e.xoffset?Math.max(t,Math.abs(e.xoffset)):\"yoffset\"in e&&e.yoffset?Math.max(t,Math.abs(e.yoffset||0)):t:t}function e(t){let e=0,n=0;for(let r=0;r<t.length;r++){const s=t[r].size;\"number\"==typeof s&&(e+=s,n++)}return e/n}function n(t,n){return\"number\"==typeof t?t:t&&t.stops&&t.stops.length?e(t.stops):n}function r(t,e){if(!e)return t;const r=e.filter((t=>\"size\"===t.type)).map((e=>{const{maxSize:r,minSize:s}=e;return(n(r,t)+n(s,t))/2}));let s=0;const o=r.length;if(0===o)return t;for(let n=0;n<o;n++)s+=r[n];const f=Math.floor(s/o);return Math.max(f,t)}function s(e){const n=e&&e.renderer,s=\"touch\"===(e&&e.event&&e.event.pointerType)?9:6;if(!n)return s;const o=\"visualVariables\"in n?r(s,n.visualVariables):s;if(\"simple\"===n.type)return t(o,n.symbol);if(\"unique-value\"===n.type){let e=o;return n.uniqueValueInfos.forEach((n=>{e=t(e,n.symbol)})),e}if(\"class-breaks\"===n.type){let e=o;return n.classBreakInfos.forEach((n=>{e=t(e,n.symbol)})),e}return n.type,o}export{s as calculateTolerance};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport\"../../geometry.js\";import{isSome as e,isNone as t}from\"../../core/maybe.js\";import{getMetersPerUnitForSR as r}from\"../../core/unitUtils.js\";import{calculateTolerance as n}from\"../../renderers/support/clickToleranceUtils.js\";import i from\"../../geometry/Extent.js\";function a(t,n,a,o=new i){let s;if(\"2d\"===a.type)s=n*a.resolution;else if(\"3d\"===a.type){const i=a.overlayPixelSizeInMapUnits(t),o=a.basemapSpatialReference;s=e(o)&&!o.equals(a.spatialReference)?r(o)/r(a.spatialReference):n*i}const m=t.x-s,p=t.y-s,c=t.x+s,l=t.y+s,{spatialReference:f}=a;return o.xmin=Math.min(m,c),o.ymin=Math.min(p,l),o.xmax=Math.max(m,c),o.ymax=Math.max(p,l),o.spatialReference=f,o}function o(e,r,i){const o=i.toMap(e);if(t(o))return!1;return a(o,n(),i,s).intersects(r)}const s=new i;export{a as createQueryGeometry,o as intersectsDrapedGeometry};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport\"../../../geometry.js\";import e from\"../../../core/Error.js\";import{isSome as n}from\"../../../core/maybe.js\";import{getMetersPerUnitForSR as t}from\"../../../core/unitUtils.js\";import{isLoaded as o,isSupported as r,load as i,getTransformation as a,project as s}from\"../../../geometry/projection.js\";import{project as l}from\"../../../geometry/support/webMercatorUtils.js\";import c from\"../../../geometry/Extent.js\";import x from\"../../../geometry/Point.js\";const m=5e-4,u=function(e,n){const t=(e.isWGS84||e.isWebMercator)&&(n.isWGS84||n.isWebMercator);return!(e.equals(n)||t)},f=function(e,n){const t=(e[0]+e[4]+e[4*n.cols]+e[4*n.cols+4])/4,o=(e[1]+e[5]+e[4*n.rows+1]+e[4*n.rows+5])/4;return[Math.abs(t-e[2*n.rows+2]),Math.abs(o-e[2*n.rows+3])]},p={3395:20037508.342789244,3410:17334193.943686873,3832:3339584.723798206,3857:20037508.342788905,3975:17367530.445161372,4087:20037508.342789244,4088:20015108.787169147,6933:17367530.445161372,8858:7396237.374497803,8859:2465412.4581659334,32662:20037508.342789244,53001:20015086.79602057,53002:10007543.39801029,53003:20015086.79602057,53004:20015086.79602057,53016:14152803.599503474,53017:17333573.624304302,53025:7276828.3848298555,53031:10384677.558821043,53034:20015086.79602057,53036:7389443.187332862,53037:2463147.729110953,53079:20015114.352186374,53080:20015114.352186374,54001:20037508.342789244,54002:10018754.171394624,54003:20037508.342789244,54004:20037508.342789244,54016:14168658.027268292,54017:17367530.44516137,54025:7311399.09166516,54031:10396310.810074743,54034:20037508.342789244,54050:808820.9223376509,54053:1920897.3915568967,54079:20037508.342789244,54080:20037508.342789244,54099:13524439.768288724,54100:20037508.342789244,54101:20037508.342789244,102038:4297258.582585486,102299:5013965.117483125},h=32;async function y(){if(o()||!r())return null;await i()}function M(n,t,r){if(!u(n.spatialReference,t))return null;if(!o())throw new e(\"rasterprojectionhelper-projectResolution\",\"projection engine is not loaded\");return r?a(t,n.spatialReference,n):a(n.spatialReference,t,n)}function g(n,t,r,i=null){if(n.spatialReference.equals(t))return n;const a=u(n.spatialReference,t);if(a&&!o())throw new e(\"rasterprojectionhelper-projectResolution\",\"projection engine is not loaded\");const x=r.center,m=new c({xmin:x.x-n.x/2,xmax:x.x+n.x/2,ymin:x.y-n.y/2,ymax:x.y+n.y/2,spatialReference:n.spatialReference}),f=a?s(m,t,i):l(m,t);if(null==f)return null;return{x:f.xmax-f.xmin,y:f.ymax-f.ymin}}function d(e,n=.01){return t(e)?n/t(e):0}function w(n,t,r=null,i=!0){const a=n.spatialReference;if(a.equals(t))return n;const c=u(a,t);if(c&&!o())throw new e(\"rasterprojectionhelper-projectResolution\",\"projection engine is not loaded\");const x=c?s(n,t,r):l(n,t);if(x&&i&&t.isGeographic){const[e,t]=v(a,!0),o=d(a);o&&null!=e&&null!=t&&(Math.abs(n.x-e)<o&&Math.abs(180-x.x)<m?x.x-=360:Math.abs(n.x-t)<o&&Math.abs(180+x.x)<m&&(x.x+=360))}return x}function R(e){const t=S(e[0].spatialReference);if(e.length<2||!n(t))return e[0];let{xmin:o,xmax:r,ymin:i,ymax:a}=e[0];for(let n=1;n<e.length;n++){const o=e[n];r=o.xmax+t*n,i=Math.min(i,o.ymin),a=Math.max(a,o.ymax)}return new c({xmin:o,xmax:r,ymin:i,ymax:a,spatialReference:e[0].spatialReference})}function j(e,t,o=null,r=!0){if(e.spatialReference.equals(t))return e;const i=W(e),a=S(e.spatialReference,!0);if(!n(a)||0===i)return b(e,t,o,r);return R(e.clone().normalize().map((e=>b(e,t,o,r))))}function b(n,t,r=null,i=!0){const a=n.spatialReference;if(a.equals(t))return n;const c=u(a,t);if(c&&!o())throw new e(\"rasterprojectionhelper-projectExtent\",\"projection engine is not loaded\");const f=c?s(n,t,r):l(n,t);let[p,h]=v(a,!0);if(f&&i&&a.isWebMercator&&t.isGeographic&&null!=p&&null!=h){const e=.001,o=1e3;if(Math.abs(n.xmin-p)<e&&Math.abs(h-n.xmax)>o&&Math.abs(180-f.xmax)<m){f.xmin=-180;const e=[];e.push(new x(n.xmax,n.ymin,a)),e.push(new x(n.xmax,(n.ymin+n.ymax)/2,a)),e.push(new x(n.xmax,n.ymax,a));const o=e.map((e=>w(e,t,r))).filter((e=>!isNaN(null==e?void 0:e.x))).map((e=>e.x));f.xmax=Math.max.apply(null,o)}if(Math.abs(n.xmax-h)<e&&Math.abs(p-n.xmin)>o&&Math.abs(180+f.xmin)<m){f.xmax=180;const e=[];e.push(new x(n.xmin,n.ymin,a)),e.push(new x(n.xmin,(n.ymin+n.ymax)/2,a)),e.push(new x(n.xmin,n.ymax,a));const o=e.map((e=>w(e,t,r))).filter((e=>!isNaN(null==e?void 0:e.x))).map((e=>e.x));f.xmin=Math.min.apply(null,o)}}[p,h]=v(t,!0);const y=d(t);return y&&null!=p&&null!=h&&(Math.abs(f.xmin-p)<y&&(f.xmin=p),Math.abs(f.xmax-h)<y&&(f.xmax=h)),f}function S(e,n=!1){const t=n?20037508.342787:20037508.342788905;return e.isWebMercator?2*t:e.wkid&&e.isGeographic?360:2*p[e.wkid]||null}function v(e,t=!1){const o=[],r=S(e,t);return n(r)&&(o.push(-r/2),o.push(r/2)),o}function N(e,n,t,o){let r=(e-n)/t;return r-Math.floor(r)!=0?r=Math.floor(r):o&&(r-=1),r}function W(e,t=!1){const o=S(e.spatialReference);if(!n(o))return 0;const r=t?0:-(o/2);return N(e.xmax,r,o,!0)-N(e.xmin,r,o,!1)}function z(e){const t=e.storageInfo.origin.x,o=S(e.spatialReference,!0);if(!n(o))return{originX:t,halfWorldWidth:null,pyramidsInfo:null};const r=o/2,{nativePixelSize:i,storageInfo:a,extent:s}=e,{maximumPyramidLevel:l,blockWidth:c,pyramidScalingFactor:x}=a;let m=i.x;const u=[],f=n(e.transform)&&\"gcs-shift\"===e.transform.type,p=t+r,h=f?o-t:r-t;for(let n=0;n<=l;n++){const e=(s.xmax-t)/m/c,n=e-Math.floor(e)==0?e:Math.ceil(e),r=(o/2-t)/m/c,i=r-Math.floor(r)==0?r:Math.ceil(r),a=Math.floor(p/m/c),l=Math.round(p/m)%c,f=(c-Math.round(h/m)%c)%c;u.push({resolutionX:m,blockWidth:c,datsetColumnCount:n,worldColumnCountFromOrigin:i,leftMargin:l,rightPadding:f,originColumnOffset:a}),m*=x}return{originX:t,halfWorldWidth:r,pyramidsInfo:u,hasGCSSShiftTransform:f}}function G(t,r,i,a=null,s=null,l=!1,c=[h,h]){if(u(t.spatialReference,r.spatialReference)&&!o())throw new e(\"rasterprojectionhelper-projectResolution\",\"projection engine is not loaded\");if(!(t&&r&&i))return null;const{xmin:m,ymin:p,xmax:y,ymax:M}=t,g=t.spatialReference,d=r.spatialReference,R=S(d);l=l||\"gcs-shift\"===(null==s?void 0:s.type);const j={x:c[0]*i.x,y:c[1]*i.y},b={cols:Math.ceil((y-m)/j.x-.1)+1,rows:Math.ceil((M-p)/j.y-.1)+1},v=j.x,N=j.y,W=[];let z,G=!1;for(let e=0;e<b.cols;e++){const t=[];for(let o=0;o<b.rows;o++){let i=w(new x({x:m+v*e,y:M-N*o,spatialReference:g}),d,a);s&&(i=s.inverseTransform(i)),t.push(i),e>0&&l&&i&&z[o]&&n(R)&&i.x<z[o].x&&(i.x+=R),i?(W.push((i.x-r.xmin)/(r.xmax-r.xmin)),W.push((r.ymax-i.y)/(r.ymax-r.ymin))):(W.push(NaN),W.push(NaN),G=!0)}z=t}const P=f(W,b),C=new Float32Array((b.cols-1)*(b.rows-1)*2*6),L=new Float32Array([-0,-1,1,-1,1,-0,1,-0,-0]),k=new Float32Array([-1,1,0,0,-1,1,1,0,0]);for(let e=0;e<b.cols-1;e++){for(let n=0;n<b.rows-1;n++){let t=e*b.rows*2+2*n;const o=W[t],r=W[t+1],i=W[t+2],a=W[t+3];t+=2*b.rows;const s=W[t],l=W[t+1],c=W[t+2],x=W[t+3];let m=0,u=12*(n*(b.cols-1)+e);for(let e=0;e<3;e++)C[u++]=L[m++]*o+L[m++]*i+L[m++]*c;m=0;for(let e=0;e<3;e++)C[u++]=L[m++]*r+L[m++]*a+L[m++]*x;m=0;for(let e=0;e<3;e++)C[u++]=k[m++]*o+k[m++]*s+k[m++]*c;m=0;for(let e=0;e<3;e++)C[u++]=k[m++]*r+k[m++]*l+k[m++]*x}if(G)for(let e=0;e<C.length;e++)isNaN(C[e])&&(C[e]=-1)}return{offsets:W,error:P,coefficients:C,spacing:c,size:[b.cols-1,b.rows-1]}}function P(e){const n=e.clone().normalize();return 1===n.length?n[0]:R(n)}function C(e,t,o){const{storageInfo:r,pixelSize:i}=t;let a,s=!1;const{pyramidResolutions:l}=r;if(n(l)&&l.length){const n=(e.x+e.y)/2,r=l[l.length-1],c=(r.x+r.y)/2,m=(i.x+i.y)/2;if(n<=m)a=0;else if(n>=c)a=l.length,s=n/c>8;else{let e,t=m;for(let r=1;r<=l.length;r++){if(e=(l[r-1].x+l[r-1].y)/2,n<=e){n===e?a=r:\"down\"===o?(a=r-1,s=n/t>8):a=\"up\"===o||n-t>e-n||n/t>2?r:r-1;break}t=e}}const u=0===a?i:l[a-1];return{pyramidLevel:a,pyramidResolution:new x({x:u.x,y:u.y,spatialReference:t.spatialReference}),excessiveReading:s}}const c=Math.log(e.x/i.x)/Math.LN2,m=Math.log(e.y/i.y)/Math.LN2,u=t.storageInfo.maximumPyramidLevel||0;a=\"down\"===o?Math.floor(Math.min(c,m)):\"up\"===o?Math.ceil(Math.max(c,m)):Math.round((c+m)/2),a<0?a=0:a>u&&(s=a>u+3,a=u);const f=2**a;return{pyramidLevel:a,pyramidResolution:new x({x:f*t.nativePixelSize.x,y:f*t.nativePixelSize.y,spatialReference:t.spatialReference}),excessiveReading:s}}function L(e,n,o=512,r=!0){const{extent:i,spatialReference:a,pixelSize:s}=e,l=g(new x({x:s.x,y:s.y,spatialReference:a}),n,i);if(null==l)return{projectedPixelSize:null,scales:null,srcResolutions:null,isCustomTilingScheme:!1};const c=(l.x+l.y)/2,m=t(n),u=c*m*96*39.37,f=n.isGeographic?256/o*295828763.7958547:256/o*591657527.591555;let p=!1;const h=j(i,n);r&&(n.isGeographic||n.isWebMercator)&&(p=h.xmin*h.xmax<0);let y,M=u;const d=1.001;if(p){M=f;const e=n.isGeographic?1341104507446289e-21:.29858214164761665,t=e*(96*m*39.37),o=n.isGeographic?4326:3857;y=g(new x({x:e,y:e,spatialReference:{wkid:o}}),a,h),y.x*=M/t,y.y*=M/t}else{y={x:s.x,y:s.y};const n=Math.ceil(Math.log(Math.min(e.width,e.height)/32)/Math.LN2);let t=0;for(;M<f*(d/2)&&t<n;)t++,M*=2,y.x*=2,y.y*=2;Math.max(M,f)/Math.min(M,f)<=d&&(M=f)}const w=[M],R=[{x:y.x,y:y.y}],b=70.5310735,S=Math.min(b,u)/d;for(;M>=S;)M/=2,y.x/=2,y.y/=2,w.push(M),R.push({x:y.x,y:y.y});return{projectedPixelSize:l,scales:w,srcResolutions:R,isCustomTilingScheme:!p}}export{L as computeProjectedScales,h as defaultGridSpacing,M as getDefaultDatumTransformationForDataset,G as getProjectionOffsetGrid,z as getRasterDatasetAlignmentInfo,W as getWorldWrapCount,y as load,j as projectExtent,w as projectPoint,g as projectResolution,P as snapExtent,C as snapPyramid};\n"],"sourceRoot":""}