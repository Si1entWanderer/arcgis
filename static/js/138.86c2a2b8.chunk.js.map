{"version":3,"sources":["../node_modules/@arcgis/core/views/layers/WMSLayerView.js","../node_modules/@arcgis/core/views/3d/layers/WMSLayerView3D.js","../node_modules/@arcgis/core/layers/support/ExportWMSImageParameters.js"],"names":["a","i","this","exportImageParameters","p","layer","destroy","e","commitProperty","_get","t","Promise","reject","r","o","popupEnabled","s","createFetchPopupFeaturesQuery","resolve","extent","width","height","m","x","n","y","u","fetchFeatureInfo","prototype","readOnly","arguments","type","supportsSpatialReference","view","spatialReference","addResolvingPromise","updatingHandles","add","addPromise","refreshDebounced","findExtentInfoAt","imageSize","Math","round","xmin","ymax","timeExtent","visible","l","scale","_set","handles","remove","sublayers","on","notifyChange","propertyName","visibleSublayers","filter","name","map","join","forEach","minScale","maxScale","unshift","layers","format","imageFormat","request","service","styles","transparent","imageTransparency","version","Number"],"mappings":"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","file":"static/js/138.86c2a2b8.chunk.js","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../chunks/tslib.es6.js\";import r from\"../../core/Error.js\";import{property as t}from\"../../core/accessorSupport/decorators/property.js\";import\"../../core/has.js\";import\"../../core/accessorSupport/ensureType.js\";import\"../../core/Logger.js\";import{subclass as o}from\"../../core/accessorSupport/decorators/subclass.js\";import{combinedViewLayerTimeExtentProperty as s}from\"../../layers/support/commonProperties.js\";import{ExportWMSImageParameters as p}from\"../../layers/support/ExportWMSImageParameters.js\";const a=a=>{let i=class extends a{initialize(){this.exportImageParameters=new p({layer:this.layer})}destroy(){this.exportImageParameters.destroy(),this.exportImageParameters=null}get exportImageVersion(){var e;return null==(e=this.exportImageParameters)||e.commitProperty(\"version\"),this.commitProperty(\"timeExtent\"),(this._get(\"exportImageVersion\")||0)+1}fetchPopupFeatures(e){const{layer:t}=this;if(!e)return Promise.reject(new r(\"wmslayerview:fetchPopupFeatures\",\"Nothing to fetch without area\",{layer:t}));const{popupEnabled:o}=t;if(!o)return Promise.reject(new r(\"wmslayerview:fetchPopupFeatures\",\"popupEnabled should be true\",{popupEnabled:o}));const s=this.createFetchPopupFeaturesQuery(e);if(!s)return Promise.resolve([]);const{extent:p,width:a,height:i,x:m,y:n}=s;if(!(p&&a&&i))throw new r(\"wmslayerview:fetchPopupFeatures\",\"WMSLayer does not support fetching features.\",{extent:p,width:a,height:i});const u=t.fetchFeatureInfo(p,a,i,m,n);return Promise.resolve(u?[u]:[])}};return e([t()],i.prototype,\"exportImageParameters\",void 0),e([t({readOnly:!0})],i.prototype,\"exportImageVersion\",null),e([t()],i.prototype,\"layer\",void 0),e([t(s)],i.prototype,\"timeExtent\",void 0),i=e([o(\"esri.layers.mixins.WMSLayerView\")],i),i};export default a;export{a as WMSLayerView};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../../chunks/tslib.es6.js\";import t from\"../../../core/Error.js\";import{property as r}from\"../../../core/accessorSupport/decorators/property.js\";import\"../../../core/has.js\";import\"../../../core/accessorSupport/ensureType.js\";import\"../../../core/Logger.js\";import{subclass as s}from\"../../../core/accessorSupport/decorators/subclass.js\";import i from\"../../../geometry/Extent.js\";import o from\"./DynamicLayerView3D.js\";import{WMSLayerView as a}from\"../../layers/WMSLayerView.js\";let p=class extends(a(o)){constructor(){super(...arguments),this.type=\"wms-3d\"}initialize(){this.layer.supportsSpatialReference(this.view.spatialReference)||this.addResolvingPromise(Promise.reject(new t(\"layerview:spatial-reference-incompatible\",\"The spatial references supported by this WMS layer are incompatible with the spatial reference of the view\"))),this.updatingHandles.add(this.exportImageParameters,\"version\",(()=>{this.updatingHandles.addPromise(this.refreshDebounced())}))}createFetchPopupFeaturesQuery(e){const t=this.findExtentInfoAt(e),r=t.extent,s=new i(r[0],r[1],r[2],r[3],t.spatialReference),o=t.imageSize,a=o.width,p=o.height,n=s.width/a;return{extent:s,width:a,height:p,x:Math.round((e.x-s.xmin)/n),y:Math.round((s.ymax-e.y)/n)}}getFetchOptions(){return{timeExtent:this.timeExtent}}};e([r()],p.prototype,\"suspended\",void 0),p=e([s(\"esri.views.3d.layers.WMSLayerView3D\")],p);var n=p;export default n;\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../chunks/tslib.es6.js\";import r from\"../../core/Accessor.js\";import{HandleOwnerMixin as s}from\"../../core/HandleOwner.js\";import{property as t}from\"../../core/accessorSupport/decorators/property.js\";import\"../../core/has.js\";import\"../../core/accessorSupport/ensureType.js\";import\"../../core/Logger.js\";import{subclass as o}from\"../../core/accessorSupport/decorators/subclass.js\";const a={visible:\"visibleSublayers\"};let l=class extends(s(r)){constructor(e){super(e),this.scale=0}set layer(e){this._get(\"layer\")!==e&&(this._set(\"layer\",e),this.handles.remove(\"layer\"),e&&this.handles.add([e.sublayers.on(\"change\",(()=>this.notifyChange(\"visibleSublayers\"))),e.on(\"wms-sublayer-update\",(e=>this.notifyChange(a[e.propertyName])))],\"layer\"))}get layers(){const{visibleSublayers:e}=this;return e.filter((e=>e.name)).map((e=>e.name)).join(\",\")}get version(){this.commitProperty(\"layers\");const e=this.layer;return e&&e.commitProperty(\"imageTransparency\"),(this._get(\"version\")||0)+1}get visibleSublayers(){const{layer:e,scale:r}=this,s=null==e?void 0:e.sublayers,t=[],o=e=>{const{minScale:s,maxScale:a,sublayers:l,visible:i}=e;i&&(0===r||(0===s||r<=s)&&(0===a||r>=a))&&(l?l.forEach(o):t.unshift(e))};return null==s||s.forEach(o),t}toJSON(){const{layer:e,layers:r}=this,{imageFormat:s,imageTransparency:t,version:o}=e;return{format:s,request:\"GetMap\",service:\"WMS\",styles:\"\",transparent:t,version:o,layers:r}}};e([t()],l.prototype,\"layer\",null),e([t({readOnly:!0})],l.prototype,\"layers\",null),e([t({type:Number})],l.prototype,\"scale\",void 0),e([t({readOnly:!0})],l.prototype,\"version\",null),e([t({readOnly:!0})],l.prototype,\"visibleSublayers\",null),l=e([o(\"esri.layers.support.ExportWMSImageParameters\")],l);export{l as ExportWMSImageParameters};\n"],"sourceRoot":""}