{"version":3,"sources":["../node_modules/@arcgis/core/views/3d/layers/analysis/LineOfSight/LineOfSightAnalysis.js","../node_modules/@arcgis/core/views/3d/layers/analysis/LineOfSight/LineOfSightResult.js","../node_modules/@arcgis/core/views/3d/layers/analysis/LineOfSight/LineOfSightController.js","../node_modules/@arcgis/core/views/3d/layers/analysis/LineOfSight/LineOfSightConfiguration.js","../node_modules/@arcgis/core/views/3d/layers/analysis/LineOfSight/LineOfSightLayerViewData.js","../node_modules/@arcgis/core/views/3d/layers/analysis/LineOfSight/LineOfSightView.js","../node_modules/@arcgis/core/views/3d/layers/LineOfSightLayerView3D.js","../node_modules/@arcgis/core/views/3d/interactive/visualElements/Object3DVisualElement.js","../node_modules/@arcgis/core/views/3d/interactive/visualElements/VisualElement.js","../node_modules/@arcgis/core/views/3d/interactive/visualElements/LineVisualElement.js"],"names":["i","t","inputPoints","isValid","observer","r","target","observerAdjusted","targetAdjusted","computationResult","start","end","intersection","isTargetVisible","result","this","notifyChange","s","o","prototype","e","V","_tasks","w","_handles","_analysisHandles","view","resourceController","scheduler","registerTask","S","LINE_OF_SIGHT_TOOL","add","d","layer","_onObserverChange","_connectAnalyses","_connectTargets","_intersector","I","state","viewingMode","options","hud","store","destroy","_analyses","removeAll","updating","priority","layerViewData","analyses","observerEngineLocation","camera","computeScreenPixelSizeAt","_observerEngineLocation","analysis","n","a","l","y","_canComputeAnalysis","_computeAnalysisIntersection","_interpolateAnalysisIntersection","updateComputationResults","_screenPixelSize","R","_","c","m","v","Math","min","f","p","interpolationInfo","sceneIntersectionHelper","renderCoordsHelper","h","u","g","C","H","intersectToolIntersectorRay","results","getIntersectionPoint","originalIntersection","originalObserver","originalTarget","fromRenderCoords","spatialReference","A","P","E","intersectedGraphic","L","intersectedLocation","visible","b","frustum","intersectsPoint","targets","T","toRenderCoords","LINE_OF_SIGHT_TOOL_INTERACTIVE","_adjustStartEndPositions","updateInputPoints","_onTargetLocationChange","_onObserverChangeForAnalysis","_onObserverEngineForAnalysis","getLineOfSightComputationDependencies","schedule","computeAnalysis","has","_connectAnalysisToTarget","_connectAnalysisToObserver","_connectAnalysisToObserverEngine","_connectAnalysisForCompute","remove","added","forEach","_connectAnalysis","removed","_disconnectAnalysis","items","length","_addTarget","on","_onTargetCollectionChange","_removeTarget","some","j","find","_onAnalysesCollectionChange","_onTargetsChange","constructOnly","O","innerWidth","outerWidth","visibleInnerColor","visibleOuterColor","occludedInnerColor","occludedOuterColor","undefinedInnerColor","undefinedOuterColor","type","Number","arguments","configuration","_handle","_configuration","attached","width","visibleLineVisualElement","color","toUnitRGBA","innerColor","occludedLineVisualElement","undefinedLineVisualElement","geometry","transform","createLineOfSightVisualization","getLineOfSightVisualizationDependencies","updateLineOfSightVisualization","destroyLineOfSightVisualization","moved","_layerViewData","_analysisController","_analysisView","map","readOnly","_resources","_transform","object","transformation","createResources","_stage","removeMany","geometries","removeAllGeometries","createGeometries","setVisible","addMany","destroyResources","isPickable","updatePolicy","castShadow","createExternalResources","forEachExternalMaterial","dispose","destroyExternalResources","_attached","_resourcesCreated","_visible","watch","_createResources","_destroyResources","console","error","updateVisibility","_renderOccluded","_width","_color","_innerWidth","_innerColor","_stipplePattern","_stippleOffColor","_stippleIntegerRepeats","_writeDepthEnabled","_falloff","_polygonOffset","applyProps","push","lines","origin","endpoint","basis1","basis2","endRenderSpace","createRenderGeometry","points","_updateMaterial","_geometry","recreateGeometry","recreate","_material","materialParameters","_createLineGeometries","addGeometry","stippleOffColor","stipplePattern","isClosed","falloff","stippleIntegerRepeats","polygonOffset","renderOccluded","writeDepth","setParameterValues","Float64Array","attributeData","position","removeDuplicateStartEnd"],"mappings":"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","file":"static/js/76.6bcb8f40.chunk.js","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport{_ as t}from\"../../../../../chunks/tslib.es6.js\";import s from\"../../../../../core/Accessor.js\";import{property as o}from\"../../../../../core/accessorSupport/decorators/property.js\";import\"../../../../../core/has.js\";import\"../../../../../core/accessorSupport/ensureType.js\";import\"../../../../../core/Logger.js\";import{subclass as e}from\"../../../../../core/accessorSupport/decorators/subclass.js\";import{c as r}from\"../../../../../chunks/vec3f64.js\";let i=class extends s{constructor(t){super(t),this.inputPoints={isValid:!1,observer:r(),target:r(),observerAdjusted:r(),targetAdjusted:r()},this.computationResult={start:r(),end:r(),intersection:r(),isValid:!1,isTargetVisible:!1},this.result=null}updateComputationResults(){this.notifyChange(\"computationResult\")}updateInputPoints(){this.notifyChange(\"inputPoints\")}};t([o()],i.prototype,\"target\",void 0),t([o()],i.prototype,\"inputPoints\",void 0),t([o()],i.prototype,\"computationResult\",void 0),t([o()],i.prototype,\"result\",void 0),i=t([e(\"esri.views.3d.layers.analysis.LineOfSight.LineOfSightAnalysis\")],i);export{i as LineOfSightAnalysis};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport{_ as o}from\"../../../../../chunks/tslib.es6.js\";import r from\"../../../../../core/Accessor.js\";import{property as e}from\"../../../../../core/accessorSupport/decorators/property.js\";import\"../../../../../core/has.js\";import\"../../../../../core/accessorSupport/ensureType.js\";import\"../../../../../core/Logger.js\";import{subclass as s}from\"../../../../../core/accessorSupport/decorators/subclass.js\";let t=class extends r{constructor(o){super(o)}};o([e()],t.prototype,\"target\",void 0),o([e()],t.prototype,\"intersectedGraphic\",void 0),o([e()],t.prototype,\"intersectedLocation\",void 0),o([e()],t.prototype,\"visible\",void 0),t=o([s(\"esri.views.3d.layers.analysis.LineOfSight.LineOfSightResult\")],t);export{t as LineOfSightResult};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../../../../chunks/tslib.es6.js\";import\"../../../../../geometry.js\";import t from\"../../../../../core/Accessor.js\";import s from\"../../../../../core/Handles.js\";import{handlesGroup as n,makeHandle as r}from\"../../../../../core/handleUtils.js\";import{isNone as i,isSome as o,abortMaybe as a,removeMaybe as l,none as c}from\"../../../../../core/maybe.js\";import{createTask as p,ignoreAbortErrors as h}from\"../../../../../core/promiseUtils.js\";import{property as u}from\"../../../../../core/accessorSupport/decorators/property.js\";import\"../../../../../core/has.js\";import\"../../../../../core/accessorSupport/ensureType.js\";import\"../../../../../core/Logger.js\";import{subclass as g}from\"../../../../../core/accessorSupport/decorators/subclass.js\";import{reactionInit as d}from\"../../../../../core/accessorSupport/trackingUtils.js\";import{g as y,f as _,n as m,a as v,b as f,j as A,w as b}from\"../../../../../chunks/vec3.js\";import{c as T}from\"../../../../../chunks/vec3f64.js\";import{fromPoints as C,create as O}from\"../../../../../geometry/support/ray.js\";import{LineOfSightAnalysis as j}from\"./LineOfSightAnalysis.js\";import{LineOfSightResult as E}from\"./LineOfSightResult.js\";import{Intersector as I}from\"../../../webgl-engine/lib/Intersector.js\";import{toGraphic as L}from\"../../../webgl-engine/lib/intersectorUtilsConversions.js\";import{ImmediateTask as w,TaskPriority as S}from\"../../../../support/Scheduler.js\";import P from\"../../../../../geometry/Point.js\";let V=class extends t{constructor(e){super(e),this._tasks=w,this._handles=new s,this._analysisHandles=new s}initialize(){var e;const t=null==(e=this.view.resourceController)?void 0:e.scheduler;t&&(this._tasks=t.registerTask(S.LINE_OF_SIGHT_TOOL));this._handles.add([d((()=>this.layer.observer),(e=>this._onObserverChange(e))),this._connectAnalyses(),this._connectTargets()]),this._intersector=new I(this.view.state.viewingMode),this._intersector.options.hud=!1,this._intersector.options.store=0}destroy(){this._handles.destroy(),this._analysisHandles.destroy(),this._analyses.removeAll()}get updating(){return this._tasks.updating}get priority(){return this._tasks.priority}set priority(e){this._tasks.priority=e}get _analyses(){return this.layerViewData.analyses}get _observerEngineLocation(){return this.layerViewData.observerEngineLocation}set _observerEngineLocation(e){this.layerViewData.observerEngineLocation=e}get _screenPixelSize(){return this.view.state.camera.computeScreenPixelSizeAt(this._observerEngineLocation)}getLineOfSightComputationDependencies(e){const{inputPoints:t}=e;return{inputPoints:t}}computeAnalysis(e,t=!1){const{analysis:s}=e,{inputPoints:n,computationResult:r}=s,{observerAdjusted:i,targetAdjusted:o}=n,{start:a,end:l}=r;y(a,i),y(l,o);t||this._canComputeAnalysis(s)?this._computeAnalysisIntersection(e):this._interpolateAnalysisIntersection(e),s.updateComputationResults()}_adjustStartEndPositions(e){const t=this._screenPixelSize,s=this.view,{inputPoints:n}=e,{observer:r,target:i,observerAdjusted:o,targetAdjusted:a}=n,l=R;_(l,i,r);const c=t;m(l,l),v(l,l,Math.min(c,1)),f(o,r,l),_(l,r,i);const p=s.state.camera.computeScreenPixelSizeAt(i);m(l,l),v(l,l,Math.min(p,1)),f(a,i,l)}_computeAnalysisIntersection({analysis:e,interpolationInfo:t}){const{view:s}=this,{sceneIntersectionHelper:n,renderCoordsHelper:r}=s;if(i(n))return;const o=this._intersector,{computationResult:a,inputPoints:l}=e,{observer:c,target:p}=l,{start:h,end:u}=a,g=C(h,u,H);n.intersectToolIntersectorRay(g,o);const d=a.intersection,_=R,m=!!o.results.min&&o.results.min.getIntersectionPoint(d);let v=!0;if(m){y(t.originalIntersection,d),y(t.originalObserver,h),y(t.originalTarget,u),r.fromRenderCoords(d,_,s.spatialReference);const e=1-A(u,p)/A(h,p);v=A(c,d)>=e*A(c,p)}const f=new P(_,s.spatialReference);e.result=new E({target:e.target,intersectedGraphic:v?null:L(o.results.min,s),intersectedLocation:v?null:f,visible:!!m&&v}),a.isValid=l.isValid=!0,a.isTargetVisible=v}_interpolateAnalysisIntersection({analysis:e,interpolationInfo:t}){const{computationResult:s,inputPoints:n}=e,{start:r,end:i,intersection:o}=s,{originalIntersection:a,originalObserver:l,originalTarget:c}=t;if(y(o,a),n.isValid){const e=R,t=A(l,a)/A(l,c);b(e,r,l),v(e,e,1-t),f(o,o,e),b(e,i,c),v(e,e,t),f(o,o,e),s.isValid=!0}else e.result=null,s.isValid=!1,s.isTargetVisible=!1}_canComputeAnalysis(e){const t=this.layer.observer,s=this.view.frustum;if(i(t)||i(e.target)||i(s))return!1;const{observerAdjusted:n,targetAdjusted:r}=e.inputPoints,o=s.intersectsPoint(n),a=s.intersectsPoint(r);return o&&a}_onObserverChange(e){if(i(e))return void this.layer.targets.removeAll();const t=T();this.view.renderCoordsHelper.toRenderCoords(e,t),this._observerEngineLocation=t,this.priority=S.LINE_OF_SIGHT_TOOL_INTERACTIVE}_onObserverChangeForAnalysis(e){e.inputPoints.isValid=!1}_onObserverEngineForAnalysis(e,t){const{inputPoints:s}=e;y(s.observer,t),this._adjustStartEndPositions(e),e.updateInputPoints(),this.priority=S.LINE_OF_SIGHT_TOOL_INTERACTIVE}_onTargetLocationChange(e,t){const{inputPoints:s}=e;s.isValid=!1,this.view.renderCoordsHelper.toRenderCoords(t,s.target),this._adjustStartEndPositions(e),e.updateInputPoints(),this.priority=S.LINE_OF_SIGHT_TOOL_INTERACTIVE}_connectAnalysisToTarget(e){return d((()=>({analysis:e,target:e.target})),(({analysis:e,target:t})=>{o(t)&&this._onTargetLocationChange(e,t)}))}_connectAnalysisToObserver(e){return d((()=>({analysis:e,observer:this.layer.observer})),(({analysis:e})=>{this._onObserverChangeForAnalysis(e)}))}_connectAnalysisToObserverEngine(e){return d((()=>({analysis:e,observer:this._observerEngineLocation})),(({analysis:e,observer:t})=>{this._onObserverEngineForAnalysis(e,t)}))}_connectAnalysisForCompute(e){let t=c;const s={analysis:e,interpolationInfo:{originalIntersection:T(),originalObserver:T(),originalTarget:T()}};return n([d((()=>this.getLineOfSightComputationDependencies(e)),(()=>{t=a(t),t=p((async e=>{await h(this._tasks.schedule((()=>this.computeAnalysis(s)),e))}))})),r((()=>t=a(t)))])}_connectAnalysis(e){const t=this._analysisHandles;t.has(e)||t.add([this._connectAnalysisToTarget(e),this._connectAnalysisToObserver(e),this._connectAnalysisToObserverEngine(e),this._connectAnalysisForCompute(e)])}_disconnectAnalysis(e){this._analysisHandles.remove(e)}_onAnalysesCollectionChange(e){e.added.forEach((e=>this._connectAnalysis(e))),e.removed.forEach((e=>this._disconnectAnalysis(e)))}_onTargetsChange(e){return this._analyses.removeAll(),e.items.length>0&&e.forEach((e=>this._addTarget(e))),e.on(\"change\",(e=>this._onTargetCollectionChange(e)))}_onTargetCollectionChange(e){e.added.forEach((e=>this._addTarget(e))),e.removed.forEach((e=>this._removeTarget(e)))}_addTarget(e){const t=this._analyses;t.some((t=>t.target===e))||t.add(new j({target:e}))}_removeTarget(e){const t=this._analyses,s=t.find((t=>t.target===e));t.remove(s)}_connectAnalyses(){let e=null;return n([d((()=>this._analyses),(t=>{e=l(e),e=t.on(\"change\",(e=>this._onAnalysesCollectionChange(e))),t.forEach((e=>this._connectAnalysis(e)))})),r((()=>e=l(e)))])}_connectTargets(){let e=null;return n([d((()=>this.layer.targets),(t=>{e=l(e),e=this._onTargetsChange(t)})),r((()=>e=l(e)))])}};e([u({constructOnly:!0})],V.prototype,\"layer\",void 0),e([u({constructOnly:!0})],V.prototype,\"layerViewData\",void 0),e([u({constructOnly:!0})],V.prototype,\"view\",void 0),e([u()],V.prototype,\"updating\",null),e([u()],V.prototype,\"priority\",null),e([u()],V.prototype,\"_analyses\",null),e([u()],V.prototype,\"_observerEngineLocation\",null),e([u()],V.prototype,\"_screenPixelSize\",null),e([u()],V.prototype,\"_tasks\",void 0),V=e([g(\"esri.views.3d.layers.analysis.LineOfSight.LineOfSightController\")],V);const R=T(),H=O();export{V as LineOfSightController};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport{_ as o}from\"../../../../../chunks/tslib.es6.js\";import e from\"../../../../../Color.js\";import r from\"../../../../../core/Accessor.js\";import{property as t}from\"../../../../../core/accessorSupport/decorators/property.js\";import\"../../../../../core/has.js\";import\"../../../../../core/accessorSupport/ensureType.js\";import\"../../../../../core/Logger.js\";import{subclass as i}from\"../../../../../core/accessorSupport/decorators/subclass.js\";let s=class extends r{constructor(o){super(o),this.innerWidth=2,this.outerWidth=8,this.visibleInnerColor=new e([3,252,111,1]),this.visibleOuterColor=new e([3,252,111,.15]),this.occludedInnerColor=new e([252,3,69,1]),this.occludedOuterColor=new e([252,3,69,.1]),this.undefinedInnerColor=new e([255,255,255,1]),this.undefinedOuterColor=new e([127,127,127,.2])}};o([t({type:Number})],s.prototype,\"innerWidth\",void 0),o([t({type:Number})],s.prototype,\"outerWidth\",void 0),o([t({type:e})],s.prototype,\"visibleInnerColor\",void 0),o([t({type:e})],s.prototype,\"visibleOuterColor\",void 0),o([t({type:e})],s.prototype,\"occludedInnerColor\",void 0),o([t({type:e})],s.prototype,\"occludedOuterColor\",void 0),o([t({type:e})],s.prototype,\"undefinedInnerColor\",void 0),o([t({type:e})],s.prototype,\"undefinedOuterColor\",void 0),s=o([i(\"esri.views.3d.layers.analysis.LineOfSight.LineOfSightConfiguration\")],s);export{s as LineOfSightConfiguration};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport{_ as o}from\"../../../../../chunks/tslib.es6.js\";import r from\"../../../../../core/Accessor.js\";import s from\"../../../../../core/Collection.js\";import{property as e}from\"../../../../../core/accessorSupport/decorators/property.js\";import\"../../../../../core/has.js\";import\"../../../../../core/accessorSupport/ensureType.js\";import\"../../../../../core/Logger.js\";import{subclass as t}from\"../../../../../core/accessorSupport/decorators/subclass.js\";import{c as i}from\"../../../../../chunks/vec3f64.js\";import{LineOfSightConfiguration as c}from\"./LineOfSightConfiguration.js\";let p=class extends r{constructor(){super(...arguments),this.analyses=new s,this.configuration=new c,this.observerEngineLocation=i()}};o([e()],p.prototype,\"analyses\",void 0),o([e({type:c})],p.prototype,\"configuration\",void 0),o([e()],p.prototype,\"observerEngineLocation\",void 0),p=o([t(\"esri.views.3d.layers.analysis.LineOfSight.LineOfSightLayerViewData\")],p);export{p as LineOfSightLayerViewData};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../../../../chunks/tslib.es6.js\";import i from\"../../../../../Color.js\";import t from\"../../../../../core/Accessor.js\";import o from\"../../../../../core/Handles.js\";import{makeHandle as n,handlesGroup as s}from\"../../../../../core/handleUtils.js\";import{removeMaybe as r,destroyMaybe as l}from\"../../../../../core/maybe.js\";import{property as a}from\"../../../../../core/accessorSupport/decorators/property.js\";import\"../../../../../core/has.js\";import\"../../../../../core/accessorSupport/ensureType.js\";import\"../../../../../core/Logger.js\";import{subclass as c}from\"../../../../../core/accessorSupport/decorators/subclass.js\";import{reactionInit as u}from\"../../../../../core/accessorSupport/trackingUtils.js\";import{c as d}from\"../../../../../chunks/mat4f64.js\";import{f as m}from\"../../../../../chunks/vec3.js\";import{d as h,c as p}from\"../../../../../chunks/vec3f64.js\";import{LineVisualElement as f}from\"../../../interactive/visualElements/LineVisualElement.js\";let y=class extends t{constructor(e){super(e),this._handle=null,this._analysisHandles=new o}initialize(){this._handle=this._connectAnalyses()}destroy(){this._handle=r(this._handle),this._analysisHandles=l(this._analysisHandles)}get _analyses(){return this.layerViewData.analyses}get _configuration(){return this.layerViewData.configuration}createLineOfSightVisualization(){const e=this._configuration,t={view:this.view,attached:!0,width:e.outerWidth,innerWidth:e.innerWidth};return{visibleLineVisualElement:new f({...t,color:i.toUnitRGBA(e.visibleOuterColor),innerColor:i.toUnitRGBA(e.visibleInnerColor)}),occludedLineVisualElement:new f({...t,color:i.toUnitRGBA(e.occludedOuterColor),innerColor:i.toUnitRGBA(e.occludedInnerColor)}),undefinedLineVisualElement:new f({...t,color:i.toUnitRGBA(e.undefinedOuterColor),innerColor:i.toUnitRGBA(e.undefinedInnerColor)})}}destroyLineOfSightVisualization(e){e.visibleLineVisualElement=l(e.visibleLineVisualElement),e.occludedLineVisualElement=l(e.occludedLineVisualElement),e.undefinedLineVisualElement=l(e.undefinedLineVisualElement)}updateLineOfSightVisualization(e,t){const o=this._configuration,{computationResult:n,inputPoints:s}=e,{start:r,end:l,intersection:a,isValid:c,isTargetVisible:u}=n,{observer:d}=s,p=v;p[12]=d[0],p[13]=d[1],p[14]=d[2];const f=m(g,r,d),y=m(V,l,d),L=m(_,a,d),{visibleLineVisualElement:C,occludedLineVisualElement:O,undefinedLineVisualElement:A}=t;C.geometry=null,O.geometry=null,A.geometry=null,c?u?(C.geometry=[[h(f),h(y)]],C.transform=p,C.color=i.toUnitRGBA(o.visibleOuterColor)):(C.geometry=[[h(f),h(L)]],C.transform=p,C.color=i.toUnitRGBA(o.occludedOuterColor),O.geometry=[[h(L),h(y)]],O.transform=p):(A.geometry=[[h(f),h(y)]],A.transform=p)}getLineOfSightVisualizationDependencies(e){const{computationResult:i}=e,{occludedOuterColor:t,visibleOuterColor:o}=this._configuration;return{computationResult:i,occludedOuterColor:t,visibleOuterColor:o}}_connectAnalysis(e){const i=this._analysisHandles;if(i.has(e))return;const t=this.createLineOfSightVisualization();i.add([u((()=>this.getLineOfSightVisualizationDependencies(e)),(()=>this.updateLineOfSightVisualization(e,t))),n((()=>this.destroyLineOfSightVisualization(t)))])}_disconnectAnalysis(e){this._analysisHandles.remove(e)}_connectAnalyses(){let e=null;return s([u((()=>this._analyses),(i=>{e=r(e),e=i.on(\"change\",(e=>this._onAnalysesCollectionChange(e))),this._onAnalysesCollectionChange({target:i,added:i.items,removed:[],moved:[]})})),n((()=>e=r(e)))])}_onAnalysesCollectionChange(e){e.added.forEach((e=>this._connectAnalysis(e))),e.removed.forEach((e=>this._disconnectAnalysis(e)))}};e([a({constructOnly:!0})],y.prototype,\"layer\",void 0),e([a({constructOnly:!0})],y.prototype,\"view\",void 0),e([a({constructOnly:!0})],y.prototype,\"layerViewData\",void 0),e([a()],y.prototype,\"_analyses\",null),e([a()],y.prototype,\"_configuration\",null),y=e([c(\"esri.views.3d.layers.analysis.LineOfSight.LineOfSightView\")],y);const g=p(),V=p(),_=p(),v=d();export{y as LineOfSightView};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport{_ as r}from\"../../../chunks/tslib.es6.js\";import{destroyMaybe as e,applySome as t,unwrapOr as i,mapOr as s}from\"../../../core/maybe.js\";import{property as o}from\"../../../core/accessorSupport/decorators/property.js\";import\"../../../core/has.js\";import\"../../../core/accessorSupport/ensureType.js\";import\"../../../core/Logger.js\";import{subclass as a}from\"../../../core/accessorSupport/decorators/subclass.js\";import{LayerView3D as l}from\"./LayerView3D.js\";import{LineOfSightController as n}from\"./analysis/LineOfSight/LineOfSightController.js\";import{LineOfSightLayerViewData as y}from\"./analysis/LineOfSight/LineOfSightLayerViewData.js\";import{LineOfSightView as p}from\"./analysis/LineOfSight/LineOfSightView.js\";import h from\"../../layers/LayerView.js\";let m=class extends(l(h)){constructor(){super(...arguments),this.type=\"line-of-sight-3d\",this._layerViewData=new y}initialize(){const r=this.view,e=this.layer,t=this._layerViewData;this._analysisController=new n({layer:e,layerViewData:t,view:r}),this._analysisView=new p({layer:e,layerViewData:t,view:r})}destroy(){this._analysisController=e(this._analysisController),this._analysisView=e(this._analysisView)}get results(){return this._layerViewData.analyses.map((r=>r.result))}get priority(){return this._analysisController.priority}set priority(r){this._analysisController.priority=r}getResultForTarget(r){const e=this._layerViewData.analyses.find((e=>e.target===r)),s=t(e,(r=>r.result));return i(s,null)}isUpdating(){return s(this._analysisController,!1,(r=>r.updating))}};r([o({readOnly:!0})],m.prototype,\"type\",void 0),r([o()],m.prototype,\"layer\",void 0),r([o({readOnly:!0})],m.prototype,\"results\",null),r([o()],m.prototype,\"priority\",null),r([o()],m.prototype,\"_layerViewData\",void 0),r([o()],m.prototype,\"_analysisController\",void 0),r([o()],m.prototype,\"_analysisView\",void 0),m=r([a(\"esri.views.3d.layers.LineOfSightLayerView3D\")],m);var w=m;export default w;export{m as LineOfSightLayerView3D};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport{isSome as e,isNone as s}from\"../../../../core/maybe.js\";import{d as r}from\"../../../../chunks/mat4.js\";import{c as t}from\"../../../../chunks/mat4f64.js\";import{VisualElement as o}from\"./VisualElement.js\";import{Object3D as i}from\"../../webgl-engine/lib/Object3D.js\";import{WebGLLayer as a}from\"../../webgl-engine/lib/WebGLLayer.js\";class c extends o{constructor(e){super(e.view),this._resources=null,this._transform=t()}get object(){return e(this._resources)?this._resources.object:null}get transform(){return this._transform}set transform(s){r(this._transform,s),e(this._resources)&&(this._resources.object.transformation=this._transform)}recreate(){this.attached&&this.createResources()}recreateGeometry(){if(s(this._resources))return;const e=this._resources.object,r=this.view._stage;r.removeMany(e.geometries),e.removeAllGeometries(),this.createGeometries(e),this.visible||e.setVisible(this.visible),r.addMany(e.geometries)}createResources(){this.destroyResources();const e=this.view._stage;if(!e)return;const s=new a({isPickable:!1,updatePolicy:1});e.add(s);const r=new i({castShadow:!1});r.transformation=this._transform,this.createExternalResources(),this.createGeometries(r),e.addMany(r.geometries),this.forEachExternalMaterial((s=>e.add(s))),e.add(r),s.add(r),this.visible||r.setVisible(!1),this._resources={layer:s,object:r}}destroyResources(){const e=this.view._stage;!s(this._resources)&&e&&(e.remove(this._resources.object),e.remove(this._resources.layer),this.forEachExternalMaterial((s=>{e.remove(s),s.dispose()})),e.removeMany(this._resources.object.geometries),this._resources.object.dispose(),this.destroyExternalResources(),this._resources=null)}updateVisibility(e){s(this._resources)||this._resources.object.setVisible(e)}}export{c as Object3DVisualElement};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nclass t{constructor(t){this._attached=!1,this._resourcesCreated=!1,this._visible=!0,this.view=t,this.view.watch(\"ready\",(t=>{this._resourcesCreated&&(t?this._createResources():this._destroyResources())}))}applyProps(t){let e=!1;for(const s in t)s in this?\"attached\"===s?e=t[s]:this[s]=t[s]:console.error(\"Cannot set unknown property\",s);this.attached=e}destroy(){this.attached=!1}get attached(){return this._attached}set attached(t){t!==this._attached&&this.view._stage&&(this._attached=t,this._attached&&!this._resourcesCreated?this._createResources():!this._attached&&this._resourcesCreated&&this._destroyResources())}get visible(){return this._visible}set visible(t){t!==this._visible&&(this._visible=t,this.attached&&this.updateVisibility(t))}_createResources(){this.createResources(),this._resourcesCreated=!0,this.visible||this.updateVisibility(!1)}_destroyResources(){this.destroyResources(),this._resourcesCreated=!1}}export{t as VisualElement};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport{isSome as e,isNone as t}from\"../../../../core/maybe.js\";import{i as r,t as s}from\"../../../../chunks/mat4.js\";import{c as i}from\"../../../../chunks/mat4f64.js\";import{s as o}from\"../../../../chunks/vec3.js\";import{Z as n,c as l}from\"../../../../chunks/vec3f64.js\";import{g as h,c as a}from\"../../../../chunks/vec4.js\";import{f as p,c as d,a as f}from\"../../../../chunks/vec4f32.js\";import{Object3DVisualElement as _}from\"./Object3DVisualElement.js\";import{createGeometry as c}from\"../../layers/graphics/lineUtils.js\";import{RibbonLineMaterial as u}from\"../../webgl-engine/materials/RibbonLineMaterial.js\";class m extends _{constructor(e){super(e),this._renderOccluded=4,this._width=1,this._color=p(1,0,1,1),this._innerWidth=1,this._innerColor=null,this._stipplePattern=null,this._stippleOffColor=null,this._stippleIntegerRepeats=!1,this._writeDepthEnabled=!0,this._falloff=0,this._polygonOffset=!1,this.applyProps(e)}setGeometryFromExtent(e){const t=this.view.spatialReference,r=l(),s=l(),i=100,n=[];o(r,e[0],e[1],i),this.view.renderCoordsHelper.toRenderCoords(r,t,s),n.push([s[0],s[1],s[2]]),o(r,e[2],e[1],i),this.view.renderCoordsHelper.toRenderCoords(r,t,s),n.push([s[0],s[1],s[2]]),o(r,e[2],e[3],i),this.view.renderCoordsHelper.toRenderCoords(r,t,s),n.push([s[0],s[1],s[2]]),o(r,e[0],e[3],i),this.view.renderCoordsHelper.toRenderCoords(r,t,s),n.push([s[0],s[1],s[2]]),o(r,e[0],e[1],i),this.view.renderCoordsHelper.toRenderCoords(r,t,s),n.push([s[0],s[1],s[2]]),o(r,e[0],e[1],i),this.view.renderCoordsHelper.toRenderCoords(r,t,s),n.push([s[0],s[1],s[2]]),this.geometry=[n]}setGeometryFromFrustum(e){const t=[];e.lines.forEach((e=>{t.push([e.origin[0],e.origin[1],e.origin[2]]),t.push([e.endpoint[0],e.endpoint[1],e.endpoint[2]])})),this.geometry=[t]}setGeometryFromBoundedPlane(e){const t=[],r=e.origin,s=e.basis1,i=e.basis2,o=.5,n=l(),h=l(),a=l(),p=l();n[0]=r[0]-s[0]*o-i[0]*o,n[1]=r[1]-s[1]*o-i[1]*o,n[2]=r[2]-s[2]*o-i[2]*o,h[0]=r[0]-s[0]*o+i[0]*o,h[1]=r[1]-s[1]*o+i[1]*o,h[2]=r[2]-s[2]*o+i[2]*o,a[0]=r[0]+s[0]*o+i[0]*o,a[1]=r[1]+s[1]*o+i[1]*o,a[2]=r[2]+s[2]*o+i[2]*o,p[0]=r[0]+s[0]*o-i[0]*o,p[1]=r[1]+s[1]*o-i[1]*o,p[2]=r[2]+s[2]*o-i[2]*o,t.push([n[0],n[1],n[2]]),t.push([h[0],h[1],h[2]]),t.push([a[0],a[1],a[2]]),t.push([p[0],p[1],p[2]]),t.push([n[0],n[1],n[2]]),this.geometry=[t]}setGeometryFromSegment(e){const t=e.endRenderSpace;r(g),s(g,g,t),this.transform=g;const{points:i}=e.createRenderGeometry(t,this.view.renderCoordsHelper);this.geometry=[i]}setGeometryFromSegments(e,t=n){r(g),s(g,g,t),this.transform=g,this.geometry=e.map((e=>e.createRenderGeometry(t,this.view.renderCoordsHelper).points))}get renderOccluded(){return this._renderOccluded}set renderOccluded(e){e!==this._renderOccluded&&(this._renderOccluded=e,this._updateMaterial())}get geometry(){return this._geometry}set geometry(e){this._geometry=e,this.recreateGeometry()}get width(){return this._width}set width(e){e!==this._width&&(this._width=e,this._updateMaterial())}get color(){return this._color}set color(e){h(e,this._color)||(a(this._color,e),this._updateMaterial())}get innerWidth(){return this._innerWidth}set innerWidth(e){e!==this._innerWidth&&(this._innerWidth=e,this._updateMaterial())}get innerColor(){return this._innerColor}set innerColor(r){e(r)?!t(this._innerColor)&&h(r,this._innerColor)||(this._innerColor=a(d(),r),this._updateMaterial()):e(this._innerColor)&&(this._innerColor=null,this._updateMaterial())}get stipplePattern(){return this._stipplePattern}set stipplePattern(t){const r=e(t)!==e(this._stipplePattern);this._stipplePattern=t,r?this.recreate():this._updateMaterial()}get stippleOffColor(){return this._stippleOffColor}set stippleOffColor(r){(t(r)||t(this._stippleOffColor)||!h(r,this._stippleOffColor))&&(this._stippleOffColor=e(r)?f(r):null,this._updateMaterial())}get stippleIntegerRepeats(){return this._stippleIntegerRepeats}set stippleIntegerRepeats(e){this._stippleIntegerRepeats!==e&&(this._stippleIntegerRepeats=e,this._updateMaterial())}get writeDepthEnabled(){return this._writeDepthEnabled}set writeDepthEnabled(e){this._writeDepthEnabled!==e&&(this._writeDepthEnabled=e,this._updateMaterial())}get falloff(){return this._falloff}set falloff(e){e!==this._falloff&&(this._falloff=e,this._updateMaterial())}get polygonOffset(){return this._polygonOffset}set polygonOffset(e){e!==this._polygonOffset&&(this._polygonOffset=e,this._updateMaterial())}createExternalResources(){this._material=new u(this.materialParameters)}destroyExternalResources(){this._material=null}createGeometries(e){const t=this._createLineGeometries();if(0!==t.length)for(let r=0;r<t.length;++r){const s=c(t[r]);e.addGeometry(s,this._material)}}forEachExternalMaterial(e){e(this._material)}get materialParameters(){return{width:this._width,color:this._color,stippleOffColor:this._stippleOffColor,stipplePattern:this._stipplePattern,isClosed:!1,falloff:this._falloff,innerColor:this._innerColor,innerWidth:this._innerWidth,stippleIntegerRepeats:this._stippleIntegerRepeats,polygonOffset:this._polygonOffset,renderOccluded:this._renderOccluded,writeDepth:this._writeDepthEnabled}}_updateMaterial(){this.attached&&this._material.setParameterValues(this.materialParameters)}_createLineGeometries(){const e=this.geometry;if(t(e)||0===e.length)return[];const r=[];return e.forEach((e=>{const t=e.length,s=new Float64Array(3*t);e.forEach(((e,t)=>{s[3*t+0]=e[0],s[3*t+1]=e[1],s[3*t+2]=e[2]}));const i={attributeData:{position:s},removeDuplicateStartEnd:0};r.push(i)})),r}}const g=i();export{m as LineVisualElement};\n"],"sourceRoot":""}